(self.webpackChunkvitrivr_ng=self.webpackChunkvitrivr_ng||[]).push([[179],{5022:(C,b,D)=>{"use strict";var F={};D.r(F),D.d(F,{ACESFilmicToneMapping:()=>AX,AddEquation:()=>u0,AddOperation:()=>CX,AdditiveAnimationBlendMode:()=>jV,AdditiveBlending:()=>gV,AlphaFormat:()=>OX,AlwaysDepth:()=>_X,AlwaysStencilFunc:()=>QX,AmbientLight:()=>a4,AmbientLightProbe:()=>rK,AnimationClip:()=>gE,AnimationLoader:()=>TSe,AnimationMixer:()=>pK,AnimationObjectGroup:()=>fK,AnimationUtils:()=>xa,ArcCurve:()=>L5,ArrayCamera:()=>C5,ArrowHelper:()=>nCe,Audio:()=>d4,AudioAnalyser:()=>hK,AudioContext:()=>h4,AudioListener:()=>PSe,AudioLoader:()=>iK,AxesHelper:()=>kK,AxisHelper:()=>kCe,BackSide:()=>Al,BasicDepthPacking:()=>ZX,BasicShadowMap:()=>rve,BinaryTextureLoader:()=>FCe,Bone:()=>N2,BooleanKeyframeTrack:()=>O0,BoundingBoxHelper:()=>PCe,Box2:()=>oC,Box3:()=>Vh,Box3Helper:()=>tCe,BoxBufferGeometry:()=>Cg,BoxGeometry:()=>Cg,BoxHelper:()=>DK,BufferAttribute:()=>lo,BufferGeometry:()=>Ir,BufferGeometryLoader:()=>JY,ByteType:()=>RX,Cache:()=>B0,Camera:()=>qT,CameraHelper:()=>eCe,CanvasRenderer:()=>NCe,CanvasTexture:()=>MY,CatmullRomCurve3:()=>H5,CineonToneMapping:()=>EX,CircleBufferGeometry:()=>ZS,CircleGeometry:()=>ZS,ClampToEdgeWrapping:()=>Kc,Clock:()=>aK,Color:()=>En,ColorKeyframeTrack:()=>$5,CompressedTexture:()=>k5,CompressedTextureLoader:()=>ESe,ConeBufferGeometry:()=>YS,ConeGeometry:()=>YS,CubeCamera:()=>x2,CubeReflectionMapping:()=>h0,CubeRefractionMapping:()=>d0,CubeTexture:()=>BS,CubeTextureLoader:()=>zY,CubeUVReflectionMapping:()=>yS,CubeUVRefractionMapping:()=>IT,CubicBezierCurve:()=>Z2,CubicBezierCurve3:()=>V5,CubicInterpolant:()=>BY,CullFaceBack:()=>fV,CullFaceFront:()=>iX,CullFaceFrontBack:()=>nve,CullFaceNone:()=>tX,Curve:()=>Gh,CurvePath:()=>AY,CustomBlending:()=>rX,CustomToneMapping:()=>DX,CylinderBufferGeometry:()=>Gy,CylinderGeometry:()=>Gy,Cylindrical:()=>XSe,DataTexture:()=>D0,DataTexture2DArray:()=>T2,DataTexture3D:()=>x5,DataTextureLoader:()=>UY,DataUtils:()=>oCe,DecrementStencilOp:()=>mve,DecrementWrapStencilOp:()=>_ve,DefaultLoadingManager:()=>VY,DepthFormat:()=>Ay,DepthStencilFormat:()=>g0,DepthTexture:()=>R2,DirectionalLight:()=>o4,DirectionalLightHelper:()=>$Se,DiscreteInterpolant:()=>NY,DodecahedronBufferGeometry:()=>KS,DodecahedronGeometry:()=>KS,DoubleSide:()=>c0,DstAlphaFactor:()=>hX,DstColorFactor:()=>fX,DynamicBufferAttribute:()=>xCe,DynamicCopyUsage:()=>kve,DynamicDrawUsage:()=>xS,DynamicReadUsage:()=>Ave,EdgesGeometry:()=>I5,EdgesHelper:()=>ICe,EllipseCurve:()=>sE,EqualDepth:()=>vX,EqualStencilFunc:()=>xve,EquirectangularReflectionMapping:()=>kT,EquirectangularRefractionMapping:()=>PT,Euler:()=>C0,EventDispatcher:()=>Dy,ExtrudeBufferGeometry:()=>Hp,ExtrudeGeometry:()=>Hp,FaceColors:()=>uCe,FileLoader:()=>Vp,FlatShading:()=>mV,Float16BufferAttribute:()=>vZ,Float32Attribute:()=>DCe,Float32BufferAttribute:()=>Jn,Float64Attribute:()=>RCe,Float64BufferAttribute:()=>bZ,FloatType:()=>gg,Fog:()=>JT,FogExp2:()=>QT,Font:()=>jCe,FontLoader:()=>WCe,FramebufferTexture:()=>CY,FrontSide:()=>l0,Frustum:()=>XT,GLBufferAttribute:()=>gK,GLSL1:()=>Ive,GLSL3:()=>qV,GreaterDepth:()=>xX,GreaterEqualDepth:()=>bX,GreaterEqualStencilFunc:()=>Mve,GreaterStencilFunc:()=>Sve,GridHelper:()=>TK,Group:()=>E0,HalfFloatType:()=>p0,HemisphereLight:()=>e4,HemisphereLightHelper:()=>QSe,HemisphereLightProbe:()=>nK,IcosahedronBufferGeometry:()=>JS,IcosahedronGeometry:()=>JS,ImageBitmapLoader:()=>tK,ImageLoader:()=>_E,ImageUtils:()=>Ry,ImmediateRenderObject:()=>qCe,IncrementStencilOp:()=>pve,IncrementWrapStencilOp:()=>gve,InstancedBufferAttribute:()=>R0,InstancedBufferGeometry:()=>u4,InstancedInterleavedBuffer:()=>mK,InstancedMesh:()=>E5,Int16Attribute:()=>MCe,Int16BufferAttribute:()=>_Z,Int32Attribute:()=>ECe,Int32BufferAttribute:()=>yZ,Int8Attribute:()=>wCe,Int8BufferAttribute:()=>pZ,IntType:()=>PX,InterleavedBuffer:()=>A0,InterleavedBufferAttribute:()=>Uy,Interpolant:()=>Eg,InterpolateDiscrete:()=>BT,InterpolateLinear:()=>NT,InterpolateSmooth:()=>ZP,InvertStencilOp:()=>yve,JSONLoader:()=>HCe,KeepStencilOp:()=>KP,KeyframeTrack:()=>Yf,LOD:()=>lY,LatheBufferGeometry:()=>$S,LatheGeometry:()=>$S,Layers:()=>l2,LensFlare:()=>zCe,LessDepth:()=>yX,LessEqualDepth:()=>VP,LessEqualStencilFunc:()=>wve,LessStencilFunc:()=>bve,Light:()=>Kf,LightProbe:()=>vE,Line:()=>Tg,Line3:()=>bK,LineBasicMaterial:()=>Ic,LineCurve:()=>lE,LineCurve3:()=>EY,LineDashedMaterial:()=>Q5,LineLoop:()=>D5,LinePieces:()=>lCe,LineSegments:()=>ph,LineStrip:()=>aCe,LinearEncoding:()=>_g,LinearFilter:()=>Ka,LinearInterpolant:()=>J5,LinearMipMapLinearFilter:()=>cve,LinearMipMapNearestFilter:()=>lve,LinearMipmapLinearFilter:()=>f0,LinearMipmapNearestFilter:()=>SV,LinearToneMapping:()=>MX,Loader:()=>Fu,LoaderUtils:()=>nI,LoadingManager:()=>iI,LoopOnce:()=>WX,LoopPingPong:()=>qX,LoopRepeat:()=>jX,LuminanceAlphaFormat:()=>BX,LuminanceFormat:()=>FX,MOUSE:()=>tve,Material:()=>kc,MaterialLoader:()=>QY,Math:()=>eZ,MathUtils:()=>eZ,Matrix3:()=>pc,Matrix4:()=>nr,MaxEquation:()=>bV,Mesh:()=>Qa,MeshBasicMaterial:()=>Sg,MeshDepthMaterial:()=>A2,MeshDistanceMaterial:()=>D2,MeshFaceMaterial:()=>dCe,MeshLambertMaterial:()=>Y5,MeshMatcapMaterial:()=>K5,MeshNormalMaterial:()=>fE,MeshPhongMaterial:()=>X5,MeshPhysicalMaterial:()=>q5,MeshStandardMaterial:()=>tI,MeshToonMaterial:()=>Z5,MinEquation:()=>vV,MirroredRepeatWrapping:()=>OT,MixOperation:()=>SX,MultiMaterial:()=>fCe,MultiplyBlending:()=>yV,MultiplyOperation:()=>RT,NearestFilter:()=>Dl,NearestMipMapLinearFilter:()=>ave,NearestMipMapNearestFilter:()=>ove,NearestMipmapLinearFilter:()=>GP,NearestMipmapNearestFilter:()=>UP,NeverDepth:()=>gX,NeverStencilFunc:()=>vve,NoBlending:()=>fg,NoColors:()=>cCe,NoToneMapping:()=>pg,NormalAnimationBlendMode:()=>YP,NormalBlending:()=>_S,NotEqualDepth:()=>wX,NotEqualStencilFunc:()=>Cve,NumberKeyframeTrack:()=>pE,Object3D:()=>Zs,ObjectLoader:()=>ASe,ObjectSpaceNormalMap:()=>KX,OctahedronBufferGeometry:()=>P0,OctahedronGeometry:()=>P0,OneFactor:()=>lX,OneMinusDstAlphaFactor:()=>dX,OneMinusDstColorFactor:()=>pX,OneMinusSrcAlphaFactor:()=>wV,OneMinusSrcColorFactor:()=>uX,OrthographicCamera:()=>ZT,PCFShadowMap:()=>pV,PCFSoftShadowMap:()=>nX,PMREMGenerator:()=>v5,ParametricGeometry:()=>UCe,Particle:()=>mCe,ParticleBasicMaterial:()=>yCe,ParticleSystem:()=>gCe,ParticleSystemMaterial:()=>vCe,Path:()=>cE,PerspectiveCamera:()=>mc,Plane:()=>Lp,PlaneBufferGeometry:()=>M0,PlaneGeometry:()=>M0,PlaneHelper:()=>iCe,PointCloud:()=>pCe,PointCloudMaterial:()=>_Ce,PointLight:()=>s4,PointLightHelper:()=>YSe,Points:()=>rE,PointsMaterial:()=>k0,PolarGridHelper:()=>JSe,PolyhedronBufferGeometry:()=>Fp,PolyhedronGeometry:()=>Fp,PositionalAudio:()=>LSe,PropertyBinding:()=>ra,PropertyMixer:()=>dK,QuadraticBezierCurve:()=>Y2,QuadraticBezierCurve3:()=>K2,Quaternion:()=>eu,QuaternionKeyframeTrack:()=>sC,QuaternionLinearInterpolant:()=>HY,REVISION:()=>HP,RGBADepthPacking:()=>YX,RGBAFormat:()=>Qc,RGBAIntegerFormat:()=>UX,RGBA_ASTC_10x10_Format:()=>zV,RGBA_ASTC_10x5_Format:()=>NV,RGBA_ASTC_10x6_Format:()=>HV,RGBA_ASTC_10x8_Format:()=>VV,RGBA_ASTC_12x10_Format:()=>UV,RGBA_ASTC_12x12_Format:()=>GV,RGBA_ASTC_4x4_Format:()=>RV,RGBA_ASTC_5x4_Format:()=>kV,RGBA_ASTC_5x5_Format:()=>PV,RGBA_ASTC_6x5_Format:()=>IV,RGBA_ASTC_6x6_Format:()=>LV,RGBA_ASTC_8x5_Format:()=>OV,RGBA_ASTC_8x6_Format:()=>FV,RGBA_ASTC_8x8_Format:()=>BV,RGBA_BPTC_Format:()=>WV,RGBA_ETC2_EAC_Format:()=>DV,RGBA_PVRTC_2BPPV1_Format:()=>EV,RGBA_PVRTC_4BPPV1_Format:()=>TV,RGBA_S3TC_DXT1_Format:()=>jP,RGBA_S3TC_DXT3_Format:()=>qP,RGBA_S3TC_DXT5_Format:()=>XP,RGB_ETC1_Format:()=>GX,RGB_ETC2_Format:()=>AV,RGB_PVRTC_2BPPV1_Format:()=>MV,RGB_PVRTC_4BPPV1_Format:()=>CV,RGB_S3TC_DXT1_Format:()=>WP,RGFormat:()=>VX,RGIntegerFormat:()=>zX,RawShaderMaterial:()=>HS,Ray:()=>Oy,Raycaster:()=>jSe,RectAreaLight:()=>l4,RedFormat:()=>NX,RedIntegerFormat:()=>HX,ReinhardToneMapping:()=>TX,RepeatWrapping:()=>LT,ReplaceStencilOp:()=>fve,ReverseSubtractEquation:()=>oX,RingBufferGeometry:()=>eC,RingGeometry:()=>eC,Scene:()=>$T,SceneUtils:()=>VCe,ShaderChunk:()=>Vs,ShaderLib:()=>Zf,ShaderMaterial:()=>Mg,ShadowMaterial:()=>j5,Shape:()=>Bp,ShapeBufferGeometry:()=>I0,ShapeGeometry:()=>I0,ShapePath:()=>rCe,ShapeUtils:()=>Np,ShortType:()=>kX,Skeleton:()=>H2,SkeletonHelper:()=>wK,SkinnedMesh:()=>B2,SmoothShading:()=>sve,Sphere:()=>Iy,SphereBufferGeometry:()=>L0,SphereGeometry:()=>L0,Spherical:()=>qSe,SphericalHarmonics3:()=>c4,SplineCurve:()=>Q2,SpotLight:()=>n4,SpotLightHelper:()=>ZSe,Sprite:()=>L2,SpriteMaterial:()=>k2,SrcAlphaFactor:()=>xV,SrcAlphaSaturateFactor:()=>mX,SrcColorFactor:()=>cX,StaticCopyUsage:()=>Rve,StaticDrawUsage:()=>bS,StaticReadUsage:()=>Eve,StereoCamera:()=>RSe,StreamCopyUsage:()=>Pve,StreamDrawUsage:()=>Tve,StreamReadUsage:()=>Dve,StringKeyframeTrack:()=>F0,SubtractEquation:()=>sX,SubtractiveBlending:()=>_V,TOUCH:()=>ive,TangentSpaceNormalMap:()=>v0,TetrahedronBufferGeometry:()=>tC,TetrahedronGeometry:()=>tC,TextGeometry:()=>GCe,Texture:()=>Jl,TextureLoader:()=>GY,TorusBufferGeometry:()=>iC,TorusGeometry:()=>iC,TorusKnotBufferGeometry:()=>nC,TorusKnotGeometry:()=>nC,Triangle:()=>Rl,TriangleFanDrawMode:()=>hve,TriangleStripDrawMode:()=>uve,TrianglesDrawMode:()=>XX,TubeBufferGeometry:()=>rC,TubeGeometry:()=>rC,UVMapping:()=>zP,Uint16Attribute:()=>TCe,Uint16BufferAttribute:()=>h2,Uint32Attribute:()=>ACe,Uint32BufferAttribute:()=>d2,Uint8Attribute:()=>SCe,Uint8BufferAttribute:()=>mZ,Uint8ClampedAttribute:()=>CCe,Uint8ClampedBufferAttribute:()=>gZ,Uniform:()=>sI,UniformsLib:()=>mn,UniformsUtils:()=>wZ,UnsignedByteType:()=>mg,UnsignedInt248Type:()=>m0,UnsignedIntType:()=>FT,UnsignedShort4444Type:()=>IX,UnsignedShort5551Type:()=>LX,UnsignedShortType:()=>vS,VSMShadowMap:()=>gS,Vector2:()=>Oi,Vector3:()=>He,Vector4:()=>Bo,VectorKeyframeTrack:()=>mE,Vertex:()=>bCe,VertexColors:()=>hCe,VideoTexture:()=>SY,WebGL1Renderer:()=>nY,WebGLCubeRenderTarget:()=>w2,WebGLMultipleRenderTargets:()=>nZ,WebGLMultisampleRenderTarget:()=>e2,WebGLRenderTarget:()=>Hh,WebGLRenderTargetCube:()=>BCe,WebGLRenderer:()=>Io,WebGLUtils:()=>iY,WireframeGeometry:()=>W5,WireframeHelper:()=>LCe,WrapAroundEnding:()=>HT,XHRLoader:()=>OCe,ZeroCurvatureEnding:()=>_0,ZeroFactor:()=>aX,ZeroSlopeEnding:()=>y0,ZeroStencilOp:()=>dve,_SRGBAFormat:()=>QP,sRGBEncoding:()=>ba});var H={};function z(i){return"function"==typeof i}function V(i){const e=i(n=>{Error.call(n),n.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}D.r(H),D.d(H,{default:()=>XCe});const W=V(i=>function(e){i(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((n,r)=>`${r+1}) ${n.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function te(i,t){if(i){const e=i.indexOf(t);0<=e&&i.splice(e,1)}}class Q{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const s of e)s.remove(this);else e.remove(this);const{initialTeardown:n}=this;if(z(n))try{n()}catch(s){t=s instanceof W?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{ae(s)}catch(a){t=null!=t?t:[],a instanceof W?t=[...t,...a.errors]:t.push(a)}}if(t)throw new W(t)}}add(t){var e;if(t&&t!==this)if(this.closed)ae(t);else{if(t instanceof Q){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(e=this._finalizers)&&void 0!==e?e:[]).push(t)}}_hasParent(t){const{_parentage:e}=this;return e===t||Array.isArray(e)&&e.includes(t)}_addParent(t){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t}_removeParent(t){const{_parentage:e}=this;e===t?this._parentage=null:Array.isArray(e)&&te(e,t)}remove(t){const{_finalizers:e}=this;e&&te(e,t),t instanceof Q&&t._removeParent(this)}}Q.EMPTY=(()=>{const i=new Q;return i.closed=!0,i})();const he=Q.EMPTY;function be(i){return i instanceof Q||i&&"closed"in i&&z(i.remove)&&z(i.add)&&z(i.unsubscribe)}function ae(i){z(i)?i():i.unsubscribe()}const Te={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Ae={setTimeout(i,t,...e){const{delegate:n}=Ae;return(null==n?void 0:n.setTimeout)?n.setTimeout(i,t,...e):setTimeout(i,t,...e)},clearTimeout(i){const{delegate:t}=Ae;return((null==t?void 0:t.clearTimeout)||clearTimeout)(i)},delegate:void 0};function me(i){Ae.setTimeout(()=>{const{onUnhandledError:t}=Te;if(!t)throw i;t(i)})}function G(){}const de=Le("C",void 0,void 0);function Le(i,t,e){return{kind:i,value:t,error:e}}let it=null;function at(i){if(Te.useDeprecatedSynchronousErrorHandling){const t=!it;if(t&&(it={errorThrown:!1,error:null}),i(),t){const{errorThrown:e,error:n}=it;if(it=null,e)throw n}}else i()}class dt extends Q{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,be(t)&&t.add(this)):this.destination=Wt}static create(t,e,n){return new xt(t,e,n)}next(t){this.isStopped?$i(function Fe(i){return Le("N",i,void 0)}(t),this):this._next(t)}error(t){this.isStopped?$i(function we(i){return Le("E",void 0,i)}(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?$i(de,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Kt=Function.prototype.bind;function oi(i,t){return Kt.call(i,t)}class We{constructor(t){this.partialObserver=t}next(t){const{partialObserver:e}=this;if(e.next)try{e.next(t)}catch(n){_e(n)}}error(t){const{partialObserver:e}=this;if(e.error)try{e.error(t)}catch(n){_e(n)}else _e(t)}complete(){const{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(e){_e(e)}}}class xt extends dt{constructor(t,e,n){let r;if(super(),z(t)||!t)r={next:null!=t?t:void 0,error:null!=e?e:void 0,complete:null!=n?n:void 0};else{let s;this&&Te.useDeprecatedNextContext?(s=Object.create(t),s.unsubscribe=()=>this.unsubscribe(),r={next:t.next&&oi(t.next,s),error:t.error&&oi(t.error,s),complete:t.complete&&oi(t.complete,s)}):r=t}this.destination=new We(r)}}function _e(i){Te.useDeprecatedSynchronousErrorHandling?function Dt(i){Te.useDeprecatedSynchronousErrorHandling&&it&&(it.errorThrown=!0,it.error=i)}(i):me(i)}function $i(i,t){const{onStoppedNotification:e}=Te;e&&Ae.setTimeout(()=>e(i,t))}const Wt={closed:!0,next:G,error:function Lt(i){throw i},complete:G},Ei="function"==typeof Symbol&&Symbol.observable||"@@observable";function Rt(i){return i}let ft=(()=>{class i{constructor(e){e&&(this._subscribe=e)}lift(e){const n=new i;return n.source=this,n.operator=e,n}subscribe(e,n,r){const s=function Fi(i){return i&&i instanceof dt||function qi(i){return i&&z(i.next)&&z(i.error)&&z(i.complete)}(i)&&be(i)}(e)?e:new xt(e,n,r);return at(()=>{const{operator:a,source:l}=this;s.add(a?a.call(s,l):l?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(e){try{return this._subscribe(e)}catch(n){e.error(n)}}forEach(e,n){return new(n=bn(n))((r,s)=>{const a=new xt({next:l=>{try{e(l)}catch(u){s(u),a.unsubscribe()}},error:s,complete:r});this.subscribe(a)})}_subscribe(e){var n;return null===(n=this.source)||void 0===n?void 0:n.subscribe(e)}[Ei](){return this}pipe(...e){return function Ct(i){return 0===i.length?Rt:1===i.length?i[0]:function(e){return i.reduce((n,r)=>r(n),e)}}(e)(this)}toPromise(e){return new(e=bn(e))((n,r)=>{let s;this.subscribe(a=>s=a,a=>r(a),()=>n(s))})}}return i.create=t=>new i(t),i})();function bn(i){var t;return null!==(t=null!=i?i:Te.Promise)&&void 0!==t?t:Promise}const cr=V(i=>function(){i(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let ii=(()=>{class i extends ft{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const n=new mr(this,this);return n.operator=e,n}_throwIfClosed(){if(this.closed)throw new cr}next(e){at(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const n of this.currentObservers)n.next(e)}})}error(e){at(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:n}=this;for(;n.length;)n.shift().error(e)}})}complete(){at(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:n,isStopped:r,observers:s}=this;return n||r?he:(this.currentObservers=null,s.push(e),new Q(()=>{this.currentObservers=null,te(s,e)}))}_checkFinalizedStatuses(e){const{hasError:n,thrownError:r,isStopped:s}=this;n?e.error(r):s&&e.complete()}asObservable(){const e=new ft;return e.source=this,e}}return i.create=(t,e)=>new mr(t,e),i})();class mr extends ii{constructor(t,e){super(),this.destination=t,this.source=e}next(t){var e,n;null===(n=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===n||n.call(e,t)}error(t){var e,n;null===(n=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===n||n.call(e,t)}complete(){var t,e;null===(e=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===e||e.call(t)}_subscribe(t){var e,n;return null!==(n=null===(e=this.source)||void 0===e?void 0:e.subscribe(t))&&void 0!==n?n:he}}function zr(i){return z(null==i?void 0:i.lift)}function gr(i){return t=>{if(zr(t))return t.lift(function(e){try{return i(e,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function qn(i,t,e,n,r){return new za(i,t,e,n,r)}class za extends dt{constructor(t,e,n,r,s,a){super(t),this.onFinalize=s,this.shouldUnsubscribe=a,this._next=e?function(l){try{e(l)}catch(u){t.error(u)}}:super._next,this._error=r?function(l){try{r(l)}catch(u){t.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=n?function(){try{n()}catch(l){t.error(l)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}}function Ui(i,t){return gr((e,n)=>{let r=0;e.subscribe(qn(n,s=>{n.next(i.call(t,s,r++))}))})}function Eo(i){return this instanceof Eo?(this.v=i,this):new Eo(i)}function oa(i,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,n=e.apply(i,t||[]),s=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(v){n[v]&&(r[v]=function(S){return new Promise(function(T,I){s.push([v,S,T,I])>1||l(v,S)})})}function l(v,S){try{!function u(v){v.value instanceof Eo?Promise.resolve(v.value.v).then(h,m):_(s[0][2],v)}(n[v](S))}catch(T){_(s[0][3],T)}}function h(v){l("next",v)}function m(v){l("throw",v)}function _(v,S){v(S),s.shift(),s.length&&l(s[0][0],s[0][1])}}function no(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,t=i[Symbol.asyncIterator];return t?t.call(i):(i=function fi(i){var t="function"==typeof Symbol&&Symbol.iterator,e=t&&i[t],n=0;if(e)return e.call(i);if(i&&"number"==typeof i.length)return{next:function(){return i&&n>=i.length&&(i=void 0),{value:i&&i[n++],done:!i}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(i),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(s){e[s]=i[s]&&function(a){return new Promise(function(l,u){!function r(s,a,l,u){Promise.resolve(u).then(function(h){s({value:h,done:l})},a)}(l,u,(a=i[s](a)).done,a.value)})}}}const Ni=i=>i&&"number"==typeof i.length&&"function"!=typeof i;function _n(i){return z(null==i?void 0:i.then)}function Gi(i){return z(i[Ei])}function Xi(i){return Symbol.asyncIterator&&z(null==i?void 0:i[Symbol.asyncIterator])}function Xn(i){return new TypeError(`You provided ${null!==i&&"object"==typeof i?"an invalid object":`'${i}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const Rr=function cs(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function vs(i){return z(null==i?void 0:i[Rr])}function kr(i){return oa(this,arguments,function*(){const e=i.getReader();try{for(;;){const{value:n,done:r}=yield Eo(e.read());if(r)return yield Eo(void 0);yield yield Eo(n)}}finally{e.releaseLock()}})}function ic(i){return z(null==i?void 0:i.getReader)}function eo(i){if(i instanceof ft)return i;if(null!=i){if(Gi(i))return function Sa(i){return new ft(t=>{const e=i[Ei]();if(z(e.subscribe))return e.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(i);if(Ni(i))return function Bg(i){return new ft(t=>{for(let e=0;e<i.length&&!t.closed;e++)t.next(i[e]);t.complete()})}(i);if(_n(i))return function Ng(i){return new ft(t=>{i.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,me)})}(i);if(Xi(i))return Kp(i);if(vs(i))return function gh(i){return new ft(t=>{for(const e of i)if(t.next(e),t.closed)return;t.complete()})}(i);if(ic(i))return function Ua(i){return Kp(kr(i))}(i)}throw Xn(i)}function Kp(i){return new ft(t=>{(function af(i,t){var e,n,r,s;return function $t(i,t,e,n){return new(e||(e=Promise))(function(s,a){function l(m){try{h(n.next(m))}catch(_){a(_)}}function u(m){try{h(n.throw(m))}catch(_){a(_)}}function h(m){m.done?s(m.value):function r(s){return s instanceof e?s:new e(function(a){a(s)})}(m.value).then(l,u)}h((n=n.apply(i,t||[])).next())})}(this,void 0,void 0,function*(){try{for(e=no(i);!(n=yield e.next()).done;)if(t.next(n.value),t.closed)return}catch(a){r={error:a}}finally{try{n&&!n.done&&(s=e.return)&&(yield s.call(e))}finally{if(r)throw r.error}}t.complete()})})(i,t).catch(e=>t.error(e))})}function Fc(i,t,e,n=0,r=!1){const s=t.schedule(function(){e(),r?i.add(this.schedule(null,n)):this.unsubscribe()},n);if(i.add(s),!r)return s}function ks(i,t,e=1/0){return z(t)?ks((n,r)=>Ui((s,a)=>t(n,s,r,a))(eo(i(n,r))),e):("number"==typeof t&&(e=t),gr((n,r)=>function ed(i,t,e,n,r,s,a,l){const u=[];let h=0,m=0,_=!1;const v=()=>{_&&!u.length&&!h&&t.complete()},S=I=>h<n?T(I):u.push(I),T=I=>{s&&t.next(I),h++;let j=!1;eo(e(I,m++)).subscribe(qn(t,P=>{null==r||r(P),s?S(P):t.next(P)},()=>{j=!0},void 0,()=>{if(j)try{for(h--;u.length&&h<n;){const P=u.shift();a?Fc(t,a,()=>T(P)):T(P)}v()}catch(P){t.error(P)}}))};return i.subscribe(qn(t,S,()=>{_=!0,v()})),()=>{null==l||l()}}(n,r,i,e)))}function lf(i=1/0){return ks(Rt,i)}const aa=new ft(i=>i.complete());function Qp(i){return i&&z(i.schedule)}function ep(i){return i[i.length-1]}function Jp(i){return z(ep(i))?i.pop():void 0}function tu(i){return Qp(ep(i))?i.pop():void 0}function _h(i,t=0){return gr((e,n)=>{e.subscribe(qn(n,r=>Fc(n,i,()=>n.next(r),t),()=>Fc(n,i,()=>n.complete(),t),r=>Fc(n,i,()=>n.error(r),t)))})}function Hg(i,t=0){return gr((e,n)=>{n.add(i.schedule(()=>e.subscribe(n),t))})}function em(i,t){if(!i)throw new Error("Iterable cannot be null");return new ft(e=>{Fc(e,t,()=>{const n=i[Symbol.asyncIterator]();Fc(e,t,()=>{n.next().then(r=>{r.done?e.complete():e.next(r.value)})},0,!0)})})}function xr(i,t){return t?function Ps(i,t){if(null!=i){if(Gi(i))return function ov(i,t){return eo(i).pipe(Hg(t),_h(t))}(i,t);if(Ni(i))return function tp(i,t){return new ft(e=>{let n=0;return t.schedule(function(){n===i.length?e.complete():(e.next(i[n++]),e.closed||this.schedule())})})}(i,t);if(_n(i))return function $p(i,t){return eo(i).pipe(Hg(t),_h(t))}(i,t);if(Xi(i))return em(i,t);if(vs(i))return function Vg(i,t){return new ft(e=>{let n;return Fc(e,t,()=>{n=i[Rr](),Fc(e,t,()=>{let r,s;try{({value:r,done:s}=n.next())}catch(a){return void e.error(a)}s?e.complete():e.next(r)},0,!0)}),()=>z(null==n?void 0:n.return)&&n.return()})}(i,t);if(ic(i))return function uf(i,t){return em(kr(i),t)}(i,t)}throw Xn(i)}(i,t):eo(i)}function uo(...i){const t=tu(i),e=function cf(i,t){return"number"==typeof ep(i)?i.pop():t}(i,1/0),n=i;return n.length?1===n.length?eo(n[0]):lf(e)(xr(n,t)):aa}function Qr(i){return i<=0?()=>aa:gr((t,e)=>{let n=0;t.subscribe(qn(e,r=>{++n<=i&&(e.next(r),i<=n&&e.complete())}))})}function yh(i={}){const{connector:t=(()=>new ii),resetOnError:e=!0,resetOnComplete:n=!0,resetOnRefCountZero:r=!0}=i;return s=>{let a=null,l=null,u=null,h=0,m=!1,_=!1;const v=()=>{null==l||l.unsubscribe(),l=null},S=()=>{v(),a=u=null,m=_=!1},T=()=>{const I=a;S(),null==I||I.unsubscribe()};return gr((I,j)=>{h++,!_&&!m&&v();const P=u=null!=u?u:t();j.add(()=>{h--,0===h&&!_&&!m&&(l=hf(T,r))}),P.subscribe(j),a||(a=new xt({next:E=>P.next(E),error:E=>{_=!0,v(),l=hf(S,e,E),P.error(E)},complete:()=>{m=!0,v(),l=hf(S,n),P.complete()}}),xr(I).subscribe(a))})(s)}}function hf(i,t,...e){return!0===t?(i(),null):!1===t?null:t(...e).pipe(Qr(1)).subscribe(()=>i())}function xn(i){for(let t in i)if(i[t]===xn)return t;throw Error("Could not find renamed property on target object.")}function Ao(i,t){for(const e in t)t.hasOwnProperty(e)&&!i.hasOwnProperty(e)&&(i[e]=t[e])}function Us(i){if("string"==typeof i)return i;if(Array.isArray(i))return"["+i.map(Us).join(", ")+"]";if(null==i)return""+i;if(i.overriddenName)return`${i.overriddenName}`;if(i.name)return`${i.name}`;const t=i.toString();if(null==t)return""+t;const e=t.indexOf("\n");return-1===e?t:t.substring(0,e)}function td(i,t){return null==i||""===i?null===t?"":t:null==t||""===t?i:i+" "+t}const vc=xn({__forward_ref__:xn});function rs(i){return i.__forward_ref__=rs,i.toString=function(){return Us(this())},i}function Br(i){return Nu(i)?i():i}function Nu(i){return"function"==typeof i&&i.hasOwnProperty(vc)&&i.__forward_ref__===rs}class ln extends Error{constructor(t,e){super(function id(i,t){return`NG0${Math.abs(i)}${t?": "+t:""}`}(t,e)),this.code=t}}function yr(i){return"string"==typeof i?i:null==i?"":String(i)}function la(i){return"function"==typeof i?i.name||i.toString():"object"==typeof i&&null!=i&&"function"==typeof i.type?i.type.name||i.type.toString():yr(i)}function hu(i,t){const e=t?` in ${t}`:"";throw new ln(-201,`No provider for ${la(i)} found${e}`)}function Ga(i,t){null==i&&function So(i,t,e,n){throw new Error(`ASSERTION ERROR: ${i}`+(null==n?"":` [Expected=> ${e} ${n} ${t} <=Actual]`))}(t,i,null,"!=")}function Nt(i){return{token:i.token,providedIn:i.providedIn||null,factory:i.factory,value:void 0}}function xi(i){return{providers:i.providers||[],imports:i.imports||[]}}function nm(i){return Wg(i,ip)||Wg(i,df)}function Wg(i,t){return i.hasOwnProperty(t)?i[t]:null}function K0(i){return i&&(i.hasOwnProperty(ds)||i.hasOwnProperty(mu))?i[ds]:null}const ip=xn({\u0275prov:xn}),ds=xn({\u0275inj:xn}),df=xn({ngInjectableDef:xn}),mu=xn({ngInjectorDef:xn});var wr=(()=>((wr=wr||{})[wr.Default=0]="Default",wr[wr.Host=1]="Host",wr[wr.Self=2]="Self",wr[wr.SkipSelf=4]="SkipSelf",wr[wr.Optional=8]="Optional",wr))();let qg;function Hu(i){const t=qg;return qg=i,t}function Q0(i,t,e){const n=nm(i);return n&&"root"==n.providedIn?void 0===n.value?n.value=n.factory():n.value:e&wr.Optional?null:void 0!==t?t:void hu(Us(i),"Injector")}function cd(i){return{toString:i}.toString()}var nc=(()=>((nc=nc||{})[nc.OnPush=0]="OnPush",nc[nc.Default=1]="Default",nc))(),Co=(()=>{return(i=Co||(Co={}))[i.Emulated=0]="Emulated",i[i.None=2]="None",i[i.ShadowDom=3]="ShadowDom",Co;var i})();const rm="undefined"!=typeof globalThis&&globalThis,ud="undefined"!=typeof window&&window,ff="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Ur=rm||"undefined"!=typeof global&&global||ud||ff,np={},Gs=[],Xg=xn({\u0275cmp:xn}),Zg=xn({\u0275dir:xn}),Yg=xn({\u0275pipe:xn}),sm=xn({\u0275mod:xn}),rc=xn({\u0275fac:xn}),om=xn({__NG_ELEMENT_ID__:xn});let am=0;function ei(i){return cd(()=>{const e={},n={type:i.type,providersResolver:null,decls:i.decls,vars:i.vars,factory:null,template:i.template||null,consts:i.consts||null,ngContentSelectors:i.ngContentSelectors,hostBindings:i.hostBindings||null,hostVars:i.hostVars||0,hostAttrs:i.hostAttrs||null,contentQueries:i.contentQueries||null,declaredInputs:e,inputs:null,outputs:null,exportAs:i.exportAs||null,onPush:i.changeDetection===nc.OnPush,directiveDefs:null,pipeDefs:null,selectors:i.selectors||Gs,viewQuery:i.viewQuery||null,features:i.features||null,data:i.data||{},encapsulation:i.encapsulation||Co.Emulated,id:"c",styles:i.styles||Gs,_:null,setInput:null,schemas:i.schemas||null,tView:null},r=i.directives,s=i.features,a=i.pipes;return n.id+=am++,n.inputs=pv(i.inputs,e),n.outputs=pv(i.outputs),s&&s.forEach(l=>l(n)),n.directiveDefs=r?()=>("function"==typeof r?r():r).map(J0):null,n.pipeDefs=a?()=>("function"==typeof a?a():a).map(lm):null,n})}function J0(i){return pl(i)||function il(i){return i[Zg]||null}(i)}function lm(i){return function ml(i){return i[Yg]||null}(i)}const dv={};function yi(i){return cd(()=>{const t={type:i.type,bootstrap:i.bootstrap||Gs,declarations:i.declarations||Gs,imports:i.imports||Gs,exports:i.exports||Gs,transitiveCompileScopes:null,schemas:i.schemas||null,id:i.id||null};return null!=i.id&&(dv[i.id]=i.type),t})}function pv(i,t){if(null==i)return np;const e={};for(const n in i)if(i.hasOwnProperty(n)){let r=i[n],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),e[r]=n,t&&(t[r]=s)}return e}const Be=ei;function Hn(i){return{type:i.type,name:i.name,factory:null,pure:!1!==i.pure,onDestroy:i.type.prototype.ngOnDestroy||null}}function pl(i){return i[Xg]||null}function Bl(i,t){const e=i[sm]||null;if(!e&&!0===t)throw new Error(`Type ${Us(i)} does not have '\u0275mod' property.`);return e}function Sc(i){return Array.isArray(i)&&"object"==typeof i[1]}function oc(i){return Array.isArray(i)&&!0===i[1]}function op(i){return 0!=(8&i.flags)}function gu(i){return 2==(2&i.flags)}function ap(i){return 1==(1&i.flags)}function qa(i){return null!==i.template}function pf(i){return 0!=(512&i[2])}function yu(i,t){return i.hasOwnProperty(rc)?i[rc]:null}class tx{constructor(t,e,n){this.previousValue=t,this.currentValue=e,this.firstChange=n}isFirstChange(){return this.firstChange}}function Ls(){return md}function md(i){return i.type.prototype.ngOnChanges&&(i.setInput=cm),Gu}function Gu(){const i=f(this),t=null==i?void 0:i.current;if(t){const e=i.previous;if(e===np)i.previous=t;else for(let n in t)e[n]=t[n];i.current=null,this.ngOnChanges(t)}}function cm(i,t,e,n){const r=f(i)||function x(i,t){return i[cp]=t}(i,{previous:np,current:null}),s=r.current||(r.current={}),a=r.previous,l=this.declaredInputs[e],u=a[l];s[l]=new tx(u&&u.currentValue,t,a===np),i[n]=t}Ls.ngInherit=!0;const cp="__ngSimpleChanges__";function f(i){return i[cp]||null}let on;function ps(){return void 0!==on?on:"undefined"!=typeof document?document:void 0}function fo(i){return!!i.listen}const bf={createRenderer:(i,t)=>ps()};function zo(i){for(;Array.isArray(i);)i=i[0];return i}function da(i,t){return zo(t[i])}function fa(i,t){return zo(t[i.index])}function xf(i,t){return i.data[t]}function Zn(i,t){return i[t]}function yl(i,t){const e=t[i];return Sc(e)?e:e[0]}function _v(i){return 4==(4&i[2])}function Jg(i){return 128==(128&i[2])}function Vc(i,t){return null==t?null:i[t]}function $g(i){i[18]=0}function up(i,t){i[5]+=t;let e=i,n=i[3];for(;null!==n&&(1===t&&1===e[5]||-1===t&&0===e[5]);)n[5]+=t,e=n,n=n[3]}const Wr={lFrame:n_(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function nx(){return Wr.bindingsEnabled}function Di(){return Wr.lFrame.lView}function Tr(){return Wr.lFrame.tView}function gt(i){return Wr.lFrame.contextLView=i,i[8]}function rl(){let i=um();for(;null!==i&&64===i.type;)i=i.parent;return i}function um(){return Wr.lFrame.currentTNode}function ac(i,t){const e=Wr.lFrame;e.currentTNode=i,e.isParent=t}function gd(){return Wr.lFrame.isParent}function _d(){Wr.lFrame.isParent=!1}function t_(){return Wr.isInCheckNoChangesMode}function dm(i){Wr.isInCheckNoChangesMode=i}function Vl(){const i=Wr.lFrame;let t=i.bindingRootIndex;return-1===t&&(t=i.bindingRootIndex=i.tView.bindingStartIndex),t}function wf(){return Wr.lFrame.bindingIndex++}function Xu(i){const t=Wr.lFrame,e=t.bindingIndex;return t.bindingIndex=t.bindingIndex+i,e}function sl(i,t){const e=Wr.lFrame;e.bindingIndex=e.bindingRootIndex=i,i_(t)}function i_(i){Wr.lFrame.currentDirectiveIndex=i}function xh(i){const t=Wr.lFrame.currentDirectiveIndex;return-1===t?null:i[t]}function fm(){return Wr.lFrame.currentQueryIndex}function zl(i){Wr.lFrame.currentQueryIndex=i}function qE(i){const t=i[1];return 2===t.type?t.declTNode:1===t.type?i[6]:null}function XE(i,t,e){if(e&wr.SkipSelf){let r=t,s=i;for(;!(r=r.parent,null!==r||e&wr.Host||(r=qE(s),null===r||(s=s[15],10&r.type))););if(null===r)return!1;t=r,i=s}const n=Wr.lFrame=yd();return n.currentTNode=t,n.lView=i,!0}function rx(i){const t=yd(),e=i[1];Wr.lFrame=t,t.currentTNode=e.firstChild,t.lView=i,t.tView=e,t.contextLView=i,t.bindingIndex=e.bindingStartIndex,t.inI18n=!1}function yd(){const i=Wr.lFrame,t=null===i?null:i.child;return null===t?n_(i):t}function n_(i){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:i,child:null,inI18n:!1};return null!==i&&(i.child=t),t}function vl(){const i=Wr.lFrame;return Wr.lFrame=i.parent,i.currentTNode=null,i.lView=null,i}const pm=vl;function Sf(){const i=vl();i.isParent=!0,i.tView=null,i.selectedIndex=-1,i.contextLView=null,i.elementDepthCount=0,i.currentDirectiveIndex=-1,i.currentNamespace=null,i.bindingRootIndex=-1,i.bindingIndex=-1,i.currentQueryIndex=0}function Ul(){return Wr.lFrame.selectedIndex}function vd(i){Wr.lFrame.selectedIndex=i}function Ta(){const i=Wr.lFrame;return xf(i.tView,i.selectedIndex)}function Zu(){Wr.lFrame.currentNamespace="svg"}function xd(){!function ox(){Wr.lFrame.currentNamespace=null}()}function ax(i,t){for(let e=t.directiveStart,n=t.directiveEnd;e<n;e++){const s=i.data[e].type.prototype,{ngAfterContentInit:a,ngAfterContentChecked:l,ngAfterViewInit:u,ngAfterViewChecked:h,ngOnDestroy:m}=s;a&&(i.contentHooks||(i.contentHooks=[])).push(-e,a),l&&((i.contentHooks||(i.contentHooks=[])).push(e,l),(i.contentCheckHooks||(i.contentCheckHooks=[])).push(e,l)),u&&(i.viewHooks||(i.viewHooks=[])).push(-e,u),h&&((i.viewHooks||(i.viewHooks=[])).push(e,h),(i.viewCheckHooks||(i.viewCheckHooks=[])).push(e,h)),null!=m&&(i.destroyHooks||(i.destroyHooks=[])).push(e,m)}}function wd(i,t,e){YE(i,t,3,e)}function lx(i,t,e,n){(3&i[2])===e&&YE(i,t,e,n)}function TC(i,t){let e=i[2];(3&e)===t&&(e&=2047,e+=1,i[2]=e)}function YE(i,t,e,n){const s=null!=n?n:-1,a=t.length-1;let l=0;for(let u=void 0!==n?65535&i[18]:0;u<a;u++)if("number"==typeof t[u+1]){if(l=t[u],null!=n&&l>=n)break}else t[u]<0&&(i[18]+=65536),(l<s||-1==s)&&(AL(i,e,t,u),i[18]=(4294901760&i[18])+u+2),u++}function AL(i,t,e,n){const r=e[n]<0,s=e[n+1],l=i[r?-e[n]:e[n]];if(r){if(i[2]>>11<i[18]>>16&&(3&i[2])===t){i[2]+=2048;try{s.call(l)}finally{}}}else try{s.call(l)}finally{}}class xv{constructor(t,e,n){this.factory=t,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=n}}function cx(i,t,e){const n=fo(i);let r=0;for(;r<e.length;){const s=e[r];if("number"==typeof s){if(0!==s)break;r++;const a=e[r++],l=e[r++],u=e[r++];n?i.setAttribute(t,l,u,a):t.setAttributeNS(a,l,u)}else{const a=s,l=e[++r];AC(a)?n&&i.setProperty(t,a,l):n?i.setAttribute(t,a,l):t.setAttribute(a,l),r++}}return r}function KE(i){return 3===i||4===i||6===i}function AC(i){return 64===i.charCodeAt(0)}function ux(i,t){if(null!==t&&0!==t.length)if(null===i||0===i.length)i=t.slice();else{let e=-1;for(let n=0;n<t.length;n++){const r=t[n];"number"==typeof r?e=r:0===e||QE(i,e,r,null,-1===e||2===e?t[++n]:null)}}return i}function QE(i,t,e,n,r){let s=0,a=i.length;if(-1===t)a=-1;else for(;s<i.length;){const l=i[s++];if("number"==typeof l){if(l===t){a=-1;break}if(l>t){a=s-1;break}}}for(;s<i.length;){const l=i[s];if("number"==typeof l)break;if(l===e){if(null===n)return void(null!==r&&(i[s+1]=r));if(n===i[s+1])return void(i[s+2]=r)}s++,null!==n&&s++,null!==r&&s++}-1!==a&&(i.splice(a,0,t),s=a+1),i.splice(s++,0,e),null!==n&&i.splice(s++,0,n),null!==r&&i.splice(s++,0,r)}function JE(i){return-1!==i}function s_(i){return 32767&i}function o_(i,t){let e=function IL(i){return i>>16}(i),n=t;for(;e>0;)n=n[15],e--;return n}let DC=!0;function hx(i){const t=DC;return DC=i,t}let LL=0;function Sv(i,t){const e=kC(i,t);if(-1!==e)return e;const n=t[1];n.firstCreatePass&&(i.injectorIndex=t.length,RC(n.data,i),RC(t,null),RC(n.blueprint,null));const r=dx(i,t),s=i.injectorIndex;if(JE(r)){const a=s_(r),l=o_(r,t),u=l[1].data;for(let h=0;h<8;h++)t[s+h]=l[a+h]|u[a+h]}return t[s+8]=r,s}function RC(i,t){i.push(0,0,0,0,0,0,0,0,t)}function kC(i,t){return-1===i.injectorIndex||i.parent&&i.parent.injectorIndex===i.injectorIndex||null===t[i.injectorIndex+8]?-1:i.injectorIndex}function dx(i,t){if(i.parent&&-1!==i.parent.injectorIndex)return i.parent.injectorIndex;let e=0,n=null,r=t;for(;null!==r;){const s=r[1],a=s.type;if(n=2===a?s.declTNode:1===a?r[6]:null,null===n)return-1;if(e++,r=r[15],-1!==n.injectorIndex)return n.injectorIndex|e<<16}return-1}function fx(i,t,e){!function OL(i,t,e){let n;"string"==typeof e?n=e.charCodeAt(0)||0:e.hasOwnProperty(om)&&(n=e[om]),null==n&&(n=e[om]=LL++);const r=255&n;t.data[i+(r>>5)]|=1<<r}(i,t,e)}function tA(i,t,e){if(e&wr.Optional)return i;hu(t,"NodeInjector")}function iA(i,t,e,n){if(e&wr.Optional&&void 0===n&&(n=null),0==(e&(wr.Self|wr.Host))){const r=i[9],s=Hu(void 0);try{return r?r.get(t,n,e&wr.Optional):Q0(t,n,e&wr.Optional)}finally{Hu(s)}}return tA(n,t,e)}function nA(i,t,e,n=wr.Default,r){if(null!==i){const s=function HL(i){if("string"==typeof i)return i.charCodeAt(0)||0;const t=i.hasOwnProperty(om)?i[om]:void 0;return"number"==typeof t?t>=0?255&t:BL:t}(e);if("function"==typeof s){if(!XE(t,i,n))return n&wr.Host?tA(r,e,n):iA(t,e,n,r);try{const a=s(n);if(null!=a||n&wr.Optional)return a;hu(e)}finally{pm()}}else if("number"==typeof s){let a=null,l=kC(i,t),u=-1,h=n&wr.Host?t[16][6]:null;for((-1===l||n&wr.SkipSelf)&&(u=-1===l?dx(i,t):t[l+8],-1!==u&&oA(n,!1)?(a=t[1],l=s_(u),t=o_(u,t)):l=-1);-1!==l;){const m=t[1];if(sA(s,l,m.data)){const _=NL(l,t,e,a,n,h);if(_!==rA)return _}u=t[l+8],-1!==u&&oA(n,t[1].data[l+8]===h)&&sA(s,l,t)?(a=m,l=s_(u),t=o_(u,t)):l=-1}}}return iA(t,e,n,r)}const rA={};function BL(){return new a_(rl(),Di())}function NL(i,t,e,n,r,s){const a=t[1],l=a.data[i+8],m=px(l,a,e,null==n?gu(l)&&DC:n!=a&&0!=(3&l.type),r&wr.Host&&s===l);return null!==m?Cv(t,a,m,l):rA}function px(i,t,e,n,r){const s=i.providerIndexes,a=t.data,l=1048575&s,u=i.directiveStart,m=s>>20,v=r?l+m:i.directiveEnd;for(let S=n?l:l+m;S<v;S++){const T=a[S];if(S<u&&e===T||S>=u&&T.type===e)return S}if(r){const S=a[u];if(S&&qa(S)&&S.type===e)return u}return null}function Cv(i,t,e,n){let r=i[e];const s=t.data;if(function DL(i){return i instanceof xv}(r)){const a=r;a.resolving&&function nd(i,t){const e=t?`. Dependency path: ${t.join(" > ")} > ${i}`:"";throw new ln(-200,`Circular dependency in DI detected for ${i}${e}`)}(la(s[e]));const l=hx(a.canSeeViewProviders);a.resolving=!0;const u=a.injectImpl?Hu(a.injectImpl):null;XE(i,n,wr.Default);try{r=i[e]=a.factory(void 0,s,i,n),t.firstCreatePass&&e>=n.directiveStart&&function ZE(i,t,e){const{ngOnChanges:n,ngOnInit:r,ngDoCheck:s}=t.type.prototype;if(n){const a=md(t);(e.preOrderHooks||(e.preOrderHooks=[])).push(i,a),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(i,a)}r&&(e.preOrderHooks||(e.preOrderHooks=[])).push(0-i,r),s&&((e.preOrderHooks||(e.preOrderHooks=[])).push(i,s),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(i,s))}(e,s[e],t)}finally{null!==u&&Hu(u),hx(l),a.resolving=!1,pm()}}return r}function sA(i,t,e){return!!(e[t+(i>>5)]&1<<i)}function oA(i,t){return!(i&wr.Self||i&wr.Host&&t)}class a_{constructor(t,e){this._tNode=t,this._lView=e}get(t,e,n){return nA(this._tNode,this._lView,t,n,e)}}function Ki(i){return cd(()=>{const t=i.prototype.constructor,e=t[rc]||PC(t),n=Object.prototype;let r=Object.getPrototypeOf(i.prototype).constructor;for(;r&&r!==n;){const s=r[rc]||PC(r);if(s&&s!==e)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function PC(i){return Nu(i)?()=>{const t=PC(Br(i));return t&&t()}:yu(i)}function zc(i){return function FL(i,t){if("class"===t)return i.classes;if("style"===t)return i.styles;const e=i.attrs;if(e){const n=e.length;let r=0;for(;r<n;){const s=e[r];if(KE(s))break;if(0===s)r+=2;else if("number"==typeof s)for(r++;r<n&&"string"==typeof e[r];)r++;else{if(s===t)return e[r+1];r+=2}}}return null}(rl(),i)}const l_="__annotations__",c_="__parameters__",u_="__prop__metadata__";function h_(i,t,e){return cd(()=>{const n=function IC(i){return function(...e){if(i){const n=i(...e);for(const r in n)this[r]=n[r]}}}(t);function r(...s){if(this instanceof r)return n.apply(this,s),this;const a=new r(...s);return l.annotation=a,l;function l(u,h,m){const _=u.hasOwnProperty(c_)?u[c_]:Object.defineProperty(u,c_,{value:[]})[c_];for(;_.length<=m;)_.push(null);return(_[m]=_[m]||[]).push(a),u}}return e&&(r.prototype=Object.create(e.prototype)),r.prototype.ngMetadataName=i,r.annotationCls=r,r})}class gi{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=Nt({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}toString(){return`InjectionToken ${this._desc}`}}const zL=new gi("AnalyzeForEntryComponents"),LC=Function;function Tv(i){return"function"==typeof i}function Yu(i,t){void 0===t&&(t=i);for(let e=0;e<i.length;e++){let n=i[e];Array.isArray(n)?(t===i&&(t=i.slice(0,e)),Yu(n,t)):t!==i&&t.push(n)}return t}function Sd(i,t){i.forEach(e=>Array.isArray(e)?Sd(e,t):t(e))}function lA(i,t,e){t>=i.length?i.push(e):i.splice(t,0,e)}function mx(i,t){return t>=i.length-1?i.pop():i.splice(t,1)[0]}function Ev(i,t){const e=[];for(let n=0;n<i;n++)e.push(t);return e}function bu(i,t,e){let n=d_(i,t);return n>=0?i[1|n]=e:(n=~n,function WL(i,t,e,n){let r=i.length;if(r==t)i.push(e,n);else if(1===r)i.push(n,i[0]),i[0]=e;else{for(r--,i.push(i[r-1],i[r]);r>t;)i[r]=i[r-2],r--;i[t]=e,i[t+1]=n}}(i,n,t,e)),n}function OC(i,t){const e=d_(i,t);if(e>=0)return i[1|e]}function d_(i,t){return function hA(i,t,e){let n=0,r=i.length>>e;for(;r!==n;){const s=n+(r-n>>1),a=i[s<<e];if(t===a)return s<<e;a>t?r=s:n=s+1}return~(r<<e)}(i,t,1)}const jL=/^function\s+\S+\(\)\s*{[\s\S]+\.apply\(this,\s*(arguments|(?:[^()]+\(\[\],)?[^()]+\(arguments\).*)\)/,qL=/^class\s+[A-Za-z\d$_]*\s*extends\s+[^{]+{/,XL=/^class\s+[A-Za-z\d$_]*\s*extends\s+[^{]+{[\s\S]*constructor\s*\(/,ZL=/^class\s+[A-Za-z\d$_]*\s*extends\s+[^{]+{[\s\S]*constructor\s*\(\)\s*{[^}]*super\(\.\.\.arguments\)/;class dA{constructor(t){this._reflect=t||Ur.Reflect}isReflectionEnabled(){return!0}factory(t){return(...e)=>new t(...e)}_zipTypesAndAnnotations(t,e){let n;n=Ev(void 0===t?e.length:t.length);for(let r=0;r<n.length;r++)n[r]=void 0===t?[]:t[r]&&t[r]!=Object?[t[r]]:[],e&&null!=e[r]&&(n[r]=n[r].concat(e[r]));return n}_ownParameters(t,e){if(function YL(i){return jL.test(i)||ZL.test(i)||qL.test(i)&&!XL.test(i)}(t.toString()))return null;if(t.parameters&&t.parameters!==e.parameters)return t.parameters;const r=t.ctorParameters;if(r&&r!==e.ctorParameters){const l="function"==typeof r?r():r,u=l.map(m=>m&&m.type),h=l.map(m=>m&&FC(m.decorators));return this._zipTypesAndAnnotations(u,h)}const s=t.hasOwnProperty(c_)&&t[c_],a=this._reflect&&this._reflect.getOwnMetadata&&this._reflect.getOwnMetadata("design:paramtypes",t);return a||s?this._zipTypesAndAnnotations(a,s):Ev(t.length)}parameters(t){if(!Tv(t))return[];const e=gx(t);let n=this._ownParameters(t,e);return!n&&e!==Object&&(n=this.parameters(e)),n||[]}_ownAnnotations(t,e){if(t.annotations&&t.annotations!==e.annotations){let n=t.annotations;return"function"==typeof n&&n.annotations&&(n=n.annotations),n}return t.decorators&&t.decorators!==e.decorators?FC(t.decorators):t.hasOwnProperty(l_)?t[l_]:null}annotations(t){if(!Tv(t))return[];const e=gx(t),n=this._ownAnnotations(t,e)||[];return(e!==Object?this.annotations(e):[]).concat(n)}_ownPropMetadata(t,e){if(t.propMetadata&&t.propMetadata!==e.propMetadata){let n=t.propMetadata;return"function"==typeof n&&n.propMetadata&&(n=n.propMetadata),n}if(t.propDecorators&&t.propDecorators!==e.propDecorators){const n=t.propDecorators,r={};return Object.keys(n).forEach(s=>{r[s]=FC(n[s])}),r}return t.hasOwnProperty(u_)?t[u_]:null}propMetadata(t){if(!Tv(t))return{};const e=gx(t),n={};if(e!==Object){const s=this.propMetadata(e);Object.keys(s).forEach(a=>{n[a]=s[a]})}const r=this._ownPropMetadata(t,e);return r&&Object.keys(r).forEach(s=>{const a=[];n.hasOwnProperty(s)&&a.push(...n[s]),a.push(...r[s]),n[s]=a}),n}ownPropMetadata(t){return Tv(t)&&this._ownPropMetadata(t,gx(t))||{}}hasLifecycleHook(t,e){return t instanceof LC&&e in t.prototype}guards(t){return{}}getter(t){return new Function("o","return o."+t+";")}setter(t){return new Function("o","v","return o."+t+" = v;")}method(t){return new Function("o","args",`if (!o.${t}) throw new Error('"${t}" is undefined');\n        return o.${t}.apply(o, args);`)}importUri(t){return"object"==typeof t&&t.filePath?t.filePath:`./${Us(t)}`}resourceUri(t){return`./${Us(t)}`}resolveIdentifier(t,e,n,r){return r}resolveEnum(t,e){return t[e]}}function FC(i){return i?i.map(t=>new(0,t.type.annotationCls)(...t.args?t.args:[])):[]}function gx(i){const t=i.prototype?Object.getPrototypeOf(i.prototype):null;return(t?t.constructor:null)||Object}const dp={},BC="__NG_DI_FLAG__",_x="ngTempTokenPath",Vz=/\n/gm,KL="__source",Uz=xn({provide:String,useValue:xn});let yx;function QL(i){const t=yx;return yx=i,t}function Gz(i,t=wr.Default){if(void 0===yx)throw new ln(203,"");return null===yx?Q0(i,void 0,t):yx.get(i,t&wr.Optional?null:void 0,t)}function Ve(i,t=wr.Default){return(function xC(){return qg}()||Gz)(Br(i),t)}const f_=Ve;function fA(i){const t=[];for(let e=0;e<i.length;e++){const n=Br(i[e]);if(Array.isArray(n)){if(0===n.length)throw new ln(900,"");let r,s=wr.Default;for(let a=0;a<n.length;a++){const l=n[a],u=Wz(l);"number"==typeof u?-1===u?r=l.token:s|=u:r=l}t.push(Ve(r,s))}else t.push(Ve(n))}return t}function vx(i,t){return i[BC]=t,i.prototype[BC]=t,i}function Wz(i){return i[BC]}const NC=vx(h_("Inject",i=>({token:i})),-1),wh=vx(h_("Optional"),8),pA=vx(h_("Self"),2),mm=vx(h_("SkipSelf"),4);let xx,Cf;function p_(i){var t;return(null===(t=function VC(){if(void 0===xx&&(xx=null,Ur.trustedTypes))try{xx=Ur.trustedTypes.createPolicy("angular",{createHTML:i=>i,createScript:i=>i,createScriptURL:i=>i})}catch(i){}return xx}())||void 0===t?void 0:t.createHTML(i))||i}function Ch(i){var t;return(null===(t=function Cd(){if(void 0===Cf&&(Cf=null,Ur.trustedTypes))try{Cf=Ur.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:i=>i,createScript:i=>i,createScriptURL:i=>i})}catch(i){}return Cf}())||void 0===t?void 0:t.createHTML(i))||i}class Ku{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class GC extends Ku{getTypeName(){return"HTML"}}class kv extends Ku{getTypeName(){return"Style"}}class gA extends Ku{getTypeName(){return"Script"}}class wx extends Ku{getTypeName(){return"URL"}}class _A extends Ku{getTypeName(){return"ResourceURL"}}function Uc(i){return i instanceof Ku?i.changingThisBreaksApplicationSecurity:i}function Cc(i,t){const e=gm(i);if(null!=e&&e!==t){if("ResourceURL"===e&&"URL"===t)return!0;throw new Error(`Required a safe ${t}, got a ${e} (see https://g.co/ng/security#xss)`)}return e===t}function gm(i){return i instanceof Ku&&i.getTypeName()||null}class xA{constructor(t){this.inertDocumentHelper=t}getInertBodyElement(t){t="<body><remove></remove>"+t;try{const e=(new window.DOMParser).parseFromString(p_(t),"text/html").body;return null===e?this.inertDocumentHelper.getInertBodyElement(t):(e.removeChild(e.firstChild),e)}catch(e){return null}}}class wA{constructor(t){if(this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const e=this.inertDocument.createElement("html");this.inertDocument.appendChild(e);const n=this.inertDocument.createElement("body");e.appendChild(n)}}getInertBodyElement(t){const e=this.inertDocument.createElement("template");if("content"in e)return e.innerHTML=p_(t),e;const n=this.inertDocument.createElement("body");return n.innerHTML=p_(t),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(n),n}stripCustomNsAttrs(t){const e=t.attributes;for(let r=e.length-1;0<r;r--){const a=e.item(r).name;("xmlns:ns1"===a||0===a.indexOf("ns1:"))&&t.removeAttribute(a)}let n=t.firstChild;for(;n;)n.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(n),n=n.nextSibling}}const oO=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,aO=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Pv(i){return(i=String(i)).match(oO)||i.match(aO)?i:"unsafe:"+i}function SA(i){return(i=String(i)).split(",").map(t=>Pv(t.trim())).join(", ")}function xu(i){const t={};for(const e of i.split(","))t[e]=!0;return t}function Iv(...i){const t={};for(const e of i)for(const n in e)e.hasOwnProperty(n)&&(t[n]=!0);return t}const CA=xu("area,br,col,hr,img,wbr"),qC=xu("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),MA=xu("rp,rt"),Cx=Iv(CA,Iv(qC,xu("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Iv(MA,xu("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Iv(MA,qC)),Mx=xu("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Tx=xu("srcset"),XC=Iv(Mx,Tx,xu("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),xu("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),EA=xu("script,style,template");class AA{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(t){let e=t.firstChild,n=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?n=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,n&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let r=this.checkClobberedElement(e,e.nextSibling);if(r){e=r;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(t){const e=t.nodeName.toLowerCase();if(!Cx.hasOwnProperty(e))return this.sanitizedSomething=!0,!EA.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const n=t.attributes;for(let r=0;r<n.length;r++){const s=n.item(r),a=s.name,l=a.toLowerCase();if(!XC.hasOwnProperty(l)){this.sanitizedSomething=!0;continue}let u=s.value;Mx[l]&&(u=Pv(u)),Tx[l]&&(u=SA(u)),this.buf.push(" ",a,'="',lc(u),'"')}return this.buf.push(">"),!0}endElement(t){const e=t.nodeName.toLowerCase();Cx.hasOwnProperty(e)&&!CA.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(t){this.buf.push(lc(t))}checkClobberedElement(t,e){if(e&&(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`);return e}}const m_=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Gc=/([^\#-~ |!])/g;function lc(i){return i.replace(/&/g,"&amp;").replace(m_,function(t){return"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";"}).replace(Gc,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let _m;function DA(i,t){let e=null;try{_m=_m||function bA(i){const t=new wA(i);return function jC(){try{return!!(new window.DOMParser).parseFromString(p_(""),"text/html")}catch(i){return!1}}()?new xA(t):t}(i);let n=t?String(t):"";e=_m.getInertBodyElement(n);let r=5,s=n;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,n=s,s=e.innerHTML,e=_m.getInertBodyElement(n)}while(n!==s);return p_((new AA).sanitizeChildren(ZC(e)||e))}finally{if(e){const n=ZC(e)||e;for(;n.firstChild;)n.removeChild(n.firstChild)}}}function ZC(i){return"content"in i&&function hO(i){return i.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===i.nodeName}(i)?i.content:null}var so=(()=>((so=so||{})[so.NONE=0]="NONE",so[so.HTML=1]="HTML",so[so.STYLE=2]="STYLE",so[so.SCRIPT=3]="SCRIPT",so[so.URL=4]="URL",so[so.RESOURCE_URL=5]="RESOURCE_URL",so))();function Lv(i){const t=Ov();return t?Ch(t.sanitize(so.HTML,i)||""):Cc(i,"HTML")?Ch(Uc(i)):DA(ps(),yr(i))}function Mc(i){const t=Ov();return t?t.sanitize(so.URL,i)||"":Cc(i,"URL")?Uc(i):Pv(yr(i))}function Ov(){const i=Di();return i&&i[12]}const PA="__ngContext__";function Tc(i,t){i[PA]=t}function KC(i){const t=function Fv(i){return i[PA]||null}(i);return t?Array.isArray(t)?t:t.lView:null}const QC="ngOriginalError";function JC(i){return i[QC]}function EO(i,...t){i.error(...t)}class fp{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t),n=function TO(i){return i&&i.ngErrorLogger||EO}(t);n(this._console,"ERROR",t),e&&n(this._console,"ORIGINAL ERROR",e)}_findOriginalError(t){let e=t&&JC(t);for(;e&&JC(e);)e=JC(e);return e||null}}const PO=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Ur))();function Ex(i){return i.ownerDocument.defaultView}function Mh(i){return i.ownerDocument}function Md(i){return i instanceof Function?i():i}var iu=(()=>((iu=iu||{})[iu.Important=1]="Important",iu[iu.DashCase=2]="DashCase",iu))();function Bv(i,t){return undefined(i,t)}function Nv(i){const t=i[3];return oc(t)?t[3]:t}function Ax(i){return zA(i[13])}function Dx(i){return zA(i[4])}function zA(i){for(;null!==i&&!oc(i);)i=i[4];return i}function y_(i,t,e,n,r){if(null!=n){let s,a=!1;oc(n)?s=n:Sc(n)&&(a=!0,n=n[0]);const l=zo(n);0===i&&null!==e?null==r?Hv(t,e,l):Td(t,e,l,r||null,!0):1===i&&null!==e?Td(t,e,l,r||null,!0):2===i?function JA(i,t,e){const n=Vv(i,t);n&&function GO(i,t,e,n){fo(i)?i.removeChild(t,e,n):t.removeChild(e)}(i,n,t,e)}(t,l,a):3===i&&t.destroyNode(l),null!=s&&function kx(i,t,e,n,r){const s=e[7];s!==zo(e)&&y_(t,i,n,s,r);for(let l=10;l<e.length;l++){const u=e[l];b_(u[1],u,i,t,n,s)}}(t,i,s,e,r)}}function rM(i,t,e){if(fo(i))return i.createElement(t,e);{const n=null!==e?function _i(i){const t=i.toLowerCase();return"svg"===t?"http://www.w3.org/2000/svg":"math"===t?"http://www.w3.org/1998/MathML/":null}(e):null;return null===n?i.createElement(t):i.createElementNS(n,t)}}function jA(i,t){const e=i[9],n=e.indexOf(t),r=t[3];1024&t[2]&&(t[2]&=-1025,up(r,-1)),e.splice(n,1)}function sM(i,t){if(i.length<=10)return;const e=10+t,n=i[e];if(n){const r=n[17];null!==r&&r!==i&&jA(r,n),t>0&&(i[e-1][4]=n[4]);const s=mx(i,10+t);!function BO(i,t){b_(i,t,t[11],2,null,null),t[0]=null,t[6]=null}(n[1],n);const a=s[19];null!==a&&a.detachView(s[1]),n[3]=null,n[4]=null,n[2]&=-129}return n}function qA(i,t){if(!(256&t[2])){const e=t[11];fo(e)&&e.destroyNode&&b_(i,t,e,3,null,null),function VO(i){let t=i[13];if(!t)return oM(i[1],i);for(;t;){let e=null;if(Sc(t))e=t[13];else{const n=t[10];n&&(e=n)}if(!e){for(;t&&!t[4]&&t!==i;)Sc(t)&&oM(t[1],t),t=t[3];null===t&&(t=i),Sc(t)&&oM(t[1],t),e=t&&t[4]}t=e}}(t)}}function oM(i,t){if(!(256&t[2])){t[2]&=-129,t[2]|=256,function UO(i,t){let e;if(null!=i&&null!=(e=i.destroyHooks))for(let n=0;n<e.length;n+=2){const r=t[e[n]];if(!(r instanceof xv)){const s=e[n+1];if(Array.isArray(s))for(let a=0;a<s.length;a+=2){const l=r[s[a]],u=s[a+1];try{u.call(l)}finally{}}else try{s.call(r)}finally{}}}}(i,t),function zO(i,t){const e=i.cleanup,n=t[7];let r=-1;if(null!==e)for(let s=0;s<e.length-1;s+=2)if("string"==typeof e[s]){const a=e[s+1],l="function"==typeof a?a(t):zo(t[a]),u=n[r=e[s+2]],h=e[s+3];"boolean"==typeof h?l.removeEventListener(e[s],u,h):h>=0?n[r=h]():n[r=-h].unsubscribe(),s+=2}else{const a=n[r=e[s+1]];e[s].call(a)}if(null!==n){for(let s=r+1;s<n.length;s++)n[s]();t[7]=null}}(i,t),1===t[1].type&&fo(t[11])&&t[11].destroy();const e=t[17];if(null!==e&&oc(t[3])){e!==t[3]&&jA(e,t);const n=t[19];null!==n&&n.detachView(i)}}}function aM(i,t,e){return function XA(i,t,e){let n=t;for(;null!==n&&40&n.type;)n=(t=n).parent;if(null===n)return e[0];if(2&n.flags){const r=i.data[n.directiveStart].encapsulation;if(r===Co.None||r===Co.Emulated)return null}return fa(n,e)}(i,t.parent,e)}function Td(i,t,e,n,r){fo(i)?i.insertBefore(t,e,n,r):t.insertBefore(e,n,r)}function Hv(i,t,e){fo(i)?i.appendChild(t,e):t.appendChild(e)}function ZA(i,t,e,n,r){null!==n?Td(i,t,e,n,r):Hv(i,t,e)}function Vv(i,t){return fo(i)?i.parentNode(t):t.parentNode}function YA(i,t,e){return Rx(i,t,e)}let Rx=function lM(i,t,e){return 40&i.type?fa(i,e):null};function v_(i,t,e,n){const r=aM(i,n,t),s=t[11],l=YA(n.parent||t[6],n,t);if(null!=r)if(Array.isArray(e))for(let u=0;u<e.length;u++)ZA(s,r,e[u],l,!1);else ZA(s,r,e,l,!1)}function ym(i,t){if(null!==t){const e=t.type;if(3&e)return fa(t,i);if(4&e)return cM(-1,i[t.index]);if(8&e){const n=t.child;if(null!==n)return ym(i,n);{const r=i[t.index];return oc(r)?cM(-1,r):zo(r)}}if(32&e)return Bv(t,i)()||zo(i[t.index]);{const n=QA(i,t);return null!==n?Array.isArray(n)?n[0]:ym(Nv(i[16]),n):ym(i,t.next)}}return null}function QA(i,t){return null!==t?i[16][6].projection[t.projection]:null}function cM(i,t){const e=10+i+1;if(e<t.length){const n=t[e],r=n[1].firstChild;if(null!==r)return ym(n,r)}return t[7]}function po(i,t,e,n,r,s,a){for(;null!=e;){const l=n[e.index],u=e.type;if(a&&0===t&&(l&&Tc(zo(l),n),e.flags|=4),64!=(64&e.flags))if(8&u)po(i,t,e.child,n,r,s,!1),y_(t,i,r,l,s);else if(32&u){const h=Bv(e,n);let m;for(;m=h();)y_(t,i,r,m,s);y_(t,i,r,l,s)}else 16&u?x_(i,t,n,e,r,s):y_(t,i,r,l,s);e=a?e.projectionNext:e.next}}function b_(i,t,e,n,r,s){po(e,n,i.firstChild,t,r,s,!1)}function x_(i,t,e,n,r,s){const a=e[16],u=a[6].projection[n.projection];if(Array.isArray(u))for(let h=0;h<u.length;h++)y_(t,i,r,u[h],s);else po(i,t,u,a[3],r,s,!0)}function Ea(i,t,e){fo(i)?i.setAttribute(t,"style",e):t.style.cssText=e}function Ed(i,t,e){fo(i)?""===e?i.removeAttribute(t,"class"):i.setAttribute(t,"class",e):t.className=e}function Uv(i,t,e){let n=i.length;for(;;){const r=i.indexOf(t,e);if(-1===r)return r;if(0===r||i.charCodeAt(r-1)<=32){const s=t.length;if(r+s===n||i.charCodeAt(r+s)<=32)return r}e=r+1}}const w_="ng-template";function S_(i,t,e){let n=0;for(;n<i.length;){let r=i[n++];if(e&&"class"===r){if(r=i[n],-1!==Uv(r.toLowerCase(),t,0))return!0}else if(1===r){for(;n<i.length&&"string"==typeof(r=i[n++]);)if(r.toLowerCase()===t)return!0;return!1}}return!1}function bm(i){return 4===i.type&&i.value!==w_}function C_(i,t,e){return t===(4!==i.type||e?i.value:w_)}function Wv(i,t,e){let n=4;const r=i.attrs||[],s=function $A(i){for(let t=0;t<i.length;t++)if(KE(i[t]))return t;return i.length}(r);let a=!1;for(let l=0;l<t.length;l++){const u=t[l];if("number"!=typeof u){if(!a)if(4&n){if(n=2|1&n,""!==u&&!C_(i,u,e)||""===u&&1===t.length){if(Qu(n))return!1;a=!0}}else{const h=8&n?u:t[++l];if(8&n&&null!==i.attrs){if(!S_(i.attrs,h,e)){if(Qu(n))return!1;a=!0}continue}const _=Px(8&n?"class":u,r,bm(i),e);if(-1===_){if(Qu(n))return!1;a=!0;continue}if(""!==h){let v;v=_>s?"":r[_+1].toLowerCase();const S=8&n?v:null;if(S&&-1!==Uv(S,h,0)||2&n&&h!==v){if(Qu(n))return!1;a=!0}}}}else{if(!a&&!Qu(n)&&!Qu(u))return!1;if(a&&Qu(u))continue;a=!1,n=u|1&n}}return Qu(n)||a}function Qu(i){return 0==(1&i)}function Px(i,t,e,n){if(null===t)return-1;let r=0;if(n||!e){let s=!1;for(;r<t.length;){const a=t[r];if(a===i)return r;if(3===a||6===a)s=!0;else{if(1===a||2===a){let l=t[++r];for(;"string"==typeof l;)l=t[++r];continue}if(4===a)break;if(0===a){r+=4;continue}}r+=s?1:2}return-1}return function uM(i,t){let e=i.indexOf(4);if(e>-1)for(e++;e<i.length;){const n=i[e];if("number"==typeof n)return-1;if(n===t)return e;e++}return-1}(t,i)}function M_(i,t,e=!1){for(let n=0;n<t.length;n++)if(Wv(i,t[n],e))return!0;return!1}function eD(i,t){e:for(let e=0;e<t.length;e++){const n=t[e];if(i.length===n.length){for(let r=0;r<i.length;r++)if(i[r]!==n[r])continue e;return!0}}return!1}function jv(i,t){return i?":not("+t.trim()+")":t}function Lx(i){let t=i[0],e=1,n=2,r="",s=!1;for(;e<i.length;){let a=i[e];if("string"==typeof a)if(2&n){const l=i[++e];r+="["+a+(l.length>0?'="'+l+'"':"")+"]"}else 8&n?r+="."+a:4&n&&(r+=" "+a);else""!==r&&!Qu(a)&&(t+=jv(s,r),r=""),n=a,s=s||!Qu(n);e++}return""!==r&&(t+=jv(s,r)),t}const $r={};function se(i){hM(Tr(),Di(),Ul()+i,t_())}function hM(i,t,e,n){if(!n)if(3==(3&t[2])){const s=i.preOrderCheckHooks;null!==s&&wd(t,s,e)}else{const s=i.preOrderHooks;null!==s&&lx(t,s,0,e)}vd(e)}function Fx(i,t){return i<<17|t<<2}function Ju(i){return i>>17&32767}function Tf(i){return 2|i}function Ad(i){return(131068&i)>>2}function fM(i,t){return-131069&i|t<<2}function Ef(i){return 1|i}function Yx(i,t){const e=i.contentQueries;if(null!==e)for(let n=0;n<e.length;n+=2){const r=e[n],s=e[n+1];if(-1!==s){const a=i.data[s];zl(r),a.contentQueries(2,t[s],s)}}}function Jv(i,t,e,n,r,s,a,l,u,h){const m=t.blueprint.slice();return m[0]=r,m[2]=140|n,$g(m),m[3]=m[15]=i,m[8]=e,m[10]=a||i&&i[10],m[11]=l||i&&i[11],m[12]=u||i&&i[12]||null,m[9]=h||i&&i[9]||null,m[6]=s,m[16]=2==t.type?i[16]:m,m}function k_(i,t,e,n,r){let s=i.data[t];if(null===s)s=function wM(i,t,e,n,r){const s=um(),a=gd(),u=i.data[t]=function nb(i,t,e,n,r,s){return{type:e,index:n,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,a?s:s&&s.parent,e,t,n,r);return null===i.firstChild&&(i.firstChild=u),null!==s&&(a?null==s.child&&null!==u.parent&&(s.child=u):null===s.next&&(s.next=u)),u}(i,t,e,n,r),function MC(){return Wr.lFrame.inI18n}()&&(s.flags|=64);else if(64&s.type){s.type=e,s.value=n,s.attrs=r;const a=function hm(){const i=Wr.lFrame,t=i.currentTNode;return i.isParent?t:t.parent}();s.injectorIndex=null===a?-1:a.injectorIndex}return ac(s,!0),s}function Rd(i,t,e,n){if(0===e)return-1;const r=t.length;for(let s=0;s<e;s++)t.push(n),i.blueprint.push(n),i.data.push(null);return r}function $v(i,t,e){rx(t);try{const n=i.viewQuery;null!==n&&kM(1,n,e);const r=i.template;null!==r&&sD(i,t,r,1,e),i.firstCreatePass&&(i.firstCreatePass=!1),i.staticContentQueries&&Yx(i,t),i.staticViewQueries&&kM(2,i.viewQuery,e);const s=i.components;null!==s&&function rD(i,t){for(let e=0;e<t.length;e++)cD(i,t[e])}(t,s)}catch(n){throw i.firstCreatePass&&(i.incompleteFirstPass=!0,i.firstCreatePass=!1),n}finally{t[2]&=-5,Sf()}}function P_(i,t,e,n){const r=t[2];if(256==(256&r))return;rx(t);const s=t_();try{$g(t),function yv(i){return Wr.lFrame.bindingIndex=i}(i.bindingStartIndex),null!==e&&sD(i,t,e,2,n);const a=3==(3&r);if(!s)if(a){const h=i.preOrderCheckHooks;null!==h&&wd(t,h,null)}else{const h=i.preOrderHooks;null!==h&&lx(t,h,0,null),TC(t,0)}if(function DM(i){for(let t=Ax(i);null!==t;t=Dx(t)){if(!t[2])continue;const e=t[9];for(let n=0;n<e.length;n++){const r=e[n],s=r[3];0==(1024&r[2])&&up(s,1),r[2]|=1024}}}(t),function ab(i){for(let t=Ax(i);null!==t;t=Dx(t))for(let e=10;e<t.length;e++){const n=t[e],r=n[1];Jg(n)&&P_(r,n,r.template,n[8])}}(t),null!==i.contentQueries&&Yx(i,t),!s)if(a){const h=i.contentCheckHooks;null!==h&&wd(t,h)}else{const h=i.contentHooks;null!==h&&lx(t,h,1),TC(t,1)}!function bM(i,t){const e=i.hostBindingOpCodes;if(null!==e)try{for(let n=0;n<e.length;n++){const r=e[n];if(r<0)vd(~r);else{const s=r,a=e[++n],l=e[++n];sl(a,s),l(2,t[s])}}}finally{vd(-1)}}(i,t);const l=i.components;null!==l&&function xM(i,t){for(let e=0;e<t.length;e++)lF(i,t[e])}(t,l);const u=i.viewQuery;if(null!==u&&kM(2,u,n),!s)if(a){const h=i.viewCheckHooks;null!==h&&wd(t,h)}else{const h=i.viewHooks;null!==h&&lx(t,h,2),TC(t,2)}!0===i.firstUpdatePass&&(i.firstUpdatePass=!1),s||(t[2]&=-73),1024&t[2]&&(t[2]&=-1025,up(t[3],-1))}finally{Sf()}}function QO(i,t,e,n){const r=t[10],s=!t_(),a=_v(t);try{s&&!a&&r.begin&&r.begin(),a&&$v(i,t,n),P_(i,t,e,n)}finally{s&&!a&&r.end&&r.end()}}function sD(i,t,e,n,r){const s=Ul(),a=2&n;try{vd(-1),a&&t.length>20&&hM(i,t,20,t_()),e(n,r)}finally{vd(s)}}function I_(i,t,e){if(op(t)){const r=t.directiveEnd;for(let s=t.directiveStart;s<r;s++){const a=i.data[s];a.contentQueries&&a.contentQueries(1,e[s],s)}}}function L_(i,t,e){!nx()||(function iF(i,t,e,n){const r=e.directiveStart,s=e.directiveEnd;i.firstCreatePass||Sv(e,t),Tc(n,t);const a=e.initialInputs;for(let l=r;l<s;l++){const u=i.data[l],h=qa(u);h&&$x(t,e,u);const m=Cv(t,i,l,e);Tc(m,t),null!==a&&ob(0,l-r,m,u,0,a),h&&(yl(e.index,t)[8]=m)}}(i,t,e,fa(e,t)),128==(128&e.flags)&&function nF(i,t,e){const n=e.directiveStart,r=e.directiveEnd,a=e.index,l=function EL(){return Wr.lFrame.currentDirectiveIndex}();try{vd(a);for(let u=n;u<r;u++){const h=i.data[u],m=t[u];i_(u),(null!==h.hostBindings||0!==h.hostVars||null!==h.hostAttrs)&&Jx(h,m)}}finally{vd(-1),i_(l)}}(i,t,e))}function eb(i,t,e=fa){const n=t.localNames;if(null!==n){let r=t.index+1;for(let s=0;s<n.length;s+=2){const a=n[s+1],l=-1===a?e(t,i):i[a];i[r++]=l}}}function O_(i){const t=i.tView;return null===t||t.incompleteFirstPass?i.tView=tb(1,null,i.template,i.decls,i.vars,i.directiveDefs,i.pipeDefs,i.viewQuery,i.schemas,i.consts):t}function tb(i,t,e,n,r,s,a,l,u,h){const m=20+n,_=m+r,v=function Kx(i,t){const e=[];for(let n=0;n<t;n++)e.push(n<i?null:$r);return e}(m,_),S="function"==typeof h?h():h;return v[1]={type:i,blueprint:v,template:e,queries:null,viewQuery:l,declTNode:t,data:v.slice().fill(null,m),bindingStartIndex:m,expandoStartIndex:_,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof a?a():a,firstChild:null,schemas:u,consts:S,incompleteFirstPass:!1}}function CM(i,t,e,n){const r=Cm(t);null===e?r.push(n):(r.push(e),i.firstCreatePass&&Mm(i).push(n,r.length-1))}function Th(i,t,e){for(let n in i)if(i.hasOwnProperty(n)){const r=i[n];(e=null===e?{}:e).hasOwnProperty(n)?e[n].push(t,r):e[n]=[t,r]}return e}function al(i,t,e,n,r,s,a,l){const u=fa(t,e);let m,h=t.inputs;!l&&null!=h&&(m=h[n])?(PM(i,e,m,n,r),gu(t)&&function rb(i,t){const e=yl(t,i);16&e[2]||(e[2]|=64)}(e,t.index)):3&t.type&&(n=function oD(i){return"class"===i?"className":"for"===i?"htmlFor":"formaction"===i?"formAction":"innerHtml"===i?"innerHTML":"readonly"===i?"readOnly":"tabindex"===i?"tabIndex":i}(n),r=null!=a?a(r,t.value||"",n):r,fo(s)?s.setProperty(u,n,r):AC(n)||(u.setProperty?u.setProperty(n,r):u[n]=r))}function MM(i,t,e,n){let r=!1;if(nx()){const s=function rF(i,t,e){const n=i.directiveRegistry;let r=null;if(n)for(let s=0;s<n.length;s++){const a=n[s];M_(e,a.selectors,!1)&&(r||(r=[]),fx(Sv(e,t),i,a.type),qa(a)?(wm(i,e),r.unshift(a)):r.push(a))}return r}(i,t,e),a=null===n?null:{"":-1};if(null!==s){r=!0,sb(e,i.data.length,s.length);for(let m=0;m<s.length;m++){const _=s[m];_.providersResolver&&_.providersResolver(_)}let l=!1,u=!1,h=Rd(i,t,s.length,null);for(let m=0;m<s.length;m++){const _=s[m];e.mergedAttrs=ux(e.mergedAttrs,_.hostAttrs),TM(i,e,t,h,_),pa(h,_,a),null!==_.contentQueries&&(e.flags|=8),(null!==_.hostBindings||null!==_.hostAttrs||0!==_.hostVars)&&(e.flags|=128);const v=_.type.prototype;!l&&(v.ngOnChanges||v.ngOnInit||v.ngDoCheck)&&((i.preOrderHooks||(i.preOrderHooks=[])).push(e.index),l=!0),!u&&(v.ngOnChanges||v.ngDoCheck)&&((i.preOrderCheckHooks||(i.preOrderCheckHooks=[])).push(e.index),u=!0),h++}!function JO(i,t){const n=t.directiveEnd,r=i.data,s=t.attrs,a=[];let l=null,u=null;for(let h=t.directiveStart;h<n;h++){const m=r[h],_=m.inputs,v=null===s||bm(t)?null:oF(_,s);a.push(v),l=Th(_,h,l),u=Th(m.outputs,h,u)}null!==l&&(l.hasOwnProperty("class")&&(t.flags|=16),l.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=a,t.inputs=l,t.outputs=u}(i,e)}a&&function sF(i,t,e){if(t){const n=i.localNames=[];for(let r=0;r<t.length;r+=2){const s=e[t[r+1]];if(null==s)throw new ln(-301,!1);n.push(t[r],s)}}}(e,n,a)}return e.mergedAttrs=ux(e.mergedAttrs,e.attrs),r}function lD(i,t,e,n,r,s){const a=s.hostBindings;if(a){let l=i.hostBindingOpCodes;null===l&&(l=i.hostBindingOpCodes=[]);const u=~t.index;(function tF(i){let t=i.length;for(;t>0;){const e=i[--t];if("number"==typeof e&&e<0)return e}return 0})(l)!=u&&l.push(u),l.push(n,r,a)}}function Jx(i,t){null!==i.hostBindings&&i.hostBindings(1,t)}function wm(i,t){t.flags|=2,(i.components||(i.components=[])).push(t.index)}function pa(i,t,e){if(e){if(t.exportAs)for(let n=0;n<t.exportAs.length;n++)e[t.exportAs[n]]=i;qa(t)&&(e[""]=i)}}function sb(i,t,e){i.flags|=1,i.directiveStart=t,i.directiveEnd=t+e,i.providerIndexes=t}function TM(i,t,e,n,r){i.data[n]=r;const s=r.factory||(r.factory=yu(r.type)),a=new xv(s,qa(r),null);i.blueprint[n]=a,e[n]=a,lD(i,t,0,n,Rd(i,e,r.hostVars,$r),r)}function $x(i,t,e){const n=fa(t,i),r=O_(e),s=i[10],a=Mu(i,Jv(i,r,null,e.onPush?64:16,n,t,s,s.createRenderer(n,e),null,null));i[t.index]=a}function Cu(i,t,e,n,r,s){const a=fa(i,t);!function EM(i,t,e,n,r,s,a){if(null==s)fo(i)?i.removeAttribute(t,r,e):t.removeAttribute(r);else{const l=null==a?yr(s):a(s,n||"",r);fo(i)?i.setAttribute(t,r,l,e):e?t.setAttributeNS(e,r,l):t.setAttribute(r,l)}}(t[11],a,s,i.value,e,n,r)}function ob(i,t,e,n,r,s){const a=s[t];if(null!==a){const l=n.setInput;for(let u=0;u<a.length;){const h=a[u++],m=a[u++],_=a[u++];null!==l?n.setInput(e,_,h,m):e[m]=_}}}function oF(i,t){let e=null,n=0;for(;n<t.length;){const r=t[n];if(0!==r)if(5!==r){if("number"==typeof r)break;i.hasOwnProperty(r)&&(null===e&&(e=[]),e.push(r,i[r],t[n+1])),n+=2}else n+=2;else n+=4}return e}function AM(i,t,e,n){return new Array(i,!0,!1,t,null,0,n,e,null,null)}function lF(i,t){const e=yl(t,i);if(Jg(e)){const n=e[1];80&e[2]?P_(n,e,n.template,e[8]):e[5]>0&&$u(e)}}function $u(i){for(let n=Ax(i);null!==n;n=Dx(n))for(let r=10;r<n.length;r++){const s=n[r];if(1024&s[2]){const a=s[1];P_(a,s,a.template,s[8])}else s[5]>0&&$u(s)}const e=i[1].components;if(null!==e)for(let n=0;n<e.length;n++){const r=yl(e[n],i);Jg(r)&&r[5]>0&&$u(r)}}function cD(i,t){const e=yl(t,i),n=e[1];(function uD(i,t){for(let e=t.length;e<i.blueprint.length;e++)t.push(i.blueprint[e])})(n,e),$v(n,e,e[8])}function Mu(i,t){return i[13]?i[14][4]=t:i[13]=t,i[14]=t,t}function RM(i){for(;i;){i[2]|=64;const t=Nv(i);if(pf(i)&&!t)return i;i=t}return null}function _p(i,t,e){const n=t[10];n.begin&&n.begin();try{P_(i,t,i.template,e)}catch(r){throw ew(t,r),r}finally{n.end&&n.end()}}function yp(i){!function gp(i){for(let t=0;t<i.components.length;t++){const e=i.components[t],n=KC(e),r=n[1];QO(r,n,r.template,e)}}(i[8])}function kM(i,t,e){zl(0),t(i,e)}const N_=(()=>Promise.resolve(null))();function Cm(i){return i[7]||(i[7]=[])}function Mm(i){return i.cleanup||(i.cleanup=[])}function Tm(i,t,e){return(null===i||qa(i))&&(e=function ha(i){for(;Array.isArray(i);){if("object"==typeof i[1])return i;i=i[0]}return null}(e[t.index])),e[11]}function ew(i,t){const e=i[9],n=e?e.get(fp,null):null;n&&n.handleError(t)}function PM(i,t,e,n,r){for(let s=0;s<e.length;){const a=e[s++],l=e[s++],u=t[a],h=i.data[a];null!==h.setInput?h.setInput(u,r,n,l):u[l]=r}}function kd(i,t,e){const n=da(t,i);!function UA(i,t,e){fo(i)?i.setValue(t,e):t.textContent=e}(i[11],n,e)}function H_(i,t,e){let n=e?i.styles:null,r=e?i.classes:null,s=0;if(null!==t)for(let a=0;a<t.length;a++){const l=t[a];"number"==typeof l?s=l:1==s?r=td(r,l):2==s&&(n=td(n,l+": "+t[++a]+";"))}e?i.styles=n:i.stylesWithoutHost=n,e?i.classes=r:i.classesWithoutHost=r}const lb=new gi("INJECTOR",-1);class iw{get(t,e=dp){if(e===dp){const n=new Error(`NullInjectorError: No provider for ${Us(t)}!`);throw n.name="NullInjectorError",n}return e}}const cb=new gi("Set Injector scope."),Em={},LM={};let OM;function Uo(){return void 0===OM&&(OM=new iw),OM}function Pd(i,t=null,e=null,n){const r=FM(i,t,e,n);return r._resolveInjectorDefTypes(),r}function FM(i,t=null,e=null,n){return new BM(i,e,t||Uo(),n)}class BM{constructor(t,e,n,r=null){this.parent=n,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const s=[];e&&Sd(e,l=>this.processProvider(l,t,e)),Sd([t],l=>this.processInjectorType(l,[],s)),this.records.set(lb,Id(void 0,this));const a=this.records.get(cb);this.scope=null!=a?a.value:null,this.source=r||("object"==typeof t?null:Us(t))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(t=>t.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(t,e=dp,n=wr.Default){this.assertNotDestroyed();const r=QL(this),s=Hu(void 0);try{if(!(n&wr.SkipSelf)){let l=this.records.get(t);if(void 0===l){const u=function Rm(i){return"function"==typeof i||"object"==typeof i&&i instanceof gi}(t)&&nm(t);l=u&&this.injectableDefInScope(u)?Id(nw(t),Em):null,this.records.set(t,l)}if(null!=l)return this.hydrate(t,l)}return(n&wr.Self?Uo():this.parent).get(t,e=n&wr.Optional&&e===dp?null:e)}catch(a){if("NullInjectorError"===a.name){if((a[_x]=a[_x]||[]).unshift(Us(t)),r)throw a;return function jz(i,t,e,n){const r=i[_x];throw t[KL]&&r.unshift(t[KL]),i.message=function qz(i,t,e,n=null){i=i&&"\n"===i.charAt(0)&&"\u0275"==i.charAt(1)?i.substr(2):i;let r=Us(t);if(Array.isArray(t))r=t.map(Us).join(" -> ");else if("object"==typeof t){let s=[];for(let a in t)if(t.hasOwnProperty(a)){let l=t[a];s.push(a+":"+("string"==typeof l?JSON.stringify(l):Us(l)))}r=`{${s.join(", ")}}`}return`${e}${n?"("+n+")":""}[${r}]: ${i.replace(Vz,"\n  ")}`}("\n"+i.message,r,e,n),i.ngTokenPath=r,i[_x]=null,i}(a,t,"R3InjectorError",this.source)}throw a}finally{Hu(s),QL(r)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(t=>this.get(t))}toString(){const t=[];return this.records.forEach((n,r)=>t.push(Us(r))),`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ln(205,!1)}processInjectorType(t,e,n){if(!(t=Br(t)))return!1;let r=K0(t);const s=null==r&&t.ngModule||void 0,a=void 0===s?t:s,l=-1!==n.indexOf(a);if(void 0!==s&&(r=K0(s)),null==r)return!1;if(null!=r.imports&&!l){let m;n.push(a);try{Sd(r.imports,_=>{this.processInjectorType(_,e,n)&&(void 0===m&&(m=[]),m.push(_))})}finally{}if(void 0!==m)for(let _=0;_<m.length;_++){const{ngModule:v,providers:S}=m[_];Sd(S,T=>this.processProvider(T,v,S||Gs))}}this.injectorDefTypes.add(a);const u=yu(a)||(()=>new a);this.records.set(a,Id(u,Em));const h=r.providers;if(null!=h&&!l){const m=t;Sd(h,_=>this.processProvider(_,m,h))}return void 0!==s&&void 0!==t.providers}processProvider(t,e,n){let r=Ld(t=Br(t))?t:Br(t&&t.provide);const s=function Am(i,t,e){return NM(i)?Id(void 0,i.useValue):Id(rw(i),Em)}(t);if(Ld(t)||!0!==t.multi)this.records.get(r);else{let a=this.records.get(r);a||(a=Id(void 0,Em,!0),a.factory=()=>fA(a.multi),this.records.set(r,a)),r=t,a.multi.push(t)}this.records.set(r,s)}hydrate(t,e){return e.value===Em&&(e.value=LM,e.value=e.factory()),"object"==typeof e.value&&e.value&&function hF(i){return null!==i&&"object"==typeof i&&"function"==typeof i.ngOnDestroy}(e.value)&&this.onDestroy.add(e.value),e.value}injectableDefInScope(t){if(!t.providedIn)return!1;const e=Br(t.providedIn);return"string"==typeof e?"any"===e||e===this.scope:this.injectorDefTypes.has(e)}}function nw(i){const t=nm(i),e=null!==t?t.factory:yu(i);if(null!==e)return e;if(i instanceof gi)throw new ln(204,!1);if(i instanceof Function)return function Eh(i){const t=i.length;if(t>0)throw Ev(t,"?"),new ln(204,!1);const e=function lv(i){const t=i&&(i[ip]||i[df]);if(t){const e=function jg(i){if(i.hasOwnProperty("name"))return i.name;const t=(""+i).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(i);return console.warn(`DEPRECATED: DI is instantiating a token "${e}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${e}" class.`),t}return null}(i);return null!==e?()=>e.factory(i):()=>new i}(i);throw new ln(204,!1)}function rw(i,t,e){let n;if(Ld(i)){const r=Br(i);return yu(r)||nw(r)}if(NM(i))n=()=>Br(i.useValue);else if(function Dm(i){return!(!i||!i.useFactory)}(i))n=()=>i.useFactory(...fA(i.deps||[]));else if(function V_(i){return!(!i||!i.useExisting)}(i))n=()=>Ve(Br(i.useExisting));else{const r=Br(i&&(i.useClass||i.provide));if(!function uF(i){return!!i.deps}(i))return yu(r)||nw(r);n=()=>new r(...fA(i.deps))}return n}function Id(i,t,e=!1){return{factory:i,value:t,multi:e?[]:void 0}}function NM(i){return null!==i&&"object"==typeof i&&Uz in i}function Ld(i){return"function"==typeof i}let Os=(()=>{class i{static create(e,n){var r;if(Array.isArray(e))return Pd({name:""},n,e,"");{const s=null!==(r=e.name)&&void 0!==r?r:"";return Pd({name:s},e.parent,e.providers,s)}}}return i.THROW_IF_NOT_FOUND=dp,i.NULL=new iw,i.\u0275prov=Nt({token:i,providedIn:"any",factory:()=>Ve(lb)}),i.__NG_ELEMENT_ID__=-1,i})();function UM(i,t){ax(KC(i)[1],rl())}function It(i){let t=function GM(i){return Object.getPrototypeOf(i.prototype).constructor}(i.type),e=!0;const n=[i];for(;t;){let r;if(qa(i))r=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new ln(903,"");r=t.\u0275dir}if(r){if(e){n.push(r);const a=i;a.inputs=dw(i.inputs),a.declaredInputs=dw(i.declaredInputs),a.outputs=dw(i.outputs);const l=r.hostBindings;l&&bD(i,l);const u=r.viewQuery,h=r.contentQueries;if(u&&mF(i,u),h&&gF(i,h),Ao(i.inputs,r.inputs),Ao(i.declaredInputs,r.declaredInputs),Ao(i.outputs,r.outputs),qa(r)&&r.data.animation){const m=i.data;m.animation=(m.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let a=0;a<s.length;a++){const l=s[a];l&&l.ngInherit&&l(i),l===It&&(e=!1)}}t=Object.getPrototypeOf(t)}!function WM(i){let t=0,e=null;for(let n=i.length-1;n>=0;n--){const r=i[n];r.hostVars=t+=r.hostVars,r.hostAttrs=ux(r.hostAttrs,e=ux(e,r.hostAttrs))}}(n)}function dw(i){return i===np?{}:i===Gs?[]:i}function mF(i,t){const e=i.viewQuery;i.viewQuery=e?(n,r)=>{t(n,r),e(n,r)}:t}function gF(i,t){const e=i.contentQueries;i.contentQueries=e?(n,r,s)=>{t(n,r,s),e(n,r,s)}:t}function bD(i,t){const e=i.hostBindings;i.hostBindings=e?(n,r)=>{t(n,r),e(n,r)}:t}let U_=null;function km(){if(!U_){const i=Ur.Symbol;if(i&&i.iterator)U_=i.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<t.length;++e){const n=t[e];"entries"!==n&&"size"!==n&&Map.prototype[n]===Map.prototype.entries&&(U_=n)}}}return U_}function G_(i){return!!Rf(i)&&(Array.isArray(i)||!(i instanceof Map)&&km()in i)}function Rf(i){return null!==i&&("function"==typeof i||"object"==typeof i)}function Bd(i,t,e){return i[t]=e}function cc(i,t,e){return!Object.is(i[t],e)&&(i[t]=e,!0)}function Tu(i,t,e,n){const r=cc(i,t,e);return cc(i,t+1,n)||r}function Vi(i,t,e,n){const r=Di();return cc(r,wf(),t)&&(Tr(),Cu(Ta(),r,i,t,e,n)),Vi}function vp(i,t,e,n){return cc(i,wf(),e)?t+yr(e)+n:$r}function ih(i,t,e,n,r,s){const l=Tu(i,function qu(){return Wr.lFrame.bindingIndex}(),e,r);return Xu(2),l?t+yr(e)+n+yr(r)+s:$r}function Ue(i,t,e,n,r,s,a,l){const u=Di(),h=Tr(),m=i+20,_=h.firstCreatePass?function _F(i,t,e,n,r,s,a,l,u){const h=t.consts,m=k_(t,i,4,a||null,Vc(h,l));MM(t,e,m,Vc(h,u)),ax(t,m);const _=m.tViews=tb(2,m,n,r,s,t.directiveRegistry,t.pipeRegistry,null,t.schemas,h);return null!==t.queries&&(t.queries.template(t,m),_.queries=t.queries.embeddedTView(m)),m}(m,h,u,t,e,n,r,s,a):h.data[m];ac(_,!1);const v=u[11].createComment("");v_(h,u,v,_),Tc(v,u),Mu(u,u[m]=AM(v,u,v,_)),ap(_)&&L_(h,u,_),null!=a&&eb(u,_,l)}function Yo(i){return Zn(function CC(){return Wr.lFrame.contextLView}(),20+i)}function _w(i){return i.length>1?" ("+function yF(i){const t=[];for(let e=0;e<i.length;++e){if(t.indexOf(i[e])>-1)return t.push(i[e]),t;t.push(i[e])}return t}(i.slice().reverse()).map(n=>Us(n.token)).join(" -> ")+")":""}function bp(i,t,e,n){const r=[t],s=e(r),a=n?function MO(i,t){const e=`${i} caused by: ${t instanceof Error?t.message:t}`,n=Error(e);return n[QC]=t,n}(s,n):Error(s);return a.addKey=ND,a.keys=r,a.injectors=[i],a.constructResolvingMessage=e,a[QC]=n,a}function ND(i,t){this.injectors.push(i),this.keys.push(t),this.message=this.constructResolvingMessage(this.keys)}function kf(i,t){const e=[];for(let n=0,r=t.length;n<r;n++){const s=t[n];e.push(s&&0!=s.length?s.map(Us).join(" "):"?")}return Error("Cannot resolve all parameters for '"+Us(i)+"'("+e.join(", ")+"). Make sure that all the parameters are decorated with Inject or have valid type annotations and that '"+Us(i)+"' is decorated with Injectable.")}function XM(i,t){return Error(`Cannot mix multi providers and regular providers, got: ${i} ${t}`)}class Pf{constructor(t,e){if(this.token=t,this.id=e,!t)throw new Error("Token must be defined!");this.displayName=Us(this.token)}static get(t){return UD.get(Br(t))}static get numberOfKeys(){return UD.numberOfKeys}}class zD{constructor(){this._allKeys=new Map}get(t){if(t instanceof Pf)return t;if(this._allKeys.has(t))return this._allKeys.get(t);const e=new Pf(t,Pf.numberOfKeys);return this._allKeys.set(t,e),e}get numberOfKeys(){return this._allKeys.size}}const UD=new zD;class bF{constructor(t){this.reflectionCapabilities=t}updateCapabilities(t){this.reflectionCapabilities=t}factory(t){return this.reflectionCapabilities.factory(t)}parameters(t){return this.reflectionCapabilities.parameters(t)}annotations(t){return this.reflectionCapabilities.annotations(t)}propMetadata(t){return this.reflectionCapabilities.propMetadata(t)}hasLifecycleHook(t,e){return this.reflectionCapabilities.hasLifecycleHook(t,e)}getter(t){return this.reflectionCapabilities.getter(t)}setter(t){return this.reflectionCapabilities.setter(t)}method(t){return this.reflectionCapabilities.method(t)}importUri(t){return this.reflectionCapabilities.importUri(t)}resourceUri(t){return this.reflectionCapabilities.resourceUri(t)}resolveIdentifier(t,e,n,r){return this.reflectionCapabilities.resolveIdentifier(t,e,n,r)}resolveEnum(t,e){return this.reflectionCapabilities.resolveEnum(t,e)}}const ZM=new bF(new dA);class fb{constructor(t,e,n){this.key=t,this.optional=e,this.visibility=n}static fromKey(t){return new fb(t,!1,null)}}const xF=[];class YM{constructor(t,e,n){this.key=t,this.resolvedFactories=e,this.multiProvider=n,this.resolvedFactory=this.resolvedFactories[0]}}class wF{constructor(t,e){this.factory=t,this.dependencies=e}}function GD(i){let t,e;if(i.useClass){const n=Br(i.useClass);t=ZM.factory(n),e=jD(n)}else i.useExisting?(t=n=>n,e=[fb.fromKey(Pf.get(i.useExisting))]):i.useFactory?(t=i.useFactory,e=function Aa(i,t){if(t){const e=t.map(n=>[n]);return t.map(n=>Da(i,n,e))}return jD(i)}(i.useFactory,i.deps)):(t=()=>i.useValue,e=xF);return new wF(t,e)}function bw(i){return new YM(Pf.get(i.provide),[GD(i)],i.multi||!1)}function WD(i){const n=function SF(i,t){for(let e=0;e<i.length;e++){const n=i[e],r=t.get(n.key.id);if(r){if(n.multiProvider!==r.multiProvider)throw XM(r,n);if(n.multiProvider)for(let s=0;s<n.resolvedFactories.length;s++)r.resolvedFactories.push(n.resolvedFactories[s]);else t.set(n.key.id,n)}else{let s;s=n.multiProvider?new YM(n.key,n.resolvedFactories.slice(),n.multiProvider):n,t.set(n.key.id,s)}}return t}(pb(i,[]).map(bw),new Map);return Array.from(n.values())}function pb(i,t){return i.forEach(e=>{if(e instanceof LC)t.push({provide:e,useClass:e});else if(e&&"object"==typeof e&&void 0!==e.provide)t.push(e);else{if(!Array.isArray(e))throw function vF(i){return Error(`Invalid provider - only instances of Provider and Type are allowed, got: ${i}`)}(e);pb(e,t)}}),t}function jD(i){const t=ZM.parameters(i);if(!t)return[];if(t.some(e=>null==e))throw kf(i,t);return t.map(e=>Da(i,e,t))}function Da(i,t,e){let n=null,r=!1;if(!Array.isArray(t))return Z_(t instanceof NC?t.token:t,r,null);let s=null;for(let a=0;a<t.length;++a){const l=t[a];l instanceof LC?n=l:l instanceof NC?n=l.token:l instanceof wh?r=!0:l instanceof pA||l instanceof mm?s=l:l instanceof gi&&(n=l)}if(n=Br(n),null!=n)return Z_(n,r,s);throw kf(i,e)}function Z_(i,t,e){return new fb(Pf.get(i),t,e)}const Y_={};class K_{static resolve(t){return WD(t)}static resolveAndCreate(t,e){const n=K_.resolve(t);return K_.fromResolvedProviders(n,e)}static fromResolvedProviders(t,e){return new CF(t,e)}}let CF=(()=>{class i{constructor(e,n){this._constructionCounter=0,this._providers=e,this.parent=n||null;const r=e.length;this.keyIds=[],this.objs=[];for(let s=0;s<r;s++)this.keyIds[s]=e[s].key.id,this.objs[s]=Y_}get(e,n=dp){return this._getByKey(Pf.get(e),null,n)}resolveAndCreateChild(e){const n=K_.resolve(e);return this.createChildFromResolved(n)}createChildFromResolved(e){const n=new i(e);return n.parent=this,n}resolveAndInstantiate(e){return this.instantiateResolved(K_.resolve([e])[0])}instantiateResolved(e){return this._instantiateProvider(e)}getProviderAtIndex(e){if(e<0||e>=this._providers.length)throw function vw(i){return Error(`Index ${i} is out-of-bounds.`)}(e);return this._providers[e]}_new(e){if(this._constructionCounter++>this._getMaxNumberOfObjects())throw function HD(i,t){return bp(i,t,function(e){return`Cannot instantiate cyclic dependency!${_w(e)}`})}(this,e.key);return this._instantiateProvider(e)}_getMaxNumberOfObjects(){return this.objs.length}_instantiateProvider(e){if(e.multiProvider){const n=[];for(let r=0;r<e.resolvedFactories.length;++r)n[r]=this._instantiate(e,e.resolvedFactories[r]);return n}return this._instantiate(e,e.resolvedFactories[0])}_instantiate(e,n){const r=n.factory;let s,a;try{s=n.dependencies.map(l=>this._getByReflectiveDependency(l))}catch(l){throw l.addKey&&l.addKey(this,e.key),l}try{a=r(...s)}catch(l){throw function VD(i,t,e,n){return bp(i,n,function(r){const s=Us(r[0].token);return`${t.message}: Error during instantiation of ${s}!${_w(r)}.`},t)}(this,l,0,e.key)}return a}_getByReflectiveDependency(e){return this._getByKey(e.key,e.visibility,e.optional?null:dp)}_getByKey(e,n,r){return e===i.INJECTOR_KEY?this:n instanceof pA?this._getByKeySelf(e,r):this._getByKeyDefault(e,r,n)}_getObjByKeyId(e){for(let n=0;n<this.keyIds.length;n++)if(this.keyIds[n]===e)return this.objs[n]===Y_&&(this.objs[n]=this._new(this._providers[n])),this.objs[n];return Y_}_throwOrNull(e,n){if(n!==dp)return n;throw function yw(i,t){return bp(i,t,function(e){return`No provider for ${Us(e[0].token)}!${_w(e)}`})}(this,e)}_getByKeySelf(e,n){const r=this._getObjByKeyId(e.id);return r!==Y_?r:this._throwOrNull(e,n)}_getByKeyDefault(e,n,r){let s;for(s=r instanceof mm?this.parent:this;s instanceof i;){const a=s,l=a._getObjByKeyId(e.id);if(l!==Y_)return l;s=a.parent}return null!==s?s.get(e.token,n):this._throwOrNull(e,n)}get displayName(){return`ReflectiveInjector(providers: [${function qD(i,t){const e=[];for(let n=0;n<i._providers.length;++n)e[n]=t(i.getProviderAtIndex(n));return e}(this,n=>' "'+n.key.displayName+'" ').join(", ")}])`}toString(){return this.displayName}}return i.INJECTOR_KEY=Pf.get(Os),i})();function B(i,t=wr.Default){const e=Di();return null===e?Ve(i,t):nA(rl(),e,Br(i),t)}function Nd(){throw new Error("invalid")}function fe(i,t,e){const n=Di();return cc(n,wf(),t)&&al(Tr(),Ta(),n,i,t,n[11],e,!1),fe}function xw(i,t,e,n,r){const a=r?"class":"style";PM(i,e,t.inputs[a],a,n)}function Z(i,t,e,n){const r=Di(),s=Tr(),a=20+i,l=r[11],u=r[a]=rM(l,t,function bv(){return Wr.lFrame.currentNamespace}()),h=s.firstCreatePass?function MF(i,t,e,n,r,s,a){const l=t.consts,h=k_(t,i,2,r,Vc(l,s));return MM(t,e,h,Vc(l,a)),null!==h.attrs&&H_(h,h.attrs,!1),null!==h.mergedAttrs&&H_(h,h.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,h),h}(a,s,r,0,t,e,n):s.data[a];ac(h,!0);const m=h.mergedAttrs;null!==m&&cx(l,u,m);const _=h.classes;null!==_&&Ed(l,u,_);const v=h.styles;return null!==v&&Ea(l,u,v),64!=(64&h.flags)&&v_(s,r,u,h),0===function WE(){return Wr.lFrame.elementDepthCount}()&&Tc(u,r),function TL(){Wr.lFrame.elementDepthCount++}(),ap(h)&&(L_(s,r,h),I_(s,h,r)),null!==n&&eb(r,h),Z}function J(){let i=rl();gd()?_d():(i=i.parent,ac(i,!1));const t=i;!function ju(){Wr.lFrame.elementDepthCount--}();const e=Tr();return e.firstCreatePass&&(ax(e,i),op(i)&&e.queries.elementEnd(i)),null!=t.classesWithoutHost&&function kL(i){return 0!=(16&i.flags)}(t)&&xw(e,t,Di(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function PL(i){return 0!=(32&i.flags)}(t)&&xw(e,t,Di(),t.stylesWithoutHost,!1),J}function yt(i,t,e,n){return Z(i,t,e,n),J(),yt}function Wo(i,t,e){const n=Di(),r=Tr(),s=i+20,a=r.firstCreatePass?function TF(i,t,e,n,r){const s=t.consts,a=Vc(s,n),l=k_(t,i,8,"ng-container",a);return null!==a&&H_(l,a,!0),MM(t,e,l,Vc(s,r)),null!==t.queries&&t.queries.elementStart(t,l),l}(s,r,n,t,e):r.data[s];ac(a,!0);const l=n[s]=n[11].createComment("");return v_(r,n,l,a),Tc(l,n),ap(a)&&(L_(r,n,a),I_(r,a,n)),null!=e&&eb(n,a),Wo}function jo(){let i=rl();const t=Tr();return gd()?_d():(i=i.parent,ac(i,!1)),t.firstCreatePass&&(ax(t,i),op(i)&&t.queries.elementEnd(i)),jo}function Hd(i,t,e){return Wo(i,t,e),jo(),Hd}function Wi(){return Di()}function mb(i){return!!i&&"function"==typeof i.then}function XD(i){return!!i&&"function"==typeof i.subscribe}const KM=XD;function je(i,t,e,n){const r=Di(),s=Tr(),a=rl();return ZD(s,r,r[11],a,i,t,!!e,n),je}function Q_(i,t){const e=rl(),n=Di(),r=Tr();return ZD(r,n,Tm(xh(r.data),e,n),e,i,t,!1),Q_}function ZD(i,t,e,n,r,s,a,l){const u=ap(n),m=i.firstCreatePass&&Mm(i),_=t[8],v=Cm(t);let S=!0;if(3&n.type||l){const j=fa(n,t),P=l?l(j):j,E=v.length,ie=l?ee=>l(zo(ee[n.index])):n.index;if(fo(e)){let ee=null;if(!l&&u&&(ee=function EF(i,t,e,n){const r=i.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const a=r[s];if(a===e&&r[s+1]===n){const l=t[7],u=r[s+2];return l.length>u?l[u]:null}"string"==typeof a&&(s+=2)}return null}(i,t,r,n.index)),null!==ee)(ee.__ngLastListenerFn__||ee).__ngNextListenerFn__=s,ee.__ngLastListenerFn__=s,S=!1;else{s=QM(n,t,_,s,!1);const ce=e.listen(P,r,s);v.push(s,ce),m&&m.push(r,ie,E,E+1)}}else s=QM(n,t,_,s,!0),P.addEventListener(r,s,a),v.push(s),m&&m.push(r,ie,E,a)}else s=QM(n,t,_,s,!1);const T=n.outputs;let I;if(S&&null!==T&&(I=T[r])){const j=I.length;if(j)for(let P=0;P<j;P+=2){const ye=t[I[P]][I[P+1]].subscribe(s),Ce=v.length;v.push(s,ye),m&&m.push(r,n.index,Ce,-(Ce+1))}}}function YD(i,t,e,n){try{return!1!==e(n)}catch(r){return ew(i,r),!1}}function QM(i,t,e,n,r){return function s(a){if(a===Function)return n;const l=2&i.flags?yl(i.index,t):t;0==(32&t[2])&&RM(l);let u=YD(t,0,n,a),h=s.__ngNextListenerFn__;for(;h;)u=YD(t,0,h,a)&&u,h=h.__ngNextListenerFn__;return r&&!1===u&&(a.preventDefault(),a.returnValue=!1),u}}function Re(i=1){return function sx(i){return(Wr.lFrame.contextLView=function r_(i,t){for(;i>0;)t=t[15],i--;return t}(i,Wr.lFrame.contextLView))[8]}(i)}function AF(i,t){let e=null;const n=function Ix(i){const t=i.attrs;if(null!=t){const e=t.indexOf(5);if(0==(1&e))return t[e+1]}return null}(i);for(let r=0;r<t.length;r++){const s=t[r];if("*"!==s){if(null===n?M_(i,s,!0):eD(n,s))return r}else e=r}return e}function As(i){const t=Di()[16][6];if(!t.projection){const n=t.projection=Ev(i?i.length:1,null),r=n.slice();let s=t.child;for(;null!==s;){const a=i?AF(s,i):0;null!==a&&(r[a]?r[a].projectionNext=s:n[a]=s,r[a]=s),s=s.next}}}function hr(i,t=0,e){const n=Di(),r=Tr(),s=k_(r,20+i,16,null,e||null);null===s.projection&&(s.projection=t),_d(),64!=(64&s.flags)&&function zv(i,t,e){x_(t[11],0,t,e,aM(i,e,t),YA(e.parent||t[6],e,t))}(r,n,s)}function _o(i,t,e){return Vd(i,"",t,"",e),_o}function Vd(i,t,e,n,r){const s=Di(),a=vp(s,t,e,n);return a!==$r&&al(Tr(),Ta(),s,i,a,s[11],r,!1),Vd}function rR(i,t,e,n,r){const s=i[e+1],a=null===t;let l=n?Ju(s):Ad(s),u=!1;for(;0!==l&&(!1===u||a);){const m=i[l+1];kF(i[l],t)&&(u=!0,i[l+1]=n?Ef(m):Tf(m)),l=n?Ju(m):Ad(m)}u&&(i[e+1]=n?Tf(s):Ef(s))}function kF(i,t){return null===i||null==t||(Array.isArray(i)?i[1]:i)===t||!(!Array.isArray(i)||"string"!=typeof t)&&d_(i,t)>=0}const xl={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function sR(i){return i.substring(xl.key,xl.keyEnd)}function oR(i,t){const e=xl.textEnd;return e===t?-1:(t=xl.keyEnd=function d(i,t,e){for(;t<e&&i.charCodeAt(t)>32;)t++;return t}(i,xl.key=t,e),c(i,t,e))}function c(i,t,e){for(;t<e&&i.charCodeAt(t)<=32;)t++;return t}function A(i,t,e){return le(i,t,e,!1),A}function N(i,t){return le(i,t,null,!0),N}function Y(i){Se(bu,ne,i,!0)}function ne(i,t){for(let e=function IF(i){return function o(i){xl.key=0,xl.keyEnd=0,xl.value=0,xl.valueEnd=0,xl.textEnd=i.length}(i),oR(i,c(i,0,xl.textEnd))}(t);e>=0;e=oR(t,e))bu(i,sR(t),!0)}function le(i,t,e,n){const r=Di(),s=Tr(),a=Xu(2);s.firstUpdatePass&&K(s,i,a,n),t!==$r&&cc(r,a,t)&&bt(s,s.data[Ul()],r,r[11],i,r[a+1]=function Qt(i,t){return null==i||("string"==typeof t?i+=t:"object"==typeof i&&(i=Us(Uc(i)))),i}(t,e),n,a)}function Se(i,t,e,n){const r=Tr(),s=Xu(2);r.firstUpdatePass&&K(r,null,s,n);const a=Di();if(e!==$r&&cc(a,s,e)){const l=r.data[Ul()];if(Ut(l,n)&&!re(r,s)){let u=n?l.classesWithoutHost:l.stylesWithoutHost;null!==u&&(e=td(u,e||"")),xw(r,l,a,e,n)}else!function Pe(i,t,e,n,r,s,a,l){r===$r&&(r=Gs);let u=0,h=0,m=0<r.length?r[0]:null,_=0<s.length?s[0]:null;for(;null!==m||null!==_;){const v=u<r.length?r[u+1]:void 0,S=h<s.length?s[h+1]:void 0;let I,T=null;m===_?(u+=2,h+=2,v!==S&&(T=_,I=S)):null===_||null!==m&&m<_?(u+=2,T=m):(h+=2,T=_,I=S),null!==T&&bt(i,t,e,n,T,I,a,l),m=u<r.length?r[u]:null,_=h<s.length?s[h]:null}}(r,l,a,a[11],a[s+1],a[s+1]=function ci(i,t,e){if(null==e||""===e)return Gs;const n=[],r=Uc(e);if(Array.isArray(r))for(let s=0;s<r.length;s++)i(n,r[s],!0);else if("object"==typeof r)for(const s in r)r.hasOwnProperty(s)&&i(n,s,r[s]);else"string"==typeof r&&t(n,r);return n}(i,t,e),n,s)}}function re(i,t){return t>=i.expandoStartIndex}function K(i,t,e,n){const r=i.data;if(null===r[e+1]){const s=r[Ul()],a=re(i,e);Ut(s,n)&&null===t&&!a&&(t=!1),t=function Oe(i,t,e,n){const r=xh(i);let s=n?t.residualClasses:t.residualStyles;if(null===r)0===(n?t.classBindings:t.styleBindings)&&(e=Et(e=ht(null,i,t,e,n),t.attrs,n),s=null);else{const a=t.directiveStylingLast;if(-1===a||i[a]!==r)if(e=ht(r,i,t,e,n),null===s){let u=function xe(i,t,e){const n=e?t.classBindings:t.styleBindings;if(0!==Ad(n))return i[Ju(n)]}(i,t,n);void 0!==u&&Array.isArray(u)&&(u=ht(null,i,t,u[1],n),u=Et(u,t.attrs,n),function ze(i,t,e,n){i[Ju(e?t.classBindings:t.styleBindings)]=n}(i,t,n,u))}else s=function $e(i,t,e){let n;const r=t.directiveEnd;for(let s=1+t.directiveStylingLast;s<r;s++)n=Et(n,i[s].hostAttrs,e);return Et(n,t.attrs,e)}(i,t,n)}return void 0!==s&&(n?t.residualClasses=s:t.residualStyles=s),e}(r,s,t,n),function DF(i,t,e,n,r,s){let a=s?t.classBindings:t.styleBindings,l=Ju(a),u=Ad(a);i[n]=e;let m,h=!1;if(Array.isArray(e)){const _=e;m=_[1],(null===m||d_(_,m)>0)&&(h=!0)}else m=e;if(r)if(0!==u){const v=Ju(i[l+1]);i[n+1]=Fx(v,l),0!==v&&(i[v+1]=fM(i[v+1],n)),i[l+1]=function Bx(i,t){return 131071&i|t<<17}(i[l+1],n)}else i[n+1]=Fx(l,0),0!==l&&(i[l+1]=fM(i[l+1],n)),l=n;else i[n+1]=Fx(u,0),0===l?l=n:i[u+1]=fM(i[u+1],n),u=n;h&&(i[n+1]=Tf(i[n+1])),rR(i,m,n,!0),rR(i,m,n,!1),function RF(i,t,e,n,r){const s=r?i.residualClasses:i.residualStyles;null!=s&&"string"==typeof t&&d_(s,t)>=0&&(e[n+1]=Ef(e[n+1]))}(t,m,i,n,s),a=Fx(l,u),s?t.classBindings=a:t.styleBindings=a}(r,s,t,e,a,n)}}function ht(i,t,e,n,r){let s=null;const a=e.directiveEnd;let l=e.directiveStylingLast;for(-1===l?l=e.directiveStart:l++;l<a&&(s=t[l],n=Et(n,s.hostAttrs,r),s!==i);)l++;return null!==i&&(e.directiveStylingLast=l),n}function Et(i,t,e){const n=e?1:2;let r=-1;if(null!==t)for(let s=0;s<t.length;s++){const a=t[s];"number"==typeof a?r=a:r===n&&(Array.isArray(i)||(i=void 0===i?[]:["",i]),bu(i,a,!!e||t[++s]))}return void 0===i?null:i}function bt(i,t,e,n,r,s,a,l){if(!(3&t.type))return;const u=i.data,h=u[l+1];zt(function Xv(i){return 1==(1&i)}(h)?Ft(u,t,e,r,Ad(h),a):void 0)||(zt(s)||function qv(i){return 2==(2&i)}(h)&&(s=Ft(u,null,e,r,l,a)),function vm(i,t,e,n,r){const s=fo(i);if(t)r?s?i.addClass(e,n):e.classList.add(n):s?i.removeClass(e,n):e.classList.remove(n);else{let a=-1===n.indexOf("-")?void 0:iu.DashCase;if(null==r)s?i.removeStyle(e,n,a):e.style.removeProperty(n);else{const l="string"==typeof r&&r.endsWith("!important");l&&(r=r.slice(0,-10),a|=iu.Important),s?i.setStyle(e,n,r,a):e.style.setProperty(n,r,l?"important":"")}}}(n,a,da(Ul(),e),r,s))}function Ft(i,t,e,n,r,s){const a=null===t;let l;for(;r>0;){const u=i[r],h=Array.isArray(u),m=h?u[1]:u,_=null===m;let v=e[r+1];v===$r&&(v=_?Gs:void 0);let S=_?OC(v,n):m===n?v:void 0;if(h&&!zt(S)&&(S=OC(u,n)),zt(S)&&(l=S,a))return l;const T=i[r+1];r=a?Ju(T):Ad(T)}if(null!==t){let u=s?t.residualClasses:t.residualStyles;null!=u&&(l=OC(u,n))}return l}function zt(i){return void 0!==i}function Ut(i,t){return 0!=(i.flags&(t?16:32))}function ue(i,t=""){const e=Di(),n=Tr(),r=i+20,s=n.firstCreatePass?k_(n,r,1,t,null):n.data[r],a=e[r]=function nM(i,t){return fo(i)?i.createText(t):i.createTextNode(t)}(e[11],t);v_(n,e,a,s),ac(s,!1)}function Xt(i){return ui("",i,""),Xt}function ui(i,t,e){const n=Di(),r=vp(n,i,t,e);return r!==$r&&kd(n,Ul(),r),ui}function hi(i,t,e,n,r){const s=Di(),a=ih(s,i,t,e,n,r);return a!==$r&&kd(s,Ul(),a),hi}function Nr(i,t,e){Se(bu,ne,vp(Di(),i,t,e),!0)}function dn(i,t,e){const n=Di();return cc(n,wf(),t)&&al(Tr(),Ta(),n,i,t,n[11],e,!0),dn}function Cr(i,t,e){const n=Di();if(cc(n,wf(),t)){const s=Tr(),a=Ta();al(s,a,n,i,t,Tm(xh(s.data),a,n),e,!0)}return Cr}const ww="en-US";let es=ww;function HF(i,t,e,n,r){if(i=Br(i),Array.isArray(i))for(let s=0;s<i.length;s++)HF(i[s],t,e,n,r);else{const s=Tr(),a=Di();let l=Ld(i)?i:Br(i.provide),u=rw(i);const h=rl(),m=1048575&h.providerIndexes,_=h.directiveStart,v=h.providerIndexes>>20;if(Ld(i)||!i.multi){const S=new xv(u,r,B),T=zF(l,t,r?m:m+v,_);-1===T?(fx(Sv(h,a),s,l),VF(s,i,t.length),t.push(l),h.directiveStart++,h.directiveEnd++,r&&(h.providerIndexes+=1048576),e.push(S),a.push(S)):(e[T]=S,a[T]=S)}else{const S=zF(l,t,m+v,_),T=zF(l,t,m,m+v),I=S>=0&&e[S],j=T>=0&&e[T];if(r&&!j||!r&&!I){fx(Sv(h,a),s,l);const P=function dte(i,t,e,n,r){const s=new xv(i,e,B);return s.multi=[],s.index=t,s.componentProviders=0,EU(s,r,n&&!e),s}(r?hte:ute,e.length,r,n,u);!r&&j&&(e[T].providerFactory=P),VF(s,i,t.length,0),t.push(l),h.directiveStart++,h.directiveEnd++,r&&(h.providerIndexes+=1048576),e.push(P),a.push(P)}else VF(s,i,S>-1?S:T,EU(e[r?T:S],u,!r&&n));!r&&n&&j&&e[T].componentProviders++}}}function VF(i,t,e,n){const r=Ld(t),s=function ub(i){return!!i.useClass}(t);if(r||s){const u=(s?Br(t.useClass):t).prototype.ngOnDestroy;if(u){const h=i.destroyHooks||(i.destroyHooks=[]);if(!r&&t.multi){const m=h.indexOf(e);-1===m?h.push(e,[n,u]):h[m+1].push(n,u)}else h.push(e,u)}}}function EU(i,t,e){return e&&i.componentProviders++,i.multi.push(t)-1}function zF(i,t,e,n){for(let r=e;r<n;r++)if(t[r]===i)return r;return-1}function ute(i,t,e,n){return UF(this.multi,[])}function hte(i,t,e,n){const r=this.multi;let s;if(this.providerFactory){const a=this.providerFactory.componentProviders,l=Cv(e,e[1],this.providerFactory.index,n);s=l.slice(0,a),UF(r,s);for(let u=a;u<l.length;u++)s.push(l[u])}else s=[],UF(r,s);return s}function UF(i,t){for(let e=0;e<i.length;e++)t.push((0,i[e])());return t}function Sn(i,t=[]){return e=>{e.providersResolver=(n,r)=>function cte(i,t,e){const n=Tr();if(n.firstCreatePass){const r=qa(i);HF(e,n.data,n.blueprint,r,!0),HF(t,n.data,n.blueprint,r,!1)}}(n,r?r(i):i,t)}}class AU{}class mte{resolveComponentFactory(t){throw function pte(i){const t=Error(`No component factory found for ${Us(i)}. Did you add it to @NgModule.entryComponents?`);return t.ngComponent=i,t}(t)}}let xp=(()=>{class i{}return i.NULL=new mte,i})();function gte(){return Cw(rl(),Di())}function Cw(i,t){return new ai(fa(i,t))}let ai=(()=>{class i{constructor(e){this.nativeElement=e}}return i.__NG_ELEMENT_ID__=gte,i})();function _te(i){return i instanceof ai?i.nativeElement:i}class e1{}let nu=(()=>{class i{}return i.__NG_ELEMENT_ID__=()=>function vte(){const i=Di(),e=yl(rl().index,i);return function yte(i){return i[11]}(Sc(e)?e:i)}(),i})(),bte=(()=>{class i{}return i.\u0275prov=Nt({token:i,providedIn:"root",factory:()=>null}),i})();class $_{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const xte=new $_("13.3.2"),GF={};function cR(i,t,e,n,r=!1){for(;null!==e;){const s=t[e.index];if(null!==s&&n.push(zo(s)),oc(s))for(let l=10;l<s.length;l++){const u=s[l],h=u[1].firstChild;null!==h&&cR(u[1],u,h,n)}const a=e.type;if(8&a)cR(i,t,e.child,n);else if(32&a){const l=Bv(e,t);let u;for(;u=l();)n.push(u)}else if(16&a){const l=QA(t,e);if(Array.isArray(l))n.push(...l);else{const u=Nv(t[16]);cR(u[1],u,l,n,!0)}}e=r?e.projectionNext:e.next}return n}class t1{constructor(t,e){this._lView=t,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const t=this._lView,e=t[1];return cR(e,t,e.firstChild,[])}get context(){return this._lView[8]}set context(t){this._lView[8]=t}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[3];if(oc(t)){const e=t[8],n=e?e.indexOf(this):-1;n>-1&&(sM(t,n),mx(e,n))}this._attachedToViewContainer=!1}qA(this._lView[1],this._lView)}onDestroy(t){CM(this._lView[1],this._lView,null,t)}markForCheck(){RM(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){_p(this._lView[1],this._lView,this.context)}checkNoChanges(){!function F_(i,t,e){dm(!0);try{_p(i,t,e)}finally{dm(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new ln(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function HO(i,t){b_(i,t,t[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new ln(902,"");this._appRef=t}}class wte extends t1{constructor(t){super(t),this._view=t}detectChanges(){yp(this._view)}checkNoChanges(){!function Sm(i){dm(!0);try{yp(i)}finally{dm(!1)}}(this._view)}get context(){return null}}class RU extends xp{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const e=pl(t);return new WF(e,this.ngModule)}}function kU(i){const t=[];for(let e in i)i.hasOwnProperty(e)&&t.push({propName:i[e],templateName:e});return t}class WF extends AU{constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=function Ox(i){return i.map(Lx).join(",")}(t.selectors),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!e}get inputs(){return kU(this.componentDef.inputs)}get outputs(){return kU(this.componentDef.outputs)}create(t,e,n,r){const s=(r=r||this.ngModule)?function Cte(i,t){return{get:(e,n,r)=>{const s=i.get(e,GF,r);return s!==GF||n===GF?s:t.get(e,n,r)}}}(t,r.injector):t,a=s.get(e1,bf),l=s.get(bte,null),u=a.createRenderer(null,this.componentDef),h=this.componentDef.selectors[0][0]||"div",m=n?function Qx(i,t,e){if(fo(i))return i.selectRootElement(t,e===Co.ShadowDom);let n="string"==typeof t?i.querySelector(t):t;return n.textContent="",n}(u,n,this.componentDef.encapsulation):rM(a.createRenderer(null,this.componentDef),h,function Ste(i){const t=i.toLowerCase();return"svg"===t?"svg":"math"===t?"math":null}(h)),_=this.componentDef.onPush?576:528,v=function uw(i,t){return{components:[],scheduler:i||PO,clean:N_,playerHandler:t||null,flags:0}}(),S=tb(0,null,null,1,0,null,null,null,null,null),T=Jv(null,S,v,_,null,null,a,u,l,s);let I,j;rx(T);try{const P=function lw(i,t,e,n,r,s){const a=e[1];e[20]=i;const u=k_(a,20,2,"#host",null),h=u.mergedAttrs=t.hostAttrs;null!==h&&(H_(u,h,!0),null!==i&&(cx(r,i,h),null!==u.classes&&Ed(r,i,u.classes),null!==u.styles&&Ea(r,i,u.styles)));const m=n.createRenderer(i,t),_=Jv(e,O_(t),null,t.onPush?64:16,e[20],u,n,m,s||null,null);return a.firstCreatePass&&(fx(Sv(u,e),a,t.type),wm(a,u),sb(u,e.length,1)),Mu(e,_),e[20]=_}(m,this.componentDef,T,a,u);if(m)if(n)cx(u,m,["ng-version",xte.full]);else{const{attrs:E,classes:ie}=function tD(i){const t=[],e=[];let n=1,r=2;for(;n<i.length;){let s=i[n];if("string"==typeof s)2===r?""!==s&&t.push(s,i[++n]):8===r&&e.push(s);else{if(!Qu(r))break;r=s}n++}return{attrs:t,classes:e}}(this.componentDef.selectors[0]);E&&cx(u,m,E),ie&&ie.length>0&&Ed(u,m,ie.join(" "))}if(j=xf(S,20),void 0!==e){const E=j.projection=[];for(let ie=0;ie<this.ngContentSelectors.length;ie++){const ee=e[ie];E.push(null!=ee?Array.from(ee):null)}}I=function cw(i,t,e,n,r){const s=e[1],a=function eF(i,t,e){const n=rl();i.firstCreatePass&&(e.providersResolver&&e.providersResolver(e),TM(i,n,t,Rd(i,t,1,null),e));const r=Cv(t,i,n.directiveStart,n);Tc(r,t);const s=fa(n,t);return s&&Tc(s,t),r}(s,e,t);if(n.components.push(a),i[8]=a,r&&r.forEach(u=>u(a,t)),t.contentQueries){const u=rl();t.contentQueries(1,a,u.directiveStart)}const l=rl();return!s.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(vd(l.index),lD(e[1],l,0,l.directiveStart,l.directiveEnd,t),Jx(t,a)),a}(P,this.componentDef,T,v,[UM]),$v(S,T,null)}finally{Sf()}return new Tte(this.componentType,I,Cw(j,T),T,j)}}class Tte extends class fte{}{constructor(t,e,n,r,s){super(),this.location=n,this._rootLView=r,this._tNode=s,this.instance=e,this.hostView=this.changeDetectorRef=new wte(r),this.componentType=t}get injector(){return new a_(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}class Bm{}class PU{}const Mw=new Map;class OU extends Bm{constructor(t,e){super(),this._parent=e,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new RU(this);const n=Bl(t);this._bootstrapComponents=Md(n.bootstrap),this._r3Injector=FM(t,e,[{provide:Bm,useValue:this},{provide:xp,useValue:this.componentFactoryResolver}],Us(t)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(t)}get(t,e=Os.THROW_IF_NOT_FOUND,n=wr.Default){return t===Os||t===Bm||t===lb?this:this._r3Injector.get(t,e,n)}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class jF extends PU{constructor(t){super(),this.moduleType=t,null!==Bl(t)&&function Ate(i){const t=new Set;!function e(n){const r=Bl(n,!0),s=r.id;null!==s&&(function IU(i,t,e){if(t&&t!==e)throw new Error(`Duplicate module registered for ${i} - ${Us(t)} vs ${Us(t.name)}`)}(s,Mw.get(s),n),Mw.set(s,n));const a=Md(r.imports);for(const l of a)t.has(l)||(t.add(l),e(l))}(i)}(t)}create(t){return new OU(this.moduleType,t)}}function n1(i,t,e){const n=Vl()+i,r=Di();return r[n]===$r?Bd(r,n,e?t.call(e):t()):function W_(i,t){return i[t]}(r,n)}function yb(i,t,e,n){return NU(Di(),Vl(),i,t,e,n)}function r1(i,t){const e=i[t];return e===$r?void 0:e}function NU(i,t,e,n,r,s){const a=t+e;return cc(i,a,r)?Bd(i,a+1,s?n.call(s,r):n(r)):r1(i,a+1)}function HU(i,t,e,n,r,s,a){const l=t+e;return Tu(i,l,r,s)?Bd(i,l+2,a?n.call(a,r,s):n(r,s)):r1(i,l+2)}function VU(i,t,e,n,r,s,a,l){const u=t+e;return function db(i,t,e,n,r){const s=Tu(i,t,e,n);return cc(i,t+2,r)||s}(i,u,r,s,a)?Bd(i,u+3,l?n.call(l,r,s,a):n(r,s,a)):r1(i,u+3)}function zU(i,t,e,n,r,s,a,l,u){const h=t+e;return function th(i,t,e,n,r,s){const a=Tu(i,t,e,n);return Tu(i,t+2,r,s)||a}(i,h,r,s,a,l)?Bd(i,h+4,u?n.call(u,r,s,a,l):n(r,s,a,l)):r1(i,h+4)}function ti(i,t){const e=Tr();let n;const r=i+20;e.firstCreatePass?(n=function Ote(i,t){if(t)for(let e=t.length-1;e>=0;e--){const n=t[e];if(i===n.name)return n}}(t,e.pipeRegistry),e.data[r]=n,n.onDestroy&&(e.destroyHooks||(e.destroyHooks=[])).push(r,n.onDestroy)):n=e.data[r];const s=n.factory||(n.factory=yu(n.type)),a=Hu(B);try{const l=hx(!1),u=s();return hx(l),function Go(i,t,e,n){e>=i.data.length&&(i.data[e]=null,i.blueprint[e]=null),t[e]=n}(e,Di(),r,u),u}finally{Hu(a)}}function Qi(i,t,e){const n=i+20,r=Di(),s=Zn(r,n);return s1(r,n)?NU(r,Vl(),t,s.transform,e,s):s.transform(e)}function Bs(i,t,e,n){const r=i+20,s=Di(),a=Zn(s,r);return s1(s,r)?HU(s,Vl(),t,a.transform,e,n,a):a.transform(e,n)}function Rh(i,t,e,n,r){const s=i+20,a=Di(),l=Zn(a,s);return s1(a,s)?VU(a,Vl(),t,l.transform,e,n,r,l):l.transform(e,n,r)}function uR(i,t,e,n,r,s){const a=i+20,l=Di(),u=Zn(l,a);return s1(l,a)?zU(l,Vl(),t,u.transform,e,n,r,s,u):u.transform(e,n,r,s)}function s1(i,t){return i[1].data[t].pure}function qF(i){return t=>{setTimeout(i,void 0,t)}}const Si=class Bte extends ii{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,n){var r,s,a;let l=t,u=e||(()=>null),h=n;if(t&&"object"==typeof t){const _=t;l=null===(r=_.next)||void 0===r?void 0:r.bind(_),u=null===(s=_.error)||void 0===s?void 0:s.bind(_),h=null===(a=_.complete)||void 0===a?void 0:a.bind(_)}this.__isAsync&&(u=qF(u),l&&(l=qF(l)),h&&(h=qF(h)));const m=super.subscribe({next:l,error:u,complete:h});return t instanceof Q&&t.add(m),m}};function Nte(){return this._results[km()]()}class ey{constructor(t=!1){this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const e=km(),n=ey.prototype;n[e]||(n[e]=Nte)}get changes(){return this._changes||(this._changes=new Si)}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,e){const n=this;n.dirty=!1;const r=Yu(t);(this._changesDetected=!function UL(i,t,e){if(i.length!==t.length)return!1;for(let n=0;n<i.length;n++){let r=i[n],s=t[n];if(e&&(r=e(r),s=e(s)),s!==r)return!1}return!0}(n._results,r,e))&&(n._results=r,n.length=r.length,n.last=r[this.length-1],n.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;let Xo=(()=>{class i{}return i.__NG_ELEMENT_ID__=zte,i})();const Hte=Xo,Vte=class extends Hte{constructor(t,e,n){super(),this._declarationLView=t,this._declarationTContainer=e,this.elementRef=n}createEmbeddedView(t){const e=this._declarationTContainer.tViews,n=Jv(this._declarationLView,e,t,16,null,e.declTNode,null,null,null,null);n[17]=this._declarationLView[this._declarationTContainer.index];const s=this._declarationLView[19];return null!==s&&(n[19]=s.createEmbeddedView(e)),$v(e,n,t),new t1(n)}};function zte(){return hR(rl(),Di())}function hR(i,t){return 4&i.type?new Vte(t,i,Cw(i,t)):null}let Ko=(()=>{class i{}return i.__NG_ELEMENT_ID__=Ute,i})();function Ute(){return jU(rl(),Di())}const Gte=Ko,GU=class extends Gte{constructor(t,e,n){super(),this._lContainer=t,this._hostTNode=e,this._hostLView=n}get element(){return Cw(this._hostTNode,this._hostLView)}get injector(){return new a_(this._hostTNode,this._hostLView)}get parentInjector(){const t=dx(this._hostTNode,this._hostLView);if(JE(t)){const e=o_(t,this._hostLView),n=s_(t);return new a_(e[1].data[n+8],e)}return new a_(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const e=WU(this._lContainer);return null!==e&&e[t]||null}get length(){return this._lContainer.length-10}createEmbeddedView(t,e,n){const r=t.createEmbeddedView(e||{});return this.insert(r,n),r}createComponent(t,e,n,r,s){const a=t&&!Tv(t);let l;if(a)l=e;else{const _=e||{};l=_.index,n=_.injector,r=_.projectableNodes,s=_.ngModuleRef}const u=a?t:new WF(pl(t)),h=n||this.parentInjector;if(!s&&null==u.ngModule){const v=(a?h:this.parentInjector).get(Bm,null);v&&(s=v)}const m=u.create(h,r,void 0,s);return this.insert(m.hostView,l),m}insert(t,e){const n=t._lView,r=n[1];if(function ix(i){return oc(i[3])}(n)){const m=this.indexOf(t);if(-1!==m)this.detach(m);else{const _=n[3],v=new GU(_,_[6],_[3]);v.detach(v.indexOf(t))}}const s=this._adjustIndex(e),a=this._lContainer;!function GA(i,t,e,n){const r=10+n,s=e.length;n>0&&(e[r-1][4]=t),n<s-10?(t[4]=e[r],lA(e,10+n,t)):(e.push(t),t[4]=null),t[3]=e;const a=t[17];null!==a&&e!==a&&function WA(i,t){const e=i[9];t[16]!==t[3][3][16]&&(i[2]=!0),null===e?i[9]=[t]:e.push(t)}(a,t);const l=t[19];null!==l&&l.insertView(i),t[2]|=128}(r,n,a,s);const l=cM(s,a),u=n[11],h=Vv(u,a[7]);return null!==h&&function NO(i,t,e,n,r,s){n[0]=r,n[6]=t,b_(i,n,e,1,r,s)}(r,a[6],u,n,h,l),t.attachToViewContainerRef(),lA(XF(a),s,t),t}move(t,e){return this.insert(t,e)}indexOf(t){const e=WU(this._lContainer);return null!==e?e.indexOf(t):-1}remove(t){const e=this._adjustIndex(t,-1),n=sM(this._lContainer,e);n&&(mx(XF(this._lContainer),e),qA(n[1],n))}detach(t){const e=this._adjustIndex(t,-1),n=sM(this._lContainer,e);return n&&null!=mx(XF(this._lContainer),e)?new t1(n):null}_adjustIndex(t,e=0){return null==t?this.length+e:t}};function WU(i){return i[8]}function XF(i){return i[8]||(i[8]=[])}function jU(i,t){let e;const n=t[i.index];if(oc(n))e=n;else{let r;if(8&i.type)r=zo(n);else{const s=t[11];r=s.createComment("");const a=fa(i,t);Td(s,Vv(s,a),r,function WO(i,t){return fo(i)?i.nextSibling(t):t.nextSibling}(s,a),!1)}t[i.index]=e=AM(n,t,r,i),Mu(t,e)}return new GU(e,i,t)}class ZF{constructor(t){this.queryList=t,this.matches=null}clone(){return new ZF(this.queryList)}setDirty(){this.queryList.setDirty()}}class YF{constructor(t=[]){this.queries=t}createEmbeddedView(t){const e=t.queries;if(null!==e){const n=null!==t.contentQueries?t.contentQueries[0]:e.length,r=[];for(let s=0;s<n;s++){const a=e.getByIndex(s);r.push(this.queries[a.indexInDeclarationView].clone())}return new YF(r)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let e=0;e<this.queries.length;e++)null!==KU(t,e).matches&&this.queries[e].setDirty()}}class qU{constructor(t,e,n=null){this.predicate=t,this.flags=e,this.read=n}}class KF{constructor(t=[]){this.queries=t}elementStart(t,e){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(t,e)}elementEnd(t){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(t)}embeddedTView(t){let e=null;for(let n=0;n<this.length;n++){const r=null!==e?e.length:0,s=this.getByIndex(n).embeddedTView(t,r);s&&(s.indexInDeclarationView=n,null!==e?e.push(s):e=[s])}return null!==e?new KF(e):null}template(t,e){for(let n=0;n<this.queries.length;n++)this.queries[n].template(t,e)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class QF{constructor(t,e=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(t,e){this.isApplyingToNode(e)&&this.matchTNode(t,e)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,e){this.elementStart(t,e)}embeddedTView(t,e){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,e),new QF(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const e=this._declarationNodeIndex;let n=t.parent;for(;null!==n&&8&n.type&&n.index!==e;)n=n.parent;return e===(null!==n?n.index:-1)}return this._appliesToNextNode}matchTNode(t,e){const n=this.metadata.predicate;if(Array.isArray(n))for(let r=0;r<n.length;r++){const s=n[r];this.matchTNodeWithReadOption(t,e,qte(e,s)),this.matchTNodeWithReadOption(t,e,px(e,t,s,!1,!1))}else n===Xo?4&e.type&&this.matchTNodeWithReadOption(t,e,-1):this.matchTNodeWithReadOption(t,e,px(e,t,n,!1,!1))}matchTNodeWithReadOption(t,e,n){if(null!==n){const r=this.metadata.read;if(null!==r)if(r===ai||r===Ko||r===Xo&&4&e.type)this.addMatch(e.index,-2);else{const s=px(e,t,r,!1,!1);null!==s&&this.addMatch(e.index,s)}else this.addMatch(e.index,n)}}addMatch(t,e){null===this.matches?this.matches=[t,e]:this.matches.push(t,e)}}function qte(i,t){const e=i.localNames;if(null!==e)for(let n=0;n<e.length;n+=2)if(e[n]===t)return e[n+1];return null}function Zte(i,t,e,n){return-1===e?function Xte(i,t){return 11&i.type?Cw(i,t):4&i.type?hR(i,t):null}(t,i):-2===e?function Yte(i,t,e){return e===ai?Cw(t,i):e===Xo?hR(t,i):e===Ko?jU(t,i):void 0}(i,t,n):Cv(i,i[1],e,t)}function XU(i,t,e,n){const r=t[19].queries[n];if(null===r.matches){const s=i.data,a=e.matches,l=[];for(let u=0;u<a.length;u+=2){const h=a[u];l.push(h<0?null:Zte(t,s[h],a[u+1],e.metadata.read))}r.matches=l}return r.matches}function JF(i,t,e,n){const r=i.queries.getByIndex(e),s=r.matches;if(null!==s){const a=XU(i,t,r,e);for(let l=0;l<s.length;l+=2){const u=s[l];if(u>0)n.push(a[l/2]);else{const h=s[l+1],m=t[-u];for(let _=10;_<m.length;_++){const v=m[_];v[17]===v[3]&&JF(v[1],v,h,n)}if(null!==m[9]){const _=m[9];for(let v=0;v<_.length;v++){const S=_[v];JF(S[1],S,h,n)}}}}}return n}function jt(i){const t=Di(),e=Tr(),n=fm();zl(n+1);const r=KU(e,n);if(i.dirty&&_v(t)===(2==(2&r.metadata.flags))){if(null===r.matches)i.reset([]);else{const s=r.crossesNgTemplate?JF(e,t,n,[]):XU(e,t,r,n);i.reset(s,_te),i.notifyOnChanges()}return!0}return!1}function ji(i,t,e){const n=Tr();n.firstCreatePass&&(YU(n,new qU(i,t,e),-1),2==(2&t)&&(n.staticViewQueries=!0)),ZU(n,Di(),t)}function Er(i,t,e,n){const r=Tr();if(r.firstCreatePass){const s=rl();YU(r,new qU(t,e,n),s.index),function Qte(i,t){const e=i.contentQueries||(i.contentQueries=[]);t!==(e.length?e[e.length-1]:-1)&&e.push(i.queries.length-1,t)}(r,i),2==(2&e)&&(r.staticContentQueries=!0)}ZU(r,Di(),e)}function qt(){return function Kte(i,t){return i[19].queries[t].queryList}(Di(),fm())}function ZU(i,t,e){const n=new ey(4==(4&e));CM(i,t,n,n.destroy),null===t[19]&&(t[19]=new YF),t[19].queries.push(new ZF(n))}function YU(i,t,e){null===i.queries&&(i.queries=new KF),i.queries.track(new QF(t,e))}function KU(i,t){return i.queries.getByIndex(t)}function QU(i,t){return hR(i,t)}function pR(...i){}const mR=new gi("Application Initializer");let s3=(()=>{class i{constructor(e){this.appInits=e,this.resolve=pR,this.reject=pR,this.initialized=!1,this.done=!1,this.donePromise=new Promise((n,r)=>{this.resolve=n,this.reject=r})}runInitializers(){if(this.initialized)return;const e=[],n=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const s=this.appInits[r]();if(mb(s))e.push(s);else if(KM(s)){const a=new Promise((l,u)=>{s.subscribe({complete:l,error:u})});e.push(a)}}Promise.all(e).then(()=>{n()}).catch(r=>{this.reject(r)}),0===e.length&&n(),this.initialized=!0}}return i.\u0275fac=function(e){return new(e||i)(Ve(mR,8))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const a1=new gi("AppId",{providedIn:"root",factory:function p8(){return`${o3()}${o3()}${o3()}`}});function o3(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const m8=new gi("Platform Initializer"),kh=new gi("Platform ID"),a3=new gi("appBootstrapListener");let g8=(()=>{class i{log(e){console.log(e)}warn(e){console.warn(e)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})();const Nm=new gi("LocaleId",{providedIn:"root",factory:()=>f_(Nm,wr.Optional|wr.SkipSelf)||function pie(){return"undefined"!=typeof $localize&&$localize.locale||ww}()});class gie{constructor(t,e){this.ngModuleFactory=t,this.componentFactories=e}}let _8=(()=>{class i{compileModuleSync(e){return new jF(e)}compileModuleAsync(e){return Promise.resolve(this.compileModuleSync(e))}compileModuleAndAllComponentsSync(e){const n=this.compileModuleSync(e),s=Md(Bl(e).declarations).reduce((a,l)=>{const u=pl(l);return u&&a.push(new WF(u)),a},[]);return new gie(n,s)}compileModuleAndAllComponentsAsync(e){return Promise.resolve(this.compileModuleAndAllComponentsSync(e))}clearCache(){}clearCacheFor(e){}getModuleId(e){}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const yie=(()=>Promise.resolve(0))();function l3(i){"undefined"==typeof Zone?yie.then(()=>{i&&i.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",i)}class Rn{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:n=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Si(!1),this.onMicrotaskEmpty=new Si(!1),this.onStable=new Si(!1),this.onError=new Si(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!n&&e,r.shouldCoalesceRunChangeDetection=n,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function vie(){let i=Ur.requestAnimationFrame,t=Ur.cancelAnimationFrame;if("undefined"!=typeof Zone&&i&&t){const e=i[Zone.__symbol__("OriginalDelegate")];e&&(i=e);const n=t[Zone.__symbol__("OriginalDelegate")];n&&(t=n)}return{nativeRequestAnimationFrame:i,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function wie(i){const t=()=>{!function xie(i){i.isCheckStableRunning||-1!==i.lastRequestAnimationFrameId||(i.lastRequestAnimationFrameId=i.nativeRequestAnimationFrame.call(Ur,()=>{i.fakeTopEventTask||(i.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{i.lastRequestAnimationFrameId=-1,u3(i),i.isCheckStableRunning=!0,c3(i),i.isCheckStableRunning=!1},void 0,()=>{},()=>{})),i.fakeTopEventTask.invoke()}),u3(i))}(i)};i._inner=i._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(e,n,r,s,a,l)=>{try{return y8(i),e.invokeTask(r,s,a,l)}finally{(i.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||i.shouldCoalesceRunChangeDetection)&&t(),v8(i)}},onInvoke:(e,n,r,s,a,l,u)=>{try{return y8(i),e.invoke(r,s,a,l,u)}finally{i.shouldCoalesceRunChangeDetection&&t(),v8(i)}},onHasTask:(e,n,r,s)=>{e.hasTask(r,s),n===r&&("microTask"==s.change?(i._hasPendingMicrotasks=s.microTask,u3(i),c3(i)):"macroTask"==s.change&&(i.hasPendingMacrotasks=s.macroTask))},onHandleError:(e,n,r,s)=>(e.handleError(r,s),i.runOutsideAngular(()=>i.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return"undefined"!=typeof Zone&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Rn.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(Rn.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(t,e,n){return this._inner.run(t,e,n)}runTask(t,e,n,r){const s=this._inner,a=s.scheduleEventTask("NgZoneEvent: "+r,t,bie,pR,pR);try{return s.runTask(a,e,n)}finally{s.cancelTask(a)}}runGuarded(t,e,n){return this._inner.runGuarded(t,e,n)}runOutsideAngular(t){return this._outer.run(t)}}const bie={};function c3(i){if(0==i._nesting&&!i.hasPendingMicrotasks&&!i.isStable)try{i._nesting++,i.onMicrotaskEmpty.emit(null)}finally{if(i._nesting--,!i.hasPendingMicrotasks)try{i.runOutsideAngular(()=>i.onStable.emit(null))}finally{i.isStable=!0}}}function u3(i){i.hasPendingMicrotasks=!!(i._hasPendingMicrotasks||(i.shouldCoalesceEventChangeDetection||i.shouldCoalesceRunChangeDetection)&&-1!==i.lastRequestAnimationFrameId)}function y8(i){i._nesting++,i.isStable&&(i.isStable=!1,i.onUnstable.emit(null))}function v8(i){i._nesting--,c3(i)}class Sie{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Si,this.onMicrotaskEmpty=new Si,this.onStable=new Si,this.onError=new Si}run(t,e,n){return t.apply(e,n)}runGuarded(t,e,n){return t.apply(e,n)}runOutsideAngular(t){return t()}runTask(t,e,n,r){return t.apply(e,n)}}let h3=(()=>{class i{constructor(e){this._ngZone=e,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Rn.assertNotInAngularZone(),l3(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())l3(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(n=>!n.updateCb||!n.updateCb(e)||(clearTimeout(n.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,n,r){let s=-1;n&&n>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==s),e(this._didWork,this.getPendingTasks())},n)),this._callbacks.push({doneCb:e,timeoutId:s,updateCb:r})}whenStable(e,n,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,n,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(e,n,r){return[]}}return i.\u0275fac=function(e){return new(e||i)(Ve(Rn))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})(),b8=(()=>{class i{constructor(){this._applications=new Map,d3.addToWindow(this)}registerApplication(e,n){this._applications.set(e,n)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,n=!0){return d3.findTestabilityInTree(this,e,n)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})();class Cie{addToWindow(t){}findTestabilityInTree(t,e,n){return null}}let Lf,d3=new Cie;const x8=new gi("AllowMultipleToken");class w8{constructor(t,e){this.name=t,this.token=e}}function S8(i,t,e=[]){const n=`Platform: ${t}`,r=new gi(n);return(s=[])=>{let a=C8();if(!a||a.injector.get(x8,!1))if(i)i(e.concat(s).concat({provide:r,useValue:!0}));else{const l=e.concat(s).concat({provide:r,useValue:!0},{provide:cb,useValue:"platform"});!function Aie(i){if(Lf&&!Lf.destroyed&&!Lf.injector.get(x8,!1))throw new ln(400,"");Lf=i.get(M8);const t=i.get(m8,null);t&&t.forEach(e=>e())}(Os.create({providers:l,name:n}))}return function Die(i){const t=C8();if(!t)throw new ln(401,"");return t}()}}function C8(){return Lf&&!Lf.destroyed?Lf:null}let M8=(()=>{class i{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,n){const l=function Rie(i,t){let e;return e="noop"===i?new Sie:("zone.js"===i?void 0:i)||new Rn({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==t?void 0:t.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==t?void 0:t.ngZoneRunCoalescing)}),e}(n?n.ngZone:void 0,{ngZoneEventCoalescing:n&&n.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:n&&n.ngZoneRunCoalescing||!1}),u=[{provide:Rn,useValue:l}];return l.run(()=>{const h=Os.create({providers:u,parent:this.injector,name:e.moduleType.name}),m=e.create(h),_=m.injector.get(fp,null);if(!_)throw new ln(402,"");return l.runOutsideAngular(()=>{const v=l.onError.subscribe({next:S=>{_.handleError(S)}});m.onDestroy(()=>{f3(this._modules,m),v.unsubscribe()})}),function kie(i,t,e){try{const n=e();return mb(n)?n.catch(r=>{throw t.runOutsideAngular(()=>i.handleError(r)),r}):n}catch(n){throw t.runOutsideAngular(()=>i.handleError(n)),n}}(_,l,()=>{const v=m.injector.get(s3);return v.runInitializers(),v.donePromise.then(()=>(function hs(i){Ga(i,"Expected localeId to be defined"),"string"==typeof i&&(es=i.toLowerCase().replace(/_/g,"-"))}(m.injector.get(Nm,ww)||ww),this._moduleDoBootstrap(m),m))})})}bootstrapModule(e,n=[]){const r=T8({},n);return function Tie(i,t,e){const n=new jF(e);return Promise.resolve(n)}(0,0,e).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(e){const n=e.injector.get(Ew);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(r=>n.bootstrap(r));else{if(!e.instance.ngDoBootstrap)throw new ln(403,"");e.instance.ngDoBootstrap(n)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new ln(404,"");this._modules.slice().forEach(e=>e.destroy()),this._destroyListeners.forEach(e=>e()),this._destroyed=!0}get destroyed(){return this._destroyed}}return i.\u0275fac=function(e){return new(e||i)(Ve(Os))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})();function T8(i,t){return Array.isArray(t)?t.reduce(T8,i):Object.assign(Object.assign({},i),t)}let Ew=(()=>{class i{constructor(e,n,r,s,a){this._zone=e,this._injector=n,this._exceptionHandler=r,this._componentFactoryResolver=s,this._initStatus=a,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const l=new ft(h=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{h.next(this._stable),h.complete()})}),u=new ft(h=>{let m;this._zone.runOutsideAngular(()=>{m=this._zone.onStable.subscribe(()=>{Rn.assertNotInAngularZone(),l3(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,h.next(!0))})})});const _=this._zone.onUnstable.subscribe(()=>{Rn.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{h.next(!1)}))});return()=>{m.unsubscribe(),_.unsubscribe()}});this.isStable=uo(l,u.pipe(yh()))}bootstrap(e,n){if(!this._initStatus.done)throw new ln(405,"");let r;r=e instanceof AU?e:this._componentFactoryResolver.resolveComponentFactory(e),this.componentTypes.push(r.componentType);const s=function Eie(i){return i.isBoundToModule}(r)?void 0:this._injector.get(Bm),l=r.create(Os.NULL,[],n||r.selector,s),u=l.location.nativeElement,h=l.injector.get(h3,null),m=h&&l.injector.get(b8);return h&&m&&m.registerApplication(u,h),l.onDestroy(()=>{this.detachView(l.hostView),f3(this.components,l),m&&m.unregisterApplication(u)}),this._loadComponent(l),l}tick(){if(this._runningTick)throw new ln(101,"");try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1}}attachView(e){const n=e;this._views.push(n),n.attachToAppRef(this)}detachView(e){const n=e;f3(this._views,n),n.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(a3,[]).concat(this._bootstrapListeners).forEach(r=>r(e))}ngOnDestroy(){this._views.slice().forEach(e=>e.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return i.\u0275fac=function(e){return new(e||i)(Ve(Rn),Ve(Os),Ve(fp),Ve(xp),Ve(s3))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function f3(i,t){const e=i.indexOf(t);e>-1&&i.splice(e,1)}let A8=!0,Pn=(()=>{class i{}return i.__NG_ELEMENT_ID__=Lie,i})();function Lie(i){return function Oie(i,t,e){if(gu(i)&&!e){const n=yl(i.index,t);return new t1(n,n)}return 47&i.type?new t1(t[16],t):null}(rl(),Di(),16==(16&i))}class I8{constructor(){}supports(t){return G_(t)}create(t){return new zie(t)}}const Vie=(i,t)=>t;class zie{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||Vie}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,n=this._removalsHead,r=0,s=null;for(;e||n;){const a=!n||e&&e.currentIndex<O8(n,r,s)?e:n,l=O8(a,r,s),u=a.currentIndex;if(a===n)r--,n=n._nextRemoved;else if(e=e._next,null==a.previousIndex)r++;else{s||(s=[]);const h=l-r,m=u-r;if(h!=m){for(let v=0;v<h;v++){const S=v<s.length?s[v]:s[v]=0,T=S+v;m<=T&&T<h&&(s[v]=S+1)}s[a.previousIndex]=m-h}}l!==u&&t(a,l,u)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!G_(t))throw new ln(900,"");return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let r,s,a,e=this._itHead,n=!1;if(Array.isArray(t)){this.length=t.length;for(let l=0;l<this.length;l++)s=t[l],a=this._trackByFn(l,s),null!==e&&Object.is(e.trackById,a)?(n&&(e=this._verifyReinsertion(e,s,a,l)),Object.is(e.item,s)||this._addIdentityChange(e,s)):(e=this._mismatch(e,s,a,l),n=!0),e=e._next}else r=0,function MD(i,t){if(Array.isArray(i))for(let e=0;e<i.length;e++)t(i[e]);else{const e=i[km()]();let n;for(;!(n=e.next()).done;)t(n.value)}}(t,l=>{a=this._trackByFn(r,l),null!==e&&Object.is(e.trackById,a)?(n&&(e=this._verifyReinsertion(e,l,a,r)),Object.is(e.item,l)||this._addIdentityChange(e,l)):(e=this._mismatch(e,l,a,r),n=!0),e=e._next,r++}),this.length=r;return this._truncate(e),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,n,r){let s;return null===t?s=this._itTail:(s=t._prev,this._remove(t)),null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,s,r)):null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,s,r)):t=this._addAfter(new Uie(e,n),s,r),t}_verifyReinsertion(t,e,n,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==s?t=this._reinsertAfter(s,t._prev,r):t.currentIndex!=r&&(t.currentIndex=r,this._addToMoves(t,r)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const r=t._prevRemoved,s=t._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(t,e,n),this._addToMoves(t,n),t}_moveAfter(t,e,n){return this._unlink(t),this._insertAfter(t,e,n),this._addToMoves(t,n),t}_addAfter(t,e,n){return this._insertAfter(t,e,n),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,n){const r=null===e?this._itHead:e._next;return t._next=r,t._prev=e,null===r?this._itTail=t:r._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new L8),this._linkedRecords.put(t),t.currentIndex=n,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,n=t._next;return null===e?this._itHead=n:e._next=n,null===n?this._itTail=e:n._prev=e,t}_addToMoves(t,e){return t.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new L8),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class Uie{constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class Gie{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let n;for(n=this._head;null!==n;n=n._nextDup)if((null===e||e<=n.currentIndex)&&Object.is(n.trackById,t))return n;return null}remove(t){const e=t._prevDup,n=t._nextDup;return null===e?this._head=n:e._nextDup=n,null===n?this._tail=e:n._prevDup=e,null===this._head}}class L8{constructor(){this.map=new Map}put(t){const e=t.trackById;let n=this.map.get(e);n||(n=new Gie,this.map.set(e,n)),n.add(t)}get(t,e){const r=this.map.get(t);return r?r.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function O8(i,t,e){const n=i.previousIndex;if(null===n)return n;let r=0;return e&&n<e.length&&(r=e[n]),n+t+r}class F8{constructor(){}supports(t){return t instanceof Map||Rf(t)}create(){return new Wie}}class Wie{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let e;for(e=this._mapHead;null!==e;e=e._next)t(e)}forEachPreviousItem(t){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)}forEachChangedItem(t){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}diff(t){if(t){if(!(t instanceof Map||Rf(t)))throw new ln(900,"")}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(t,(n,r)=>{if(e&&e.key===r)this._maybeAddToChanges(e,n),this._appendAfter=e,e=e._next;else{const s=this._getOrCreateRecordForKey(r,n);e=this._insertBeforeOrAppend(e,s)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let n=e;null!==n;n=n._nextRemoved)n===this._mapHead&&(this._mapHead=null),this._records.delete(n.key),n._nextRemoved=n._next,n.previousValue=n.currentValue,n.currentValue=null,n._prev=null,n._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,e){if(t){const n=t._prev;return e._next=t,e._prev=n,t._prev=e,n&&(n._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(t,e){if(this._records.has(t)){const r=this._records.get(t);this._maybeAddToChanges(r,e);const s=r._prev,a=r._next;return s&&(s._next=a),a&&(a._prev=s),r._next=null,r._prev=null,r}const n=new jie(t);return this._records.set(t,n),n.currentValue=e,this._addToAdditions(n),n}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,e){Object.is(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach(n=>e(t[n],n))}}class jie{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function B8(){return new wp([new I8])}let wp=(()=>{class i{constructor(e){this.factories=e}static create(e,n){if(null!=n){const r=n.factories.slice();e=e.concat(r)}return new i(e)}static extend(e){return{provide:i,useFactory:n=>i.create(e,n||B8()),deps:[[i,new mm,new wh]]}}find(e){const n=this.factories.find(r=>r.supports(e));if(null!=n)return n;throw new ln(901,"")}}return i.\u0275prov=Nt({token:i,providedIn:"root",factory:B8}),i})();function N8(){return new bb([new F8])}let bb=(()=>{class i{constructor(e){this.factories=e}static create(e,n){if(n){const r=n.factories.slice();e=e.concat(r)}return new i(e)}static extend(e){return{provide:i,useFactory:n=>i.create(e,n||N8()),deps:[[i,new mm,new wh]]}}find(e){const n=this.factories.find(s=>s.supports(e));if(n)return n;throw new ln(901,"")}}return i.\u0275prov=Nt({token:i,providedIn:"root",factory:N8}),i})();const Zie=S8(null,"core",[{provide:kh,useValue:"unknown"},{provide:M8,deps:[Os]},{provide:b8,deps:[]},{provide:g8,deps:[]}]);let Yie=(()=>{class i{constructor(e){}}return i.\u0275fac=function(e){return new(e||i)(Ve(Ew))},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({}),i})(),yR=null;function Sp(){return yR}const ar=new gi("DocumentToken");let xb=(()=>{class i{historyGo(e){throw new Error("Not implemented")}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Nt({token:i,factory:function(){return function $ie(){return Ve(H8)}()},providedIn:"platform"}),i})();const ene=new gi("Location Initialized");let H8=(()=>{class i extends xb{constructor(e){super(),this._doc=e,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Sp().getBaseHref(this._doc)}onPopState(e){const n=Sp().getGlobalEventTarget(this._doc,"window");return n.addEventListener("popstate",e,!1),()=>n.removeEventListener("popstate",e)}onHashChange(e){const n=Sp().getGlobalEventTarget(this._doc,"window");return n.addEventListener("hashchange",e,!1),()=>n.removeEventListener("hashchange",e)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(e){this.location.pathname=e}pushState(e,n,r){V8()?this._history.pushState(e,n,r):this.location.hash=r}replaceState(e,n,r){V8()?this._history.replaceState(e,n,r):this.location.hash=r}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}}return i.\u0275fac=function(e){return new(e||i)(Ve(ar))},i.\u0275prov=Nt({token:i,factory:function(){return function tne(){return new H8(Ve(ar))}()},providedIn:"platform"}),i})();function V8(){return!!window.history.pushState}function y3(i,t){if(0==i.length)return t;if(0==t.length)return i;let e=0;return i.endsWith("/")&&e++,t.startsWith("/")&&e++,2==e?i+t.substring(1):1==e?i+t:i+"/"+t}function z8(i){const t=i.match(/#|\?|$/),e=t&&t.index||i.length;return i.slice(0,e-("/"===i[e-1]?1:0))+i.slice(e)}function Hm(i){return i&&"?"!==i[0]?"?"+i:i}let Aw=(()=>{class i{historyGo(e){throw new Error("Not implemented")}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Nt({token:i,factory:function(){return function ine(i){const t=Ve(ar).location;return new U8(Ve(xb),t&&t.origin||"")}()},providedIn:"root"}),i})();const v3=new gi("appBaseHref");let U8=(()=>{class i extends Aw{constructor(e,n){if(super(),this._platformLocation=e,this._removeListenerFns=[],null==n&&(n=this._platformLocation.getBaseHrefFromDOM()),null==n)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=n}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return y3(this._baseHref,e)}path(e=!1){const n=this._platformLocation.pathname+Hm(this._platformLocation.search),r=this._platformLocation.hash;return r&&e?`${n}${r}`:n}pushState(e,n,r,s){const a=this.prepareExternalUrl(r+Hm(s));this._platformLocation.pushState(e,n,a)}replaceState(e,n,r,s){const a=this.prepareExternalUrl(r+Hm(s));this._platformLocation.replaceState(e,n,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(e=0){var n,r;null===(r=(n=this._platformLocation).historyGo)||void 0===r||r.call(n,e)}}return i.\u0275fac=function(e){return new(e||i)(Ve(xb),Ve(v3,8))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})(),nne=(()=>{class i extends Aw{constructor(e,n){super(),this._platformLocation=e,this._baseHref="",this._removeListenerFns=[],null!=n&&(this._baseHref=n)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){let n=this._platformLocation.hash;return null==n&&(n="#"),n.length>0?n.substring(1):n}prepareExternalUrl(e){const n=y3(this._baseHref,e);return n.length>0?"#"+n:n}pushState(e,n,r,s){let a=this.prepareExternalUrl(r+Hm(s));0==a.length&&(a=this._platformLocation.pathname),this._platformLocation.pushState(e,n,a)}replaceState(e,n,r,s){let a=this.prepareExternalUrl(r+Hm(s));0==a.length&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(e,n,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(e=0){var n,r;null===(r=(n=this._platformLocation).historyGo)||void 0===r||r.call(n,e)}}return i.\u0275fac=function(e){return new(e||i)(Ve(xb),Ve(v3,8))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})(),l1=(()=>{class i{constructor(e,n){this._subject=new Si,this._urlChangeListeners=[],this._platformStrategy=e;const r=this._platformStrategy.getBaseHref();this._platformLocation=n,this._baseHref=z8(G8(r)),this._platformStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}path(e=!1){return this.normalize(this._platformStrategy.path(e))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(e,n=""){return this.path()==this.normalize(e+Hm(n))}normalize(e){return i.stripTrailingSlash(function sne(i,t){return i&&t.startsWith(i)?t.substring(i.length):t}(this._baseHref,G8(e)))}prepareExternalUrl(e){return e&&"/"!==e[0]&&(e="/"+e),this._platformStrategy.prepareExternalUrl(e)}go(e,n="",r=null){this._platformStrategy.pushState(r,"",e,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Hm(n)),r)}replaceState(e,n="",r=null){this._platformStrategy.replaceState(r,"",e,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Hm(n)),r)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(e=0){var n,r;null===(r=(n=this._platformStrategy).historyGo)||void 0===r||r.call(n,e)}onUrlChange(e){this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(n=>{this._notifyUrlChangeListeners(n.url,n.state)}))}_notifyUrlChangeListeners(e="",n){this._urlChangeListeners.forEach(r=>r(e,n))}subscribe(e,n,r){return this._subject.subscribe({next:e,error:n,complete:r})}}return i.normalizeQueryParams=Hm,i.joinWithSlash=y3,i.stripTrailingSlash=z8,i.\u0275fac=function(e){return new(e||i)(Ve(Aw),Ve(xb))},i.\u0275prov=Nt({token:i,factory:function(){return function rne(){return new l1(Ve(Aw),Ve(xb))}()},providedIn:"root"}),i})();function G8(i){return i.replace(/\/index.html$/,"")}function J8(i,t){t=encodeURIComponent(t);for(const e of i.split(";")){const n=e.indexOf("="),[r,s]=-1==n?[e,""]:[e.slice(0,n),e.slice(n+1)];if(r.trim()===t)return decodeURIComponent(s)}return null}let Cp=(()=>{class i{constructor(e,n,r,s){this._iterableDiffers=e,this._keyValueDiffers=n,this._ngEl=r,this._renderer=s,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(G_(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){const e=this._keyValueDiffer.diff(this._rawClass);e&&this._applyKeyValueChanges(e)}}_applyKeyValueChanges(e){e.forEachAddedItem(n=>this._toggleClass(n.key,n.currentValue)),e.forEachChangedItem(n=>this._toggleClass(n.key,n.currentValue)),e.forEachRemovedItem(n=>{n.previousValue&&this._toggleClass(n.key,!1)})}_applyIterableChanges(e){e.forEachAddedItem(n=>{if("string"!=typeof n.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${Us(n.item)}`);this._toggleClass(n.item,!0)}),e.forEachRemovedItem(n=>this._toggleClass(n.item,!1))}_applyClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(n=>this._toggleClass(n,!0)):Object.keys(e).forEach(n=>this._toggleClass(n,!!e[n])))}_removeClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(n=>this._toggleClass(n,!1)):Object.keys(e).forEach(n=>this._toggleClass(n,!1)))}_toggleClass(e,n){(e=e.trim())&&e.split(/\s+/g).forEach(r=>{n?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}}return i.\u0275fac=function(e){return new(e||i)(B(wp),B(bb),B(ai),B(nu))},i.\u0275dir=Be({type:i,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),i})();class Gne{constructor(t,e,n,r){this.$implicit=t,this.ngForOf=e,this.index=n,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let mo=(()=>{class i{constructor(e,n,r){this._viewContainer=e,this._template=n,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const n=this._viewContainer;e.forEachOperation((r,s,a)=>{if(null==r.previousIndex)n.createEmbeddedView(this._template,new Gne(r.item,this._ngForOf,-1,-1),null===a?void 0:a);else if(null==a)n.remove(null===s?void 0:s);else if(null!==s){const l=n.get(s);n.move(l,a),$8(l,r)}});for(let r=0,s=n.length;r<s;r++){const l=n.get(r).context;l.index=r,l.count=s,l.ngForOf=this._ngForOf}e.forEachIdentityChange(r=>{$8(n.get(r.currentIndex),r)})}static ngTemplateContextGuard(e,n){return!0}}return i.\u0275fac=function(e){return new(e||i)(B(Ko),B(Xo),B(wp))},i.\u0275dir=Be({type:i,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),i})();function $8(i,t){i.context.$implicit=t.item}let ms=(()=>{class i{constructor(e,n){this._viewContainer=e,this._context=new Wne,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=n}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){e6("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){e6("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,n){return!0}}return i.\u0275fac=function(e){return new(e||i)(B(Ko),B(Xo))},i.\u0275dir=Be({type:i,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),i})();class Wne{constructor(){this.$implicit=null,this.ngIf=null}}function e6(i,t){if(t&&!t.createEmbeddedView)throw new Error(`${i} must be a TemplateRef, but received '${Us(t)}'.`)}class D3{constructor(t,e){this._viewContainerRef=t,this._templateRef=e,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(t){t&&!this._created?this.create():!t&&this._created&&this.destroy()}}let Dw=(()=>{class i{constructor(){this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(e){this._ngSwitch=e,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(e){this._defaultViews||(this._defaultViews=[]),this._defaultViews.push(e)}_matchCase(e){const n=e==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||n,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),n}_updateDefaultCases(e){if(this._defaultViews&&e!==this._defaultUsed){this._defaultUsed=e;for(let n=0;n<this._defaultViews.length;n++)this._defaultViews[n].enforceState(e)}}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275dir=Be({type:i,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"}}),i})(),AR=(()=>{class i{constructor(e,n,r){this.ngSwitch=r,r._addCase(),this._view=new D3(e,n)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return i.\u0275fac=function(e){return new(e||i)(B(Ko),B(Xo),B(Dw,9))},i.\u0275dir=Be({type:i,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"}}),i})(),t6=(()=>{class i{constructor(e,n,r){r._addDefault(new D3(e,n))}}return i.\u0275fac=function(e){return new(e||i)(B(Ko),B(Xo),B(Dw,9))},i.\u0275dir=Be({type:i,selectors:[["","ngSwitchDefault",""]]}),i})(),Rw=(()=>{class i{constructor(e,n,r){this._ngEl=e,this._differs=n,this._renderer=r,this._ngStyle=null,this._differ=null}set ngStyle(e){this._ngStyle=e,!this._differ&&e&&(this._differ=this._differs.find(e).create())}ngDoCheck(){if(this._differ){const e=this._differ.diff(this._ngStyle);e&&this._applyChanges(e)}}_setStyle(e,n){const[r,s]=e.split(".");null!=(n=null!=n&&s?`${n}${s}`:n)?this._renderer.setStyle(this._ngEl.nativeElement,r,n):this._renderer.removeStyle(this._ngEl.nativeElement,r)}_applyChanges(e){e.forEachRemovedItem(n=>this._setStyle(n.key,null)),e.forEachAddedItem(n=>this._setStyle(n.key,n.currentValue)),e.forEachChangedItem(n=>this._setStyle(n.key,n.currentValue))}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(bb),B(nu))},i.\u0275dir=Be({type:i,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"}}),i})(),n6=(()=>{class i{constructor(e){this._viewContainerRef=e,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null}ngOnChanges(e){if(e.ngTemplateOutlet){const n=this._viewContainerRef;this._viewRef&&n.remove(n.indexOf(this._viewRef)),this._viewRef=this.ngTemplateOutlet?n.createEmbeddedView(this.ngTemplateOutlet,this.ngTemplateOutletContext):null}else this._viewRef&&e.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return i.\u0275fac=function(e){return new(e||i)(B(Ko))},i.\u0275dir=Be({type:i,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet"},features:[Ls]}),i})();class qne{createSubscription(t,e){return t.subscribe({next:e,error:n=>{throw n}})}dispose(t){t.unsubscribe()}onDestroy(t){t.unsubscribe()}}class Xne{createSubscription(t,e){return t.then(e,n=>{throw n})}dispose(t){}onDestroy(t){}}const Zne=new Xne,Yne=new qne;let Xc=(()=>{class i{constructor(e){this._ref=e,this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null}ngOnDestroy(){this._subscription&&this._dispose()}transform(e){return this._obj?e!==this._obj?(this._dispose(),this.transform(e)):this._latestValue:(e&&this._subscribe(e),this._latestValue)}_subscribe(e){this._obj=e,this._strategy=this._selectStrategy(e),this._subscription=this._strategy.createSubscription(e,n=>this._updateLatestValue(e,n))}_selectStrategy(e){if(mb(e))return Zne;if(XD(e))return Yne;throw function Ff(i,t){return new ln(2100,"")}()}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(e,n){e===this._obj&&(this._latestValue=n,this._ref.markForCheck())}}return i.\u0275fac=function(e){return new(e||i)(B(Pn,16))},i.\u0275pipe=Hn({name:"async",type:i,pure:!1}),i})(),h1=(()=>{class i{constructor(e){this.differs=e,this.keyValues=[],this.compareFn=r6}transform(e,n=r6){if(!e||!(e instanceof Map)&&"object"!=typeof e)return null;this.differ||(this.differ=this.differs.find(e).create());const r=this.differ.diff(e),s=n!==this.compareFn;return r&&(this.keyValues=[],r.forEachItem(a=>{this.keyValues.push(function ore(i,t){return{key:i,value:t}}(a.key,a.currentValue))})),(r||s)&&(this.keyValues.sort(n),this.compareFn=n),this.keyValues}}return i.\u0275fac=function(e){return new(e||i)(B(bb,16))},i.\u0275pipe=Hn({name:"keyvalue",type:i,pure:!1}),i})();function r6(i,t){const e=i.key,n=t.key;if(e===n)return 0;if(void 0===e)return 1;if(void 0===n)return-1;if(null===e)return 1;if(null===n)return-1;if("string"==typeof e&&"string"==typeof n)return e<n?-1:1;if("number"==typeof e&&"number"==typeof n)return e-n;if("boolean"==typeof e&&"boolean"==typeof n)return e<n?-1:1;const r=String(e),s=String(n);return r==s?0:r<s?-1:1}let ka=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({}),i})();const s6="browser";function wb(i){return i===s6}function kw(i){return"server"===i}let pre=(()=>{class i{}return i.\u0275prov=Nt({token:i,providedIn:"root",factory:()=>new mre(Ve(ar),window)}),i})();class mre{constructor(t,e){this.document=t,this.window=e,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(t){this.supportsScrolling()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(!this.supportsScrolling())return;const e=function gre(i,t){const e=i.getElementById(t)||i.getElementsByName(t)[0];if(e)return e;if("function"==typeof i.createTreeWalker&&i.body&&(i.body.createShadowRoot||i.body.attachShadow)){const n=i.createTreeWalker(i.body,NodeFilter.SHOW_ELEMENT);let r=n.currentNode;for(;r;){const s=r.shadowRoot;if(s){const a=s.getElementById(t)||s.querySelector(`[name="${t}"]`);if(a)return a}r=n.nextNode()}}return null}(this.document,t);e&&(this.scrollToElement(e),e.focus())}setHistoryScrollRestoration(t){if(this.supportScrollRestoration()){const e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=t)}}scrollToElement(t){const e=t.getBoundingClientRect(),n=e.left+this.window.pageXOffset,r=e.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(n-s[0],r-s[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const t=o6(this.window.history)||o6(Object.getPrototypeOf(this.window.history));return!(!t||!t.writable&&!t.set)}catch(t){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(t){return!1}}}function o6(i){return Object.getOwnPropertyDescriptor(i,"scrollRestoration")}class a6{}class P3 extends class _re extends class Jie{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function Qie(i){yR||(yR=i)}(new P3)}onAndCancel(t,e,n){return t.addEventListener(e,n,!1),()=>{t.removeEventListener(e,n,!1)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getBaseHref(t){const e=function yre(){return d1=d1||document.querySelector("base"),d1?d1.getAttribute("href"):null}();return null==e?null:function vre(i){DR=DR||document.createElement("a"),DR.setAttribute("href",i);const t=DR.pathname;return"/"===t.charAt(0)?t:`/${t}`}(e)}resetBaseElement(){d1=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return J8(document.cookie,t)}}let DR,d1=null;const l6=new gi("TRANSITION_ID"),xre=[{provide:mR,useFactory:function bre(i,t,e){return()=>{e.get(s3).donePromise.then(()=>{const n=Sp(),r=t.querySelectorAll(`style[ng-transition="${i}"]`);for(let s=0;s<r.length;s++)n.remove(r[s])})}},deps:[l6,ar,Os],multi:!0}];class I3{static init(){!function Mie(i){d3=i}(new I3)}addToWindow(t){Ur.getAngularTestability=(n,r=!0)=>{const s=t.findTestabilityInTree(n,r);if(null==s)throw new Error("Could not find testability for element.");return s},Ur.getAllAngularTestabilities=()=>t.getAllTestabilities(),Ur.getAllAngularRootElements=()=>t.getAllRootElements(),Ur.frameworkStabilizers||(Ur.frameworkStabilizers=[]),Ur.frameworkStabilizers.push(n=>{const r=Ur.getAllAngularTestabilities();let s=r.length,a=!1;const l=function(u){a=a||u,s--,0==s&&n(a)};r.forEach(function(u){u.whenStable(l)})})}findTestabilityInTree(t,e,n){if(null==e)return null;const r=t.getTestability(e);return null!=r?r:n?Sp().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null}}let wre=(()=>{class i{build(){return new XMLHttpRequest}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})();const RR=new gi("EventManagerPlugins");let f1=(()=>{class i{constructor(e,n){this._zone=n,this._eventNameToPlugin=new Map,e.forEach(r=>r.manager=this),this._plugins=e.slice().reverse()}addEventListener(e,n,r){return this._findPluginFor(n).addEventListener(e,n,r)}addGlobalEventListener(e,n,r){return this._findPluginFor(n).addGlobalEventListener(e,n,r)}getZone(){return this._zone}_findPluginFor(e){const n=this._eventNameToPlugin.get(e);if(n)return n;const r=this._plugins;for(let s=0;s<r.length;s++){const a=r[s];if(a.supports(e))return this._eventNameToPlugin.set(e,a),a}throw new Error(`No event manager plugin found for event ${e}`)}}return i.\u0275fac=function(e){return new(e||i)(Ve(RR),Ve(Rn))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})();class c6{constructor(t){this._doc=t}addGlobalEventListener(t,e,n){const r=Sp().getGlobalEventTarget(this._doc,t);if(!r)throw new Error(`Unsupported event target ${r} for event ${e}`);return this.addEventListener(r,e,n)}}let u6=(()=>{class i{constructor(){this._stylesSet=new Set}addStyles(e){const n=new Set;e.forEach(r=>{this._stylesSet.has(r)||(this._stylesSet.add(r),n.add(r))}),this.onStylesAdded(n)}onStylesAdded(e){}getAllStyles(){return Array.from(this._stylesSet)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})(),p1=(()=>{class i extends u6{constructor(e){super(),this._doc=e,this._hostNodes=new Map,this._hostNodes.set(e.head,[])}_addStylesToHost(e,n,r){e.forEach(s=>{const a=this._doc.createElement("style");a.textContent=s,r.push(n.appendChild(a))})}addHost(e){const n=[];this._addStylesToHost(this._stylesSet,e,n),this._hostNodes.set(e,n)}removeHost(e){const n=this._hostNodes.get(e);n&&n.forEach(h6),this._hostNodes.delete(e)}onStylesAdded(e){this._hostNodes.forEach((n,r)=>{this._addStylesToHost(e,r,n)})}ngOnDestroy(){this._hostNodes.forEach(e=>e.forEach(h6))}}return i.\u0275fac=function(e){return new(e||i)(Ve(ar))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})();function h6(i){Sp().remove(i)}const L3={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},O3=/%COMP%/g;function kR(i,t,e){for(let n=0;n<t.length;n++){let r=t[n];Array.isArray(r)?kR(i,r,e):(r=r.replace(O3,i),e.push(r))}return e}function p6(i){return t=>{if("__ngUnwrap__"===t)return i;!1===i(t)&&(t.preventDefault(),t.returnValue=!1)}}let PR=(()=>{class i{constructor(e,n,r){this.eventManager=e,this.sharedStylesHost=n,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new F3(e)}createRenderer(e,n){if(!e||!n)return this.defaultRenderer;switch(n.encapsulation){case Co.Emulated:{let r=this.rendererByCompId.get(n.id);return r||(r=new Are(this.eventManager,this.sharedStylesHost,n,this.appId),this.rendererByCompId.set(n.id,r)),r.applyToHost(e),r}case 1:case Co.ShadowDom:return new Dre(this.eventManager,this.sharedStylesHost,e,n);default:if(!this.rendererByCompId.has(n.id)){const r=kR(n.id,n.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(n.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return i.\u0275fac=function(e){return new(e||i)(Ve(f1),Ve(p1),Ve(a1))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})();class F3{constructor(t){this.eventManager=t,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(t,e){return e?document.createElementNS(L3[e]||e,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,e){t.appendChild(e)}insertBefore(t,e,n){t&&t.insertBefore(e,n)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let n="string"==typeof t?document.querySelector(t):t;if(!n)throw new Error(`The selector "${t}" did not match any elements`);return e||(n.textContent=""),n}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,n,r){if(r){e=r+":"+e;const s=L3[r];s?t.setAttributeNS(s,e,n):t.setAttribute(e,n)}else t.setAttribute(e,n)}removeAttribute(t,e,n){if(n){const r=L3[n];r?t.removeAttributeNS(r,e):t.removeAttribute(`${n}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,n,r){r&(iu.DashCase|iu.Important)?t.style.setProperty(e,n,r&iu.Important?"important":""):t.style[e]=n}removeStyle(t,e,n){n&iu.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,n){t[e]=n}setValue(t,e){t.nodeValue=e}listen(t,e,n){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,p6(n)):this.eventManager.addEventListener(t,e,p6(n))}}class Are extends F3{constructor(t,e,n,r){super(t),this.component=n;const s=kR(r+"-"+n.id,n.styles,[]);e.addStyles(s),this.contentAttr=function Mre(i){return"_ngcontent-%COMP%".replace(O3,i)}(r+"-"+n.id),this.hostAttr=function Tre(i){return"_nghost-%COMP%".replace(O3,i)}(r+"-"+n.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,e){const n=super.createElement(t,e);return super.setAttribute(n,this.contentAttr,""),n}}class Dre extends F3{constructor(t,e,n,r){super(t),this.sharedStylesHost=e,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=kR(r.id,r.styles,[]);for(let a=0;a<s.length;a++){const l=document.createElement("style");l.textContent=s[a],this.shadowRoot.appendChild(l)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,n){return super.insertBefore(this.nodeOrShadowRoot(t),e,n)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}let Rre=(()=>{class i extends c6{constructor(e){super(e)}supports(e){return!0}addEventListener(e,n,r){return e.addEventListener(n,r,!1),()=>this.removeEventListener(e,n,r)}removeEventListener(e,n,r){return e.removeEventListener(n,r)}}return i.\u0275fac=function(e){return new(e||i)(Ve(ar))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})();const g6=["alt","control","meta","shift"],Pre={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},_6={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Ire={alt:i=>i.altKey,control:i=>i.ctrlKey,meta:i=>i.metaKey,shift:i=>i.shiftKey};let Lre=(()=>{class i extends c6{constructor(e){super(e)}supports(e){return null!=i.parseEventName(e)}addEventListener(e,n,r){const s=i.parseEventName(n),a=i.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Sp().onAndCancel(e,s.domEventName,a))}static parseEventName(e){const n=e.toLowerCase().split("."),r=n.shift();if(0===n.length||"keydown"!==r&&"keyup"!==r)return null;const s=i._normalizeKey(n.pop());let a="";if(g6.forEach(u=>{const h=n.indexOf(u);h>-1&&(n.splice(h,1),a+=u+".")}),a+=s,0!=n.length||0===s.length)return null;const l={};return l.domEventName=r,l.fullKey=a,l}static getEventFullKey(e){let n="",r=function Ore(i){let t=i.key;if(null==t){if(t=i.keyIdentifier,null==t)return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===i.location&&_6.hasOwnProperty(t)&&(t=_6[t]))}return Pre[t]||t}(e);return r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),g6.forEach(s=>{s!=r&&Ire[s](e)&&(n+=s+".")}),n+=r,n}static eventCallback(e,n,r){return s=>{i.getEventFullKey(s)===e&&r.runGuarded(()=>n(s))}}static _normalizeKey(e){return"esc"===e?"escape":e}}return i.\u0275fac=function(e){return new(e||i)(Ve(ar))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})();const Hre=S8(Zie,"browser",[{provide:kh,useValue:s6},{provide:m8,useValue:function Fre(){P3.makeCurrent(),I3.init()},multi:!0},{provide:ar,useFactory:function Nre(){return function Ln(i){on=i}(document),document},deps:[]}]),Vre=[{provide:cb,useValue:"root"},{provide:fp,useFactory:function Bre(){return new fp},deps:[]},{provide:RR,useClass:Rre,multi:!0,deps:[ar,Rn,kh]},{provide:RR,useClass:Lre,multi:!0,deps:[ar]},{provide:PR,useClass:PR,deps:[f1,p1,a1]},{provide:e1,useExisting:PR},{provide:u6,useExisting:p1},{provide:p1,useClass:p1,deps:[ar]},{provide:h3,useClass:h3,deps:[Rn]},{provide:f1,useClass:f1,deps:[RR,Rn]},{provide:a6,useClass:wre,deps:[]}];let Oo=(()=>{class i{constructor(e){if(e)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(e){return{ngModule:i,providers:[{provide:a1,useValue:e.appId},{provide:l6,useExisting:a1},xre]}}}return i.\u0275fac=function(e){return new(e||i)(Ve(i,12))},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({providers:Vre,imports:[ka,Yie]}),i})(),y6=(()=>{class i{constructor(e){this._doc=e}getTitle(){return this._doc.title}setTitle(e){this._doc.title=e||""}}return i.\u0275fac=function(e){return new(e||i)(Ve(ar))},i.\u0275prov=Nt({token:i,factory:function(e){let n=null;return n=e?new e:function Ure(){return new y6(Ve(ar))}(),n},providedIn:"root"}),i})();"undefined"!=typeof window&&window;let m1=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Nt({token:i,factory:function(e){let n=null;return n=e?new(e||i):Ve(x6),n},providedIn:"root"}),i})(),x6=(()=>{class i extends m1{constructor(e){super(),this._doc=e}sanitize(e,n){if(null==n)return null;switch(e){case so.NONE:return n;case so.HTML:return Cc(n,"HTML")?Uc(n):DA(this._doc,String(n)).toString();case so.STYLE:return Cc(n,"Style")?Uc(n):n;case so.SCRIPT:if(Cc(n,"Script"))return Uc(n);throw new Error("unsafe value used in a script context");case so.URL:return gm(n),Cc(n,"URL")?Uc(n):Pv(String(n));case so.RESOURCE_URL:if(Cc(n,"ResourceURL"))return Uc(n);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${e} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(e){return function yA(i){return new GC(i)}(e)}bypassSecurityTrustStyle(e){return function WC(i){return new kv(i)}(e)}bypassSecurityTrustScript(e){return function sO(i){return new gA(i)}(e)}bypassSecurityTrustUrl(e){return function vA(i){return new wx(i)}(e)}bypassSecurityTrustResourceUrl(e){return function Sx(i){return new _A(i)}(e)}}return i.\u0275fac=function(e){return new(e||i)(Ve(ar))},i.\u0275prov=Nt({token:i,factory:function(e){let n=null;return n=e?new e:function Kre(i){return new x6(i.get(ar))}(Ve(Os)),n},providedIn:"root"}),i})();function Qn(...i){return xr(i,tu(i))}function Pw(i,t){return z(t)?ks(i,t,1):ks(i,1)}function vr(i,t){return gr((e,n)=>{let r=0;e.subscribe(qn(n,s=>i.call(t,s,r++)&&n.next(s)))})}class w6{}class S6{}class Pa{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?()=>{this.headers=new Map,t.split("\n").forEach(e=>{const n=e.indexOf(":");if(n>0){const r=e.slice(0,n),s=r.toLowerCase(),a=e.slice(n+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(a):this.headers.set(s,[a])}})}:()=>{this.headers=new Map,Object.keys(t).forEach(e=>{let n=t[e];const r=e.toLowerCase();"string"==typeof n&&(n=[n]),n.length>0&&(this.headers.set(r,n),this.maybeSetNormalizedName(e,r))})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,e){return this.clone({name:t,value:e,op:"a"})}set(t,e){return this.clone({name:t,value:e,op:"s"})}delete(t,e){return this.clone({name:t,value:e,op:"d"})}maybeSetNormalizedName(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}init(){this.lazyInit&&(this.lazyInit instanceof Pa?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(e=>{this.headers.set(e,t.headers.get(e)),this.normalizedNames.set(e,t.normalizedNames.get(e))})}clone(t){const e=new Pa;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof Pa?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([t]),e}applyUpdate(t){const e=t.name.toLowerCase();switch(t.op){case"a":case"s":let n=t.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(t.name,e);const r=("a"===t.op?this.headers.get(e):void 0)||[];r.push(...n),this.headers.set(e,r);break;case"d":const s=t.value;if(s){let a=this.headers.get(e);if(!a)return;a=a.filter(l=>-1===s.indexOf(l)),0===a.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,a)}else this.headers.delete(e),this.normalizedNames.delete(e)}}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>t(this.normalizedNames.get(e),this.headers.get(e)))}}class Qre{encodeKey(t){return C6(t)}encodeValue(t){return C6(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}const $re=/%(\d[a-f0-9])/gi,ese={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function C6(i){return encodeURIComponent(i).replace($re,(t,e)=>{var n;return null!==(n=ese[e])&&void 0!==n?n:t})}function M6(i){return`${i}`}class oh{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new Qre,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function Jre(i,t){const e=new Map;return i.length>0&&i.replace(/^\?/,"").split("&").forEach(r=>{const s=r.indexOf("="),[a,l]=-1==s?[t.decodeKey(r),""]:[t.decodeKey(r.slice(0,s)),t.decodeValue(r.slice(s+1))],u=e.get(a)||[];u.push(l),e.set(a,u)}),e}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(e=>{const n=t.fromObject[e];this.map.set(e,Array.isArray(n)?n:[n])})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const e=this.map.get(t);return e?e[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,e){return this.clone({param:t,value:e,op:"a"})}appendAll(t){const e=[];return Object.keys(t).forEach(n=>{const r=t[n];Array.isArray(r)?r.forEach(s=>{e.push({param:n,value:s,op:"a"})}):e.push({param:n,value:r,op:"a"})}),this.clone(e)}set(t,e){return this.clone({param:t,value:e,op:"s"})}delete(t,e){return this.clone({param:t,value:e,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const e=this.encoder.encodeKey(t);return this.map.get(t).map(n=>e+"="+this.encoder.encodeValue(n)).join("&")}).filter(t=>""!==t).join("&")}clone(t){const e=new oh({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(t),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const e=("a"===t.op?this.map.get(t.param):void 0)||[];e.push(M6(t.value)),this.map.set(t.param,e);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let n=this.map.get(t.param)||[];const r=n.indexOf(M6(t.value));-1!==r&&n.splice(r,1),n.length>0?this.map.set(t.param,n):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}class Fr{constructor(){this.map=new Map}set(t,e){return this.map.set(t,e),this}get(t){return this.map.has(t)||this.map.set(t,t.defaultValue()),this.map.get(t)}delete(t){return this.map.delete(t),this}has(t){return this.map.has(t)}keys(){return this.map.keys()}}function T6(i){return"undefined"!=typeof ArrayBuffer&&i instanceof ArrayBuffer}function E6(i){return"undefined"!=typeof Blob&&i instanceof Blob}function A6(i){return"undefined"!=typeof FormData&&i instanceof FormData}class g1{constructor(t,e,n,r){let s;if(this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function tse(i){switch(i){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==n?n:null,s=r):s=n,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new Pa),this.context||(this.context=new Fr),this.params){const a=this.params.toString();if(0===a.length)this.urlWithParams=e;else{const l=e.indexOf("?");this.urlWithParams=e+(-1===l?"?":l<e.length-1?"&":"")+a}}else this.params=new oh,this.urlWithParams=e}serializeBody(){return null===this.body?null:T6(this.body)||E6(this.body)||A6(this.body)||function ise(i){return"undefined"!=typeof URLSearchParams&&i instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof oh?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||A6(this.body)?null:E6(this.body)?this.body.type||null:T6(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof oh?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(t={}){var e;const n=t.method||this.method,r=t.url||this.url,s=t.responseType||this.responseType,a=void 0!==t.body?t.body:this.body,l=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,u=void 0!==t.reportProgress?t.reportProgress:this.reportProgress;let h=t.headers||this.headers,m=t.params||this.params;const _=null!==(e=t.context)&&void 0!==e?e:this.context;return void 0!==t.setHeaders&&(h=Object.keys(t.setHeaders).reduce((v,S)=>v.set(S,t.setHeaders[S]),h)),t.setParams&&(m=Object.keys(t.setParams).reduce((v,S)=>v.set(S,t.setParams[S]),m)),new g1(n,r,a,{params:m,headers:h,context:_,reportProgress:u,responseType:s,withCredentials:l})}}var jl=(()=>((jl=jl||{})[jl.Sent=0]="Sent",jl[jl.UploadProgress=1]="UploadProgress",jl[jl.ResponseHeader=2]="ResponseHeader",jl[jl.DownloadProgress=3]="DownloadProgress",jl[jl.Response=4]="Response",jl[jl.User=5]="User",jl))();class N3{constructor(t,e=200,n="OK"){this.headers=t.headers||new Pa,this.status=void 0!==t.status?t.status:e,this.statusText=t.statusText||n,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}class H3 extends N3{constructor(t={}){super(t),this.type=jl.ResponseHeader}clone(t={}){return new H3({headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class IR extends N3{constructor(t={}){super(t),this.type=jl.Response,this.body=void 0!==t.body?t.body:null}clone(t={}){return new IR({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class D6 extends N3{constructor(t){super(t,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${t.url||"(unknown url)"}`:`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}}function V3(i,t){return{body:t,headers:i.headers,context:i.context,observe:i.observe,params:i.params,reportProgress:i.reportProgress,responseType:i.responseType,withCredentials:i.withCredentials}}let ma=(()=>{class i{constructor(e){this.handler=e}request(e,n,r={}){let s;if(e instanceof g1)s=e;else{let u,h;u=r.headers instanceof Pa?r.headers:new Pa(r.headers),r.params&&(h=r.params instanceof oh?r.params:new oh({fromObject:r.params})),s=new g1(e,n,void 0!==r.body?r.body:null,{headers:u,context:r.context,params:h,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const a=Qn(s).pipe(Pw(u=>this.handler.handle(u)));if(e instanceof g1||"events"===r.observe)return a;const l=a.pipe(vr(u=>u instanceof IR));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return l.pipe(Ui(u=>{if(null!==u.body&&!(u.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return u.body}));case"blob":return l.pipe(Ui(u=>{if(null!==u.body&&!(u.body instanceof Blob))throw new Error("Response is not a Blob.");return u.body}));case"text":return l.pipe(Ui(u=>{if(null!==u.body&&"string"!=typeof u.body)throw new Error("Response is not a string.");return u.body}));default:return l.pipe(Ui(u=>u.body))}case"response":return l;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(e,n={}){return this.request("DELETE",e,n)}get(e,n={}){return this.request("GET",e,n)}head(e,n={}){return this.request("HEAD",e,n)}jsonp(e,n){return this.request("JSONP",e,{params:(new oh).append(n,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,n={}){return this.request("OPTIONS",e,n)}patch(e,n,r={}){return this.request("PATCH",e,V3(r,n))}post(e,n,r={}){return this.request("POST",e,V3(r,n))}put(e,n,r={}){return this.request("PUT",e,V3(r,n))}}return i.\u0275fac=function(e){return new(e||i)(Ve(w6))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})();class R6{constructor(t,e){this.next=t,this.interceptor=e}handle(t){return this.interceptor.intercept(t,this.next)}}const k6=new gi("HTTP_INTERCEPTORS");let nse=(()=>{class i{intercept(e,n){return n.handle(e)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})();const rse=/^\)\]\}',?\n/;let P6=(()=>{class i{constructor(e){this.xhrFactory=e}handle(e){if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new ft(n=>{const r=this.xhrFactory.build();if(r.open(e.method,e.urlWithParams),e.withCredentials&&(r.withCredentials=!0),e.headers.forEach((S,T)=>r.setRequestHeader(S,T.join(","))),e.headers.has("Accept")||r.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){const S=e.detectContentTypeHeader();null!==S&&r.setRequestHeader("Content-Type",S)}if(e.responseType){const S=e.responseType.toLowerCase();r.responseType="json"!==S?S:"text"}const s=e.serializeBody();let a=null;const l=()=>{if(null!==a)return a;const S=r.statusText||"OK",T=new Pa(r.getAllResponseHeaders()),I=function sse(i){return"responseURL"in i&&i.responseURL?i.responseURL:/^X-Request-URL:/m.test(i.getAllResponseHeaders())?i.getResponseHeader("X-Request-URL"):null}(r)||e.url;return a=new H3({headers:T,status:r.status,statusText:S,url:I}),a},u=()=>{let{headers:S,status:T,statusText:I,url:j}=l(),P=null;204!==T&&(P=void 0===r.response?r.responseText:r.response),0===T&&(T=P?200:0);let E=T>=200&&T<300;if("json"===e.responseType&&"string"==typeof P){const ie=P;P=P.replace(rse,"");try{P=""!==P?JSON.parse(P):null}catch(ee){P=ie,E&&(E=!1,P={error:ee,text:P})}}E?(n.next(new IR({body:P,headers:S,status:T,statusText:I,url:j||void 0})),n.complete()):n.error(new D6({error:P,headers:S,status:T,statusText:I,url:j||void 0}))},h=S=>{const{url:T}=l(),I=new D6({error:S,status:r.status||0,statusText:r.statusText||"Unknown Error",url:T||void 0});n.error(I)};let m=!1;const _=S=>{m||(n.next(l()),m=!0);let T={type:jl.DownloadProgress,loaded:S.loaded};S.lengthComputable&&(T.total=S.total),"text"===e.responseType&&!!r.responseText&&(T.partialText=r.responseText),n.next(T)},v=S=>{let T={type:jl.UploadProgress,loaded:S.loaded};S.lengthComputable&&(T.total=S.total),n.next(T)};return r.addEventListener("load",u),r.addEventListener("error",h),r.addEventListener("timeout",h),r.addEventListener("abort",h),e.reportProgress&&(r.addEventListener("progress",_),null!==s&&r.upload&&r.upload.addEventListener("progress",v)),r.send(s),n.next({type:jl.Sent}),()=>{r.removeEventListener("error",h),r.removeEventListener("abort",h),r.removeEventListener("load",u),r.removeEventListener("timeout",h),e.reportProgress&&(r.removeEventListener("progress",_),null!==s&&r.upload&&r.upload.removeEventListener("progress",v)),r.readyState!==r.DONE&&r.abort()}})}}return i.\u0275fac=function(e){return new(e||i)(Ve(a6))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})();const z3=new gi("XSRF_COOKIE_NAME"),U3=new gi("XSRF_HEADER_NAME");class I6{}let ose=(()=>{class i{constructor(e,n,r){this.doc=e,this.platform=n,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=J8(e,this.cookieName),this.lastCookieString=e),this.lastToken}}return i.\u0275fac=function(e){return new(e||i)(Ve(ar),Ve(kh),Ve(z3))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})(),G3=(()=>{class i{constructor(e,n){this.tokenService=e,this.headerName=n}intercept(e,n){const r=e.url.toLowerCase();if("GET"===e.method||"HEAD"===e.method||r.startsWith("http://")||r.startsWith("https://"))return n.handle(e);const s=this.tokenService.getToken();return null!==s&&!e.headers.has(this.headerName)&&(e=e.clone({headers:e.headers.set(this.headerName,s)})),n.handle(e)}}return i.\u0275fac=function(e){return new(e||i)(Ve(I6),Ve(U3))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})(),ase=(()=>{class i{constructor(e,n){this.backend=e,this.injector=n,this.chain=null}handle(e){if(null===this.chain){const n=this.injector.get(k6,[]);this.chain=n.reduceRight((r,s)=>new R6(r,s),this.backend)}return this.chain.handle(e)}}return i.\u0275fac=function(e){return new(e||i)(Ve(S6),Ve(Os))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})(),lse=(()=>{class i{static disable(){return{ngModule:i,providers:[{provide:G3,useClass:nse}]}}static withOptions(e={}){return{ngModule:i,providers:[e.cookieName?{provide:z3,useValue:e.cookieName}:[],e.headerName?{provide:U3,useValue:e.headerName}:[]]}}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({providers:[G3,{provide:k6,useExisting:G3,multi:!0},{provide:I6,useClass:ose},{provide:z3,useValue:"XSRF-TOKEN"},{provide:U3,useValue:"X-XSRF-TOKEN"}]}),i})(),Iw=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({providers:[ma,{provide:w6,useClass:ase},P6,{provide:S6,useExisting:P6}],imports:[[lse.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),i})();const{isArray:cse}=Array,{getPrototypeOf:use,prototype:hse,keys:dse}=Object;function L6(i){if(1===i.length){const t=i[0];if(cse(t))return{args:t,keys:null};if(function fse(i){return i&&"object"==typeof i&&use(i)===hse}(t)){const e=dse(t);return{args:e.map(n=>t[n]),keys:e}}}return{args:i,keys:null}}const{isArray:pse}=Array;function W3(i){return Ui(t=>function mse(i,t){return pse(t)?i(...t):i(t)}(i,t))}function O6(i,t){return i.reduce((e,n,r)=>(e[n]=t[r],e),{})}function F6(...i){const t=Jp(i),{args:e,keys:n}=L6(i),r=new ft(s=>{const{length:a}=e;if(!a)return void s.complete();const l=new Array(a);let u=a,h=a;for(let m=0;m<a;m++){let _=!1;eo(e[m]).subscribe(qn(s,v=>{_||(_=!0,h--),l[m]=v},()=>u--,void 0,()=>{(!u||!_)&&(h||s.next(n?O6(n,l):l),s.complete())}))}});return t?r.pipe(W3(t)):r}let B6=(()=>{class i{constructor(e,n){this._renderer=e,this._elementRef=n,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(e,n){this._renderer.setProperty(this._elementRef.nativeElement,e,n)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}}return i.\u0275fac=function(e){return new(e||i)(B(nu),B(ai))},i.\u0275dir=Be({type:i}),i})(),Sb=(()=>{class i extends B6{}return i.\u0275fac=function(){let t;return function(n){return(t||(t=Ki(i)))(n||i)}}(),i.\u0275dir=Be({type:i,features:[It]}),i})();const Ac=new gi("NgValueAccessor"),_se={provide:Ac,useExisting:rs(()=>Bf),multi:!0},vse=new gi("CompositionEventMode");let Bf=(()=>{class i extends B6{constructor(e,n,r){super(e,n),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function yse(){const i=Sp()?Sp().getUserAgent():"";return/android (\d+)/.test(i.toLowerCase())}())}writeValue(e){this.setProperty("value",null==e?"":e)}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}return i.\u0275fac=function(e){return new(e||i)(B(nu),B(ai),B(vse,8))},i.\u0275dir=Be({type:i,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,n){1&e&&je("input",function(s){return n._handleInput(s.target.value)})("blur",function(){return n.onTouched()})("compositionstart",function(){return n._compositionStart()})("compositionend",function(s){return n._compositionEnd(s.target.value)})},features:[Sn([_se]),It]}),i})();function iy(i){return null==i||0===i.length}function H6(i){return null!=i&&"number"==typeof i.length}const Dc=new gi("NgValidators"),ny=new gi("NgAsyncValidators"),bse=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class j3{static min(t){return function V6(i){return t=>{if(iy(t.value)||iy(i))return null;const e=parseFloat(t.value);return!isNaN(e)&&e<i?{min:{min:i,actual:t.value}}:null}}(t)}static max(t){return function z6(i){return t=>{if(iy(t.value)||iy(i))return null;const e=parseFloat(t.value);return!isNaN(e)&&e>i?{max:{max:i,actual:t.value}}:null}}(t)}static required(t){return U6(t)}static requiredTrue(t){return function G6(i){return!0===i.value?null:{required:!0}}(t)}static email(t){return function W6(i){return iy(i.value)||bse.test(i.value)?null:{email:!0}}(t)}static minLength(t){return function j6(i){return t=>iy(t.value)||!H6(t.value)?null:t.value.length<i?{minlength:{requiredLength:i,actualLength:t.value.length}}:null}(t)}static maxLength(t){return function q6(i){return t=>H6(t.value)&&t.value.length>i?{maxlength:{requiredLength:i,actualLength:t.value.length}}:null}(t)}static pattern(t){return function X6(i){if(!i)return LR;let t,e;return"string"==typeof i?(e="","^"!==i.charAt(0)&&(e+="^"),e+=i,"$"!==i.charAt(i.length-1)&&(e+="$"),t=new RegExp(e)):(e=i.toString(),t=i),n=>{if(iy(n.value))return null;const r=n.value;return t.test(r)?null:{pattern:{requiredPattern:e,actualValue:r}}}}(t)}static nullValidator(t){return null}static compose(t){return $6(t)}static composeAsync(t){return eG(t)}}function U6(i){return iy(i.value)?{required:!0}:null}function LR(i){return null}function Z6(i){return null!=i}function Y6(i){const t=mb(i)?xr(i):i;return KM(t),t}function K6(i){let t={};return i.forEach(e=>{t=null!=e?Object.assign(Object.assign({},t),e):t}),0===Object.keys(t).length?null:t}function Q6(i,t){return t.map(e=>e(i))}function J6(i){return i.map(t=>function xse(i){return!i.validate}(t)?t:e=>t.validate(e))}function $6(i){if(!i)return null;const t=i.filter(Z6);return 0==t.length?null:function(e){return K6(Q6(e,t))}}function q3(i){return null!=i?$6(J6(i)):null}function eG(i){if(!i)return null;const t=i.filter(Z6);return 0==t.length?null:function(e){return F6(Q6(e,t).map(Y6)).pipe(Ui(K6))}}function X3(i){return null!=i?eG(J6(i)):null}function tG(i,t){return null===i?[t]:Array.isArray(i)?[...i,t]:[i,t]}function iG(i){return i._rawValidators}function nG(i){return i._rawAsyncValidators}function Z3(i){return i?Array.isArray(i)?i:[i]:[]}function OR(i,t){return Array.isArray(i)?i.includes(t):i===t}function rG(i,t){const e=Z3(t);return Z3(i).forEach(r=>{OR(e,r)||e.push(r)}),e}function sG(i,t){return Z3(t).filter(e=>!OR(i,e))}class oG{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=q3(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=X3(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t){this.control&&this.control.reset(t)}hasError(t,e){return!!this.control&&this.control.hasError(t,e)}getError(t,e){return this.control?this.control.getError(t,e):null}}class Nf extends oG{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class Au extends oG{get formDirective(){return null}get path(){return null}}class aG{constructor(t){this._cd=t}is(t){var e,n,r;return"submitted"===t?!!(null===(e=this._cd)||void 0===e?void 0:e.submitted):!!(null===(r=null===(n=this._cd)||void 0===n?void 0:n.control)||void 0===r?void 0:r[t])}}let ah=(()=>{class i extends aG{constructor(e){super(e)}}return i.\u0275fac=function(e){return new(e||i)(B(Nf,2))},i.\u0275dir=Be({type:i,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,n){2&e&&N("ng-untouched",n.is("untouched"))("ng-touched",n.is("touched"))("ng-pristine",n.is("pristine"))("ng-dirty",n.is("dirty"))("ng-valid",n.is("valid"))("ng-invalid",n.is("invalid"))("ng-pending",n.is("pending"))},features:[It]}),i})(),lG=(()=>{class i extends aG{constructor(e){super(e)}}return i.\u0275fac=function(e){return new(e||i)(B(Au,10))},i.\u0275dir=Be({type:i,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(e,n){2&e&&N("ng-untouched",n.is("untouched"))("ng-touched",n.is("touched"))("ng-pristine",n.is("pristine"))("ng-dirty",n.is("dirty"))("ng-valid",n.is("valid"))("ng-invalid",n.is("invalid"))("ng-pending",n.is("pending"))("ng-submitted",n.is("submitted"))},features:[It]}),i})();function _1(i,t){Q3(i,t),t.valueAccessor.writeValue(i.value),function Dse(i,t){t.valueAccessor.registerOnChange(e=>{i._pendingValue=e,i._pendingChange=!0,i._pendingDirty=!0,"change"===i.updateOn&&uG(i,t)})}(i,t),function kse(i,t){const e=(n,r)=>{t.valueAccessor.writeValue(n),r&&t.viewToModelUpdate(n)};i.registerOnChange(e),t._registerOnDestroy(()=>{i._unregisterOnChange(e)})}(i,t),function Rse(i,t){t.valueAccessor.registerOnTouched(()=>{i._pendingTouched=!0,"blur"===i.updateOn&&i._pendingChange&&uG(i,t),"submit"!==i.updateOn&&i.markAsTouched()})}(i,t),function Ase(i,t){if(t.valueAccessor.setDisabledState){const e=n=>{t.valueAccessor.setDisabledState(n)};i.registerOnDisabledChange(e),t._registerOnDestroy(()=>{i._unregisterOnDisabledChange(e)})}}(i,t)}function NR(i,t,e=!0){const n=()=>{};t.valueAccessor&&(t.valueAccessor.registerOnChange(n),t.valueAccessor.registerOnTouched(n)),VR(i,t),i&&(t._invokeOnDestroyCallbacks(),i._registerOnCollectionChange(()=>{}))}function HR(i,t){i.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function Q3(i,t){const e=iG(i);null!==t.validator?i.setValidators(tG(e,t.validator)):"function"==typeof e&&i.setValidators([e]);const n=nG(i);null!==t.asyncValidator?i.setAsyncValidators(tG(n,t.asyncValidator)):"function"==typeof n&&i.setAsyncValidators([n]);const r=()=>i.updateValueAndValidity();HR(t._rawValidators,r),HR(t._rawAsyncValidators,r)}function VR(i,t){let e=!1;if(null!==i){if(null!==t.validator){const r=iG(i);if(Array.isArray(r)&&r.length>0){const s=r.filter(a=>a!==t.validator);s.length!==r.length&&(e=!0,i.setValidators(s))}}if(null!==t.asyncValidator){const r=nG(i);if(Array.isArray(r)&&r.length>0){const s=r.filter(a=>a!==t.asyncValidator);s.length!==r.length&&(e=!0,i.setAsyncValidators(s))}}}const n=()=>{};return HR(t._rawValidators,n),HR(t._rawAsyncValidators,n),e}function uG(i,t){i._pendingDirty&&i.markAsDirty(),i.setValue(i._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(i._pendingValue),i._pendingChange=!1}function hG(i,t){Q3(i,t)}function J3(i,t){if(!i.hasOwnProperty("model"))return!1;const e=i.model;return!!e.isFirstChange()||!Object.is(t,e.currentValue)}function fG(i,t){i._syncPendingControls(),t.forEach(e=>{const n=e.control;"submit"===n.updateOn&&n._pendingChange&&(e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1)})}function $3(i,t){if(!t)return null;let e,n,r;return Array.isArray(t),t.forEach(s=>{s.constructor===Bf?e=s:function Lse(i){return Object.getPrototypeOf(i.constructor)===Sb}(s)?n=s:r=s}),r||n||e||null}function eB(i,t){const e=i.indexOf(t);e>-1&&i.splice(e,1)}const y1="VALID",zR="INVALID",Lw="PENDING",v1="DISABLED";function iB(i){return(UR(i)?i.validators:i)||null}function pG(i){return Array.isArray(i)?q3(i):i||null}function nB(i,t){return(UR(t)?t.asyncValidators:i)||null}function mG(i){return Array.isArray(i)?X3(i):i||null}function UR(i){return null!=i&&!Array.isArray(i)&&"object"==typeof i}const gG=i=>i instanceof GR,rB=i=>i instanceof oB;function _G(i){return gG(i)?i.value:i.getRawValue()}function yG(i,t){const e=rB(i),n=i.controls;if(!(e?Object.keys(n):n).length)throw new ln(1e3,"");if(!n[t])throw new ln(1001,"")}function vG(i,t){rB(i),i._forEachChild((n,r)=>{if(void 0===t[r])throw new ln(1002,"")})}class sB{constructor(t,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=t,this._rawAsyncValidators=e,this._composedValidatorFn=pG(this._rawValidators),this._composedAsyncValidatorFn=mG(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return this.status===y1}get invalid(){return this.status===zR}get pending(){return this.status==Lw}get disabled(){return this.status===v1}get enabled(){return this.status!==v1}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._rawValidators=t,this._composedValidatorFn=pG(t)}setAsyncValidators(t){this._rawAsyncValidators=t,this._composedAsyncValidatorFn=mG(t)}addValidators(t){this.setValidators(rG(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(rG(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(sG(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(sG(t,this._rawAsyncValidators))}hasValidator(t){return OR(this._rawValidators,t)}hasAsyncValidator(t){return OR(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status=Lw,!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=v1,this.errors=null,this._forEachChild(n=>{n.disable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:e})),this._onDisabledChange.forEach(n=>n(!0))}enable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=y1,this._forEachChild(n=>{n.enable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:e})),this._onDisabledChange.forEach(n=>n(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===y1||this.status===Lw)&&this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?v1:y1}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status=Lw,this._hasOwnPendingAsyncValidator=!0;const e=Y6(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(n=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(n,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(!1!==e.emitEvent)}get(t){return function Ose(i,t,e){if(null==t||(Array.isArray(t)||(t=t.split(e)),Array.isArray(t)&&0===t.length))return null;let n=i;return t.forEach(r=>{n=rB(n)?n.controls.hasOwnProperty(r)?n.controls[r]:null:(i=>i instanceof Bse)(n)&&n.at(r)||null}),n}(this,t,".")}getError(t,e){const n=e?this.get(e):this;return n&&n.errors?n.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new Si,this.statusChanges=new Si}_calculateStatus(){return this._allControlsDisabled()?v1:this.errors?zR:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Lw)?Lw:this._anyControlsHaveStatus(zR)?zR:y1}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_isBoxedValue(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){UR(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class GR extends sB{constructor(t=null,e,n){super(iB(e),nB(n,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),UR(e)&&e.initialValueIsDefault&&(this.defaultValue=this._isBoxedValue(t)?t.value:t)}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(n=>n(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=this.defaultValue,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){eB(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){eB(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){this._isBoxedValue(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}}class oB extends sB{constructor(t,e,n){super(iB(e),nB(n,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e,n={}){this.registerControl(t,e),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}removeControl(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(t,e,n={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){vG(this,t),Object.keys(t).forEach(n=>{yG(this,n),this.controls[n].setValue(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(Object.keys(t).forEach(n=>{this.controls[n]&&this.controls[n].patchValue(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t={},e={}){this._forEachChild((n,r)=>{n.reset(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,n)=>(t[n]=_G(e),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(e,n)=>!!n._syncPendingControls()||e);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(e=>{const n=this.controls[e];n&&t(n,e)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const e of Object.keys(this.controls)){const n=this.controls[e];if(this.contains(e)&&t(n))return!0}return!1}_reduceValue(){return this._reduceChildren({},(t,e,n)=>((e.enabled||this.disabled)&&(t[n]=e.value),t))}_reduceChildren(t,e){let n=t;return this._forEachChild((r,s)=>{n=e(n,r,s)}),n}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}}class Bse extends sB{constructor(t,e,n){super(iB(e),nB(n,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(t){return this.controls[t]}push(t,e={}){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(t,e,n={}){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:n.emitEvent})}removeAt(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(t,e,n={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),e&&(this.controls.splice(t,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,e={}){vG(this,t),t.forEach((n,r)=>{yG(this,r),this.at(r).setValue(n,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(t.forEach((n,r)=>{this.at(r)&&this.at(r).patchValue(n,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t=[],e={}){this._forEachChild((n,r)=>{n.reset(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(t=>_G(t))}clear(t={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:t.emitEvent}))}_syncPendingControls(){let t=this.controls.reduce((e,n)=>!!n._syncPendingControls()||e,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){this.controls.forEach((e,n)=>{t(e,n)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(e=>e.enabled&&t(e))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_allControlsDisabled(){for(const t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}}const Nse={provide:Au,useExisting:rs(()=>Cb)},b1=(()=>Promise.resolve(null))();let Cb=(()=>{class i extends Au{constructor(e,n){super(),this.submitted=!1,this._directives=new Set,this.ngSubmit=new Si,this.form=new oB({},q3(e),X3(n))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){b1.then(()=>{const n=this._findContainer(e.path);e.control=n.registerControl(e.name,e.control),_1(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){b1.then(()=>{const n=this._findContainer(e.path);n&&n.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){b1.then(()=>{const n=this._findContainer(e.path),r=new oB({});hG(r,e),n.registerControl(e.name,r),r.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){b1.then(()=>{const n=this._findContainer(e.path);n&&n.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,n){b1.then(()=>{this.form.get(e.path).setValue(n)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,fG(this.form,this._directives),this.ngSubmit.emit(e),!1}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}}return i.\u0275fac=function(e){return new(e||i)(B(Dc,10),B(ny,10))},i.\u0275dir=Be({type:i,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,n){1&e&&je("submit",function(s){return n.onSubmit(s)})("reset",function(){return n.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Sn([Nse]),It]}),i})();const Vse={provide:Nf,useExisting:rs(()=>lh)},wG=(()=>Promise.resolve(null))();let lh=(()=>{class i extends Nf{constructor(e,n,r,s,a){super(),this._changeDetectorRef=a,this.control=new GR,this._registered=!1,this.update=new Si,this._parent=e,this._setValidators(n),this._setAsyncValidators(r),this.valueAccessor=$3(0,s)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){const n=e.name.previousValue;this.formDirective.removeControl({name:n,path:this._getPath(n)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),J3(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){_1(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){wG.then(()=>{var n;this.control.setValue(e,{emitViewToModelChange:!1}),null===(n=this._changeDetectorRef)||void 0===n||n.markForCheck()})}_updateDisabled(e){const n=e.isDisabled.currentValue,r=""===n||n&&"false"!==n;wG.then(()=>{var s;r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),null===(s=this._changeDetectorRef)||void 0===s||s.markForCheck()})}_getPath(e){return this._parent?function BR(i,t){return[...t.path,i]}(e,this._parent):[e]}}return i.\u0275fac=function(e){return new(e||i)(B(Au,9),B(Dc,10),B(ny,10),B(Ac,10),B(Pn,8))},i.\u0275dir=Be({type:i,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Sn([Vse]),It,Ls]}),i})(),SG=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275dir=Be({type:i,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),i})();const zse={provide:Ac,useExisting:rs(()=>WR),multi:!0};let WR=(()=>{class i extends Sb{writeValue(e){this.setProperty("value",null==e?"":e)}registerOnChange(e){this.onChange=n=>{e(""==n?null:parseFloat(n))}}}return i.\u0275fac=function(){let t;return function(n){return(t||(t=Ki(i)))(n||i)}}(),i.\u0275dir=Be({type:i,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(e,n){1&e&&je("input",function(s){return n.onChange(s.target.value)})("blur",function(){return n.onTouched()})},features:[Sn([zse]),It]}),i})(),CG=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({}),i})();const aB=new gi("NgModelWithFormControlWarning"),jse={provide:Nf,useExisting:rs(()=>jR)};let jR=(()=>{class i extends Nf{constructor(e,n,r,s){super(),this._ngModelWarningConfig=s,this.update=new Si,this._ngModelWarningSent=!1,this._setValidators(e),this._setAsyncValidators(n),this.valueAccessor=$3(0,r)}set isDisabled(e){}ngOnChanges(e){if(this._isControlChanged(e)){const n=e.form.previousValue;n&&NR(n,this,!1),_1(this.form,this),this.control.disabled&&this.valueAccessor.setDisabledState&&this.valueAccessor.setDisabledState(!0),this.form.updateValueAndValidity({emitEvent:!1})}J3(e,this.viewModel)&&(this.form.setValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.form&&NR(this.form,this,!1)}get path(){return[]}get control(){return this.form}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_isControlChanged(e){return e.hasOwnProperty("form")}}return i._ngModelWarningSentOnce=!1,i.\u0275fac=function(e){return new(e||i)(B(Dc,10),B(ny,10),B(Ac,10),B(aB,8))},i.\u0275dir=Be({type:i,selectors:[["","formControl",""]],inputs:{form:["formControl","form"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},exportAs:["ngForm"],features:[Sn([jse]),It,Ls]}),i})();const qse={provide:Au,useExisting:rs(()=>Ow)};let Ow=(()=>{class i extends Au{constructor(e,n){super(),this.validators=e,this.asyncValidators=n,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new Si,this._setValidators(e),this._setAsyncValidators(n)}ngOnChanges(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(VR(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(e){const n=this.form.get(e.path);return _1(n,e),n.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),n}getControl(e){return this.form.get(e.path)}removeControl(e){NR(e.control||null,e,!1),eB(this.directives,e)}addFormGroup(e){this._setUpFormContainer(e)}removeFormGroup(e){this._cleanUpFormContainer(e)}getFormGroup(e){return this.form.get(e.path)}addFormArray(e){this._setUpFormContainer(e)}removeFormArray(e){this._cleanUpFormContainer(e)}getFormArray(e){return this.form.get(e.path)}updateModel(e,n){this.form.get(e.path).setValue(n)}onSubmit(e){return this.submitted=!0,fG(this.form,this.directives),this.ngSubmit.emit(e),!1}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_updateDomValue(){this.directives.forEach(e=>{const n=e.control,r=this.form.get(e.path);n!==r&&(NR(n||null,e),gG(r)&&(_1(r,e),e.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(e){const n=this.form.get(e.path);hG(n,e),n.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(e){if(this.form){const n=this.form.get(e.path);n&&function Pse(i,t){return VR(i,t)}(n,e)&&n.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){Q3(this.form,this),this._oldForm&&VR(this._oldForm,this)}_checkFormPresent(){}}return i.\u0275fac=function(e){return new(e||i)(B(Dc,10),B(ny,10))},i.\u0275dir=Be({type:i,selectors:[["","formGroup",""]],hostBindings:function(e,n){1&e&&je("submit",function(s){return n.onSubmit(s)})("reset",function(){return n.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Sn([qse]),It,Ls]}),i})(),Mb=(()=>{class i{constructor(){this._validator=LR}ngOnChanges(e){if(this.inputName in e){const n=this.normalizeInput(e[this.inputName].currentValue);this._enabled=this.enabled(n),this._validator=this._enabled?this.createValidator(n):LR,this._onChange&&this._onChange()}}validate(e){return this._validator(e)}registerOnValidatorChange(e){this._onChange=e}enabled(e){return null!=e}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275dir=Be({type:i,features:[Ls]}),i})();const soe={provide:Dc,useExisting:rs(()=>qR),multi:!0};let qR=(()=>{class i extends Mb{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=e=>function ioe(i){return null!=i&&!1!==i&&"false"!=`${i}`}(e),this.createValidator=e=>U6}enabled(e){return e}}return i.\u0275fac=function(){let t;return function(n){return(t||(t=Ki(i)))(n||i)}}(),i.\u0275dir=Be({type:i,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(e,n){2&e&&Vi("required",n._enabled?"":null)},inputs:{required:"required"},features:[Sn([soe]),It]}),i})(),HG=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[CG]]}),i})(),Za=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[HG]}),i})(),ZR=(()=>{class i{static withConfig(e){return{ngModule:i,providers:[{provide:aB,useValue:e.warnOnNgModelWithFormControl}]}}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[HG]}),i})();class VG{}const zm="*";function Xd(i,t){return{type:7,name:i,definitions:t,options:{}}}function ql(i,t=null){return{type:4,styles:t,timings:i}}function YR(i,t=null){return{type:3,steps:i,options:t}}function zG(i,t=null){return{type:2,steps:i,options:t}}function Xs(i){return{type:6,styles:i,offset:null}}function Cl(i,t,e){return{type:0,name:i,styles:t,options:e}}function Ml(i,t,e=null){return{type:1,expr:i,animation:t,options:e}}function x1(i=null){return{type:9,options:i}}function w1(i,t,e=null){return{type:11,selector:i,animation:t,options:e}}function UG(i){Promise.resolve(null).then(i)}class S1{constructor(t=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){UG(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this._started=!1}setPosition(t){this._position=this.totalTime?t*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(n=>n()),e.length=0}}class GG{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let e=0,n=0,r=0;const s=this.players.length;0==s?UG(()=>this._onFinish()):this.players.forEach(a=>{a.onDone(()=>{++e==s&&this._onFinish()}),a.onDestroy(()=>{++n==s&&this._onDestroy()}),a.onStart(()=>{++r==s&&this._onStart()})}),this.totalTime=this.players.reduce((a,l)=>Math.max(a,l.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const e=t*this.totalTime;this.players.forEach(n=>{const r=n.totalTime?Math.min(1,e/n.totalTime):1;n.setPosition(r)})}getPosition(){const t=this.players.reduce((e,n)=>null===e||n.totalTime>e.totalTime?n:e,null);return null!=t?t.getPosition():0}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(n=>n()),e.length=0}}const Qs=!1;function WG(i){return new ln(3e3,Qs)}function qoe(){return"undefined"!=typeof window&&void 0!==window.document}function fB(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function ry(i){switch(i.length){case 0:return new S1;case 1:return i[0];default:return new GG(i)}}function jG(i,t,e,n,r={},s={}){const a=[],l=[];let u=-1,h=null;if(n.forEach(m=>{const _=m.offset,v=_==u,S=v&&h||{};Object.keys(m).forEach(T=>{let I=T,j=m[T];if("offset"!==T)switch(I=t.normalizePropertyName(I,a),j){case"!":j=r[T];break;case zm:j=s[T];break;default:j=t.normalizeStyleValue(T,I,j,a)}S[I]=j}),v||l.push(S),h=S,u=_}),a.length)throw function Ooe(i){return new ln(3502,Qs)}();return l}function pB(i,t,e,n){switch(t){case"start":i.onStart(()=>n(e&&mB(e,"start",i)));break;case"done":i.onDone(()=>n(e&&mB(e,"done",i)));break;case"destroy":i.onDestroy(()=>n(e&&mB(e,"destroy",i)))}}function mB(i,t,e){const n=e.totalTime,s=gB(i.element,i.triggerName,i.fromState,i.toState,t||i.phaseName,null==n?i.totalTime:n,!!e.disabled),a=i._data;return null!=a&&(s._data=a),s}function gB(i,t,e,n,r="",s=0,a){return{element:i,triggerName:t,fromState:e,toState:n,phaseName:r,totalTime:s,disabled:!!a}}function Ph(i,t,e){let n;return i instanceof Map?(n=i.get(t),n||i.set(t,n=e)):(n=i[t],n||(n=i[t]=e)),n}function qG(i){const t=i.indexOf(":");return[i.substring(1,t),i.substr(t+1)]}let _B=(i,t)=>!1,XG=(i,t,e)=>[],ZG=null;function yB(i){const t=i.parentNode||i.host;return t===ZG?null:t}(fB()||"undefined"!=typeof Element)&&(qoe()?(ZG=(()=>document.documentElement)(),_B=(i,t)=>{for(;t;){if(t===i)return!0;t=yB(t)}return!1}):_B=(i,t)=>i.contains(t),XG=(i,t,e)=>{if(e)return Array.from(i.querySelectorAll(t));const n=i.querySelector(t);return n?[n]:[]});let Tb=null,YG=!1;function KG(i){Tb||(Tb=function Zoe(){return"undefined"!=typeof document?document.body:null}()||{},YG=!!Tb.style&&"WebkitAppearance"in Tb.style);let t=!0;return Tb.style&&!function Xoe(i){return"ebkit"==i.substring(1,6)}(i)&&(t=i in Tb.style,!t&&YG&&(t="Webkit"+i.charAt(0).toUpperCase()+i.substr(1)in Tb.style)),t}const QG=_B,JG=XG;let $G=(()=>{class i{validateStyleProperty(e){return KG(e)}matchesElement(e,n){return!1}containsElement(e,n){return QG(e,n)}getParentElement(e){return yB(e)}query(e,n,r){return JG(e,n,r)}computeStyle(e,n,r){return r||""}animate(e,n,r,s,a,l=[],u){return new S1(r,s)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})(),vB=(()=>{class i{}return i.NOOP=new $G,i})();const bB="ng-enter",QR="ng-leave",JR="ng-trigger",$R=".ng-trigger",tW="ng-animating",xB=".ng-animating";function Eb(i){if("number"==typeof i)return i;const t=i.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:wB(parseFloat(t[1]),t[2])}function wB(i,t){return"s"===t?1e3*i:i}function ek(i,t,e){return i.hasOwnProperty("duration")?i:function Qoe(i,t,e){let r,s=0,a="";if("string"==typeof i){const l=i.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===l)return t.push(WG()),{duration:0,delay:0,easing:""};r=wB(parseFloat(l[1]),l[2]);const u=l[3];null!=u&&(s=wB(parseFloat(u),l[4]));const h=l[5];h&&(a=h)}else r=i;if(!e){let l=!1,u=t.length;r<0&&(t.push(function foe(){return new ln(3100,Qs)}()),l=!0),s<0&&(t.push(function poe(){return new ln(3101,Qs)}()),l=!0),l&&t.splice(u,0,WG())}return{duration:r,delay:s,easing:a}}(i,t,e)}function Fw(i,t={}){return Object.keys(i).forEach(e=>{t[e]=i[e]}),t}function sy(i,t,e={}){if(t)for(let n in i)e[n]=i[n];else Fw(i,e);return e}function nW(i,t,e){return e?t+":"+e+";":""}function rW(i){let t="";for(let e=0;e<i.style.length;e++){const n=i.style.item(e);t+=nW(0,n,i.style.getPropertyValue(n))}for(const e in i.style)i.style.hasOwnProperty(e)&&!e.startsWith("_")&&(t+=nW(0,eae(e),i.style[e]));i.setAttribute("style",t)}function Mp(i,t,e){i.style&&(Object.keys(t).forEach(n=>{const r=CB(n);e&&!e.hasOwnProperty(n)&&(e[n]=i.style[r]),i.style[r]=t[n]}),fB()&&rW(i))}function Ab(i,t){i.style&&(Object.keys(t).forEach(e=>{const n=CB(e);i.style[n]=""}),fB()&&rW(i))}function C1(i){return Array.isArray(i)?1==i.length?i[0]:zG(i):i}const SB=new RegExp("{{\\s*(.+?)\\s*}}","g");function sW(i){let t=[];if("string"==typeof i){let e;for(;e=SB.exec(i);)t.push(e[1]);SB.lastIndex=0}return t}function tk(i,t,e){const n=i.toString(),r=n.replace(SB,(s,a)=>{let l=t[a];return t.hasOwnProperty(a)||(e.push(function goe(i){return new ln(3003,Qs)}()),l=""),l.toString()});return r==n?i:r}function ik(i){const t=[];let e=i.next();for(;!e.done;)t.push(e.value),e=i.next();return t}const $oe=/-+([a-z0-9])/g;function CB(i){return i.replace($oe,(...t)=>t[1].toUpperCase())}function eae(i){return i.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function Ih(i,t,e){switch(t.type){case 7:return i.visitTrigger(t,e);case 0:return i.visitState(t,e);case 1:return i.visitTransition(t,e);case 2:return i.visitSequence(t,e);case 3:return i.visitGroup(t,e);case 4:return i.visitAnimate(t,e);case 5:return i.visitKeyframes(t,e);case 6:return i.visitStyle(t,e);case 8:return i.visitReference(t,e);case 9:return i.visitAnimateChild(t,e);case 10:return i.visitAnimateRef(t,e);case 11:return i.visitQuery(t,e);case 12:return i.visitStagger(t,e);default:throw function _oe(i){return new ln(3004,Qs)}()}}function oW(i,t){return window.getComputedStyle(i)[t]}function oae(i,t){const e=[];return"string"==typeof i?i.split(/\s*,\s*/).forEach(n=>function aae(i,t,e){if(":"==i[0]){const u=function lae(i,t){switch(i){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,n)=>parseFloat(n)>parseFloat(e);case":decrement":return(e,n)=>parseFloat(n)<parseFloat(e);default:return t.push(function koe(i){return new ln(3016,Qs)}()),"* => *"}}(i,e);if("function"==typeof u)return void t.push(u);i=u}const n=i.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==n||n.length<4)return e.push(function Roe(i){return new ln(3015,Qs)}()),t;const r=n[1],s=n[2],a=n[3];t.push(aW(r,a));"<"==s[0]&&!("*"==r&&"*"==a)&&t.push(aW(a,r))}(n,e,t)):e.push(i),e}const ok=new Set(["true","1"]),ak=new Set(["false","0"]);function aW(i,t){const e=ok.has(i)||ak.has(i),n=ok.has(t)||ak.has(t);return(r,s)=>{let a="*"==i||i==r,l="*"==t||t==s;return!a&&e&&"boolean"==typeof r&&(a=r?ok.has(i):ak.has(i)),!l&&n&&"boolean"==typeof s&&(l=s?ok.has(t):ak.has(t)),a&&l}}const cae=new RegExp("s*:selfs*,?","g");function MB(i,t,e,n){return new uae(i).build(t,e,n)}class uae{constructor(t){this._driver=t}build(t,e,n){const r=new fae(e);this._resetContextStyleTimingState(r);const s=Ih(this,C1(t),r);return r.unsupportedCSSPropertiesFound.size&&r.unsupportedCSSPropertiesFound.keys(),s}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles={},t.collectedStyles[""]={},t.currentTime=0}visitTrigger(t,e){let n=e.queryCount=0,r=e.depCount=0;const s=[],a=[];return"@"==t.name.charAt(0)&&e.errors.push(function voe(){return new ln(3006,Qs)}()),t.definitions.forEach(l=>{if(this._resetContextStyleTimingState(e),0==l.type){const u=l,h=u.name;h.toString().split(/\s*,\s*/).forEach(m=>{u.name=m,s.push(this.visitState(u,e))}),u.name=h}else if(1==l.type){const u=this.visitTransition(l,e);n+=u.queryCount,r+=u.depCount,a.push(u)}else e.errors.push(function boe(){return new ln(3007,Qs)}())}),{type:7,name:t.name,states:s,transitions:a,queryCount:n,depCount:r,options:null}}visitState(t,e){const n=this.visitStyle(t.styles,e),r=t.options&&t.options.params||null;if(n.containsDynamicStyles){const s=new Set,a=r||{};n.styles.forEach(l=>{if(lk(l)){const u=l;Object.keys(u).forEach(h=>{sW(u[h]).forEach(m=>{a.hasOwnProperty(m)||s.add(m)})})}}),s.size&&(ik(s.values()),e.errors.push(function xoe(i,t){return new ln(3008,Qs)}()))}return{type:0,name:t.name,style:n,options:r?{params:r}:null}}visitTransition(t,e){e.queryCount=0,e.depCount=0;const n=Ih(this,C1(t.animation),e);return{type:1,matchers:oae(t.expr,e.errors),animation:n,queryCount:e.queryCount,depCount:e.depCount,options:Db(t.options)}}visitSequence(t,e){return{type:2,steps:t.steps.map(n=>Ih(this,n,e)),options:Db(t.options)}}visitGroup(t,e){const n=e.currentTime;let r=0;const s=t.steps.map(a=>{e.currentTime=n;const l=Ih(this,a,e);return r=Math.max(r,e.currentTime),l});return e.currentTime=r,{type:3,steps:s,options:Db(t.options)}}visitAnimate(t,e){const n=function mae(i,t){if(i.hasOwnProperty("duration"))return i;if("number"==typeof i)return TB(ek(i,t).duration,0,"");const e=i;if(e.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=TB(0,0,"");return s.dynamic=!0,s.strValue=e,s}const r=ek(e,t);return TB(r.duration,r.delay,r.easing)}(t.timings,e.errors);e.currentAnimateTimings=n;let r,s=t.styles?t.styles:Xs({});if(5==s.type)r=this.visitKeyframes(s,e);else{let a=t.styles,l=!1;if(!a){l=!0;const h={};n.easing&&(h.easing=n.easing),a=Xs(h)}e.currentTime+=n.duration+n.delay;const u=this.visitStyle(a,e);u.isEmptyStep=l,r=u}return e.currentAnimateTimings=null,{type:4,timings:n,style:r,options:null}}visitStyle(t,e){const n=this._makeStyleAst(t,e);return this._validateStyleAst(n,e),n}_makeStyleAst(t,e){const n=[];Array.isArray(t.styles)?t.styles.forEach(a=>{"string"==typeof a?a==zm?n.push(a):e.errors.push(function woe(i){return new ln(3002,Qs)}()):n.push(a)}):n.push(t.styles);let r=!1,s=null;return n.forEach(a=>{if(lk(a)){const l=a,u=l.easing;if(u&&(s=u,delete l.easing),!r)for(let h in l)if(l[h].toString().indexOf("{{")>=0){r=!0;break}}}),{type:6,styles:n,easing:s,offset:t.offset,containsDynamicStyles:r,options:null}}_validateStyleAst(t,e){const n=e.currentAnimateTimings;let r=e.currentTime,s=e.currentTime;n&&s>0&&(s-=n.duration+n.delay),t.styles.forEach(a=>{"string"!=typeof a&&Object.keys(a).forEach(l=>{if(!this._driver.validateStyleProperty(l))return delete a[l],void e.unsupportedCSSPropertiesFound.add(l);const u=e.collectedStyles[e.currentQuerySelector],h=u[l];let m=!0;h&&(s!=r&&s>=h.startTime&&r<=h.endTime&&(e.errors.push(function Soe(i,t,e,n,r){return new ln(3010,Qs)}()),m=!1),s=h.startTime),m&&(u[l]={startTime:s,endTime:r}),e.options&&function Joe(i,t,e){const n=t.params||{},r=sW(i);r.length&&r.forEach(s=>{n.hasOwnProperty(s)||e.push(function moe(i){return new ln(3001,Qs)}())})}(a[l],e.options,e.errors)})})}visitKeyframes(t,e){const n={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function Coe(){return new ln(3011,Qs)}()),n;let s=0;const a=[];let l=!1,u=!1,h=0;const m=t.steps.map(P=>{const E=this._makeStyleAst(P,e);let ie=null!=E.offset?E.offset:function pae(i){if("string"==typeof i)return null;let t=null;if(Array.isArray(i))i.forEach(e=>{if(lk(e)&&e.hasOwnProperty("offset")){const n=e;t=parseFloat(n.offset),delete n.offset}});else if(lk(i)&&i.hasOwnProperty("offset")){const e=i;t=parseFloat(e.offset),delete e.offset}return t}(E.styles),ee=0;return null!=ie&&(s++,ee=E.offset=ie),u=u||ee<0||ee>1,l=l||ee<h,h=ee,a.push(ee),E});u&&e.errors.push(function Moe(){return new ln(3012,Qs)}()),l&&e.errors.push(function Toe(){return new ln(3200,Qs)}());const _=t.steps.length;let v=0;s>0&&s<_?e.errors.push(function Eoe(){return new ln(3202,Qs)}()):0==s&&(v=1/(_-1));const S=_-1,T=e.currentTime,I=e.currentAnimateTimings,j=I.duration;return m.forEach((P,E)=>{const ie=v>0?E==S?1:v*E:a[E],ee=ie*j;e.currentTime=T+I.delay+ee,I.duration=ee,this._validateStyleAst(P,e),P.offset=ie,n.styles.push(P)}),n}visitReference(t,e){return{type:8,animation:Ih(this,C1(t.animation),e),options:Db(t.options)}}visitAnimateChild(t,e){return e.depCount++,{type:9,options:Db(t.options)}}visitAnimateRef(t,e){return{type:10,animation:this.visitReference(t.animation,e),options:Db(t.options)}}visitQuery(t,e){const n=e.currentQuerySelector,r=t.options||{};e.queryCount++,e.currentQuery=t;const[s,a]=function hae(i){const t=!!i.split(/\s*,\s*/).find(e=>":self"==e);return t&&(i=i.replace(cae,"")),i=i.replace(/@\*/g,$R).replace(/@\w+/g,e=>$R+"-"+e.substr(1)).replace(/:animating/g,xB),[i,t]}(t.selector);e.currentQuerySelector=n.length?n+" "+s:s,Ph(e.collectedStyles,e.currentQuerySelector,{});const l=Ih(this,C1(t.animation),e);return e.currentQuery=null,e.currentQuerySelector=n,{type:11,selector:s,limit:r.limit||0,optional:!!r.optional,includeSelf:a,animation:l,originalSelector:t.selector,options:Db(t.options)}}visitStagger(t,e){e.currentQuery||e.errors.push(function Aoe(){return new ln(3013,Qs)}());const n="full"===t.timings?{duration:0,delay:0,easing:"full"}:ek(t.timings,e.errors,!0);return{type:12,animation:Ih(this,C1(t.animation),e),timings:n,options:null}}}class fae{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function lk(i){return!Array.isArray(i)&&"object"==typeof i}function Db(i){return i?(i=Fw(i)).params&&(i.params=function dae(i){return i?Fw(i):null}(i.params)):i={},i}function TB(i,t,e){return{duration:i,delay:t,easing:e}}function EB(i,t,e,n,r,s,a=null,l=!1){return{type:1,element:i,keyframes:t,preStyleProps:e,postStyleProps:n,duration:r,delay:s,totalTime:r+s,easing:a,subTimeline:l}}class ck{constructor(){this._map=new Map}get(t){return this._map.get(t)||[]}append(t,e){let n=this._map.get(t);n||this._map.set(t,n=[]),n.push(...e)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const yae=new RegExp(":enter","g"),bae=new RegExp(":leave","g");function AB(i,t,e,n,r,s={},a={},l,u,h=[]){return(new xae).buildKeyframes(i,t,e,n,r,s,a,l,u,h)}class xae{buildKeyframes(t,e,n,r,s,a,l,u,h,m=[]){h=h||new ck;const _=new DB(t,e,h,r,s,m,[]);_.options=u,_.currentTimeline.setStyles([a],null,_.errors,u),Ih(this,n,_);const v=_.timelines.filter(S=>S.containsAnimation());if(Object.keys(l).length){let S;for(let T=v.length-1;T>=0;T--){const I=v[T];if(I.element===e){S=I;break}}S&&!S.allowOnlyTimelineStyles()&&S.setStyles([l],null,_.errors,u)}return v.length?v.map(S=>S.buildKeyframes()):[EB(e,[],[],[],0,0,"",!1)]}visitTrigger(t,e){}visitState(t,e){}visitTransition(t,e){}visitAnimateChild(t,e){const n=e.subInstructions.get(e.element);if(n){const r=e.createSubContext(t.options),s=e.currentTimeline.currentTime,a=this._visitSubInstructions(n,r,r.options);s!=a&&e.transformIntoNewTimeline(a)}e.previousNode=t}visitAnimateRef(t,e){const n=e.createSubContext(t.options);n.transformIntoNewTimeline(),this.visitReference(t.animation,n),e.transformIntoNewTimeline(n.currentTimeline.currentTime),e.previousNode=t}_visitSubInstructions(t,e,n){let s=e.currentTimeline.currentTime;const a=null!=n.duration?Eb(n.duration):null,l=null!=n.delay?Eb(n.delay):null;return 0!==a&&t.forEach(u=>{const h=e.appendInstructionToTimeline(u,a,l);s=Math.max(s,h.duration+h.delay)}),s}visitReference(t,e){e.updateOptions(t.options,!0),Ih(this,t.animation,e),e.previousNode=t}visitSequence(t,e){const n=e.subContextCount;let r=e;const s=t.options;if(s&&(s.params||s.delay)&&(r=e.createSubContext(s),r.transformIntoNewTimeline(),null!=s.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=uk);const a=Eb(s.delay);r.delayNextStep(a)}t.steps.length&&(t.steps.forEach(a=>Ih(this,a,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>n&&r.transformIntoNewTimeline()),e.previousNode=t}visitGroup(t,e){const n=[];let r=e.currentTimeline.currentTime;const s=t.options&&t.options.delay?Eb(t.options.delay):0;t.steps.forEach(a=>{const l=e.createSubContext(t.options);s&&l.delayNextStep(s),Ih(this,a,l),r=Math.max(r,l.currentTimeline.currentTime),n.push(l.currentTimeline)}),n.forEach(a=>e.currentTimeline.mergeTimelineCollectedStyles(a)),e.transformIntoNewTimeline(r),e.previousNode=t}_visitTiming(t,e){if(t.dynamic){const n=t.strValue;return ek(e.params?tk(n,e.params,e.errors):n,e.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,e){const n=e.currentAnimateTimings=this._visitTiming(t.timings,e),r=e.currentTimeline;n.delay&&(e.incrementTime(n.delay),r.snapshotCurrentStyles());const s=t.style;5==s.type?this.visitKeyframes(s,e):(e.incrementTime(n.duration),this.visitStyle(s,e),r.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=t}visitStyle(t,e){const n=e.currentTimeline,r=e.currentAnimateTimings;!r&&n.getCurrentStyleProperties().length&&n.forwardFrame();const s=r&&r.easing||t.easing;t.isEmptyStep?n.applyEmptyStep(s):n.setStyles(t.styles,s,e.errors,e.options),e.previousNode=t}visitKeyframes(t,e){const n=e.currentAnimateTimings,r=e.currentTimeline.duration,s=n.duration,l=e.createSubContext().currentTimeline;l.easing=n.easing,t.styles.forEach(u=>{l.forwardTime((u.offset||0)*s),l.setStyles(u.styles,u.easing,e.errors,e.options),l.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(l),e.transformIntoNewTimeline(r+s),e.previousNode=t}visitQuery(t,e){const n=e.currentTimeline.currentTime,r=t.options||{},s=r.delay?Eb(r.delay):0;s&&(6===e.previousNode.type||0==n&&e.currentTimeline.getCurrentStyleProperties().length)&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=uk);let a=n;const l=e.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!r.optional,e.errors);e.currentQueryTotal=l.length;let u=null;l.forEach((h,m)=>{e.currentQueryIndex=m;const _=e.createSubContext(t.options,h);s&&_.delayNextStep(s),h===e.element&&(u=_.currentTimeline),Ih(this,t.animation,_),_.currentTimeline.applyStylesToKeyframe(),a=Math.max(a,_.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(a),u&&(e.currentTimeline.mergeTimelineCollectedStyles(u),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=t}visitStagger(t,e){const n=e.parentContext,r=e.currentTimeline,s=t.timings,a=Math.abs(s.duration),l=a*(e.currentQueryTotal-1);let u=a*e.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":u=l-u;break;case"full":u=n.currentStaggerTime}const m=e.currentTimeline;u&&m.delayNextStep(u);const _=m.currentTime;Ih(this,t.animation,e),e.previousNode=t,n.currentStaggerTime=r.currentTime-_+(r.startTime-n.currentTimeline.startTime)}}const uk={};class DB{constructor(t,e,n,r,s,a,l,u){this._driver=t,this.element=e,this.subInstructions=n,this._enterClassName=r,this._leaveClassName=s,this.errors=a,this.timelines=l,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=uk,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=u||new hk(this._driver,e,0),l.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,e){if(!t)return;const n=t;let r=this.options;null!=n.duration&&(r.duration=Eb(n.duration)),null!=n.delay&&(r.delay=Eb(n.delay));const s=n.params;if(s){let a=r.params;a||(a=this.options.params={}),Object.keys(s).forEach(l=>{(!e||!a.hasOwnProperty(l))&&(a[l]=tk(s[l],a,this.errors))})}}_copyOptions(){const t={};if(this.options){const e=this.options.params;if(e){const n=t.params={};Object.keys(e).forEach(r=>{n[r]=e[r]})}}return t}createSubContext(t=null,e,n){const r=e||this.element,s=new DB(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,n||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(t),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(t){return this.previousNode=uk,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,e,n){const r={duration:null!=e?e:t.duration,delay:this.currentTimeline.currentTime+(null!=n?n:0)+t.delay,easing:""},s=new wae(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,r,t.stretchStartingKeyframe);return this.timelines.push(s),r}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,e,n,r,s,a){let l=[];if(r&&l.push(this.element),t.length>0){t=(t=t.replace(yae,"."+this._enterClassName)).replace(bae,"."+this._leaveClassName);let h=this._driver.query(this.element,t,1!=n);0!==n&&(h=n<0?h.slice(h.length+n,h.length):h.slice(0,n)),l.push(...h)}return!s&&0==l.length&&a.push(function Doe(i){return new ln(3014,Qs)}()),l}}class hk{constructor(t,e,n,r){this._driver=t,this.element=e,this.startTime=n,this._elementTimelineStylesLookup=r,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}getCurrentStyleProperties(){return Object.keys(this._currentKeyframe)}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const e=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||e?(this.forwardTime(this.currentTime+t),e&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,e){return this.applyStylesToKeyframe(),new hk(this._driver,t,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,e){this._localTimelineStyles[t]=e,this._globalTimelineStyles[t]=e,this._styleSummary[t]={time:this.currentTime,value:e}}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&(this._previousKeyframe.easing=t),Object.keys(this._globalTimelineStyles).forEach(e=>{this._backFill[e]=this._globalTimelineStyles[e]||zm,this._currentKeyframe[e]=zm}),this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,e,n,r){e&&(this._previousKeyframe.easing=e);const s=r&&r.params||{},a=function Sae(i,t){const e={};let n;return i.forEach(r=>{"*"===r?(n=n||Object.keys(t),n.forEach(s=>{e[s]=zm})):sy(r,!1,e)}),e}(t,this._globalTimelineStyles);Object.keys(a).forEach(l=>{const u=tk(a[l],s,n);this._pendingStyles[l]=u,this._localTimelineStyles.hasOwnProperty(l)||(this._backFill[l]=this._globalTimelineStyles.hasOwnProperty(l)?this._globalTimelineStyles[l]:zm),this._updateStyle(l,u)})}applyStylesToKeyframe(){const t=this._pendingStyles,e=Object.keys(t);0!=e.length&&(this._pendingStyles={},e.forEach(n=>{this._currentKeyframe[n]=t[n]}),Object.keys(this._localTimelineStyles).forEach(n=>{this._currentKeyframe.hasOwnProperty(n)||(this._currentKeyframe[n]=this._localTimelineStyles[n])}))}snapshotCurrentStyles(){Object.keys(this._localTimelineStyles).forEach(t=>{const e=this._localTimelineStyles[t];this._pendingStyles[t]=e,this._updateStyle(t,e)})}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let e in this._currentKeyframe)t.push(e);return t}mergeTimelineCollectedStyles(t){Object.keys(t._styleSummary).forEach(e=>{const n=this._styleSummary[e],r=t._styleSummary[e];(!n||r.time>n.time)&&this._updateStyle(e,r.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,e=new Set,n=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((l,u)=>{const h=sy(l,!0);Object.keys(h).forEach(m=>{const _=h[m];"!"==_?t.add(m):_==zm&&e.add(m)}),n||(h.offset=u/this.duration),r.push(h)});const s=t.size?ik(t.values()):[],a=e.size?ik(e.values()):[];if(n){const l=r[0],u=Fw(l);l.offset=0,u.offset=1,r=[l,u]}return EB(this.element,r,s,a,this.duration,this.startTime,this.easing,!1)}}class wae extends hk{constructor(t,e,n,r,s,a,l=!1){super(t,e,a.delay),this.keyframes=n,this.preStyleProps=r,this.postStyleProps=s,this._stretchStartingKeyframe=l,this.timings={duration:a.duration,delay:a.delay,easing:a.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:e,duration:n,easing:r}=this.timings;if(this._stretchStartingKeyframe&&e){const s=[],a=n+e,l=e/a,u=sy(t[0],!1);u.offset=0,s.push(u);const h=sy(t[0],!1);h.offset=uW(l),s.push(h);const m=t.length-1;for(let _=1;_<=m;_++){let v=sy(t[_],!1);v.offset=uW((e+v.offset*n)/a),s.push(v)}n=a,e=0,r="",t=s}return EB(this.element,t,this.preStyleProps,this.postStyleProps,n,e,r,!0)}}function uW(i,t=3){const e=Math.pow(10,t-1);return Math.round(i*e)/e}class RB{}class Cae extends RB{normalizePropertyName(t,e){return CB(t)}normalizeStyleValue(t,e,n,r){let s="";const a=n.toString().trim();if(Mae[e]&&0!==n&&"0"!==n)if("number"==typeof n)s="px";else{const l=n.match(/^[+-]?[\d\.]+([a-z]*)$/);l&&0==l[1].length&&r.push(function yoe(i,t){return new ln(3005,Qs)}())}return a+s}}const Mae=(()=>function Tae(i){const t={};return i.forEach(e=>t[e]=!0),t}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(",")))();function hW(i,t,e,n,r,s,a,l,u,h,m,_,v){return{type:0,element:i,triggerName:t,isRemovalTransition:r,fromState:e,fromStyles:s,toState:n,toStyles:a,timelines:l,queriedElements:u,preStyleProps:h,postStyleProps:m,totalTime:_,errors:v}}const kB={};class dW{constructor(t,e,n){this._triggerName=t,this.ast=e,this._stateStyles=n}match(t,e,n,r){return function Eae(i,t,e,n,r){return i.some(s=>s(t,e,n,r))}(this.ast.matchers,t,e,n,r)}buildStyles(t,e,n){const r=this._stateStyles["*"],s=this._stateStyles[t],a=r?r.buildStyles(e,n):{};return s?s.buildStyles(e,n):a}build(t,e,n,r,s,a,l,u,h,m){const _=[],v=this.ast.options&&this.ast.options.params||kB,T=this.buildStyles(n,l&&l.params||kB,_),I=u&&u.params||kB,j=this.buildStyles(r,I,_),P=new Set,E=new Map,ie=new Map,ee="void"===r,ce={params:Object.assign(Object.assign({},v),I)},ye=m?[]:AB(t,e,this.ast.animation,s,a,T,j,ce,h,_);let Ce=0;if(ye.forEach(Qe=>{Ce=Math.max(Qe.duration+Qe.delay,Ce)}),_.length)return hW(e,this._triggerName,n,r,ee,T,j,[],[],E,ie,Ce,_);ye.forEach(Qe=>{const nt=Qe.element,ge=Ph(E,nt,{});Qe.preStyleProps.forEach(mt=>ge[mt]=!0);const Je=Ph(ie,nt,{});Qe.postStyleProps.forEach(mt=>Je[mt]=!0),nt!==e&&P.add(nt)});const Ge=ik(P.values());return hW(e,this._triggerName,n,r,ee,T,j,ye,Ge,E,ie,Ce)}}class Aae{constructor(t,e,n){this.styles=t,this.defaultParams=e,this.normalizer=n}buildStyles(t,e){const n={},r=Fw(this.defaultParams);return Object.keys(t).forEach(s=>{const a=t[s];null!=a&&(r[s]=a)}),this.styles.styles.forEach(s=>{if("string"!=typeof s){const a=s;Object.keys(a).forEach(l=>{let u=a[l];u.length>1&&(u=tk(u,r,e));const h=this.normalizer.normalizePropertyName(l,e);u=this.normalizer.normalizeStyleValue(l,h,u,e),n[h]=u})}}),n}}class Rae{constructor(t,e,n){this.name=t,this.ast=e,this._normalizer=n,this.transitionFactories=[],this.states={},e.states.forEach(r=>{this.states[r.name]=new Aae(r.style,r.options&&r.options.params||{},n)}),fW(this.states,"true","1"),fW(this.states,"false","0"),e.transitions.forEach(r=>{this.transitionFactories.push(new dW(t,r,this.states))}),this.fallbackTransition=function kae(i,t,e){return new dW(i,{type:1,animation:{type:2,steps:[],options:null},matchers:[(a,l)=>!0],options:null,queryCount:0,depCount:0},t)}(t,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,e,n,r){return this.transitionFactories.find(a=>a.match(t,e,n,r))||null}matchStyles(t,e,n){return this.fallbackTransition.buildStyles(t,e,n)}}function fW(i,t,e){i.hasOwnProperty(t)?i.hasOwnProperty(e)||(i[e]=i[t]):i.hasOwnProperty(e)&&(i[t]=i[e])}const Pae=new ck;class Iae{constructor(t,e,n){this.bodyNode=t,this._driver=e,this._normalizer=n,this._animations={},this._playersById={},this.players=[]}register(t,e){const n=[],s=MB(this._driver,e,n,[]);if(n.length)throw function Foe(i){return new ln(3503,Qs)}();this._animations[t]=s}_buildPlayer(t,e,n){const r=t.element,s=jG(0,this._normalizer,0,t.keyframes,e,n);return this._driver.animate(r,s,t.duration,t.delay,t.easing,[],!0)}create(t,e,n={}){const r=[],s=this._animations[t];let a;const l=new Map;if(s?(a=AB(this._driver,e,s,bB,QR,{},{},n,Pae,r),a.forEach(m=>{const _=Ph(l,m.element,{});m.postStyleProps.forEach(v=>_[v]=null)})):(r.push(function Boe(){return new ln(3300,Qs)}()),a=[]),r.length)throw function Noe(i){return new ln(3504,Qs)}();l.forEach((m,_)=>{Object.keys(m).forEach(v=>{m[v]=this._driver.computeStyle(_,v,zm)})});const h=ry(a.map(m=>{const _=l.get(m.element);return this._buildPlayer(m,{},_)}));return this._playersById[t]=h,h.onDestroy(()=>this.destroy(t)),this.players.push(h),h}destroy(t){const e=this._getPlayer(t);e.destroy(),delete this._playersById[t];const n=this.players.indexOf(e);n>=0&&this.players.splice(n,1)}_getPlayer(t){const e=this._playersById[t];if(!e)throw function Hoe(i){return new ln(3301,Qs)}();return e}listen(t,e,n,r){const s=gB(e,"","","");return pB(this._getPlayer(t),n,s,r),()=>{}}command(t,e,n,r){if("register"==n)return void this.register(t,r[0]);if("create"==n)return void this.create(t,e,r[0]||{});const s=this._getPlayer(t);switch(n){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(t)}}}const pW="ng-animate-queued",PB="ng-animate-disabled",Nae=[],mW={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Hae={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Zd="__ng_removed";class IB{constructor(t,e=""){this.namespaceId=e;const n=t&&t.hasOwnProperty("value");if(this.value=function Gae(i){return null!=i?i:null}(n?t.value:t),n){const s=Fw(t);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(t){const e=t.params;if(e){const n=this.options.params;Object.keys(e).forEach(r=>{null==n[r]&&(n[r]=e[r])})}}}const M1="void",LB=new IB(M1);class Vae{constructor(t,e,n){this.id=t,this.hostElement=e,this._engine=n,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,Yd(e,this._hostClassName)}listen(t,e,n,r){if(!this._triggers.hasOwnProperty(e))throw function Voe(i,t){return new ln(3302,Qs)}();if(null==n||0==n.length)throw function zoe(i){return new ln(3303,Qs)}();if(!function Wae(i){return"start"==i||"done"==i}(n))throw function Uoe(i,t){return new ln(3400,Qs)}();const s=Ph(this._elementListeners,t,[]),a={name:e,phase:n,callback:r};s.push(a);const l=Ph(this._engine.statesByElement,t,{});return l.hasOwnProperty(e)||(Yd(t,JR),Yd(t,JR+"-"+e),l[e]=LB),()=>{this._engine.afterFlush(()=>{const u=s.indexOf(a);u>=0&&s.splice(u,1),this._triggers[e]||delete l[e]})}}register(t,e){return!this._triggers[t]&&(this._triggers[t]=e,!0)}_getTrigger(t){const e=this._triggers[t];if(!e)throw function Goe(i){return new ln(3401,Qs)}();return e}trigger(t,e,n,r=!0){const s=this._getTrigger(e),a=new OB(this.id,e,t);let l=this._engine.statesByElement.get(t);l||(Yd(t,JR),Yd(t,JR+"-"+e),this._engine.statesByElement.set(t,l={}));let u=l[e];const h=new IB(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&u&&h.absorbOptions(u.options),l[e]=h,u||(u=LB),h.value!==M1&&u.value===h.value){if(!function Xae(i,t){const e=Object.keys(i),n=Object.keys(t);if(e.length!=n.length)return!1;for(let r=0;r<e.length;r++){const s=e[r];if(!t.hasOwnProperty(s)||i[s]!==t[s])return!1}return!0}(u.params,h.params)){const I=[],j=s.matchStyles(u.value,u.params,I),P=s.matchStyles(h.value,h.params,I);I.length?this._engine.reportError(I):this._engine.afterFlush(()=>{Ab(t,j),Mp(t,P)})}return}const v=Ph(this._engine.playersByElement,t,[]);v.forEach(I=>{I.namespaceId==this.id&&I.triggerName==e&&I.queued&&I.destroy()});let S=s.matchTransition(u.value,h.value,t,h.params),T=!1;if(!S){if(!r)return;S=s.fallbackTransition,T=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:e,transition:S,fromState:u,toState:h,player:a,isFallbackTransition:T}),T||(Yd(t,pW),a.onStart(()=>{Bw(t,pW)})),a.onDone(()=>{let I=this.players.indexOf(a);I>=0&&this.players.splice(I,1);const j=this._engine.playersByElement.get(t);if(j){let P=j.indexOf(a);P>=0&&j.splice(P,1)}}),this.players.push(a),v.push(a),a}deregister(t){delete this._triggers[t],this._engine.statesByElement.forEach((e,n)=>{delete e[t]}),this._elementListeners.forEach((e,n)=>{this._elementListeners.set(n,e.filter(r=>r.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const e=this._engine.playersByElement.get(t);e&&(e.forEach(n=>n.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,e){const n=this._engine.driver.query(t,$R,!0);n.forEach(r=>{if(r[Zd])return;const s=this._engine.fetchNamespacesByElement(r);s.size?s.forEach(a=>a.triggerLeaveAnimation(r,e,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(t,e,n,r){const s=this._engine.statesByElement.get(t),a=new Map;if(s){const l=[];if(Object.keys(s).forEach(u=>{if(a.set(u,s[u].value),this._triggers[u]){const h=this.trigger(t,u,M1,r);h&&l.push(h)}}),l.length)return this._engine.markElementAsRemoved(this.id,t,!0,e,a),n&&ry(l).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const e=this._elementListeners.get(t),n=this._engine.statesByElement.get(t);if(e&&n){const r=new Set;e.forEach(s=>{const a=s.name;if(r.has(a))return;r.add(a);const u=this._triggers[a].fallbackTransition,h=n[a]||LB,m=new IB(M1),_=new OB(this.id,a,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:a,transition:u,fromState:h,toState:m,player:_,isFallbackTransition:!0})})}}removeNode(t,e){const n=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,e),this.triggerLeaveAnimation(t,e,!0))return;let r=!1;if(n.totalAnimations){const s=n.players.length?n.playersByQueriedElement.get(t):[];if(s&&s.length)r=!0;else{let a=t;for(;a=a.parentNode;)if(n.statesByElement.get(a)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(t),r)n.markElementAsRemoved(this.id,t,!1,e);else{const s=t[Zd];(!s||s===mW)&&(n.afterFlush(()=>this.clearElementCache(t)),n.destroyInnerAnimations(t),n._onRemovalComplete(t,e))}}insertNode(t,e){Yd(t,this._hostClassName)}drainQueuedTransitions(t){const e=[];return this._queue.forEach(n=>{const r=n.player;if(r.destroyed)return;const s=n.element,a=this._elementListeners.get(s);a&&a.forEach(l=>{if(l.name==n.triggerName){const u=gB(s,n.triggerName,n.fromState.value,n.toState.value);u._data=t,pB(n.player,l.phase,u,l.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):e.push(n)}),this._queue=[],e.sort((n,r)=>{const s=n.transition.ast.depCount,a=r.transition.ast.depCount;return 0==s||0==a?s-a:this._engine.driver.containsElement(n.element,r.element)?1:-1})}destroy(t){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}elementContainsData(t){let e=!1;return this._elementListeners.has(t)&&(e=!0),e=!!this._queue.find(n=>n.element===t)||e,e}}class zae{constructor(t,e,n){this.bodyNode=t,this.driver=e,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,s)=>{}}_onRemovalComplete(t,e){this.onRemovalComplete(t,e)}get queuedPlayers(){const t=[];return this._namespaceList.forEach(e=>{e.players.forEach(n=>{n.queued&&t.push(n)})}),t}createNamespace(t,e){const n=new Vae(t,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(n,e):(this.newHostElements.set(e,n),this.collectEnterElement(e)),this._namespaceLookup[t]=n}_balanceNamespaceList(t,e){const n=this._namespaceList,r=this.namespacesByHostElement,s=n.length-1;if(s>=0){let a=!1;if(void 0!==this.driver.getParentElement){let l=this.driver.getParentElement(e);for(;l;){const u=r.get(l);if(u){const h=n.indexOf(u);n.splice(h+1,0,t),a=!0;break}l=this.driver.getParentElement(l)}}else for(let l=s;l>=0;l--)if(this.driver.containsElement(n[l].hostElement,e)){n.splice(l+1,0,t),a=!0;break}a||n.unshift(t)}else n.push(t);return r.set(e,t),t}register(t,e){let n=this._namespaceLookup[t];return n||(n=this.createNamespace(t,e)),n}registerTrigger(t,e,n){let r=this._namespaceLookup[t];r&&r.register(e,n)&&this.totalAnimations++}destroy(t,e){if(!t)return;const n=this._fetchNamespace(t);this.afterFlush(()=>{this.namespacesByHostElement.delete(n.hostElement),delete this._namespaceLookup[t];const r=this._namespaceList.indexOf(n);r>=0&&this._namespaceList.splice(r,1)}),this.afterFlushAnimationsDone(()=>n.destroy(e))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const e=new Set,n=this.statesByElement.get(t);if(n){const r=Object.keys(n);for(let s=0;s<r.length;s++){const a=n[r[s]].namespaceId;if(a){const l=this._fetchNamespace(a);l&&e.add(l)}}}return e}trigger(t,e,n,r){if(dk(e)){const s=this._fetchNamespace(t);if(s)return s.trigger(e,n,r),!0}return!1}insertNode(t,e,n,r){if(!dk(e))return;const s=e[Zd];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const a=this.collectedLeaveElements.indexOf(e);a>=0&&this.collectedLeaveElements.splice(a,1)}if(t){const a=this._fetchNamespace(t);a&&a.insertNode(e,n)}r&&this.collectEnterElement(e)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,e){e?this.disabledNodes.has(t)||(this.disabledNodes.add(t),Yd(t,PB)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),Bw(t,PB))}removeNode(t,e,n,r){if(dk(e)){const s=t?this._fetchNamespace(t):null;if(s?s.removeNode(e,r):this.markElementAsRemoved(t,e,!1,r),n){const a=this.namespacesByHostElement.get(e);a&&a.id!==t&&a.removeNode(e,r)}}else this._onRemovalComplete(e,r)}markElementAsRemoved(t,e,n,r,s){this.collectedLeaveElements.push(e),e[Zd]={namespaceId:t,setForRemoval:r,hasAnimation:n,removedBeforeQueried:!1,previousTriggersValues:s}}listen(t,e,n,r,s){return dk(e)?this._fetchNamespace(t).listen(e,n,r,s):()=>{}}_buildInstruction(t,e,n,r,s){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,n,r,t.fromState.options,t.toState.options,e,s)}destroyInnerAnimations(t){let e=this.driver.query(t,$R,!0);e.forEach(n=>this.destroyActiveAnimationsForElement(n)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(t,xB,!0),e.forEach(n=>this.finishActiveQueriedAnimationOnElement(n)))}destroyActiveAnimationsForElement(t){const e=this.playersByElement.get(t);e&&e.forEach(n=>{n.queued?n.markedForDestroy=!0:n.destroy()})}finishActiveQueriedAnimationOnElement(t){const e=this.playersByQueriedElement.get(t);e&&e.forEach(n=>n.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return ry(this.players).onDone(()=>t());t()})}processLeaveNode(t){var e;const n=t[Zd];if(n&&n.setForRemoval){if(t[Zd]=mW,n.namespaceId){this.destroyInnerAnimations(t);const r=this._fetchNamespace(n.namespaceId);r&&r.clearElementCache(t)}this._onRemovalComplete(t,n.setForRemoval)}(null===(e=t.classList)||void 0===e?void 0:e.contains(PB))&&this.markElementAsDisabled(t,!1),this.driver.query(t,".ng-animate-disabled",!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(t=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((n,r)=>this._balanceNamespaceList(n,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++)Yd(this.collectedEnterElements[n],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const n=[];try{e=this._flushAnimations(n,t)}finally{for(let r=0;r<n.length;r++)n[r]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++)this.processLeaveNode(this.collectedLeaveElements[n]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(n=>n()),this._flushFns=[],this._whenQuietFns.length){const n=this._whenQuietFns;this._whenQuietFns=[],e.length?ry(e).onDone(()=>{n.forEach(r=>r())}):n.forEach(r=>r())}}reportError(t){throw function Woe(i){return new ln(3402,Qs)}()}_flushAnimations(t,e){const n=new ck,r=[],s=new Map,a=[],l=new Map,u=new Map,h=new Map,m=new Set;this.disabledNodes.forEach(et=>{m.add(et);const vt=this.driver.query(et,".ng-animate-queued",!0);for(let kt=0;kt<vt.length;kt++)m.add(vt[kt])});const _=this.bodyNode,v=Array.from(this.statesByElement.keys()),S=yW(v,this.collectedEnterElements),T=new Map;let I=0;S.forEach((et,vt)=>{const kt=bB+I++;T.set(vt,kt),et.forEach(pi=>Yd(pi,kt))});const j=[],P=new Set,E=new Set;for(let et=0;et<this.collectedLeaveElements.length;et++){const vt=this.collectedLeaveElements[et],kt=vt[Zd];kt&&kt.setForRemoval&&(j.push(vt),P.add(vt),kt.hasAnimation?this.driver.query(vt,".ng-star-inserted",!0).forEach(pi=>P.add(pi)):E.add(vt))}const ie=new Map,ee=yW(v,Array.from(P));ee.forEach((et,vt)=>{const kt=QR+I++;ie.set(vt,kt),et.forEach(pi=>Yd(pi,kt))}),t.push(()=>{S.forEach((et,vt)=>{const kt=T.get(vt);et.forEach(pi=>Bw(pi,kt))}),ee.forEach((et,vt)=>{const kt=ie.get(vt);et.forEach(pi=>Bw(pi,kt))}),j.forEach(et=>{this.processLeaveNode(et)})});const ce=[],ye=[];for(let et=this._namespaceList.length-1;et>=0;et--)this._namespaceList[et].drainQueuedTransitions(e).forEach(kt=>{const pi=kt.player,Ht=kt.element;if(ce.push(pi),this.collectedEnterElements.length){const nn=Ht[Zd];if(nn&&nn.setForMove){if(nn.previousTriggersValues&&nn.previousTriggersValues.has(kt.triggerName)){const Un=nn.previousTriggersValues.get(kt.triggerName),Cn=this.statesByElement.get(kt.element);Cn&&Cn[kt.triggerName]&&(Cn[kt.triggerName].value=Un)}return void pi.destroy()}}const ct=!_||!this.driver.containsElement(_,Ht),mi=ie.get(Ht),Zi=T.get(Ht),zi=this._buildInstruction(kt,n,Zi,mi,ct);if(zi.errors&&zi.errors.length)return void ye.push(zi);if(ct)return pi.onStart(()=>Ab(Ht,zi.fromStyles)),pi.onDestroy(()=>Mp(Ht,zi.toStyles)),void r.push(pi);if(kt.isFallbackTransition)return pi.onStart(()=>Ab(Ht,zi.fromStyles)),pi.onDestroy(()=>Mp(Ht,zi.toStyles)),void r.push(pi);const Zt=[];zi.timelines.forEach(nn=>{nn.stretchStartingKeyframe=!0,this.disabledNodes.has(nn.element)||Zt.push(nn)}),zi.timelines=Zt,n.append(Ht,zi.timelines),a.push({instruction:zi,player:pi,element:Ht}),zi.queriedElements.forEach(nn=>Ph(l,nn,[]).push(pi)),zi.preStyleProps.forEach((nn,Un)=>{const Cn=Object.keys(nn);if(Cn.length){let ts=u.get(Un);ts||u.set(Un,ts=new Set),Cn.forEach(Hr=>ts.add(Hr))}}),zi.postStyleProps.forEach((nn,Un)=>{const Cn=Object.keys(nn);let ts=h.get(Un);ts||h.set(Un,ts=new Set),Cn.forEach(Hr=>ts.add(Hr))})});if(ye.length){const et=[];ye.forEach(vt=>{et.push(function joe(i,t){return new ln(3505,Qs)}())}),ce.forEach(vt=>vt.destroy()),this.reportError(et)}const Ce=new Map,Ge=new Map;a.forEach(et=>{const vt=et.element;n.has(vt)&&(Ge.set(vt,vt),this._beforeAnimationBuild(et.player.namespaceId,et.instruction,Ce))}),r.forEach(et=>{const vt=et.element;this._getPreviousPlayers(vt,!1,et.namespaceId,et.triggerName,null).forEach(pi=>{Ph(Ce,vt,[]).push(pi),pi.destroy()})});const Qe=j.filter(et=>bW(et,u,h)),nt=new Map;_W(nt,this.driver,E,h,zm).forEach(et=>{bW(et,u,h)&&Qe.push(et)});const Je=new Map;S.forEach((et,vt)=>{_W(Je,this.driver,new Set(et),u,"!")}),Qe.forEach(et=>{const vt=nt.get(et),kt=Je.get(et);nt.set(et,Object.assign(Object.assign({},vt),kt))});const mt=[],pt=[],Pt={};a.forEach(et=>{const{element:vt,player:kt,instruction:pi}=et;if(n.has(vt)){if(m.has(vt))return kt.onDestroy(()=>Mp(vt,pi.toStyles)),kt.disabled=!0,kt.overrideTotalTime(pi.totalTime),void r.push(kt);let Ht=Pt;if(Ge.size>1){let mi=vt;const Zi=[];for(;mi=mi.parentNode;){const zi=Ge.get(mi);if(zi){Ht=zi;break}Zi.push(mi)}Zi.forEach(zi=>Ge.set(zi,Ht))}const ct=this._buildAnimation(kt.namespaceId,pi,Ce,s,Je,nt);if(kt.setRealPlayer(ct),Ht===Pt)mt.push(kt);else{const mi=this.playersByElement.get(Ht);mi&&mi.length&&(kt.parentPlayer=ry(mi)),r.push(kt)}}else Ab(vt,pi.fromStyles),kt.onDestroy(()=>Mp(vt,pi.toStyles)),pt.push(kt),m.has(vt)&&r.push(kt)}),pt.forEach(et=>{const vt=s.get(et.element);if(vt&&vt.length){const kt=ry(vt);et.setRealPlayer(kt)}}),r.forEach(et=>{et.parentPlayer?et.syncPlayerEvents(et.parentPlayer):et.destroy()});for(let et=0;et<j.length;et++){const vt=j[et],kt=vt[Zd];if(Bw(vt,QR),kt&&kt.hasAnimation)continue;let pi=[];if(l.size){let ct=l.get(vt);ct&&ct.length&&pi.push(...ct);let mi=this.driver.query(vt,xB,!0);for(let Zi=0;Zi<mi.length;Zi++){let zi=l.get(mi[Zi]);zi&&zi.length&&pi.push(...zi)}}const Ht=pi.filter(ct=>!ct.destroyed);Ht.length?jae(this,vt,Ht):this.processLeaveNode(vt)}return j.length=0,mt.forEach(et=>{this.players.push(et),et.onDone(()=>{et.destroy();const vt=this.players.indexOf(et);this.players.splice(vt,1)}),et.play()}),mt}elementContainsData(t,e){let n=!1;const r=e[Zd];return r&&r.setForRemoval&&(n=!0),this.playersByElement.has(e)&&(n=!0),this.playersByQueriedElement.has(e)&&(n=!0),this.statesByElement.has(e)&&(n=!0),this._fetchNamespace(t).elementContainsData(e)||n}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,e,n,r,s){let a=[];if(e){const l=this.playersByQueriedElement.get(t);l&&(a=l)}else{const l=this.playersByElement.get(t);if(l){const u=!s||s==M1;l.forEach(h=>{h.queued||!u&&h.triggerName!=r||a.push(h)})}}return(n||r)&&(a=a.filter(l=>!(n&&n!=l.namespaceId||r&&r!=l.triggerName))),a}_beforeAnimationBuild(t,e,n){const s=e.element,a=e.isRemovalTransition?void 0:t,l=e.isRemovalTransition?void 0:e.triggerName;for(const u of e.timelines){const h=u.element,m=h!==s,_=Ph(n,h,[]);this._getPreviousPlayers(h,m,a,l,e.toState).forEach(S=>{const T=S.getRealPlayer();T.beforeDestroy&&T.beforeDestroy(),S.destroy(),_.push(S)})}Ab(s,e.fromStyles)}_buildAnimation(t,e,n,r,s,a){const l=e.triggerName,u=e.element,h=[],m=new Set,_=new Set,v=e.timelines.map(T=>{const I=T.element;m.add(I);const j=I[Zd];if(j&&j.removedBeforeQueried)return new S1(T.duration,T.delay);const P=I!==u,E=function qae(i){const t=[];return vW(i,t),t}((n.get(I)||Nae).map(Ce=>Ce.getRealPlayer())).filter(Ce=>!!Ce.element&&Ce.element===I),ie=s.get(I),ee=a.get(I),ce=jG(0,this._normalizer,0,T.keyframes,ie,ee),ye=this._buildPlayer(T,ce,E);if(T.subTimeline&&r&&_.add(I),P){const Ce=new OB(t,l,I);Ce.setRealPlayer(ye),h.push(Ce)}return ye});h.forEach(T=>{Ph(this.playersByQueriedElement,T.element,[]).push(T),T.onDone(()=>function Uae(i,t,e){let n;if(i instanceof Map){if(n=i.get(t),n){if(n.length){const r=n.indexOf(e);n.splice(r,1)}0==n.length&&i.delete(t)}}else if(n=i[t],n){if(n.length){const r=n.indexOf(e);n.splice(r,1)}0==n.length&&delete i[t]}return n}(this.playersByQueriedElement,T.element,T))}),m.forEach(T=>Yd(T,tW));const S=ry(v);return S.onDestroy(()=>{m.forEach(T=>Bw(T,tW)),Mp(u,e.toStyles)}),_.forEach(T=>{Ph(r,T,[]).push(S)}),S}_buildPlayer(t,e,n){return e.length>0?this.driver.animate(t.element,e,t.duration,t.delay,t.easing,n):new S1(t.duration,t.delay)}}class OB{constructor(t,e,n){this.namespaceId=t,this.triggerName=e,this.element=n,this._player=new S1,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,Object.keys(this._queuedCallbacks).forEach(e=>{this._queuedCallbacks[e].forEach(n=>pB(t,e,void 0,n))}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const e=this._player;e.triggerCallback&&t.onStart(()=>e.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,e){Ph(this._queuedCallbacks,t,[]).push(e)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const e=this._player;e.triggerCallback&&e.triggerCallback(t)}}function dk(i){return i&&1===i.nodeType}function gW(i,t){const e=i.style.display;return i.style.display=null!=t?t:"none",e}function _W(i,t,e,n,r){const s=[];e.forEach(u=>s.push(gW(u)));const a=[];n.forEach((u,h)=>{const m={};u.forEach(_=>{const v=m[_]=t.computeStyle(h,_,r);(!v||0==v.length)&&(h[Zd]=Hae,a.push(h))}),i.set(h,m)});let l=0;return e.forEach(u=>gW(u,s[l++])),a}function yW(i,t){const e=new Map;if(i.forEach(l=>e.set(l,[])),0==t.length)return e;const r=new Set(t),s=new Map;function a(l){if(!l)return 1;let u=s.get(l);if(u)return u;const h=l.parentNode;return u=e.has(h)?h:r.has(h)?1:a(h),s.set(l,u),u}return t.forEach(l=>{const u=a(l);1!==u&&e.get(u).push(l)}),e}function Yd(i,t){var e;null===(e=i.classList)||void 0===e||e.add(t)}function Bw(i,t){var e;null===(e=i.classList)||void 0===e||e.remove(t)}function jae(i,t,e){ry(e).onDone(()=>i.processLeaveNode(t))}function vW(i,t){for(let e=0;e<i.length;e++){const n=i[e];n instanceof GG?vW(n.players,t):t.push(n)}}function bW(i,t,e){const n=e.get(i);if(!n)return!1;let r=t.get(i);return r?n.forEach(s=>r.add(s)):t.set(i,n),e.delete(i),!0}class fk{constructor(t,e,n){this.bodyNode=t,this._driver=e,this._normalizer=n,this._triggerCache={},this.onRemovalComplete=(r,s)=>{},this._transitionEngine=new zae(t,e,n),this._timelineEngine=new Iae(t,e,n),this._transitionEngine.onRemovalComplete=(r,s)=>this.onRemovalComplete(r,s)}registerTrigger(t,e,n,r,s){const a=t+"-"+r;let l=this._triggerCache[a];if(!l){const u=[],m=MB(this._driver,s,u,[]);if(u.length)throw function Loe(i,t){return new ln(3404,Qs)}();l=function Dae(i,t,e){return new Rae(i,t,e)}(r,m,this._normalizer),this._triggerCache[a]=l}this._transitionEngine.registerTrigger(e,r,l)}register(t,e){this._transitionEngine.register(t,e)}destroy(t,e){this._transitionEngine.destroy(t,e)}onInsert(t,e,n,r){this._transitionEngine.insertNode(t,e,n,r)}onRemove(t,e,n,r){this._transitionEngine.removeNode(t,e,r||!1,n)}disableAnimations(t,e){this._transitionEngine.markElementAsDisabled(t,e)}process(t,e,n,r){if("@"==n.charAt(0)){const[s,a]=qG(n);this._timelineEngine.command(s,e,a,r)}else this._transitionEngine.trigger(t,e,n,r)}listen(t,e,n,r,s){if("@"==n.charAt(0)){const[a,l]=qG(n);return this._timelineEngine.listen(a,e,l,s)}return this._transitionEngine.listen(t,e,n,r,s)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let Yae=(()=>{class i{constructor(e,n,r){this._element=e,this._startStyles=n,this._endStyles=r,this._state=0;let s=i.initialStylesByElement.get(e);s||i.initialStylesByElement.set(e,s={}),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&Mp(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Mp(this._element,this._initialStyles),this._endStyles&&(Mp(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(i.initialStylesByElement.delete(this._element),this._startStyles&&(Ab(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Ab(this._element,this._endStyles),this._endStyles=null),Mp(this._element,this._initialStyles),this._state=3)}}return i.initialStylesByElement=new WeakMap,i})();function FB(i){let t=null;const e=Object.keys(i);for(let n=0;n<e.length;n++){const r=e[n];Kae(r)&&(t=t||{},t[r]=i[r])}return t}function Kae(i){return"display"===i||"position"===i}class xW{constructor(t,e,n,r){this.element=t,this.keyframes=e,this.options=n,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:{},this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_triggerWebAnimation(t,e,n){return t.animate(e,n)}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=t*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t={};if(this.hasStarted()){const e=this._finalKeyframe;Object.keys(e).forEach(n=>{"offset"!=n&&(t[n]=this._finished?e[n]:oW(this.element,n))})}this.currentSnapshot=t}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(n=>n()),e.length=0}}class Qae{validateStyleProperty(t){return KG(t)}matchesElement(t,e){return!1}containsElement(t,e){return QG(t,e)}getParentElement(t){return yB(t)}query(t,e,n){return JG(t,e,n)}computeStyle(t,e,n){return window.getComputedStyle(t)[e]}animate(t,e,n,r,s,a=[]){const u={duration:n,delay:r,fill:0==r?"both":"forwards"};s&&(u.easing=s);const h={},m=a.filter(v=>v instanceof xW);(function tae(i,t){return 0===i||0===t})(n,r)&&m.forEach(v=>{let S=v.currentSnapshot;Object.keys(S).forEach(T=>h[T]=S[T])}),e=function iae(i,t,e){const n=Object.keys(e);if(n.length&&t.length){let s=t[0],a=[];if(n.forEach(l=>{s.hasOwnProperty(l)||a.push(l),s[l]=e[l]}),a.length)for(var r=1;r<t.length;r++){let l=t[r];a.forEach(function(u){l[u]=oW(i,u)})}}return t}(t,e=e.map(v=>sy(v,!1)),h);const _=function Zae(i,t){let e=null,n=null;return Array.isArray(t)&&t.length?(e=FB(t[0]),t.length>1&&(n=FB(t[t.length-1]))):t&&(e=FB(t)),e||n?new Yae(i,e,n):null}(t,e);return new xW(t,e,u,_)}}let Jae=(()=>{class i extends VG{constructor(e,n){super(),this._nextAnimationId=0,this._renderer=e.createRenderer(n.body,{id:"0",encapsulation:Co.None,styles:[],data:{animation:[]}})}build(e){const n=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(e)?zG(e):e;return wW(this._renderer,null,n,"register",[r]),new $ae(n,this._renderer)}}return i.\u0275fac=function(e){return new(e||i)(Ve(e1),Ve(ar))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})();class $ae extends class hoe{}{constructor(t,e){super(),this._id=t,this._renderer=e}create(t,e){return new ele(this._id,t,e||{},this._renderer)}}class ele{constructor(t,e,n,r){this.id=t,this.element=e,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",n)}_listen(t,e){return this._renderer.listen(this.element,`@@${this.id}:${t}`,e)}_command(t,...e){return wW(this._renderer,this.element,this.id,t,e)}onDone(t){this._listen("done",t)}onStart(t){this._listen("start",t)}onDestroy(t){this._listen("destroy",t)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(t){this._command("setPosition",t)}getPosition(){var t,e;return null!==(e=null===(t=this._renderer.engine.players[+this.id])||void 0===t?void 0:t.getPosition())&&void 0!==e?e:0}}function wW(i,t,e,n,r){return i.setProperty(t,`@@${e}:${n}`,r)}const SW="@.disabled";let tle=(()=>{class i{constructor(e,n,r){this.delegate=e,this.engine=n,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),n.onRemovalComplete=(s,a)=>{const l=null==a?void 0:a.parentNode(s);l&&a.removeChild(l,s)}}createRenderer(e,n){const s=this.delegate.createRenderer(e,n);if(!(e&&n&&n.data&&n.data.animation)){let m=this._rendererCache.get(s);return m||(m=new CW("",s,this.engine),this._rendererCache.set(s,m)),m}const a=n.id,l=n.id+"-"+this._currentId;this._currentId++,this.engine.register(l,e);const u=m=>{Array.isArray(m)?m.forEach(u):this.engine.registerTrigger(a,l,e,m.name,m)};return n.data.animation.forEach(u),new ile(this,l,s,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(e,n,r){e>=0&&e<this._microtaskId?this._zone.run(()=>n(r)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(s=>{const[a,l]=s;a(l)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([n,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return i.\u0275fac=function(e){return new(e||i)(Ve(e1),Ve(fk),Ve(Rn))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})();class CW{constructor(t,e,n){this.namespaceId=t,this.delegate=e,this.engine=n,this.destroyNode=this.delegate.destroyNode?r=>e.destroyNode(r):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,e){this.delegate.appendChild(t,e),this.engine.onInsert(this.namespaceId,e,t,!1)}insertBefore(t,e,n,r=!0){this.delegate.insertBefore(t,e,n),this.engine.onInsert(this.namespaceId,e,t,r)}removeChild(t,e,n){this.engine.onRemove(this.namespaceId,e,this.delegate,n)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,n,r){this.delegate.setAttribute(t,e,n,r)}removeAttribute(t,e,n){this.delegate.removeAttribute(t,e,n)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,n,r){this.delegate.setStyle(t,e,n,r)}removeStyle(t,e,n){this.delegate.removeStyle(t,e,n)}setProperty(t,e,n){"@"==e.charAt(0)&&e==SW?this.disableAnimations(t,!!n):this.delegate.setProperty(t,e,n)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,n){return this.delegate.listen(t,e,n)}disableAnimations(t,e){this.engine.disableAnimations(t,e)}}class ile extends CW{constructor(t,e,n,r){super(e,n,r),this.factory=t,this.namespaceId=e}setProperty(t,e,n){"@"==e.charAt(0)?"."==e.charAt(1)&&e==SW?this.disableAnimations(t,n=void 0===n||!!n):this.engine.process(this.namespaceId,t,e.substr(1),n):this.delegate.setProperty(t,e,n)}listen(t,e,n){if("@"==e.charAt(0)){const r=function nle(i){switch(i){case"body":return document.body;case"document":return document;case"window":return window;default:return i}}(t);let s=e.substr(1),a="";return"@"!=s.charAt(0)&&([s,a]=function rle(i){const t=i.indexOf(".");return[i.substring(0,t),i.substr(t+1)]}(s)),this.engine.listen(this.namespaceId,r,s,a,l=>{this.factory.scheduleListenerCallback(l._data||-1,n,l)})}return this.delegate.listen(t,e,n)}}let sle=(()=>{class i extends fk{constructor(e,n,r){super(e.body,n,r)}ngOnDestroy(){this.flush()}}return i.\u0275fac=function(e){return new(e||i)(Ve(ar),Ve(vB),Ve(RB))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})();const ga=new gi("AnimationModuleType"),MW=[{provide:VG,useClass:Jae},{provide:RB,useFactory:function ole(){return new Cae}},{provide:fk,useClass:sle},{provide:e1,useFactory:function ale(i,t,e){return new tle(i,t,e)},deps:[PR,fk,Rn]}],TW=[{provide:vB,useFactory:()=>new Qae},{provide:ga,useValue:"BrowserAnimations"},...MW],lle=[{provide:vB,useClass:$G},{provide:ga,useValue:"NoopAnimations"},...MW];let cle=(()=>{class i{static withConfig(e){return{ngModule:i,providers:e.disableAnimations?lle:TW}}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({providers:TW,imports:[Oo]}),i})();class ule{constructor(t){if(!t)throw new Error("Cannot create HistoryContainerModel without ResultsContainer.");this.timestamp=Date.now(),this.objects=t.objectCount,this.segments=t.segmentCount,this.features=t.features.map(e=>e.name),this.results=t.serialize()}}const mk=V(i=>function(){i(this),this.name="EmptyError",this.message="no elements in sequence"});function EW(i){return gr((t,e)=>{let n=!1;t.subscribe(qn(e,r=>{n=!0,e.next(r)},()=>{n||e.next(i),e.complete()}))})}function AW(i=hle){return gr((t,e)=>{let n=!1;t.subscribe(qn(e,r=>{n=!0,e.next(r)},()=>n?e.complete():e.error(i())))})}function hle(){return new mk}function Xl(i,t){const e=arguments.length>=2;return n=>n.pipe(i?vr((r,s)=>i(r,s,n)):Rt,Qr(1),e?EW(t):AW(()=>new mk))}var DW=D(5650);class gs extends ii{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return!e.closed&&t.next(this._value),e}getValue(){const{hasError:t,thrownError:e,_value:n}=this;if(t)throw e;return this._throwIfClosed(),n}next(t){super.next(this._value=t)}}class Rb{static hsvToRgb(t,e,n){if(t<0||t>360)throw new Error("Hue must be between 0 and 360 degree.");if(e<0||e>1)throw new Error("Saturation must be between 0 and 1.");if(n<0||n>1)throw new Error("Value must be between 0 and 1.");const r=n*e,s=r*(1-Math.abs(t/60%2-1)),a=n-r,l=[0,0,0];return t<60?(l[0]=r,l[1]=s):t<120?(l[0]=s,l[1]=r):t<180?(l[1]=r,l[2]=s):t<240?(l[1]=s,l[2]=r):t<300?(l[0]=s,l[2]=r):t<360&&(l[0]=r,l[2]=s),l.map(u=>Math.round(255*(u+a)))}static rgbToHex(t,e,n){return"#"+((1<<24)+(t<<16)+(e<<8)+n).toString(16).slice(1)}static randomColorHex(){let e="#";for(let n=0;n<6;n++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e}static jet(t){return Rb.rgbToHex(255*Math.min(1,Math.max(0,1.5-Math.abs(4*t-3))),255*Math.min(1,Math.max(0,1.5-Math.abs(4*t-2))),255*Math.min(1,Math.max(0,1.5-Math.abs(4*t-1))))}}class Nw{constructor(t,e){this.name=t,this.hue=e}colorForRelevance(t){t=Math.min(0,t),t=Math.max(1,t);const e=Rb.hsvToRgb(this.hue,Math.min(t+.1,1),1);return Rb.rgbToHex(e[0],e[1],e[2])}toString(){return`Tag ${this.name}: ${this.hue}`}}var kb=D(4999);class RW{constructor(t,e,n){this.type=t,this.domain=e,this.key=n}}var T1=(()=>{return(i=T1||(T1={})).OBJECT="OBJECT",i.SEGMENT="SEGMENT",T1;var i})(),Um=(()=>{return(i=Um||(Um={}))[i.number=1]="number",i[i.string=2]="string",Um;var i})(),Ns=(()=>{return(i=Ns||(Ns={})).EQ="=",i.NEQ="!=",i.LIKE="LIKE",i.ILIKE="ILIKE",i.NLIKE="NLIKE",i.RLIKE="RLIKE",i.ISNULL="ISNULL",i.ISNOTNULL="ISNOTNULL",i.GEQ="\u2265",i.LEQ="\u2264",i.GREATER=">",i.LESS="<",i.IN="IN",i.BETWEEN="BETWEEN",Ns;var i})(),_a=(()=>{return(i=_a||(_a={}))[i.OPTIONS=0]="OPTIONS",i[i.DATE=1]="DATE",i[i.NUMERIC=2]="NUMERIC",i[i.TEXT=3]="TEXT",i[i.RANGE=4]="RANGE",i[i.DYNAMICOPTIONS=5]="DYNAMICOPTIONS",i[i.MULTIOPTIONS=6]="MULTIOPTIONS",_a;var i})();class oy{constructor(t,e,n,r,s,a,l,u){this.displayName=t,this.featureName=e,this.inputType=n,this.valueType=u,this.operators=r||oy.getDefaultOperatorsByValueType(n),s&&(this.options=s.map(h=>oy.parse(h,this.valueType)),this.options=oy.sort(this.options,this.valueType,t)),a&&(this.shorthand=a),l&&(this.range=l,this.sliderOptions={floor:l[0],ceil:l[1],animate:!1},this.minValue=this.sliderOptions.floor,this.maxValue=this.sliderOptions.ceil)}static getDefaultOperatorsByValueType(t){let e=-1;switch(e="string"==typeof t?Number(_a[t]):t.valueOf(),e){case _a.DATE:return[Ns.EQ,Ns.NEQ,Ns.BETWEEN,Ns.LEQ,Ns.GEQ,Ns.GREATER,Ns.LESS];case _a.NUMERIC:return[Ns.NEQ,Ns.EQ,Ns.GEQ,Ns.LEQ,Ns.GREATER,Ns.LESS];case _a.MULTIOPTIONS:return[Ns.IN];case _a.OPTIONS:case _a.DYNAMICOPTIONS:return[Ns.EQ,Ns.NEQ];case _a.RANGE:return[Ns.BETWEEN];case _a.TEXT:return[Ns.LIKE,Ns.EQ];default:return void console.error("type "+t+" not known")}}static getOperatorName(t){switch(t){case Ns.EQ:return"EQ";case Ns.NEQ:return"NEQ";case Ns.LIKE:return"LIKE";case Ns.ILIKE:return"ILIKE";case Ns.NLIKE:return"NLIKE";case Ns.RLIKE:return"RLIKE";case Ns.ISNULL:return"ISNULL";case Ns.ISNOTNULL:return"ISNOTNULL";case Ns.GEQ:return"GEQ";case Ns.LEQ:return"LEQ";case Ns.GREATER:return"GREATER";case Ns.LESS:return"LESS";case Ns.IN:return"IN";case Ns.BETWEEN:return"BETWEEN"}return console.error("Could not match operator "+t),""}static parse(t,e){if(e){let n=-1;switch(n="string"==typeof e?Number(Um[e]):e,n.valueOf()){case Um.number.valueOf():return Number(t);case Um.string.valueOf():return t}}return t}static sort(t,e,n){if(e){let r=-1;switch(r="string"==typeof e?Number(Um[e]):e,r.valueOf()){case Um.number.valueOf():return t.sort((s,a)=>s-a);case Um.string.valueOf():return t}}return t}}let Pb=(()=>{class i{constructor(e,n,r,s,a,l,u,h){var m;this._config={title:"vitrivr",api:{host:window.location.hostname,port:4567,http_secure:!1,ws_secure:!1,ping_interval:5e3},resources:{host_thumbnails:window.location.protocol+"//"+window.location.hostname+":80/vitrivr/thumbnails",host_objects:window.location.protocol+"//"+window.location.hostname+":80/vitrivr/objects",suffix_default:".jpg",suffix:{IMAGE:"png",VIDEO:"png"},port:"$host"},competition:{vbs:!1,lsc:!1,host:"",tls:!1,log:!1,loginterval:5e3,collabordinator:null,textualInput:!1},tags:[new Nw("Red",0),new Nw("Orange",30),new Nw("Blue",240),new Nw("Violet",270),new Nw("Magenta",300)],mlt:{MODEL3D:["sphericalharmonicsdefault"],IMAGE:["visualtextcoembedding"],VIDEO:["visualtextcoembedding"],AUDIO:["audiofingerprint"],IMAGE_SEQUENCE:["visualtextcoembedding"]},query:{history:-1,scoreFunction:"average",temporalView:!0,options:{image:!0,audio:!1,model3d:!1,text:!0,tag:!1,map:!1,semantic:!0,boolean:!0,skeleton:!1},metadata:{object:[["*","*"]],segment:[["*","*"]]},config:{queryId:null,neighboringSegmentLookupCount:5,neighboringSegmentLookupAllCount:2e5},text:{categories:["visualtextcoembedding","Text Co-Embedding"]},boolean:[{display:"Segment Id",input:_a.TEXT,table:"cineast_segment",col:"segmentid",operators:["="]},{display:"Object Id",input:_a.TEXT,table:"cineast_segment",col:"objectid",operators:["="]}],temporal_mode:"TEMPORAL_DISTANCE",enableTagPrioritisation:!1,temporal_max_length:600,default_temporal_distance:10},refinement:{filters:[["dominantcolor.color","CHECKBOX"],["technical.duration","SLIDER"]],showMetadataInViewer:!1}};const _=(v,S,T)=>S;if(e&&(this._config.title=e),n&&(this._config.api=kb(this._config.api,n,{arrayMerge:_})),r&&(this._config.resources=kb(this._config.resources,r,{arrayMerge:_})),s&&(this._config.query=kb(this._config.query,s,{arrayMerge:_})),a&&(this._config.competition=kb(this._config.competition,a,{arrayMerge:_})),l&&(this._config.tags=kb(this._config.tags,l,{arrayMerge:_})),u&&(this._config.mlt=kb(this._config.mlt,u,{arrayMerge:_})),h&&(this._config.refinement=kb(this._config.refinement,h,{arrayMerge:_})),"$host"===this._config.api.host&&(this._config.api.host=window.location.hostname),this._config.resources.host_objects=this._config.resources.host_objects.replace("/$host/","/"+window.location.hostname+"/"),this._config.resources.host_thumbnails=this._config.resources.host_thumbnails.replace("/$host/","/"+window.location.hostname+"/"),this._config.resources.port){const v=this._config.resources.port;let S=window.location.port;"$api"===v?S=""+this._config.api.port:(null===(m=v.match(i.PORT_REGEX))||void 0===m?void 0:m.length)>0&&(S=""+v),this._config.resources.host_objects=this._config.resources.host_objects.replace(i.PORT_REGEX,":"+S+"/"),this._config.resources.host_thumbnails=this._config.resources.host_thumbnails.replace(i.PORT_REGEX,":"+S+"/")}}get cineastEndpointWs(){return this._config.api.host&&this._config.api.port?(this._config.api.ws_secure?"wss://":"ws://")+this._config.api.host+":"+this._config.api.port+"/"+i.CONTEXT+"/"+i.VERSION+"/websocket":null}get cineastEndpointRest(){return this._config.api.host&&this._config.api.port?(this._config.api.http_secure?"https://":"http://")+this._config.api.host+":"+this._config.api.port:null}get dresEndpointRest(){return this._config.competition.host?`${this._config.competition.tls?"https://":"http://"}${this._config.competition.host}`:null}get metadataAccessSpec(){let e=[];return this._config.query.metadata.object.forEach(n=>e.push(new RW(T1.OBJECT,n[0],n[1]))),this._config.query.metadata.segment.forEach(n=>e.push(new RW(T1.SEGMENT,n[0],n[1]))),e}static deserialize(e){return"string"==typeof e&&(e=JSON.parse(e)),e.api||e.resources||e.query||e.competition||e.tags||e.mlt||e.refinement?new i(e.title,e.api,e.resources,e.query,e.competition,e.tags,e.mlt,e.refinement):null}get(e){try{const n=".";return e.replace("[",n).replace("]","").split(n).reduce((s,a)=>s[a],this._config)}catch(n){return null}}set(e,n){try{const r=".",s=e.replace("[",r).replace("]","").split(r),a=s[s.length-1],l=s.reduce((u,h)=>h===a?u:u[h],this._config);return!(!l[a]||typeof n!=typeof l[a]||(l[a]=n,0))}catch(r){return!1}}}return i.CONTEXT="api",i.VERSION="v1",i.DB_KEY="main",i.SNACKBAR_DURATION=2500,i.PORT_REGEX=/:([1-9][0-9]{0,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])\//,i})();function tn(i){return null!=i&&"false"!=`${i}`}function Qo(i,t=0){return function fle(i){return!isNaN(parseFloat(i))&&!isNaN(Number(i))}(i)?Number(i):t}function E1(i){return Array.isArray(i)?i:[i]}function Zl(i){return null==i?"":"string"==typeof i?i:`${i}px`}function Gm(i){return i instanceof ai?i.nativeElement:i}const mle=["addListener","removeListener"],gle=["addEventListener","removeEventListener"],_le=["on","off"];function os(i,t,e,n){if(z(e)&&(n=e,e=void 0),n)return os(i,t,e).pipe(W3(n));const[r,s]=function ble(i){return z(i.addEventListener)&&z(i.removeEventListener)}(i)?gle.map(a=>l=>i[a](t,l,e)):function yle(i){return z(i.addListener)&&z(i.removeListener)}(i)?mle.map(kW(i,t)):function vle(i){return z(i.on)&&z(i.off)}(i)?_le.map(kW(i,t)):[];if(!r&&Ni(i))return ks(a=>os(a,t,e))(eo(i));if(!r)throw new TypeError("Invalid event target");return new ft(a=>{const l=(...u)=>a.next(1<u.length?u:u[0]);return r(l),()=>s(l)})}function kW(i,t){return e=>n=>i[e](t,n)}class xle extends Q{constructor(t,e){super()}schedule(t,e=0){return this}}const gk={setInterval(i,t,...e){const{delegate:n}=gk;return(null==n?void 0:n.setInterval)?n.setInterval(i,t,...e):setInterval(i,t,...e)},clearInterval(i){const{delegate:t}=gk;return((null==t?void 0:t.clearInterval)||clearInterval)(i)},delegate:void 0};class BB extends xle{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){if(this.closed)return this;this.state=t;const n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(r,this.id,e),this}requestAsyncId(t,e,n=0){return gk.setInterval(t.flush.bind(t,this),n)}recycleAsyncId(t,e,n=0){if(null!=n&&this.delay===n&&!1===this.pending)return e;gk.clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(t,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let r,n=!1;try{this.work(t)}catch(s){n=!0,r=s||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:t,scheduler:e}=this,{actions:n}=e;this.work=this.state=this.scheduler=null,this.pending=!1,te(n,this),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null,super.unsubscribe()}}}const A1={schedule(i){let t=requestAnimationFrame,e=cancelAnimationFrame;const{delegate:n}=A1;n&&(t=n.requestAnimationFrame,e=n.cancelAnimationFrame);const r=t(s=>{e=void 0,i(s)});return new Q(()=>null==e?void 0:e(r))},requestAnimationFrame(...i){const{delegate:t}=A1;return((null==t?void 0:t.requestAnimationFrame)||requestAnimationFrame)(...i)},cancelAnimationFrame(...i){const{delegate:t}=A1;return((null==t?void 0:t.cancelAnimationFrame)||cancelAnimationFrame)(...i)},delegate:void 0},_k={now:()=>(_k.delegate||Date).now(),delegate:void 0};class D1{constructor(t,e=D1.now){this.schedulerActionCtor=t,this.now=e}schedule(t,e=0,n){return new this.schedulerActionCtor(this,t).schedule(n,e)}}D1.now=_k.now;class NB extends D1{constructor(t,e=D1.now){super(t,e),this.actions=[],this._active=!1,this._scheduled=void 0}flush(t){const{actions:e}=this;if(this._active)return void e.push(t);let n;this._active=!0;do{if(n=t.execute(t.state,t.delay))break}while(t=e.shift());if(this._active=!1,n){for(;t=e.shift();)t.unsubscribe();throw n}}}new class Sle extends NB{flush(t){this._active=!0;const e=this._scheduled;this._scheduled=void 0;const{actions:n}=this;let r;t=t||n.shift();do{if(r=t.execute(t.state,t.delay))break}while((t=n[0])&&t.id===e&&n.shift());if(this._active=!1,r){for(;(t=n[0])&&t.id===e&&n.shift();)t.unsubscribe();throw r}}}(class wle extends BB{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}requestAsyncId(t,e,n=0){return null!==n&&n>0?super.requestAsyncId(t,e,n):(t.actions.push(this),t._scheduled||(t._scheduled=A1.requestAnimationFrame(()=>t.flush(void 0))))}recycleAsyncId(t,e,n=0){if(null!=n&&n>0||null==n&&this.delay>0)return super.recycleAsyncId(t,e,n);t.actions.some(r=>r.id===e)||(A1.cancelAnimationFrame(e),t._scheduled=void 0)}});let HB,Mle=1;const yk={};function PW(i){return i in yk&&(delete yk[i],!0)}const Tle={setImmediate(i){const t=Mle++;return yk[t]=!0,HB||(HB=Promise.resolve()),HB.then(()=>PW(t)&&i()),t},clearImmediate(i){PW(i)}},{setImmediate:Ele,clearImmediate:Ale}=Tle,vk={setImmediate(...i){const{delegate:t}=vk;return((null==t?void 0:t.setImmediate)||Ele)(...i)},clearImmediate(i){const{delegate:t}=vk;return((null==t?void 0:t.clearImmediate)||Ale)(i)},delegate:void 0},VB=new class Rle extends NB{flush(t){this._active=!0;const e=this._scheduled;this._scheduled=void 0;const{actions:n}=this;let r;t=t||n.shift();do{if(r=t.execute(t.state,t.delay))break}while((t=n[0])&&t.id===e&&n.shift());if(this._active=!1,r){for(;(t=n[0])&&t.id===e&&n.shift();)t.unsubscribe();throw r}}}(class Dle extends BB{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}requestAsyncId(t,e,n=0){return null!==n&&n>0?super.requestAsyncId(t,e,n):(t.actions.push(this),t._scheduled||(t._scheduled=vk.setImmediate(t.flush.bind(t,void 0))))}recycleAsyncId(t,e,n=0){if(null!=n&&n>0||null==n&&this.delay>0)return super.recycleAsyncId(t,e,n);t.actions.some(r=>r.id===e)||(vk.clearImmediate(e),t._scheduled=void 0)}}),Hw=new NB(BB),kle=Hw;function ay(i=0,t,e=kle){let n=-1;return null!=t&&(Qp(t)?e=t:n=t),new ft(r=>{let s=function Ile(i){return i instanceof Date&&!isNaN(i)}(i)?+i-e.now():i;s<0&&(s=0);let a=0;return e.schedule(function(){r.closed||(r.next(a++),0<=n?this.schedule(void 0,n):r.complete())},s)})}function IW(i,t=Hw){return function Ple(i){return gr((t,e)=>{let n=!1,r=null,s=null,a=!1;const l=()=>{if(null==s||s.unsubscribe(),s=null,n){n=!1;const h=r;r=null,e.next(h)}a&&e.complete()},u=()=>{s=null,a&&e.complete()};t.subscribe(qn(e,h=>{n=!0,r=h,s||eo(i(h)).subscribe(s=qn(e,l,u))},()=>{a=!0,(!n||!s||s.closed)&&e.complete()}))})}(()=>ay(i,t))}function $n(i){return gr((t,e)=>{eo(i).subscribe(qn(e,()=>e.complete(),G)),!e.closed&&t.subscribe(e)})}let zB;try{zB="undefined"!=typeof Intl&&Intl.v8BreakIterator}catch(i){zB=!1}let Vw,ta=(()=>{class i{constructor(e){this._platformId=e,this.isBrowser=this._platformId?wb(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!zB)&&"undefined"!=typeof CSS&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return i.\u0275fac=function(e){return new(e||i)(Ve(kh))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const LW=["color","button","checkbox","date","datetime-local","email","file","hidden","image","month","number","password","radio","range","reset","search","submit","tel","text","time","url","week"];function OW(){if(Vw)return Vw;if("object"!=typeof document||!document)return Vw=new Set(LW),Vw;let i=document.createElement("input");return Vw=new Set(LW.filter(t=>(i.setAttribute("type",t),i.type===t))),Vw}let R1,bk,Ib,UB;function ly(i){return function Lle(){if(null==R1&&"undefined"!=typeof window)try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>R1=!0}))}finally{R1=R1||!1}return R1}()?i:!!i.capture}function FW(){if(null==Ib){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return Ib=!1,Ib;if("scrollBehavior"in document.documentElement.style)Ib=!0;else{const i=Element.prototype.scrollTo;Ib=!!i&&!/\{\s*\[native code\]\s*\}/.test(i.toString())}}return Ib}function k1(){if("object"!=typeof document||!document)return 0;if(null==bk){const i=document.createElement("div"),t=i.style;i.dir="rtl",t.width="1px",t.overflow="auto",t.visibility="hidden",t.pointerEvents="none",t.position="absolute";const e=document.createElement("div"),n=e.style;n.width="2px",n.height="1px",i.appendChild(e),document.body.appendChild(i),bk=0,0===i.scrollLeft&&(i.scrollLeft=1,bk=0===i.scrollLeft?1:2),i.remove()}return bk}function BW(i){if(function Ole(){if(null==UB){const i="undefined"!=typeof document?document.head:null;UB=!(!i||!i.createShadowRoot&&!i.attachShadow)}return UB}()){const t=i.getRootNode?i.getRootNode():null;if("undefined"!=typeof ShadowRoot&&ShadowRoot&&t instanceof ShadowRoot)return t}return null}function zw(){let i="undefined"!=typeof document&&document?document.activeElement:null;for(;i&&i.shadowRoot;){const t=i.shadowRoot.activeElement;if(t===i)break;i=t}return i}function cy(i){return i.composedPath?i.composedPath()[0]:i.target}function GB(){return"undefined"!=typeof __karma__&&!!__karma__||"undefined"!=typeof jasmine&&!!jasmine||"undefined"!=typeof jest&&!!jest||"undefined"!=typeof Mocha&&!!Mocha}const Fle=new gi("cdk-dir-doc",{providedIn:"root",factory:function Ble(){return f_(ar)}}),Nle=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let Ia=(()=>{class i{constructor(e){if(this.value="ltr",this.change=new Si,e){const r=e.documentElement?e.documentElement.dir:null;this.value=function Hle(i){const t=(null==i?void 0:i.toLowerCase())||"";return"auto"===t&&"undefined"!=typeof navigator&&(null==navigator?void 0:navigator.language)?Nle.test(navigator.language)?"rtl":"ltr":"rtl"===t?"rtl":"ltr"}((e.body?e.body.dir:null)||r||"ltr")}}ngOnDestroy(){this.change.complete()}}return i.\u0275fac=function(e){return new(e||i)(Ve(Fle,8))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Uw=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({}),i})(),P1=(()=>{class i{constructor(e,n,r){this._ngZone=e,this._platform=n,this._scrolled=new ii,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=r}register(e){this.scrollContainers.has(e)||this.scrollContainers.set(e,e.elementScrolled().subscribe(()=>this._scrolled.next(e)))}deregister(e){const n=this.scrollContainers.get(e);n&&(n.unsubscribe(),this.scrollContainers.delete(e))}scrolled(e=20){return this._platform.isBrowser?new ft(n=>{this._globalSubscription||this._addGlobalListener();const r=e>0?this._scrolled.pipe(IW(e)).subscribe(n):this._scrolled.subscribe(n);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):Qn()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((e,n)=>this.deregister(n)),this._scrolled.complete()}ancestorScrolled(e,n){const r=this.getAncestorScrollContainers(e);return this.scrolled(n).pipe(vr(s=>!s||r.indexOf(s)>-1))}getAncestorScrollContainers(e){const n=[];return this.scrollContainers.forEach((r,s)=>{this._scrollableContainsElement(s,e)&&n.push(s)}),n}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(e,n){let r=Gm(n),s=e.getElementRef().nativeElement;do{if(r==s)return!0}while(r=r.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>os(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return i.\u0275fac=function(e){return new(e||i)(Ve(Rn),Ve(ta),Ve(ar,8))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),I1=(()=>{class i{constructor(e,n,r,s){this.elementRef=e,this.scrollDispatcher=n,this.ngZone=r,this.dir=s,this._destroyed=new ii,this._elementScrolled=new ft(a=>this.ngZone.runOutsideAngular(()=>os(this.elementRef.nativeElement,"scroll").pipe($n(this._destroyed)).subscribe(a)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(e){const n=this.elementRef.nativeElement,r=this.dir&&"rtl"==this.dir.value;null==e.left&&(e.left=r?e.end:e.start),null==e.right&&(e.right=r?e.start:e.end),null!=e.bottom&&(e.top=n.scrollHeight-n.clientHeight-e.bottom),r&&0!=k1()?(null!=e.left&&(e.right=n.scrollWidth-n.clientWidth-e.left),2==k1()?e.left=e.right:1==k1()&&(e.left=e.right?-e.right:e.right)):null!=e.right&&(e.left=n.scrollWidth-n.clientWidth-e.right),this._applyScrollToOptions(e)}_applyScrollToOptions(e){const n=this.elementRef.nativeElement;FW()?n.scrollTo(e):(null!=e.top&&(n.scrollTop=e.top),null!=e.left&&(n.scrollLeft=e.left))}measureScrollOffset(e){const n="left",r="right",s=this.elementRef.nativeElement;if("top"==e)return s.scrollTop;if("bottom"==e)return s.scrollHeight-s.clientHeight-s.scrollTop;const a=this.dir&&"rtl"==this.dir.value;return"start"==e?e=a?r:n:"end"==e&&(e=a?n:r),a&&2==k1()?e==n?s.scrollWidth-s.clientWidth-s.scrollLeft:s.scrollLeft:a&&1==k1()?e==n?s.scrollLeft+s.scrollWidth-s.clientWidth:-s.scrollLeft:e==n?s.scrollLeft:s.scrollWidth-s.clientWidth-s.scrollLeft}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(P1),B(Rn),B(Ia,8))},i.\u0275dir=Be({type:i,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]]}),i})(),Tp=(()=>{class i{constructor(e,n,r){this._platform=e,this._change=new ii,this._changeListener=s=>{this._change.next(s)},this._document=r,n.runOutsideAngular(()=>{if(e.isBrowser){const s=this._getWindow();s.addEventListener("resize",this._changeListener),s.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const e=this._getWindow();e.removeEventListener("resize",this._changeListener),e.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const e={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),e}getViewportRect(){const e=this.getViewportScrollPosition(),{width:n,height:r}=this.getViewportSize();return{top:e.top,left:e.left,bottom:e.top+r,right:e.left+n,height:r,width:n}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const e=this._document,n=this._getWindow(),r=e.documentElement,s=r.getBoundingClientRect();return{top:-s.top||e.body.scrollTop||n.scrollY||r.scrollTop||0,left:-s.left||e.body.scrollLeft||n.scrollX||r.scrollLeft||0}}change(e=20){return e>0?this._change.pipe(IW(e)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const e=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:e.innerWidth,height:e.innerHeight}:{width:0,height:0}}}return i.\u0275fac=function(e){return new(e||i)(Ve(ta),Ve(Rn),Ve(ar,8))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),uy=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({}),i})(),WB=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[Uw,uy],Uw,uy]}),i})();class jB{attach(t){return this._attachedHost=t,t.attach(this)}detach(){let t=this._attachedHost;null!=t&&(this._attachedHost=null,t.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(t){this._attachedHost=t}}class hy extends jB{constructor(t,e,n,r){super(),this.component=t,this.viewContainerRef=e,this.injector=n,this.componentFactoryResolver=r}}class Ep extends jB{constructor(t,e,n){super(),this.templateRef=t,this.viewContainerRef=e,this.context=n}get origin(){return this.templateRef.elementRef}attach(t,e=this.context){return this.context=e,super.attach(t)}detach(){return this.context=void 0,super.detach()}}class Ule extends jB{constructor(t){super(),this.element=t instanceof ai?t.nativeElement:t}}class L1{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(t){return t instanceof hy?(this._attachedPortal=t,this.attachComponentPortal(t)):t instanceof Ep?(this._attachedPortal=t,this.attachTemplatePortal(t)):this.attachDomPortal&&t instanceof Ule?(this._attachedPortal=t,this.attachDomPortal(t)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(t){this._disposeFn=t}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class NW extends L1{constructor(t,e,n,r,s){super(),this.outletElement=t,this._componentFactoryResolver=e,this._appRef=n,this._defaultInjector=r,this.attachDomPortal=a=>{const l=a.element,u=this._document.createComment("dom-portal");l.parentNode.insertBefore(u,l),this.outletElement.appendChild(l),this._attachedPortal=a,super.setDisposeFn(()=>{u.parentNode&&u.parentNode.replaceChild(l,u)})},this._document=s}attachComponentPortal(t){const n=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component);let r;return t.viewContainerRef?(r=t.viewContainerRef.createComponent(n,t.viewContainerRef.length,t.injector||t.viewContainerRef.injector),this.setDisposeFn(()=>r.destroy())):(r=n.create(t.injector||this._defaultInjector||Os.NULL),this._appRef.attachView(r.hostView),this.setDisposeFn(()=>{this._appRef.detachView(r.hostView),r.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(r)),this._attachedPortal=t,r}attachTemplatePortal(t){let e=t.viewContainerRef,n=e.createEmbeddedView(t.templateRef,t.context);return n.rootNodes.forEach(r=>this.outletElement.appendChild(r)),n.detectChanges(),this.setDisposeFn(()=>{let r=e.indexOf(n);-1!==r&&e.remove(r)}),this._attachedPortal=t,n}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(t){return t.hostView.rootNodes[0]}}let Gle=(()=>{class i extends Ep{constructor(e,n){super(e,n)}}return i.\u0275fac=function(e){return new(e||i)(B(Xo),B(Ko))},i.\u0275dir=Be({type:i,selectors:[["","cdkPortal",""]],exportAs:["cdkPortal"],features:[It]}),i})(),Wm=(()=>{class i extends L1{constructor(e,n,r){super(),this._componentFactoryResolver=e,this._viewContainerRef=n,this._isInitialized=!1,this.attached=new Si,this.attachDomPortal=s=>{const a=s.element,l=this._document.createComment("dom-portal");s.setAttachedHost(this),a.parentNode.insertBefore(l,a),this._getRootNode().appendChild(a),this._attachedPortal=s,super.setDisposeFn(()=>{l.parentNode&&l.parentNode.replaceChild(a,l)})},this._document=r}get portal(){return this._attachedPortal}set portal(e){this.hasAttached()&&!e&&!this._isInitialized||(this.hasAttached()&&super.detach(),e&&super.attach(e),this._attachedPortal=e||null)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedPortal=null,this._attachedRef=null}attachComponentPortal(e){e.setAttachedHost(this);const n=null!=e.viewContainerRef?e.viewContainerRef:this._viewContainerRef,s=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component),a=n.createComponent(s,n.length,e.injector||n.injector);return n!==this._viewContainerRef&&this._getRootNode().appendChild(a.hostView.rootNodes[0]),super.setDisposeFn(()=>a.destroy()),this._attachedPortal=e,this._attachedRef=a,this.attached.emit(a),a}attachTemplatePortal(e){e.setAttachedHost(this);const n=this._viewContainerRef.createEmbeddedView(e.templateRef,e.context);return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=e,this._attachedRef=n,this.attached.emit(n),n}_getRootNode(){const e=this._viewContainerRef.element.nativeElement;return e.nodeType===e.ELEMENT_NODE?e:e.parentNode}}return i.\u0275fac=function(e){return new(e||i)(B(xp),B(Ko),B(ar))},i.\u0275dir=Be({type:i,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:["cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[It]}),i})(),O1=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({}),i})();function dc(i,...t){return t.length?t.some(e=>i[e]):i.altKey||i.shiftKey||i.ctrlKey||i.metaKey}const zW=FW();class ice{constructor(t,e){this._viewportRuler=t,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=e}attach(){}enable(){if(this._canBeEnabled()){const t=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=t.style.left||"",this._previousHTMLStyles.top=t.style.top||"",t.style.left=Zl(-this._previousScrollPosition.left),t.style.top=Zl(-this._previousScrollPosition.top),t.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const t=this._document.documentElement,n=t.style,r=this._document.body.style,s=n.scrollBehavior||"",a=r.scrollBehavior||"";this._isEnabled=!1,n.left=this._previousHTMLStyles.left,n.top=this._previousHTMLStyles.top,t.classList.remove("cdk-global-scrollblock"),zW&&(n.scrollBehavior=r.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),zW&&(n.scrollBehavior=s,r.scrollBehavior=a)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const e=this._document.body,n=this._viewportRuler.getViewportSize();return e.scrollHeight>n.height||e.scrollWidth>n.width}}class nce{constructor(t,e,n,r){this._scrollDispatcher=t,this._ngZone=e,this._viewportRuler=n,this._config=r,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(t){this._overlayRef=t}enable(){if(this._scrollSubscription)return;const t=this._scrollDispatcher.scrolled(0);this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=t.subscribe(()=>{const e=this._viewportRuler.getViewportScrollPosition().top;Math.abs(e-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=t.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class UW{enable(){}disable(){}attach(){}}function YB(i,t){return t.some(e=>i.bottom<e.top||i.top>e.bottom||i.right<e.left||i.left>e.right)}function GW(i,t){return t.some(e=>i.top<e.top||i.bottom>e.bottom||i.left<e.left||i.right>e.right)}class rce{constructor(t,e,n,r){this._scrollDispatcher=t,this._viewportRuler=e,this._ngZone=n,this._config=r,this._scrollSubscription=null}attach(t){this._overlayRef=t}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const e=this._overlayRef.overlayElement.getBoundingClientRect(),{width:n,height:r}=this._viewportRuler.getViewportSize();YB(e,[{width:n,height:r,bottom:r,right:n,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let sce=(()=>{class i{constructor(e,n,r,s){this._scrollDispatcher=e,this._viewportRuler=n,this._ngZone=r,this.noop=()=>new UW,this.close=a=>new nce(this._scrollDispatcher,this._ngZone,this._viewportRuler,a),this.block=()=>new ice(this._viewportRuler,this._document),this.reposition=a=>new rce(this._scrollDispatcher,this._viewportRuler,this._ngZone,a),this._document=s}}return i.\u0275fac=function(e){return new(e||i)(Ve(P1),Ve(Tp),Ve(Rn),Ve(ar))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();class Fb{constructor(t){if(this.scrollStrategy=new UW,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,t){const e=Object.keys(t);for(const n of e)void 0!==t[n]&&(this[n]=t[n])}}}class oce{constructor(t,e){this.connectionPair=t,this.scrollableViewProperties=e}}class ace{constructor(t,e,n,r,s,a,l,u,h){this._portalOutlet=t,this._host=e,this._pane=n,this._config=r,this._ngZone=s,this._keyboardDispatcher=a,this._document=l,this._location=u,this._outsideClickDispatcher=h,this._backdropElement=null,this._backdropClick=new ii,this._attachments=new ii,this._detachments=new ii,this._locationChanges=Q.EMPTY,this._backdropClickHandler=m=>this._backdropClick.next(m),this._backdropTransitionendHandler=m=>{this._disposeBackdrop(m.target)},this._keydownEvents=new ii,this._outsidePointerEvents=new ii,r.scrollStrategy&&(this._scrollStrategy=r.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=r.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(t){let e=this._portalOutlet.attach(t);return!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host),this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe(Qr(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),e}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const t=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),t}dispose(){var t;const e=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),null===(t=this._host)||void 0===t||t.remove(),this._previousHostParent=this._pane=this._host=null,e&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(t){t!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=t,this.hasAttached()&&(t.attach(this),this.updatePosition()))}updateSize(t){this._config=Object.assign(Object.assign({},this._config),t),this._updateElementSize()}setDirection(t){this._config=Object.assign(Object.assign({},this._config),{direction:t}),this._updateElementDirection()}addPanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!0)}removePanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!1)}getDirection(){const t=this._config.direction;return t?"string"==typeof t?t:t.value:"ltr"}updateScrollStrategy(t){t!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=t,this.hasAttached()&&(t.attach(this),t.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const t=this._pane.style;t.width=Zl(this._config.width),t.height=Zl(this._config.height),t.minWidth=Zl(this._config.minWidth),t.minHeight=Zl(this._config.minHeight),t.maxWidth=Zl(this._config.maxWidth),t.maxHeight=Zl(this._config.maxHeight)}_togglePointerEvents(t){this._pane.style.pointerEvents=t?"":"none"}_attachBackdrop(){const t="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),"undefined"!=typeof requestAnimationFrame?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(t)})}):this._backdropElement.classList.add(t)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const t=this._backdropElement;!t||(t.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{t.addEventListener("transitionend",this._backdropTransitionendHandler)}),t.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(t)},500)))}_toggleClasses(t,e,n){const r=E1(e||[]).filter(s=>!!s);r.length&&(n?t.classList.add(...r):t.classList.remove(...r))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const t=this._ngZone.onStable.pipe($n(uo(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),t.unsubscribe())})})}_disposeScrollStrategy(){const t=this._scrollStrategy;t&&(t.disable(),t.detach&&t.detach())}_disposeBackdrop(t){t&&(t.removeEventListener("click",this._backdropClickHandler),t.removeEventListener("transitionend",this._backdropTransitionendHandler),t.remove(),this._backdropElement===t&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}}let KB=(()=>{class i{constructor(e,n){this._platform=n,this._document=e}ngOnDestroy(){var e;null===(e=this._containerElement)||void 0===e||e.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const e="cdk-overlay-container";if(this._platform.isBrowser||GB()){const r=this._document.querySelectorAll(`.${e}[platform="server"], .${e}[platform="test"]`);for(let s=0;s<r.length;s++)r[s].remove()}const n=this._document.createElement("div");n.classList.add(e),GB()?n.setAttribute("platform","test"):this._platform.isBrowser||n.setAttribute("platform","server"),this._document.body.appendChild(n),this._containerElement=n}}return i.\u0275fac=function(e){return new(e||i)(Ve(ar),Ve(ta))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const WW="cdk-overlay-connected-position-bounding-box",lce=/([A-Za-z%]+)$/;class cce{constructor(t,e,n,r,s){this._viewportRuler=e,this._document=n,this._platform=r,this._overlayContainer=s,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new ii,this._resizeSubscription=Q.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(t)}get positions(){return this._preferredPositions}attach(t){this._validatePositions(),t.hostElement.classList.add(WW),this._overlayRef=t,this._boundingBox=t.hostElement,this._pane=t.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const t=this._originRect,e=this._overlayRect,n=this._viewportRect,r=this._containerRect,s=[];let a;for(let l of this._preferredPositions){let u=this._getOriginPoint(t,r,l),h=this._getOverlayPoint(u,e,l),m=this._getOverlayFit(h,e,n,l);if(m.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(l,u);this._canFitWithFlexibleDimensions(m,h,n)?s.push({position:l,origin:u,overlayRect:e,boundingBoxRect:this._calculateBoundingBoxRect(u,l)}):(!a||a.overlayFit.visibleArea<m.visibleArea)&&(a={overlayFit:m,overlayPoint:h,originPoint:u,position:l,overlayRect:e})}if(s.length){let l=null,u=-1;for(const h of s){const m=h.boundingBoxRect.width*h.boundingBoxRect.height*(h.position.weight||1);m>u&&(u=m,l=h)}return this._isPushed=!1,void this._applyPosition(l.position,l.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(a.position,a.originPoint);this._applyPosition(a.position,a.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&Bb(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(WW),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const t=this._lastPosition;if(t){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const e=this._getOriginPoint(this._originRect,this._containerRect,t);this._applyPosition(t,e)}else this.apply()}withScrollableContainers(t){return this._scrollables=t,this}withPositions(t){return this._preferredPositions=t,-1===t.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(t){return this._viewportMargin=t,this}withFlexibleDimensions(t=!0){return this._hasFlexibleDimensions=t,this}withGrowAfterOpen(t=!0){return this._growAfterOpen=t,this}withPush(t=!0){return this._canPush=t,this}withLockedPosition(t=!0){return this._positionLocked=t,this}setOrigin(t){return this._origin=t,this}withDefaultOffsetX(t){return this._offsetX=t,this}withDefaultOffsetY(t){return this._offsetY=t,this}withTransformOriginOn(t){return this._transformOriginSelector=t,this}_getOriginPoint(t,e,n){let r,s;if("center"==n.originX)r=t.left+t.width/2;else{const a=this._isRtl()?t.right:t.left,l=this._isRtl()?t.left:t.right;r="start"==n.originX?a:l}return e.left<0&&(r-=e.left),s="center"==n.originY?t.top+t.height/2:"top"==n.originY?t.top:t.bottom,e.top<0&&(s-=e.top),{x:r,y:s}}_getOverlayPoint(t,e,n){let r,s;return r="center"==n.overlayX?-e.width/2:"start"===n.overlayX?this._isRtl()?-e.width:0:this._isRtl()?0:-e.width,s="center"==n.overlayY?-e.height/2:"top"==n.overlayY?0:-e.height,{x:t.x+r,y:t.y+s}}_getOverlayFit(t,e,n,r){const s=qW(e);let{x:a,y:l}=t,u=this._getOffset(r,"x"),h=this._getOffset(r,"y");u&&(a+=u),h&&(l+=h);let v=0-l,S=l+s.height-n.height,T=this._subtractOverflows(s.width,0-a,a+s.width-n.width),I=this._subtractOverflows(s.height,v,S),j=T*I;return{visibleArea:j,isCompletelyWithinViewport:s.width*s.height===j,fitsInViewportVertically:I===s.height,fitsInViewportHorizontally:T==s.width}}_canFitWithFlexibleDimensions(t,e,n){if(this._hasFlexibleDimensions){const r=n.bottom-e.y,s=n.right-e.x,a=jW(this._overlayRef.getConfig().minHeight),l=jW(this._overlayRef.getConfig().minWidth),h=t.fitsInViewportHorizontally||null!=l&&l<=s;return(t.fitsInViewportVertically||null!=a&&a<=r)&&h}return!1}_pushOverlayOnScreen(t,e,n){if(this._previousPushAmount&&this._positionLocked)return{x:t.x+this._previousPushAmount.x,y:t.y+this._previousPushAmount.y};const r=qW(e),s=this._viewportRect,a=Math.max(t.x+r.width-s.width,0),l=Math.max(t.y+r.height-s.height,0),u=Math.max(s.top-n.top-t.y,0),h=Math.max(s.left-n.left-t.x,0);let m=0,_=0;return m=r.width<=s.width?h||-a:t.x<this._viewportMargin?s.left-n.left-t.x:0,_=r.height<=s.height?u||-l:t.y<this._viewportMargin?s.top-n.top-t.y:0,this._previousPushAmount={x:m,y:_},{x:t.x+m,y:t.y+_}}_applyPosition(t,e){if(this._setTransformOrigin(t),this._setOverlayElementStyles(e,t),this._setBoundingBoxStyles(e,t),t.panelClass&&this._addPanelClasses(t.panelClass),this._lastPosition=t,this._positionChanges.observers.length){const n=this._getScrollVisibility(),r=new oce(t,n);this._positionChanges.next(r)}this._isInitialRender=!1}_setTransformOrigin(t){if(!this._transformOriginSelector)return;const e=this._boundingBox.querySelectorAll(this._transformOriginSelector);let n,r=t.overlayY;n="center"===t.overlayX?"center":this._isRtl()?"start"===t.overlayX?"right":"left":"start"===t.overlayX?"left":"right";for(let s=0;s<e.length;s++)e[s].style.transformOrigin=`${n} ${r}`}_calculateBoundingBoxRect(t,e){const n=this._viewportRect,r=this._isRtl();let s,a,l,m,_,v;if("top"===e.overlayY)a=t.y,s=n.height-a+this._viewportMargin;else if("bottom"===e.overlayY)l=n.height-t.y+2*this._viewportMargin,s=n.height-l+this._viewportMargin;else{const S=Math.min(n.bottom-t.y+n.top,t.y),T=this._lastBoundingBoxSize.height;s=2*S,a=t.y-S,s>T&&!this._isInitialRender&&!this._growAfterOpen&&(a=t.y-T/2)}if("end"===e.overlayX&&!r||"start"===e.overlayX&&r)v=n.width-t.x+this._viewportMargin,m=t.x-this._viewportMargin;else if("start"===e.overlayX&&!r||"end"===e.overlayX&&r)_=t.x,m=n.right-t.x;else{const S=Math.min(n.right-t.x+n.left,t.x),T=this._lastBoundingBoxSize.width;m=2*S,_=t.x-S,m>T&&!this._isInitialRender&&!this._growAfterOpen&&(_=t.x-T/2)}return{top:a,left:_,bottom:l,right:v,width:m,height:s}}_setBoundingBoxStyles(t,e){const n=this._calculateBoundingBoxRect(t,e);!this._isInitialRender&&!this._growAfterOpen&&(n.height=Math.min(n.height,this._lastBoundingBoxSize.height),n.width=Math.min(n.width,this._lastBoundingBoxSize.width));const r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right=r.maxHeight=r.maxWidth="",r.width=r.height="100%";else{const s=this._overlayRef.getConfig().maxHeight,a=this._overlayRef.getConfig().maxWidth;r.height=Zl(n.height),r.top=Zl(n.top),r.bottom=Zl(n.bottom),r.width=Zl(n.width),r.left=Zl(n.left),r.right=Zl(n.right),r.alignItems="center"===e.overlayX?"center":"end"===e.overlayX?"flex-end":"flex-start",r.justifyContent="center"===e.overlayY?"center":"bottom"===e.overlayY?"flex-end":"flex-start",s&&(r.maxHeight=Zl(s)),a&&(r.maxWidth=Zl(a))}this._lastBoundingBoxSize=n,Bb(this._boundingBox.style,r)}_resetBoundingBoxStyles(){Bb(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){Bb(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(t,e){const n={},r=this._hasExactPosition(),s=this._hasFlexibleDimensions,a=this._overlayRef.getConfig();if(r){const m=this._viewportRuler.getViewportScrollPosition();Bb(n,this._getExactOverlayY(e,t,m)),Bb(n,this._getExactOverlayX(e,t,m))}else n.position="static";let l="",u=this._getOffset(e,"x"),h=this._getOffset(e,"y");u&&(l+=`translateX(${u}px) `),h&&(l+=`translateY(${h}px)`),n.transform=l.trim(),a.maxHeight&&(r?n.maxHeight=Zl(a.maxHeight):s&&(n.maxHeight="")),a.maxWidth&&(r?n.maxWidth=Zl(a.maxWidth):s&&(n.maxWidth="")),Bb(this._pane.style,n)}_getExactOverlayY(t,e,n){let r={top:"",bottom:""},s=this._getOverlayPoint(e,this._overlayRect,t);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,n)),"bottom"===t.overlayY?r.bottom=this._document.documentElement.clientHeight-(s.y+this._overlayRect.height)+"px":r.top=Zl(s.y),r}_getExactOverlayX(t,e,n){let a,r={left:"",right:""},s=this._getOverlayPoint(e,this._overlayRect,t);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,n)),a=this._isRtl()?"end"===t.overlayX?"left":"right":"end"===t.overlayX?"right":"left","right"===a?r.right=this._document.documentElement.clientWidth-(s.x+this._overlayRect.width)+"px":r.left=Zl(s.x),r}_getScrollVisibility(){const t=this._getOriginRect(),e=this._pane.getBoundingClientRect(),n=this._scrollables.map(r=>r.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:GW(t,n),isOriginOutsideView:YB(t,n),isOverlayClipped:GW(e,n),isOverlayOutsideView:YB(e,n)}}_subtractOverflows(t,...e){return e.reduce((n,r)=>n-Math.max(r,0),t)}_getNarrowedViewportRect(){const t=this._document.documentElement.clientWidth,e=this._document.documentElement.clientHeight,n=this._viewportRuler.getViewportScrollPosition();return{top:n.top+this._viewportMargin,left:n.left+this._viewportMargin,right:n.left+t-this._viewportMargin,bottom:n.top+e-this._viewportMargin,width:t-2*this._viewportMargin,height:e-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(t,e){return"x"===e?null==t.offsetX?this._offsetX:t.offsetX:null==t.offsetY?this._offsetY:t.offsetY}_validatePositions(){}_addPanelClasses(t){this._pane&&E1(t).forEach(e=>{""!==e&&-1===this._appliedPanelClasses.indexOf(e)&&(this._appliedPanelClasses.push(e),this._pane.classList.add(e))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(t=>{this._pane.classList.remove(t)}),this._appliedPanelClasses=[])}_getOriginRect(){const t=this._origin;if(t instanceof ai)return t.nativeElement.getBoundingClientRect();if(t instanceof Element)return t.getBoundingClientRect();const e=t.width||0,n=t.height||0;return{top:t.y,bottom:t.y+n,left:t.x,right:t.x+e,height:n,width:e}}}function Bb(i,t){for(let e in t)t.hasOwnProperty(e)&&(i[e]=t[e]);return i}function jW(i){if("number"!=typeof i&&null!=i){const[t,e]=i.split(lce);return e&&"px"!==e?null:parseFloat(t)}return i||null}function qW(i){return{top:Math.floor(i.top),right:Math.floor(i.right),bottom:Math.floor(i.bottom),left:Math.floor(i.left),width:Math.floor(i.width),height:Math.floor(i.height)}}const XW="cdk-global-overlay-wrapper";class uce{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._leftOffset="",this._rightOffset="",this._alignItems="",this._justifyContent="",this._width="",this._height=""}attach(t){const e=t.getConfig();this._overlayRef=t,this._width&&!e.width&&t.updateSize({width:this._width}),this._height&&!e.height&&t.updateSize({height:this._height}),t.hostElement.classList.add(XW),this._isDisposed=!1}top(t=""){return this._bottomOffset="",this._topOffset=t,this._alignItems="flex-start",this}left(t=""){return this._rightOffset="",this._leftOffset=t,this._justifyContent="flex-start",this}bottom(t=""){return this._topOffset="",this._bottomOffset=t,this._alignItems="flex-end",this}right(t=""){return this._leftOffset="",this._rightOffset=t,this._justifyContent="flex-end",this}width(t=""){return this._overlayRef?this._overlayRef.updateSize({width:t}):this._width=t,this}height(t=""){return this._overlayRef?this._overlayRef.updateSize({height:t}):this._height=t,this}centerHorizontally(t=""){return this.left(t),this._justifyContent="center",this}centerVertically(t=""){return this.top(t),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const t=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement.style,n=this._overlayRef.getConfig(),{width:r,height:s,maxWidth:a,maxHeight:l}=n,u=!("100%"!==r&&"100vw"!==r||a&&"100%"!==a&&"100vw"!==a),h=!("100%"!==s&&"100vh"!==s||l&&"100%"!==l&&"100vh"!==l);t.position=this._cssPosition,t.marginLeft=u?"0":this._leftOffset,t.marginTop=h?"0":this._topOffset,t.marginBottom=this._bottomOffset,t.marginRight=this._rightOffset,u?e.justifyContent="flex-start":"center"===this._justifyContent?e.justifyContent="center":"rtl"===this._overlayRef.getConfig().direction?"flex-start"===this._justifyContent?e.justifyContent="flex-end":"flex-end"===this._justifyContent&&(e.justifyContent="flex-start"):e.justifyContent=this._justifyContent,e.alignItems=h?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const t=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement,n=e.style;e.classList.remove(XW),n.justifyContent=n.alignItems=t.marginTop=t.marginBottom=t.marginLeft=t.marginRight=t.position="",this._overlayRef=null,this._isDisposed=!0}}let hce=(()=>{class i{constructor(e,n,r,s){this._viewportRuler=e,this._document=n,this._platform=r,this._overlayContainer=s}global(){return new uce}flexibleConnectedTo(e){return new cce(e,this._viewportRuler,this._document,this._platform,this._overlayContainer)}}return i.\u0275fac=function(e){return new(e||i)(Ve(Tp),Ve(ar),Ve(ta),Ve(KB))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),ZW=(()=>{class i{constructor(e){this._attachedOverlays=[],this._document=e}ngOnDestroy(){this.detach()}add(e){this.remove(e),this._attachedOverlays.push(e)}remove(e){const n=this._attachedOverlays.indexOf(e);n>-1&&this._attachedOverlays.splice(n,1),0===this._attachedOverlays.length&&this.detach()}}return i.\u0275fac=function(e){return new(e||i)(Ve(ar))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),dce=(()=>{class i extends ZW{constructor(e,n){super(e),this._ngZone=n,this._keydownListener=r=>{const s=this._attachedOverlays;for(let a=s.length-1;a>-1;a--)if(s[a]._keydownEvents.observers.length>0){const l=s[a]._keydownEvents;this._ngZone?this._ngZone.run(()=>l.next(r)):l.next(r);break}}}add(e){super.add(e),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}}return i.\u0275fac=function(e){return new(e||i)(Ve(ar),Ve(Rn,8))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),fce=(()=>{class i extends ZW{constructor(e,n,r){super(e),this._platform=n,this._ngZone=r,this._cursorStyleIsSet=!1,this._pointerDownListener=s=>{this._pointerDownEventTarget=cy(s)},this._clickListener=s=>{const a=cy(s),l="click"===s.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:a;this._pointerDownEventTarget=null;const u=this._attachedOverlays.slice();for(let h=u.length-1;h>-1;h--){const m=u[h];if(m._outsidePointerEvents.observers.length<1||!m.hasAttached())continue;if(m.overlayElement.contains(a)||m.overlayElement.contains(l))break;const _=m._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>_.next(s)):_.next(s)}}}add(e){if(super.add(e),!this._isAttached){const n=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(n)):this._addEventListeners(n),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=n.style.cursor,n.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const e=this._document.body;e.removeEventListener("pointerdown",this._pointerDownListener,!0),e.removeEventListener("click",this._clickListener,!0),e.removeEventListener("auxclick",this._clickListener,!0),e.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(e.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(e){e.addEventListener("pointerdown",this._pointerDownListener,!0),e.addEventListener("click",this._clickListener,!0),e.addEventListener("auxclick",this._clickListener,!0),e.addEventListener("contextmenu",this._clickListener,!0)}}return i.\u0275fac=function(e){return new(e||i)(Ve(ar),Ve(ta),Ve(Rn,8))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),pce=0,Du=(()=>{class i{constructor(e,n,r,s,a,l,u,h,m,_,v){this.scrollStrategies=e,this._overlayContainer=n,this._componentFactoryResolver=r,this._positionBuilder=s,this._keyboardDispatcher=a,this._injector=l,this._ngZone=u,this._document=h,this._directionality=m,this._location=_,this._outsideClickDispatcher=v}create(e){const n=this._createHostElement(),r=this._createPaneElement(n),s=this._createPortalOutlet(r),a=new Fb(e);return a.direction=a.direction||this._directionality.value,new ace(s,n,r,a,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher)}position(){return this._positionBuilder}_createPaneElement(e){const n=this._document.createElement("div");return n.id="cdk-overlay-"+pce++,n.classList.add("cdk-overlay-pane"),e.appendChild(n),n}_createHostElement(){const e=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(e),e}_createPortalOutlet(e){return this._appRef||(this._appRef=this._injector.get(Ew)),new NW(e,this._componentFactoryResolver,this._appRef,this._injector,this._document)}}return i.\u0275fac=function(e){return new(e||i)(Ve(sce),Ve(KB),Ve(xp),Ve(hce),Ve(dce),Ve(Os),Ve(Rn),Ve(ar),Ve(Ia),Ve(l1),Ve(fce))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})();const mce=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],YW=new gi("cdk-connected-overlay-scroll-strategy");let KW=(()=>{class i{constructor(e){this.elementRef=e}}return i.\u0275fac=function(e){return new(e||i)(B(ai))},i.\u0275dir=Be({type:i,selectors:[["","cdk-overlay-origin",""],["","overlay-origin",""],["","cdkOverlayOrigin",""]],exportAs:["cdkOverlayOrigin"]}),i})(),QW=(()=>{class i{constructor(e,n,r,s,a){this._overlay=e,this._dir=a,this._hasBackdrop=!1,this._lockPosition=!1,this._growAfterOpen=!1,this._flexibleDimensions=!1,this._push=!1,this._backdropSubscription=Q.EMPTY,this._attachSubscription=Q.EMPTY,this._detachSubscription=Q.EMPTY,this._positionSubscription=Q.EMPTY,this.viewportMargin=0,this.open=!1,this.disableClose=!1,this.backdropClick=new Si,this.positionChange=new Si,this.attach=new Si,this.detach=new Si,this.overlayKeydown=new Si,this.overlayOutsideClick=new Si,this._templatePortal=new Ep(n,r),this._scrollStrategyFactory=s,this.scrollStrategy=this._scrollStrategyFactory()}get offsetX(){return this._offsetX}set offsetX(e){this._offsetX=e,this._position&&this._updatePositionStrategy(this._position)}get offsetY(){return this._offsetY}set offsetY(e){this._offsetY=e,this._position&&this._updatePositionStrategy(this._position)}get hasBackdrop(){return this._hasBackdrop}set hasBackdrop(e){this._hasBackdrop=tn(e)}get lockPosition(){return this._lockPosition}set lockPosition(e){this._lockPosition=tn(e)}get flexibleDimensions(){return this._flexibleDimensions}set flexibleDimensions(e){this._flexibleDimensions=tn(e)}get growAfterOpen(){return this._growAfterOpen}set growAfterOpen(e){this._growAfterOpen=tn(e)}get push(){return this._push}set push(e){this._push=tn(e)}get overlayRef(){return this._overlayRef}get dir(){return this._dir?this._dir.value:"ltr"}ngOnDestroy(){this._attachSubscription.unsubscribe(),this._detachSubscription.unsubscribe(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this._overlayRef&&this._overlayRef.dispose()}ngOnChanges(e){this._position&&(this._updatePositionStrategy(this._position),this._overlayRef.updateSize({width:this.width,minWidth:this.minWidth,height:this.height,minHeight:this.minHeight}),e.origin&&this.open&&this._position.apply()),e.open&&(this.open?this._attachOverlay():this._detachOverlay())}_createOverlay(){(!this.positions||!this.positions.length)&&(this.positions=mce);const e=this._overlayRef=this._overlay.create(this._buildConfig());this._attachSubscription=e.attachments().subscribe(()=>this.attach.emit()),this._detachSubscription=e.detachments().subscribe(()=>this.detach.emit()),e.keydownEvents().subscribe(n=>{this.overlayKeydown.next(n),27===n.keyCode&&!this.disableClose&&!dc(n)&&(n.preventDefault(),this._detachOverlay())}),this._overlayRef.outsidePointerEvents().subscribe(n=>{this.overlayOutsideClick.next(n)})}_buildConfig(){const e=this._position=this.positionStrategy||this._createPositionStrategy(),n=new Fb({direction:this._dir,positionStrategy:e,scrollStrategy:this.scrollStrategy,hasBackdrop:this.hasBackdrop});return(this.width||0===this.width)&&(n.width=this.width),(this.height||0===this.height)&&(n.height=this.height),(this.minWidth||0===this.minWidth)&&(n.minWidth=this.minWidth),(this.minHeight||0===this.minHeight)&&(n.minHeight=this.minHeight),this.backdropClass&&(n.backdropClass=this.backdropClass),this.panelClass&&(n.panelClass=this.panelClass),n}_updatePositionStrategy(e){const n=this.positions.map(r=>({originX:r.originX,originY:r.originY,overlayX:r.overlayX,overlayY:r.overlayY,offsetX:r.offsetX||this.offsetX,offsetY:r.offsetY||this.offsetY,panelClass:r.panelClass||void 0}));return e.setOrigin(this._getFlexibleConnectedPositionStrategyOrigin()).withPositions(n).withFlexibleDimensions(this.flexibleDimensions).withPush(this.push).withGrowAfterOpen(this.growAfterOpen).withViewportMargin(this.viewportMargin).withLockedPosition(this.lockPosition).withTransformOriginOn(this.transformOriginSelector)}_createPositionStrategy(){const e=this._overlay.position().flexibleConnectedTo(this._getFlexibleConnectedPositionStrategyOrigin());return this._updatePositionStrategy(e),e}_getFlexibleConnectedPositionStrategyOrigin(){return this.origin instanceof KW?this.origin.elementRef:this.origin}_attachOverlay(){this._overlayRef?this._overlayRef.getConfig().hasBackdrop=this.hasBackdrop:this._createOverlay(),this._overlayRef.hasAttached()||this._overlayRef.attach(this._templatePortal),this.hasBackdrop?this._backdropSubscription=this._overlayRef.backdropClick().subscribe(e=>{this.backdropClick.emit(e)}):this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this.positionChange.observers.length>0&&(this._positionSubscription=this._position.positionChanges.pipe(function Wle(i,t=!1){return gr((e,n)=>{let r=0;e.subscribe(qn(n,s=>{const a=i(s,r++);(a||t)&&n.next(s),!a&&n.complete()}))})}(()=>this.positionChange.observers.length>0)).subscribe(e=>{this.positionChange.emit(e),0===this.positionChange.observers.length&&this._positionSubscription.unsubscribe()}))}_detachOverlay(){this._overlayRef&&this._overlayRef.detach(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe()}}return i.\u0275fac=function(e){return new(e||i)(B(Du),B(Xo),B(Ko),B(YW),B(Ia,8))},i.\u0275dir=Be({type:i,selectors:[["","cdk-connected-overlay",""],["","connected-overlay",""],["","cdkConnectedOverlay",""]],inputs:{origin:["cdkConnectedOverlayOrigin","origin"],positions:["cdkConnectedOverlayPositions","positions"],positionStrategy:["cdkConnectedOverlayPositionStrategy","positionStrategy"],offsetX:["cdkConnectedOverlayOffsetX","offsetX"],offsetY:["cdkConnectedOverlayOffsetY","offsetY"],width:["cdkConnectedOverlayWidth","width"],height:["cdkConnectedOverlayHeight","height"],minWidth:["cdkConnectedOverlayMinWidth","minWidth"],minHeight:["cdkConnectedOverlayMinHeight","minHeight"],backdropClass:["cdkConnectedOverlayBackdropClass","backdropClass"],panelClass:["cdkConnectedOverlayPanelClass","panelClass"],viewportMargin:["cdkConnectedOverlayViewportMargin","viewportMargin"],scrollStrategy:["cdkConnectedOverlayScrollStrategy","scrollStrategy"],open:["cdkConnectedOverlayOpen","open"],disableClose:["cdkConnectedOverlayDisableClose","disableClose"],transformOriginSelector:["cdkConnectedOverlayTransformOriginOn","transformOriginSelector"],hasBackdrop:["cdkConnectedOverlayHasBackdrop","hasBackdrop"],lockPosition:["cdkConnectedOverlayLockPosition","lockPosition"],flexibleDimensions:["cdkConnectedOverlayFlexibleDimensions","flexibleDimensions"],growAfterOpen:["cdkConnectedOverlayGrowAfterOpen","growAfterOpen"],push:["cdkConnectedOverlayPush","push"]},outputs:{backdropClick:"backdropClick",positionChange:"positionChange",attach:"attach",detach:"detach",overlayKeydown:"overlayKeydown",overlayOutsideClick:"overlayOutsideClick"},exportAs:["cdkConnectedOverlay"],features:[Ls]}),i})();const _ce={provide:YW,deps:[Du],useFactory:function gce(i){return()=>i.scrollStrategies.reposition()}};let Nb=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({providers:[Du,_ce],imports:[[Uw,O1,WB],WB]}),i})();function Po(i,t,e){const n=z(i)||t||e?{next:i,error:t,complete:e}:i;return n?gr((r,s)=>{var a;null===(a=n.subscribe)||void 0===a||a.call(n);let l=!0;r.subscribe(qn(s,u=>{var h;null===(h=n.next)||void 0===h||h.call(n,u),s.next(u)},()=>{var u;l=!1,null===(u=n.complete)||void 0===u||u.call(n),s.complete()},u=>{var h;l=!1,null===(h=n.error)||void 0===h||h.call(n,u),s.error(u)},()=>{var u,h;l&&(null===(u=n.unsubscribe)||void 0===u||u.call(n)),null===(h=n.finalize)||void 0===h||h.call(n)}))}):Rt}function jm(i,t=Hw){return gr((e,n)=>{let r=null,s=null,a=null;const l=()=>{if(r){r.unsubscribe(),r=null;const h=s;s=null,n.next(h)}};function u(){const h=a+i,m=t.now();if(m<h)return r=this.schedule(void 0,h-m),void n.add(r);l()}e.subscribe(qn(n,h=>{s=h,a=t.now(),r||(r=t.schedule(u,i),n.add(r))},()=>{l(),n.complete()},void 0,()=>{s=r=null}))})}function N1(i){return vr((t,e)=>i<=e)}function xk(i,t=Rt){return i=null!=i?i:yce,gr((e,n)=>{let r,s=!0;e.subscribe(qn(n,a=>{const l=t(a);(s||!i(r,l))&&(s=!1,r=l,n.next(a))}))})}function yce(i,t){return i===t}let $W=(()=>{class i{create(e){return"undefined"==typeof MutationObserver?null:new MutationObserver(e)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),vce=(()=>{class i{constructor(e){this._mutationObserverFactory=e,this._observedElements=new Map}ngOnDestroy(){this._observedElements.forEach((e,n)=>this._cleanupObserver(n))}observe(e){const n=Gm(e);return new ft(r=>{const a=this._observeElement(n).subscribe(r);return()=>{a.unsubscribe(),this._unobserveElement(n)}})}_observeElement(e){if(this._observedElements.has(e))this._observedElements.get(e).count++;else{const n=new ii,r=this._mutationObserverFactory.create(s=>n.next(s));r&&r.observe(e,{characterData:!0,childList:!0,subtree:!0}),this._observedElements.set(e,{observer:r,stream:n,count:1})}return this._observedElements.get(e).stream}_unobserveElement(e){this._observedElements.has(e)&&(this._observedElements.get(e).count--,this._observedElements.get(e).count||this._cleanupObserver(e))}_cleanupObserver(e){if(this._observedElements.has(e)){const{observer:n,stream:r}=this._observedElements.get(e);n&&n.disconnect(),r.complete(),this._observedElements.delete(e)}}}return i.\u0275fac=function(e){return new(e||i)(Ve($W))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),wk=(()=>{class i{constructor(e,n,r){this._contentObserver=e,this._elementRef=n,this._ngZone=r,this.event=new Si,this._disabled=!1,this._currentSubscription=null}get disabled(){return this._disabled}set disabled(e){this._disabled=tn(e),this._disabled?this._unsubscribe():this._subscribe()}get debounce(){return this._debounce}set debounce(e){this._debounce=Qo(e),this._subscribe()}ngAfterContentInit(){!this._currentSubscription&&!this.disabled&&this._subscribe()}ngOnDestroy(){this._unsubscribe()}_subscribe(){this._unsubscribe();const e=this._contentObserver.observe(this._elementRef);this._ngZone.runOutsideAngular(()=>{this._currentSubscription=(this.debounce?e.pipe(jm(this.debounce)):e).subscribe(this.event)})}_unsubscribe(){var e;null===(e=this._currentSubscription)||void 0===e||e.unsubscribe()}}return i.\u0275fac=function(e){return new(e||i)(B(vce),B(ai),B(Rn))},i.\u0275dir=Be({type:i,selectors:[["","cdkObserveContent",""]],inputs:{disabled:["cdkObserveContentDisabled","disabled"],debounce:"debounce"},outputs:{event:"cdkObserveContent"},exportAs:["cdkObserveContent"]}),i})(),H1=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({providers:[$W]}),i})();function Sk(i,t){return(i.getAttribute(t)||"").match(/\S+/g)||[]}const t7="cdk-describedby-message",Ck="cdk-describedby-host";let n7=0,r7=(()=>{class i{constructor(e,n){this._platform=n,this._messageRegistry=new Map,this._messagesContainer=null,this._id=""+n7++,this._document=e}describe(e,n,r){if(!this._canBeDescribed(e,n))return;const s=QB(n,r);"string"!=typeof n?(s7(n),this._messageRegistry.set(s,{messageElement:n,referenceCount:0})):this._messageRegistry.has(s)||this._createMessageElement(n,r),this._isElementDescribedByMessage(e,s)||this._addMessageReference(e,s)}removeDescription(e,n,r){var s;if(!n||!this._isElementNode(e))return;const a=QB(n,r);if(this._isElementDescribedByMessage(e,a)&&this._removeMessageReference(e,a),"string"==typeof n){const l=this._messageRegistry.get(a);l&&0===l.referenceCount&&this._deleteMessageElement(a)}0===(null===(s=this._messagesContainer)||void 0===s?void 0:s.childNodes.length)&&(this._messagesContainer.remove(),this._messagesContainer=null)}ngOnDestroy(){var e;const n=this._document.querySelectorAll(`[${Ck}="${this._id}"]`);for(let r=0;r<n.length;r++)this._removeCdkDescribedByReferenceIds(n[r]),n[r].removeAttribute(Ck);null===(e=this._messagesContainer)||void 0===e||e.remove(),this._messagesContainer=null,this._messageRegistry.clear()}_createMessageElement(e,n){const r=this._document.createElement("div");s7(r),r.textContent=e,n&&r.setAttribute("role",n),this._createMessagesContainer(),this._messagesContainer.appendChild(r),this._messageRegistry.set(QB(e,n),{messageElement:r,referenceCount:0})}_deleteMessageElement(e){var n,r;null===(r=null===(n=this._messageRegistry.get(e))||void 0===n?void 0:n.messageElement)||void 0===r||r.remove(),this._messageRegistry.delete(e)}_createMessagesContainer(){if(this._messagesContainer)return;const e="cdk-describedby-message-container",n=this._document.querySelectorAll(`.${e}[platform="server"]`);for(let s=0;s<n.length;s++)n[s].remove();const r=this._document.createElement("div");r.style.visibility="hidden",r.classList.add(e),r.classList.add("cdk-visually-hidden"),this._platform&&!this._platform.isBrowser&&r.setAttribute("platform","server"),this._document.body.appendChild(r),this._messagesContainer=r}_removeCdkDescribedByReferenceIds(e){const n=Sk(e,"aria-describedby").filter(r=>0!=r.indexOf(t7));e.setAttribute("aria-describedby",n.join(" "))}_addMessageReference(e,n){const r=this._messageRegistry.get(n);(function bce(i,t,e){const n=Sk(i,t);n.some(r=>r.trim()==e.trim())||(n.push(e.trim()),i.setAttribute(t,n.join(" ")))})(e,"aria-describedby",r.messageElement.id),e.setAttribute(Ck,this._id),r.referenceCount++}_removeMessageReference(e,n){const r=this._messageRegistry.get(n);r.referenceCount--,function xce(i,t,e){const r=Sk(i,t).filter(s=>s!=e.trim());r.length?i.setAttribute(t,r.join(" ")):i.removeAttribute(t)}(e,"aria-describedby",r.messageElement.id),e.removeAttribute(Ck)}_isElementDescribedByMessage(e,n){const r=Sk(e,"aria-describedby"),s=this._messageRegistry.get(n),a=s&&s.messageElement.id;return!!a&&-1!=r.indexOf(a)}_canBeDescribed(e,n){if(!this._isElementNode(e))return!1;if(n&&"object"==typeof n)return!0;const r=null==n?"":`${n}`.trim(),s=e.getAttribute("aria-label");return!(!r||s&&s.trim()===r)}_isElementNode(e){return e.nodeType===this._document.ELEMENT_NODE}}return i.\u0275fac=function(e){return new(e||i)(Ve(ar),Ve(ta))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function QB(i,t){return"string"==typeof i?`${t||""}/${i}`:i}function s7(i){i.id||(i.id=`${t7}-${n7++}`)}class o7{constructor(t){this._items=t,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._letterKeyStream=new ii,this._typeaheadSubscription=Q.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._homeAndEnd=!1,this._skipPredicateFn=e=>e.disabled,this._pressedLetters=[],this.tabOut=new ii,this.change=new ii,t instanceof ey&&t.changes.subscribe(e=>{if(this._activeItem){const r=e.toArray().indexOf(this._activeItem);r>-1&&r!==this._activeItemIndex&&(this._activeItemIndex=r)}})}skipPredicate(t){return this._skipPredicateFn=t,this}withWrap(t=!0){return this._wrap=t,this}withVerticalOrientation(t=!0){return this._vertical=t,this}withHorizontalOrientation(t){return this._horizontal=t,this}withAllowedModifierKeys(t){return this._allowedModifierKeys=t,this}withTypeAhead(t=200){return this._typeaheadSubscription.unsubscribe(),this._typeaheadSubscription=this._letterKeyStream.pipe(Po(e=>this._pressedLetters.push(e)),jm(t),vr(()=>this._pressedLetters.length>0),Ui(()=>this._pressedLetters.join(""))).subscribe(e=>{const n=this._getItemsArray();for(let r=1;r<n.length+1;r++){const s=(this._activeItemIndex+r)%n.length,a=n[s];if(!this._skipPredicateFn(a)&&0===a.getLabel().toUpperCase().trim().indexOf(e)){this.setActiveItem(s);break}}this._pressedLetters=[]}),this}withHomeAndEnd(t=!0){return this._homeAndEnd=t,this}setActiveItem(t){const e=this._activeItem;this.updateActiveItem(t),this._activeItem!==e&&this.change.next(this._activeItemIndex)}onKeydown(t){const e=t.keyCode,r=["altKey","ctrlKey","metaKey","shiftKey"].every(s=>!t[s]||this._allowedModifierKeys.indexOf(s)>-1);switch(e){case 9:return void this.tabOut.next();case 40:if(this._vertical&&r){this.setNextItemActive();break}return;case 38:if(this._vertical&&r){this.setPreviousItemActive();break}return;case 39:if(this._horizontal&&r){"rtl"===this._horizontal?this.setPreviousItemActive():this.setNextItemActive();break}return;case 37:if(this._horizontal&&r){"rtl"===this._horizontal?this.setNextItemActive():this.setPreviousItemActive();break}return;case 36:if(this._homeAndEnd&&r){this.setFirstItemActive();break}return;case 35:if(this._homeAndEnd&&r){this.setLastItemActive();break}return;default:return void((r||dc(t,"shiftKey"))&&(t.key&&1===t.key.length?this._letterKeyStream.next(t.key.toLocaleUpperCase()):(e>=65&&e<=90||e>=48&&e<=57)&&this._letterKeyStream.next(String.fromCharCode(e))))}this._pressedLetters=[],t.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem}isTyping(){return this._pressedLetters.length>0}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._items.length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(t){const e=this._getItemsArray(),n="number"==typeof t?t:e.indexOf(t),r=e[n];this._activeItem=null==r?null:r,this._activeItemIndex=n}_setActiveItemByDelta(t){this._wrap?this._setActiveInWrapMode(t):this._setActiveInDefaultMode(t)}_setActiveInWrapMode(t){const e=this._getItemsArray();for(let n=1;n<=e.length;n++){const r=(this._activeItemIndex+t*n+e.length)%e.length;if(!this._skipPredicateFn(e[r]))return void this.setActiveItem(r)}}_setActiveInDefaultMode(t){this._setActiveItemByIndex(this._activeItemIndex+t,t)}_setActiveItemByIndex(t,e){const n=this._getItemsArray();if(n[t]){for(;this._skipPredicateFn(n[t]);)if(!n[t+=e])return;this.setActiveItem(t)}}_getItemsArray(){return this._items instanceof ey?this._items.toArray():this._items}}class a7 extends o7{setActiveItem(t){this.activeItem&&this.activeItem.setInactiveStyles(),super.setActiveItem(t),this.activeItem&&this.activeItem.setActiveStyles()}}class Mk extends o7{constructor(){super(...arguments),this._origin="program"}setFocusOrigin(t){return this._origin=t,this}setActiveItem(t){super.setActiveItem(t),this.activeItem&&this.activeItem.focus(this._origin)}}let Tk=(()=>{class i{constructor(e){this._platform=e}isDisabled(e){return e.hasAttribute("disabled")}isVisible(e){return function Sce(i){return!!(i.offsetWidth||i.offsetHeight||"function"==typeof i.getClientRects&&i.getClientRects().length)}(e)&&"visible"===getComputedStyle(e).visibility}isTabbable(e){if(!this._platform.isBrowser)return!1;const n=function wce(i){try{return i.frameElement}catch(t){return null}}(function kce(i){return i.ownerDocument&&i.ownerDocument.defaultView||window}(e));if(n&&(-1===c7(n)||!this.isVisible(n)))return!1;let r=e.nodeName.toLowerCase(),s=c7(e);return e.hasAttribute("contenteditable")?-1!==s:!("iframe"===r||"object"===r||this._platform.WEBKIT&&this._platform.IOS&&!function Dce(i){let t=i.nodeName.toLowerCase(),e="input"===t&&i.type;return"text"===e||"password"===e||"select"===t||"textarea"===t}(e))&&("audio"===r?!!e.hasAttribute("controls")&&-1!==s:"video"===r?-1!==s&&(null!==s||this._platform.FIREFOX||e.hasAttribute("controls")):e.tabIndex>=0)}isFocusable(e,n){return function Rce(i){return!function Mce(i){return function Ece(i){return"input"==i.nodeName.toLowerCase()}(i)&&"hidden"==i.type}(i)&&(function Cce(i){let t=i.nodeName.toLowerCase();return"input"===t||"select"===t||"button"===t||"textarea"===t}(i)||function Tce(i){return function Ace(i){return"a"==i.nodeName.toLowerCase()}(i)&&i.hasAttribute("href")}(i)||i.hasAttribute("contenteditable")||l7(i))}(e)&&!this.isDisabled(e)&&((null==n?void 0:n.ignoreVisibility)||this.isVisible(e))}}return i.\u0275fac=function(e){return new(e||i)(Ve(ta))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function l7(i){if(!i.hasAttribute("tabindex")||void 0===i.tabIndex)return!1;let t=i.getAttribute("tabindex");return!(!t||isNaN(parseInt(t,10)))}function c7(i){if(!l7(i))return null;const t=parseInt(i.getAttribute("tabindex")||"",10);return isNaN(t)?-1:t}class Pce{constructor(t,e,n,r,s=!1){this._element=t,this._checker=e,this._ngZone=n,this._document=r,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,s||this.attachAnchors()}get enabled(){return this._enabled}set enabled(t){this._enabled=t,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}destroy(){const t=this._startAnchor,e=this._endAnchor;t&&(t.removeEventListener("focus",this.startAnchorListener),t.remove()),e&&(e.removeEventListener("focus",this.endAnchorListener),e.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(t){return new Promise(e=>{this._executeOnStable(()=>e(this.focusInitialElement(t)))})}focusFirstTabbableElementWhenReady(t){return new Promise(e=>{this._executeOnStable(()=>e(this.focusFirstTabbableElement(t)))})}focusLastTabbableElementWhenReady(t){return new Promise(e=>{this._executeOnStable(()=>e(this.focusLastTabbableElement(t)))})}_getRegionBoundary(t){const e=this._element.querySelectorAll(`[cdk-focus-region-${t}], [cdkFocusRegion${t}], [cdk-focus-${t}]`);return"start"==t?e.length?e[0]:this._getFirstTabbableElement(this._element):e.length?e[e.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(t){const e=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(e){if(!this._checker.isFocusable(e)){const n=this._getFirstTabbableElement(e);return null==n||n.focus(t),!!n}return e.focus(t),!0}return this.focusFirstTabbableElement(t)}focusFirstTabbableElement(t){const e=this._getRegionBoundary("start");return e&&e.focus(t),!!e}focusLastTabbableElement(t){const e=this._getRegionBoundary("end");return e&&e.focus(t),!!e}hasAttached(){return this._hasAttached}_getFirstTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;const e=t.children;for(let n=0;n<e.length;n++){const r=e[n].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(e[n]):null;if(r)return r}return null}_getLastTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;const e=t.children;for(let n=e.length-1;n>=0;n--){const r=e[n].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(e[n]):null;if(r)return r}return null}_createAnchor(){const t=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,t),t.classList.add("cdk-visually-hidden"),t.classList.add("cdk-focus-trap-anchor"),t.setAttribute("aria-hidden","true"),t}_toggleAnchorTabIndex(t,e){t?e.setAttribute("tabindex","0"):e.removeAttribute("tabindex")}toggleAnchors(t){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}_executeOnStable(t){this._ngZone.isStable?t():this._ngZone.onStable.pipe(Qr(1)).subscribe(t)}}let JB=(()=>{class i{constructor(e,n,r){this._checker=e,this._ngZone=n,this._document=r}create(e,n=!1){return new Pce(e,this._checker,this._ngZone,this._document,n)}}return i.\u0275fac=function(e){return new(e||i)(Ve(Tk),Ve(Rn),Ve(ar))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function $B(i){return 0===i.buttons||0===i.offsetX&&0===i.offsetY}function eN(i){const t=i.touches&&i.touches[0]||i.changedTouches&&i.changedTouches[0];return!(!t||-1!==t.identifier||null!=t.radiusX&&1!==t.radiusX||null!=t.radiusY&&1!==t.radiusY)}const Ice=new gi("cdk-input-modality-detector-options"),Lce={ignoreKeys:[18,17,224,91,16]},Gw=ly({passive:!0,capture:!0});let Oce=(()=>{class i{constructor(e,n,r,s){this._platform=e,this._mostRecentTarget=null,this._modality=new gs(null),this._lastTouchMs=0,this._onKeydown=a=>{var l,u;(null===(u=null===(l=this._options)||void 0===l?void 0:l.ignoreKeys)||void 0===u?void 0:u.some(h=>h===a.keyCode))||(this._modality.next("keyboard"),this._mostRecentTarget=cy(a))},this._onMousedown=a=>{Date.now()-this._lastTouchMs<650||(this._modality.next($B(a)?"keyboard":"mouse"),this._mostRecentTarget=cy(a))},this._onTouchstart=a=>{eN(a)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=cy(a))},this._options=Object.assign(Object.assign({},Lce),s),this.modalityDetected=this._modality.pipe(N1(1)),this.modalityChanged=this.modalityDetected.pipe(xk()),e.isBrowser&&n.runOutsideAngular(()=>{r.addEventListener("keydown",this._onKeydown,Gw),r.addEventListener("mousedown",this._onMousedown,Gw),r.addEventListener("touchstart",this._onTouchstart,Gw)})}get mostRecentModality(){return this._modality.value}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,Gw),document.removeEventListener("mousedown",this._onMousedown,Gw),document.removeEventListener("touchstart",this._onTouchstart,Gw))}}return i.\u0275fac=function(e){return new(e||i)(Ve(ta),Ve(Rn),Ve(ar),Ve(Ice,8))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const Fce=new gi("liveAnnouncerElement",{providedIn:"root",factory:function Bce(){return null}}),Nce=new gi("LIVE_ANNOUNCER_DEFAULT_OPTIONS");let tN=(()=>{class i{constructor(e,n,r,s){this._ngZone=n,this._defaultOptions=s,this._document=r,this._liveElement=e||this._createLiveElement()}announce(e,...n){const r=this._defaultOptions;let s,a;return 1===n.length&&"number"==typeof n[0]?a=n[0]:[s,a]=n,this.clear(),clearTimeout(this._previousTimeout),s||(s=r&&r.politeness?r.politeness:"polite"),null==a&&r&&(a=r.duration),this._liveElement.setAttribute("aria-live",s),this._ngZone.runOutsideAngular(()=>(this._currentPromise||(this._currentPromise=new Promise(l=>this._currentResolve=l)),clearTimeout(this._previousTimeout),this._previousTimeout=setTimeout(()=>{this._liveElement.textContent=e,"number"==typeof a&&(this._previousTimeout=setTimeout(()=>this.clear(),a)),this._currentResolve(),this._currentPromise=this._currentResolve=void 0},100),this._currentPromise))}clear(){this._liveElement&&(this._liveElement.textContent="")}ngOnDestroy(){var e,n;clearTimeout(this._previousTimeout),null===(e=this._liveElement)||void 0===e||e.remove(),this._liveElement=null,null===(n=this._currentResolve)||void 0===n||n.call(this),this._currentPromise=this._currentResolve=void 0}_createLiveElement(){const e="cdk-live-announcer-element",n=this._document.getElementsByClassName(e),r=this._document.createElement("div");for(let s=0;s<n.length;s++)n[s].remove();return r.classList.add(e),r.classList.add("cdk-visually-hidden"),r.setAttribute("aria-atomic","true"),r.setAttribute("aria-live","polite"),this._document.body.appendChild(r),r}}return i.\u0275fac=function(e){return new(e||i)(Ve(Fce,8),Ve(Rn),Ve(ar),Ve(Nce,8))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const Hce=new gi("cdk-focus-monitor-default-options"),Ek=ly({passive:!0,capture:!0});let ch=(()=>{class i{constructor(e,n,r,s,a){this._ngZone=e,this._platform=n,this._inputModalityDetector=r,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new ii,this._rootNodeFocusAndBlurListener=l=>{const u=cy(l),h="focus"===l.type?this._onFocus:this._onBlur;for(let m=u;m;m=m.parentElement)h.call(this,l,m)},this._document=s,this._detectionMode=(null==a?void 0:a.detectionMode)||0}monitor(e,n=!1){const r=Gm(e);if(!this._platform.isBrowser||1!==r.nodeType)return Qn(null);const s=BW(r)||this._getDocument(),a=this._elementInfo.get(r);if(a)return n&&(a.checkChildren=!0),a.subject;const l={checkChildren:n,subject:new ii,rootNode:s};return this._elementInfo.set(r,l),this._registerGlobalListeners(l),l.subject}stopMonitoring(e){const n=Gm(e),r=this._elementInfo.get(n);r&&(r.subject.complete(),this._setClasses(n),this._elementInfo.delete(n),this._removeGlobalListeners(r))}focusVia(e,n,r){const s=Gm(e);s===this._getDocument().activeElement?this._getClosestElementsInfo(s).forEach(([l,u])=>this._originChanged(l,n,u)):(this._setOrigin(n),"function"==typeof s.focus&&s.focus(r))}ngOnDestroy(){this._elementInfo.forEach((e,n)=>this.stopMonitoring(n))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(e){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(e)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:"program"}_shouldBeAttributedToTouch(e){return 1===this._detectionMode||!!(null==e?void 0:e.contains(this._inputModalityDetector._mostRecentTarget))}_setClasses(e,n){e.classList.toggle("cdk-focused",!!n),e.classList.toggle("cdk-touch-focused","touch"===n),e.classList.toggle("cdk-keyboard-focused","keyboard"===n),e.classList.toggle("cdk-mouse-focused","mouse"===n),e.classList.toggle("cdk-program-focused","program"===n)}_setOrigin(e,n=!1){this._ngZone.runOutsideAngular(()=>{this._origin=e,this._originFromTouchInteraction="touch"===e&&n,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(e,n){const r=this._elementInfo.get(n),s=cy(e);!r||!r.checkChildren&&n!==s||this._originChanged(n,this._getFocusOrigin(s),r)}_onBlur(e,n){const r=this._elementInfo.get(n);!r||r.checkChildren&&e.relatedTarget instanceof Node&&n.contains(e.relatedTarget)||(this._setClasses(n),this._emitOrigin(r.subject,null))}_emitOrigin(e,n){this._ngZone.run(()=>e.next(n))}_registerGlobalListeners(e){if(!this._platform.isBrowser)return;const n=e.rootNode,r=this._rootNodeFocusListenerCount.get(n)||0;r||this._ngZone.runOutsideAngular(()=>{n.addEventListener("focus",this._rootNodeFocusAndBlurListener,Ek),n.addEventListener("blur",this._rootNodeFocusAndBlurListener,Ek)}),this._rootNodeFocusListenerCount.set(n,r+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe($n(this._stopInputModalityDetector)).subscribe(s=>{this._setOrigin(s,!0)}))}_removeGlobalListeners(e){const n=e.rootNode;if(this._rootNodeFocusListenerCount.has(n)){const r=this._rootNodeFocusListenerCount.get(n);r>1?this._rootNodeFocusListenerCount.set(n,r-1):(n.removeEventListener("focus",this._rootNodeFocusAndBlurListener,Ek),n.removeEventListener("blur",this._rootNodeFocusAndBlurListener,Ek),this._rootNodeFocusListenerCount.delete(n))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(e,n,r){this._setClasses(e,n),this._emitOrigin(r.subject,n),this._lastFocusOrigin=n}_getClosestElementsInfo(e){const n=[];return this._elementInfo.forEach((r,s)=>{(s===e||r.checkChildren&&s.contains(e))&&n.push([s,r])}),n}}return i.\u0275fac=function(e){return new(e||i)(Ve(Rn),Ve(ta),Ve(Oce),Ve(ar,8),Ve(Hce,8))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Vce=(()=>{class i{constructor(e,n){this._elementRef=e,this._focusMonitor=n,this.cdkFocusChange=new Si}ngAfterViewInit(){const e=this._elementRef.nativeElement;this._monitorSubscription=this._focusMonitor.monitor(e,1===e.nodeType&&e.hasAttribute("cdkMonitorSubtreeFocus")).subscribe(n=>this.cdkFocusChange.emit(n))}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._monitorSubscription&&this._monitorSubscription.unsubscribe()}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(ch))},i.\u0275dir=Be({type:i,selectors:[["","cdkMonitorElementFocus",""],["","cdkMonitorSubtreeFocus",""]],outputs:{cdkFocusChange:"cdkFocusChange"}}),i})();const h7="cdk-high-contrast-black-on-white",d7="cdk-high-contrast-white-on-black",iN="cdk-high-contrast-active";let f7=(()=>{class i{constructor(e,n){this._platform=e,this._document=n}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const e=this._document.createElement("div");e.style.backgroundColor="rgb(1,2,3)",e.style.position="absolute",this._document.body.appendChild(e);const n=this._document.defaultView||window,r=n&&n.getComputedStyle?n.getComputedStyle(e):null,s=(r&&r.backgroundColor||"").replace(/ /g,"");switch(e.remove(),s){case"rgb(0,0,0)":return 2;case"rgb(255,255,255)":return 1}return 0}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const e=this._document.body.classList;e.remove(iN),e.remove(h7),e.remove(d7),this._hasCheckedHighContrastMode=!0;const n=this.getHighContrastMode();1===n?(e.add(iN),e.add(h7)):2===n&&(e.add(iN),e.add(d7))}}}return i.\u0275fac=function(e){return new(e||i)(Ve(ta),Ve(ar))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),nN=(()=>{class i{constructor(e){e._applyBodyHighContrastModeCssClasses()}}return i.\u0275fac=function(e){return new(e||i)(Ve(f7))},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[H1]]}),i})();function V1(...i){return function zce(){return lf(1)}()(xr(i,tu(i)))}function Tl(...i){const t=tu(i);return gr((e,n)=>{(t?V1(i,e,t):V1(i,e)).subscribe(n)})}function Uce(i,t){if(1&i&&yt(0,"mat-pseudo-checkbox",4),2&i){const e=Re();fe("state",e.selected?"checked":"unchecked")("disabled",e.disabled)}}function Gce(i,t){if(1&i&&(Z(0,"span",5),ue(1),J()),2&i){const e=Re();se(1),ui("(",e.group.label,")")}}const Wce=["*"];let m7=(()=>{class i{}return i.STANDARD_CURVE="cubic-bezier(0.4,0.0,0.2,1)",i.DECELERATION_CURVE="cubic-bezier(0.0,0.0,0.2,1)",i.ACCELERATION_CURVE="cubic-bezier(0.4,0.0,1,1)",i.SHARP_CURVE="cubic-bezier(0.4,0.0,0.6,1)",i})(),g7=(()=>{class i{}return i.COMPLEX="375ms",i.ENTERING="225ms",i.EXITING="195ms",i})();const qce=new gi("mat-sanity-checks",{providedIn:"root",factory:function jce(){return!0}});let jn=(()=>{class i{constructor(e,n,r){this._sanityChecks=n,this._document=r,this._hasDoneGlobalChecks=!1,e._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(e){return!GB()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[e])}}return i.\u0275fac=function(e){return new(e||i)(Ve(f7),Ve(qce,8),Ve(ar))},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[Uw],Uw]}),i})();function Hf(i){return class extends i{constructor(...t){super(...t),this._disabled=!1}get disabled(){return this._disabled}set disabled(t){this._disabled=tn(t)}}}function Vf(i,t){return class extends i{constructor(...e){super(...e),this.defaultColor=t,this.color=t}get color(){return this._color}set color(e){const n=e||this.defaultColor;n!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),n&&this._elementRef.nativeElement.classList.add(`mat-${n}`),this._color=n)}}}function uh(i){return class extends i{constructor(...t){super(...t),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(t){this._disableRipple=tn(t)}}}function Ww(i,t=0){return class extends i{constructor(...e){super(...e),this._tabIndex=t,this.defaultTabIndex=t}get tabIndex(){return this.disabled?-1:this._tabIndex}set tabIndex(e){this._tabIndex=null!=e?Qo(e):this.defaultTabIndex}}}function rN(i){return class extends i{constructor(...t){super(...t),this.stateChanges=new ii,this.errorState=!1}updateErrorState(){const t=this.errorState,s=(this.errorStateMatcher||this._defaultErrorStateMatcher).isErrorState(this.ngControl?this.ngControl.control:null,this._parentFormGroup||this._parentForm);s!==t&&(this.errorState=s,this.stateChanges.next())}}}function Xce(i){return class extends i{constructor(...t){super(...t),this._isInitialized=!1,this._pendingSubscribers=[],this.initialized=new ft(e=>{this._isInitialized?this._notifySubscriber(e):this._pendingSubscribers.push(e)})}_markInitialized(){this._isInitialized=!0,this._pendingSubscribers.forEach(this._notifySubscriber),this._pendingSubscribers=null}_notifySubscriber(t){t.next(),t.complete()}}}let z1=(()=>{class i{isErrorState(e,n){return!!(e&&e.invalid&&(e.touched||n&&n.submitted))}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Hb=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275dir=Be({type:i,selectors:[["","mat-line",""],["","matLine",""]],hostAttrs:[1,"mat-line"]}),i})();function U1(i,t,e){i.nativeElement.classList.toggle(t,e)}let Ak=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[jn],jn]}),i})();class Yce{constructor(t,e,n){this._renderer=t,this.element=e,this.config=n,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const y7={enterDuration:225,exitDuration:150},sN=ly({passive:!0}),v7=["mousedown","touchstart"],b7=["mouseup","mouseleave","touchend","touchcancel"];class x7{constructor(t,e,n,r){this._target=t,this._ngZone=e,this._isPointerDown=!1,this._activeRipples=new Set,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=Gm(n))}fadeInRipple(t,e,n={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s=Object.assign(Object.assign({},y7),n.animation);n.centered&&(t=r.left+r.width/2,e=r.top+r.height/2);const a=n.radius||function Jce(i,t,e){const n=Math.max(Math.abs(i-e.left),Math.abs(i-e.right)),r=Math.max(Math.abs(t-e.top),Math.abs(t-e.bottom));return Math.sqrt(n*n+r*r)}(t,e,r),l=t-r.left,u=e-r.top,h=s.enterDuration,m=document.createElement("div");m.classList.add("mat-ripple-element"),m.style.left=l-a+"px",m.style.top=u-a+"px",m.style.height=2*a+"px",m.style.width=2*a+"px",null!=n.color&&(m.style.backgroundColor=n.color),m.style.transitionDuration=`${h}ms`,this._containerElement.appendChild(m),function Qce(i){window.getComputedStyle(i).getPropertyValue("opacity")}(m),m.style.transform="scale(1)";const _=new Yce(this,m,n);return _.state=0,this._activeRipples.add(_),n.persistent||(this._mostRecentTransientRipple=_),this._runTimeoutOutsideZone(()=>{const v=_===this._mostRecentTransientRipple;_.state=1,!n.persistent&&(!v||!this._isPointerDown)&&_.fadeOut()},h),_}fadeOutRipple(t){const e=this._activeRipples.delete(t);if(t===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),this._activeRipples.size||(this._containerRect=null),!e)return;const n=t.element,r=Object.assign(Object.assign({},y7),t.config.animation);n.style.transitionDuration=`${r.exitDuration}ms`,n.style.opacity="0",t.state=2,this._runTimeoutOutsideZone(()=>{t.state=3,n.remove()},r.exitDuration)}fadeOutAll(){this._activeRipples.forEach(t=>t.fadeOut())}fadeOutAllNonPersistent(){this._activeRipples.forEach(t=>{t.config.persistent||t.fadeOut()})}setupTriggerEvents(t){const e=Gm(t);!e||e===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=e,this._registerEvents(v7))}handleEvent(t){"mousedown"===t.type?this._onMousedown(t):"touchstart"===t.type?this._onTouchStart(t):this._onPointerUp(),this._pointerUpEventsRegistered||(this._registerEvents(b7),this._pointerUpEventsRegistered=!0)}_onMousedown(t){const e=$B(t),n=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!e&&!n&&(this._isPointerDown=!0,this.fadeInRipple(t.clientX,t.clientY,this._target.rippleConfig))}_onTouchStart(t){if(!this._target.rippleDisabled&&!eN(t)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const e=t.changedTouches;for(let n=0;n<e.length;n++)this.fadeInRipple(e[n].clientX,e[n].clientY,this._target.rippleConfig)}}_onPointerUp(){!this._isPointerDown||(this._isPointerDown=!1,this._activeRipples.forEach(t=>{!t.config.persistent&&(1===t.state||t.config.terminateOnPointerUp&&0===t.state)&&t.fadeOut()}))}_runTimeoutOutsideZone(t,e=0){this._ngZone.runOutsideAngular(()=>setTimeout(t,e))}_registerEvents(t){this._ngZone.runOutsideAngular(()=>{t.forEach(e=>{this._triggerElement.addEventListener(e,this,sN)})})}_removeTriggerEvents(){this._triggerElement&&(v7.forEach(t=>{this._triggerElement.removeEventListener(t,this,sN)}),this._pointerUpEventsRegistered&&b7.forEach(t=>{this._triggerElement.removeEventListener(t,this,sN)}))}}const w7=new gi("mat-ripple-global-options");let hh=(()=>{class i{constructor(e,n,r,s,a){this._elementRef=e,this._animationMode=a,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=s||{},this._rippleRenderer=new x7(this,n,e,r)}get disabled(){return this._disabled}set disabled(e){e&&this.fadeOutAllNonPersistent(),this._disabled=e,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(e){this._trigger=e,this._setupTriggerEventsIfEnabled()}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:Object.assign(Object.assign(Object.assign({},this._globalOptions.animation),"NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{}),this.animation),terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(e,n=0,r){return"number"==typeof e?this._rippleRenderer.fadeInRipple(e,n,Object.assign(Object.assign({},this.rippleConfig),r)):this._rippleRenderer.fadeInRipple(0,0,Object.assign(Object.assign({},this.rippleConfig),e))}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(Rn),B(ta),B(w7,8),B(ga,8))},i.\u0275dir=Be({type:i,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(e,n){2&e&&N("mat-ripple-unbounded",n.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]}),i})(),zf=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[jn],jn]}),i})(),S7=(()=>{class i{constructor(e){this._animationMode=e,this.state="unchecked",this.disabled=!1}}return i.\u0275fac=function(e){return new(e||i)(B(ga,8))},i.\u0275cmp=ei({type:i,selectors:[["mat-pseudo-checkbox"]],hostAttrs:[1,"mat-pseudo-checkbox"],hostVars:8,hostBindings:function(e,n){2&e&&N("mat-pseudo-checkbox-indeterminate","indeterminate"===n.state)("mat-pseudo-checkbox-checked","checked"===n.state)("mat-pseudo-checkbox-disabled",n.disabled)("_mat-animation-noopable","NoopAnimations"===n._animationMode)},inputs:{state:"state",disabled:"disabled"},decls:0,vars:0,template:function(e,n){},styles:['.mat-pseudo-checkbox{width:16px;height:16px;border:2px solid;border-radius:2px;cursor:pointer;display:inline-block;vertical-align:middle;box-sizing:border-box;position:relative;flex-shrink:0;transition:border-color 90ms cubic-bezier(0, 0, 0.2, 0.1),background-color 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox::after{position:absolute;opacity:0;content:"";border-bottom:2px solid currentColor;transition:opacity 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox.mat-pseudo-checkbox-checked,.mat-pseudo-checkbox.mat-pseudo-checkbox-indeterminate{border-color:transparent}._mat-animation-noopable.mat-pseudo-checkbox{transition:none;animation:none}._mat-animation-noopable.mat-pseudo-checkbox::after{transition:none}.mat-pseudo-checkbox-disabled{cursor:default}.mat-pseudo-checkbox-indeterminate::after{top:5px;left:1px;width:10px;opacity:1;border-radius:2px}.mat-pseudo-checkbox-checked::after{top:2.4px;left:1px;width:8px;height:3px;border-left:2px solid currentColor;transform:rotate(-45deg);opacity:1;box-sizing:content-box}\n'],encapsulation:2,changeDetection:0}),i})(),oN=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[jn]]}),i})();const aN=new gi("MAT_OPTION_PARENT_COMPONENT"),lN=new gi("MatOptgroup");let $ce=0;class C7{constructor(t,e=!1){this.source=t,this.isUserInput=e}}let eue=(()=>{class i{constructor(e,n,r,s){this._element=e,this._changeDetectorRef=n,this._parent=r,this.group=s,this._selected=!1,this._active=!1,this._disabled=!1,this._mostRecentViewValue="",this.id="mat-option-"+$ce++,this.onSelectionChange=new Si,this._stateChanges=new ii}get multiple(){return this._parent&&this._parent.multiple}get selected(){return this._selected}get disabled(){return this.group&&this.group.disabled||this._disabled}set disabled(e){this._disabled=tn(e)}get disableRipple(){return!(!this._parent||!this._parent.disableRipple)}get active(){return this._active}get viewValue(){return(this._getHostElement().textContent||"").trim()}select(){this._selected||(this._selected=!0,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())}deselect(){this._selected&&(this._selected=!1,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())}focus(e,n){const r=this._getHostElement();"function"==typeof r.focus&&r.focus(n)}setActiveStyles(){this._active||(this._active=!0,this._changeDetectorRef.markForCheck())}setInactiveStyles(){this._active&&(this._active=!1,this._changeDetectorRef.markForCheck())}getLabel(){return this.viewValue}_handleKeydown(e){(13===e.keyCode||32===e.keyCode)&&!dc(e)&&(this._selectViaInteraction(),e.preventDefault())}_selectViaInteraction(){this.disabled||(this._selected=!this.multiple||!this._selected,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent(!0))}_getAriaSelected(){return this.selected||!this.multiple&&null}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._element.nativeElement}ngAfterViewChecked(){if(this._selected){const e=this.viewValue;e!==this._mostRecentViewValue&&(this._mostRecentViewValue=e,this._stateChanges.next())}}ngOnDestroy(){this._stateChanges.complete()}_emitSelectionChangeEvent(e=!1){this.onSelectionChange.emit(new C7(this,e))}}return i.\u0275fac=function(e){Nd()},i.\u0275dir=Be({type:i,inputs:{value:"value",id:"id",disabled:"disabled"},outputs:{onSelectionChange:"onSelectionChange"}}),i})(),Vb=(()=>{class i extends eue{constructor(e,n,r,s){super(e,n,r,s)}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(Pn),B(aN,8),B(lN,8))},i.\u0275cmp=ei({type:i,selectors:[["mat-option"]],hostAttrs:["role","option",1,"mat-option","mat-focus-indicator"],hostVars:12,hostBindings:function(e,n){1&e&&je("click",function(){return n._selectViaInteraction()})("keydown",function(s){return n._handleKeydown(s)}),2&e&&(dn("id",n.id),Vi("tabindex",n._getTabIndex())("aria-selected",n._getAriaSelected())("aria-disabled",n.disabled.toString()),N("mat-selected",n.selected)("mat-option-multiple",n.multiple)("mat-active",n.active)("mat-option-disabled",n.disabled))},exportAs:["matOption"],features:[It],ngContentSelectors:Wce,decls:5,vars:4,consts:[["class","mat-option-pseudo-checkbox",3,"state","disabled",4,"ngIf"],[1,"mat-option-text"],["class","cdk-visually-hidden",4,"ngIf"],["mat-ripple","",1,"mat-option-ripple",3,"matRippleTrigger","matRippleDisabled"],[1,"mat-option-pseudo-checkbox",3,"state","disabled"],[1,"cdk-visually-hidden"]],template:function(e,n){1&e&&(As(),Ue(0,Uce,1,2,"mat-pseudo-checkbox",0),Z(1,"span",1),hr(2),J(),Ue(3,Gce,2,1,"span",2),yt(4,"div",3)),2&e&&(fe("ngIf",n.multiple),se(3),fe("ngIf",n.group&&n.group._inert),se(1),fe("matRippleTrigger",n._getHostElement())("matRippleDisabled",n.disabled||n.disableRipple))},directives:[S7,ms,hh],styles:[".mat-option{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;line-height:48px;height:48px;padding:0 16px;text-align:left;text-decoration:none;max-width:100%;position:relative;cursor:pointer;outline:none;display:flex;flex-direction:row;max-width:100%;box-sizing:border-box;align-items:center;-webkit-tap-highlight-color:transparent}.mat-option[disabled]{cursor:default}[dir=rtl] .mat-option{text-align:right}.mat-option .mat-icon{margin-right:16px;vertical-align:middle}.mat-option .mat-icon svg{vertical-align:top}[dir=rtl] .mat-option .mat-icon{margin-left:16px;margin-right:0}.mat-option[aria-disabled=true]{-webkit-user-select:none;user-select:none;cursor:default}.mat-optgroup .mat-option:not(.mat-option-multiple){padding-left:32px}[dir=rtl] .mat-optgroup .mat-option:not(.mat-option-multiple){padding-left:16px;padding-right:32px}.cdk-high-contrast-active .mat-option{margin:0 1px}.cdk-high-contrast-active .mat-option.mat-active{border:solid 1px currentColor;margin:0}.cdk-high-contrast-active .mat-option[aria-disabled=true]{opacity:.5}.mat-option-text{display:inline-block;flex-grow:1;overflow:hidden;text-overflow:ellipsis}.mat-option .mat-option-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-option-pseudo-checkbox{margin-right:8px}[dir=rtl] .mat-option-pseudo-checkbox{margin-left:8px;margin-right:0}\n"],encapsulation:2,changeDetection:0}),i})();function cN(i,t,e){if(e.length){let n=t.toArray(),r=e.toArray(),s=0;for(let a=0;a<i+1;a++)n[a].group&&n[a].group===r[s]&&s++;return s}return 0}function M7(i,t,e,n){return i<e?i:i+t>e+n?Math.max(0,i-n+t):e}let Dk=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[zf,ka,jn,oN]]}),i})();const T7=["mat-button",""],E7=["*"],nue=["mat-button","mat-flat-button","mat-icon-button","mat-raised-button","mat-stroked-button","mat-mini-fab","mat-fab"],rue=Vf(Hf(uh(class{constructor(i){this._elementRef=i}})));let Mo=(()=>{class i extends rue{constructor(e,n,r){super(e),this._focusMonitor=n,this._animationMode=r,this.isRoundButton=this._hasHostAttributes("mat-fab","mat-mini-fab"),this.isIconButton=this._hasHostAttributes("mat-icon-button");for(const s of nue)this._hasHostAttributes(s)&&this._getHostElement().classList.add(s);e.nativeElement.classList.add("mat-button-base"),this.isRoundButton&&(this.color="accent")}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(e,n){e?this._focusMonitor.focusVia(this._getHostElement(),e,n):this._getHostElement().focus(n)}_getHostElement(){return this._elementRef.nativeElement}_isRippleDisabled(){return this.disableRipple||this.disabled}_hasHostAttributes(...e){return e.some(n=>this._getHostElement().hasAttribute(n))}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(ch),B(ga,8))},i.\u0275cmp=ei({type:i,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-icon-button",""],["button","mat-fab",""],["button","mat-mini-fab",""],["button","mat-stroked-button",""],["button","mat-flat-button",""]],viewQuery:function(e,n){if(1&e&&ji(hh,5),2&e){let r;jt(r=qt())&&(n.ripple=r.first)}},hostAttrs:[1,"mat-focus-indicator"],hostVars:5,hostBindings:function(e,n){2&e&&(Vi("disabled",n.disabled||null),N("_mat-animation-noopable","NoopAnimations"===n._animationMode)("mat-button-disabled",n.disabled))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[It],attrs:T7,ngContentSelectors:E7,decls:4,vars:5,consts:[[1,"mat-button-wrapper"],["matRipple","",1,"mat-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-button-focus-overlay"]],template:function(e,n){1&e&&(As(),Z(0,"span",0),hr(1),J(),yt(2,"span",1)(3,"span",2)),2&e&&(se(2),N("mat-button-ripple-round",n.isRoundButton||n.isIconButton),fe("matRippleDisabled",n._isRippleDisabled())("matRippleCentered",n.isIconButton)("matRippleTrigger",n._getHostElement()))},directives:[hh],styles:[".mat-button .mat-button-focus-overlay,.mat-icon-button .mat-button-focus-overlay{opacity:0}.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:.04}@media(hover: none){.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:0}}.mat-button,.mat-icon-button,.mat-stroked-button,.mat-flat-button{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-button.mat-button-disabled,.mat-icon-button.mat-button-disabled,.mat-stroked-button.mat-button-disabled,.mat-flat-button.mat-button-disabled{cursor:default}.mat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-button.cdk-program-focused .mat-button-focus-overlay,.mat-icon-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-icon-button.cdk-program-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-program-focused .mat-button-focus-overlay,.mat-flat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-flat-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-raised-button{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button.mat-button-disabled{cursor:default}.mat-raised-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-raised-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-raised-button::-moz-focus-inner{border:0}._mat-animation-noopable.mat-raised-button{transition:none;animation:none}.mat-stroked-button{border:1px solid currentColor;padding:0 15px;line-height:34px}.mat-stroked-button .mat-button-ripple.mat-ripple,.mat-stroked-button .mat-button-focus-overlay{top:-1px;left:-1px;right:-1px;bottom:-1px}.mat-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:56px;height:56px;padding:0;flex-shrink:0}.mat-fab::-moz-focus-inner{border:0}.mat-fab.mat-button-disabled{cursor:default}.mat-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-fab{transition:none;animation:none}.mat-fab .mat-button-wrapper{padding:16px 0;display:inline-block;line-height:24px}.mat-mini-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:40px;height:40px;padding:0;flex-shrink:0}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab.mat-button-disabled{cursor:default}.mat-mini-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-mini-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-mini-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-mini-fab{transition:none;animation:none}.mat-mini-fab .mat-button-wrapper{padding:8px 0;display:inline-block;line-height:24px}.mat-icon-button{padding:0;min-width:0;width:40px;height:40px;flex-shrink:0;line-height:40px;border-radius:50%}.mat-icon-button i,.mat-icon-button .mat-icon{line-height:24px}.mat-button-ripple.mat-ripple,.mat-button-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-button-ripple.mat-ripple:not(:empty){transform:translateZ(0)}.mat-button-focus-overlay{opacity:0;transition:opacity 200ms cubic-bezier(0.35, 0, 0.25, 1),background-color 200ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable .mat-button-focus-overlay{transition:none}.mat-button-ripple-round{border-radius:50%;z-index:1}.mat-button .mat-button-wrapper>*,.mat-flat-button .mat-button-wrapper>*,.mat-stroked-button .mat-button-wrapper>*,.mat-raised-button .mat-button-wrapper>*,.mat-icon-button .mat-button-wrapper>*,.mat-fab .mat-button-wrapper>*,.mat-mini-fab .mat-button-wrapper>*{vertical-align:middle}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button{display:inline-flex;justify-content:center;align-items:center;font-size:inherit;width:2.5em;height:2.5em}.cdk-high-contrast-active .mat-button,.cdk-high-contrast-active .mat-flat-button,.cdk-high-contrast-active .mat-raised-button,.cdk-high-contrast-active .mat-icon-button,.cdk-high-contrast-active .mat-fab,.cdk-high-contrast-active .mat-mini-fab{outline:solid 1px}.cdk-high-contrast-active .mat-button-base.cdk-keyboard-focused,.cdk-high-contrast-active .mat-button-base.cdk-program-focused{outline:solid 3px}\n"],encapsulation:2,changeDetection:0}),i})(),A7=(()=>{class i extends Mo{constructor(e,n,r,s){super(n,e,r),this._ngZone=s,this._haltDisabledEvents=a=>{this.disabled&&(a.preventDefault(),a.stopImmediatePropagation())}}ngAfterViewInit(){super.ngAfterViewInit(),this._ngZone?this._ngZone.runOutsideAngular(()=>{this._elementRef.nativeElement.addEventListener("click",this._haltDisabledEvents)}):this._elementRef.nativeElement.addEventListener("click",this._haltDisabledEvents)}ngOnDestroy(){super.ngOnDestroy(),this._elementRef.nativeElement.removeEventListener("click",this._haltDisabledEvents)}}return i.\u0275fac=function(e){return new(e||i)(B(ch),B(ai),B(ga,8),B(Rn,8))},i.\u0275cmp=ei({type:i,selectors:[["a","mat-button",""],["a","mat-raised-button",""],["a","mat-icon-button",""],["a","mat-fab",""],["a","mat-mini-fab",""],["a","mat-stroked-button",""],["a","mat-flat-button",""]],hostAttrs:[1,"mat-focus-indicator"],hostVars:7,hostBindings:function(e,n){2&e&&(Vi("tabindex",n.disabled?-1:n.tabIndex)("disabled",n.disabled||null)("aria-disabled",n.disabled.toString()),N("_mat-animation-noopable","NoopAnimations"===n._animationMode)("mat-button-disabled",n.disabled))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color",tabIndex:"tabIndex"},exportAs:["matButton","matAnchor"],features:[It],attrs:T7,ngContentSelectors:E7,decls:4,vars:5,consts:[[1,"mat-button-wrapper"],["matRipple","",1,"mat-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-button-focus-overlay"]],template:function(e,n){1&e&&(As(),Z(0,"span",0),hr(1),J(),yt(2,"span",1)(3,"span",2)),2&e&&(se(2),N("mat-button-ripple-round",n.isRoundButton||n.isIconButton),fe("matRippleDisabled",n._isRippleDisabled())("matRippleCentered",n.isIconButton)("matRippleTrigger",n._getHostElement()))},directives:[hh],styles:[".mat-button .mat-button-focus-overlay,.mat-icon-button .mat-button-focus-overlay{opacity:0}.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:.04}@media(hover: none){.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:0}}.mat-button,.mat-icon-button,.mat-stroked-button,.mat-flat-button{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-button.mat-button-disabled,.mat-icon-button.mat-button-disabled,.mat-stroked-button.mat-button-disabled,.mat-flat-button.mat-button-disabled{cursor:default}.mat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-button.cdk-program-focused .mat-button-focus-overlay,.mat-icon-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-icon-button.cdk-program-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-program-focused .mat-button-focus-overlay,.mat-flat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-flat-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-raised-button{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button.mat-button-disabled{cursor:default}.mat-raised-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-raised-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-raised-button::-moz-focus-inner{border:0}._mat-animation-noopable.mat-raised-button{transition:none;animation:none}.mat-stroked-button{border:1px solid currentColor;padding:0 15px;line-height:34px}.mat-stroked-button .mat-button-ripple.mat-ripple,.mat-stroked-button .mat-button-focus-overlay{top:-1px;left:-1px;right:-1px;bottom:-1px}.mat-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:56px;height:56px;padding:0;flex-shrink:0}.mat-fab::-moz-focus-inner{border:0}.mat-fab.mat-button-disabled{cursor:default}.mat-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-fab{transition:none;animation:none}.mat-fab .mat-button-wrapper{padding:16px 0;display:inline-block;line-height:24px}.mat-mini-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:40px;height:40px;padding:0;flex-shrink:0}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab.mat-button-disabled{cursor:default}.mat-mini-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-mini-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-mini-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-mini-fab{transition:none;animation:none}.mat-mini-fab .mat-button-wrapper{padding:8px 0;display:inline-block;line-height:24px}.mat-icon-button{padding:0;min-width:0;width:40px;height:40px;flex-shrink:0;line-height:40px;border-radius:50%}.mat-icon-button i,.mat-icon-button .mat-icon{line-height:24px}.mat-button-ripple.mat-ripple,.mat-button-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-button-ripple.mat-ripple:not(:empty){transform:translateZ(0)}.mat-button-focus-overlay{opacity:0;transition:opacity 200ms cubic-bezier(0.35, 0, 0.25, 1),background-color 200ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable .mat-button-focus-overlay{transition:none}.mat-button-ripple-round{border-radius:50%;z-index:1}.mat-button .mat-button-wrapper>*,.mat-flat-button .mat-button-wrapper>*,.mat-stroked-button .mat-button-wrapper>*,.mat-raised-button .mat-button-wrapper>*,.mat-icon-button .mat-button-wrapper>*,.mat-fab .mat-button-wrapper>*,.mat-mini-fab .mat-button-wrapper>*{vertical-align:middle}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button{display:inline-flex;justify-content:center;align-items:center;font-size:inherit;width:2.5em;height:2.5em}.cdk-high-contrast-active .mat-button,.cdk-high-contrast-active .mat-flat-button,.cdk-high-contrast-active .mat-raised-button,.cdk-high-contrast-active .mat-icon-button,.cdk-high-contrast-active .mat-fab,.cdk-high-contrast-active .mat-mini-fab{outline:solid 1px}.cdk-high-contrast-active .mat-button-base.cdk-keyboard-focused,.cdk-high-contrast-active .mat-button-base.cdk-program-focused{outline:solid 3px}\n"],encapsulation:2,changeDetection:0}),i})(),jw=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[zf,jn],jn]}),i})();function zb(...i){const t=tu(i),e=Jp(i),{args:n,keys:r}=L6(i);if(0===n.length)return xr([],t);const s=new ft(function sue(i,t,e=Rt){return n=>{D7(t,()=>{const{length:r}=i,s=new Array(r);let a=r,l=r;for(let u=0;u<r;u++)D7(t,()=>{const h=xr(i[u],t);let m=!1;h.subscribe(qn(n,_=>{s[u]=_,m||(m=!0,l--),l||n.next(e(s.slice()))},()=>{--a||n.complete()}))},n)},n)}}(n,t,r?a=>O6(r,a):Rt));return e?s.pipe(W3(e)):s}function D7(i,t,e){i?Fc(e,i,t):t()}const R7=new Set;let qw,oue=(()=>{class i{constructor(e){this._platform=e,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):lue}matchMedia(e){return(this._platform.WEBKIT||this._platform.BLINK)&&function aue(i){if(!R7.has(i))try{qw||(qw=document.createElement("style"),qw.setAttribute("type","text/css"),document.head.appendChild(qw)),qw.sheet&&(qw.sheet.insertRule(`@media ${i} {body{ }}`,0),R7.add(i))}catch(t){console.error(t)}}(e),this._matchMedia(e)}}return i.\u0275fac=function(e){return new(e||i)(Ve(ta))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function lue(i){return{matches:"all"===i||""===i,media:i,addListener:()=>{},removeListener:()=>{}}}let Rk=(()=>{class i{constructor(e,n){this._mediaMatcher=e,this._zone=n,this._queries=new Map,this._destroySubject=new ii}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(e){return k7(E1(e)).some(r=>this._registerQuery(r).mql.matches)}observe(e){let s=zb(k7(E1(e)).map(a=>this._registerQuery(a).observable));return s=V1(s.pipe(Qr(1)),s.pipe(N1(1),jm(0))),s.pipe(Ui(a=>{const l={matches:!1,breakpoints:{}};return a.forEach(({matches:u,query:h})=>{l.matches=l.matches||u,l.breakpoints[h]=u}),l}))}_registerQuery(e){if(this._queries.has(e))return this._queries.get(e);const n=this._mediaMatcher.matchMedia(e),s={observable:new ft(a=>{const l=u=>this._zone.run(()=>a.next(u));return n.addListener(l),()=>{n.removeListener(l)}}).pipe(Tl(n),Ui(({matches:a})=>({query:e,matches:a})),$n(this._destroySubject)),mql:n};return this._queries.set(e,s),s}}return i.\u0275fac=function(e){return new(e||i)(Ve(oue),Ve(Rn))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function k7(i){return i.map(t=>t.split(",")).reduce((t,e)=>t.concat(e)).map(t=>t.trim())}const my_Medium="(min-width: 960px) and (max-width: 1279.98px)",my_Large="(min-width: 1280px) and (max-width: 1919.98px)";function cue(i,t){if(1&i){const e=Wi();Z(0,"div",2)(1,"button",3),je("click",function(){return gt(e),Re().action()}),ue(2),J()()}if(2&i){const e=Re();se(2),Xt(e.data.action)}}function uue(i,t){}const kk=new gi("MatSnackBarData");class Pk{constructor(){this.politeness="assertive",this.announcementMessage="",this.duration=0,this.data=null,this.horizontalPosition="center",this.verticalPosition="bottom"}}const hue=Math.pow(2,31)-1;class uN{constructor(t,e){this._overlayRef=e,this._afterDismissed=new ii,this._afterOpened=new ii,this._onAction=new ii,this._dismissedByAction=!1,this.containerInstance=t,this.onAction().subscribe(()=>this.dismiss()),t._onExit.subscribe(()=>this._finishDismiss())}dismiss(){this._afterDismissed.closed||this.containerInstance.exit(),clearTimeout(this._durationTimeoutId)}dismissWithAction(){this._onAction.closed||(this._dismissedByAction=!0,this._onAction.next(),this._onAction.complete()),clearTimeout(this._durationTimeoutId)}closeWithAction(){this.dismissWithAction()}_dismissAfter(t){this._durationTimeoutId=setTimeout(()=>this.dismiss(),Math.min(t,hue))}_open(){this._afterOpened.closed||(this._afterOpened.next(),this._afterOpened.complete())}_finishDismiss(){this._overlayRef.dispose(),this._onAction.closed||this._onAction.complete(),this._afterDismissed.next({dismissedByAction:this._dismissedByAction}),this._afterDismissed.complete(),this._dismissedByAction=!1}afterDismissed(){return this._afterDismissed}afterOpened(){return this.containerInstance._onEnter}onAction(){return this._onAction}}let due=(()=>{class i{constructor(e,n){this.snackBarRef=e,this.data=n}action(){this.snackBarRef.dismissWithAction()}get hasAction(){return!!this.data.action}}return i.\u0275fac=function(e){return new(e||i)(B(uN),B(kk))},i.\u0275cmp=ei({type:i,selectors:[["simple-snack-bar"]],hostAttrs:[1,"mat-simple-snackbar"],decls:3,vars:2,consts:[[1,"mat-simple-snack-bar-content"],["class","mat-simple-snackbar-action",4,"ngIf"],[1,"mat-simple-snackbar-action"],["mat-button","",3,"click"]],template:function(e,n){1&e&&(Z(0,"span",0),ue(1),J(),Ue(2,cue,3,1,"div",1)),2&e&&(se(1),Xt(n.data.message),se(1),fe("ngIf",n.hasAction))},directives:[Mo,ms],styles:[".mat-simple-snackbar{display:flex;justify-content:space-between;align-items:center;line-height:20px;opacity:1}.mat-simple-snackbar-action{flex-shrink:0;margin:-8px -8px -8px 8px}.mat-simple-snackbar-action button{max-height:36px;min-width:0}[dir=rtl] .mat-simple-snackbar-action{margin-left:-8px;margin-right:8px}.mat-simple-snack-bar-content{overflow:hidden;text-overflow:ellipsis}\n"],encapsulation:2,changeDetection:0}),i})();const fue={snackBarState:Xd("state",[Cl("void, hidden",Xs({transform:"scale(0.8)",opacity:0})),Cl("visible",Xs({transform:"scale(1)",opacity:1})),Ml("* => visible",ql("150ms cubic-bezier(0, 0, 0.2, 1)")),Ml("* => void, * => hidden",ql("75ms cubic-bezier(0.4, 0.0, 1, 1)",Xs({opacity:0})))])};let pue=(()=>{class i extends L1{constructor(e,n,r,s,a){super(),this._ngZone=e,this._elementRef=n,this._changeDetectorRef=r,this._platform=s,this.snackBarConfig=a,this._announceDelay=150,this._destroyed=!1,this._onAnnounce=new ii,this._onExit=new ii,this._onEnter=new ii,this._animationState="void",this.attachDomPortal=l=>(this._assertNotAttached(),this._applySnackBarClasses(),this._portalOutlet.attachDomPortal(l)),this._live="assertive"!==a.politeness||a.announcementMessage?"off"===a.politeness?"off":"polite":"assertive",this._platform.FIREFOX&&("polite"===this._live&&(this._role="status"),"assertive"===this._live&&(this._role="alert"))}attachComponentPortal(e){return this._assertNotAttached(),this._applySnackBarClasses(),this._portalOutlet.attachComponentPortal(e)}attachTemplatePortal(e){return this._assertNotAttached(),this._applySnackBarClasses(),this._portalOutlet.attachTemplatePortal(e)}onAnimationEnd(e){const{fromState:n,toState:r}=e;if(("void"===r&&"void"!==n||"hidden"===r)&&this._completeExit(),"visible"===r){const s=this._onEnter;this._ngZone.run(()=>{s.next(),s.complete()})}}enter(){this._destroyed||(this._animationState="visible",this._changeDetectorRef.detectChanges(),this._screenReaderAnnounce())}exit(){return this._ngZone.run(()=>{this._animationState="hidden",this._elementRef.nativeElement.setAttribute("mat-exit",""),clearTimeout(this._announceTimeoutId)}),this._onExit}ngOnDestroy(){this._destroyed=!0,this._completeExit()}_completeExit(){this._ngZone.onMicrotaskEmpty.pipe(Qr(1)).subscribe(()=>{this._ngZone.run(()=>{this._onExit.next(),this._onExit.complete()})})}_applySnackBarClasses(){const e=this._elementRef.nativeElement,n=this.snackBarConfig.panelClass;n&&(Array.isArray(n)?n.forEach(r=>e.classList.add(r)):e.classList.add(n)),"center"===this.snackBarConfig.horizontalPosition&&e.classList.add("mat-snack-bar-center"),"top"===this.snackBarConfig.verticalPosition&&e.classList.add("mat-snack-bar-top")}_assertNotAttached(){this._portalOutlet.hasAttached()}_screenReaderAnnounce(){this._announceTimeoutId||this._ngZone.runOutsideAngular(()=>{this._announceTimeoutId=setTimeout(()=>{const e=this._elementRef.nativeElement.querySelector("[aria-hidden]"),n=this._elementRef.nativeElement.querySelector("[aria-live]");if(e&&n){let r=null;this._platform.isBrowser&&document.activeElement instanceof HTMLElement&&e.contains(document.activeElement)&&(r=document.activeElement),e.removeAttribute("aria-hidden"),n.appendChild(e),null==r||r.focus(),this._onAnnounce.next(),this._onAnnounce.complete()}},this._announceDelay)})}}return i.\u0275fac=function(e){return new(e||i)(B(Rn),B(ai),B(Pn),B(ta),B(Pk))},i.\u0275cmp=ei({type:i,selectors:[["snack-bar-container"]],viewQuery:function(e,n){if(1&e&&ji(Wm,7),2&e){let r;jt(r=qt())&&(n._portalOutlet=r.first)}},hostAttrs:[1,"mat-snack-bar-container"],hostVars:1,hostBindings:function(e,n){1&e&&Q_("@state.done",function(s){return n.onAnimationEnd(s)}),2&e&&Cr("@state",n._animationState)},features:[It],decls:3,vars:2,consts:[["aria-hidden","true"],["cdkPortalOutlet",""]],template:function(e,n){1&e&&(Z(0,"div",0),Ue(1,uue,0,0,"ng-template",1),J(),yt(2,"div")),2&e&&(se(2),Vi("aria-live",n._live)("role",n._role))},directives:[Wm],styles:[".mat-snack-bar-container{border-radius:4px;box-sizing:border-box;display:block;margin:24px;max-width:33vw;min-width:344px;padding:14px 16px;min-height:48px;transform-origin:center}.cdk-high-contrast-active .mat-snack-bar-container{border:solid 1px}.mat-snack-bar-handset{width:100%}.mat-snack-bar-handset .mat-snack-bar-container{margin:8px;max-width:100%;min-width:0;width:100%}\n"],encapsulation:2,data:{animation:[fue.snackBarState]}}),i})(),hN=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[Nb,O1,ka,jw,jn],jn]}),i})();const P7=new gi("mat-snack-bar-default-options",{providedIn:"root",factory:function mue(){return new Pk}});let gue=(()=>{class i{constructor(e,n,r,s,a,l){this._overlay=e,this._live=n,this._injector=r,this._breakpointObserver=s,this._parentSnackBar=a,this._defaultConfig=l,this._snackBarRefAtThisLevel=null}get _openedSnackBarRef(){const e=this._parentSnackBar;return e?e._openedSnackBarRef:this._snackBarRefAtThisLevel}set _openedSnackBarRef(e){this._parentSnackBar?this._parentSnackBar._openedSnackBarRef=e:this._snackBarRefAtThisLevel=e}openFromComponent(e,n){return this._attach(e,n)}openFromTemplate(e,n){return this._attach(e,n)}open(e,n="",r){const s=Object.assign(Object.assign({},this._defaultConfig),r);return s.data={message:e,action:n},s.announcementMessage===e&&(s.announcementMessage=void 0),this.openFromComponent(this.simpleSnackBarComponent,s)}dismiss(){this._openedSnackBarRef&&this._openedSnackBarRef.dismiss()}ngOnDestroy(){this._snackBarRefAtThisLevel&&this._snackBarRefAtThisLevel.dismiss()}_attachSnackBarContainer(e,n){const s=Os.create({parent:n&&n.viewContainerRef&&n.viewContainerRef.injector||this._injector,providers:[{provide:Pk,useValue:n}]}),a=new hy(this.snackBarContainerComponent,n.viewContainerRef,s),l=e.attach(a);return l.instance.snackBarConfig=n,l.instance}_attach(e,n){const r=Object.assign(Object.assign(Object.assign({},new Pk),this._defaultConfig),n),s=this._createOverlay(r),a=this._attachSnackBarContainer(s,r),l=new uN(a,s);if(e instanceof Xo){const u=new Ep(e,null,{$implicit:r.data,snackBarRef:l});l.instance=a.attachTemplatePortal(u)}else{const u=this._createInjector(r,l),h=new hy(e,void 0,u),m=a.attachComponentPortal(h);l.instance=m.instance}return this._breakpointObserver.observe("(max-width: 599.98px) and (orientation: portrait)").pipe($n(s.detachments())).subscribe(u=>{s.overlayElement.classList.toggle(this.handsetCssClass,u.matches)}),r.announcementMessage&&a._onAnnounce.subscribe(()=>{this._live.announce(r.announcementMessage,r.politeness)}),this._animateSnackBar(l,r),this._openedSnackBarRef=l,this._openedSnackBarRef}_animateSnackBar(e,n){e.afterDismissed().subscribe(()=>{this._openedSnackBarRef==e&&(this._openedSnackBarRef=null),n.announcementMessage&&this._live.clear()}),this._openedSnackBarRef?(this._openedSnackBarRef.afterDismissed().subscribe(()=>{e.containerInstance.enter()}),this._openedSnackBarRef.dismiss()):e.containerInstance.enter(),n.duration&&n.duration>0&&e.afterOpened().subscribe(()=>e._dismissAfter(n.duration))}_createOverlay(e){const n=new Fb;n.direction=e.direction;let r=this._overlay.position().global();const s="rtl"===e.direction,a="left"===e.horizontalPosition||"start"===e.horizontalPosition&&!s||"end"===e.horizontalPosition&&s,l=!a&&"center"!==e.horizontalPosition;return a?r.left("0"):l?r.right("0"):r.centerHorizontally(),"top"===e.verticalPosition?r.top("0"):r.bottom("0"),n.positionStrategy=r,this._overlay.create(n)}_createInjector(e,n){return Os.create({parent:e&&e.viewContainerRef&&e.viewContainerRef.injector||this._injector,providers:[{provide:uN,useValue:n},{provide:kk,useValue:e.data}]})}}return i.\u0275fac=function(e){return new(e||i)(Ve(Du),Ve(tN),Ve(Os),Ve(Rk),Ve(i,12),Ve(P7))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})(),Ru=(()=>{class i extends gue{constructor(e,n,r,s,a,l){super(e,n,r,s,a,l),this.simpleSnackBarComponent=due,this.snackBarContainerComponent=pue,this.handsetCssClass="mat-snack-bar-handset"}}return i.\u0275fac=function(e){return new(e||i)(Ve(Du),Ve(tN),Ve(Os),Ve(Rk),Ve(i,12),Ve(P7))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:hN}),i})();class dr{constructor(t,e,n){this.http=t,this._snackBar=e,this.titleService=n,this.handler={set:(r,s,a)=>(r[s]=a,dr.settingsSubject.next(dr.settings),!0)},dr.settingsSubject.subscribe(r=>{r&&this.titleService.setTitle(r.get("title"))})}get config(){return dr.settings}get configAsObservable(){return dr.settingsSubject.asObservable()}publishChanges(){dr.settingsSubject.next(dr.settings)}load(){const t="config.json?r="+class dle{static uuid(){let t=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?n:3&n|8).toString(16)})}static suid(){let t=(new Date).getTime();return"xxx-xxx-xxx".replace(/[xy]/g,function(e){const n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?n:3&n|8).toString(16)})}}.suid();return new Promise((e,n)=>{this.http.get(t).toPromise().then(r=>{dr.settings=new Proxy(Pb.deserialize(r),this.handler),dr.settingsSubject.next(dr.settings),e()}).catch(r=>{this._snackBar.open("No config file present, using default config.","Dismiss",{duration:1e6,verticalPosition:"top"}),dr.settings=new Proxy(new Pb,this.handler),dr.settingsSubject.next(dr.settings),console.log(`No config present at '${t}'. Using default.`),e()})})}}dr.settingsSubject=new gs(null),dr.\u0275fac=function(t){return new(t||dr)(Ve(ma),Ve(Ru),Ve(y6))},dr.\u0275prov=Nt({token:dr,factory:dr.\u0275fac});const ya="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,Yl=Object.keys,ru=Array.isArray;function ku(i,t){return"object"!=typeof t||Yl(t).forEach(function(e){i[e]=t[e]}),i}"undefined"==typeof Promise||ya.Promise||(ya.Promise=Promise);const G1=Object.getPrototypeOf,_ue={}.hasOwnProperty;function Lh(i,t){return _ue.call(i,t)}function Xw(i,t){"function"==typeof t&&(t=t(G1(i))),("undefined"==typeof Reflect?Yl:Reflect.ownKeys)(t).forEach(e=>{qm(i,e,t[e])})}const I7=Object.defineProperty;function qm(i,t,e,n){I7(i,t,ku(e&&Lh(e,"get")&&"function"==typeof e.get?{get:e.get,set:e.set,configurable:!0}:{value:e,configurable:!0,writable:!0},n))}function Zw(i){return{from:function(t){return i.prototype=Object.create(t.prototype),qm(i.prototype,"constructor",i),{extend:Xw.bind(null,i.prototype)}}}}const yue=Object.getOwnPropertyDescriptor;function dN(i,t){let e;return yue(i,t)||(e=G1(i))&&dN(e,t)}const vue=[].slice;function Ik(i,t,e){return vue.call(i,t,e)}function L7(i,t){return t(i)}function W1(i){if(!i)throw new Error("Assertion Failed")}function O7(i){ya.setImmediate?setImmediate(i):setTimeout(i,0)}function F7(i,t){return i.reduce((e,n,r)=>{var s=t(n,r);return s&&(e[s[0]]=s[1]),e},{})}function Xm(i,t){if(Lh(i,t))return i[t];if(!t)return i;if("string"!=typeof t){for(var e=[],n=0,r=t.length;n<r;++n){var s=Xm(i,t[n]);e.push(s)}return e}var a=t.indexOf(".");if(-1!==a){var l=i[t.substr(0,a)];return void 0===l?void 0:Xm(l,t.substr(a+1))}}function Uf(i,t,e){if(i&&void 0!==t&&(!("isFrozen"in Object)||!Object.isFrozen(i)))if("string"!=typeof t&&"length"in t){W1("string"!=typeof e&&"length"in e);for(var n=0,r=t.length;n<r;++n)Uf(i,t[n],e[n])}else{var s=t.indexOf(".");if(-1!==s){var a=t.substr(0,s),l=t.substr(s+1);if(""===l)void 0===e?ru(i)&&!isNaN(parseInt(a))?i.splice(a,1):delete i[a]:i[a]=e;else{var u=i[a];u&&Lh(i,a)||(u=i[a]={}),Uf(u,l,e)}}else void 0===e?ru(i)&&!isNaN(parseInt(t))?i.splice(t,1):delete i[t]:i[t]=e}}function B7(i){var t={};for(var e in i)Lh(i,e)&&(t[e]=i[e]);return t}const bue=[].concat;function N7(i){return bue.apply([],i)}const H7="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(N7([8,16,32,64].map(i=>["Int","Uint","Float"].map(t=>t+i+"Array")))).filter(i=>ya[i]),xue=H7.map(i=>ya[i]);F7(H7,i=>[i,!0]);let gy=null;function j1(i){gy="undefined"!=typeof WeakMap&&new WeakMap;const t=fN(i);return gy=null,t}function fN(i){if(!i||"object"!=typeof i)return i;let t=gy&&gy.get(i);if(t)return t;if(ru(i)){t=[],gy&&gy.set(i,t);for(var e=0,n=i.length;e<n;++e)t.push(fN(i[e]))}else if(xue.indexOf(i.constructor)>=0)t=i;else{const s=G1(i);for(var r in t=s===Object.prototype?{}:Object.create(s),gy&&gy.set(i,t),i)Lh(i,r)&&(t[r]=fN(i[r]))}return t}const{toString:wue}={};function pN(i){return wue.call(i).slice(8,-1)}const mN="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator",Sue="symbol"==typeof mN?function(i){var t;return null!=i&&(t=i[mN])&&t.apply(i)}:function(){return null},Yw={};function Zm(i){var t,e,n,r;if(1===arguments.length){if(ru(i))return i.slice();if(this===Yw&&"string"==typeof i)return[i];if(r=Sue(i)){for(e=[];!(n=r.next()).done;)e.push(n.value);return e}if(null==i)return[i];if("number"==typeof(t=i.length)){for(e=new Array(t);t--;)e[t]=i[t];return e}return[i]}for(t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];return e}const gN="undefined"!=typeof Symbol?i=>"AsyncFunction"===i[Symbol.toStringTag]:()=>!1;var Ap="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function V7(i,t){Ap=i,z7=t}var z7=()=>!0;const Cue=!new Error("").stack;function Ub(){if(Cue)try{throw new Error}catch(i){return i}return new Error}function _N(i,t){var e=i.stack;return e?(t=t||0,0===e.indexOf(i.name)&&(t+=(i.name+i.message).split("\n").length),e.split("\n").slice(t).filter(z7).map(n=>"\n"+n).join("")):""}var U7=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],yN=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(U7),Mue={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Kw(i,t){this._e=Ub(),this.name=i,this.message=t}function G7(i,t){return i+". Errors: "+Object.keys(t).map(e=>t[e].toString()).filter((e,n,r)=>r.indexOf(e)===n).join("\n")}function Lk(i,t,e,n){this._e=Ub(),this.failures=t,this.failedKeys=n,this.successCount=e,this.message=G7(i,t)}function q1(i,t){this._e=Ub(),this.name="BulkError",this.failures=Object.keys(t).map(e=>t[e]),this.failuresByPos=t,this.message=G7(i,t)}Zw(Kw).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+_N(this._e,2))}},toString:function(){return this.name+": "+this.message}}),Zw(Lk).from(Kw),Zw(q1).from(Kw);var vN=yN.reduce((i,t)=>(i[t]=t+"Error",i),{});const Tue=Kw;var Yr=yN.reduce((i,t)=>{var e=t+"Error";function n(r,s){this._e=Ub(),this.name=e,r?"string"==typeof r?(this.message=`${r}${s?"\n "+s:""}`,this.inner=s||null):"object"==typeof r&&(this.message=`${r.name} ${r.message}`,this.inner=r):(this.message=Mue[t]||e,this.inner=null)}return Zw(n).from(Tue),i[t]=n,i},{});Yr.Syntax=SyntaxError,Yr.Type=TypeError,Yr.Range=RangeError;var W7=U7.reduce((i,t)=>(i[t+"Error"]=Yr[t],i),{}),Ok=yN.reduce((i,t)=>(-1===["Syntax","Type","Range"].indexOf(t)&&(i[t+"Error"]=Yr[t]),i),{});function Jo(){}function X1(i){return i}function Eue(i,t){return null==i||i===X1?t:function(e){return t(i(e))}}function Gb(i,t){return function(){i.apply(this,arguments),t.apply(this,arguments)}}function Aue(i,t){return i===Jo?t:function(){var e=i.apply(this,arguments);void 0!==e&&(arguments[0]=e);var n=this.onsuccess,r=this.onerror;this.onsuccess=null,this.onerror=null;var s=t.apply(this,arguments);return n&&(this.onsuccess=this.onsuccess?Gb(n,this.onsuccess):n),r&&(this.onerror=this.onerror?Gb(r,this.onerror):r),void 0!==s?s:e}}function Due(i,t){return i===Jo?t:function(){i.apply(this,arguments);var e=this.onsuccess,n=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),e&&(this.onsuccess=this.onsuccess?Gb(e,this.onsuccess):e),n&&(this.onerror=this.onerror?Gb(n,this.onerror):n)}}function Rue(i,t){return i===Jo?t:function(e){var n=i.apply(this,arguments);ku(e,n);var r=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?Gb(r,this.onsuccess):r),s&&(this.onerror=this.onerror?Gb(s,this.onerror):s),void 0===n?void 0===a?void 0:a:ku(n,a)}}function kue(i,t){return i===Jo?t:function(){return!1!==t.apply(this,arguments)&&i.apply(this,arguments)}}function bN(i,t){return i===Jo?t:function(){var e=i.apply(this,arguments);if(e&&"function"==typeof e.then){for(var n=this,r=arguments.length,s=new Array(r);r--;)s[r]=arguments[r];return e.then(function(){return t.apply(n,s)})}return t.apply(this,arguments)}}Ok.ModifyError=Lk,Ok.DexieError=Kw,Ok.BulkError=q1;var Z1={};const[xN,Fk,wN]="undefined"==typeof Promise?[]:(()=>{let i=Promise.resolve();if("undefined"==typeof crypto||!crypto.subtle)return[i,G1(i),i];const t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,G1(t),i]})(),j7=Fk&&Fk.then,Bk=xN&&xN.constructor,SN=!!wN;var CN=!1,Pue=wN?()=>{wN.then(zk)}:ya.setImmediate?setImmediate.bind(null,zk):ya.MutationObserver?()=>{var i=document.createElement("div");new MutationObserver(()=>{zk(),i=null}).observe(i,{attributes:!0}),i.setAttribute("i","1")}:()=>{setTimeout(zk,0)},Y1=function(i,t){K1.push([i,t]),Nk&&(Pue(),Nk=!1)},MN=!0,Nk=!0,Wb=[],Hk=[],TN=null,EN=X1,Qw={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:ej,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(i=>{try{ej(i[0],i[1])}catch(t){}})}},Ar=Qw,K1=[],jb=0,Vk=[];function Nn(i){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=Jo,this._lib=!1;var t=this._PSD=Ar;if(Ap&&(this._stackHolder=Ub(),this._prev=null,this._numPrev=0),"function"!=typeof i){if(i!==Z1)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&DN(this,this._value))}this._state=null,this._value=null,++t.ref,X7(this,i)}const AN={get:function(){var i=Ar,t=Wk;function e(n,r){var s=!i.global&&(i!==Ar||t!==Wk);const a=s&&!Ym();var l=new Nn((u,h)=>{RN(this,new q7(qk(n,i,s,a),qk(r,i,s,a),u,h,i))});return Ap&&K7(l,this),l}return e.prototype=Z1,e},set:function(i){qm(this,"then",i&&i.prototype===Z1?AN:{get:function(){return i},set:AN.set})}};function q7(i,t,e,n,r){this.onFulfilled="function"==typeof i?i:null,this.onRejected="function"==typeof t?t:null,this.resolve=e,this.reject=n,this.psd=r}function X7(i,t){try{t(e=>{if(null===i._state){if(e===i)throw new TypeError("A promise cannot be resolved with itself.");var n=i._lib&&Q1();e&&"function"==typeof e.then?X7(i,(r,s)=>{e instanceof Nn?e._then(r,s):e.then(r,s)}):(i._state=!0,i._value=e,Z7(i)),n&&J1()}},DN.bind(null,i))}catch(e){DN(i,e)}}function DN(i,t){if(Hk.push(t),null===i._state){var e=i._lib&&Q1();t=EN(t),i._state=!1,i._value=t,Ap&&null!==t&&"object"==typeof t&&!t._promise&&function(n,r,s){try{(()=>{var n=dN(t,"stack");t._promise=i,qm(t,"stack",{get:()=>CN?n&&(n.get?n.get.apply(t):n.value):i.stack})}).apply(null,void 0)}catch(a){}}(),n=i,Wb.some(r=>r._value===n._value)||Wb.push(n),Z7(i),e&&J1()}var n}function Z7(i){var t=i._listeners;i._listeners=[];for(var e=0,n=t.length;e<n;++e)RN(i,t[e]);var r=i._PSD;--r.ref||r.finalize(),0===jb&&(++jb,Y1(()=>{0==--jb&&kN()},[]))}function RN(i,t){if(null!==i._state){var e=i._state?t.onFulfilled:t.onRejected;if(null===e)return(i._state?t.resolve:t.reject)(i._value);++t.psd.ref,++jb,Y1(Iue,[e,i,t])}else i._listeners.push(t)}function Iue(i,t,e){try{TN=t;var n,r=t._value;t._state?n=i(r):(Hk.length&&(Hk=[]),n=i(r),-1===Hk.indexOf(r)&&function(s){for(var a=Wb.length;a;)if(Wb[--a]._value===s._value)return void Wb.splice(a,1)}(t)),e.resolve(n)}catch(s){e.reject(s)}finally{TN=null,0==--jb&&kN(),--e.psd.ref||e.psd.finalize()}}function Y7(i,t,e){if(t.length===e)return t;var n="";if(!1===i._state){var r,s,a=i._value;null!=a?(r=a.name||"Error",s=a.message||a,n=_N(a,0)):(r=a,s=""),t.push(r+(s?": "+s:"")+n)}return Ap&&((n=_N(i._stackHolder,2))&&-1===t.indexOf(n)&&t.push(n),i._prev&&Y7(i._prev,t,e)),t}function K7(i,t){var e=t?t._numPrev+1:0;e<100&&(i._prev=t,i._numPrev=e)}function zk(){Q1()&&J1()}function Q1(){var i=MN;return MN=!1,Nk=!1,i}function J1(){var i,t,e;do{for(;K1.length>0;)for(i=K1,K1=[],e=i.length,t=0;t<e;++t){var n=i[t];n[0].apply(null,n[1])}}while(K1.length>0);MN=!0,Nk=!0}function kN(){var i=Wb;Wb=[],i.forEach(n=>{n._PSD.onunhandled.call(null,n._value,n)});for(var t=Vk.slice(0),e=t.length;e;)t[--e]()}function Uk(i){return new Nn(Z1,!1,i)}function La(i,t){var e=Ar;return function(){var n=Q1(),r=Ar;try{return yy(e,!0),i.apply(this,arguments)}catch(s){t&&t(s)}finally{yy(r,!1),n&&J1()}}}Xw(Nn.prototype,{then:AN,_then:function(i,t){RN(this,new q7(null,null,i,t,Ar))},catch:function(i){if(1===arguments.length)return this.then(null,i);var t=arguments[0],e=arguments[1];return this.then(null,"function"==typeof t?n=>n instanceof t?e(n):Uk(n):n=>n&&n.name===t?e(n):Uk(n))},finally:function(i){return this.then(t=>(i(),t),t=>(i(),Uk(t)))},stack:{get:function(){if(this._stack)return this._stack;try{CN=!0;var i=Y7(this,[],20).join("\nFrom previous: ");return null!==this._state&&(this._stack=i),i}finally{CN=!1}}},timeout:function(i,t){return i<1/0?new Nn((e,n)=>{var r=setTimeout(()=>n(new Yr.Timeout(t)),i);this.then(e,n).finally(clearTimeout.bind(null,r))}):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&qm(Nn.prototype,Symbol.toStringTag,"Dexie.Promise"),Qw.env=Q7(),Xw(Nn,{all:function(){var i=Zm.apply(null,arguments).map(jk);return new Nn(function(t,e){0===i.length&&t([]);var n=i.length;i.forEach((r,s)=>Nn.resolve(r).then(a=>{i[s]=a,--n||t(i)},e))})},resolve:i=>{if(i instanceof Nn)return i;if(i&&"function"==typeof i.then)return new Nn((e,n)=>{i.then(e,n)});var t=new Nn(Z1,!0,i);return K7(t,TN),t},reject:Uk,race:function(){var i=Zm.apply(null,arguments).map(jk);return new Nn((t,e)=>{i.map(n=>Nn.resolve(n).then(t,e))})},PSD:{get:()=>Ar,set:i=>Ar=i},totalEchoes:{get:()=>Wk},newPSD:_y,usePSD:$w,scheduler:{get:()=>Y1,set:i=>{Y1=i}},rejectionMapper:{get:()=>EN,set:i=>{EN=i}},follow:(i,t)=>new Nn((e,n)=>_y((r,s)=>{var a=Ar;a.unhandleds=[],a.onunhandled=s,a.finalize=Gb(function(){var l;l=()=>{0===this.unhandleds.length?r():s(this.unhandleds[0])},Vk.push(function u(){l(),Vk.splice(Vk.indexOf(u),1)}),++jb,Y1(()=>{0==--jb&&kN()},[])},a.finalize),i()},t,e,n))}),Bk&&(Bk.allSettled&&qm(Nn,"allSettled",function(){const i=Zm.apply(null,arguments).map(jk);return new Nn(t=>{0===i.length&&t([]);let e=i.length;const n=new Array(e);i.forEach((r,s)=>Nn.resolve(r).then(a=>n[s]={status:"fulfilled",value:a},a=>n[s]={status:"rejected",reason:a}).then(()=>--e||t(n)))})}),Bk.any&&"undefined"!=typeof AggregateError&&qm(Nn,"any",function(){const i=Zm.apply(null,arguments).map(jk);return new Nn((t,e)=>{0===i.length&&e(new AggregateError([]));let n=i.length;const r=new Array(n);i.forEach((s,a)=>Nn.resolve(s).then(l=>t(l),l=>{r[a]=l,--n||e(new AggregateError(r))}))})}));const su={awaits:0,echoes:0,id:0};var Lue=0,Gk=[],PN=0,Wk=0,Oue=0;function _y(i,t,e,n){var r=Ar,s=Object.create(r);s.parent=r,s.ref=0,s.global=!1,s.id=++Oue;var a=Qw.env;s.env=SN?{Promise:Nn,PromiseProp:{value:Nn,configurable:!0,writable:!0},all:Nn.all,race:Nn.race,allSettled:Nn.allSettled,any:Nn.any,resolve:Nn.resolve,reject:Nn.reject,nthen:$7(a.nthen,s),gthen:$7(a.gthen,s)}:{},t&&ku(s,t),++r.ref,s.finalize=function(){--this.parent.ref||this.parent.finalize()};var l=$w(s,i,e,n);return 0===s.ref&&s.finalize(),l}function Jw(){return su.id||(su.id=++Lue),++su.awaits,su.echoes+=100,su.id}function Ym(){return!!su.awaits&&(0==--su.awaits&&(su.id=0),su.echoes=100*su.awaits,!0)}function jk(i){return su.echoes&&i&&i.constructor===Bk?(Jw(),i.then(t=>(Ym(),t),t=>(Ym(),fc(t)))):i}function Fue(i){++Wk,su.echoes&&0!=--su.echoes||(su.echoes=su.id=0),Gk.push(Ar),yy(i,!0)}function Bue(){var i=Gk[Gk.length-1];Gk.pop(),yy(i,!1)}function yy(i,t){var e=Ar;if((t?!su.echoes||PN++&&i===Ar:!PN||--PN&&i===Ar)||J7(t?Fue.bind(null,i):Bue),i!==Ar&&(Ar=i,e===Qw&&(Qw.env=Q7()),SN)){var n=Qw.env.Promise,r=i.env;Fk.then=r.nthen,n.prototype.then=r.gthen,(e.global||i.global)&&(Object.defineProperty(ya,"Promise",r.PromiseProp),n.all=r.all,n.race=r.race,n.resolve=r.resolve,n.reject=r.reject,r.allSettled&&(n.allSettled=r.allSettled),r.any&&(n.any=r.any))}}function Q7(){var i=ya.Promise;return SN?{Promise:i,PromiseProp:Object.getOwnPropertyDescriptor(ya,"Promise"),all:i.all,race:i.race,allSettled:i.allSettled,any:i.any,resolve:i.resolve,reject:i.reject,nthen:Fk.then,gthen:i.prototype.then}:{}}function $w(i,t,e,n,r){var s=Ar;try{return yy(i,!0),t(e,n,r)}finally{yy(s,!1)}}function J7(i){j7.call(xN,i)}function qk(i,t,e,n){return"function"!=typeof i?i:function(){var r=Ar;e&&Jw(),yy(t,!0);try{return i.apply(this,arguments)}finally{yy(r,!1),n&&J7(Ym)}}}function $7(i,t){return function(e,n){return i.call(this,qk(e,t),qk(n,t))}}function ej(i,t){var e;try{e=t.onuncatched(i)}catch(s){}if(!1!==e)try{var n,r={promise:t,reason:i};if(ya.document&&document.createEvent?((n=document.createEvent("Event")).initEvent("unhandledrejection",!0,!0),ku(n,r)):ya.CustomEvent&&ku(n=new CustomEvent("unhandledrejection",{detail:r}),r),n&&ya.dispatchEvent&&(dispatchEvent(n),!ya.PromiseRejectionEvent&&ya.onunhandledrejection))try{ya.onunhandledrejection(n)}catch(s){}Ap&&n&&!n.defaultPrevented&&console.warn(`Unhandled rejection: ${i.stack||i}`)}catch(s){}}-1===(""+j7).indexOf("[native code]")&&(Jw=Ym=Jo);var fc=Nn.reject;function IN(i,t,e,n){if(i.idbdb&&(i._state.openComplete||Ar.letThrough||i._vip)){var r=i._createTransaction(t,e,i._dbSchema);try{r.create(),i._state.PR1398_maxLoop=3}catch(s){return s.name===vN.InvalidState&&i.isOpen()&&--i._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),i._close(),i.open().then(()=>IN(i,t,e,n))):fc(s)}return r._promise(t,(s,a)=>_y(()=>(Ar.trans=r,n(s,a,r)))).then(s=>r._completion.then(()=>s))}if(i._state.openComplete)return fc(new Yr.DatabaseClosed(i._state.dbOpenError));if(!i._state.isBeingOpened){if(!i._options.autoOpen)return fc(new Yr.DatabaseClosed);i.open().catch(Jo)}return i._state.dbReadyPromise.then(()=>IN(i,t,e,n))}const qb=String.fromCharCode(65535),Km="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",$1=[],Xk="undefined"!=typeof navigator&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),Nue=Xk,Hue=Xk,tj=i=>!/(dexie\.js|dexie\.min\.js)/.test(i);function Xb(i,t){return i?t?function(){return i.apply(this,arguments)&&t.apply(this,arguments)}:i:t}const ij={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Zk(i){return"string"!=typeof i||/\./.test(i)?t=>t:t=>(void 0===t[i]&&i in t&&delete(t=j1(t))[i],t)}class Vue{_trans(t,e,n){const r=this._tx||Ar.trans,s=this.name;function a(u,h,m){if(!m.schema[s])throw new Yr.NotFound("Table "+s+" not part of transaction");return e(m.idbtrans,m)}const l=Q1();try{return r&&r.db===this.db?r===Ar.trans?r._promise(t,a,n):_y(()=>r._promise(t,a,n),{trans:r,transless:Ar.transless||Ar}):IN(this.db,t,[this.name],a)}finally{l&&J1()}}get(t,e){return t&&t.constructor===Object?this.where(t).first(e):this._trans("readonly",n=>this.core.get({trans:n,key:t}).then(r=>this.hook.reading.fire(r))).then(e)}where(t){if("string"==typeof t)return new this.db.WhereClause(this,t);if(ru(t))return new this.db.WhereClause(this,`[${t.join("+")}]`);const e=Yl(t);if(1===e.length)return this.where(e[0]).equals(t[e[0]]);const n=this.schema.indexes.concat(this.schema.primKey).filter(h=>h.compound&&e.every(m=>h.keyPath.indexOf(m)>=0)&&h.keyPath.every(m=>e.indexOf(m)>=0))[0];if(n&&this.db._maxKey!==qb)return this.where(n.name).equals(n.keyPath.map(h=>t[h]));!n&&Ap&&console.warn(`The query ${JSON.stringify(t)} on ${this.name} would benefit of a compound index [${e.join("+")}]`);const{idxByName:r}=this.schema,s=this.db._deps.indexedDB;function a(h,m){try{return 0===s.cmp(h,m)}catch(_){return!1}}const[l,u]=e.reduce(([h,m],_)=>{const v=r[_],S=t[_];return[h||v,h||!v?Xb(m,v&&v.multi?T=>{const I=Xm(T,_);return ru(I)&&I.some(j=>a(S,j))}:T=>a(S,Xm(T,_))):m]},[null,null]);return l?this.where(l.name).equals(t[l.keyPath]).filter(u):n?this.filter(u):this.where(e).equals("")}filter(t){return this.toCollection().and(t)}count(t){return this.toCollection().count(t)}offset(t){return this.toCollection().offset(t)}limit(t){return this.toCollection().limit(t)}each(t){return this.toCollection().each(t)}toArray(t){return this.toCollection().toArray(t)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(t){return new this.db.Collection(new this.db.WhereClause(this,ru(t)?`[${t.join("+")}]`:t))}reverse(){return this.toCollection().reverse()}mapToClass(t){this.schema.mappedClass=t;const e=n=>{if(!n)return n;const r=Object.create(t.prototype);for(var s in n)if(Lh(n,s))try{r[s]=n[s]}catch(a){}return r};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=e,this.hook("reading",e),t}defineClass(){return this.mapToClass(function(t){ku(this,t)})}add(t,e){const{auto:n,keyPath:r}=this.schema.primKey;let s=t;return r&&n&&(s=Zk(r)(t)),this._trans("readwrite",a=>this.core.mutate({trans:a,type:"add",keys:null!=e?[e]:null,values:[s]})).then(a=>a.numFailures?Nn.reject(a.failures[0]):a.lastResult).then(a=>{if(r)try{Uf(t,r,a)}catch(l){}return a})}update(t,e){if("object"!=typeof t||ru(t))return this.where(":id").equals(t).modify(e);{const n=Xm(t,this.schema.primKey.keyPath);if(void 0===n)return fc(new Yr.InvalidArgument("Given object does not contain its primary key"));try{"function"!=typeof e?Yl(e).forEach(r=>{Uf(t,r,e[r])}):e(t,{value:t,primKey:n})}catch(r){}return this.where(":id").equals(n).modify(e)}}put(t,e){const{auto:n,keyPath:r}=this.schema.primKey;let s=t;return r&&n&&(s=Zk(r)(t)),this._trans("readwrite",a=>this.core.mutate({trans:a,type:"put",values:[s],keys:null!=e?[e]:null})).then(a=>a.numFailures?Nn.reject(a.failures[0]):a.lastResult).then(a=>{if(r)try{Uf(t,r,a)}catch(l){}return a})}delete(t){return this._trans("readwrite",e=>this.core.mutate({trans:e,type:"delete",keys:[t]})).then(e=>e.numFailures?Nn.reject(e.failures[0]):void 0)}clear(){return this._trans("readwrite",t=>this.core.mutate({trans:t,type:"deleteRange",range:ij})).then(t=>t.numFailures?Nn.reject(t.failures[0]):void 0)}bulkGet(t){return this._trans("readonly",e=>this.core.getMany({keys:t,trans:e}).then(n=>n.map(r=>this.hook.reading.fire(r))))}bulkAdd(t,e,n){const r=Array.isArray(e)?e:void 0,s=(n=n||(r?void 0:e))?n.allKeys:void 0;return this._trans("readwrite",a=>{const{auto:l,keyPath:u}=this.schema.primKey;if(u&&r)throw new Yr.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(r&&r.length!==t.length)throw new Yr.InvalidArgument("Arguments objects and keys must have the same length");const h=t.length;let m=u&&l?t.map(Zk(u)):t;return this.core.mutate({trans:a,type:"add",keys:r,values:m,wantResults:s}).then(({numFailures:_,results:v,lastResult:S,failures:T})=>{if(0===_)return s?v:S;throw new q1(`${this.name}.bulkAdd(): ${_} of ${h} operations failed`,T)})})}bulkPut(t,e,n){const r=Array.isArray(e)?e:void 0,s=(n=n||(r?void 0:e))?n.allKeys:void 0;return this._trans("readwrite",a=>{const{auto:l,keyPath:u}=this.schema.primKey;if(u&&r)throw new Yr.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(r&&r.length!==t.length)throw new Yr.InvalidArgument("Arguments objects and keys must have the same length");const h=t.length;let m=u&&l?t.map(Zk(u)):t;return this.core.mutate({trans:a,type:"put",keys:r,values:m,wantResults:s}).then(({numFailures:_,results:v,lastResult:S,failures:T})=>{if(0===_)return s?v:S;throw new q1(`${this.name}.bulkPut(): ${_} of ${h} operations failed`,T)})})}bulkDelete(t){const e=t.length;return this._trans("readwrite",n=>this.core.mutate({trans:n,type:"delete",keys:t})).then(({numFailures:n,lastResult:r,failures:s})=>{if(0===n)return r;throw new q1(`${this.name}.bulkDelete(): ${n} of ${e} operations failed`,s)})}}function eT(i){var t={},e=function(l,u){if(u){for(var h=arguments.length,m=new Array(h-1);--h;)m[h-1]=arguments[h];return t[l].subscribe.apply(null,m),i}if("string"==typeof l)return t[l]};e.addEventType=s;for(var n=1,r=arguments.length;n<r;++n)s(arguments[n]);return e;function s(l,u,h){if("object"==typeof l)return a(l);u||(u=kue),h||(h=Jo);var m={subscribers:[],fire:h,subscribe:function(_){-1===m.subscribers.indexOf(_)&&(m.subscribers.push(_),m.fire=u(m.fire,_))},unsubscribe:function(_){m.subscribers=m.subscribers.filter(function(v){return v!==_}),m.fire=m.subscribers.reduce(u,h)}};return t[l]=e[l]=m,m}function a(l){Yl(l).forEach(function(u){var h=l[u];if(ru(h))s(u,l[u][0],l[u][1]);else{if("asap"!==h)throw new Yr.InvalidArgument("Invalid event config");var m=s(u,X1,function(){for(var _=arguments.length,v=new Array(_);_--;)v[_]=arguments[_];m.subscribers.forEach(function(S){O7(function(){S.apply(null,v)})})})}})}}function tT(i,t){return Zw(t).from({prototype:i}),t}function eS(i,t){return!(i.filter||i.algorithm||i.or)&&(t?i.justLimit:!i.replayFilter)}function LN(i,t){i.filter=Xb(i.filter,t)}function ON(i,t,e){var n=i.replayFilter;i.replayFilter=n?()=>Xb(n(),t()):t,i.justLimit=e&&!n}function Yk(i,t){if(i.isPrimKey)return t.primaryKey;const e=t.getIndexByKeyPath(i.index);if(!e)throw new Yr.Schema("KeyPath "+i.index+" on object store "+t.name+" is not indexed");return e}function nj(i,t,e){const n=Yk(i,t.schema);return t.openCursor({trans:e,values:!i.keysOnly,reverse:"prev"===i.dir,unique:!!i.unique,query:{index:n,range:i.range}})}function Kk(i,t,e,n){const r=i.replayFilter?Xb(i.filter,i.replayFilter()):i.filter;if(i.or){const s={},a=(l,u,h)=>{if(!r||r(u,h,v=>u.stop(v),v=>u.fail(v))){var m=u.primaryKey,_=""+m;"[object ArrayBuffer]"===_&&(_=""+new Uint8Array(m)),Lh(s,_)||(s[_]=!0,t(l,u,h))}};return Promise.all([i.or._iterate(a,e),rj(nj(i,n,e),i.algorithm,a,!i.keysOnly&&i.valueMapper)])}return rj(nj(i,n,e),Xb(i.algorithm,r),t,!i.keysOnly&&i.valueMapper)}function rj(i,t,e,n){var r=La(n?(s,a,l)=>e(n(s),a,l):e);return i.then(s=>{if(s)return s.start(()=>{var a=()=>s.continue();t&&!t(s,l=>a=l,l=>{s.stop(l),a=Jo},l=>{s.fail(l),a=Jo})||r(s.value,s,l=>a=l),a()})})}function Pu(i,t){try{const e=sj(i),n=sj(t);if(e!==n)return"Array"===e?1:"Array"===n?-1:"binary"===e?1:"binary"===n?-1:"string"===e?1:"string"===n?-1:"Date"===e?1:"Date"!==n?NaN:-1;switch(e){case"number":case"Date":case"string":return i>t?1:i<t?-1:0;case"binary":return function(r,s){const a=r.length,l=s.length,u=a<l?a:l;for(let h=0;h<u;++h)if(r[h]!==s[h])return r[h]<s[h]?-1:1;return a===l?0:a<l?-1:1}(oj(i),oj(t));case"Array":return function(r,s){const a=r.length,l=s.length,u=a<l?a:l;for(let h=0;h<u;++h){const m=Pu(r[h],s[h]);if(0!==m)return m}return a===l?0:a<l?-1:1}(i,t)}}catch(e){}return NaN}function sj(i){const t=typeof i;if("object"!==t)return t;if(ArrayBuffer.isView(i))return"binary";const e=pN(i);return"ArrayBuffer"===e?"binary":e}function oj(i){return i instanceof Uint8Array?i:ArrayBuffer.isView(i)?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):new Uint8Array(i)}class zue{_read(t,e){var n=this._ctx;return n.error?n.table._trans(null,fc.bind(null,n.error)):n.table._trans("readonly",t).then(e)}_write(t){var e=this._ctx;return e.error?e.table._trans(null,fc.bind(null,e.error)):e.table._trans("readwrite",t,"locked")}_addAlgorithm(t){var e=this._ctx;e.algorithm=Xb(e.algorithm,t)}_iterate(t,e){return Kk(this._ctx,t,e,this._ctx.table.core)}clone(t){var e=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return t&&ku(n,t),e._ctx=n,e}raw(){return this._ctx.valueMapper=null,this}each(t){var e=this._ctx;return this._read(n=>Kk(e,t,n,e.table.core))}count(t){return this._read(e=>{const n=this._ctx,r=n.table.core;if(eS(n,!0))return r.count({trans:e,query:{index:Yk(n,r.schema),range:n.range}}).then(a=>Math.min(a,n.limit));var s=0;return Kk(n,()=>(++s,!1),e,r).then(()=>s)}).then(t)}sortBy(t,e){const n=t.split(".").reverse(),r=n[0],s=n.length-1;function a(h,m){return m?a(h[n[m]],m-1):h[r]}var l="next"===this._ctx.dir?1:-1;function u(h,m){var _=a(h,s),v=a(m,s);return _<v?-l:_>v?l:0}return this.toArray(function(h){return h.sort(u)}).then(e)}toArray(t){return this._read(e=>{var n=this._ctx;if("next"===n.dir&&eS(n,!0)&&n.limit>0){const{valueMapper:r}=n,s=Yk(n,n.table.core.schema);return n.table.core.query({trans:e,limit:n.limit,values:!0,query:{index:s,range:n.range}}).then(({result:a})=>r?a.map(r):a)}{const r=[];return Kk(n,s=>r.push(s),e,n.table.core).then(()=>r)}},t)}offset(t){var e=this._ctx;return t<=0||(e.offset+=t,eS(e)?ON(e,()=>{var n=t;return(r,s)=>0===n||(1===n?(--n,!1):(s(()=>{r.advance(n),n=0}),!1))}):ON(e,()=>{var n=t;return()=>--n<0})),this}limit(t){return this._ctx.limit=Math.min(this._ctx.limit,t),ON(this._ctx,()=>{var e=t;return function(n,r,s){return--e<=0&&r(s),e>=0}},!0),this}until(t,e){return LN(this._ctx,function(n,r,s){return!t(n.value)||(r(s),e)}),this}first(t){return this.limit(1).toArray(function(e){return e[0]}).then(t)}last(t){return this.reverse().first(t)}filter(t){var e;return LN(this._ctx,function(r){return t(r.value)}),(e=this._ctx).isMatch=Xb(e.isMatch,t),this}and(t){return this.filter(t)}or(t){return new this.db.WhereClause(this._ctx.table,t,this)}reverse(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(t){var e=this._ctx;return e.keysOnly=!e.isMatch,this.each(function(n,r){t(r.key,r)})}eachUniqueKey(t){return this._ctx.unique="unique",this.eachKey(t)}eachPrimaryKey(t){var e=this._ctx;return e.keysOnly=!e.isMatch,this.each(function(n,r){t(r.primaryKey,r)})}keys(t){var e=this._ctx;e.keysOnly=!e.isMatch;var n=[];return this.each(function(r,s){n.push(s.key)}).then(function(){return n}).then(t)}primaryKeys(t){var e=this._ctx;if("next"===e.dir&&eS(e,!0)&&e.limit>0)return this._read(r=>{var s=Yk(e,e.table.core.schema);return e.table.core.query({trans:r,values:!1,limit:e.limit,query:{index:s,range:e.range}})}).then(({result:r})=>r).then(t);e.keysOnly=!e.isMatch;var n=[];return this.each(function(r,s){n.push(s.primaryKey)}).then(function(){return n}).then(t)}uniqueKeys(t){return this._ctx.unique="unique",this.keys(t)}firstKey(t){return this.limit(1).keys(function(e){return e[0]}).then(t)}lastKey(t){return this.reverse().firstKey(t)}distinct(){var t=this._ctx,e=t.index&&t.table.schema.idxByName[t.index];if(!e||!e.multi)return this;var n={};return LN(this._ctx,function(r){var s=r.primaryKey.toString(),a=Lh(n,s);return n[s]=!0,!a}),this}modify(t){var e=this._ctx;return this._write(n=>{var r;if("function"==typeof t)r=t;else{var s=Yl(t),a=s.length;r=function(I){for(var j=!1,P=0;P<a;++P){var E=s[P],ie=t[E];Xm(I,E)!==ie&&(Uf(I,E,ie),j=!0)}return j}}const l=e.table.core,{outbound:u,extractKey:h}=l.schema.primaryKey,m=this.db._options.modifyChunkSize||200,_=[];let v=0;const S=[],T=(I,j)=>{const{failures:P,numFailures:E}=j;v+=I-E;for(let ie of Yl(P))_.push(P[ie])};return this.clone().primaryKeys().then(I=>{const j=P=>{const E=Math.min(m,I.length-P);return l.getMany({trans:n,keys:I.slice(P,P+E),cache:"immutable"}).then(ie=>{const ee=[],ce=[],ye=u?[]:null,Ce=[];for(let Qe=0;Qe<E;++Qe){const nt=ie[Qe],ge={value:j1(nt),primKey:I[P+Qe]};!1!==r.call(ge,ge.value,ge)&&(null==ge.value?Ce.push(I[P+Qe]):u||0===Pu(h(nt),h(ge.value))?(ce.push(ge.value),u&&ye.push(I[P+Qe])):(Ce.push(I[P+Qe]),ee.push(ge.value)))}const Ge=eS(e)&&e.limit===1/0&&("function"!=typeof t||t===FN)&&{index:e.index,range:e.range};return Promise.resolve(ee.length>0&&l.mutate({trans:n,type:"add",values:ee}).then(Qe=>{for(let nt in Qe.failures)Ce.splice(parseInt(nt),1);T(ee.length,Qe)})).then(()=>(ce.length>0||Ge&&"object"==typeof t)&&l.mutate({trans:n,type:"put",keys:ye,values:ce,criteria:Ge,changeSpec:"function"!=typeof t&&t}).then(Qe=>T(ce.length,Qe))).then(()=>(Ce.length>0||Ge&&t===FN)&&l.mutate({trans:n,type:"delete",keys:Ce,criteria:Ge}).then(Qe=>T(Ce.length,Qe))).then(()=>I.length>P+E&&j(P+m))})};return j(0).then(()=>{if(_.length>0)throw new Lk("Error modifying one or more objects",_,v,S);return I.length})})})}delete(){var t=this._ctx,e=t.range;return eS(t)&&(t.isPrimKey&&!Hue||3===e.type)?this._write(n=>{const{primaryKey:r}=t.table.core.schema,s=e;return t.table.core.count({trans:n,query:{index:r,range:s}}).then(a=>t.table.core.mutate({trans:n,type:"deleteRange",range:s}).then(({failures:l,numFailures:m})=>{if(m)throw new Lk("Could not delete some values",Object.keys(l).map(_=>l[_]),a-m);return a-m}))}):this.modify(FN)}}const FN=(i,t)=>t.value=null;function Uue(i,t){return i<t?-1:i===t?0:1}function Gue(i,t){return i>t?-1:i===t?0:1}function Oh(i,t,e){var n=i instanceof lj?new i.Collection(i):i;return n._ctx.error=e?new e(t):new TypeError(t),n}function tS(i){return new i.Collection(i,()=>aj("")).limit(0)}function Wue(i,t,e,n,r,s){for(var a=Math.min(i.length,n.length),l=-1,u=0;u<a;++u){var h=t[u];if(h!==n[u])return r(i[u],e[u])<0?i.substr(0,u)+e[u]+e.substr(u+1):r(i[u],n[u])<0?i.substr(0,u)+n[u]+e.substr(u+1):l>=0?i.substr(0,l)+t[l]+e.substr(l+1):null;r(i[u],h)<0&&(l=u)}return a<n.length&&"next"===s?i+e.substr(i.length):a<i.length&&"prev"===s?i.substr(0,e.length):l<0?null:i.substr(0,l)+n[l]+e.substr(l+1)}function Qk(i,t,e,n){var r,s,a,l,u,h,m,_=e.length;if(!e.every(I=>"string"==typeof I))return Oh(i,"String expected.");function v(I){r="next"===I?E=>E.toUpperCase():E=>E.toLowerCase(),s="next"===I?E=>E.toLowerCase():E=>E.toUpperCase(),a="next"===I?Uue:Gue;var j=e.map(function(P){return{lower:s(P),upper:r(P)}}).sort(function(P,E){return a(P.lower,E.lower)});l=j.map(function(P){return P.upper}),u=j.map(function(P){return P.lower}),h=I,m="next"===I?"":n}v("next");var S=new i.Collection(i,()=>vy(l[0],u[_-1]+n));S._ondirectionchange=function(I){v(I)};var T=0;return S._addAlgorithm(function(I,j,P){var E=I.key;if("string"!=typeof E)return!1;var ie=s(E);if(t(ie,u,T))return!0;for(var ee=null,ce=T;ce<_;++ce){var ye=Wue(E,ie,l[ce],u[ce],a,h);null===ye&&null===ee?T=ce+1:(null===ee||a(ee,ye)>0)&&(ee=ye)}return j(null!==ee?function(){I.continue(ee+m)}:P),!1}),S}function vy(i,t,e,n){return{type:2,lower:i,upper:t,lowerOpen:e,upperOpen:n}}function aj(i){return{type:1,lower:i,upper:i}}class lj{get Collection(){return this._ctx.table.db.Collection}between(t,e,n,r){n=!1!==n,r=!0===r;try{return this._cmp(t,e)>0||0===this._cmp(t,e)&&(n||r)&&(!n||!r)?tS(this):new this.Collection(this,()=>vy(t,e,!n,!r))}catch(s){return Oh(this,Km)}}equals(t){return null==t?Oh(this,Km):new this.Collection(this,()=>aj(t))}above(t){return null==t?Oh(this,Km):new this.Collection(this,()=>vy(t,void 0,!0))}aboveOrEqual(t){return null==t?Oh(this,Km):new this.Collection(this,()=>vy(t,void 0,!1))}below(t){return null==t?Oh(this,Km):new this.Collection(this,()=>vy(void 0,t,!1,!0))}belowOrEqual(t){return null==t?Oh(this,Km):new this.Collection(this,()=>vy(void 0,t))}startsWith(t){return"string"!=typeof t?Oh(this,"String expected."):this.between(t,t+qb,!0,!0)}startsWithIgnoreCase(t){return""===t?this.startsWith(t):Qk(this,(e,n)=>0===e.indexOf(n[0]),[t],qb)}equalsIgnoreCase(t){return Qk(this,(e,n)=>e===n[0],[t],"")}anyOfIgnoreCase(){var t=Zm.apply(Yw,arguments);return 0===t.length?tS(this):Qk(this,(e,n)=>-1!==n.indexOf(e),t,"")}startsWithAnyOfIgnoreCase(){var t=Zm.apply(Yw,arguments);return 0===t.length?tS(this):Qk(this,(e,n)=>n.some(r=>0===e.indexOf(r)),t,qb)}anyOf(){const t=Zm.apply(Yw,arguments);let e=this._cmp;try{t.sort(e)}catch(s){return Oh(this,Km)}if(0===t.length)return tS(this);const n=new this.Collection(this,()=>vy(t[0],t[t.length-1]));n._ondirectionchange=s=>{e="next"===s?this._ascending:this._descending,t.sort(e)};let r=0;return n._addAlgorithm((s,a,l)=>{const u=s.key;for(;e(u,t[r])>0;)if(++r,r===t.length)return a(l),!1;return 0===e(u,t[r])||(a(()=>{s.continue(t[r])}),!1)}),n}notEqual(t){return this.inAnyRange([[-1/0,t],[t,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){const t=Zm.apply(Yw,arguments);if(0===t.length)return new this.Collection(this);try{t.sort(this._ascending)}catch(n){return Oh(this,Km)}const e=t.reduce((n,r)=>n?n.concat([[n[n.length-1][1],r]]):[[-1/0,r]],null);return e.push([t[t.length-1],this.db._maxKey]),this.inAnyRange(e,{includeLowers:!1,includeUppers:!1})}inAnyRange(t,e){const n=this._cmp,r=this._ascending,s=this._descending,a=this._min,l=this._max;if(0===t.length)return tS(this);if(!t.every(E=>void 0!==E[0]&&void 0!==E[1]&&r(E[0],E[1])<=0))return Oh(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Yr.InvalidArgument);const u=!e||!1!==e.includeLowers,h=e&&!0===e.includeUppers;let m,_=r;function v(E,ie){return _(E[0],ie[0])}try{m=t.reduce(function(E,ie){let ee=0,ce=E.length;for(;ee<ce;++ee){const ye=E[ee];if(n(ie[0],ye[1])<0&&n(ie[1],ye[0])>0){ye[0]=a(ye[0],ie[0]),ye[1]=l(ye[1],ie[1]);break}}return ee===ce&&E.push(ie),E},[]),m.sort(v)}catch(E){return Oh(this,Km)}let S=0;const T=h?E=>r(E,m[S][1])>0:E=>r(E,m[S][1])>=0,I=u?E=>s(E,m[S][0])>0:E=>s(E,m[S][0])>=0;let j=T;const P=new this.Collection(this,()=>vy(m[0][0],m[m.length-1][1],!u,!h));return P._ondirectionchange=E=>{"next"===E?(j=T,_=r):(j=I,_=s),m.sort(v)},P._addAlgorithm((E,ie,ee)=>{for(var ce=E.key;j(ce);)if(++S,S===m.length)return ie(ee),!1;return!((T(ye=ce)||I(ye))&&(0===this._cmp(ce,m[S][1])||0===this._cmp(ce,m[S][0])||ie(()=>{E.continue(_===r?m[S][0]:m[S][1])}),1));var ye}),P}startsWithAnyOf(){const t=Zm.apply(Yw,arguments);return t.every(e=>"string"==typeof e)?0===t.length?tS(this):this.inAnyRange(t.map(e=>[e,e+qb])):Oh(this,"startsWithAnyOf() only works with strings")}}function Dp(i){return La(function(t){return iT(t),i(t.target.error),!1})}function iT(i){i.stopPropagation&&i.stopPropagation(),i.preventDefault&&i.preventDefault()}const by=eT(null,"storagemutated");class jue{_lock(){return W1(!Ar.global),++this._reculock,1!==this._reculock||Ar.global||(Ar.lockOwnerFor=this),this}_unlock(){if(W1(!Ar.global),0==--this._reculock)for(Ar.global||(Ar.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var t=this._blockedFuncs.shift();try{$w(t[1],t[0])}catch(e){}}return this}_locked(){return this._reculock&&Ar.lockOwnerFor!==this}create(t){if(!this.mode)return this;const e=this.db.idbdb,n=this.db._state.dbOpenError;if(W1(!this.idbtrans),!t&&!e)switch(n&&n.name){case"DatabaseClosedError":throw new Yr.DatabaseClosed(n);case"MissingAPIError":throw new Yr.MissingAPI(n.message,n);default:throw new Yr.OpenFailed(n)}if(!this.active)throw new Yr.TransactionInactive;return W1(null===this._completion._state),(t=this.idbtrans=t||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):e.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=La(r=>{iT(r),this._reject(t.error)}),t.onabort=La(r=>{iT(r),this.active&&this._reject(new Yr.Abort(t.error)),this.active=!1,this.on("abort").fire(r)}),t.oncomplete=La(()=>{this.active=!1,this._resolve(),"mutatedParts"in t&&by.storagemutated.fire(t.mutatedParts)}),this}_promise(t,e,n){if("readwrite"===t&&"readwrite"!==this.mode)return fc(new Yr.ReadOnly("Transaction is readonly"));if(!this.active)return fc(new Yr.TransactionInactive);if(this._locked())return new Nn((s,a)=>{this._blockedFuncs.push([()=>{this._promise(t,e,n).then(s,a)},Ar])});if(n)return _y(()=>{var s=new Nn((a,l)=>{this._lock();const u=e(a,l,this);u&&u.then&&u.then(a,l)});return s.finally(()=>this._unlock()),s._lib=!0,s});var r=new Nn((s,a)=>{var l=e(s,a,this);l&&l.then&&l.then(s,a)});return r._lib=!0,r}_root(){return this.parent?this.parent._root():this}waitFor(t){var e=this._root();const n=Nn.resolve(t);if(e._waitingFor)e._waitingFor=e._waitingFor.then(()=>n);else{e._waitingFor=n,e._waitingQueue=[];var r=e.idbtrans.objectStore(e.storeNames[0]);!function a(){for(++e._spinCount;e._waitingQueue.length;)e._waitingQueue.shift()();e._waitingFor&&(r.get(-1/0).onsuccess=a)}()}var s=e._waitingFor;return new Nn((a,l)=>{n.then(u=>e._waitingQueue.push(La(a.bind(null,u))),u=>e._waitingQueue.push(La(l.bind(null,u)))).finally(()=>{e._waitingFor===s&&(e._waitingFor=null)})})}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Yr.Abort))}table(t){const e=this._memoizedTables||(this._memoizedTables={});if(Lh(e,t))return e[t];const n=this.schema[t];if(!n)throw new Yr.NotFound("Table "+t+" not part of transaction");const r=new this.db.Table(t,n,this);return r.core=this.db.core.table(t),e[t]=r,r}}function BN(i,t,e,n,r,s,a){return{name:i,keyPath:t,unique:e,multi:n,auto:r,compound:s,src:(e&&!a?"&":"")+(n?"*":"")+(r?"++":"")+cj(t)}}function cj(i){return"string"==typeof i?i:i?"["+[].join.call(i,"+")+"]":""}function uj(i,t,e){return{name:i,primKey:t,indexes:e,mappedClass:null,idxByName:F7(e,n=>[n.name,n])}}let nT=i=>{try{return i.only([[]]),nT=()=>[[]],[[]]}catch(t){return nT=()=>qb,qb}};function NN(i){return null==i?()=>{}:"string"==typeof i?1===(t=i).split(".").length?e=>e[t]:e=>Xm(e,t):t=>Xm(t,i);var t}function hj(i){return[].slice.call(i)}let que=0;function rT(i){return null==i?":id":"string"==typeof i?i:`[${i.join("+")}]`}function Xue(i,t,e){function n(u){if(3===u.type)return null;if(4===u.type)throw new Error("Cannot convert never type to IDBKeyRange");const{lower:h,upper:m,lowerOpen:_,upperOpen:v}=u;return void 0===h?void 0===m?null:t.upperBound(m,!!v):void 0===m?t.lowerBound(h,!!_):t.bound(h,m,!!_,!!v)}const{schema:r,hasGetAll:s}=function(u,h){const m=hj(u.objectStoreNames);return{schema:{name:u.name,tables:m.map(_=>h.objectStore(_)).map(_=>{const{keyPath:v,autoIncrement:S}=_,T=ru(v),j={},P={name:_.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:null==v,compound:T,keyPath:v,autoIncrement:S,unique:!0,extractKey:NN(v)},indexes:hj(_.indexNames).map(E=>_.index(E)).map(E=>{const{name:ie,unique:ee,multiEntry:ce,keyPath:ye}=E,Ce={name:ie,compound:ru(ye),keyPath:ye,unique:ee,multiEntry:ce,extractKey:NN(ye)};return j[rT(ye)]=Ce,Ce}),getIndexByKeyPath:E=>j[rT(E)]};return j[":id"]=P.primaryKey,null!=v&&(j[rT(v)]=P.primaryKey),P})},hasGetAll:m.length>0&&"getAll"in h.objectStore(m[0])&&!("undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(i,e),a=r.tables.map(u=>function(h){const m=h.name;return{name:m,schema:h,mutate:function({trans:_,type:v,keys:S,values:T,range:I}){return new Promise((j,P)=>{j=La(j);const E=_.objectStore(m),ie=null==E.keyPath,ee="put"===v||"add"===v;if(!ee&&"delete"!==v&&"deleteRange"!==v)throw new Error("Invalid operation type: "+v);const{length:ce}=S||T||{length:1};if(S&&T&&S.length!==T.length)throw new Error("Given keys array must have same length as given values array.");if(0===ce)return j({numFailures:0,failures:{},results:[],lastResult:void 0});let ye;const Ce=[],Ge=[];let Qe=0;const nt=Je=>{++Qe,iT(Je)};if("deleteRange"===v){if(4===I.type)return j({numFailures:Qe,failures:Ge,results:[],lastResult:void 0});Ce.push(ye=3===I.type?E.clear():E.delete(n(I)))}else{const[Je,mt]=ee?ie?[T,S]:[T,null]:[S,null];if(ee)for(let pt=0;pt<ce;++pt)Ce.push(ye=mt&&void 0!==mt[pt]?E[v](Je[pt],mt[pt]):E[v](Je[pt])),ye.onerror=nt;else for(let pt=0;pt<ce;++pt)Ce.push(ye=E[v](Je[pt])),ye.onerror=nt}const ge=Je=>{const mt=Je.target.result;Ce.forEach((pt,Pt)=>null!=pt.error&&(Ge[Pt]=pt.error)),j({numFailures:Qe,failures:Ge,results:"delete"===v?S:Ce.map(pt=>pt.result),lastResult:mt})};ye.onerror=Je=>{nt(Je),ge(Je)},ye.onsuccess=ge})},getMany:({trans:_,keys:v})=>new Promise((S,T)=>{S=La(S);const I=_.objectStore(m),j=v.length,P=new Array(j);let E,ie=0,ee=0;const ce=Ce=>{const Ge=Ce.target;P[Ge._pos]=Ge.result,++ee===ie&&S(P)},ye=Dp(T);for(let Ce=0;Ce<j;++Ce)null!=v[Ce]&&(E=I.get(v[Ce]),E._pos=Ce,E.onsuccess=ce,E.onerror=ye,++ie);0===ie&&S(P)}),get:({trans:_,key:v})=>new Promise((S,T)=>{S=La(S);const I=_.objectStore(m).get(v);I.onsuccess=j=>S(j.target.result),I.onerror=Dp(T)}),query:(_=s,v=>new Promise((S,T)=>{S=La(S);const{trans:I,values:j,limit:P,query:E}=v,ie=P===1/0?void 0:P,{index:ee,range:ce}=E,ye=I.objectStore(m),Ce=ee.isPrimaryKey?ye:ye.index(ee.name),Ge=n(ce);if(0===P)return S({result:[]});if(_){const Qe=j?Ce.getAll(Ge,ie):Ce.getAllKeys(Ge,ie);Qe.onsuccess=nt=>S({result:nt.target.result}),Qe.onerror=Dp(T)}else{let Qe=0;const nt=j||!("openKeyCursor"in Ce)?Ce.openCursor(Ge):Ce.openKeyCursor(Ge),ge=[];nt.onsuccess=Je=>{const mt=nt.result;return mt?(ge.push(j?mt.value:mt.primaryKey),++Qe===P?S({result:ge}):void mt.continue()):S({result:ge})},nt.onerror=Dp(T)}})),openCursor:function({trans:_,values:v,query:S,reverse:T,unique:I}){return new Promise((j,P)=>{j=La(j);const{index:E,range:ie}=S,ee=_.objectStore(m),ce=E.isPrimaryKey?ee:ee.index(E.name),ye=T?I?"prevunique":"prev":I?"nextunique":"next",Ce=v||!("openKeyCursor"in ce)?ce.openCursor(n(ie),ye):ce.openKeyCursor(n(ie),ye);Ce.onerror=Dp(P),Ce.onsuccess=La(Ge=>{const Qe=Ce.result;if(!Qe)return void j(null);Qe.___id=++que,Qe.done=!1;const nt=Qe.continue.bind(Qe);let ge=Qe.continuePrimaryKey;ge&&(ge=ge.bind(Qe));const Je=Qe.advance.bind(Qe),mt=()=>{throw new Error("Cursor not stopped")};Qe.trans=_,Qe.stop=Qe.continue=Qe.continuePrimaryKey=Qe.advance=()=>{throw new Error("Cursor not started")},Qe.fail=La(P),Qe.next=function(){let pt=1;return this.start(()=>pt--?this.continue():this.stop()).then(()=>this)},Qe.start=pt=>{const Pt=new Promise((vt,kt)=>{vt=La(vt),Ce.onerror=Dp(kt),Qe.fail=kt,Qe.stop=pi=>{Qe.stop=Qe.continue=Qe.continuePrimaryKey=Qe.advance=mt,vt(pi)}}),et=()=>{if(Ce.result)try{pt()}catch(vt){Qe.fail(vt)}else Qe.done=!0,Qe.start=()=>{throw new Error("Cursor behind last entry")},Qe.stop()};return Ce.onsuccess=La(vt=>{Ce.onsuccess=et,et()}),Qe.continue=nt,Qe.continuePrimaryKey=ge,Qe.advance=Je,et(),Pt},j(Qe)},P)})},count({query:_,trans:v}){const{index:S,range:T}=_;return new Promise((I,j)=>{const P=v.objectStore(m),E=S.isPrimaryKey?P:P.index(S.name),ie=n(T),ee=ie?E.count(ie):E.count();ee.onsuccess=La(ce=>I(ce.target.result)),ee.onerror=Dp(j)})}};var _}(u)),l={};return a.forEach(u=>l[u.name]=u),{stack:"dbcore",transaction:i.transaction.bind(i),table(u){if(!l[u])throw new Error(`Table '${u}' not found`);return l[u]},MIN_KEY:-1/0,MAX_KEY:nT(t),schema:r}}function HN({_novip:i},t){const n=function(r,s,{IDBKeyRange:a},u){return{dbcore:(m=Xue(s,a,u),_=r.dbcore,_.reduce((v,{create:S})=>({...v,...S(v)}),m))};var m,_}(i._middlewares,t.db,i._deps,t);i.core=n.dbcore,i.tables.forEach(r=>{const s=r.name;i.core.schema.tables.some(a=>a.name===s)&&(r.core=i.core.table(s),i[s]instanceof i.Table&&(i[s].core=r.core))})}function Jk({_novip:i},t,e,n){e.forEach(r=>{const s=n[r];t.forEach(a=>{const l=dN(a,r);(!l||"value"in l&&void 0===l.value)&&(a===i.Transaction.prototype||a instanceof i.Transaction?qm(a,r,{get(){return this.table(r)},set(u){I7(this,r,{value:u,writable:!0,configurable:!0,enumerable:!0})}}):a[r]=new i.Table(r,s))})})}function VN({_novip:i},t){t.forEach(e=>{for(let n in e)e[n]instanceof i.Table&&delete e[n]})}function Zue(i,t){return i._cfg.version-t._cfg.version}function dj(i,t){const e={del:[],add:[],change:[]};let n;for(n in i)t[n]||e.del.push(n);for(n in t){const r=i[n],s=t[n];if(r){const a={name:n,def:s,recreate:!1,del:[],add:[],change:[]};if(""+(r.primKey.keyPath||"")!=""+(s.primKey.keyPath||"")||r.primKey.auto!==s.primKey.auto&&!Xk)a.recreate=!0,e.change.push(a);else{const l=r.idxByName,u=s.idxByName;let h;for(h in l)u[h]||a.del.push(h);for(h in u){const m=l[h],_=u[h];m?m.src!==_.src&&a.change.push(_):a.add.push(_)}(a.del.length>0||a.add.length>0||a.change.length>0)&&e.change.push(a)}}else e.add.push([n,s])}return e}function zN(i,t,e,n){const r=i.db.createObjectStore(t,e.keyPath?{keyPath:e.keyPath,autoIncrement:e.auto}:{autoIncrement:e.auto});return n.forEach(s=>UN(r,s)),r}function UN(i,t){i.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function GN(i,t,e){const n={};return Ik(t.objectStoreNames,0).forEach(r=>{const s=e.objectStore(r);let a=s.keyPath;const l=BN(cj(a),a||"",!1,!1,!!s.autoIncrement,a&&"string"!=typeof a,!0),u=[];for(let m=0;m<s.indexNames.length;++m){const _=s.index(s.indexNames[m]);a=_.keyPath;var h=BN(_.name,a,!!_.unique,!!_.multiEntry,!1,a&&"string"!=typeof a,!1);u.push(h)}n[r]=uj(r,l,u)}),n}function WN({_novip:i},t,e){const n=e.db.objectStoreNames;for(let r=0;r<n.length;++r){const s=n[r],a=e.objectStore(s);i._hasGetAll="getAll"in a;for(let l=0;l<a.indexNames.length;++l){const u=a.indexNames[l],h=a.index(u).keyPath,m="string"==typeof h?h:"["+Ik(h).join("+")+"]";if(t[s]){const _=t[s].idxByName[m];_&&(_.name=u,delete t[s].idxByName[m],t[s].idxByName[u]=_)}}}"undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&ya.WorkerGlobalScope&&ya instanceof ya.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(i._hasGetAll=!1)}class Kue{_parseStoresSpec(t,e){Yl(t).forEach(n=>{if(null!==t[n]){var r=t[n].split(",").map((a,l)=>{const u=(a=a.trim()).replace(/([&*]|\+\+)/g,""),h=/^\[/.test(u)?u.match(/^\[(.*)\]$/)[1].split("+"):u;return BN(u,h||null,/\&/.test(a),/\*/.test(a),/\+\+/.test(a),ru(h),0===l)}),s=r.shift();if(s.multi)throw new Yr.Schema("Primary key cannot be multi-valued");r.forEach(a=>{if(a.auto)throw new Yr.Schema("Only primary key can be marked as autoIncrement (++)");if(!a.keyPath)throw new Yr.Schema("Index must have a name and cannot be an empty string")}),e[n]=uj(n,s,r)}})}stores(t){const e=this.db;this._cfg.storesSource=this._cfg.storesSource?ku(this._cfg.storesSource,t):t;const r={};let s={};return e._versions.forEach(a=>{ku(r,a._cfg.storesSource),s=a._cfg.dbschema={},a._parseStoresSpec(r,s)}),e._dbSchema=s,VN(e,[e._allTables,e,e.Transaction.prototype]),Jk(e,[e._allTables,e,e.Transaction.prototype,this._cfg.tables],Yl(s),s),e._storeNames=Yl(s),this}upgrade(t){return this._cfg.contentUpgrade=bN(this._cfg.contentUpgrade||Jo,t),this}}function jN(i,t){let e=i._dbNamesDB;return e||(e=i._dbNamesDB=new Zb("__dbnames",{addons:[],indexedDB:i,IDBKeyRange:t}),e.version(1).stores({dbnames:"name"})),e.table("dbnames")}function qN(i){return i&&"function"==typeof i.databases}function XN(i){return _y(function(){return Ar.letThrough=!0,i()})}function Que(){var i;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(t){var e=function(){return indexedDB.databases().finally(t)};i=setInterval(e,100),e()}).finally(function(){return clearInterval(i)}):Promise.resolve()}function ZN(i){var t=s=>i.next(s),e=r(t),n=r(s=>i.throw(s));function r(s){return a=>{var l=s(a),u=l.value;return l.done?u:u&&"function"==typeof u.then?u.then(e,n):ru(u)?Promise.all(u).then(e,n):e(u)}}return r(t)()}function $ue(i,t,e){var n=arguments.length;if(n<2)throw new Yr.InvalidArgument("Too few arguments");for(var r=new Array(n-1);--n;)r[n-1]=arguments[n];e=r.pop();var s=N7(r);return[i,s,e]}function fj(i,t,e,n,r){return Nn.resolve().then(()=>{const s=Ar.transless||Ar,a=i._createTransaction(t,e,i._dbSchema,n),l={trans:a,transless:s};if(n)a.idbtrans=n.idbtrans;else try{a.create(),i._state.PR1398_maxLoop=3}catch(_){return _.name===vN.InvalidState&&i.isOpen()&&--i._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),i._close(),i.open().then(()=>fj(i,t,e,null,r))):fc(_)}const u=gN(r);let h;u&&Jw();const m=Nn.follow(()=>{if(h=r.call(a,a),h)if(u){var _=Ym.bind(null,null);h.then(_,_)}else"function"==typeof h.next&&"function"==typeof h.throw&&(h=ZN(h))},l);return(h&&"function"==typeof h.then?Nn.resolve(h).then(_=>a.active?_:fc(new Yr.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))):m.then(()=>h)).then(_=>(n&&a._resolve(),a._completion.then(()=>_))).catch(_=>(a._reject(_),fc(_)))})}function $k(i,t,e){const n=ru(i)?i.slice():[i];for(let r=0;r<e;++r)n.push(t);return n}const ehe={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(i){return{...i,table(t){const e=i.table(t),{schema:n}=e,r={},s=[];function a(m,_,v){const S=rT(m),T=r[S]=r[S]||[],I=null==m?0:"string"==typeof m?1:m.length,j=_>0,P={...v,isVirtual:j,keyTail:_,keyLength:I,extractKey:NN(m),unique:!j&&v.unique};return T.push(P),P.isPrimaryKey||s.push(P),I>1&&a(2===I?m[0]:m.slice(0,I-1),_+1,v),T.sort((E,ie)=>E.keyTail-ie.keyTail),P}const l=a(n.primaryKey.keyPath,0,n.primaryKey);r[":id"]=[l];for(const m of n.indexes)a(m.keyPath,0,m);function u(m){const _=m.query.index;return _.isVirtual?{...m,query:{index:_,range:(v=m.query.range,S=_.keyTail,{type:1===v.type?2:v.type,lower:$k(v.lower,v.lowerOpen?i.MAX_KEY:i.MIN_KEY,S),lowerOpen:!0,upper:$k(v.upper,v.upperOpen?i.MIN_KEY:i.MAX_KEY,S),upperOpen:!0})}}:m;var v,S}return{...e,schema:{...n,primaryKey:l,indexes:s,getIndexByKeyPath:function(m){const _=r[rT(m)];return _&&_[0]}},count:m=>e.count(u(m)),query:m=>e.query(u(m)),openCursor(m){const{keyTail:_,isVirtual:v,keyLength:S}=m.query.index;return v?e.openCursor(u(m)).then(T=>{return T&&(I=T,Object.create(I,{continue:{value:function(P){null!=P?I.continue($k(P,m.reverse?i.MAX_KEY:i.MIN_KEY,_)):m.unique?I.continue(I.key.slice(0,S).concat(m.reverse?i.MIN_KEY:i.MAX_KEY,_)):I.continue()}},continuePrimaryKey:{value(P,E){I.continuePrimaryKey($k(P,i.MAX_KEY,_),E)}},primaryKey:{get:()=>I.primaryKey},key:{get(){const P=I.key;return 1===S?P[0]:P.slice(0,S)}},value:{get:()=>I.value}}));var I}):e.openCursor(m)}}}}}};function YN(i,t,e,n){return e=e||{},n=n||"",Yl(i).forEach(r=>{if(Lh(t,r)){var s=i[r],a=t[r];if("object"==typeof s&&"object"==typeof a&&s&&a){const l=pN(s);l!==pN(a)?e[n+r]=t[r]:"Object"===l?YN(s,a,e,n+r+"."):s!==a&&(e[n+r]=t[r])}else s!==a&&(e[n+r]=t[r])}else e[n+r]=void 0}),Yl(t).forEach(r=>{Lh(i,r)||(e[n+r]=t[r])}),e}const the={stack:"dbcore",name:"HooksMiddleware",level:2,create:i=>({...i,table(t){const e=i.table(t),{primaryKey:n}=e.schema;return{...e,mutate(s){const a=Ar.trans,{deleting:l,creating:u,updating:h}=a.table(t).hook;switch(s.type){case"add":if(u.fire===Jo)break;return a._promise("readwrite",()=>m(s),!0);case"put":if(u.fire===Jo&&h.fire===Jo)break;return a._promise("readwrite",()=>m(s),!0);case"delete":if(l.fire===Jo)break;return a._promise("readwrite",()=>m(s),!0);case"deleteRange":if(l.fire===Jo)break;return a._promise("readwrite",()=>{return _((v=s).trans,v.range,1e4);var v},!0)}return e.mutate(s);function m(v){const S=Ar.trans,T=v.keys||("delete"===(j=v).type?j.keys:j.keys||j.values.map(n.extractKey));var j;if(!T)throw new Error("Keys missing");return"delete"!==(v="add"===v.type||"put"===v.type?{...v,keys:T}:{...v}).type&&(v.values=[...v.values]),v.keys&&(v.keys=[...v.keys]),function(I,j,P){return"add"===j.type?Promise.resolve([]):I.getMany({trans:j.trans,keys:P,cache:"immutable"})}(e,v,T).then(I=>{const j=T.map((P,E)=>{const ie=I[E],ee={onerror:null,onsuccess:null};if("delete"===v.type)l.fire.call(ee,P,ie,S);else if("add"===v.type||void 0===ie){const ce=u.fire.call(ee,P,v.values[E],S);null==P&&null!=ce&&(v.keys[E]=P=ce,n.outbound||Uf(v.values[E],n.keyPath,P))}else{const ce=YN(ie,v.values[E]),ye=h.fire.call(ee,ce,P,ie,S);if(ye){const Ce=v.values[E];Object.keys(ye).forEach(Ge=>{Lh(Ce,Ge)?Ce[Ge]=ye[Ge]:Uf(Ce,Ge,ye[Ge])})}}return ee});return e.mutate(v).then(({failures:P,results:E,numFailures:ie,lastResult:ee})=>{for(let ce=0;ce<T.length;++ce){const ye=E?E[ce]:T[ce],Ce=j[ce];null==ye?Ce.onerror&&Ce.onerror(P[ce]):Ce.onsuccess&&Ce.onsuccess("put"===v.type&&I[ce]?v.values[ce]:ye)}return{failures:P,results:E,numFailures:ie,lastResult:ee}}).catch(P=>(j.forEach(E=>E.onerror&&E.onerror(P)),Promise.reject(P)))})}function _(v,S,T){return e.query({trans:v,values:!1,query:{index:n,range:S},limit:T}).then(({result:I})=>m({type:"delete",keys:I,trans:v}).then(j=>j.numFailures>0?Promise.reject(j.failures[0]):I.length<T?{failures:[],numFailures:0,lastResult:void 0}:_(v,{...S,lower:I[I.length-1],lowerOpen:!0},T)))}}}}})};function pj(i,t,e){try{if(!t||t.keys.length<i.length)return null;const n=[];for(let r=0,s=0;r<t.keys.length&&s<i.length;++r)0===Pu(t.keys[r],i[s])&&(n.push(e?j1(t.values[r]):t.values[r]),++s);return n.length===i.length?n:null}catch(n){return null}}const ihe={stack:"dbcore",level:-1,create:i=>({table:t=>{const e=i.table(t);return{...e,getMany:n=>{if(!n.cache)return e.getMany(n);const r=pj(n.keys,n.trans._cache,"clone"===n.cache);return r?Nn.resolve(r):e.getMany(n).then(s=>(n.trans._cache={keys:n.keys,values:"clone"===n.cache?j1(s):s},s))},mutate:n=>("add"!==n.type&&(n.trans._cache=null),e.mutate(n))}}})};function KN(i){return!("from"in i)}const Qm=function(i,t){if(!this){const e=new Qm;return i&&"d"in i&&ku(e,i),e}ku(this,arguments.length?{d:1,from:i,to:arguments.length>1?t:i}:{d:0})};function sT(i,t,e){const n=Pu(t,e);if(isNaN(n))return;if(n>0)throw RangeError();if(KN(i))return ku(i,{from:t,to:e,d:1});const r=i.l,s=i.r;if(Pu(e,i.from)<0)return r?sT(r,t,e):i.l={from:t,to:e,d:1,l:null,r:null},mj(i);if(Pu(t,i.to)>0)return s?sT(s,t,e):i.r={from:t,to:e,d:1,l:null,r:null},mj(i);Pu(t,i.from)<0&&(i.from=t,i.l=null,i.d=s?s.d+1:1),Pu(e,i.to)>0&&(i.to=e,i.r=null,i.d=i.l?i.l.d+1:1);const a=!i.r;r&&!i.l&&eP(i,r),s&&a&&eP(i,s)}function eP(i,t){KN(t)||function e(n,{from:r,to:s,l:a,r:l}){sT(n,r,s),a&&e(n,a),l&&e(n,l)}(i,t)}function QN(i){let t=KN(i)?null:{s:0,n:i};return{next(e){const n=arguments.length>0;for(;t;)switch(t.s){case 0:if(t.s=1,n)for(;t.n.l&&Pu(e,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!n||Pu(e,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function mj(i){var t,e;const n=((null===(t=i.r)||void 0===t?void 0:t.d)||0)-((null===(e=i.l)||void 0===e?void 0:e.d)||0),r=n>1?"r":n<-1?"l":"";if(r){const s="r"===r?"l":"r",a={...i},l=i[r];i.from=l.from,i.to=l.to,i[r]=l[r],a[r]=l[s],i[s]=a,a.d=gj(a)}i.d=gj(i)}function gj({r:i,l:t}){return(i?t?Math.max(i.d,t.d):i.d:t?t.d:0)+1}Xw(Qm.prototype,{add(i){return eP(this,i),this},addKey(i){return sT(this,i,i),this},addKeys(i){return i.forEach(t=>sT(this,t,t)),this},[mN](){return QN(this)}});const rhe={stack:"dbcore",level:0,create:i=>{const t=i.schema.name,e=new Qm(i.MIN_KEY,i.MAX_KEY);return{...i,table:n=>{const r=i.table(n),{schema:s}=r,{primaryKey:a}=s,{extractKey:l,outbound:u}=a,h={...r,mutate:v=>{const S=v.trans,T=S.mutatedParts||(S.mutatedParts={}),I=ye=>{const Ce=`idb://${t}/${n}/${ye}`;return T[Ce]||(T[Ce]=new Qm)},j=I(""),P=I(":dels"),{type:E}=v;let[ie,ee]="deleteRange"===v.type?[v.range]:"delete"===v.type?[v.keys]:v.values.length<50?[[],v.values]:[];const ce=v.trans._cache;return r.mutate(v).then(ye=>{if(ru(ie)){"delete"!==E&&(ie=ye.results),j.addKeys(ie);const Ce=pj(ie,ce);Ce||"add"===E||P.addKeys(ie),(Ce||ee)&&(Ge=I,nt=Ce,ge=ee,s.indexes.forEach(function Je(mt){const pt=Ge(mt.name||"");function Pt(vt){return null!=vt?mt.extractKey(vt):null}const et=vt=>mt.multiEntry&&ru(vt)?vt.forEach(kt=>pt.addKey(kt)):pt.addKey(vt);(nt||ge).forEach((vt,kt)=>{const pi=nt&&Pt(nt[kt]),Ht=ge&&Pt(ge[kt]);0!==Pu(pi,Ht)&&(null!=pi&&et(pi),null!=Ht&&et(Ht))})}))}else if(ie){const Ce={from:ie.lower,to:ie.upper};P.add(Ce),j.add(Ce)}else j.add(e),P.add(e),s.indexes.forEach(Ce=>I(Ce.name).add(e));var Ge,nt,ge;return ye})}},m=({query:{index:v,range:S}})=>{var T,I;return[v,new Qm(null!==(T=S.lower)&&void 0!==T?T:i.MIN_KEY,null!==(I=S.upper)&&void 0!==I?I:i.MAX_KEY)]},_={get:v=>[a,new Qm(v.key)],getMany:v=>[a,(new Qm).addKeys(v.keys)],count:m,query:m,openCursor:m};return Yl(_).forEach(v=>{h[v]=function(S){const{subscr:T}=Ar;if(T){const I=ee=>{const ce=`idb://${t}/${n}/${ee}`;return T[ce]||(T[ce]=new Qm)},j=I(""),P=I(":dels"),[E,ie]=_[v](S);if(I(E.name||"").add(ie),!E.isPrimaryKey){if("count"!==v){const ee="query"===v&&u&&S.values&&r.query({...S,values:!1});return r[v].apply(this,arguments).then(ce=>{if("query"===v){if(u&&S.values)return ee.then(({result:Ce})=>(j.addKeys(Ce),ce));const ye=S.values?ce.result.map(l):ce.result;S.values?j.addKeys(ye):P.addKeys(ye)}else if("openCursor"===v){const ye=ce,Ce=S.values;return ye&&Object.create(ye,{key:{get:()=>(P.addKey(ye.primaryKey),ye.key)},primaryKey:{get(){const Ge=ye.primaryKey;return P.addKey(Ge),Ge}},value:{get:()=>(Ce&&j.addKey(ye.primaryKey),ye.value)}})}return ce})}P.add(e)}}return r[v].apply(this,arguments)}}),h}}}};class Zb{constructor(t,e){this._middlewares={},this.verno=0;const n=Zb.dependencies;this._options=e={addons:Zb.addons,autoOpen:!0,indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange,...e},this._deps={indexedDB:e.indexedDB,IDBKeyRange:e.IDBKeyRange};const{addons:r}=e;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;const s={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Jo,dbReadyPromise:null,cancelOpen:Jo,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};var a,l;s.dbReadyPromise=new Nn(l=>{s.dbReadyResolve=l}),s.openCanceller=new Nn((l,u)=>{s.cancelOpen=u}),this._state=s,this.name=t,this.on=eT(this,"populate","blocked","versionchange","close",{ready:[bN,Jo]}),this.on.ready.subscribe=L7(this.on.ready.subscribe,l=>(u,h)=>{Zb.vip(()=>{const m=this._state;if(m.openComplete)m.dbOpenError||Nn.resolve().then(u),h&&l(u);else if(m.onReadyBeingFired)m.onReadyBeingFired.push(u),h&&l(u);else{l(u);const _=this;h||l(function v(){_.on.ready.unsubscribe(u),_.on.ready.unsubscribe(v)})}})}),this.Collection=(a=this,tT(zue.prototype,function(l,u){this.db=a;let h=ij,m=null;if(u)try{h=u()}catch(T){m=T}const _=l._ctx,v=_.table,S=v.hook.reading.fire;this._ctx={table:v,index:_.index,isPrimKey:!_.index||v.schema.primKey.keyPath&&_.index===v.schema.primKey.name,range:h,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:m,or:_.or,valueMapper:S!==X1?S:null}})),this.Table=(l=this,tT(Vue.prototype,function(u,h,m){this.db=l,this._tx=m,this.name=u,this.schema=h,this.hook=l._allTables[u]?l._allTables[u].hook:eT(null,{creating:[Aue,Jo],reading:[Eue,X1],updating:[Rue,Jo],deleting:[Due,Jo]})})),this.Transaction=function(l){return tT(jue.prototype,function(u,h,m,_,v){this.db=l,this.mode=u,this.storeNames=h,this.schema=m,this.chromeTransactionDurability=_,this.idbtrans=null,this.on=eT(this,"complete","error","abort"),this.parent=v||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Nn((S,T)=>{this._resolve=S,this._reject=T}),this._completion.then(()=>{this.active=!1,this.on.complete.fire()},S=>{var T=this.active;return this.active=!1,this.on.error.fire(S),this.parent?this.parent._reject(S):T&&this.idbtrans&&this.idbtrans.abort(),fc(S)})})}(this),this.Version=function(l){return tT(Kue.prototype,function(u){this.db=l,this._cfg={version:u,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}(this),this.WhereClause=function(l){return tT(lj.prototype,function(u,h,m){this.db=l,this._ctx={table:u,index:":id"===h?null:h,or:m};const _=l._deps.indexedDB;if(!_)throw new Yr.MissingAPI;this._cmp=this._ascending=_.cmp.bind(_),this._descending=(v,S)=>_.cmp(S,v),this._max=(v,S)=>_.cmp(v,S)>0?v:S,this._min=(v,S)=>_.cmp(v,S)<0?v:S,this._IDBKeyRange=l._deps.IDBKeyRange})}(this),this.on("versionchange",l=>{l.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()}),this.on("blocked",l=>{!l.newVersion||l.newVersion<l.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${l.oldVersion/10}`)}),this._maxKey=nT(e.IDBKeyRange),this._createTransaction=(l,u,h,m)=>new this.Transaction(l,u,h,this._options.chromeTransactionDurability,m),this._fireOnBlocked=l=>{this.on("blocked").fire(l),$1.filter(u=>u.name===this.name&&u!==this&&!u._state.vcFired).map(u=>u.on("versionchange").fire(l))},this.use(ehe),this.use(the),this.use(rhe),this.use(ihe),this.vip=Object.create(this,{_vip:{value:!0}}),r.forEach(l=>l(this))}version(t){if(isNaN(t)||t<.1)throw new Yr.Type("Given version is not a positive number");if(t=Math.round(10*t)/10,this.idbdb||this._state.isBeingOpened)throw new Yr.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);const e=this._versions;var n=e.filter(r=>r._cfg.version===t)[0];return n||(n=new this.Version(t),e.push(n),e.sort(Zue),n.stores({}),this._state.autoSchema=!1,n)}_whenReady(t){return this.idbdb&&(this._state.openComplete||Ar.letThrough||this._vip)?t():new Nn((e,n)=>{if(this._state.openComplete)return n(new Yr.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen)return void n(new Yr.DatabaseClosed);this.open().catch(Jo)}this._state.dbReadyPromise.then(e,n)}).then(t)}use({stack:t,create:e,level:n,name:r}){r&&this.unuse({stack:t,name:r});const s=this._middlewares[t]||(this._middlewares[t]=[]);return s.push({stack:t,create:e,level:null==n?10:n,name:r}),s.sort((a,l)=>a.level-l.level),this}unuse({stack:t,name:e,create:n}){return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(r=>n?r.create!==n:!!e&&r.name!==e)),this}open(){return function Jue(i){const t=i._state,{indexedDB:e}=i._deps;if(t.isBeingOpened||i.idbdb)return t.dbReadyPromise.then(()=>t.dbOpenError?fc(t.dbOpenError):i);Ap&&(t.openCanceller._stackHolder=Ub()),t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;const n=t.openCanceller;function r(){if(t.openCanceller!==n)throw new Yr.DatabaseClosed("db.open() was cancelled")}let s=t.dbReadyResolve,a=null,l=!1;return Nn.race([n,("undefined"==typeof navigator?Nn.resolve():Que()).then(()=>new Nn((u,h)=>{if(r(),!e)throw new Yr.MissingAPI;const m=i.name,_=t.autoSchema?e.open(m):e.open(m,Math.round(10*i.verno));if(!_)throw new Yr.MissingAPI;_.onerror=Dp(h),_.onblocked=La(i._fireOnBlocked),_.onupgradeneeded=La(v=>{if(a=_.transaction,t.autoSchema&&!i._options.allowEmptyDB){_.onerror=iT,a.abort(),_.result.close();const T=e.deleteDatabase(m);T.onsuccess=T.onerror=La(()=>{h(new Yr.NoSuchDatabase(`Database ${m} doesnt exist`))})}else{a.onerror=Dp(h);var S=v.oldVersion>Math.pow(2,62)?0:v.oldVersion;l=S<1,i._novip.idbdb=_.result,function Yue(i,t,e,n){const r=i._dbSchema,s=i._createTransaction("readwrite",i._storeNames,r);s.create(e),s._completion.catch(n);const a=s._reject.bind(s),l=Ar.transless||Ar;_y(()=>{Ar.trans=s,Ar.transless=l,0===t?(Yl(r).forEach(u=>{zN(e,u,r[u].primKey,r[u].indexes)}),HN(i,e),Nn.follow(()=>i.on.populate.fire(s)).catch(a)):function({_novip:u},h,m,_){const v=[],S=u._versions;let T=u._dbSchema=GN(0,u.idbdb,_),I=!1;return S.filter(P=>P._cfg.version>=h).forEach(P=>{v.push(()=>{const E=T,ie=P._cfg.dbschema;WN(u,E,_),WN(u,ie,_),T=u._dbSchema=ie;const ee=dj(E,ie);ee.add.forEach(ye=>{zN(_,ye[0],ye[1].primKey,ye[1].indexes)}),ee.change.forEach(ye=>{if(ye.recreate)throw new Yr.Upgrade("Not yet support for changing primary key");{const Ce=_.objectStore(ye.name);ye.add.forEach(Ge=>UN(Ce,Ge)),ye.change.forEach(Ge=>{Ce.deleteIndex(Ge.name),UN(Ce,Ge)}),ye.del.forEach(Ge=>Ce.deleteIndex(Ge))}});const ce=P._cfg.contentUpgrade;if(ce&&P._cfg.version>h){HN(u,_),m._memoizedTables={},I=!0;let ye=B7(ie);ee.del.forEach(nt=>{ye[nt]=E[nt]}),VN(u,[u.Transaction.prototype]),Jk(u,[u.Transaction.prototype],Yl(ye),ye),m.schema=ye;const Ce=gN(ce);let Ge;Ce&&Jw();const Qe=Nn.follow(()=>{if(Ge=ce(m),Ge&&Ce){var nt=Ym.bind(null,null);Ge.then(nt,nt)}});return Ge&&"function"==typeof Ge.then?Nn.resolve(Ge):Qe.then(()=>Ge)}}),v.push(E=>{var ie,ee;(!I||!Nue)&&(ie=P._cfg.dbschema,[].slice.call((ee=E).db.objectStoreNames).forEach(ce=>null==ie[ce]&&ee.db.deleteObjectStore(ce))),VN(u,[u.Transaction.prototype]),Jk(u,[u.Transaction.prototype],u._storeNames,u._dbSchema),m.schema=u._dbSchema})}),function j(){return v.length?Nn.resolve(v.shift()(m.idbtrans)).then(j):Nn.resolve()}().then(()=>{var P,E;E=_,Yl(P=T).forEach(ie=>{E.db.objectStoreNames.contains(ie)||zN(E,ie,P[ie].primKey,P[ie].indexes)})})}(i,t,s,e).catch(a)})}(i,S/10,a,h)}},h),_.onsuccess=La(()=>{a=null;const v=i._novip.idbdb=_.result,S=Ik(v.objectStoreNames);if(S.length>0)try{const I=v.transaction(1===(T=S).length?T[0]:T,"readonly");t.autoSchema?function({_novip:j},P,E){j.verno=P.version/10;const ie=j._dbSchema=GN(0,P,E);j._storeNames=Ik(P.objectStoreNames,0),Jk(j,[j._allTables],Yl(ie),ie)}(i,v,I):(WN(i,i._dbSchema,I),function(j,P){const E=dj(GN(0,j.idbdb,P),j._dbSchema);return!(E.add.length||E.change.some(ie=>ie.add.length||ie.change.length))}(i,I)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),HN(i,I)}catch(I){}var T;$1.push(i),v.onversionchange=La(I=>{t.vcFired=!0,i.on("versionchange").fire(I)}),v.onclose=La(I=>{i.on("close").fire(I)}),l&&function({indexedDB:I,IDBKeyRange:j},P){!qN(I)&&"__dbnames"!==P&&jN(I,j).put({name:P}).catch(Jo)}(i._deps,m),u()},h)}))]).then(()=>(r(),t.onReadyBeingFired=[],Nn.resolve(XN(()=>i.on.ready.fire(i.vip))).then(function u(){if(t.onReadyBeingFired.length>0){let h=t.onReadyBeingFired.reduce(bN,Jo);return t.onReadyBeingFired=[],Nn.resolve(XN(()=>h(i.vip))).then(u)}}))).finally(()=>{t.onReadyBeingFired=null,t.isBeingOpened=!1}).then(()=>i).catch(u=>{t.dbOpenError=u;try{a&&a.abort()}catch(h){}return n===t.openCanceller&&i._close(),fc(u)}).finally(()=>{t.openComplete=!0,s()})}(this)}_close(){const t=this._state,e=$1.indexOf(this);if(e>=0&&$1.splice(e,1),this.idbdb){try{this.idbdb.close()}catch(n){}this._novip.idbdb=null}t.dbReadyPromise=new Nn(n=>{t.dbReadyResolve=n}),t.openCanceller=new Nn((n,r)=>{t.cancelOpen=r})}close(){this._close();const t=this._state;this._options.autoOpen=!1,t.dbOpenError=new Yr.DatabaseClosed,t.isBeingOpened&&t.cancelOpen(t.dbOpenError)}delete(){const t=arguments.length>0,e=this._state;return new Nn((n,r)=>{const s=()=>{this.close();var a=this._deps.indexedDB.deleteDatabase(this.name);a.onsuccess=La(()=>{(function({indexedDB:l,IDBKeyRange:u},h){!qN(l)&&"__dbnames"!==h&&jN(l,u).delete(h).catch(Jo)})(this._deps,this.name),n()}),a.onerror=Dp(r),a.onblocked=this._fireOnBlocked};if(t)throw new Yr.InvalidArgument("Arguments not allowed in db.delete()");e.isBeingOpened?e.dbReadyPromise.then(s):s()})}backendDB(){return this.idbdb}isOpen(){return null!==this.idbdb}hasBeenClosed(){const t=this._state.dbOpenError;return t&&"DatabaseClosed"===t.name}hasFailed(){return null!==this._state.dbOpenError}dynamicallyOpened(){return this._state.autoSchema}get tables(){return Yl(this._allTables).map(t=>this._allTables[t])}transaction(){const t=$ue.apply(this,arguments);return this._transaction.apply(this,t)}_transaction(t,e,n){let r=Ar.trans;r&&r.db===this&&-1===t.indexOf("!")||(r=null);const s=-1!==t.indexOf("?");let a,l;t=t.replace("!","").replace("?","");try{if(l=e.map(h=>{var m=h instanceof this.Table?h.name:h;if("string"!=typeof m)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return m}),"r"==t||"readonly"===t)a="readonly";else{if("rw"!=t&&"readwrite"!=t)throw new Yr.InvalidArgument("Invalid transaction mode: "+t);a="readwrite"}if(r){if("readonly"===r.mode&&"readwrite"===a){if(!s)throw new Yr.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");r=null}r&&l.forEach(h=>{if(r&&-1===r.storeNames.indexOf(h)){if(!s)throw new Yr.SubTransaction("Table "+h+" not included in parent transaction.");r=null}}),s&&r&&!r.active&&(r=null)}}catch(h){return r?r._promise(null,(m,_)=>{_(h)}):fc(h)}const u=fj.bind(null,this,a,l,r,n);return r?r._promise(a,u,"lock"):Ar.trans?$w(Ar.transless,()=>this._whenReady(u)):this._whenReady(u)}table(t){if(!Lh(this._allTables,t))throw new Yr.InvalidTable(`Table ${t} does not exist`);return this._allTables[t]}}const she="undefined"!=typeof Symbol&&"observable"in Symbol?Symbol.observable:"@@observable";class ohe{constructor(t){this._subscribe=t}subscribe(t,e,n){return this._subscribe(t&&"function"!=typeof t?t:{next:t,error:e,complete:n})}[she](){return this}}function _j(i,t){return Yl(t).forEach(e=>{eP(i[e]||(i[e]=new Qm),t[e])}),i}let JN;try{JN={indexedDB:ya.indexedDB||ya.mozIndexedDB||ya.webkitIndexedDB||ya.msIndexedDB,IDBKeyRange:ya.IDBKeyRange||ya.webkitIDBKeyRange}}catch(i){JN={indexedDB:null,IDBKeyRange:null}}const Yb=Zb;function tP(i){let t=Jm;try{Jm=!0,by.storagemutated.fire(i)}finally{Jm=t}}Xw(Yb,{...Ok,delete:i=>new Yb(i,{addons:[]}).delete(),exists:i=>new Yb(i,{addons:[]}).open().then(t=>(t.close(),!0)).catch("NoSuchDatabaseError",()=>!1),getDatabaseNames(i){try{return function({indexedDB:t,IDBKeyRange:e}){return qN(t)?Promise.resolve(t.databases()).then(n=>n.map(r=>r.name).filter(r=>"__dbnames"!==r)):jN(t,e).toCollection().primaryKeys()}(Yb.dependencies).then(i)}catch(t){return fc(new Yr.MissingAPI)}},defineClass:()=>function(i){ku(this,i)},ignoreTransaction:i=>Ar.trans?$w(Ar.transless,i):i(),vip:XN,async:function(i){return function(){try{var t=ZN(i.apply(this,arguments));return t&&"function"==typeof t.then?t:Nn.resolve(t)}catch(e){return fc(e)}}},spawn:function(i,t,e){try{var n=ZN(i.apply(e,t||[]));return n&&"function"==typeof n.then?n:Nn.resolve(n)}catch(r){return fc(r)}},currentTransaction:{get:()=>Ar.trans||null},waitFor:function(i,t){const e=Nn.resolve("function"==typeof i?Yb.ignoreTransaction(i):i).timeout(t||6e4);return Ar.trans?Ar.trans.waitFor(e):e},Promise:Nn,debug:{get:()=>Ap,set:i=>{V7(i,"dexie"===i?()=>!0:tj)}},derive:Zw,extend:ku,props:Xw,override:L7,Events:eT,on:by,liveQuery:function ahe(i){return new ohe(t=>{const e=gN(i);let n=!1,r={},s={};const a={get closed(){return n},unsubscribe:()=>{n=!0,by.storagemutated.unsubscribe(m)}};t.start&&t.start(a);let l=!1,u=!1;function h(){return Yl(s).some(v=>r[v]&&function nhe(i,t){const e=QN(t);let n=e.next();if(n.done)return!1;let r=n.value;const s=QN(i);let a=s.next(r.from),l=a.value;for(;!n.done&&!a.done;){if(Pu(l.from,r.to)<=0&&Pu(l.to,r.from)>=0)return!0;Pu(r.from,l.from)<0?r=(n=e.next(l.from)).value:l=(a=s.next(r.from)).value}return!1}(r[v],s[v]))}const m=v=>{_j(r,v),h()&&_()},_=()=>{if(l||n)return;r={};const v={},S=function(T){e&&Jw();const I=()=>_y(i,{subscr:T,trans:null}),j=Ar.trans?$w(Ar.transless,I):I();return e&&j.then(Ym,Ym),j}(v);u||(by("storagemutated",m),u=!0),l=!0,Promise.resolve(S).then(T=>{l=!1,n||(h()?_():(r={},s=v,t.next&&t.next(T)))},T=>{l=!1,t.error&&t.error(T),a.unsubscribe()})};return _(),a})},extendObservabilitySet:_j,getByKeyPath:Xm,setByKeyPath:Uf,delByKeyPath:function(i,t){"string"==typeof t?Uf(i,t,void 0):"length"in t&&[].map.call(t,function(e){Uf(i,e,void 0)})},shallowClone:B7,deepClone:j1,getObjectDiff:YN,cmp:Pu,asap:O7,minKey:-1/0,addons:[],connections:$1,errnames:vN,dependencies:JN,semVer:"3.2.2",version:"3.2.2".split(".").map(i=>parseInt(i)).reduce((i,t,e)=>i+t/Math.pow(10,2*e))}),Yb.maxKey=nT(Yb.dependencies.IDBKeyRange),"undefined"!=typeof dispatchEvent&&"undefined"!=typeof addEventListener&&(by("storagemutated",i=>{if(!Jm){let t;Xk?(t=document.createEvent("CustomEvent"),t.initCustomEvent("x-storagemutated-1",!0,!0,i)):t=new CustomEvent("x-storagemutated-1",{detail:i}),Jm=!0,dispatchEvent(t),Jm=!1}}),addEventListener("x-storagemutated-1",({detail:i})=>{Jm||tP(i)}));let Jm=!1;if("undefined"!=typeof BroadcastChannel){const i=new BroadcastChannel("x-storagemutated-1");by("storagemutated",t=>{Jm||i.postMessage(t)}),i.onmessage=t=>{t.data&&tP(t.data)}}else if("undefined"!=typeof self&&"undefined"!=typeof navigator){by("storagemutated",t=>{try{Jm||("undefined"!=typeof localStorage&&localStorage.setItem("x-storagemutated-1",JSON.stringify({trig:Math.random(),changedParts:t})),"object"==typeof self.clients&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach(e=>e.postMessage({type:"x-storagemutated-1",changedParts:t})))}catch(e){}}),"undefined"!=typeof addEventListener&&addEventListener("storage",t=>{if("x-storagemutated-1"===t.key){const e=JSON.parse(t.newValue);e&&tP(e.changedParts)}});const i=self.document&&navigator.serviceWorker;i&&i.addEventListener("message",function({data:t}){t&&"x-storagemutated-1"===t.type&&tP(t.changedParts)})}Nn.rejectionMapper=function(i,t){if(!i||i instanceof Kw||i instanceof TypeError||i instanceof SyntaxError||!i.name||!W7[i.name])return i;var e=new W7[i.name](t||i.message,i);return"stack"in i&&qm(e,"stack",{get:function(){return this.inner.stack}}),e},V7(Ap,tj);class Fh{constructor(){Fh.DB.version(1).stores({history:"++id,timestamp",log_results_dres:"++id,log",log_interaction_dres:"++id,log",log_submission_dres:"++id,log",log_results:"++id,entry",log_queries:"++id,entry"})}get db(){return Fh.DB}}Fh.DB=new Zb("vitrivrng"),Fh.\u0275fac=function(t){return new(t||Fh)},Fh.\u0275prov=Nt({token:Fh,factory:Fh.\u0275fac});let $N=(()=>{class i{constructor(e,n){this._keep=-1,this._historyTable=n.db.table("history"),e.configAsObservable.subscribe(r=>{this.keep=r.get("query.history")})}get keep(){return this._keep}set keep(e){this._keep=e,this.ommitOldest()}get list(){return xr(this._historyTable.orderBy("id").reverse().toArray())}get count(){return xr(this._historyTable.count())}append(e){this._keep>0&&(xr(this._historyTable.add(new ule(e))).subscribe(),this.ommitOldest())}delete(e){xr(this._historyTable.delete(e)).subscribe()}clear(){xr(this._historyTable.clear()).subscribe()}download(){xr(this._historyTable.orderBy("id").toArray()).pipe(Xl(),Ui(e=>{const n=new DW,r={base64:!1,binary:!1,date:new Date,createFolders:!1,dir:!1};return n.file("vitrivrng-history.json",JSON.stringify(e,null,2),r),n})).subscribe(e=>{e.generateAsync({type:"blob"}).then(n=>{window.open(window.URL.createObjectURL(n))},n=>{console.log(n)})})}ommitOldest(){xr(this._historyTable.count()).pipe(Ui(e=>{e>this._keep&&this._historyTable.orderBy("timestamp").limit(e-this.keep).delete()})).subscribe()}}return i.\u0275fac=function(e){return new(e||i)(Ve(dr),Ve(Fh))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})();class lhe{constructor(t,e,n=null,r=null){this.segmentId=t,this.categories=e,this.config=n,this.metadataAccessSpec=r,this.messageType="Q_MLT"}}class yj{constructor(){this._score=0}static compareDesc(t,e){return e._score-t._score}static compareAsc(t,e){return t._score-e._score}get score(){return this._score}get scorePercentage(){return Math.round(1e3*this._score)/10}}class eH extends yj{constructor(t,e){if(super(),this._mediaSegment=t,this._objectScoreContainer=e,this._scores=new Map,this.metadata=new Map,t.objectId!==e.objectid)throw new Error("You cannot associate a MediaObjectScoreContainer with ID '"+e.objectid+"' with a segment with objectId '"+t.objectId+"'.");this.segmentId=t.segmentId,this.objectId=t.objectId,this.sequenceNumber=t.sequenceNumber,this.start=t.start,this.end=t.end,this.startabs=t.startabs,this.endabs=t.endabs}get scores(){return this._scores}get scoresPerCategory(){const t=new Map;return this._scores.forEach((e,n)=>{e.forEach((r,s)=>{t.has(s)?t.get(s)<r&&t.set(s,r):t.set(s,r)})}),t}get objectScoreContainer(){return this._objectScoreContainer}addSimilarity(t,e,n){return e.key===this._mediaSegment.segmentId&&(this._scores.has(n)||this._scores.set(n,new Map),this._scores.get(n).set(t,e.value),!0)}update(t,e){this._score=e.scoreForSegment(t,this)}metadataForKey(t){return this.metadata.get(t)}serialize(){return{segmentId:this.segmentId,objectId:this.objectId,sequenceNumber:this.sequenceNumber,start:this.start,end:this.end,startabs:this.startabs,endabs:this.endabs}}}class tH extends yj{constructor(t){super(),this.objectid=t,this._segmentScores=new Map,this._cache=new Map,this._segments=[],this._segmentsObservable=new gs(this._segments),this.metadata=new Map}get segments(){return this._segments}set segments(t){this._segments=t,this.updateSegmentsObservable()}get segmentsObservable(){return this._segmentsObservable.asObservable()}get show(){return this.mediatype&&this._segmentScores.size>0}get numberOfSegments(){return this._segmentScores.size}get representativeSegment(){return this.segments.reduce((t,e)=>t.score>e.score?t:e)}updateSegmentsObservable(){this._segmentsObservable.next(this._segments)}addMediaSegment(t){const e=this.uniqueSegmentScoreContainer(t);return this._cache.has(e.segmentId)&&(this._cache.get(e.segmentId).forEach(n=>{this.addSimilarity(n[0],n[1],n[2])}),this._cache.delete(e.segmentId)),e}addSimilarity(t,e,n){this._segmentScores.has(e.key)?this._segmentScores.get(e.key).addSimilarity(t,e,n):(this._cache.has(e.key)||this._cache.set(e.key,[]),this._cache.get(e.key).push([t,e,n]))}update(t,e){this._score=e.scoreForObject(t,this)}serialize(){return{objectId:this.objectid,mediatype:this.mediatype,name:this.name,path:this.path,contentURL:this.contentURL}}uniqueSegmentScoreContainer(t){if(!this._segmentScores.has(t.segmentId)){const e=new eH(t,this);this._segmentScores.set(t.segmentId,e),this._segments.push(e),this.updateSegmentsObservable()}return this._segmentScores.get(t.segmentId)}}class che{constructor(t,e,n){this.name=t,this.readableName=e,this.defaultWeight=n,this.displayColor=Rb.randomColorHex(),this.weightPercentage=n}toString(){return this.name+":"+this.weightPercentage}}class vj{constructor(t){this.type=t}}var $m=(()=>{return(i=$m||($m={})).CHECKBOX="CHECKBOX",i.SLIDER="SLIDER",$m;var i})();class uhe extends vj{constructor(t){super($m.CHECKBOX),this.options=t}}class hhe extends vj{constructor(t,e){super($m.SLIDER),this._min=t,this._max=e}set min(t){this._min=t}get min(){return this._min}set max(t){this._max=t}get max(){return this._max}sliderOptions(){return{floor:this.min,ceil:this.max}}}class bj{scoreForObject(t,e){let n=0;return e.segments.forEach(r=>{const s=this.scoreForSegment(t,r);n=Math.max(n,s)}),n}scoreForSegment(t,e){let n=0;return e.scores.forEach((r,s)=>{r.forEach((a,l)=>{n=Math.max(a*l.weightPercentage/100,n)})}),n}name(){return"maxpool"}}class xj{constructor(){this._objectFusionFunction=new bj}scoreForObject(t,e){return this._objectFusionFunction.scoreForObject(t,e)}scoreForSegment(t,e){let n=0,r=0;return t.forEach(s=>{let a=0;e.scores.forEach((l,u)=>{if(l.has(s)){const h=l.get(s)*s.weightPercentage/100;a=Math.max(h,a)}}),n+=a,r+=s.weightPercentage/100}),n/r}name(){return"average"}}class dhe{constructor(t,e,n){this.object=t,this.segments=e,this.score=n}}class iS{constructor(t,e=new xj){this.queryId=t,this.scoreFunction=e,this._objectid_to_object_map=new Map,this._segmentid_to_segment_map=new Map,this._objectid_to_temporal_object_map=new Map,this._results_objects=[],this._results_segments=[],this._results_objects_subject=new gs(this._results_objects),this._results_segments_subject=new gs(this._results_segments),this._temporal_objects_subject=new gs(Array.from(this._objectid_to_temporal_object_map.values())),this._rerank=0,this._next=0,this._features=[],this._results_features_subject=new gs(this._features),this._mediatypes=new Map}get features(){return this._features}get mediatypes(){return this._mediatypes}get objectCount(){return this._results_objects.length}get segmentCount(){return this._results_segments.length}get mediaobjectsAsObservable(){return this._results_objects_subject.asObservable()}get segmentsAsObservable(){return this._results_segments_subject.asObservable()}get featuresAsObservable(){return this._results_features_subject.asObservable()}get temporalObjectsAsObservable(){return this._temporal_objects_subject.asObservable()}static deserialize(t){const e=new iS(t.queryId);e.processObjectMessage({queryId:e.queryId,content:t.objects}),e.processSegmentMessage({queryId:e.queryId,content:t.segments}),e.processObjectMetadataMessage({queryId:e.queryId,content:t.objectMetadata}),e.processSegmentMetadataMessage({queryId:e.queryId,content:t.segmentMetadata});for(const n of t.similarity)n.length>0&&e.processSimilarityMessage({queryId:e.queryId,category:n[0].category,containerId:n.containerId,content:n});return e}static fillMap(t,e,n){return n&&n.get("refinement.filters").forEach(r=>{switch(r[1]){case"CHECKBOX":t.set(r[0],new uhe(new Set));break;case"SLIDER":t.set(r[0],new hhe(0,0));break;default:console.error("unknown filter type: "+r[1])}}),e.forEach(r=>{r.metadata.forEach((s,a)=>{if(t.has(a))switch(t.get(a).type){case $m.CHECKBOX:t.get(a).options.add(s);break;case $m.SLIDER:const l=t.get(a),u=Number(s);!u&&0!==u&&console.error(s+" is not a number so it cannot be used for category "+a),u<l.min&&(l.min=u),u>l.max&&(l.max=u);break;default:console.error("unknown type: "+t.get(a).type)}})}),t}checkUpdate(){this._rerank>0?this._rerank<100?this.rerank():this._rerank=1:this._next>0&&(this._next<100?this.next():this._next=1)}doUpdate(){this._rerank>0?this.rerank():this._next>0&&this.next()}setScoreFunction(t){switch(t.toUpperCase()){case"AVERAGE":this.scoreFunction=new xj;break;case"MAXPOOL":this.scoreFunction=new bj}this.rerank()}hasObject(t){return this._objectid_to_object_map.has(t)}getObject(t){return this._objectid_to_object_map.get(t)}metadataAsObservable(t){return zb([this.segmentsAsObservable,t.configAsObservable,this._results_objects_subject]).pipe(Ui(([e,n,r])=>{const s=new Map;return iS.fillMap(s,e,n),iS.fillMap(s,r)}))}toggleMediatype(t,e){this._mediatypes.has(t)&&this._mediatypes.set(t,e),this.next()}rerank(t,e){this._rerank=0,t||(console.debug(`no features given for rerank(), using features inherent to the results container: ${this.features}`),t=this.features),e||(console.debug(`no weight function given for rerank(), using weight function inherent to the results container: ${this.scoreFunction.name()}`),e=this.scoreFunction),console.time(`Rerank (${this.queryId})`),this._results_objects.forEach(n=>{n.update(t,e),n.segments.forEach(r=>{r.update(t,e)})}),this.next(),console.timeEnd(`Rerank (${this.queryId})`)}processObjectMessage(t){if(t.queryId!==this.queryId)return!1;console.time(`Processing Object Message (${this.queryId})`);for(const e of t.content)this._mediatypes.has(e.mediatype)||this._mediatypes.set(e.mediatype,!0),this.uniqueMediaObjectScoreContainer(e.objectid,e);return console.timeEnd(`Processing Object Message (${this.queryId})`),this._rerank+=1,!0}processSegmentMessage(t){if(t.queryId!==this.queryId)return console.warn("query result id "+t.queryId+" does not match query id "+this.queryId),!1;console.time(`Processing Segment Message (${this.queryId})`);for(const e of t.content){const r=this.uniqueMediaObjectScoreContainer(e.objectId).addMediaSegment(e);this._segmentid_to_segment_map.has(e.segmentId)||(this._results_segments.push(r),this._segmentid_to_segment_map.set(e.segmentId,r)),this.updateTemporalSegments(r)}return console.timeEnd(`Processing Segment Message (${this.queryId})`),this._rerank+=1,!0}processSegmentMetadataMessage(t){if(t.queryId!==this.queryId)return console.warn("segment metadata result id "+t.queryId+" does not match query id "+this.queryId),!1;console.time(`Processing Segment Metadata Message (${this.queryId})`);for(const e of t.content){const n=this._segmentid_to_segment_map.get(e.segmentId);n&&n.metadata.set(`${e.domain}.${e.key}`,e.value)}console.timeEnd(`Processing Segment Metadata Message (${this.queryId})`),this._next+=1}processObjectMetadataMessage(t){if(t.queryId!==this.queryId)return console.warn("object metadata result id "+t.queryId+" does not match query id "+this.queryId),!1;console.time(`Processing Object Metadata Message (${this.queryId})`);for(const e of t.content){const n=this._objectid_to_object_map.get(e.objectid);n&&n.metadata.set(`${e.domain}.${e.key}`,e.value)}console.timeEnd(`Processing Object Metadata Message (${this.queryId})`),this._next+=1}processSimilarityMessage(t){if(t.queryId!==this.queryId)return console.warn(`similarity result query id ${t.queryId} does not match query id ${this.queryId}`),!1;const e=this.uniqueFeature(t.category);for(const n of t.content){const r=this._segmentid_to_segment_map.get(n.key);void 0!==r&&r.addSimilarity(e,n,t.containerId)}return this._rerank+=1,!0}processTemporalMessage(t){if(t.queryId!==this.queryId)return console.warn(`similarity result query id ${t.queryId} does not match query id ${this.queryId}`),!1;console.time(`Processing Temporal Message (${this.queryId})`);for(const e of t.content){let n;if(this._objectid_to_temporal_object_map.has(e.objectId)){const r=this._objectid_to_temporal_object_map.get(e.objectId);r.score=r.score<e.score?e.score:r.score,e.segments.forEach(s=>{const a=this._segmentid_to_segment_map.get(s);if(!a)return console.warn(`cannot add undefined segment! ${s}`),!1;-1===r.segments.indexOf(a)&&r.segments.push(a)})}else n=new dhe(this._objectid_to_object_map.get(e.objectId),e.segments.map(r=>this._segmentid_to_segment_map.get(r)),e.score),this._objectid_to_temporal_object_map.set(e.objectId,n)}return this._next+=1,console.timeEnd(`Processing Temporal Message (${this.queryId})`),!0}updateTemporalSegments(t){if(!t)return void console.error("received undefined segment, exiting");const e=this._objectid_to_temporal_object_map.get(t.objectId);if(e&&-1===e.segments.indexOf(t)){const n=e.segments.findIndex(r=>r.sequenceNumber>t.sequenceNumber);if(-1===n)return void e.segments.push(t);e.segments.splice(n,0,t)}}complete(){this._results_objects_subject.complete(),this._results_segments_subject.complete(),this._results_features_subject.complete(),this._temporal_objects_subject.complete()}flatten(t,e=[]){for(let n=0;n<t.length;n++){const r=t[n];Array.isArray(r)?this.flatten(r,e):e.push(r)}return e}serialize(){const t=[];this._results_segments.forEach(n=>{n.scores.forEach((r,s)=>{r.forEach((a,l)=>{t.push({category:l.name,key:n.segmentId,value:a,containerId:s})})})});const e=[];return Array.from(this._objectid_to_temporal_object_map.values()).forEach(n=>{e.push({objectId:n.object.objectid,segments:n.segments.map(r=>r.serialize()),score:n.score})}),{queryId:this.queryId,objects:this._results_objects.map(n=>n.serialize()),segments:this._results_segments.map(n=>n.serialize()),objectMetadata:this.flatten(this._results_objects.map(n=>{const r=[];return n.metadata.forEach((s,a)=>{r.push({objectid:n.objectid,domain:a.split(".")[0],key:a.split(".")[1],value:s})}),r})),segmentMetadata:this.flatten(this._results_segments.map(n=>{const r=[];return n.metadata.forEach((s,a)=>{r.push({segmentId:n.segmentId,domain:a.split(".")[0],key:a.split(".")[1],value:s})}),r})),similarity:t,temporal:e}}next(){this._next=0,this._results_segments_subject.next(this._results_segments.filter(t=>t.objectScoreContainer.show)),this._results_objects_subject.next(this._results_objects.filter(t=>t.show)),this._results_features_subject.next(this._features),this._temporal_objects_subject.next(Array.from(this._objectid_to_temporal_object_map.values()).sort((t,e)=>e.score-t.score))}uniqueMediaObjectScoreContainer(t,e){let n;return this._objectid_to_object_map.has(t)?n=this._objectid_to_object_map.get(t):(n=new tH(t),this._objectid_to_object_map.set(t,n),this._results_objects.push(n)),e&&e.objectid==e.objectid&&(n.mediatype=e.mediatype,n.name=e.name,n.path=e.path,n.contentURL=e.contentURL),n}uniqueFeature(t){for(const n of this._features)if(n.name===t)return n;const e=new che(t,t,100);return this._features.push(e),e}}class fhe{constructor(t,e,n=3,r=null){this.segmentId=t,this.config=e,this.count=n,this.metadataAccessSpec=r,this.messageType="Q_NESEG"}}class iH extends ii{constructor(t=1/0,e=1/0,n=_k){super(),this._bufferSize=t,this._windowTime=e,this._timestampProvider=n,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=e===1/0,this._bufferSize=Math.max(1,t),this._windowTime=Math.max(1,e)}next(t){const{isStopped:e,_buffer:n,_infiniteTimeWindow:r,_timestampProvider:s,_windowTime:a}=this;e||(n.push(t),!r&&n.push(s.now()+a)),this._trimBuffer(),super.next(t)}_subscribe(t){this._throwIfClosed(),this._trimBuffer();const e=this._innerSubscribe(t),{_infiniteTimeWindow:n,_buffer:r}=this,s=r.slice();for(let a=0;a<s.length&&!t.closed;a+=n?1:2)t.next(s[a]);return this._checkFinalizedStatuses(t),e}_trimBuffer(){const{_bufferSize:t,_timestampProvider:e,_buffer:n,_infiniteTimeWindow:r}=this,s=(r?1:2)*t;if(t<1/0&&s<n.length&&n.splice(0,n.length-s),!r){const a=e.now();let l=0;for(let u=1;u<n.length&&n[u]<=a;u+=2)l=u;l&&n.splice(0,l+1)}}}const phe={url:"",deserializer:i=>JSON.parse(i.data),serializer:i=>JSON.stringify(i)};class nH extends mr{constructor(t,e){if(super(),this._socket=null,t instanceof ft)this.destination=e,this.source=t;else{const n=this._config=Object.assign({},phe);if(this._output=new ii,"string"==typeof t)n.url=t;else for(const r in t)t.hasOwnProperty(r)&&(n[r]=t[r]);if(!n.WebSocketCtor&&WebSocket)n.WebSocketCtor=WebSocket;else if(!n.WebSocketCtor)throw new Error("no WebSocket constructor can be found");this.destination=new iH}}lift(t){const e=new nH(this._config,this.destination);return e.operator=t,e.source=this,e}_resetState(){this._socket=null,this.source||(this.destination=new iH),this._output=new ii}multiplex(t,e,n){const r=this;return new ft(s=>{try{r.next(t())}catch(l){s.error(l)}const a=r.subscribe({next:l=>{try{n(l)&&s.next(l)}catch(u){s.error(u)}},error:l=>s.error(l),complete:()=>s.complete()});return()=>{try{r.next(e())}catch(l){s.error(l)}a.unsubscribe()}})}_connectSocket(){const{WebSocketCtor:t,protocol:e,url:n,binaryType:r}=this._config,s=this._output;let a=null;try{a=e?new t(n,e):new t(n),this._socket=a,r&&(this._socket.binaryType=r)}catch(u){return void s.error(u)}const l=new Q(()=>{this._socket=null,a&&1===a.readyState&&a.close()});a.onopen=u=>{const{_socket:h}=this;if(!h)return a.close(),void this._resetState();const{openObserver:m}=this._config;m&&m.next(u);const _=this.destination;this.destination=dt.create(v=>{if(1===a.readyState)try{const{serializer:S}=this._config;a.send(S(v))}catch(S){this.destination.error(S)}},v=>{const{closingObserver:S}=this._config;S&&S.next(void 0),v&&v.code?a.close(v.code,v.reason):s.error(new TypeError("WebSocketSubject.error must be called with an object with an error code, and an optional reason: { code: number, reason: string }")),this._resetState()},()=>{const{closingObserver:v}=this._config;v&&v.next(void 0),a.close(),this._resetState()}),_&&_ instanceof iH&&l.add(_.subscribe(this.destination))},a.onerror=u=>{this._resetState(),s.error(u)},a.onclose=u=>{a===this._socket&&this._resetState();const{closeObserver:h}=this._config;h&&h.next(u),u.wasClean?s.complete():s.error(u)},a.onmessage=u=>{try{const{deserializer:h}=this._config;s.next(h(u))}catch(h){s.error(h)}}}_subscribe(t){const{source:e}=this;return e?e.subscribe(t):(this._socket||this._connectSocket(),this._output.subscribe(t),t.add(()=>{const{_socket:n}=this;0===this._output.observers.length&&(n&&(1===n.readyState||0===n.readyState)&&n.close(),this._resetState())}),t)}unsubscribe(){const{_socket:t}=this;t&&(1===t.readyState||0===t.readyState)&&t.close(),this._resetState(),super.unsubscribe()}}function wj(i){return new nH(i)}let iP=(()=>{class i extends gs{constructor(e,n){super(null),this._configService=e,this._snackbar=n,this._configService.configAsObservable.pipe(vr(r=>null!=r.cineastEndpointWs)).subscribe(r=>this.connect(r))}reconnect(e=!0){e&&this._snackbar.open("Reconnecting to Cineast","Dismiss",{duration:2e3}),null!=this.getValue()&&(console.log("disconnecting to reconnect"),this.getValue().complete()),this.next(wj({url:this._config.cineastEndpointWs,openObserver:{next:a=>{console.log(`WebSocket connected to Cineast (${this._config.cineastEndpointWs}).`)}},closeObserver:{next:a=>{console.log(`WebSocket disconnected from Cineast (${this._config.cineastEndpointWs}, Code: ${a.code}).`)}},serializer:a=>JSON.stringify(a,(l,u)=>{if(!l.startsWith("_"))return u})}))}connect(e){if(this._config&&this._config.cineastEndpointWs===e.cineastEndpointWs)return!1;this._config=e,this.reconnect(!1)}}return i.\u0275fac=function(e){return new(e||i)(Ve(dr),Ve(Ru))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})();class ghe{constructor(t,e,n=null){this.segmentId=t,this.config=e,this.metadataAccessSpec=n,this.messageType="Q_SEG"}}class _he{constructor(t,e=null){this.stages=t,this.config=e}}class ao{constructor(t,e=new Map){this.type=t,this.context=e}}var fr=(()=>{return(i=fr||(fr={}))[i.QUERY_IMAGE=0]="QUERY_IMAGE",i[i.QUERY_AUDIO=1]="QUERY_AUDIO",i[i.QUERY_MOTION=2]="QUERY_MOTION",i[i.QUERY_MODEL3D=3]="QUERY_MODEL3D",i[i.QUERY_FULLTEXT=4]="QUERY_FULLTEXT",i[i.QUERY_TAG=5]="QUERY_TAG",i[i.QUERY_SEMANTIC=6]="QUERY_SEMANTIC",i[i.QUERY_BOOLEAN=7]="QUERY_BOOLEAN",i[i.MLT=8]="MLT",i[i.CLEAR=9]="CLEAR",i[i.REFINE=10]="REFINE",i[i.FILTER=11]="FILTER",i[i.HIGHLIGHT=12]="HIGHLIGHT",i[i.SCROLL=13]="SCROLL",i[i.EXPAND=14]="EXPAND",i[i.EXAMINE=15]="EXAMINE",i[i.PLAY=16]="PLAY",i[i.NAVIGATE=17]="NAVIGATE",i[i.NEW_QUERY_STAGE=18]="NEW_QUERY_STAGE",i[i.NEW_QUERY_CONTAINER=19]="NEW_QUERY_CONTAINER",i[i.LOAD_FEATURES=20]="LOAD_FEATURES",fr;var i})();class ia{constructor(...t){this._components=[],this._timestamp=Date.now(),t.forEach(e=>this._components.push(e))}get components(){return this._components}get timestamp(){return this._timestamp}}class eg{encodeKey(t){return encodeURIComponent(t)}encodeValue(t){return encodeURIComponent(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}const tg=new gi("basePath");class Kl{constructor(t={}){this.apiKeys=t.apiKeys,this.username=t.username,this.password=t.password,this.accessToken=t.accessToken,this.basePath=t.basePath,this.withCredentials=t.withCredentials,this.encoder=t.encoder,this.credentials=t.credentials?t.credentials:{}}selectHeaderContentType(t){if(0===t.length)return;const e=t.find(n=>this.isJsonMime(n));return void 0===e?t[0]:e}selectHeaderAccept(t){if(0===t.length)return;const e=t.find(n=>this.isJsonMime(n));return void 0===e?t[0]:e}isJsonMime(t){const e=new RegExp("^(application/json|[^;/ \t]+/[^;/ \t]+[+]json)[ \t]*(;.*)?$","i");return null!==t&&(e.test(t)||"application/json-patch+json"===t.toLowerCase())}lookupCredential(t){const e=this.credentials[t];return"function"==typeof e?e():e}}let Kb=(()=>{class i{constructor(e,n,r){this.httpClient=e,this.basePath="http://localhost",this.defaultHeaders=new Pa,this.configuration=new Kl,r&&(this.configuration=r),"string"!=typeof this.configuration.basePath&&("string"!=typeof n&&(n=this.basePath),this.configuration.basePath=n),this.encoder=this.configuration.encoder||new eg}addToHttpParams(e,n,r){return"object"!=typeof n||n instanceof Date?this.addToHttpParamsRecursive(e,n,r):this.addToHttpParamsRecursive(e,n)}addToHttpParamsRecursive(e,n,r){if(null==n)return e;if("object"==typeof n)if(Array.isArray(n))n.forEach(s=>e=this.addToHttpParamsRecursive(e,s,r));else if(n instanceof Date){if(null==r)throw Error("key may not be null if value is Date");e=e.append(r,n.toISOString().substr(0,10))}else Object.keys(n).forEach(s=>e=this.addToHttpParamsRecursive(e,n[s],null!=r?`${r}.${s}`:s));else{if(null==r)throw Error("key may not be null if value is not object or array");e=e.append(r,n)}return e}findFeaturesByCategory(e,n,r="body",s=!1,a){if(null==e)throw new Error("Required parameter category was null or undefined when calling findFeaturesByCategory.");let l=this.defaultHeaders,u=a&&a.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(l=l.set("Accept",u));let h=a&&a.context;void 0===h&&(h=new Fr);const _=this.configuration.selectHeaderContentType(["application/json"]);void 0!==_&&(l=l.set("Content-Type",_));let v="json";return u&&(v=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.post(`${this.configuration.basePath}/api/v1/find/feature/all/by/category/${encodeURIComponent(String(e))}`,n,{context:h,responseType:v,withCredentials:this.configuration.withCredentials,headers:l,observe:r,reportProgress:s})}findFeaturesByEntity(e,n,r="body",s=!1,a){if(null==e)throw new Error("Required parameter entity was null or undefined when calling findFeaturesByEntity.");let l=this.defaultHeaders,u=a&&a.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(l=l.set("Accept",u));let h=a&&a.context;void 0===h&&(h=new Fr);const _=this.configuration.selectHeaderContentType(["application/json"]);void 0!==_&&(l=l.set("Content-Type",_));let v="json";return u&&(v=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.post(`${this.configuration.basePath}/api/v1/find/feature/all/by/entity/${encodeURIComponent(String(e))}`,n,{context:h,responseType:v,withCredentials:this.configuration.withCredentials,headers:l,observe:r,reportProgress:s})}findMetaById(e,n="body",r=!1,s){if(null==e)throw new Error("Required parameter id was null or undefined when calling findMetaById.");let a=this.defaultHeaders,l=s&&s.httpHeaderAccept;void 0===l&&(l=this.configuration.selectHeaderAccept(["application/json"])),void 0!==l&&(a=a.set("Accept",l));let u=s&&s.context;void 0===u&&(u=new Fr);let h="json";return l&&(h=l.startsWith("text")?"text":this.configuration.isJsonMime(l)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/api/v1/find/metadata/by/id/${encodeURIComponent(String(e))}`,{context:u,responseType:h,withCredentials:this.configuration.withCredentials,headers:a,observe:n,reportProgress:r})}findMetaFullyQualified(e,n,r,s="body",a=!1,l){if(null==e)throw new Error("Required parameter id was null or undefined when calling findMetaFullyQualified.");if(null==n)throw new Error("Required parameter domain was null or undefined when calling findMetaFullyQualified.");if(null==r)throw new Error("Required parameter key was null or undefined when calling findMetaFullyQualified.");let u=this.defaultHeaders,h=l&&l.httpHeaderAccept;void 0===h&&(h=this.configuration.selectHeaderAccept(["application/json"])),void 0!==h&&(u=u.set("Accept",h));let m=l&&l.context;void 0===m&&(m=new Fr);let _="json";return h&&(_=h.startsWith("text")?"text":this.configuration.isJsonMime(h)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/api/v1/find/metadata/of/${encodeURIComponent(String(e))}/in/${encodeURIComponent(String(n))}/with/${encodeURIComponent(String(r))}`,{context:m,responseType:_,withCredentials:this.configuration.withCredentials,headers:u,observe:s,reportProgress:a})}findMetadataByDomain(e,n,r="body",s=!1,a){if(null==e)throw new Error("Required parameter domain was null or undefined when calling findMetadataByDomain.");if(null==n)throw new Error("Required parameter id was null or undefined when calling findMetadataByDomain.");let l=this.defaultHeaders,u=a&&a.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(l=l.set("Accept",u));let h=a&&a.context;void 0===h&&(h=new Fr);let m="json";return u&&(m=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/api/v1/find/metadata/in/${encodeURIComponent(String(e))}/by/id/${encodeURIComponent(String(n))}`,{context:h,responseType:m,withCredentials:this.configuration.withCredentials,headers:l,observe:r,reportProgress:s})}findMetadataByDomainBatched(e,n,r="body",s=!1,a){if(null==e)throw new Error("Required parameter domain was null or undefined when calling findMetadataByDomainBatched.");let l=this.defaultHeaders,u=a&&a.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(l=l.set("Accept",u));let h=a&&a.context;void 0===h&&(h=new Fr);const _=this.configuration.selectHeaderContentType(["application/json"]);void 0!==_&&(l=l.set("Content-Type",_));let v="json";return u&&(v=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.post(`${this.configuration.basePath}/api/v1/find/metadata/in/${encodeURIComponent(String(e))}`,n,{context:h,responseType:v,withCredentials:this.configuration.withCredentials,headers:l,observe:r,reportProgress:s})}findMetadataByKey(e,n,r="body",s=!1,a){if(null==e)throw new Error("Required parameter key was null or undefined when calling findMetadataByKey.");if(null==n)throw new Error("Required parameter id was null or undefined when calling findMetadataByKey.");let l=this.defaultHeaders,u=a&&a.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(l=l.set("Accept",u));let h=a&&a.context;void 0===h&&(h=new Fr);let m="json";return u&&(m=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/api/v1/find/metadata/with/${encodeURIComponent(String(e))}/by/id/${encodeURIComponent(String(n))}`,{context:h,responseType:m,withCredentials:this.configuration.withCredentials,headers:l,observe:r,reportProgress:s})}findMetadataByKeyBatched(e,n,r="body",s=!1,a){if(null==e)throw new Error("Required parameter key was null or undefined when calling findMetadataByKeyBatched.");let l=this.defaultHeaders,u=a&&a.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(l=l.set("Accept",u));let h=a&&a.context;void 0===h&&(h=new Fr);const _=this.configuration.selectHeaderContentType(["application/json"]);void 0!==_&&(l=l.set("Content-Type",_));let v="json";return u&&(v=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.post(`${this.configuration.basePath}/api/v1/find/metadata/with/${encodeURIComponent(String(e))}`,n,{context:h,responseType:v,withCredentials:this.configuration.withCredentials,headers:l,observe:r,reportProgress:s})}findMetadataForObjectIdBatched(e,n="body",r=!1,s){let a=this.defaultHeaders,l=s&&s.httpHeaderAccept;void 0===l&&(l=this.configuration.selectHeaderAccept(["application/json"])),void 0!==l&&(a=a.set("Accept",l));let u=s&&s.context;void 0===u&&(u=new Fr);const m=this.configuration.selectHeaderContentType(["application/json"]);void 0!==m&&(a=a.set("Content-Type",m));let _="json";return l&&(_=l.startsWith("text")?"text":this.configuration.isJsonMime(l)?"json":"blob"),this.httpClient.post(`${this.configuration.basePath}/api/v1/find/metadata/by/id`,e,{context:u,responseType:_,withCredentials:this.configuration.withCredentials,headers:a,observe:n,reportProgress:r})}findSegFeatById(e,n="body",r=!1,s){if(null==e)throw new Error("Required parameter id was null or undefined when calling findSegFeatById.");let a=this.defaultHeaders,l=s&&s.httpHeaderAccept;void 0===l&&(l=this.configuration.selectHeaderAccept(["application/json"])),void 0!==l&&(a=a.set("Accept",l));let u=s&&s.context;void 0===u&&(u=new Fr);let h="json";return l&&(h=l.startsWith("text")?"text":this.configuration.isJsonMime(l)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/api/v1/find/feature/all/by/id/${encodeURIComponent(String(e))}`,{context:u,responseType:h,withCredentials:this.configuration.withCredentials,headers:a,observe:n,reportProgress:r})}findSegMetaById(e,n="body",r=!1,s){if(null==e)throw new Error("Required parameter id was null or undefined when calling findSegMetaById.");let a=this.defaultHeaders,l=s&&s.httpHeaderAccept;void 0===l&&(l=this.configuration.selectHeaderAccept(["application/json"])),void 0!==l&&(a=a.set("Accept",l));let u=s&&s.context;void 0===u&&(u=new Fr);let h="json";return l&&(h=l.startsWith("text")?"text":this.configuration.isJsonMime(l)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/api/v1/find/metadata/by/segmentid/${encodeURIComponent(String(e))}`,{context:u,responseType:h,withCredentials:this.configuration.withCredentials,headers:a,observe:n,reportProgress:r})}findTagInformationById(e,n="body",r=!1,s){if(null==e)throw new Error("Required parameter id was null or undefined when calling findTagInformationById.");let a=this.defaultHeaders,l=s&&s.httpHeaderAccept;void 0===l&&(l=this.configuration.selectHeaderAccept(["application/json"])),void 0!==l&&(a=a.set("Accept",l));let u=s&&s.context;void 0===u&&(u=new Fr);let h="json";return l&&(h=l.startsWith("text")?"text":this.configuration.isJsonMime(l)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/api/v1/find/feature/tags/by/id/${encodeURIComponent(String(e))}`,{context:u,responseType:h,withCredentials:this.configuration.withCredentials,headers:a,observe:n,reportProgress:r})}findTextByIDAndCat(e,n,r="body",s=!1,a){if(null==e)throw new Error("Required parameter id was null or undefined when calling findTextByIDAndCat.");if(null==n)throw new Error("Required parameter category was null or undefined when calling findTextByIDAndCat.");let l=this.defaultHeaders,u=a&&a.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(l=l.set("Accept",u));let h=a&&a.context;void 0===h&&(h=new Fr);let m="json";return u&&(m=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/api/v1/find/feature/text/by/${encodeURIComponent(String(e))}/${encodeURIComponent(String(n))}`,{context:h,responseType:m,withCredentials:this.configuration.withCredentials,headers:l,observe:r,reportProgress:s})}}return i.\u0275fac=function(e){return new(e||i)(Ve(ma),Ve(tg,8),Ve(Kl,8))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),nP=(()=>{class i{constructor(e,n,r){this.httpClient=e,this.basePath="http://localhost",this.defaultHeaders=new Pa,this.configuration=new Kl,r&&(this.configuration=r),"string"!=typeof this.configuration.basePath&&("string"!=typeof n&&(n=this.basePath),this.configuration.basePath=n),this.encoder=this.configuration.encoder||new eg}addToHttpParams(e,n,r){return"object"!=typeof n||n instanceof Date?this.addToHttpParamsRecursive(e,n,r):this.addToHttpParamsRecursive(e,n)}addToHttpParamsRecursive(e,n,r){if(null==n)return e;if("object"==typeof n)if(Array.isArray(n))n.forEach(s=>e=this.addToHttpParamsRecursive(e,s,r));else if(n instanceof Date){if(null==r)throw Error("key may not be null if value is Date");e=e.append(r,n.toISOString().substr(0,10))}else Object.keys(n).forEach(s=>e=this.addToHttpParamsRecursive(e,n[s],null!=r?`${r}.${s}`:s));else{if(null==r)throw Error("key may not be null if value is not object or array");e=e.append(r,n)}return e}countRows(e,n="body",r=!1,s){if(null==e)throw new Error("Required parameter table was null or undefined when calling countRows.");let a=this.defaultHeaders,l=s&&s.httpHeaderAccept;void 0===l&&(l=this.configuration.selectHeaderAccept(["application/json"])),void 0!==l&&(a=a.set("Accept",l));let u=s&&s.context;void 0===u&&(u=new Fr);let h="json";return l&&(h=l.startsWith("text")?"text":this.configuration.isJsonMime(l)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/api/v1/count/table/${encodeURIComponent(String(e))}`,{context:u,responseType:h,withCredentials:this.configuration.withCredentials,headers:a,observe:n,reportProgress:r})}findDistinctElementsByColumn(e,n="body",r=!1,s){let a=this.defaultHeaders,l=s&&s.httpHeaderAccept;void 0===l&&(l=this.configuration.selectHeaderAccept(["application/json"])),void 0!==l&&(a=a.set("Accept",l));let u=s&&s.context;void 0===u&&(u=new Fr);const m=this.configuration.selectHeaderContentType(["application/json"]);void 0!==m&&(a=a.set("Content-Type",m));let _="json";return l&&(_=l.startsWith("text")?"text":this.configuration.isJsonMime(l)?"json":"blob"),this.httpClient.post(`${this.configuration.basePath}/api/v1/find/boolean/column/distinct`,e,{context:u,responseType:_,withCredentials:this.configuration.withCredentials,headers:a,observe:n,reportProgress:r})}selectFromTable(e,n="body",r=!1,s){let a=this.defaultHeaders,l=s&&s.httpHeaderAccept;void 0===l&&(l=this.configuration.selectHeaderAccept(["application/json"])),void 0!==l&&(a=a.set("Accept",l));let u=s&&s.context;void 0===u&&(u=new Fr);const m=this.configuration.selectHeaderContentType(["application/json"]);void 0!==m&&(a=a.set("Content-Type",m));let _="json";return l&&(_=l.startsWith("text")?"text":this.configuration.isJsonMime(l)?"json":"blob"),this.httpClient.post(`${this.configuration.basePath}/api/v1/find/boolean/table/select`,e,{context:u,responseType:_,withCredentials:this.configuration.withCredentials,headers:a,observe:n,reportProgress:r})}}return i.\u0275fac=function(e){return new(e||i)(Ve(ma),Ve(tg,8),Ve(Kl,8))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),rP=(()=>{class i{constructor(e,n,r){this.httpClient=e,this.basePath="http://localhost",this.defaultHeaders=new Pa,this.configuration=new Kl,r&&(this.configuration=r),"string"!=typeof this.configuration.basePath&&("string"!=typeof n&&(n=this.basePath),this.configuration.basePath=n),this.encoder=this.configuration.encoder||new eg}addToHttpParams(e,n,r){return"object"!=typeof n||n instanceof Date?this.addToHttpParamsRecursive(e,n,r):this.addToHttpParamsRecursive(e,n)}addToHttpParamsRecursive(e,n,r){if(null==n)return e;if("object"==typeof n)if(Array.isArray(n))n.forEach(s=>e=this.addToHttpParamsRecursive(e,s,r));else if(n instanceof Date){if(null==r)throw Error("key may not be null if value is Date");e=e.append(r,n.toISOString().substr(0,10))}else Object.keys(n).forEach(s=>e=this.addToHttpParamsRecursive(e,n[s],null!=r?`${r}.${s}`:s));else{if(null==r)throw Error("key may not be null if value is not object or array");e=e.append(r,n)}return e}findObjectsAll(e="body",n=!1,r){let s=this.defaultHeaders,a=r&&r.httpHeaderAccept;void 0===a&&(a=this.configuration.selectHeaderAccept(["application/json"])),void 0!==a&&(s=s.set("Accept",a));let l=r&&r.context;void 0===l&&(l=new Fr);let u="json";return a&&(u=a.startsWith("text")?"text":this.configuration.isJsonMime(a)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/api/v1/find/objects/all`,{context:l,responseType:u,withCredentials:this.configuration.withCredentials,headers:s,observe:e,reportProgress:n})}findObjectsByAttribute(e,n,r="body",s=!1,a){if(null==e)throw new Error("Required parameter attribute was null or undefined when calling findObjectsByAttribute.");if(null==n)throw new Error("Required parameter value was null or undefined when calling findObjectsByAttribute.");let l=this.defaultHeaders,u=a&&a.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(l=l.set("Accept",u));let h=a&&a.context;void 0===h&&(h=new Fr);let m="json";return u&&(m=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/api/v1/find/object/by/${encodeURIComponent(String(e))}/${encodeURIComponent(String(n))}`,{context:h,responseType:m,withCredentials:this.configuration.withCredentials,headers:l,observe:r,reportProgress:s})}findObjectsByIdBatched(e,n="body",r=!1,s){let a=this.defaultHeaders,l=s&&s.httpHeaderAccept;void 0===l&&(l=this.configuration.selectHeaderAccept(["application/json"])),void 0!==l&&(a=a.set("Accept",l));let u=s&&s.context;void 0===u&&(u=new Fr);const m=this.configuration.selectHeaderContentType(["application/json"]);void 0!==m&&(a=a.set("Content-Type",m));let _="json";return l&&(_=l.startsWith("text")?"text":this.configuration.isJsonMime(l)?"json":"blob"),this.httpClient.post(`${this.configuration.basePath}/api/v1/find/object/by/id`,e,{context:u,responseType:_,withCredentials:this.configuration.withCredentials,headers:a,observe:n,reportProgress:r})}findObjectsPagination(e,n,r="body",s=!1,a){if(null==e)throw new Error("Required parameter skip was null or undefined when calling findObjectsPagination.");if(null==n)throw new Error("Required parameter limit was null or undefined when calling findObjectsPagination.");let l=this.defaultHeaders,u=a&&a.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(l=l.set("Accept",u));let h=a&&a.context;void 0===h&&(h=new Fr);let m="json";return u&&(m=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/api/v1/find/object/all/${encodeURIComponent(String(e))}/${encodeURIComponent(String(n))}`,{context:h,responseType:m,withCredentials:this.configuration.withCredentials,headers:l,observe:r,reportProgress:s})}}return i.\u0275fac=function(e){return new(e||i)(Ve(ma),Ve(tg,8),Ve(Kl,8))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),rH=(()=>{class i{constructor(e,n,r){this.httpClient=e,this.basePath="http://localhost",this.defaultHeaders=new Pa,this.configuration=new Kl,r&&(this.configuration=r),"string"!=typeof this.configuration.basePath&&("string"!=typeof n&&(n=this.basePath),this.configuration.basePath=n),this.encoder=this.configuration.encoder||new eg}addToHttpParams(e,n,r){return"object"!=typeof n||n instanceof Date?this.addToHttpParamsRecursive(e,n,r):this.addToHttpParamsRecursive(e,n)}addToHttpParamsRecursive(e,n,r){if(null==n)return e;if("object"==typeof n)if(Array.isArray(n))n.forEach(s=>e=this.addToHttpParamsRecursive(e,s,r));else if(n instanceof Date){if(null==r)throw Error("key may not be null if value is Date");e=e.append(r,n.toISOString().substr(0,10))}else Object.keys(n).forEach(s=>e=this.addToHttpParamsRecursive(e,n[s],null!=r?`${r}.${s}`:s));else{if(null==r)throw Error("key may not be null if value is not object or array");e=e.append(r,n)}return e}findSegmentById(e,n="body",r=!1,s){if(null==e)throw new Error("Required parameter id was null or undefined when calling findSegmentById.");let a=this.defaultHeaders,l=s&&s.httpHeaderAccept;void 0===l&&(l=this.configuration.selectHeaderAccept(["application/json"])),void 0!==l&&(a=a.set("Accept",l));let u=s&&s.context;void 0===u&&(u=new Fr);let h="json";return l&&(h=l.startsWith("text")?"text":this.configuration.isJsonMime(l)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/api/v1/find/segments/by/id/${encodeURIComponent(String(e))}`,{context:u,responseType:h,withCredentials:this.configuration.withCredentials,headers:a,observe:n,reportProgress:r})}findSegmentByIdBatched(e,n="body",r=!1,s){let a=this.defaultHeaders,l=s&&s.httpHeaderAccept;void 0===l&&(l=this.configuration.selectHeaderAccept(["application/json"])),void 0!==l&&(a=a.set("Accept",l));let u=s&&s.context;void 0===u&&(u=new Fr);const m=this.configuration.selectHeaderContentType(["application/json"]);void 0!==m&&(a=a.set("Content-Type",m));let _="json";return l&&(_=l.startsWith("text")?"text":this.configuration.isJsonMime(l)?"json":"blob"),this.httpClient.post(`${this.configuration.basePath}/api/v1/find/segments/by/id`,e,{context:u,responseType:_,withCredentials:this.configuration.withCredentials,headers:a,observe:n,reportProgress:r})}findSegmentByObjectId(e,n="body",r=!1,s){if(null==e)throw new Error("Required parameter id was null or undefined when calling findSegmentByObjectId.");let a=this.defaultHeaders,l=s&&s.httpHeaderAccept;void 0===l&&(l=this.configuration.selectHeaderAccept(["application/json"])),void 0!==l&&(a=a.set("Accept",l));let u=s&&s.context;void 0===u&&(u=new Fr);let h="json";return l&&(h=l.startsWith("text")?"text":this.configuration.isJsonMime(l)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/api/v1/find/segments/all/object/${encodeURIComponent(String(e))}`,{context:u,responseType:h,withCredentials:this.configuration.withCredentials,headers:a,observe:n,reportProgress:r})}}return i.\u0275fac=function(e){return new(e||i)(Ve(ma),Ve(tg,8),Ve(Kl,8))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),sP=(()=>{class i{constructor(e,n,r){this.httpClient=e,this.basePath="http://localhost",this.defaultHeaders=new Pa,this.configuration=new Kl,r&&(this.configuration=r),"string"!=typeof this.configuration.basePath&&("string"!=typeof n&&(n=this.basePath),this.configuration.basePath=n),this.encoder=this.configuration.encoder||new eg}addToHttpParams(e,n,r){return"object"!=typeof n||n instanceof Date?this.addToHttpParamsRecursive(e,n,r):this.addToHttpParamsRecursive(e,n)}addToHttpParamsRecursive(e,n,r){if(null==n)return e;if("object"==typeof n)if(Array.isArray(n))n.forEach(s=>e=this.addToHttpParamsRecursive(e,s,r));else if(n instanceof Date){if(null==r)throw Error("key may not be null if value is Date");e=e.append(r,n.toISOString().substr(0,10))}else Object.keys(n).forEach(s=>e=this.addToHttpParamsRecursive(e,n[s],null!=r?`${r}.${s}`:s));else{if(null==r)throw Error("key may not be null if value is not object or array");e=e.append(r,n)}return e}findAllTags(e="body",n=!1,r){let s=this.defaultHeaders,a=r&&r.httpHeaderAccept;void 0===a&&(a=this.configuration.selectHeaderAccept(["application/json"])),void 0!==a&&(s=s.set("Accept",a));let l=r&&r.context;void 0===l&&(l=new Fr);let u="json";return a&&(u=a.startsWith("text")?"text":this.configuration.isJsonMime(a)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/api/v1/find/tags/all`,{context:l,responseType:u,withCredentials:this.configuration.withCredentials,headers:s,observe:e,reportProgress:n})}findTagsBy(e,n,r="body",s=!1,a){if(null==e)throw new Error("Required parameter attribute was null or undefined when calling findTagsBy.");if(null==n)throw new Error("Required parameter value was null or undefined when calling findTagsBy.");let l=this.defaultHeaders,u=a&&a.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(l=l.set("Accept",u));let h=a&&a.context;void 0===h&&(h=new Fr);let m="json";return u&&(m=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/api/v1/find/tags/by/${encodeURIComponent(String(e))}/${encodeURIComponent(String(n))}`,{context:h,responseType:m,withCredentials:this.configuration.withCredentials,headers:l,observe:r,reportProgress:s})}findTagsById(e,n="body",r=!1,s){let a=this.defaultHeaders,l=s&&s.httpHeaderAccept;void 0===l&&(l=this.configuration.selectHeaderAccept(["application/json"])),void 0!==l&&(a=a.set("Accept",l));let u=s&&s.context;void 0===u&&(u=new Fr);const m=this.configuration.selectHeaderContentType(["application/json"]);void 0!==m&&(a=a.set("Content-Type",m));let _="json";return l&&(_=l.startsWith("text")?"text":this.configuration.isJsonMime(l)?"json":"blob"),this.httpClient.post(`${this.configuration.basePath}/api/v1/tags/by/id`,e,{context:u,responseType:_,withCredentials:this.configuration.withCredentials,headers:a,observe:n,reportProgress:r})}}return i.\u0275fac=function(e){return new(e||i)(Ve(ma),Ve(tg,8),Ve(Kl,8))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var Kd=(()=>((Kd||(Kd={})).MediatypeEnum={Video:"VIDEO",Image:"IMAGE",Audio:"AUDIO",Model3D:"MODEL3D",ImageSequence:"IMAGE_SEQUENCE",Unknown:"UNKNOWN"},Kd))(),El=(()=>((El||(El={})).TypeEnum={Image:"IMAGE",Audio:"AUDIO",Model3D:"MODEL3D",Location:"LOCATION",ParameterisedLocation:"PARAMETERISED_LOCATION",Time:"TIME",Text:"TEXT",Tag:"TAG",Semantic:"SEMANTIC",Skeleton:"SKELETON",Id:"ID",Boolean:"BOOLEAN"},El))(),oP=(()=>((oP||(oP={})).PriorityEnum={Request:"REQUEST",Require:"REQUIRE",Exclude:"EXCLUDE"},oP))();let Sj=(()=>{class i{constructor(e,n){if(e)throw new Error("ApiModule is already loaded. Import in your base AppModule only.");if(!n)throw new Error("You need to import the HttpClientModule in your AppModule! \nSee also https://github.com/angular/angular/issues/20575")}static forRoot(e){return{ngModule:i,providers:[{provide:Kl,useFactory:e}]}}}return i.\u0275fac=function(e){return new(e||i)(Ve(i,12),Ve(ma,8))},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({providers:[],imports:[[]]}),i})();class whe{constructor(t,e=null,n){this.queries=t,this.config=e,this.metadataAccessSpec=n,this.messageType="Q_TEMPORAL"}}class She{constructor(t=null,e=[],n=[],r=-1){this.queryId=t,this.hints=e,this.timeDistances=n,this.maxLength=r}}let Zc=(()=>{class i{constructor(){this._bus=new ii,this._currentView=new gs(null),this._lastQuery=new gs(null)}publish(e){this._bus.next(e),e.components[0]&&e.components[0].type===fr.NAVIGATE&&this._currentView.next(e.components[0].context.get("n:component")),e.components.filter(n=>n.context.has("q:categories")).length>0&&this._lastQuery.next(e)}currentView(){return this._currentView.asObservable()}lastQueryInteractionEvent(){return this._lastQuery.getValue()}observable(){return this._bus.asObservable()}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})(),Rc=(()=>{class i{constructor(e,n,r,s){this._history=e,this._config=r,this._eventBusService=s,this._subject=new ii,this._interval_map=new Map,this._running=0,this._lastQuery=null,n.asObservable().pipe(vr(a=>null!=a)).subscribe(a=>{this._socket=a,this._socket.pipe(vr(l=>["QR_START","QR_END","QR_ERROR","QR_SIMILARITY","QR_OBJECT","QR_SEGMENT","QR_TEMPORAL","QR_METADATA_S","QR_METADATA_O"].indexOf(l.messageType)>-1)).subscribe(l=>this.onApiMessage(l))}),this._config.configAsObservable.subscribe(a=>{this._scoreFunction=a.get("query.scoreFunction"),this._results&&this._results.setScoreFunction(this._scoreFunction)})}get results(){return this._results}get running(){return this._running>0}get observable(){return this._subject.asObservable()}findTemporal(e,n,r){if(!this._socket)return console.warn("No socket available, not executing temporal query"),!1;this._running>0&&console.warn("There is already a query running");const s=new whe(e.map(l=>new _he(l.stages,null)),new She(null,[],n,r),this._config.config.metadataAccessSpec);this._lastQuery=s,this._socket.next(s);const a=[];e.forEach(l=>{a.push(new ao(fr.NEW_QUERY_CONTAINER)),l.stages.forEach(u=>{a.push(new ao(fr.NEW_QUERY_STAGE)),u.terms.forEach(h=>{const m=new Map;switch(m.set("q:categories",h.categories),m.set("q:value","null"),h.type){case"IMAGE":return void a.push(new ao(fr.QUERY_IMAGE,m));case"AUDIO":return void a.push(new ao(fr.QUERY_AUDIO,m));case"MODEL3D":return void a.push(new ao(fr.QUERY_MODEL3D,m));case"SEMANTIC":return void a.push(new ao(fr.QUERY_SEMANTIC,m));case"TEXT":return m.set("q:value",h.data),void a.push(new ao(fr.QUERY_FULLTEXT,m));case"BOOLEAN":return m.set("q:value",h.terms),void a.push(new ao(fr.QUERY_BOOLEAN,m));case"TAG":return m.set("q:value",h.tags),void a.push(new ao(fr.QUERY_TAG,m))}})})}),this._eventBusService.publish(new ia(...a))}findMoreLikeThis(e,n,r=[]){if(this._running>0)return console.log("an mlt query is already running, cannot perform mlt"),!1;if(!this._socket)return console.log("no socket available, cannot perform mlt"),!1;if(!e)return console.log("segment undefined, cannot perform mlt"),!1;if(!n)return console.log(`no mediatype specified for segment ${e.segmentId}, cannot perform mlt`),!1;const s=new Map;s.set("q:value",e.segmentId),this._eventBusService.publish(new ia(new ao(fr.MLT,s)));const a=this._config.config,l=a.get(`mlt.${n}`);if(!l)return console.log("no mlt categories available. printing first config, then segment"),console.log(a),void console.log(e);if(l.filter(u=>-1===r.indexOf(u)).forEach(u=>r.push(u)),r.length>0){const u=new lhe(e.segmentId,r,{},a.metadataAccessSpec);this._lastQuery=u,this._socket.next(u)}return!0}lookupNeighboringSegments(e,n){const r=new Map;return r.set("i:mediasegment",e),this._eventBusService.publish(new ia(new ao(fr.EXPAND,r))),this._results?this._socket?(this._socket.next(new fhe(e,{queryId:this.results.queryId},n,this._config.config.metadataAccessSpec)),!0):(console.log("no socket, not looking up neighboring segments"),!1):(console.log("no results, not looking up neighboring segments"),!1)}lookupSegment(e){return!(!this._results||!this._socket||(this._socket.next(new ghe(e,{queryId:this.results.queryId},this._config.config.metadataAccessSpec)),0))}load(e){if(this._running>0)return!1;const n=iS.deserialize(e.results);n&&(this._results=n,this._scoreFunction&&this._results.setScoreFunction(this._scoreFunction),this._subject.next("STARTED"),this._subject.next("ENDED"))}clear(){this._running&&(this._subject.next("ENDED"),this._running=0),this._results&&(this._results.complete(),this._results=null),this._subject.next("CLEAR")}onApiMessage(e){switch(e.messageType){case"QR_START":const n=e;console.time(`Query (${n.queryId})`),this.startNewQuery(n.queryId);break;case"QR_OBJECT":const r=e;this._results&&this._results.processObjectMessage(r)&&this._subject.next("UPDATED");break;case"QR_SEGMENT":const s=e;this._results&&this._results.processSegmentMessage(s)&&this._subject.next("UPDATED");break;case"QR_SIMILARITY":const a=e;this._results&&this._results.processSimilarityMessage(a)&&this._subject.next("UPDATED");break;case"QR_TEMPORAL":const l=e;this._results&&this._results.processTemporalMessage(l)&&this._subject.next("UPDATED");break;case"QR_METADATA_S":const u=e;this._results&&this._results.processSegmentMetadataMessage(u)&&this._subject.next("UPDATED");break;case"QR_METADATA_O":const h=e;this._results&&this._results.processObjectMetadataMessage(h)&&this._subject.next("UPDATED");break;case"QR_ERROR":console.timeEnd(`Query (${e.queryId})`),this.errorOccurred(e);break;case"QR_END":console.timeEnd(`Query (${e.queryId})`),this.finalizeQuery(e.queryId)}}startNewQuery(e){console.debug("received QR_START"),(!this._results||this._results&&this._results.queryId!==e)&&(this._results=new iS(e),this._interval_map.set(e,window.setInterval(()=>this._results.checkUpdate(),2500)),this._scoreFunction&&this._results.setScoreFunction(this._scoreFunction)),this._running+=1,this._subject.next("STARTED")}finalizeQuery(e){window.clearInterval(this._interval_map.get(e)),this._interval_map.delete(e),this._results.doUpdate(),this._running-=1,this._subject.next("ENDED"),this._results.segmentCount>0&&this._history.append(this._results)}errorOccurred(e){this._interval_map.has(e.queryId)&&(window.clearInterval(this._interval_map.get(e.queryId)),this._interval_map.delete(e.queryId)),this._running-=1,this._subject.next("ERROR"),console.log("QueryService received error: "+e.message)}lastQueryIssued(){return this._lastQuery}}return i.\u0275fac=function(e){return new(e||i)(Ve($N),Ve(iP),Ve(dr),Ve(Zc))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})();const Che=["tooltip"],Cj="tooltip-panel",Mj=ly({passive:!0}),Tj=new gi("mat-tooltip-scroll-strategy"),Ahe={provide:Tj,deps:[Du],useFactory:function Ehe(i){return()=>i.scrollStrategies.reposition({scrollThrottle:20})}},Dhe=new gi("mat-tooltip-default-options",{providedIn:"root",factory:function Rhe(){return{showDelay:0,hideDelay:0,touchendHideDelay:1500}}});let khe=(()=>{class i{constructor(e,n,r,s,a,l,u,h,m,_,v,S){this._overlay=e,this._elementRef=n,this._scrollDispatcher=r,this._viewContainerRef=s,this._ngZone=a,this._platform=l,this._ariaDescriber=u,this._focusMonitor=h,this._dir=_,this._defaultOptions=v,this._position="below",this._disabled=!1,this._viewInitialized=!1,this._pointerExitEventsInitialized=!1,this._viewportMargin=8,this._cssClassPrefix="mat",this._showDelay=this._defaultOptions.showDelay,this._hideDelay=this._defaultOptions.hideDelay,this.touchGestures="auto",this._message="",this._passiveListeners=[],this._destroyed=new ii,this._scrollStrategy=m,this._document=S,v&&(v.position&&(this.position=v.position),v.touchGestures&&(this.touchGestures=v.touchGestures)),_.change.pipe($n(this._destroyed)).subscribe(()=>{this._overlayRef&&this._updatePosition(this._overlayRef)})}get position(){return this._position}set position(e){var n;e!==this._position&&(this._position=e,this._overlayRef&&(this._updatePosition(this._overlayRef),null===(n=this._tooltipInstance)||void 0===n||n.show(0),this._overlayRef.updatePosition()))}get disabled(){return this._disabled}set disabled(e){this._disabled=tn(e),this._disabled?this.hide(0):this._setupPointerEnterEventsIfNeeded()}get showDelay(){return this._showDelay}set showDelay(e){this._showDelay=Qo(e)}get hideDelay(){return this._hideDelay}set hideDelay(e){this._hideDelay=Qo(e),this._tooltipInstance&&(this._tooltipInstance._mouseLeaveHideDelay=this._hideDelay)}get message(){return this._message}set message(e){this._ariaDescriber.removeDescription(this._elementRef.nativeElement,this._message,"tooltip"),this._message=null!=e?String(e).trim():"",!this._message&&this._isTooltipVisible()?this.hide(0):(this._setupPointerEnterEventsIfNeeded(),this._updateTooltipMessage(),this._ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>{this._ariaDescriber.describe(this._elementRef.nativeElement,this.message,"tooltip")})}))}get tooltipClass(){return this._tooltipClass}set tooltipClass(e){this._tooltipClass=e,this._tooltipInstance&&this._setTooltipClass(this._tooltipClass)}ngAfterViewInit(){this._viewInitialized=!0,this._setupPointerEnterEventsIfNeeded(),this._focusMonitor.monitor(this._elementRef).pipe($n(this._destroyed)).subscribe(e=>{e?"keyboard"===e&&this._ngZone.run(()=>this.show()):this._ngZone.run(()=>this.hide(0))})}ngOnDestroy(){const e=this._elementRef.nativeElement;clearTimeout(this._touchstartTimeout),this._overlayRef&&(this._overlayRef.dispose(),this._tooltipInstance=null),this._passiveListeners.forEach(([n,r])=>{e.removeEventListener(n,r,Mj)}),this._passiveListeners.length=0,this._destroyed.next(),this._destroyed.complete(),this._ariaDescriber.removeDescription(e,this.message,"tooltip"),this._focusMonitor.stopMonitoring(e)}show(e=this.showDelay){if(this.disabled||!this.message||this._isTooltipVisible()&&!this._tooltipInstance._showTimeoutId&&!this._tooltipInstance._hideTimeoutId)return;const n=this._createOverlay();this._detach(),this._portal=this._portal||new hy(this._tooltipComponent,this._viewContainerRef);const r=this._tooltipInstance=n.attach(this._portal).instance;r._triggerElement=this._elementRef.nativeElement,r._mouseLeaveHideDelay=this._hideDelay,r.afterHidden().pipe($n(this._destroyed)).subscribe(()=>this._detach()),this._setTooltipClass(this._tooltipClass),this._updateTooltipMessage(),r.show(e)}hide(e=this.hideDelay){this._tooltipInstance&&this._tooltipInstance.hide(e)}toggle(){this._isTooltipVisible()?this.hide():this.show()}_isTooltipVisible(){return!!this._tooltipInstance&&this._tooltipInstance.isVisible()}_createOverlay(){var e;if(this._overlayRef)return this._overlayRef;const n=this._scrollDispatcher.getAncestorScrollContainers(this._elementRef),r=this._overlay.position().flexibleConnectedTo(this._elementRef).withTransformOriginOn(`.${this._cssClassPrefix}-tooltip`).withFlexibleDimensions(!1).withViewportMargin(this._viewportMargin).withScrollableContainers(n);return r.positionChanges.pipe($n(this._destroyed)).subscribe(s=>{this._updateCurrentPositionClass(s.connectionPair),this._tooltipInstance&&s.scrollableViewProperties.isOverlayClipped&&this._tooltipInstance.isVisible()&&this._ngZone.run(()=>this.hide(0))}),this._overlayRef=this._overlay.create({direction:this._dir,positionStrategy:r,panelClass:`${this._cssClassPrefix}-${Cj}`,scrollStrategy:this._scrollStrategy()}),this._updatePosition(this._overlayRef),this._overlayRef.detachments().pipe($n(this._destroyed)).subscribe(()=>this._detach()),this._overlayRef.outsidePointerEvents().pipe($n(this._destroyed)).subscribe(()=>{var s;return null===(s=this._tooltipInstance)||void 0===s?void 0:s._handleBodyInteraction()}),this._overlayRef.keydownEvents().pipe($n(this._destroyed)).subscribe(s=>{this._isTooltipVisible()&&27===s.keyCode&&!dc(s)&&(s.preventDefault(),s.stopPropagation(),this._ngZone.run(()=>this.hide(0)))}),(null===(e=this._defaultOptions)||void 0===e?void 0:e.disableTooltipInteractivity)&&this._overlayRef.addPanelClass(`${this._cssClassPrefix}-tooltip-panel-non-interactive`),this._overlayRef}_detach(){this._overlayRef&&this._overlayRef.hasAttached()&&this._overlayRef.detach(),this._tooltipInstance=null}_updatePosition(e){const n=e.getConfig().positionStrategy,r=this._getOrigin(),s=this._getOverlayPosition();n.withPositions([this._addOffset(Object.assign(Object.assign({},r.main),s.main)),this._addOffset(Object.assign(Object.assign({},r.fallback),s.fallback))])}_addOffset(e){return e}_getOrigin(){const e=!this._dir||"ltr"==this._dir.value,n=this.position;let r;"above"==n||"below"==n?r={originX:"center",originY:"above"==n?"top":"bottom"}:"before"==n||"left"==n&&e||"right"==n&&!e?r={originX:"start",originY:"center"}:("after"==n||"right"==n&&e||"left"==n&&!e)&&(r={originX:"end",originY:"center"});const{x:s,y:a}=this._invertPosition(r.originX,r.originY);return{main:r,fallback:{originX:s,originY:a}}}_getOverlayPosition(){const e=!this._dir||"ltr"==this._dir.value,n=this.position;let r;"above"==n?r={overlayX:"center",overlayY:"bottom"}:"below"==n?r={overlayX:"center",overlayY:"top"}:"before"==n||"left"==n&&e||"right"==n&&!e?r={overlayX:"end",overlayY:"center"}:("after"==n||"right"==n&&e||"left"==n&&!e)&&(r={overlayX:"start",overlayY:"center"});const{x:s,y:a}=this._invertPosition(r.overlayX,r.overlayY);return{main:r,fallback:{overlayX:s,overlayY:a}}}_updateTooltipMessage(){this._tooltipInstance&&(this._tooltipInstance.message=this.message,this._tooltipInstance._markForCheck(),this._ngZone.onMicrotaskEmpty.pipe(Qr(1),$n(this._destroyed)).subscribe(()=>{this._tooltipInstance&&this._overlayRef.updatePosition()}))}_setTooltipClass(e){this._tooltipInstance&&(this._tooltipInstance.tooltipClass=e,this._tooltipInstance._markForCheck())}_invertPosition(e,n){return"above"===this.position||"below"===this.position?"top"===n?n="bottom":"bottom"===n&&(n="top"):"end"===e?e="start":"start"===e&&(e="end"),{x:e,y:n}}_updateCurrentPositionClass(e){const{overlayY:n,originX:r,originY:s}=e;let a;if(a="center"===n?this._dir&&"rtl"===this._dir.value?"end"===r?"left":"right":"start"===r?"left":"right":"bottom"===n&&"top"===s?"above":"below",a!==this._currentPosition){const l=this._overlayRef;if(l){const u=`${this._cssClassPrefix}-${Cj}-`;l.removePanelClass(u+this._currentPosition),l.addPanelClass(u+a)}this._currentPosition=a}}_setupPointerEnterEventsIfNeeded(){this._disabled||!this.message||!this._viewInitialized||this._passiveListeners.length||(this._platformSupportsMouseEvents()?this._passiveListeners.push(["mouseenter",()=>{this._setupPointerExitEventsIfNeeded(),this.show()}]):"off"!==this.touchGestures&&(this._disableNativeGesturesIfNecessary(),this._passiveListeners.push(["touchstart",()=>{this._setupPointerExitEventsIfNeeded(),clearTimeout(this._touchstartTimeout),this._touchstartTimeout=setTimeout(()=>this.show(),500)}])),this._addListeners(this._passiveListeners))}_setupPointerExitEventsIfNeeded(){if(this._pointerExitEventsInitialized)return;this._pointerExitEventsInitialized=!0;const e=[];if(this._platformSupportsMouseEvents())e.push(["mouseleave",n=>{var r;const s=n.relatedTarget;(!s||!(null===(r=this._overlayRef)||void 0===r?void 0:r.overlayElement.contains(s)))&&this.hide()}],["wheel",n=>this._wheelListener(n)]);else if("off"!==this.touchGestures){this._disableNativeGesturesIfNecessary();const n=()=>{clearTimeout(this._touchstartTimeout),this.hide(this._defaultOptions.touchendHideDelay)};e.push(["touchend",n],["touchcancel",n])}this._addListeners(e),this._passiveListeners.push(...e)}_addListeners(e){e.forEach(([n,r])=>{this._elementRef.nativeElement.addEventListener(n,r,Mj)})}_platformSupportsMouseEvents(){return!this._platform.IOS&&!this._platform.ANDROID}_wheelListener(e){if(this._isTooltipVisible()){const n=this._document.elementFromPoint(e.clientX,e.clientY),r=this._elementRef.nativeElement;n!==r&&!r.contains(n)&&this.hide()}}_disableNativeGesturesIfNecessary(){const e=this.touchGestures;if("off"!==e){const n=this._elementRef.nativeElement,r=n.style;("on"===e||"INPUT"!==n.nodeName&&"TEXTAREA"!==n.nodeName)&&(r.userSelect=r.msUserSelect=r.webkitUserSelect=r.MozUserSelect="none"),("on"===e||!n.draggable)&&(r.webkitUserDrag="none"),r.touchAction="none",r.webkitTapHighlightColor="transparent"}}}return i.\u0275fac=function(e){Nd()},i.\u0275dir=Be({type:i,inputs:{position:["matTooltipPosition","position"],disabled:["matTooltipDisabled","disabled"],showDelay:["matTooltipShowDelay","showDelay"],hideDelay:["matTooltipHideDelay","hideDelay"],touchGestures:["matTooltipTouchGestures","touchGestures"],message:["matTooltip","message"],tooltipClass:["matTooltipClass","tooltipClass"]}}),i})(),Fo=(()=>{class i extends khe{constructor(e,n,r,s,a,l,u,h,m,_,v,S){super(e,n,r,s,a,l,u,h,m,_,v,S),this._tooltipComponent=Ihe}}return i.\u0275fac=function(e){return new(e||i)(B(Du),B(ai),B(P1),B(Ko),B(Rn),B(ta),B(r7),B(ch),B(Tj),B(Ia,8),B(Dhe,8),B(ar))},i.\u0275dir=Be({type:i,selectors:[["","matTooltip",""]],hostAttrs:[1,"mat-tooltip-trigger"],exportAs:["matTooltip"],features:[It]}),i})(),Phe=(()=>{class i{constructor(e,n){this._changeDetectorRef=e,this._visibility="initial",this._closeOnInteraction=!1,this._isVisible=!1,this._onHide=new ii,this._animationsDisabled="NoopAnimations"===n}show(e){clearTimeout(this._hideTimeoutId),this._showTimeoutId=setTimeout(()=>{this._toggleVisibility(!0),this._showTimeoutId=void 0},e)}hide(e){clearTimeout(this._showTimeoutId),this._hideTimeoutId=setTimeout(()=>{this._toggleVisibility(!1),this._hideTimeoutId=void 0},e)}afterHidden(){return this._onHide}isVisible(){return this._isVisible}ngOnDestroy(){clearTimeout(this._showTimeoutId),clearTimeout(this._hideTimeoutId),this._onHide.complete(),this._triggerElement=null}_handleBodyInteraction(){this._closeOnInteraction&&this.hide(0)}_markForCheck(){this._changeDetectorRef.markForCheck()}_handleMouseLeave({relatedTarget:e}){(!e||!this._triggerElement.contains(e))&&this.hide(this._mouseLeaveHideDelay)}_onShow(){}_handleAnimationEnd({animationName:e}){(e===this._showAnimation||e===this._hideAnimation)&&this._finalizeAnimation(e===this._showAnimation)}_finalizeAnimation(e){e?this._closeOnInteraction=!0:this.isVisible()||this._onHide.next()}_toggleVisibility(e){const n=this._tooltip.nativeElement,r=this._showAnimation,s=this._hideAnimation;if(n.classList.remove(e?s:r),n.classList.add(e?r:s),this._isVisible=e,e&&!this._animationsDisabled&&"function"==typeof getComputedStyle){const a=getComputedStyle(n);("0s"===a.getPropertyValue("animation-duration")||"none"===a.getPropertyValue("animation-name"))&&(this._animationsDisabled=!0)}e&&this._onShow(),this._animationsDisabled&&(n.classList.add("_mat-animation-noopable"),this._finalizeAnimation(e))}}return i.\u0275fac=function(e){return new(e||i)(B(Pn),B(ga,8))},i.\u0275dir=Be({type:i}),i})(),Ihe=(()=>{class i extends Phe{constructor(e,n,r){super(e,r),this._breakpointObserver=n,this._isHandset=this._breakpointObserver.observe("(max-width: 599.98px) and (orientation: portrait), (max-width: 959.98px) and (orientation: landscape)"),this._showAnimation="mat-tooltip-show",this._hideAnimation="mat-tooltip-hide"}}return i.\u0275fac=function(e){return new(e||i)(B(Pn),B(Rk),B(ga,8))},i.\u0275cmp=ei({type:i,selectors:[["mat-tooltip-component"]],viewQuery:function(e,n){if(1&e&&ji(Che,7),2&e){let r;jt(r=qt())&&(n._tooltip=r.first)}},hostAttrs:["aria-hidden","true"],hostVars:2,hostBindings:function(e,n){1&e&&je("mouseleave",function(s){return n._handleMouseLeave(s)}),2&e&&A("zoom",n.isVisible()?1:null)},features:[It],decls:4,vars:6,consts:[[1,"mat-tooltip",3,"ngClass","animationend"],["tooltip",""]],template:function(e,n){if(1&e&&(Z(0,"div",0,1),je("animationend",function(s){return n._handleAnimationEnd(s)}),ti(2,"async"),ue(3),J()),2&e){let r;N("mat-tooltip-handset",null==(r=Qi(2,4,n._isHandset))?null:r.matches),fe("ngClass",n.tooltipClass),se(3),Xt(n.message)}},directives:[Cp],pipes:[Xc],styles:[".mat-tooltip{color:#fff;border-radius:4px;margin:14px;max-width:250px;padding-left:8px;padding-right:8px;overflow:hidden;text-overflow:ellipsis;transform:scale(0)}.mat-tooltip._mat-animation-noopable{animation:none;transform:scale(1)}.cdk-high-contrast-active .mat-tooltip{outline:solid 1px}.mat-tooltip-handset{margin:24px;padding-left:16px;padding-right:16px}.mat-tooltip-panel-non-interactive{pointer-events:none}@keyframes mat-tooltip-show{0%{opacity:0;transform:scale(0)}50%{opacity:.5;transform:scale(0.99)}100%{opacity:1;transform:scale(1)}}@keyframes mat-tooltip-hide{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(1)}}.mat-tooltip-show{animation:mat-tooltip-show 200ms cubic-bezier(0, 0, 0.2, 1) forwards}.mat-tooltip-hide{animation:mat-tooltip-hide 100ms cubic-bezier(0, 0, 0.2, 1) forwards}\n"],encapsulation:2,changeDetection:0}),i})(),sH=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({providers:[Ahe],imports:[[nN,ka,Nb,jn],jn,uy]}),i})();function oT(i,t){const e=z(i)?i:()=>i,n=r=>r.error(e());return new ft(t?r=>t.schedule(n,0,r):n)}function Iu(i){return gr((t,e)=>{let s,n=null,r=!1;n=t.subscribe(qn(e,void 0,void 0,a=>{s=eo(i(a,Iu(i)(t))),n?(n.unsubscribe(),n=null,s.subscribe(e)):r=!0})),r&&(n.unsubscribe(),n=null,s.subscribe(e))})}function Ej(i){return gr((t,e)=>{try{t.subscribe(e)}finally{e.add(i)}})}const Lhe=["*"];let aP;function aT(i){var t;return(null===(t=function Ohe(){if(void 0===aP&&(aP=null,"undefined"!=typeof window)){const i=window;void 0!==i.trustedTypes&&(aP=i.trustedTypes.createPolicy("angular#components",{createHTML:t=>t}))}return aP}())||void 0===t?void 0:t.createHTML(i))||i}function Aj(i){return Error(`Unable to find icon with the name "${i}"`)}function Dj(i){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${i}".`)}function Rj(i){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${i}".`)}class Qb{constructor(t,e,n){this.url=t,this.svgText=e,this.options=n}}let lT=(()=>{class i{constructor(e,n,r,s){this._httpClient=e,this._sanitizer=n,this._errorHandler=s,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass="material-icons",this._document=r}addSvgIcon(e,n,r){return this.addSvgIconInNamespace("",e,n,r)}addSvgIconLiteral(e,n,r){return this.addSvgIconLiteralInNamespace("",e,n,r)}addSvgIconInNamespace(e,n,r,s){return this._addSvgIconConfig(e,n,new Qb(r,null,s))}addSvgIconResolver(e){return this._resolvers.push(e),this}addSvgIconLiteralInNamespace(e,n,r,s){const a=this._sanitizer.sanitize(so.HTML,r);if(!a)throw Rj(r);const l=aT(a);return this._addSvgIconConfig(e,n,new Qb("",l,s))}addSvgIconSet(e,n){return this.addSvgIconSetInNamespace("",e,n)}addSvgIconSetLiteral(e,n){return this.addSvgIconSetLiteralInNamespace("",e,n)}addSvgIconSetInNamespace(e,n,r){return this._addSvgIconSetConfig(e,new Qb(n,null,r))}addSvgIconSetLiteralInNamespace(e,n,r){const s=this._sanitizer.sanitize(so.HTML,n);if(!s)throw Rj(n);const a=aT(s);return this._addSvgIconSetConfig(e,new Qb("",a,r))}registerFontClassAlias(e,n=e){return this._fontCssClassesByAlias.set(e,n),this}classNameForFontAlias(e){return this._fontCssClassesByAlias.get(e)||e}setDefaultFontSetClass(e){return this._defaultFontSetClass=e,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(e){const n=this._sanitizer.sanitize(so.RESOURCE_URL,e);if(!n)throw Dj(e);const r=this._cachedIconsByUrl.get(n);return r?Qn(lP(r)):this._loadSvgIconFromConfig(new Qb(e,null)).pipe(Po(s=>this._cachedIconsByUrl.set(n,s)),Ui(s=>lP(s)))}getNamedSvgIcon(e,n=""){const r=kj(n,e);let s=this._svgIconConfigs.get(r);if(s)return this._getSvgFromConfig(s);if(s=this._getIconConfigFromResolvers(n,e),s)return this._svgIconConfigs.set(r,s),this._getSvgFromConfig(s);const a=this._iconSetConfigs.get(n);return a?this._getSvgFromIconSetConfigs(e,a):oT(Aj(r))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(e){return e.svgText?Qn(lP(this._svgElementFromConfig(e))):this._loadSvgIconFromConfig(e).pipe(Ui(n=>lP(n)))}_getSvgFromIconSetConfigs(e,n){const r=this._extractIconWithNameFromAnySet(e,n);return r?Qn(r):F6(n.filter(a=>!a.svgText).map(a=>this._loadSvgIconSetFromConfig(a).pipe(Iu(l=>{const h=`Loading icon set URL: ${this._sanitizer.sanitize(so.RESOURCE_URL,a.url)} failed: ${l.message}`;return this._errorHandler.handleError(new Error(h)),Qn(null)})))).pipe(Ui(()=>{const a=this._extractIconWithNameFromAnySet(e,n);if(!a)throw Aj(e);return a}))}_extractIconWithNameFromAnySet(e,n){for(let r=n.length-1;r>=0;r--){const s=n[r];if(s.svgText&&s.svgText.toString().indexOf(e)>-1){const a=this._svgElementFromConfig(s),l=this._extractSvgIconFromSet(a,e,s.options);if(l)return l}}return null}_loadSvgIconFromConfig(e){return this._fetchIcon(e).pipe(Po(n=>e.svgText=n),Ui(()=>this._svgElementFromConfig(e)))}_loadSvgIconSetFromConfig(e){return e.svgText?Qn(null):this._fetchIcon(e).pipe(Po(n=>e.svgText=n))}_extractSvgIconFromSet(e,n,r){const s=e.querySelector(`[id="${n}"]`);if(!s)return null;const a=s.cloneNode(!0);if(a.removeAttribute("id"),"svg"===a.nodeName.toLowerCase())return this._setSvgAttributes(a,r);if("symbol"===a.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(a),r);const l=this._svgElementFromString(aT("<svg></svg>"));return l.appendChild(a),this._setSvgAttributes(l,r)}_svgElementFromString(e){const n=this._document.createElement("DIV");n.innerHTML=e;const r=n.querySelector("svg");if(!r)throw Error("<svg> tag not found");return r}_toSvgElement(e){const n=this._svgElementFromString(aT("<svg></svg>")),r=e.attributes;for(let s=0;s<r.length;s++){const{name:a,value:l}=r[s];"id"!==a&&n.setAttribute(a,l)}for(let s=0;s<e.childNodes.length;s++)e.childNodes[s].nodeType===this._document.ELEMENT_NODE&&n.appendChild(e.childNodes[s].cloneNode(!0));return n}_setSvgAttributes(e,n){return e.setAttribute("fit",""),e.setAttribute("height","100%"),e.setAttribute("width","100%"),e.setAttribute("preserveAspectRatio","xMidYMid meet"),e.setAttribute("focusable","false"),n&&n.viewBox&&e.setAttribute("viewBox",n.viewBox),e}_fetchIcon(e){var n;const{url:r,options:s}=e,a=null!==(n=null==s?void 0:s.withCredentials)&&void 0!==n&&n;if(!this._httpClient)throw function Fhe(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}();if(null==r)throw Error(`Cannot fetch icon from URL "${r}".`);const l=this._sanitizer.sanitize(so.RESOURCE_URL,r);if(!l)throw Dj(r);const u=this._inProgressUrlFetches.get(l);if(u)return u;const h=this._httpClient.get(l,{responseType:"text",withCredentials:a}).pipe(Ui(m=>aT(m)),Ej(()=>this._inProgressUrlFetches.delete(l)),yh());return this._inProgressUrlFetches.set(l,h),h}_addSvgIconConfig(e,n,r){return this._svgIconConfigs.set(kj(e,n),r),this}_addSvgIconSetConfig(e,n){const r=this._iconSetConfigs.get(e);return r?r.push(n):this._iconSetConfigs.set(e,[n]),this}_svgElementFromConfig(e){if(!e.svgElement){const n=this._svgElementFromString(e.svgText);this._setSvgAttributes(n,e.options),e.svgElement=n}return e.svgElement}_getIconConfigFromResolvers(e,n){for(let r=0;r<this._resolvers.length;r++){const s=this._resolvers[r](n,e);if(s)return Nhe(s)?new Qb(s.url,null,s.options):new Qb(s,null)}}}return i.\u0275fac=function(e){return new(e||i)(Ve(ma,8),Ve(m1),Ve(ar,8),Ve(fp))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function lP(i){return i.cloneNode(!0)}function kj(i,t){return i+":"+t}function Nhe(i){return!(!i.url||!i.options)}const Hhe=Vf(class{constructor(i){this._elementRef=i}}),Vhe=new gi("mat-icon-location",{providedIn:"root",factory:function zhe(){const i=f_(ar),t=i?i.location:null;return{getPathname:()=>t?t.pathname+t.search:""}}}),Pj=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],Uhe=Pj.map(i=>`[${i}]`).join(", "),Ghe=/^url\(['"]?#(.*?)['"]?\)$/;let vo=(()=>{class i extends Hhe{constructor(e,n,r,s,a){super(e),this._iconRegistry=n,this._location=s,this._errorHandler=a,this._inline=!1,this._currentIconFetch=Q.EMPTY,r||e.nativeElement.setAttribute("aria-hidden","true")}get inline(){return this._inline}set inline(e){this._inline=tn(e)}get svgIcon(){return this._svgIcon}set svgIcon(e){e!==this._svgIcon&&(e?this._updateSvgIcon(e):this._svgIcon&&this._clearSvgElement(),this._svgIcon=e)}get fontSet(){return this._fontSet}set fontSet(e){const n=this._cleanupFontValue(e);n!==this._fontSet&&(this._fontSet=n,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(e){const n=this._cleanupFontValue(e);n!==this._fontIcon&&(this._fontIcon=n,this._updateFontIconClasses())}_splitIconName(e){if(!e)return["",""];const n=e.split(":");switch(n.length){case 1:return["",n[0]];case 2:return n;default:throw Error(`Invalid icon name: "${e}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const e=this._elementsWithExternalReferences;if(e&&e.size){const n=this._location.getPathname();n!==this._previousPath&&(this._previousPath=n,this._prependPathToReferences(n))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(e){this._clearSvgElement();const n=this._location.getPathname();this._previousPath=n,this._cacheChildrenWithExternalReferences(e),this._prependPathToReferences(n),this._elementRef.nativeElement.appendChild(e)}_clearSvgElement(){const e=this._elementRef.nativeElement;let n=e.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();n--;){const r=e.childNodes[n];(1!==r.nodeType||"svg"===r.nodeName.toLowerCase())&&r.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const e=this._elementRef.nativeElement,n=this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet):this._iconRegistry.getDefaultFontSetClass();n!=this._previousFontSetClass&&(this._previousFontSetClass&&e.classList.remove(this._previousFontSetClass),n&&e.classList.add(n),this._previousFontSetClass=n),this.fontIcon!=this._previousFontIconClass&&(this._previousFontIconClass&&e.classList.remove(this._previousFontIconClass),this.fontIcon&&e.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(e){return"string"==typeof e?e.trim().split(" ")[0]:e}_prependPathToReferences(e){const n=this._elementsWithExternalReferences;n&&n.forEach((r,s)=>{r.forEach(a=>{s.setAttribute(a.name,`url('${e}#${a.value}')`)})})}_cacheChildrenWithExternalReferences(e){const n=e.querySelectorAll(Uhe),r=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let s=0;s<n.length;s++)Pj.forEach(a=>{const l=n[s],u=l.getAttribute(a),h=u?u.match(Ghe):null;if(h){let m=r.get(l);m||(m=[],r.set(l,m)),m.push({name:a,value:h[1]})}})}_updateSvgIcon(e){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),e){const[n,r]=this._splitIconName(e);n&&(this._svgNamespace=n),r&&(this._svgName=r),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(r,n).pipe(Qr(1)).subscribe(s=>this._setSvgElement(s),s=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${n}:${r}! ${s.message}`))})}}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(lT),zc("aria-hidden"),B(Vhe),B(fp))},i.\u0275cmp=ei({type:i,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:7,hostBindings:function(e,n){2&e&&(Vi("data-mat-icon-type",n._usingFontIcon()?"font":"svg")("data-mat-icon-name",n._svgName||n.fontIcon)("data-mat-icon-namespace",n._svgNamespace||n.fontSet),N("mat-icon-inline",n.inline)("mat-icon-no-color","primary"!==n.color&&"accent"!==n.color&&"warn"!==n.color))},inputs:{color:"color",inline:"inline",svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[It],ngContentSelectors:Lhe,decls:1,vars:0,template:function(e,n){1&e&&(As(),hr(0))},styles:[".mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}\n"],encapsulation:2,changeDetection:0}),i})(),oH=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[jn],jn]}),i})();function aH(i){return i&&"function"==typeof i.connect}class Ij{applyChanges(t,e,n,r,s){t.forEachOperation((a,l,u)=>{let h,m;if(null==a.previousIndex){const _=n(a,l,u);h=e.createEmbeddedView(_.templateRef,_.context,_.index),m=1}else null==u?(e.remove(l),m=3):(h=e.get(l),e.move(h,u),m=2);s&&s({context:null==h?void 0:h.context,operation:m,record:a})})}detach(){}}class cT{constructor(t=!1,e,n=!0){this._multiple=t,this._emitChanges=n,this._selection=new Set,this._deselectedToEmit=[],this._selectedToEmit=[],this.changed=new ii,e&&e.length&&(t?e.forEach(r=>this._markSelected(r)):this._markSelected(e[0]),this._selectedToEmit.length=0)}get selected(){return this._selected||(this._selected=Array.from(this._selection.values())),this._selected}select(...t){this._verifyValueAssignment(t),t.forEach(e=>this._markSelected(e)),this._emitChangeEvent()}deselect(...t){this._verifyValueAssignment(t),t.forEach(e=>this._unmarkSelected(e)),this._emitChangeEvent()}toggle(t){this.isSelected(t)?this.deselect(t):this.select(t)}clear(){this._unmarkAll(),this._emitChangeEvent()}isSelected(t){return this._selection.has(t)}isEmpty(){return 0===this._selection.size}hasValue(){return!this.isEmpty()}sort(t){this._multiple&&this.selected&&this._selected.sort(t)}isMultipleSelection(){return this._multiple}_emitChangeEvent(){this._selected=null,(this._selectedToEmit.length||this._deselectedToEmit.length)&&(this.changed.next({source:this,added:this._selectedToEmit,removed:this._deselectedToEmit}),this._deselectedToEmit=[],this._selectedToEmit=[])}_markSelected(t){this.isSelected(t)||(this._multiple||this._unmarkAll(),this._selection.add(t),this._emitChanges&&this._selectedToEmit.push(t))}_unmarkSelected(t){this.isSelected(t)&&(this._selection.delete(t),this._emitChanges&&this._deselectedToEmit.push(t))}_unmarkAll(){this.isEmpty()||this._selection.forEach(t=>this._unmarkSelected(t))}_verifyValueAssignment(t){}}const uT=new gi("_ViewRepeater");let ig=(()=>{class i{constructor(){this._vertical=!1,this._inset=!1}get vertical(){return this._vertical}set vertical(e){this._vertical=tn(e)}get inset(){return this._inset}set inset(e){this._inset=tn(e)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=ei({type:i,selectors:[["mat-divider"]],hostAttrs:["role","separator",1,"mat-divider"],hostVars:7,hostBindings:function(e,n){2&e&&(Vi("aria-orientation",n.vertical?"vertical":"horizontal"),N("mat-divider-vertical",n.vertical)("mat-divider-horizontal",!n.vertical)("mat-divider-inset",n.inset))},inputs:{vertical:"vertical",inset:"inset"},decls:0,vars:0,template:function(e,n){},styles:[".mat-divider{display:block;margin:0;border-top-width:1px;border-top-style:solid}.mat-divider.mat-divider-vertical{border-top:0;border-right-width:1px;border-right-style:solid}.mat-divider.mat-divider-inset{margin-left:80px}[dir=rtl] .mat-divider.mat-divider-inset{margin-left:auto;margin-right:80px}\n"],encapsulation:2,changeDetection:0}),i})(),jhe=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[jn],jn]}),i})();const lH=["*"],qhe=[[["","mat-list-avatar",""],["","mat-list-icon",""],["","matListAvatar",""],["","matListIcon",""]],[["","mat-line",""],["","matLine",""]],"*"],Xhe=["[mat-list-avatar], [mat-list-icon], [matListAvatar], [matListIcon]","[mat-line], [matLine]","*"],Fj=Hf(uh(class{})),Jhe=uh(class{}),Bj=new gi("MatList"),Nj=new gi("MatNavList");let $he=(()=>{class i extends Fj{constructor(){super(...arguments),this._stateChanges=new ii}ngOnChanges(){this._stateChanges.next()}ngOnDestroy(){this._stateChanges.complete()}}return i.\u0275fac=function(){let t;return function(n){return(t||(t=Ki(i)))(n||i)}}(),i.\u0275cmp=ei({type:i,selectors:[["mat-nav-list"]],hostAttrs:["role","navigation",1,"mat-nav-list","mat-list-base"],inputs:{disableRipple:"disableRipple",disabled:"disabled"},exportAs:["matNavList"],features:[Sn([{provide:Nj,useExisting:i}]),It,Ls],ngContentSelectors:lH,decls:1,vars:0,template:function(e,n){1&e&&(As(),hr(0))},styles:['.mat-subheader{display:flex;box-sizing:border-box;padding:16px;align-items:center}.mat-list-base .mat-subheader{margin:0}button.mat-list-item,button.mat-list-option{padding:0;width:100%;background:none;color:inherit;border:none;outline:inherit;-webkit-tap-highlight-color:transparent;text-align:left}[dir=rtl] button.mat-list-item,[dir=rtl] button.mat-list-option{text-align:right}button.mat-list-item::-moz-focus-inner,button.mat-list-option::-moz-focus-inner{border:0}.mat-list-base{padding-top:8px;display:block;-webkit-tap-highlight-color:transparent}.mat-list-base .mat-subheader{height:48px;line-height:16px}.mat-list-base .mat-subheader:first-child{margin-top:-8px}.mat-list-base .mat-list-item,.mat-list-base .mat-list-option{display:block;height:48px;-webkit-tap-highlight-color:transparent;width:100%;padding:0}.mat-list-base .mat-list-item .mat-list-item-content,.mat-list-base .mat-list-option .mat-list-item-content{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;padding:0 16px;position:relative;height:inherit}.mat-list-base .mat-list-item .mat-list-item-content-reverse,.mat-list-base .mat-list-option .mat-list-item-content-reverse{display:flex;align-items:center;padding:0 16px;flex-direction:row-reverse;justify-content:space-around}.mat-list-base .mat-list-item .mat-list-item-ripple,.mat-list-base .mat-list-option .mat-list-item-ripple{display:block;top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-list-base .mat-list-item.mat-list-item-with-avatar,.mat-list-base .mat-list-option.mat-list-item-with-avatar{height:56px}.mat-list-base .mat-list-item.mat-2-line,.mat-list-base .mat-list-option.mat-2-line{height:72px}.mat-list-base .mat-list-item.mat-3-line,.mat-list-base .mat-list-option.mat-3-line{height:88px}.mat-list-base .mat-list-item.mat-multi-line,.mat-list-base .mat-list-option.mat-multi-line{height:auto}.mat-list-base .mat-list-item.mat-multi-line .mat-list-item-content,.mat-list-base .mat-list-option.mat-multi-line .mat-list-item-content{padding-top:16px;padding-bottom:16px}.mat-list-base .mat-list-item .mat-list-text,.mat-list-base .mat-list-option .mat-list-text{display:flex;flex-direction:column;flex:auto;box-sizing:border-box;overflow:hidden;padding:0}.mat-list-base .mat-list-item .mat-list-text>*,.mat-list-base .mat-list-option .mat-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-list-base .mat-list-item .mat-list-text:empty,.mat-list-base .mat-list-option .mat-list-text:empty{display:none}.mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:0;padding-left:16px}[dir=rtl] .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:0}.mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-left:0;padding-right:16px}[dir=rtl] .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:0;padding-left:16px}.mat-list-base .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:16px}.mat-list-base .mat-list-item .mat-list-avatar,.mat-list-base .mat-list-option .mat-list-avatar{flex-shrink:0;width:40px;height:40px;border-radius:50%;object-fit:cover}.mat-list-base .mat-list-item .mat-list-avatar~.mat-divider-inset,.mat-list-base .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:72px;width:calc(100% - 72px)}[dir=rtl] .mat-list-base .mat-list-item .mat-list-avatar~.mat-divider-inset,[dir=rtl] .mat-list-base .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:auto;margin-right:72px}.mat-list-base .mat-list-item .mat-list-icon,.mat-list-base .mat-list-option .mat-list-icon{flex-shrink:0;width:24px;height:24px;font-size:24px;box-sizing:content-box;border-radius:50%;padding:4px}.mat-list-base .mat-list-item .mat-list-icon~.mat-divider-inset,.mat-list-base .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:64px;width:calc(100% - 64px)}[dir=rtl] .mat-list-base .mat-list-item .mat-list-icon~.mat-divider-inset,[dir=rtl] .mat-list-base .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:auto;margin-right:64px}.mat-list-base .mat-list-item .mat-divider,.mat-list-base .mat-list-option .mat-divider{position:absolute;bottom:0;left:0;width:100%;margin:0}[dir=rtl] .mat-list-base .mat-list-item .mat-divider,[dir=rtl] .mat-list-base .mat-list-option .mat-divider{margin-left:auto;margin-right:0}.mat-list-base .mat-list-item .mat-divider.mat-divider-inset,.mat-list-base .mat-list-option .mat-divider.mat-divider-inset{position:absolute}.mat-list-base[dense]{padding-top:4px;display:block}.mat-list-base[dense] .mat-subheader{height:40px;line-height:8px}.mat-list-base[dense] .mat-subheader:first-child{margin-top:-4px}.mat-list-base[dense] .mat-list-item,.mat-list-base[dense] .mat-list-option{display:block;height:40px;-webkit-tap-highlight-color:transparent;width:100%;padding:0}.mat-list-base[dense] .mat-list-item .mat-list-item-content,.mat-list-base[dense] .mat-list-option .mat-list-item-content{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;padding:0 16px;position:relative;height:inherit}.mat-list-base[dense] .mat-list-item .mat-list-item-content-reverse,.mat-list-base[dense] .mat-list-option .mat-list-item-content-reverse{display:flex;align-items:center;padding:0 16px;flex-direction:row-reverse;justify-content:space-around}.mat-list-base[dense] .mat-list-item .mat-list-item-ripple,.mat-list-base[dense] .mat-list-option .mat-list-item-ripple{display:block;top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar{height:48px}.mat-list-base[dense] .mat-list-item.mat-2-line,.mat-list-base[dense] .mat-list-option.mat-2-line{height:60px}.mat-list-base[dense] .mat-list-item.mat-3-line,.mat-list-base[dense] .mat-list-option.mat-3-line{height:76px}.mat-list-base[dense] .mat-list-item.mat-multi-line,.mat-list-base[dense] .mat-list-option.mat-multi-line{height:auto}.mat-list-base[dense] .mat-list-item.mat-multi-line .mat-list-item-content,.mat-list-base[dense] .mat-list-option.mat-multi-line .mat-list-item-content{padding-top:16px;padding-bottom:16px}.mat-list-base[dense] .mat-list-item .mat-list-text,.mat-list-base[dense] .mat-list-option .mat-list-text{display:flex;flex-direction:column;flex:auto;box-sizing:border-box;overflow:hidden;padding:0}.mat-list-base[dense] .mat-list-item .mat-list-text>*,.mat-list-base[dense] .mat-list-option .mat-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-list-base[dense] .mat-list-item .mat-list-text:empty,.mat-list-base[dense] .mat-list-option .mat-list-text:empty{display:none}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:0;padding-left:16px}[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:0}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-left:0;padding-right:16px}[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:0;padding-left:16px}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:16px}.mat-list-base[dense] .mat-list-item .mat-list-avatar,.mat-list-base[dense] .mat-list-option .mat-list-avatar{flex-shrink:0;width:36px;height:36px;border-radius:50%;object-fit:cover}.mat-list-base[dense] .mat-list-item .mat-list-avatar~.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:68px;width:calc(100% - 68px)}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-list-avatar~.mat-divider-inset,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:auto;margin-right:68px}.mat-list-base[dense] .mat-list-item .mat-list-icon,.mat-list-base[dense] .mat-list-option .mat-list-icon{flex-shrink:0;width:20px;height:20px;font-size:20px;box-sizing:content-box;border-radius:50%;padding:4px}.mat-list-base[dense] .mat-list-item .mat-list-icon~.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:60px;width:calc(100% - 60px)}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-list-icon~.mat-divider-inset,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:auto;margin-right:60px}.mat-list-base[dense] .mat-list-item .mat-divider,.mat-list-base[dense] .mat-list-option .mat-divider{position:absolute;bottom:0;left:0;width:100%;margin:0}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-divider,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-divider{margin-left:auto;margin-right:0}.mat-list-base[dense] .mat-list-item .mat-divider.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-divider.mat-divider-inset{position:absolute}.mat-nav-list a{text-decoration:none;color:inherit}.mat-nav-list .mat-list-item{cursor:pointer;outline:none}mat-action-list .mat-list-item{cursor:pointer;outline:inherit}.mat-list-option:not(.mat-list-item-disabled){cursor:pointer;outline:none}.mat-list-item-disabled{pointer-events:none}.cdk-high-contrast-active .mat-list-item-disabled{opacity:.5}.cdk-high-contrast-active :host .mat-list-item-disabled{opacity:.5}.cdk-high-contrast-active .mat-selection-list:focus{outline-style:dotted}.cdk-high-contrast-active .mat-list-option:hover,.cdk-high-contrast-active .mat-list-option:focus,.cdk-high-contrast-active .mat-nav-list .mat-list-item:hover,.cdk-high-contrast-active .mat-nav-list .mat-list-item:focus,.cdk-high-contrast-active mat-action-list .mat-list-item:hover,.cdk-high-contrast-active mat-action-list .mat-list-item:focus{outline:dotted 1px;z-index:1}.cdk-high-contrast-active .mat-list-single-selected-option::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}.cdk-high-contrast-active [dir=rtl] .mat-list-single-selected-option::after{right:auto;left:16px}@media(hover: none){.mat-list-option:not(.mat-list-single-selected-option):not(.mat-list-item-disabled):hover,.mat-nav-list .mat-list-item:not(.mat-list-item-disabled):hover,.mat-action-list .mat-list-item:not(.mat-list-item-disabled):hover{background:none}}\n'],encapsulation:2,changeDetection:0}),i})(),nS=(()=>{class i extends Fj{constructor(e){super(),this._elementRef=e,this._stateChanges=new ii,"action-list"===this._getListType()&&e.nativeElement.classList.add("mat-action-list")}_getListType(){const e=this._elementRef.nativeElement.nodeName.toLowerCase();return"mat-list"===e?"list":"mat-action-list"===e?"action-list":null}ngOnChanges(){this._stateChanges.next()}ngOnDestroy(){this._stateChanges.complete()}}return i.\u0275fac=function(e){return new(e||i)(B(ai))},i.\u0275cmp=ei({type:i,selectors:[["mat-list"],["mat-action-list"]],hostAttrs:[1,"mat-list","mat-list-base"],inputs:{disableRipple:"disableRipple",disabled:"disabled"},exportAs:["matList"],features:[Sn([{provide:Bj,useExisting:i}]),It,Ls],ngContentSelectors:lH,decls:1,vars:0,template:function(e,n){1&e&&(As(),hr(0))},styles:['.mat-subheader{display:flex;box-sizing:border-box;padding:16px;align-items:center}.mat-list-base .mat-subheader{margin:0}button.mat-list-item,button.mat-list-option{padding:0;width:100%;background:none;color:inherit;border:none;outline:inherit;-webkit-tap-highlight-color:transparent;text-align:left}[dir=rtl] button.mat-list-item,[dir=rtl] button.mat-list-option{text-align:right}button.mat-list-item::-moz-focus-inner,button.mat-list-option::-moz-focus-inner{border:0}.mat-list-base{padding-top:8px;display:block;-webkit-tap-highlight-color:transparent}.mat-list-base .mat-subheader{height:48px;line-height:16px}.mat-list-base .mat-subheader:first-child{margin-top:-8px}.mat-list-base .mat-list-item,.mat-list-base .mat-list-option{display:block;height:48px;-webkit-tap-highlight-color:transparent;width:100%;padding:0}.mat-list-base .mat-list-item .mat-list-item-content,.mat-list-base .mat-list-option .mat-list-item-content{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;padding:0 16px;position:relative;height:inherit}.mat-list-base .mat-list-item .mat-list-item-content-reverse,.mat-list-base .mat-list-option .mat-list-item-content-reverse{display:flex;align-items:center;padding:0 16px;flex-direction:row-reverse;justify-content:space-around}.mat-list-base .mat-list-item .mat-list-item-ripple,.mat-list-base .mat-list-option .mat-list-item-ripple{display:block;top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-list-base .mat-list-item.mat-list-item-with-avatar,.mat-list-base .mat-list-option.mat-list-item-with-avatar{height:56px}.mat-list-base .mat-list-item.mat-2-line,.mat-list-base .mat-list-option.mat-2-line{height:72px}.mat-list-base .mat-list-item.mat-3-line,.mat-list-base .mat-list-option.mat-3-line{height:88px}.mat-list-base .mat-list-item.mat-multi-line,.mat-list-base .mat-list-option.mat-multi-line{height:auto}.mat-list-base .mat-list-item.mat-multi-line .mat-list-item-content,.mat-list-base .mat-list-option.mat-multi-line .mat-list-item-content{padding-top:16px;padding-bottom:16px}.mat-list-base .mat-list-item .mat-list-text,.mat-list-base .mat-list-option .mat-list-text{display:flex;flex-direction:column;flex:auto;box-sizing:border-box;overflow:hidden;padding:0}.mat-list-base .mat-list-item .mat-list-text>*,.mat-list-base .mat-list-option .mat-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-list-base .mat-list-item .mat-list-text:empty,.mat-list-base .mat-list-option .mat-list-text:empty{display:none}.mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:0;padding-left:16px}[dir=rtl] .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:0}.mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-left:0;padding-right:16px}[dir=rtl] .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:0;padding-left:16px}.mat-list-base .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:16px}.mat-list-base .mat-list-item .mat-list-avatar,.mat-list-base .mat-list-option .mat-list-avatar{flex-shrink:0;width:40px;height:40px;border-radius:50%;object-fit:cover}.mat-list-base .mat-list-item .mat-list-avatar~.mat-divider-inset,.mat-list-base .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:72px;width:calc(100% - 72px)}[dir=rtl] .mat-list-base .mat-list-item .mat-list-avatar~.mat-divider-inset,[dir=rtl] .mat-list-base .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:auto;margin-right:72px}.mat-list-base .mat-list-item .mat-list-icon,.mat-list-base .mat-list-option .mat-list-icon{flex-shrink:0;width:24px;height:24px;font-size:24px;box-sizing:content-box;border-radius:50%;padding:4px}.mat-list-base .mat-list-item .mat-list-icon~.mat-divider-inset,.mat-list-base .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:64px;width:calc(100% - 64px)}[dir=rtl] .mat-list-base .mat-list-item .mat-list-icon~.mat-divider-inset,[dir=rtl] .mat-list-base .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:auto;margin-right:64px}.mat-list-base .mat-list-item .mat-divider,.mat-list-base .mat-list-option .mat-divider{position:absolute;bottom:0;left:0;width:100%;margin:0}[dir=rtl] .mat-list-base .mat-list-item .mat-divider,[dir=rtl] .mat-list-base .mat-list-option .mat-divider{margin-left:auto;margin-right:0}.mat-list-base .mat-list-item .mat-divider.mat-divider-inset,.mat-list-base .mat-list-option .mat-divider.mat-divider-inset{position:absolute}.mat-list-base[dense]{padding-top:4px;display:block}.mat-list-base[dense] .mat-subheader{height:40px;line-height:8px}.mat-list-base[dense] .mat-subheader:first-child{margin-top:-4px}.mat-list-base[dense] .mat-list-item,.mat-list-base[dense] .mat-list-option{display:block;height:40px;-webkit-tap-highlight-color:transparent;width:100%;padding:0}.mat-list-base[dense] .mat-list-item .mat-list-item-content,.mat-list-base[dense] .mat-list-option .mat-list-item-content{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;padding:0 16px;position:relative;height:inherit}.mat-list-base[dense] .mat-list-item .mat-list-item-content-reverse,.mat-list-base[dense] .mat-list-option .mat-list-item-content-reverse{display:flex;align-items:center;padding:0 16px;flex-direction:row-reverse;justify-content:space-around}.mat-list-base[dense] .mat-list-item .mat-list-item-ripple,.mat-list-base[dense] .mat-list-option .mat-list-item-ripple{display:block;top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar{height:48px}.mat-list-base[dense] .mat-list-item.mat-2-line,.mat-list-base[dense] .mat-list-option.mat-2-line{height:60px}.mat-list-base[dense] .mat-list-item.mat-3-line,.mat-list-base[dense] .mat-list-option.mat-3-line{height:76px}.mat-list-base[dense] .mat-list-item.mat-multi-line,.mat-list-base[dense] .mat-list-option.mat-multi-line{height:auto}.mat-list-base[dense] .mat-list-item.mat-multi-line .mat-list-item-content,.mat-list-base[dense] .mat-list-option.mat-multi-line .mat-list-item-content{padding-top:16px;padding-bottom:16px}.mat-list-base[dense] .mat-list-item .mat-list-text,.mat-list-base[dense] .mat-list-option .mat-list-text{display:flex;flex-direction:column;flex:auto;box-sizing:border-box;overflow:hidden;padding:0}.mat-list-base[dense] .mat-list-item .mat-list-text>*,.mat-list-base[dense] .mat-list-option .mat-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-list-base[dense] .mat-list-item .mat-list-text:empty,.mat-list-base[dense] .mat-list-option .mat-list-text:empty{display:none}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:0;padding-left:16px}[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:0}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-left:0;padding-right:16px}[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:0;padding-left:16px}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:16px}.mat-list-base[dense] .mat-list-item .mat-list-avatar,.mat-list-base[dense] .mat-list-option .mat-list-avatar{flex-shrink:0;width:36px;height:36px;border-radius:50%;object-fit:cover}.mat-list-base[dense] .mat-list-item .mat-list-avatar~.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:68px;width:calc(100% - 68px)}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-list-avatar~.mat-divider-inset,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:auto;margin-right:68px}.mat-list-base[dense] .mat-list-item .mat-list-icon,.mat-list-base[dense] .mat-list-option .mat-list-icon{flex-shrink:0;width:20px;height:20px;font-size:20px;box-sizing:content-box;border-radius:50%;padding:4px}.mat-list-base[dense] .mat-list-item .mat-list-icon~.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:60px;width:calc(100% - 60px)}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-list-icon~.mat-divider-inset,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:auto;margin-right:60px}.mat-list-base[dense] .mat-list-item .mat-divider,.mat-list-base[dense] .mat-list-option .mat-divider{position:absolute;bottom:0;left:0;width:100%;margin:0}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-divider,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-divider{margin-left:auto;margin-right:0}.mat-list-base[dense] .mat-list-item .mat-divider.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-divider.mat-divider-inset{position:absolute}.mat-nav-list a{text-decoration:none;color:inherit}.mat-nav-list .mat-list-item{cursor:pointer;outline:none}mat-action-list .mat-list-item{cursor:pointer;outline:inherit}.mat-list-option:not(.mat-list-item-disabled){cursor:pointer;outline:none}.mat-list-item-disabled{pointer-events:none}.cdk-high-contrast-active .mat-list-item-disabled{opacity:.5}.cdk-high-contrast-active :host .mat-list-item-disabled{opacity:.5}.cdk-high-contrast-active .mat-selection-list:focus{outline-style:dotted}.cdk-high-contrast-active .mat-list-option:hover,.cdk-high-contrast-active .mat-list-option:focus,.cdk-high-contrast-active .mat-nav-list .mat-list-item:hover,.cdk-high-contrast-active .mat-nav-list .mat-list-item:focus,.cdk-high-contrast-active mat-action-list .mat-list-item:hover,.cdk-high-contrast-active mat-action-list .mat-list-item:focus{outline:dotted 1px;z-index:1}.cdk-high-contrast-active .mat-list-single-selected-option::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}.cdk-high-contrast-active [dir=rtl] .mat-list-single-selected-option::after{right:auto;left:16px}@media(hover: none){.mat-list-option:not(.mat-list-single-selected-option):not(.mat-list-item-disabled):hover,.mat-nav-list .mat-list-item:not(.mat-list-item-disabled):hover,.mat-action-list .mat-list-item:not(.mat-list-item-disabled):hover{background:none}}\n'],encapsulation:2,changeDetection:0}),i})(),Hj=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275dir=Be({type:i,selectors:[["","mat-list-avatar",""],["","matListAvatar",""]],hostAttrs:[1,"mat-list-avatar"]}),i})(),cH=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275dir=Be({type:i,selectors:[["","mat-list-icon",""],["","matListIcon",""]],hostAttrs:[1,"mat-list-icon"]}),i})(),Vj=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275dir=Be({type:i,selectors:[["","mat-subheader",""],["","matSubheader",""]],hostAttrs:[1,"mat-subheader"]}),i})(),Jb=(()=>{class i extends Jhe{constructor(e,n,r,s){super(),this._element=e,this._isInteractiveList=!1,this._destroyed=new ii,this._disabled=!1,this._isInteractiveList=!!(r||s&&"action-list"===s._getListType()),this._list=r||s;const a=this._getHostElement();"button"===a.nodeName.toLowerCase()&&!a.hasAttribute("type")&&a.setAttribute("type","button"),this._list&&this._list._stateChanges.pipe($n(this._destroyed)).subscribe(()=>{n.markForCheck()})}get disabled(){return this._disabled||!(!this._list||!this._list.disabled)}set disabled(e){this._disabled=tn(e)}ngAfterContentInit(){!function _7(i,t,e="mat"){i.changes.pipe(Tl(i)).subscribe(({length:n})=>{U1(t,`${e}-2-line`,!1),U1(t,`${e}-3-line`,!1),U1(t,`${e}-multi-line`,!1),2===n||3===n?U1(t,`${e}-${n}-line`,!0):n>3&&U1(t,`${e}-multi-line`,!0)})}(this._lines,this._element)}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_isRippleDisabled(){return!this._isInteractiveList||this.disableRipple||!(!this._list||!this._list.disableRipple)}_getHostElement(){return this._element.nativeElement}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(Pn),B(Nj,8),B(Bj,8))},i.\u0275cmp=ei({type:i,selectors:[["mat-list-item"],["a","mat-list-item",""],["button","mat-list-item",""]],contentQueries:function(e,n,r){if(1&e&&(Er(r,Hj,5),Er(r,cH,5),Er(r,Hb,5)),2&e){let s;jt(s=qt())&&(n._avatar=s.first),jt(s=qt())&&(n._icon=s.first),jt(s=qt())&&(n._lines=s)}},hostAttrs:[1,"mat-list-item","mat-focus-indicator"],hostVars:6,hostBindings:function(e,n){2&e&&N("mat-list-item-disabled",n.disabled)("mat-list-item-avatar",n._avatar||n._icon)("mat-list-item-with-avatar",n._avatar||n._icon)},inputs:{disableRipple:"disableRipple",disabled:"disabled"},exportAs:["matListItem"],features:[It],ngContentSelectors:Xhe,decls:6,vars:2,consts:[[1,"mat-list-item-content"],["mat-ripple","",1,"mat-list-item-ripple",3,"matRippleTrigger","matRippleDisabled"],[1,"mat-list-text"]],template:function(e,n){1&e&&(As(qhe),Z(0,"span",0),yt(1,"span",1),hr(2),Z(3,"span",2),hr(4,1),J(),hr(5,2),J()),2&e&&(se(1),fe("matRippleTrigger",n._getHostElement())("matRippleDisabled",n._isRippleDisabled()))},directives:[hh],encapsulation:2,changeDetection:0}),i})(),Uj=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[Ak,zf,jn,oN,ka],Ak,jn,oN,jhe]}),i})();function sde(i,t){if(1&i){const e=Wi();Z(0,"a",6),je("click",function(){const s=gt(e).$implicit;return Re(2).load(s)}),Z(1,"mat-icon",7),ue(2,"change_history"),J(),Z(3,"span",8)(4,"strong"),ue(5),J()(),Z(6,"span",8),ue(7),J(),Z(8,"span",8),ue(9),J()()}if(2&i){const e=t.$implicit,n=Re(2);se(5),hi("ID: ",e.id,", ",n.format(e.timestamp),""),se(2),hi("Objects: ",e.objects,", Segments: ",e.segments,""),se(2),ui("Features: ",e.features.join(", "),"")}}function ode(i,t){if(1&i&&(Z(0,"mat-nav-list"),Ue(1,sde,10,5,"a",5),ti(2,"async"),J()),2&i){const e=Re();se(1),fe("ngForOf",Qi(2,1,e._history))}}function ade(i,t){1&i&&(Z(0,"p"),ue(1,"No history available!"),J())}let lde=(()=>{class i{constructor(e,n){this._service=e,this._query=n,this._count=e.count,this._history=e.list}load(e){this._query.load(e)}clear(){this._service.clear(),this._count=this._service.count,this._history=this._service.list}download(){this._service.download()}format(e){return new Date(e).toISOString()}}return i.\u0275fac=function(e){return new(e||i)(B($N),B(Rc))},i.\u0275cmp=ei({type:i,selectors:[["app-history"]],decls:14,vars:8,consts:[[1,"mat-h2"],[1,"spacer-flex"],["mat-icon-button","","matTooltip","Clears the query history.",3,"click"],["mat-icon-button","","matTooltip","Downloads the entire history as ZIP file.",3,"click"],[4,"ngIf"],["mat-list-item","",3,"click",4,"ngFor","ngForOf"],["mat-list-item","",3,"click"],["mat-list-icon",""],["mat-line",""]],template:function(e,n){1&e&&(Z(0,"div")(1,"h2",0),ue(2,"Query history"),J(),yt(3,"span",1),Z(4,"button",2),je("click",function(){return n.clear()}),Z(5,"mat-icon"),ue(6,"delete"),J()(),Z(7,"button",3),je("click",function(){return n.download()}),Z(8,"mat-icon"),ue(9,"cloud_download"),J()()(),Ue(10,ode,3,3,"mat-nav-list",4),ti(11,"async"),Ue(12,ade,2,0,"p",4),ti(13,"async")),2&e&&(A("display","flex"),se(10),fe("ngIf",Qi(11,4,n._count)>0),se(2),fe("ngIf",0==Qi(13,6,n._count)))},directives:[Mo,Fo,vo,ms,$he,mo,Jb,cH,Hb],pipes:[Xc],encapsulation:2}),i})();function cde(i,t){}const ude={bottomSheetState:Xd("state",[Cl("void, hidden",Xs({transform:"translateY(100%)"})),Cl("visible",Xs({transform:"translateY(0%)"})),Ml("visible => void, visible => hidden",YR([ql(`${g7.COMPLEX} ${m7.ACCELERATION_CURVE}`),w1("@*",x1(),{optional:!0})])),Ml("void => visible",YR([ql(`${g7.EXITING} ${m7.DECELERATION_CURVE}`),w1("@*",x1(),{optional:!0})]))])},hde=new gi("MatBottomSheetData");class uH{constructor(){this.data=null,this.hasBackdrop=!0,this.disableClose=!1,this.ariaLabel=null,this.closeOnNavigation=!0,this.autoFocus="dialog",this.restoreFocus=!0}}let dde=(()=>{class i extends L1{constructor(e,n,r,s,a,l,u,h){super(),this._elementRef=e,this._changeDetectorRef=n,this._focusTrapFactory=r,this._interactivityChecker=s,this._ngZone=a,this.bottomSheetConfig=h,this._animationState="void",this._animationStateChanged=new Si,this._elementFocusedBeforeOpened=null,this.attachDomPortal=m=>(this._validatePortalAttached(),this._setPanelClass(),this._savePreviouslyFocusedElement(),this._portalOutlet.attachDomPortal(m)),this._document=u,this._breakpointSubscription=l.observe([my_Medium,my_Large,"(min-width: 1920px)"]).subscribe(()=>{this._toggleClass("mat-bottom-sheet-container-medium",l.isMatched(my_Medium)),this._toggleClass("mat-bottom-sheet-container-large",l.isMatched(my_Large)),this._toggleClass("mat-bottom-sheet-container-xlarge",l.isMatched("(min-width: 1920px)"))})}attachComponentPortal(e){return this._validatePortalAttached(),this._setPanelClass(),this._savePreviouslyFocusedElement(),this._portalOutlet.attachComponentPortal(e)}attachTemplatePortal(e){return this._validatePortalAttached(),this._setPanelClass(),this._savePreviouslyFocusedElement(),this._portalOutlet.attachTemplatePortal(e)}enter(){this._destroyed||(this._animationState="visible",this._changeDetectorRef.detectChanges())}exit(){this._destroyed||(this._animationState="hidden",this._changeDetectorRef.markForCheck())}ngOnDestroy(){this._breakpointSubscription.unsubscribe(),this._destroyed=!0}_onAnimationDone(e){"hidden"===e.toState?this._restoreFocus():"visible"===e.toState&&this._trapFocus(),this._animationStateChanged.emit(e)}_onAnimationStart(e){this._animationStateChanged.emit(e)}_toggleClass(e,n){this._elementRef.nativeElement.classList.toggle(e,n)}_validatePortalAttached(){this._portalOutlet.hasAttached()}_setPanelClass(){this._elementRef.nativeElement.classList.add(...E1(this.bottomSheetConfig.panelClass||[]))}_forceFocus(e,n){this._interactivityChecker.isFocusable(e)||(e.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const r=()=>{e.removeEventListener("blur",r),e.removeEventListener("mousedown",r),e.removeAttribute("tabindex")};e.addEventListener("blur",r),e.addEventListener("mousedown",r)})),e.focus(n)}_focusByCssSelector(e,n){let r=this._elementRef.nativeElement.querySelector(e);r&&this._forceFocus(r,n)}_trapFocus(){const e=this._elementRef.nativeElement;switch(this._focusTrap||(this._focusTrap=this._focusTrapFactory.create(e)),this.bottomSheetConfig.autoFocus){case!1:case"dialog":const n=zw();n!==e&&!e.contains(n)&&e.focus();break;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady();break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this.bottomSheetConfig.autoFocus)}}_restoreFocus(){const e=this._elementFocusedBeforeOpened;if(this.bottomSheetConfig.restoreFocus&&e&&"function"==typeof e.focus){const n=zw(),r=this._elementRef.nativeElement;(!n||n===this._document.body||n===r||r.contains(n))&&e.focus()}this._focusTrap&&this._focusTrap.destroy()}_savePreviouslyFocusedElement(){this._elementFocusedBeforeOpened=zw(),this._elementRef.nativeElement.focus&&this._ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>this._elementRef.nativeElement.focus())})}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(Pn),B(JB),B(Tk),B(Rn),B(Rk),B(ar,8),B(uH))},i.\u0275cmp=ei({type:i,selectors:[["mat-bottom-sheet-container"]],viewQuery:function(e,n){if(1&e&&ji(Wm,7),2&e){let r;jt(r=qt())&&(n._portalOutlet=r.first)}},hostAttrs:["tabindex","-1","role","dialog","aria-modal","true",1,"mat-bottom-sheet-container"],hostVars:2,hostBindings:function(e,n){1&e&&Q_("@state.start",function(s){return n._onAnimationStart(s)})("@state.done",function(s){return n._onAnimationDone(s)}),2&e&&(Vi("aria-label",null==n.bottomSheetConfig?null:n.bottomSheetConfig.ariaLabel),Cr("@state",n._animationState))},features:[It],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(e,n){1&e&&Ue(0,cde,0,0,"ng-template",0)},directives:[Wm],styles:[".mat-bottom-sheet-container{padding:8px 16px;min-width:100vw;box-sizing:border-box;display:block;outline:0;max-height:80vh;overflow:auto}.cdk-high-contrast-active .mat-bottom-sheet-container{outline:1px solid}.mat-bottom-sheet-container-xlarge,.mat-bottom-sheet-container-large,.mat-bottom-sheet-container-medium{border-top-left-radius:4px;border-top-right-radius:4px}.mat-bottom-sheet-container-medium{min-width:384px;max-width:calc(100vw - 128px)}.mat-bottom-sheet-container-large{min-width:512px;max-width:calc(100vw - 256px)}.mat-bottom-sheet-container-xlarge{min-width:576px;max-width:calc(100vw - 384px)}\n"],encapsulation:2,data:{animation:[ude.bottomSheetState]}}),i})(),hH=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[Nb,jn,O1],jn]}),i})();class Gj{constructor(t,e){this._overlayRef=e,this._afterDismissed=new ii,this._afterOpened=new ii,this.containerInstance=t,this.disableClose=t.bottomSheetConfig.disableClose,t._animationStateChanged.pipe(vr(n=>"done"===n.phaseName&&"visible"===n.toState),Qr(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),t._animationStateChanged.pipe(vr(n=>"done"===n.phaseName&&"hidden"===n.toState),Qr(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),e.dispose()}),e.detachments().pipe(Qr(1)).subscribe(()=>{this._afterDismissed.next(this._result),this._afterDismissed.complete()}),uo(e.backdropClick(),e.keydownEvents().pipe(vr(n=>27===n.keyCode))).subscribe(n=>{!this.disableClose&&("keydown"!==n.type||!dc(n))&&(n.preventDefault(),this.dismiss())})}dismiss(t){this._afterDismissed.closed||(this.containerInstance._animationStateChanged.pipe(vr(e=>"start"===e.phaseName),Qr(1)).subscribe(e=>{this._closeFallbackTimeout=setTimeout(()=>{this._overlayRef.dispose()},e.totalTime+100),this._overlayRef.detachBackdrop()}),this._result=t,this.containerInstance.exit())}afterDismissed(){return this._afterDismissed}afterOpened(){return this._afterOpened}backdropClick(){return this._overlayRef.backdropClick()}keydownEvents(){return this._overlayRef.keydownEvents()}}const fde=new gi("mat-bottom-sheet-default-options");let pde=(()=>{class i{constructor(e,n,r,s){this._overlay=e,this._injector=n,this._parentBottomSheet=r,this._defaultOptions=s,this._bottomSheetRefAtThisLevel=null}get _openedBottomSheetRef(){const e=this._parentBottomSheet;return e?e._openedBottomSheetRef:this._bottomSheetRefAtThisLevel}set _openedBottomSheetRef(e){this._parentBottomSheet?this._parentBottomSheet._openedBottomSheetRef=e:this._bottomSheetRefAtThisLevel=e}open(e,n){const r=function mde(i,t){return Object.assign(Object.assign({},i),t)}(this._defaultOptions||new uH,n),s=this._createOverlay(r),a=this._attachContainer(s,r),l=new Gj(a,s);if(e instanceof Xo)a.attachTemplatePortal(new Ep(e,null,{$implicit:r.data,bottomSheetRef:l}));else{const u=new hy(e,void 0,this._createInjector(r,l)),h=a.attachComponentPortal(u);l.instance=h.instance}return l.afterDismissed().subscribe(()=>{this._openedBottomSheetRef==l&&(this._openedBottomSheetRef=null)}),this._openedBottomSheetRef?(this._openedBottomSheetRef.afterDismissed().subscribe(()=>l.containerInstance.enter()),this._openedBottomSheetRef.dismiss()):l.containerInstance.enter(),this._openedBottomSheetRef=l,l}dismiss(e){this._openedBottomSheetRef&&this._openedBottomSheetRef.dismiss(e)}ngOnDestroy(){this._bottomSheetRefAtThisLevel&&this._bottomSheetRefAtThisLevel.dismiss()}_attachContainer(e,n){const s=Os.create({parent:n&&n.viewContainerRef&&n.viewContainerRef.injector||this._injector,providers:[{provide:uH,useValue:n}]}),a=new hy(dde,n.viewContainerRef,s);return e.attach(a).instance}_createOverlay(e){const n=new Fb({direction:e.direction,hasBackdrop:e.hasBackdrop,disposeOnNavigation:e.closeOnNavigation,maxWidth:"100%",scrollStrategy:e.scrollStrategy||this._overlay.scrollStrategies.block(),positionStrategy:this._overlay.position().global().centerHorizontally().bottom("0")});return e.backdropClass&&(n.backdropClass=e.backdropClass),this._overlay.create(n)}_createInjector(e,n){const r=e&&e.viewContainerRef&&e.viewContainerRef.injector,s=[{provide:Gj,useValue:n},{provide:hde,useValue:e.data}];return e.direction&&(!r||!r.get(Ia,null,wr.Optional))&&s.push({provide:Ia,useValue:{value:e.direction,change:Qn()}}),Os.create({parent:r||this._injector,providers:s})}}return i.\u0275fac=function(e){return new(e||i)(Ve(Du),Ve(Os),Ve(i,12),Ve(fde,8))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:hH}),i})(),dH=(()=>{class i{constructor(e){this._miscService=e,this.cache={}}getDistinct(e,n){return this.cache[e+n]?new gs(this.cache[e+n]):this._miscService.findDistinctElementsByColumn({table:e,column:n}).pipe(Xl(),Ui(r=>(this.cache[e+n]=r.distinctElements,r.distinctElements)))}}return i.\u0275fac=function(e){return new(e||i)(Ve(nP))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})();class Wj{static getNotificationSymbol(){return"\u{1f534}"}}class $b{static mapEventStream(t){return t.pipe(Ui(e=>({timestamp:e.timestamp,events:e.components.map(n=>$b.mapAtomicEvent(n,e.timestamp)).filter(n=>null!=n)})),Iu((e,n)=>(console.log("An error occurred when mapping an event from the event stream to a VbsSubmission: "+e.message),n)),vr(e=>null!=e))}static mapAtomicEvent(t,e){switch(t.type){case fr.QUERY_MODEL3D:case fr.QUERY_BOOLEAN:case fr.HIGHLIGHT:case fr.QUERY_AUDIO:console.warn(`interaction logging for ${t.type} is unsupported`);break;case fr.PLAY:return{category:"BROWSING",type:"videoPlayer",value:t.context.get("i:mediaobject")+": "+t.context.get("i:starttime"),timestamp:e};case fr.NEW_QUERY_STAGE:case fr.NEW_QUERY_CONTAINER:console.warn(`interaction logging for ${t.type} is unsupported`);break;case fr.QUERY_SEMANTIC:return{category:"SKETCH",type:"semanticSegmentation",timestamp:e};case fr.MLT:return{category:"IMAGE",type:"globalFeatures",value:"mlt",timestamp:e};case fr.QUERY_TAG:return{category:"TEXT",type:"concept",timestamp:e};case fr.QUERY_FULLTEXT:{const r=t.context.get("q:categories"),s=[];return r.indexOf("ocr")>-1&&s.push("ocr"),r.indexOf("asr")>-1&&s.push("asr"),r.indexOf("meta")>-1&&s.push("metadata"),r.indexOf("tagsft")>-1&&s.push("concept"),r.indexOf("scenecaption")>-1&&s.push("caption"),r.indexOf("audio")>-1&&s.push("custom"),r.indexOf("visualtextcoembedding")>-1&&s.push("jointEmbedding"),0===s.length&&console.warn(`no type available for ${r} in interaction logging`),{category:"TEXT",value:s.join(","),timestamp:e}}case fr.QUERY_IMAGE:{const r=t.context.get("q:categories"),s=[];return-1===r.indexOf("localfeatures")?((r.indexOf("globalcolor")>-1||r.context.get("q:categories").indexOf("localcolor")>-1)&&s.push("color"),r.indexOf("edge")>-1&&s.push("edge"),{category:"SKETCH",value:s.join(","),timestamp:e}):(s.push("localFeatures","globalFeatures"),{category:"IMAGE",value:s.join(","),timestamp:e})}case fr.FILTER:return{category:"FILTER",type:t.context.get("f:type"),timestamp:e};case fr.EXPAND:return{category:"BROWSING",type:"temporalContext",timestamp:e};case fr.REFINE:return{category:"BROWSING",type:"explicitSort",value:"adjust weights,"+t.context.get("w:weights").map(r=>r.name+":"+r.weightPercentage/100).join(","),timestamp:e};case fr.EXAMINE:return{category:"BROWSING",type:"videoPlayer",value:t.context.get("i:mediasegment"),timestamp:e};case fr.SCROLL:return{category:"BROWSING",type:"rankedList",timestamp:e};case fr.CLEAR:return{category:"BROWSING",type:"resetAll",timestamp:e};case fr.NAVIGATE:return{category:"BROWSING",type:"toolLayout",timestamp:e}}}static mapTemporalScoreContainer(t,e,n){return{timestamp:Date.now(),sortType:t,resultSetAvailability:"top",results:e.flatMap((r,s)=>r.segments.map(a=>({item:a.objectId,segment:a.sequenceNumber,score:r.score,rank:s}))),events:n.components.map(r=>$b.mapAtomicEvent(r,n.timestamp)).filter(r=>null!=r)}}static mapSegmentScoreContainer(t,e,n){return{timestamp:Date.now(),sortType:t,resultSetAvailability:"top",results:e.map((r,s)=>({item:r.objectId,segment:r.sequenceNumber,score:r.score,rank:s})),events:n.components.map(r=>$b.mapAtomicEvent(r,n.timestamp)).filter(r=>null!=r)}}static featureCategoryToVbsCategory(t){switch(t){case"ocr":case"asr":case"meta":case"tagsft":case"tags":case"scenecaption":case"boolean":return"TEXT";case"semantic":case"edge":case"globalcolor":case"localcolor":return"SKETCH";case"localfeatures":case"localfeatures_fast":return"IMAGE";default:return null}}static featureCategoryToVbsType(t){switch(t){case"ocr":return"OCR";case"asr":return"ASR";case"meta":case"boolean":return"metadata";case"tagsft":case"tags":return"concept";case"scenecaption":return"caption";case"semantic":return"semanticSegmentation";case"edge":return"edge";case"globalcolor":case"localcolor":return"color";case"localfeatures":case"localfeatures_fast":return"localFeatures";default:return null}}}function yde(i,t){if(1&i&&(Z(0,"div",1),ue(1),J()),2&i){const e=t.$implicit;se(1),Xt(e)}}let jj=(()=>{class i{constructor(e){this._lines=[];const n=e[0];let r;e.length>1&&(r=e[1]),this._title=n.sequenceNumber+" : "+n.segmentId+" ("+(100*n.score).toFixed(2)+"%)",r&&(this._lines.push(`Score for path: ${r.score.toFixed(2)}`),this._lines.push(`Path: ${r.segments[0].sequenceNumber} - ${r.segments[r.segments.length-1].sequenceNumber} (${r.segments[0].segmentId} - ${r.segments[r.segments.length-1].segmentId})`)),this._lines.push(`Score for obj (${n.objectScoreContainer.objectid}) : ${n.objectScoreContainer.scorePercentage}%`),n.scores.forEach((s,a)=>{s.forEach((l,u)=>{this._lines.push("(c:"+a+")."+u.name+": "+Math.round(1e3*l)/1e3)})})}}return i.\u0275fac=function(e){return new(e||i)(B(kk))},i.\u0275cmp=ei({type:i,selectors:[["app-feature-details"]],decls:3,vars:2,consts:[["class","snackbar-feature",4,"ngFor","ngForOf"],[1,"snackbar-feature"]],template:function(e,n){1&e&&(Z(0,"h3"),ue(1),J(),Ue(2,yde,2,1,"div",0)),2&e&&(se(1),Xt(n._title),se(1),fe("ngForOf",n._lines))},directives:[mo],styles:[".snackbar-feature[_ngcontent-%COMP%]{color:#fff;opacity:.65;font-size:1.5em;padding:5px}"]}),i})(),rS=(()=>{class i{constructor(e,n){this._mediatype=e,this._object=n}static fromJSON(e){const n=JSON.parse(e);return new i(n.mediatype,n.object)}static fromScoreContainer(e){return new i(e.mediatype,e)}static fromDescriptor(e){return new i(e.mediatype,e)}get mediatype(){return this._mediatype}get object(){return this._object}toJSON(){return JSON.stringify({mediatype:this._mediatype,object:this._object},["mediatype","object","objectId","mediatype","name","path","contentURL"])}}return i.FORMAT="application/vitrivr-mediaobject",i})(),xy=(()=>{class i{constructor(e,n){this._object=e,this._segment=n}static fromJSON(e){const n=JSON.parse(e);return new i(n.object,n.segment)}static fromScoreContainer(e){return new i(e.objectScoreContainer,e)}get object(){return this._object}get segment(){return this._segment}toJSON(){return JSON.stringify({object:this._object,segment:this._segment},["object","segment","objectId","mediatype","name","path","contentURL","segmentId","sequenceNumber","start","end","startabs","endabs"])}}return i.FORMAT="application/vitrivr-mediasegment",i})(),vde=["BLACKWHITE","CYAN","GREEN","ORANGE","YELLOW","BLUE","GRAY","MAGENTA","RED","VIOLET"];class bde{constructor(){this.useOrForMetadataCategoriesFilter=!1,this.mediatypes=new Map,this.dominant=new Map,this.filterMetadata=new Map,this.filterTags=new Set,this.filterRangeMetadata=new Map,this.threshold=0}}let fH=(()=>{class i extends ii{constructor(e){super(),this._online=new gs(!1),this.off=!0,e.configAsObservable.pipe(vr(n=>null!=n._config.competition.collabordinator)).subscribe(n=>{this._config=n,this.connect()})}add(e,...n){this.off||(this._webSocket?this._webSocket.next({action:"ADD",key:`vitrivr~${e.name.toLowerCase()}`,attribute:n}):console.log("Collabordinator service is currently not available."))}remove(e,...n){this.off||(this._webSocket?this._webSocket.next({action:"REMOVE",key:`vitrivr~${e.name.toLowerCase()}`,attribute:n}):console.log("Collabordinator service is currently not available."))}clear(e){this.off||(this._webSocket?this._webSocket.next({action:"CLEAR",key:`vitrivr~${e.name.toLowerCase()}`,attribute:[]}):console.log("Collabordinator service is currently not available."))}connect(){return!!this._config&&(this._webSocket&&this._webSocket.complete(),null===this._config._config.competition.collabordinator?(console.debug("collabordinator not enabled in config"),void(this.off=!0)):(this.off=!1,this._webSocket=wj(this._config._config.competition.collabordinator),this._online.next(!0),this._webSocket.subscribe({next:e=>{this.next(e)},error:e=>{console.error("Error occurred while communicating with Collabordinator web service"),console.error(e),this._online.next(!1)},complete:()=>{console.log("Connection to Collabordinator web service was closed."),this._online.next(!1)}}),!0))}}return i.\u0275fac=function(e){return new(e||i)(Ve(dr))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})(),Bh=(()=>{class i extends gs{constructor(e,n){super(new Map),this._collabordinator=n,this._available=[],this._selections=new Map,this._cache=new Map,e.configAsObservable.subscribe(r=>{this._available.length=0,r.get("tags").forEach(s=>this._available.push(new Nw(s.name,s.hue)))}),n._online.pipe(N1(1),Po(r=>{console.debug(`new collabordinator status: ${r}`),r&&null==this._cache&&(this._cache=new Map)})).subscribe(),n.subscribe(r=>this.synchronize(r))}add(e,...n){var r,s;for(const a of n)this._selections.has(a)||this._selections.set(a,[]),this._selections.get(a).push(e),this.next(this._selections),null===(s=null===(r=this._cache)||void 0===r?void 0:r.get(a))||void 0===s||s.next(this._selections.get(a));this._collabordinator.add(e,...n)}remove(e,...n){var r,s;for(const a of n)if(this._selections.has(a)){const l=this._selections.get(a);this._selections.set(a,l.filter(u=>u!=e)),null===(s=null===(r=this._cache)||void 0===r?void 0:r.get(a))||void 0===s||s.next(this._selections.get(a)),0===l.length&&this._selections.delete(a),this.next(this._selections)}this._collabordinator.remove(e,...n)}toggle(e,n){this._selections.has(n)?-1==this._selections.get(n).findIndex(r=>r==e)?this.add(e,n):this.remove(e,n):this.add(e,n)}isTagged(e){return this._selections.has(e)}hasTag(e,n){return!!this._selections.has(e)&&this._selections.get(e).findIndex(r=>r==n)>-1}getTags(e){var n;const r=[];return null===(n=this._selections.get(e))||void 0===n||n.forEach(s=>r.push(s)),r}clear(e=!0){var n;if(this._selections.clear(),e)for(const r of this._available)this._collabordinator.clear(r);null===(n=this._cache)||void 0===n||n.forEach(r=>r.next([])),this.next(this._selections)}synchronize(e){let n=null;for(const r of this._available)if(r.name.toLowerCase()===e.key.split("~")[1]){n=r;break}if(n){switch(e.action){case"ADD":e.attribute.forEach(r=>{this._selections.has(r)?-1==this._selections.get(r).findIndex(s=>s==n)&&this.add(n,r):this.add(n,r)});break;case"REMOVE":e.attribute.forEach(r=>{this.remove(n,r)});break;case"CLEAR":this.clear(!1)}this.next(this._selections)}}register(e){var n;const r=new ii;return null===(n=this._cache)||void 0===n||n.set(e,r),r.asObservable()}deregister(e){var n;null===(n=this._cache)||void 0===n||n.delete(e)}}return i.\u0275fac=function(e){return new(e||i)(Ve(dr),Ve(fH))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})(),Rp=(()=>{class i{constructor(e){this._selectionService=e,this._segmentFilters=new gs([]),this._objectFilters=new gs([]),this._filters=new bde,this.filterSubject=new gs(this._filters),Object.keys(Kd.MediatypeEnum).map(n=>Kd.MediatypeEnum[n]).forEach(n=>this._filters.mediatypes.set(n,!1)),vde.forEach(n=>this._filters.dominant.set(n,!1))}get mediatypes(){return this._filters.mediatypes}get dominant(){return this._filters.dominant}get filterMetadata(){return this._filters.filterMetadata}get filterTags(){return this._filters.filterTags}get filterRangeMetadata(){return this._filters.filterRangeMetadata}get threshold(){return this._filters.threshold}set threshold(e){e>=0&&e<=1&&(this._filters.threshold=e)}get mediatypeKeys(){return Array.from(this._filters.mediatypes.keys())}get dominantKeys(){return Array.from(this._filters.dominant.keys())}clear(){this._filters.mediatypes.forEach((e,n)=>this._filters.mediatypes.set(n,!1)),this._filters.dominant.forEach((e,n)=>this._filters.dominant.set(n,!1)),this._filters.filterMetadata.clear(),this._filters.filterRangeMetadata.clear(),this._filters.filterTags.clear(),this._filters.threshold=0,this._filters.id=null,this.update()}clearMetadata(){this._filters.filterMetadata.clear(),this._filters.filterRangeMetadata.clear(),this.update()}update(){const e=[],n=[];function r(s,a){if(!a)return!1;const l=Number(a);return!(!l||s[0]&&l<s[0]||s[1]&&l>s[1])}this._filters.id&&(e.push(s=>s.objectid===this._filters.id),n.push(s=>s.objectId===this._filters.id||s.segmentId===this._filters.id)),0===this._filters.filterMetadata.size&&0===this._filters.filterRangeMetadata.size&&0===this._filters.filterTags.size||(console.debug("updating filters"),e.push(s=>{let a=Boolean(!0),l=Boolean(!1),u=Boolean(!1);return this._filters.filterMetadata.forEach((h,m)=>{s.segments.findIndex(_=>h.has(_.metadata.get(m)))>=0||h.has(s.metadata.get(m))?l=!0:a=!1}),this._filters.filterRangeMetadata.forEach((h,m)=>{s.segments.findIndex(_=>r(h,_.metadata.get(m)))>=0||r(h,s.metadata.get(m))?l=!0:a=!1}),0===this._filters.filterTags.size&&(u=!0),this._filters.filterTags.forEach(h=>{s.segments.findIndex(m=>this._selectionService.hasTag(m.segmentId,h))>=0&&(u=!0)}),this._filters.useOrForMetadataCategoriesFilter?l&&u:a&&u}),n.push(s=>{let a=Boolean(!0),l=Boolean(!1);return this._filters.filterMetadata.forEach((u,h)=>{u.has(s.metadata.get(h))||u.has(s.objectScoreContainer.metadata.get(h))?l=!0:a=!1}),this._filters.filterRangeMetadata.forEach((u,h)=>{r(u,s.metadata.get(h))||r(u,s.objectScoreContainer.metadata.get(h))?l=!0:a=!1}),this._filters.useOrForMetadataCategoriesFilter?l:a})),this.mediatypeKeys.every(s=>!1===this._filters.mediatypes.get(s))||(e.push(s=>!0===this._filters.mediatypes.get(s.mediatype)),n.push(s=>!0===this._filters.mediatypes.get(s.objectScoreContainer.mediatype))),this.dominantKeys.every(s=>!1===this._filters.dominant.get(s))||n.push(s=>s.metadata.has("dominantcolor.color")&&!0===this._filters.dominant.get(s.metadata.get("dominantcolor.color").toUpperCase())),this.threshold>0&&(e.push(s=>s.score>this.threshold),n.push(s=>s.score>this.threshold)),this._objectFilters.next(e),this._segmentFilters.next(n),this.filterSubject.next(this._filters)}}return i.\u0275fac=function(e){return new(e||i)(Ve(Bh))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})();function hT(i){return new ft(t=>{eo(i()).subscribe(t)})}function qj(){return gr((i,t)=>{let e=null;i._refCount++;const n=qn(t,void 0,void 0,void 0,()=>{if(!i||i._refCount<=0||0<--i._refCount)return void(e=null);const r=i._connection,s=e;e=null,r&&(!s||r===s)&&r.unsubscribe(),t.unsubscribe()});i.subscribe(n),n.closed||(e=i.connect())})}class xde extends ft{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,zr(t)&&(this.lift=t.lift)}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:t}=this;this._subject=this._connection=null,null==t||t.unsubscribe()}connect(){let t=this._connection;if(!t){t=this._connection=new Q;const e=this.getSubject();t.add(this.source.subscribe(qn(e,void 0,()=>{this._teardown(),e.complete()},n=>{this._teardown(),e.error(n)},()=>this._teardown()))),t.closed&&(this._connection=null,t=Q.EMPTY)}return t}refCount(){return qj()(this)}}function dh(i,t){return gr((e,n)=>{let r=null,s=0,a=!1;const l=()=>a&&!r&&n.complete();e.subscribe(qn(n,u=>{null==r||r.unsubscribe();let h=0;const m=s++;eo(i(u,m)).subscribe(r=qn(n,_=>n.next(t?t(u,_,m,h++):_),()=>{r=null,l()}))},()=>{a=!0,l()}))})}function wde(i,t,e,n,r){return(s,a)=>{let l=e,u=t,h=0;s.subscribe(qn(a,m=>{const _=h++;u=l?i(u,m,_):(l=!0,m),n&&a.next(u)},r&&(()=>{l&&a.next(u),a.complete()})))}}function Xj(i,t){return gr(wde(i,t,arguments.length>=2,!0))}function pH(i){return i<=0?()=>aa:gr((t,e)=>{let n=[];t.subscribe(qn(e,r=>{n.push(r),i<n.length&&n.shift()},()=>{for(const r of n)e.next(r);e.complete()},void 0,()=>{n=null}))})}class ng{constructor(t,e){this.id=t,this.url=e}}class mH extends ng{constructor(t,e,n="imperative",r=null){super(t,e),this.navigationTrigger=n,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class sS extends ng{constructor(t,e,n){super(t,e),this.urlAfterRedirects=n}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Zj extends ng{constructor(t,e,n){super(t,e),this.reason=n}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Cde extends ng{constructor(t,e,n){super(t,e),this.error=n}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Mde extends ng{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Tde extends ng{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Ede extends ng{constructor(t,e,n,r,s){super(t,e),this.urlAfterRedirects=n,this.state=r,this.shouldActivate=s}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Ade extends ng{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Dde extends ng{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Yj{constructor(t){this.route=t}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Kj{constructor(t){this.route=t}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Rde{constructor(t){this.snapshot=t}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class kde{constructor(t){this.snapshot=t}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Pde{constructor(t){this.snapshot=t}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Ide{constructor(t){this.snapshot=t}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Qj{constructor(t,e,n){this.routerEvent=t,this.position=e,this.anchor=n}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const Hs="primary";class Lde{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function oS(i){return new Lde(i)}const Jj="ngNavigationCancelingError";function gH(i){const t=Error("NavigationCancelingError: "+i);return t[Jj]=!0,t}function Fde(i,t,e){const n=e.path.split("/");if(n.length>i.length||"full"===e.pathMatch&&(t.hasChildren()||n.length<i.length))return null;const r={};for(let s=0;s<n.length;s++){const a=n[s],l=i[s];if(a.startsWith(":"))r[a.substring(1)]=l;else if(a!==l.path)return null}return{consumed:i.slice(0,n.length),posParams:r}}function kp(i,t){const e=i?Object.keys(i):void 0,n=t?Object.keys(t):void 0;if(!e||!n||e.length!=n.length)return!1;let r;for(let s=0;s<e.length;s++)if(r=e[s],!$j(i[r],t[r]))return!1;return!0}function $j(i,t){if(Array.isArray(i)&&Array.isArray(t)){if(i.length!==t.length)return!1;const e=[...i].sort(),n=[...t].sort();return e.every((r,s)=>n[s]===r)}return i===t}function e9(i){return Array.prototype.concat.apply([],i)}function t9(i){return i.length>0?i[i.length-1]:null}function Yc(i,t){for(const e in i)i.hasOwnProperty(e)&&t(i[e],e)}function Pp(i){return KM(i)?i:mb(i)?xr(Promise.resolve(i)):Qn(i)}const Hde={exact:function r9(i,t,e){if(!t0(i.segments,t.segments)||!cP(i.segments,t.segments,e)||i.numberOfChildren!==t.numberOfChildren)return!1;for(const n in t.children)if(!i.children[n]||!r9(i.children[n],t.children[n],e))return!1;return!0},subset:s9},i9={exact:function Vde(i,t){return kp(i,t)},subset:function zde(i,t){return Object.keys(t).length<=Object.keys(i).length&&Object.keys(t).every(e=>$j(i[e],t[e]))},ignored:()=>!0};function n9(i,t,e){return Hde[e.paths](i.root,t.root,e.matrixParams)&&i9[e.queryParams](i.queryParams,t.queryParams)&&!("exact"===e.fragment&&i.fragment!==t.fragment)}function s9(i,t,e){return o9(i,t,t.segments,e)}function o9(i,t,e,n){if(i.segments.length>e.length){const r=i.segments.slice(0,e.length);return!(!t0(r,e)||t.hasChildren()||!cP(r,e,n))}if(i.segments.length===e.length){if(!t0(i.segments,e)||!cP(i.segments,e,n))return!1;for(const r in t.children)if(!i.children[r]||!s9(i.children[r],t.children[r],n))return!1;return!0}{const r=e.slice(0,i.segments.length),s=e.slice(i.segments.length);return!!(t0(i.segments,r)&&cP(i.segments,r,n)&&i.children[Hs])&&o9(i.children[Hs],t,s,n)}}function cP(i,t,e){return t.every((n,r)=>i9[e](i[r].parameters,n.parameters))}class e0{constructor(t,e,n){this.root=t,this.queryParams=e,this.fragment=n}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=oS(this.queryParams)),this._queryParamMap}toString(){return Wde.serialize(this)}}class Js{constructor(t,e){this.segments=t,this.children=e,this.parent=null,Yc(e,(n,r)=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return uP(this)}}class dT{constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=oS(this.parameters)),this._parameterMap}toString(){return h9(this)}}function t0(i,t){return i.length===t.length&&i.every((e,n)=>e.path===t[n].path)}class a9{}class l9{parse(t){const e=new $de(t);return new e0(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){const e=`/${fT(t.root,!0)}`,n=function Xde(i){const t=Object.keys(i).map(e=>{const n=i[e];return Array.isArray(n)?n.map(r=>`${hP(e)}=${hP(r)}`).join("&"):`${hP(e)}=${hP(n)}`}).filter(e=>!!e);return t.length?`?${t.join("&")}`:""}(t.queryParams);return`${e}${n}${"string"==typeof t.fragment?`#${function jde(i){return encodeURI(i)}(t.fragment)}`:""}`}}const Wde=new l9;function uP(i){return i.segments.map(t=>h9(t)).join("/")}function fT(i,t){if(!i.hasChildren())return uP(i);if(t){const e=i.children[Hs]?fT(i.children[Hs],!1):"",n=[];return Yc(i.children,(r,s)=>{s!==Hs&&n.push(`${s}:${fT(r,!1)}`)}),n.length>0?`${e}(${n.join("//")})`:e}{const e=function Gde(i,t){let e=[];return Yc(i.children,(n,r)=>{r===Hs&&(e=e.concat(t(n,r)))}),Yc(i.children,(n,r)=>{r!==Hs&&(e=e.concat(t(n,r)))}),e}(i,(n,r)=>r===Hs?[fT(i.children[Hs],!1)]:[`${r}:${fT(n,!1)}`]);return 1===Object.keys(i.children).length&&null!=i.children[Hs]?`${uP(i)}/${e[0]}`:`${uP(i)}/(${e.join("//")})`}}function c9(i){return encodeURIComponent(i).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function hP(i){return c9(i).replace(/%3B/gi,";")}function _H(i){return c9(i).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function dP(i){return decodeURIComponent(i)}function u9(i){return dP(i.replace(/\+/g,"%20"))}function h9(i){return`${_H(i.path)}${function qde(i){return Object.keys(i).map(t=>`;${_H(t)}=${_H(i[t])}`).join("")}(i.parameters)}`}const Zde=/^[^\/()?;=#]+/;function fP(i){const t=i.match(Zde);return t?t[0]:""}const Yde=/^[^=?&#]+/,Qde=/^[^&#]+/;class $de{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Js([],{}):new Js([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(n[Hs]=new Js(t,e)),n}parseSegment(){const t=fP(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(t),new dT(dP(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const e=fP(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){const r=fP(this.remaining);r&&(n=r,this.capture(n))}t[dP(e)]=dP(n)}parseQueryParam(t){const e=function Kde(i){const t=i.match(Yde);return t?t[0]:""}(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){const a=function Jde(i){const t=i.match(Qde);return t?t[0]:""}(this.remaining);a&&(n=a,this.capture(n))}const r=u9(e),s=u9(n);if(t.hasOwnProperty(r)){let a=t[r];Array.isArray(a)||(a=[a],t[r]=a),a.push(s)}else t[r]=s}parseParens(t){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=fP(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error(`Cannot parse url '${this.url}'`);let s;n.indexOf(":")>-1?(s=n.substr(0,n.indexOf(":")),this.capture(s),this.capture(":")):t&&(s=Hs);const a=this.parseChildren();e[s]=1===Object.keys(a).length?a[Hs]:new Js([],a),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new Error(`Expected "${t}".`)}}class d9{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){const e=yH(t,this._root);return e?e.children.map(n=>n.value):[]}firstChild(t){const e=yH(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){const e=vH(t,this._root);return e.length<2?[]:e[e.length-2].children.map(r=>r.value).filter(r=>r!==t)}pathFromRoot(t){return vH(t,this._root).map(e=>e.value)}}function yH(i,t){if(i===t.value)return t;for(const e of t.children){const n=yH(i,e);if(n)return n}return null}function vH(i,t){if(i===t.value)return[t];for(const e of t.children){const n=vH(i,e);if(n.length)return n.unshift(t),n}return[]}class rg{constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}}function aS(i){const t={};return i&&i.children.forEach(e=>t[e.value.outlet]=e),t}class f9 extends d9{constructor(t,e){super(t),this.snapshot=e,bH(this,t)}toString(){return this.snapshot.toString()}}function p9(i,t){const e=function efe(i,t){const a=new pP([],{},{},"",{},Hs,t,null,i.root,-1,{});return new g9("",new rg(a,[]))}(i,t),n=new gs([new dT("",{})]),r=new gs({}),s=new gs({}),a=new gs({}),l=new gs(""),u=new wy(n,r,a,l,s,Hs,t,e.root);return u.snapshot=e.root,new f9(new rg(u,[]),e)}class wy{constructor(t,e,n,r,s,a,l,u){this.url=t,this.params=e,this.queryParams=n,this.fragment=r,this.data=s,this.outlet=a,this.component=l,this._futureSnapshot=u}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(Ui(t=>oS(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Ui(t=>oS(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function m9(i,t="emptyOnly"){const e=i.pathFromRoot;let n=0;if("always"!==t)for(n=e.length-1;n>=1;){const r=e[n],s=e[n-1];if(r.routeConfig&&""===r.routeConfig.path)n--;else{if(s.component)break;n--}}return function tfe(i){return i.reduce((t,e)=>({params:Object.assign(Object.assign({},t.params),e.params),data:Object.assign(Object.assign({},t.data),e.data),resolve:Object.assign(Object.assign({},t.resolve),e._resolvedData)}),{params:{},data:{},resolve:{}})}(e.slice(n))}class pP{constructor(t,e,n,r,s,a,l,u,h,m,_){this.url=t,this.params=e,this.queryParams=n,this.fragment=r,this.data=s,this.outlet=a,this.component=l,this.routeConfig=u,this._urlSegment=h,this._lastPathIndex=m,this._resolve=_}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=oS(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=oS(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(n=>n.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class g9 extends d9{constructor(t,e){super(e),this.url=t,bH(this,e)}toString(){return _9(this._root)}}function bH(i,t){t.value._routerState=i,t.children.forEach(e=>bH(i,e))}function _9(i){const t=i.children.length>0?` { ${i.children.map(_9).join(", ")} } `:"";return`${i.value}${t}`}function xH(i){if(i.snapshot){const t=i.snapshot,e=i._futureSnapshot;i.snapshot=e,kp(t.queryParams,e.queryParams)||i.queryParams.next(e.queryParams),t.fragment!==e.fragment&&i.fragment.next(e.fragment),kp(t.params,e.params)||i.params.next(e.params),function Bde(i,t){if(i.length!==t.length)return!1;for(let e=0;e<i.length;++e)if(!kp(i[e],t[e]))return!1;return!0}(t.url,e.url)||i.url.next(e.url),kp(t.data,e.data)||i.data.next(e.data)}else i.snapshot=i._futureSnapshot,i.data.next(i._futureSnapshot.data)}function wH(i,t){const e=kp(i.params,t.params)&&function Ude(i,t){return t0(i,t)&&i.every((e,n)=>kp(e.parameters,t[n].parameters))}(i.url,t.url);return e&&!(!i.parent!=!t.parent)&&(!i.parent||wH(i.parent,t.parent))}function pT(i,t,e){if(e&&i.shouldReuseRoute(t.value,e.value.snapshot)){const n=e.value;n._futureSnapshot=t.value;const r=function nfe(i,t,e){return t.children.map(n=>{for(const r of e.children)if(i.shouldReuseRoute(n.value,r.value.snapshot))return pT(i,n,r);return pT(i,n)})}(i,t,e);return new rg(n,r)}{if(i.shouldAttach(t.value)){const s=i.retrieve(t.value);if(null!==s){const a=s.route;return a.value._futureSnapshot=t.value,a.children=t.children.map(l=>pT(i,l)),a}}const n=function rfe(i){return new wy(new gs(i.url),new gs(i.params),new gs(i.queryParams),new gs(i.fragment),new gs(i.data),i.outlet,i.component,i)}(t.value),r=t.children.map(s=>pT(i,s));return new rg(n,r)}}function mP(i){return"object"==typeof i&&null!=i&&!i.outlets&&!i.segmentPath}function mT(i){return"object"==typeof i&&null!=i&&i.outlets}function SH(i,t,e,n,r){let s={};if(n&&Yc(n,(l,u)=>{s[u]=Array.isArray(l)?l.map(h=>`${h}`):`${l}`}),i===t)return new e0(e,s,r);const a=y9(i,t,e);return new e0(a,s,r)}function y9(i,t,e){const n={};return Yc(i.children,(r,s)=>{n[s]=r===t?e:y9(r,t,e)}),new Js(i.segments,n)}class v9{constructor(t,e,n){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=n,t&&n.length>0&&mP(n[0]))throw new Error("Root segment cannot have matrix parameters");const r=n.find(mT);if(r&&r!==t9(n))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class CH{constructor(t,e,n){this.segmentGroup=t,this.processChildren=e,this.index=n}}function b9(i,t,e){if(i||(i=new Js([],{})),0===i.segments.length&&i.hasChildren())return gP(i,t,e);const n=function ufe(i,t,e){let n=0,r=t;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<i.segments.length;){if(n>=e.length)return s;const a=i.segments[r],l=e[n];if(mT(l))break;const u=`${l}`,h=n<e.length-1?e[n+1]:null;if(r>0&&void 0===u)break;if(u&&h&&"object"==typeof h&&void 0===h.outlets){if(!w9(u,h,a))return s;n+=2}else{if(!w9(u,{},a))return s;n++}r++}return{match:!0,pathIndex:r,commandIndex:n}}(i,t,e),r=e.slice(n.commandIndex);if(n.match&&n.pathIndex<i.segments.length){const s=new Js(i.segments.slice(0,n.pathIndex),{});return s.children[Hs]=new Js(i.segments.slice(n.pathIndex),i.children),gP(s,0,r)}return n.match&&0===r.length?new Js(i.segments,{}):n.match&&!i.hasChildren()?MH(i,t,e):n.match?gP(i,0,r):MH(i,t,e)}function gP(i,t,e){if(0===e.length)return new Js(i.segments,{});{const n=function cfe(i){return mT(i[0])?i[0].outlets:{[Hs]:i}}(e),r={};return Yc(n,(s,a)=>{"string"==typeof s&&(s=[s]),null!==s&&(r[a]=b9(i.children[a],t,s))}),Yc(i.children,(s,a)=>{void 0===n[a]&&(r[a]=s)}),new Js(i.segments,r)}}function MH(i,t,e){const n=i.segments.slice(0,t);let r=0;for(;r<e.length;){const s=e[r];if(mT(s)){const u=hfe(s.outlets);return new Js(n,u)}if(0===r&&mP(e[0])){n.push(new dT(i.segments[t].path,x9(e[0]))),r++;continue}const a=mT(s)?s.outlets[Hs]:`${s}`,l=r<e.length-1?e[r+1]:null;a&&l&&mP(l)?(n.push(new dT(a,x9(l))),r+=2):(n.push(new dT(a,{})),r++)}return new Js(n,{})}function hfe(i){const t={};return Yc(i,(e,n)=>{"string"==typeof e&&(e=[e]),null!==e&&(t[n]=MH(new Js([],{}),0,e))}),t}function x9(i){const t={};return Yc(i,(e,n)=>t[n]=`${e}`),t}function w9(i,t,e){return i==e.path&&kp(t,e.parameters)}class ffe{constructor(t,e,n,r){this.routeReuseStrategy=t,this.futureState=e,this.currState=n,this.forwardEvent=r}activate(t){const e=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,n,t),xH(this.futureState.root),this.activateChildRoutes(e,n,t)}deactivateChildRoutes(t,e,n){const r=aS(e);t.children.forEach(s=>{const a=s.value.outlet;this.deactivateRoutes(s,r[a],n),delete r[a]}),Yc(r,(s,a)=>{this.deactivateRouteAndItsChildren(s,n)})}deactivateRoutes(t,e,n){const r=t.value,s=e?e.value:null;if(r===s)if(r.component){const a=n.getContext(r.outlet);a&&this.deactivateChildRoutes(t,e,a.children)}else this.deactivateChildRoutes(t,e,n);else s&&this.deactivateRouteAndItsChildren(e,n)}deactivateRouteAndItsChildren(t,e){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){const n=e.getContext(t.value.outlet),r=n&&t.value.component?n.children:e,s=aS(t);for(const a of Object.keys(s))this.deactivateRouteAndItsChildren(s[a],r);if(n&&n.outlet){const a=n.outlet.detach(),l=n.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:a,route:t,contexts:l})}}deactivateRouteAndOutlet(t,e){const n=e.getContext(t.value.outlet),r=n&&t.value.component?n.children:e,s=aS(t);for(const a of Object.keys(s))this.deactivateRouteAndItsChildren(s[a],r);n&&n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated(),n.attachRef=null,n.resolver=null,n.route=null)}activateChildRoutes(t,e,n){const r=aS(e);t.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],n),this.forwardEvent(new Ide(s.value.snapshot))}),t.children.length&&this.forwardEvent(new kde(t.value.snapshot))}activateRoutes(t,e,n){const r=t.value,s=e?e.value:null;if(xH(r),r===s)if(r.component){const a=n.getOrCreateContext(r.outlet);this.activateChildRoutes(t,e,a.children)}else this.activateChildRoutes(t,e,n);else if(r.component){const a=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const l=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),a.children.onOutletReAttached(l.contexts),a.attachRef=l.componentRef,a.route=l.route.value,a.outlet&&a.outlet.attach(l.componentRef,l.route.value),xH(l.route.value),this.activateChildRoutes(t,null,a.children)}else{const l=function pfe(i){for(let t=i.parent;t;t=t.parent){const e=t.routeConfig;if(e&&e._loadedConfig)return e._loadedConfig;if(e&&e.component)return null}return null}(r.snapshot),u=l?l.module.componentFactoryResolver:null;a.attachRef=null,a.route=r,a.resolver=u,a.outlet&&a.outlet.activateWith(r,u),this.activateChildRoutes(t,null,a.children)}}else this.activateChildRoutes(t,null,n)}}class TH{constructor(t,e){this.routes=t,this.module=e}}function Sy(i){return"function"==typeof i}function n0(i){return i instanceof e0}const gT=Symbol("INITIAL_VALUE");function _T(){return dh(i=>zb(i.map(t=>t.pipe(Qr(1),Tl(gT)))).pipe(Xj((t,e)=>{let n=!1;return e.reduce((r,s,a)=>r!==gT?r:(s===gT&&(n=!0),n||!1!==s&&a!==e.length-1&&!n0(s)?r:s),t)},gT),vr(t=>t!==gT),Ui(t=>n0(t)?t:!0===t),Qr(1)))}class bfe{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new yT,this.attachRef=null}}class yT{constructor(){this.contexts=new Map}onChildOutletCreated(t,e){const n=this.getOrCreateContext(t);n.outlet=e,this.contexts.set(t,n)}onChildOutletDestroyed(t){const e=this.getContext(t);e&&(e.outlet=null,e.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let e=this.getContext(t);return e||(e=new bfe,this.contexts.set(t,e)),e}getContext(t){return this.contexts.get(t)||null}}let EH=(()=>{class i{constructor(e,n,r,s,a){this.parentContexts=e,this.location=n,this.resolver=r,this.changeDetector=a,this.activated=null,this._activatedRoute=null,this.activateEvents=new Si,this.deactivateEvents=new Si,this.attachEvents=new Si,this.detachEvents=new Si,this.name=s||Hs,e.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const e=this.parentContexts.getContext(this.name);e&&e.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,n){this.activated=e,this._activatedRoute=n,this.location.insert(e.hostView),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){const e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,n){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=e;const a=(n=n||this.resolver).resolveComponentFactory(e._futureSnapshot.routeConfig.component),l=this.parentContexts.getOrCreateContext(this.name).children,u=new xfe(e,l,this.location.injector);this.activated=this.location.createComponent(a,this.location.length,u),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return i.\u0275fac=function(e){return new(e||i)(B(yT),B(Ko),B(xp),zc("name"),B(Pn))},i.\u0275dir=Be({type:i,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),i})();class xfe{constructor(t,e,n){this.route=t,this.childContexts=e,this.parent=n}get(t,e){return t===wy?this.route:t===yT?this.childContexts:this.parent.get(t,e)}}let S9=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=ei({type:i,selectors:[["ng-component"]],decls:1,vars:0,template:function(e,n){1&e&&yt(0,"router-outlet")},directives:[EH],encapsulation:2}),i})();function C9(i,t=""){for(let e=0;e<i.length;e++){const n=i[e];wfe(n,Sfe(t,n))}}function wfe(i,t){i.children&&C9(i.children,t)}function Sfe(i,t){return t?i||t.path?i&&!t.path?`${i}/`:!i&&t.path?t.path:`${i}/${t.path}`:"":i}function AH(i){const t=i.children&&i.children.map(AH),e=t?Object.assign(Object.assign({},i),{children:t}):Object.assign({},i);return!e.component&&(t||e.loadChildren)&&e.outlet&&e.outlet!==Hs&&(e.component=S9),e}function Qd(i){return i.outlet||Hs}function M9(i,t){const e=i.filter(n=>Qd(n)===t);return e.push(...i.filter(n=>Qd(n)!==t)),e}const T9={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function _P(i,t,e){var n;if(""===t.path)return"full"===t.pathMatch&&(i.hasChildren()||e.length>0)?Object.assign({},T9):{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};const s=(t.matcher||Fde)(e,i,t);if(!s)return Object.assign({},T9);const a={};Yc(s.posParams,(u,h)=>{a[h]=u.path});const l=s.consumed.length>0?Object.assign(Object.assign({},a),s.consumed[s.consumed.length-1].parameters):a;return{matched:!0,consumedSegments:s.consumed,remainingSegments:e.slice(s.consumed.length),parameters:l,positionalParamSegments:null!==(n=s.posParams)&&void 0!==n?n:{}}}function yP(i,t,e,n,r="corrected"){if(e.length>0&&function Tfe(i,t,e){return e.some(n=>vP(i,t,n)&&Qd(n)!==Hs)}(i,e,n)){const a=new Js(t,function Mfe(i,t,e,n){const r={};r[Hs]=n,n._sourceSegment=i,n._segmentIndexShift=t.length;for(const s of e)if(""===s.path&&Qd(s)!==Hs){const a=new Js([],{});a._sourceSegment=i,a._segmentIndexShift=t.length,r[Qd(s)]=a}return r}(i,t,n,new Js(e,i.children)));return a._sourceSegment=i,a._segmentIndexShift=t.length,{segmentGroup:a,slicedSegments:[]}}if(0===e.length&&function Efe(i,t,e){return e.some(n=>vP(i,t,n))}(i,e,n)){const a=new Js(i.segments,function Cfe(i,t,e,n,r,s){const a={};for(const l of n)if(vP(i,e,l)&&!r[Qd(l)]){const u=new Js([],{});u._sourceSegment=i,u._segmentIndexShift="legacy"===s?i.segments.length:t.length,a[Qd(l)]=u}return Object.assign(Object.assign({},r),a)}(i,t,e,n,i.children,r));return a._sourceSegment=i,a._segmentIndexShift=t.length,{segmentGroup:a,slicedSegments:e}}const s=new Js(i.segments,i.children);return s._sourceSegment=i,s._segmentIndexShift=t.length,{segmentGroup:s,slicedSegments:e}}function vP(i,t,e){return(!(i.hasChildren()||t.length>0)||"full"!==e.pathMatch)&&""===e.path}function E9(i,t,e,n){return!!(Qd(i)===n||n!==Hs&&vP(t,e,i))&&("**"===i.path||_P(t,i,e).matched)}function A9(i,t,e){return 0===t.length&&!i.children[e]}class bP{constructor(t){this.segmentGroup=t||null}}class D9{constructor(t){this.urlTree=t}}function vT(i){return oT(new bP(i))}function R9(i){return oT(new D9(i))}class kfe{constructor(t,e,n,r,s){this.configLoader=e,this.urlSerializer=n,this.urlTree=r,this.config=s,this.allowRedirects=!0,this.ngModule=t.get(Bm)}apply(){const t=yP(this.urlTree.root,[],[],this.config).segmentGroup,e=new Js(t.segments,t.children);return this.expandSegmentGroup(this.ngModule,this.config,e,Hs).pipe(Ui(s=>this.createUrlTree(DH(s),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Iu(s=>{if(s instanceof D9)return this.allowRedirects=!1,this.match(s.urlTree);throw s instanceof bP?this.noMatchError(s):s}))}match(t){return this.expandSegmentGroup(this.ngModule,this.config,t.root,Hs).pipe(Ui(r=>this.createUrlTree(DH(r),t.queryParams,t.fragment))).pipe(Iu(r=>{throw r instanceof bP?this.noMatchError(r):r}))}noMatchError(t){return new Error(`Cannot match any routes. URL Segment: '${t.segmentGroup}'`)}createUrlTree(t,e,n){const r=t.segments.length>0?new Js([],{[Hs]:t}):t;return new e0(r,e,n)}expandSegmentGroup(t,e,n,r){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(t,e,n).pipe(Ui(s=>new Js([],s))):this.expandSegment(t,n,e,n.segments,r,!0)}expandChildren(t,e,n){const r=[];for(const s of Object.keys(n.children))"primary"===s?r.unshift(s):r.push(s);return xr(r).pipe(Pw(s=>{const a=n.children[s],l=M9(e,s);return this.expandSegmentGroup(t,l,a,s).pipe(Ui(u=>({segment:u,outlet:s})))}),Xj((s,a)=>(s[a.outlet]=a.segment,s),{}),function Sde(i,t){const e=arguments.length>=2;return n=>n.pipe(i?vr((r,s)=>i(r,s,n)):Rt,pH(1),e?EW(t):AW(()=>new mk))}())}expandSegment(t,e,n,r,s,a){return xr(n).pipe(Pw(l=>this.expandSegmentAgainstRoute(t,e,n,l,r,s,a).pipe(Iu(h=>{if(h instanceof bP)return Qn(null);throw h}))),Xl(l=>!!l),Iu((l,u)=>{if(l instanceof mk||"EmptyError"===l.name)return A9(e,r,s)?Qn(new Js([],{})):vT(e);throw l}))}expandSegmentAgainstRoute(t,e,n,r,s,a,l){return E9(r,e,s,a)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(t,e,r,s,a):l&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,e,n,r,s,a):vT(e):vT(e)}expandSegmentAgainstRouteUsingRedirect(t,e,n,r,s,a){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,n,r,a):this.expandRegularSegmentAgainstRouteUsingRedirect(t,e,n,r,s,a)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,e,n,r){const s=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?R9(s):this.lineralizeSegments(n,s).pipe(ks(a=>{const l=new Js(a,{});return this.expandSegment(t,l,e,a,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,e,n,r,s,a){const{matched:l,consumedSegments:u,remainingSegments:h,positionalParamSegments:m}=_P(e,r,s);if(!l)return vT(e);const _=this.applyRedirectCommands(u,r.redirectTo,m);return r.redirectTo.startsWith("/")?R9(_):this.lineralizeSegments(r,_).pipe(ks(v=>this.expandSegment(t,e,n,v.concat(h),a,!1)))}matchSegmentAgainstRoute(t,e,n,r,s){if("**"===n.path)return n.loadChildren?(n._loadedConfig?Qn(n._loadedConfig):this.configLoader.load(t.injector,n)).pipe(Ui(_=>(n._loadedConfig=_,new Js(r,{})))):Qn(new Js(r,{}));const{matched:a,consumedSegments:l,remainingSegments:u}=_P(e,n,r);return a?this.getChildConfig(t,n,r).pipe(ks(m=>{const _=m.module,v=m.routes,{segmentGroup:S,slicedSegments:T}=yP(e,l,u,v),I=new Js(S.segments,S.children);if(0===T.length&&I.hasChildren())return this.expandChildren(_,v,I).pipe(Ui(ie=>new Js(l,ie)));if(0===v.length&&0===T.length)return Qn(new Js(l,{}));const j=Qd(n)===s;return this.expandSegment(_,I,v,T,j?Hs:s,!0).pipe(Ui(E=>new Js(l.concat(E.segments),E.children)))})):vT(e)}getChildConfig(t,e,n){return e.children?Qn(new TH(e.children,t)):e.loadChildren?void 0!==e._loadedConfig?Qn(e._loadedConfig):this.runCanLoadGuards(t.injector,e,n).pipe(ks(r=>r?this.configLoader.load(t.injector,e).pipe(Ui(s=>(e._loadedConfig=s,s))):function Dfe(i){return oT(gH(`Cannot load children because the guard of the route "path: '${i.path}'" returned false`))}(e))):Qn(new TH([],t))}runCanLoadGuards(t,e,n){const r=e.canLoad;return r&&0!==r.length?Qn(r.map(a=>{const l=t.get(a);let u;if(function gfe(i){return i&&Sy(i.canLoad)}(l))u=l.canLoad(e,n);else{if(!Sy(l))throw new Error("Invalid CanLoad guard");u=l(e,n)}return Pp(u)})).pipe(_T(),Po(a=>{if(!n0(a))return;const l=gH(`Redirecting to "${this.urlSerializer.serialize(a)}"`);throw l.url=a,l}),Ui(a=>!0===a)):Qn(!0)}lineralizeSegments(t,e){let n=[],r=e.root;for(;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return Qn(n);if(r.numberOfChildren>1||!r.children[Hs])return oT(new Error(`Only absolute redirects can have named outlets. redirectTo: '${t.redirectTo}'`));r=r.children[Hs]}}applyRedirectCommands(t,e,n){return this.applyRedirectCreatreUrlTree(e,this.urlSerializer.parse(e),t,n)}applyRedirectCreatreUrlTree(t,e,n,r){const s=this.createSegmentGroup(t,e.root,n,r);return new e0(s,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){const n={};return Yc(t,(r,s)=>{if("string"==typeof r&&r.startsWith(":")){const l=r.substring(1);n[s]=e[l]}else n[s]=r}),n}createSegmentGroup(t,e,n,r){const s=this.createSegments(t,e.segments,n,r);let a={};return Yc(e.children,(l,u)=>{a[u]=this.createSegmentGroup(t,l,n,r)}),new Js(s,a)}createSegments(t,e,n,r){return e.map(s=>s.path.startsWith(":")?this.findPosParam(t,s,r):this.findOrReturn(s,n))}findPosParam(t,e,n){const r=n[e.path.substring(1)];if(!r)throw new Error(`Cannot redirect to '${t}'. Cannot find '${e.path}'.`);return r}findOrReturn(t,e){let n=0;for(const r of e){if(r.path===t.path)return e.splice(n),r;n++}return t}}function DH(i){const t={};for(const n of Object.keys(i.children)){const s=DH(i.children[n]);(s.segments.length>0||s.hasChildren())&&(t[n]=s)}return function Pfe(i){if(1===i.numberOfChildren&&i.children[Hs]){const t=i.children[Hs];return new Js(i.segments.concat(t.segments),t.children)}return i}(new Js(i.segments,t))}class k9{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class xP{constructor(t,e){this.component=t,this.route=e}}function Lfe(i,t,e){const n=i._root;return bT(n,t?t._root:null,e,[n.value])}function wP(i,t,e){const n=function Ffe(i){if(!i)return null;for(let t=i.parent;t;t=t.parent){const e=t.routeConfig;if(e&&e._loadedConfig)return e._loadedConfig}return null}(t);return(n?n.module.injector:e).get(i)}function bT(i,t,e,n,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=aS(t);return i.children.forEach(a=>{(function Bfe(i,t,e,n,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=i.value,a=t?t.value:null,l=e?e.getContext(i.value.outlet):null;if(a&&s.routeConfig===a.routeConfig){const u=function Nfe(i,t,e){if("function"==typeof e)return e(i,t);switch(e){case"pathParamsChange":return!t0(i.url,t.url);case"pathParamsOrQueryParamsChange":return!t0(i.url,t.url)||!kp(i.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!wH(i,t)||!kp(i.queryParams,t.queryParams);default:return!wH(i,t)}}(a,s,s.routeConfig.runGuardsAndResolvers);u?r.canActivateChecks.push(new k9(n)):(s.data=a.data,s._resolvedData=a._resolvedData),bT(i,t,s.component?l?l.children:null:e,n,r),u&&l&&l.outlet&&l.outlet.isActivated&&r.canDeactivateChecks.push(new xP(l.outlet.component,a))}else a&&xT(t,l,r),r.canActivateChecks.push(new k9(n)),bT(i,null,s.component?l?l.children:null:e,n,r)})(a,s[a.value.outlet],e,n.concat([a.value]),r),delete s[a.value.outlet]}),Yc(s,(a,l)=>xT(a,e.getContext(l),r)),r}function xT(i,t,e){const n=aS(i),r=i.value;Yc(n,(s,a)=>{xT(s,r.component?t?t.children.getContext(a):null:t,e)}),e.canDeactivateChecks.push(new xP(r.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,r))}class Xfe{}function P9(i){return new ft(t=>t.error(i))}class Yfe{constructor(t,e,n,r,s,a){this.rootComponentType=t,this.config=e,this.urlTree=n,this.url=r,this.paramsInheritanceStrategy=s,this.relativeLinkResolution=a}recognize(){const t=yP(this.urlTree.root,[],[],this.config.filter(a=>void 0===a.redirectTo),this.relativeLinkResolution).segmentGroup,e=this.processSegmentGroup(this.config,t,Hs);if(null===e)return null;const n=new pP([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},Hs,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new rg(n,e),s=new g9(this.url,r);return this.inheritParamsAndData(s._root),s}inheritParamsAndData(t){const e=t.value,n=m9(e,this.paramsInheritanceStrategy);e.params=Object.freeze(n.params),e.data=Object.freeze(n.data),t.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(t,e,n){return 0===e.segments.length&&e.hasChildren()?this.processChildren(t,e):this.processSegment(t,e,e.segments,n)}processChildren(t,e){const n=[];for(const s of Object.keys(e.children)){const a=e.children[s],l=M9(t,s),u=this.processSegmentGroup(l,a,s);if(null===u)return null;n.push(...u)}const r=I9(n);return function Kfe(i){i.sort((t,e)=>t.value.outlet===Hs?-1:e.value.outlet===Hs?1:t.value.outlet.localeCompare(e.value.outlet))}(r),r}processSegment(t,e,n,r){for(const s of t){const a=this.processSegmentAgainstRoute(s,e,n,r);if(null!==a)return a}return A9(e,n,r)?[]:null}processSegmentAgainstRoute(t,e,n,r){if(t.redirectTo||!E9(t,e,n,r))return null;let s,a=[],l=[];if("**"===t.path){const S=n.length>0?t9(n).parameters:{};s=new pP(n,S,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,F9(t),Qd(t),t.component,t,L9(e),O9(e)+n.length,B9(t))}else{const S=_P(e,t,n);if(!S.matched)return null;a=S.consumedSegments,l=S.remainingSegments,s=new pP(a,S.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,F9(t),Qd(t),t.component,t,L9(e),O9(e)+a.length,B9(t))}const u=function Qfe(i){return i.children?i.children:i.loadChildren?i._loadedConfig.routes:[]}(t),{segmentGroup:h,slicedSegments:m}=yP(e,a,l,u.filter(S=>void 0===S.redirectTo),this.relativeLinkResolution);if(0===m.length&&h.hasChildren()){const S=this.processChildren(u,h);return null===S?null:[new rg(s,S)]}if(0===u.length&&0===m.length)return[new rg(s,[])];const _=Qd(t)===r,v=this.processSegment(u,h,m,_?Hs:r);return null===v?null:[new rg(s,v)]}}function Jfe(i){const t=i.value.routeConfig;return t&&""===t.path&&void 0===t.redirectTo}function I9(i){const t=[],e=new Set;for(const n of i){if(!Jfe(n)){t.push(n);continue}const r=t.find(s=>n.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...n.children),e.add(r)):t.push(n)}for(const n of e){const r=I9(n.children);t.push(new rg(n.value,r))}return t.filter(n=>!e.has(n))}function L9(i){let t=i;for(;t._sourceSegment;)t=t._sourceSegment;return t}function O9(i){let t=i,e=t._segmentIndexShift?t._segmentIndexShift:0;for(;t._sourceSegment;)t=t._sourceSegment,e+=t._segmentIndexShift?t._segmentIndexShift:0;return e-1}function F9(i){return i.data||{}}function B9(i){return i.resolve||{}}function N9(i){return[...Object.keys(i),...Object.getOwnPropertySymbols(i)]}function RH(i){return dh(t=>{const e=i(t);return e?xr(e).pipe(Ui(()=>t)):Qn(t)})}class ope extends class spe{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}}{}const kH=new gi("ROUTES");class H9{constructor(t,e,n,r){this.injector=t,this.compiler=e,this.onLoadStartListener=n,this.onLoadEndListener=r}load(t,e){if(e._loader$)return e._loader$;this.onLoadStartListener&&this.onLoadStartListener(e);const r=this.loadModuleFactory(e.loadChildren).pipe(Ui(s=>{this.onLoadEndListener&&this.onLoadEndListener(e);const a=s.create(t);return new TH(e9(a.injector.get(kH,void 0,wr.Self|wr.Optional)).map(AH),a)}),Iu(s=>{throw e._loader$=void 0,s}));return e._loader$=new xde(r,()=>new ii).pipe(qj()),e._loader$}loadModuleFactory(t){return Pp(t()).pipe(ks(e=>e instanceof PU?Qn(e):xr(this.compiler.compileModuleAsync(e))))}}class lpe{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,e){return t}}function cpe(i){throw i}function upe(i,t,e){return t.parse("/")}function V9(i,t){return Qn(null)}const hpe={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},dpe={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Ql=(()=>{class i{constructor(e,n,r,s,a,l,u){this.rootComponentType=e,this.urlSerializer=n,this.rootContexts=r,this.location=s,this.config=u,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new ii,this.errorHandler=cpe,this.malformedUriErrorHandler=upe,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:V9,afterPreactivation:V9},this.urlHandlingStrategy=new lpe,this.routeReuseStrategy=new ope,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=a.get(Bm),this.console=a.get(g8);const _=a.get(Rn);this.isNgZoneEnabled=_ instanceof Rn&&Rn.isInAngularZone(),this.resetConfig(u),this.currentUrlTree=function Nde(){return new e0(new Js([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new H9(a,l,v=>this.triggerEvent(new Yj(v)),v=>this.triggerEvent(new Kj(v))),this.routerState=p9(this.currentUrlTree,this.rootComponentType),this.transitions=new gs({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var e;return null===(e=this.location.getState())||void 0===e?void 0:e.\u0275routerPageId}setupNavigations(e){const n=this.events;return e.pipe(vr(r=>0!==r.id),Ui(r=>Object.assign(Object.assign({},r),{extractedUrl:this.urlHandlingStrategy.extract(r.rawUrl)})),dh(r=>{let s=!1,a=!1;return Qn(r).pipe(Po(l=>{this.currentNavigation={id:l.id,initialUrl:l.currentRawUrl,extractedUrl:l.extractedUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),dh(l=>{const u=this.browserUrlTree.toString(),h=!this.navigated||l.extractedUrl.toString()!==u||u!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||h)&&this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return z9(l.source)&&(this.browserUrlTree=l.extractedUrl),Qn(l).pipe(dh(_=>{const v=this.transitions.getValue();return n.next(new mH(_.id,this.serializeUrl(_.extractedUrl),_.source,_.restoredState)),v!==this.transitions.getValue()?aa:Promise.resolve(_)}),function Ife(i,t,e,n){return dh(r=>function Rfe(i,t,e,n,r){return new kfe(i,t,e,n,r).apply()}(i,t,e,r.extractedUrl,n).pipe(Ui(s=>Object.assign(Object.assign({},r),{urlAfterRedirects:s}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),Po(_=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:_.urlAfterRedirects})}),function $fe(i,t,e,n,r){return ks(s=>function Zfe(i,t,e,n,r="emptyOnly",s="legacy"){try{const a=new Yfe(i,t,e,n,r,s).recognize();return null===a?P9(new Xfe):Qn(a)}catch(a){return P9(a)}}(i,t,s.urlAfterRedirects,e(s.urlAfterRedirects),n,r).pipe(Ui(a=>Object.assign(Object.assign({},s),{targetSnapshot:a}))))}(this.rootComponentType,this.config,_=>this.serializeUrl(_),this.paramsInheritanceStrategy,this.relativeLinkResolution),Po(_=>{if("eager"===this.urlUpdateStrategy){if(!_.extras.skipLocationChange){const S=this.urlHandlingStrategy.merge(_.urlAfterRedirects,_.rawUrl);this.setBrowserUrl(S,_)}this.browserUrlTree=_.urlAfterRedirects}const v=new Mde(_.id,this.serializeUrl(_.extractedUrl),this.serializeUrl(_.urlAfterRedirects),_.targetSnapshot);n.next(v)}));if(h&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:v,extractedUrl:S,source:T,restoredState:I,extras:j}=l,P=new mH(v,this.serializeUrl(S),T,I);n.next(P);const E=p9(S,this.rootComponentType).snapshot;return Qn(Object.assign(Object.assign({},l),{targetSnapshot:E,urlAfterRedirects:S,extras:Object.assign(Object.assign({},j),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=l.rawUrl,l.resolve(null),aa}),RH(l=>{const{targetSnapshot:u,id:h,extractedUrl:m,rawUrl:_,extras:{skipLocationChange:v,replaceUrl:S}}=l;return this.hooks.beforePreactivation(u,{navigationId:h,appliedUrlTree:m,rawUrlTree:_,skipLocationChange:!!v,replaceUrl:!!S})}),Po(l=>{const u=new Tde(l.id,this.serializeUrl(l.extractedUrl),this.serializeUrl(l.urlAfterRedirects),l.targetSnapshot);this.triggerEvent(u)}),Ui(l=>Object.assign(Object.assign({},l),{guards:Lfe(l.targetSnapshot,l.currentSnapshot,this.rootContexts)})),function Hfe(i,t){return ks(e=>{const{targetSnapshot:n,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:a}}=e;return 0===a.length&&0===s.length?Qn(Object.assign(Object.assign({},e),{guardsResult:!0})):function Vfe(i,t,e,n){return xr(i).pipe(ks(r=>function qfe(i,t,e,n,r){const s=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return s&&0!==s.length?Qn(s.map(l=>{const u=wP(l,t,r);let h;if(function vfe(i){return i&&Sy(i.canDeactivate)}(u))h=Pp(u.canDeactivate(i,t,e,n));else{if(!Sy(u))throw new Error("Invalid CanDeactivate guard");h=Pp(u(i,t,e,n))}return h.pipe(Xl())})).pipe(_T()):Qn(!0)}(r.component,r.route,e,t,n)),Xl(r=>!0!==r,!0))}(a,n,r,i).pipe(ks(l=>l&&function mfe(i){return"boolean"==typeof i}(l)?function zfe(i,t,e,n){return xr(t).pipe(Pw(r=>V1(function Gfe(i,t){return null!==i&&t&&t(new Rde(i)),Qn(!0)}(r.route.parent,n),function Ufe(i,t){return null!==i&&t&&t(new Pde(i)),Qn(!0)}(r.route,n),function jfe(i,t,e){const n=t[t.length-1],s=t.slice(0,t.length-1).reverse().map(a=>function Ofe(i){const t=i.routeConfig?i.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:i,guards:t}:null}(a)).filter(a=>null!==a).map(a=>hT(()=>Qn(a.guards.map(u=>{const h=wP(u,a.node,e);let m;if(function yfe(i){return i&&Sy(i.canActivateChild)}(h))m=Pp(h.canActivateChild(n,i));else{if(!Sy(h))throw new Error("Invalid CanActivateChild guard");m=Pp(h(n,i))}return m.pipe(Xl())})).pipe(_T())));return Qn(s).pipe(_T())}(i,r.path,e),function Wfe(i,t,e){const n=t.routeConfig?t.routeConfig.canActivate:null;if(!n||0===n.length)return Qn(!0);const r=n.map(s=>hT(()=>{const a=wP(s,t,e);let l;if(function _fe(i){return i&&Sy(i.canActivate)}(a))l=Pp(a.canActivate(t,i));else{if(!Sy(a))throw new Error("Invalid CanActivate guard");l=Pp(a(t,i))}return l.pipe(Xl())}));return Qn(r).pipe(_T())}(i,r.route,e))),Xl(r=>!0!==r,!0))}(n,s,i,t):Qn(l)),Ui(l=>Object.assign(Object.assign({},e),{guardsResult:l})))})}(this.ngModule.injector,l=>this.triggerEvent(l)),Po(l=>{if(n0(l.guardsResult)){const h=gH(`Redirecting to "${this.serializeUrl(l.guardsResult)}"`);throw h.url=l.guardsResult,h}const u=new Ede(l.id,this.serializeUrl(l.extractedUrl),this.serializeUrl(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.triggerEvent(u)}),vr(l=>!!l.guardsResult||(this.restoreHistory(l),this.cancelNavigationTransition(l,""),!1)),RH(l=>{if(l.guards.canActivateChecks.length)return Qn(l).pipe(Po(u=>{const h=new Ade(u.id,this.serializeUrl(u.extractedUrl),this.serializeUrl(u.urlAfterRedirects),u.targetSnapshot);this.triggerEvent(h)}),dh(u=>{let h=!1;return Qn(u).pipe(function epe(i,t){return ks(e=>{const{targetSnapshot:n,guards:{canActivateChecks:r}}=e;if(!r.length)return Qn(e);let s=0;return xr(r).pipe(Pw(a=>function tpe(i,t,e,n){return function ipe(i,t,e,n){const r=N9(i);if(0===r.length)return Qn({});const s={};return xr(r).pipe(ks(a=>function npe(i,t,e,n){const r=wP(i,t,n);return Pp(r.resolve?r.resolve(t,e):r(t,e))}(i[a],t,e,n).pipe(Po(l=>{s[a]=l}))),pH(1),ks(()=>N9(s).length===r.length?Qn(s):aa))}(i._resolve,i,t,n).pipe(Ui(s=>(i._resolvedData=s,i.data=Object.assign(Object.assign({},i.data),m9(i,e).resolve),null)))}(a.route,n,i,t)),Po(()=>s++),pH(1),ks(a=>s===r.length?Qn(e):aa))})}(this.paramsInheritanceStrategy,this.ngModule.injector),Po({next:()=>h=!0,complete:()=>{h||(this.restoreHistory(u),this.cancelNavigationTransition(u,"At least one route resolver didn't emit any value."))}}))}),Po(u=>{const h=new Dde(u.id,this.serializeUrl(u.extractedUrl),this.serializeUrl(u.urlAfterRedirects),u.targetSnapshot);this.triggerEvent(h)}))}),RH(l=>{const{targetSnapshot:u,id:h,extractedUrl:m,rawUrl:_,extras:{skipLocationChange:v,replaceUrl:S}}=l;return this.hooks.afterPreactivation(u,{navigationId:h,appliedUrlTree:m,rawUrlTree:_,skipLocationChange:!!v,replaceUrl:!!S})}),Ui(l=>{const u=function ife(i,t,e){const n=pT(i,t._root,e?e._root:void 0);return new f9(n,t)}(this.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return Object.assign(Object.assign({},l),{targetRouterState:u})}),Po(l=>{this.currentUrlTree=l.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(l.urlAfterRedirects,l.rawUrl),this.routerState=l.targetRouterState,"deferred"===this.urlUpdateStrategy&&(l.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,l),this.browserUrlTree=l.urlAfterRedirects)}),((i,t,e)=>Ui(n=>(new ffe(t,n.targetRouterState,n.currentRouterState,e).activate(i),n)))(this.rootContexts,this.routeReuseStrategy,l=>this.triggerEvent(l)),Po({next(){s=!0},complete(){s=!0}}),Ej(()=>{var l;s||a||this.cancelNavigationTransition(r,`Navigation ID ${r.id} is not equal to the current navigation id ${this.navigationId}`),(null===(l=this.currentNavigation)||void 0===l?void 0:l.id)===r.id&&(this.currentNavigation=null)}),Iu(l=>{if(a=!0,function Ode(i){return i&&i[Jj]}(l)){const u=n0(l.url);u||(this.navigated=!0,this.restoreHistory(r,!0));const h=new Zj(r.id,this.serializeUrl(r.extractedUrl),l.message);n.next(h),u?setTimeout(()=>{const m=this.urlHandlingStrategy.merge(l.url,this.rawUrlTree),_={skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||z9(r.source)};this.scheduleNavigation(m,"imperative",null,_,{resolve:r.resolve,reject:r.reject,promise:r.promise})},0):r.resolve(!1)}else{this.restoreHistory(r,!0);const u=new Cde(r.id,this.serializeUrl(r.extractedUrl),l);n.next(u);try{r.resolve(this.errorHandler(l))}catch(h){r.reject(h)}}return aa}))}))}resetRootComponentType(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}setTransition(e){this.transitions.next(Object.assign(Object.assign({},this.transitions.value),e))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(e=>{const n="popstate"===e.type?"popstate":"hashchange";"popstate"===n&&setTimeout(()=>{var r;const s={replaceUrl:!0},a=(null===(r=e.state)||void 0===r?void 0:r.navigationId)?e.state:null;if(a){const u=Object.assign({},a);delete u.navigationId,delete u.\u0275routerPageId,0!==Object.keys(u).length&&(s.state=u)}const l=this.parseUrl(e.url);this.scheduleNavigation(l,n,a,s)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(e){this.events.next(e)}resetConfig(e){C9(e),this.config=e.map(AH),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(e,n={}){const{relativeTo:r,queryParams:s,fragment:a,queryParamsHandling:l,preserveFragment:u}=n,h=r||this.routerState.root,m=u?this.currentUrlTree.fragment:a;let _=null;switch(l){case"merge":_=Object.assign(Object.assign({},this.currentUrlTree.queryParams),s);break;case"preserve":_=this.currentUrlTree.queryParams;break;default:_=s||null}return null!==_&&(_=this.removeEmptyProps(_)),function sfe(i,t,e,n,r){if(0===e.length)return SH(t.root,t.root,t.root,n,r);const s=function ofe(i){if("string"==typeof i[0]&&1===i.length&&"/"===i[0])return new v9(!0,0,i);let t=0,e=!1;const n=i.reduce((r,s,a)=>{if("object"==typeof s&&null!=s){if(s.outlets){const l={};return Yc(s.outlets,(u,h)=>{l[h]="string"==typeof u?u.split("/"):u}),[...r,{outlets:l}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===a?(s.split("/").forEach((l,u)=>{0==u&&"."===l||(0==u&&""===l?e=!0:".."===l?t++:""!=l&&r.push(l))}),r):[...r,s]},[]);return new v9(e,t,n)}(e);if(s.toRoot())return SH(t.root,t.root,new Js([],{}),n,r);const a=function afe(i,t,e){if(i.isAbsolute)return new CH(t.root,!0,0);if(-1===e.snapshot._lastPathIndex){const s=e.snapshot._urlSegment;return new CH(s,s===t.root,0)}const n=mP(i.commands[0])?0:1;return function lfe(i,t,e){let n=i,r=t,s=e;for(;s>r;){if(s-=r,n=n.parent,!n)throw new Error("Invalid number of '../'");r=n.segments.length}return new CH(n,!1,r-s)}(e.snapshot._urlSegment,e.snapshot._lastPathIndex+n,i.numberOfDoubleDots)}(s,t,i),l=a.processChildren?gP(a.segmentGroup,a.index,s.commands):b9(a.segmentGroup,a.index,s.commands);return SH(t.root,a.segmentGroup,l,n,r)}(h,this.currentUrlTree,e,_,null!=m?m:null)}navigateByUrl(e,n={skipLocationChange:!1}){const r=n0(e)?e:this.parseUrl(e),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,"imperative",null,n)}navigate(e,n={skipLocationChange:!1}){return function fpe(i){for(let t=0;t<i.length;t++){const e=i[t];if(null==e)throw new Error(`The requested path contains ${e} segment at index ${t}`)}}(e),this.navigateByUrl(this.createUrlTree(e,n),n)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){let n;try{n=this.urlSerializer.parse(e)}catch(r){n=this.malformedUriErrorHandler(r,this.urlSerializer,e)}return n}isActive(e,n){let r;if(r=!0===n?Object.assign({},hpe):!1===n?Object.assign({},dpe):n,n0(e))return n9(this.currentUrlTree,e,r);const s=this.parseUrl(e);return n9(this.currentUrlTree,s,r)}removeEmptyProps(e){return Object.keys(e).reduce((n,r)=>{const s=e[r];return null!=s&&(n[r]=s),n},{})}processNavigations(){this.navigations.subscribe(e=>{this.navigated=!0,this.lastSuccessfulId=e.id,this.currentPageId=e.targetPageId,this.events.next(new sS(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,e.resolve(!0)},e=>{this.console.warn(`Unhandled Navigation Error: ${e}`)})}scheduleNavigation(e,n,r,s,a){var l,u;if(this.disposed)return Promise.resolve(!1);let h,m,_;a?(h=a.resolve,m=a.reject,_=a.promise):_=new Promise((T,I)=>{h=T,m=I});const v=++this.navigationId;let S;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(r=this.location.getState()),S=r&&r.\u0275routerPageId?r.\u0275routerPageId:s.replaceUrl||s.skipLocationChange?null!==(l=this.browserPageId)&&void 0!==l?l:0:(null!==(u=this.browserPageId)&&void 0!==u?u:0)+1):S=0,this.setTransition({id:v,targetPageId:S,source:n,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:e,extras:s,resolve:h,reject:m,promise:_,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),_.catch(T=>Promise.reject(T))}setBrowserUrl(e,n){const r=this.urlSerializer.serialize(e),s=Object.assign(Object.assign({},n.extras.state),this.generateNgRouterState(n.id,n.targetPageId));this.location.isCurrentPathEqualTo(r)||n.extras.replaceUrl?this.location.replaceState(r,"",s):this.location.go(r,"",s)}restoreHistory(e,n=!1){var r,s;if("computed"===this.canceledNavigationResolution){const a=this.currentPageId-e.targetPageId;"popstate"!==e.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(r=this.currentNavigation)||void 0===r?void 0:r.finalUrl)||0===a?this.currentUrlTree===(null===(s=this.currentNavigation)||void 0===s?void 0:s.finalUrl)&&0===a&&(this.resetState(e),this.browserUrlTree=e.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(a)}else"replace"===this.canceledNavigationResolution&&(n&&this.resetState(e),this.resetUrlToCurrentUrlTree())}resetState(e){this.routerState=e.currentRouterState,this.currentUrlTree=e.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(e,n){const r=new Zj(e.id,this.serializeUrl(e.extractedUrl),n);this.triggerEvent(r),e.resolve(!1)}generateNgRouterState(e,n){return"computed"===this.canceledNavigationResolution?{navigationId:e,\u0275routerPageId:n}:{navigationId:e}}}return i.\u0275fac=function(e){Nd()},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})();function z9(i){return"imperative"!==i}let PH=(()=>{class i{constructor(e,n,r,s,a){this.router=e,this.route=n,this.tabIndexAttribute=r,this.renderer=s,this.el=a,this.commands=null,this.onChanges=new ii,this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(e){if(null!=this.tabIndexAttribute)return;const n=this.renderer,r=this.el.nativeElement;null!==e?n.setAttribute(r,"tabindex",e):n.removeAttribute(r,"tabindex")}ngOnChanges(e){this.onChanges.next(this)}set routerLink(e){null!=e?(this.commands=Array.isArray(e)?e:[e],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(){if(null===this.urlTree)return!0;const e={skipLocationChange:lS(this.skipLocationChange),replaceUrl:lS(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,e),!0}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:lS(this.preserveFragment)})}}return i.\u0275fac=function(e){return new(e||i)(B(Ql),B(wy),zc("tabindex"),B(nu),B(ai))},i.\u0275dir=Be({type:i,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(e,n){1&e&&je("click",function(){return n.onClick()})},inputs:{queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo",routerLink:"routerLink"},features:[Ls]}),i})(),SP=(()=>{class i{constructor(e,n,r){this.router=e,this.route=n,this.locationStrategy=r,this.commands=null,this.href=null,this.onChanges=new ii,this.subscription=e.events.subscribe(s=>{s instanceof sS&&this.updateTargetUrlAndHref()})}set routerLink(e){this.commands=null!=e?Array.isArray(e)?e:[e]:null}ngOnChanges(e){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(e,n,r,s,a){if(0!==e||n||r||s||a||"string"==typeof this.target&&"_self"!=this.target||null===this.urlTree)return!0;const l={skipLocationChange:lS(this.skipLocationChange),replaceUrl:lS(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,l),!1}updateTargetUrlAndHref(){this.href=null!==this.urlTree?this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:lS(this.preserveFragment)})}}return i.\u0275fac=function(e){return new(e||i)(B(Ql),B(wy),B(Aw))},i.\u0275dir=Be({type:i,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(e,n){1&e&&je("click",function(s){return n.onClick(s.button,s.ctrlKey,s.shiftKey,s.altKey,s.metaKey)}),2&e&&Vi("target",n.target)("href",n.href,Mc)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo",routerLink:"routerLink"},features:[Ls]}),i})();function lS(i){return""===i||!!i}let U9=(()=>{class i{constructor(e,n,r,s,a,l){this.router=e,this.element=n,this.renderer=r,this.cdr=s,this.link=a,this.linkWithHref=l,this.classes=[],this.isActive=!1,this.routerLinkActiveOptions={exact:!1},this.isActiveChange=new Si,this.routerEventsSubscription=e.events.subscribe(u=>{u instanceof sS&&this.update()})}ngAfterContentInit(){Qn(this.links.changes,this.linksWithHrefs.changes,Qn(null)).pipe(lf()).subscribe(e=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){var e;null===(e=this.linkInputChangesSubscription)||void 0===e||e.unsubscribe();const n=[...this.links.toArray(),...this.linksWithHrefs.toArray(),this.link,this.linkWithHref].filter(r=>!!r).map(r=>r.onChanges);this.linkInputChangesSubscription=xr(n).pipe(lf()).subscribe(r=>{this.isActive!==this.isLinkActive(this.router)(r)&&this.update()})}set routerLinkActive(e){const n=Array.isArray(e)?e:e.split(" ");this.classes=n.filter(r=>!!r)}ngOnChanges(e){this.update()}ngOnDestroy(){var e;this.routerEventsSubscription.unsubscribe(),null===(e=this.linkInputChangesSubscription)||void 0===e||e.unsubscribe()}update(){!this.links||!this.linksWithHrefs||!this.router.navigated||Promise.resolve().then(()=>{const e=this.hasActiveLinks();this.isActive!==e&&(this.isActive=e,this.cdr.markForCheck(),this.classes.forEach(n=>{e?this.renderer.addClass(this.element.nativeElement,n):this.renderer.removeClass(this.element.nativeElement,n)}),this.isActiveChange.emit(e))})}isLinkActive(e){const n=function ppe(i){return!!i.paths}(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return r=>!!r.urlTree&&e.isActive(r.urlTree,n)}hasActiveLinks(){const e=this.isLinkActive(this.router);return this.link&&e(this.link)||this.linkWithHref&&e(this.linkWithHref)||this.links.some(e)||this.linksWithHrefs.some(e)}}return i.\u0275fac=function(e){return new(e||i)(B(Ql),B(ai),B(nu),B(Pn),B(PH,8),B(SP,8))},i.\u0275dir=Be({type:i,selectors:[["","routerLinkActive",""]],contentQueries:function(e,n,r){if(1&e&&(Er(r,PH,5),Er(r,SP,5)),2&e){let s;jt(s=qt())&&(n.links=s),jt(s=qt())&&(n.linksWithHrefs=s)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],features:[Ls]}),i})();class G9{}class W9{preload(t,e){return Qn(null)}}let j9=(()=>{class i{constructor(e,n,r,s){this.router=e,this.injector=r,this.preloadingStrategy=s,this.loader=new H9(r,n,u=>e.triggerEvent(new Yj(u)),u=>e.triggerEvent(new Kj(u)))}setUpPreloading(){this.subscription=this.router.events.pipe(vr(e=>e instanceof sS),Pw(()=>this.preload())).subscribe(()=>{})}preload(){const e=this.injector.get(Bm);return this.processRoutes(e,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,n){const r=[];for(const s of n)if(s.loadChildren&&!s.canLoad&&s._loadedConfig){const a=s._loadedConfig;r.push(this.processRoutes(a.module,a.routes))}else s.loadChildren&&!s.canLoad?r.push(this.preloadConfig(e,s)):s.children&&r.push(this.processRoutes(e,s.children));return xr(r).pipe(lf(),Ui(s=>{}))}preloadConfig(e,n){return this.preloadingStrategy.preload(n,()=>(n._loadedConfig?Qn(n._loadedConfig):this.loader.load(e.injector,n)).pipe(ks(s=>(n._loadedConfig=s,this.processRoutes(s.module,s.routes)))))}}return i.\u0275fac=function(e){return new(e||i)(Ve(Ql),Ve(_8),Ve(Os),Ve(G9))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})(),IH=(()=>{class i{constructor(e,n,r={}){this.router=e,this.viewportScroller=n,this.options=r,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},r.scrollPositionRestoration=r.scrollPositionRestoration||"disabled",r.anchorScrolling=r.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(e=>{e instanceof mH?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof sS&&(this.lastId=e.id,this.scheduleScrollEvent(e,this.router.parseUrl(e.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(e=>{e instanceof Qj&&(e.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,n){this.router.triggerEvent(new Qj(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,n))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return i.\u0275fac=function(e){Nd()},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})();const r0=new gi("ROUTER_CONFIGURATION"),q9=new gi("ROUTER_FORROOT_GUARD"),gpe=[l1,{provide:a9,useClass:l9},{provide:Ql,useFactory:function xpe(i,t,e,n,r,s,a={},l,u){const h=new Ql(null,i,t,e,n,r,e9(s));return l&&(h.urlHandlingStrategy=l),u&&(h.routeReuseStrategy=u),function wpe(i,t){i.errorHandler&&(t.errorHandler=i.errorHandler),i.malformedUriErrorHandler&&(t.malformedUriErrorHandler=i.malformedUriErrorHandler),i.onSameUrlNavigation&&(t.onSameUrlNavigation=i.onSameUrlNavigation),i.paramsInheritanceStrategy&&(t.paramsInheritanceStrategy=i.paramsInheritanceStrategy),i.relativeLinkResolution&&(t.relativeLinkResolution=i.relativeLinkResolution),i.urlUpdateStrategy&&(t.urlUpdateStrategy=i.urlUpdateStrategy),i.canceledNavigationResolution&&(t.canceledNavigationResolution=i.canceledNavigationResolution)}(a,h),a.enableTracing&&h.events.subscribe(m=>{var _,v;null===(_=console.group)||void 0===_||_.call(console,`Router Event: ${m.constructor.name}`),console.log(m.toString()),console.log(m),null===(v=console.groupEnd)||void 0===v||v.call(console)}),h},deps:[a9,yT,l1,Os,_8,kH,r0,[class ape{},new wh],[class rpe{},new wh]]},yT,{provide:wy,useFactory:function Spe(i){return i.routerState.root},deps:[Ql]},j9,W9,class mpe{preload(t,e){return e().pipe(Iu(()=>Qn(null)))}},{provide:r0,useValue:{enableTracing:!1}}];function _pe(){return new w8("Router",Ql)}let LH=(()=>{class i{constructor(e,n){}static forRoot(e,n){return{ngModule:i,providers:[gpe,X9(e),{provide:q9,useFactory:bpe,deps:[[Ql,new wh,new mm]]},{provide:r0,useValue:n||{}},{provide:Aw,useFactory:vpe,deps:[xb,[new NC(v3),new wh],r0]},{provide:IH,useFactory:ype,deps:[Ql,pre,r0]},{provide:G9,useExisting:n&&n.preloadingStrategy?n.preloadingStrategy:W9},{provide:w8,multi:!0,useFactory:_pe},[OH,{provide:mR,multi:!0,useFactory:Cpe,deps:[OH]},{provide:Z9,useFactory:Mpe,deps:[OH]},{provide:a3,multi:!0,useExisting:Z9}]]}}static forChild(e){return{ngModule:i,providers:[X9(e)]}}}return i.\u0275fac=function(e){return new(e||i)(Ve(q9,8),Ve(Ql,8))},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({}),i})();function ype(i,t,e){return e.scrollOffset&&t.setOffset(e.scrollOffset),new IH(i,t,e)}function vpe(i,t,e={}){return e.useHash?new nne(i,t):new U8(i,t)}function bpe(i){return"guarded"}function X9(i){return[{provide:zL,multi:!0,useValue:i},{provide:kH,multi:!0,useValue:i}]}let OH=(()=>{class i{constructor(e){this.injector=e,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new ii}appInitializer(){return this.injector.get(ene,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let n=null;const r=new Promise(l=>n=l),s=this.injector.get(Ql),a=this.injector.get(r0);return"disabled"===a.initialNavigation?(s.setUpLocationChangeListener(),n(!0)):"enabled"===a.initialNavigation||"enabledBlocking"===a.initialNavigation?(s.hooks.afterPreactivation=()=>this.initNavigation?Qn(null):(this.initNavigation=!0,n(!0),this.resultOfPreactivationDone),s.initialNavigation()):n(!0),r})}bootstrapListener(e){const n=this.injector.get(r0),r=this.injector.get(j9),s=this.injector.get(IH),a=this.injector.get(Ql),l=this.injector.get(Ew);e===l.components[0]&&(("enabledNonBlocking"===n.initialNavigation||void 0===n.initialNavigation)&&a.initialNavigation(),r.setUpPreloading(),s.init(),a.resetRootComponentType(l.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return i.\u0275fac=function(e){return new(e||i)(Ve(Os))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})();function Cpe(i){return i.appInitializer.bind(i)}function Mpe(i){return i.bootstrapListener.bind(i)}const Z9=new gi("Router Initializer");let FH=(()=>{class i{constructor(e,n,r,s,a,l,u){this._cdr=e,this._queryService=n,this._filterService=r,this._selectionService=s,this._eventBusService=a,this._router=l,this._snackBar=u,this._loading=!1,this._updateScroll=!1,this._dataSource=aa,this._count=this.scrollIncrement()}static staticBackgroundForScore(e,n,r,s){const a=void 0===s?e:s.score;if(null==r||0===r.length){const l=Math.round(255-255*a);return Rb.rgbToHex(l,255,l)}if(1===r.length)return r[0].colorForRelevance(a);{const l=100/r.length;return"repeating-linear-gradient(90deg,"+r.map((u,h)=>u.colorForRelevance(a)+" "+h*l+"%,"+u.colorForRelevance(a)+" "+(h+1)*l+"%").join(",")+")"}}backgroundForSegment(e){return this.backgroundForScore(e.score,e)}backgroundForScore(e,n,r){const s=this._selectionService.getTags(n.segmentId);return i.staticBackgroundForScore(e,n,s,r)}ngOnInit(){this._queryServiceSubscription=this._queryService.observable.pipe(vr(n=>["STARTED","ENDED","ERROR","CLEAR"].indexOf(n)>-1)).subscribe(n=>this.onQueryStateChange(n)),this._filterServiceSubscription=this._filterService._objectFilters.subscribe(n=>{this._cdr.markForCheck()}),this.subscribe(this._queryService.results);const e=new Map;e.set("n:component",this.name),this._eventBusService.publish(new ia(new ao(fr.NAVIGATE,e)))}ngOnDestroy(){this._queryServiceSubscription.unsubscribe(),this._filterServiceSubscription.unsubscribe()}onDetailsButtonClicked(e){this._router.navigate(["/mediaobject/"+e.objectId],{skipLocationChange:!0});const n=new Map;n.set("i:mediasegment",e.objectId),this._eventBusService.publish(new ia(new ao(fr.EXAMINE,n)))}onMltButtonClicked(e){this._queryService.findMoreLikeThis(e,e.objectScoreContainer.mediatype)}onInformationButtonClicked(e,n){this._snackBar.openFromComponent(jj,n?{data:[e,n],duration:5e3}:{data:[e,n],duration:2500});const r=new Map;r.set("i:mediasegment",e.segmentId),this._eventBusService.publish(new ia(new ao(fr.EXAMINE,r)))}onTileDrag(e,n,r){n&&e.dataTransfer.setData(xy.FORMAT,xy.fromScoreContainer(n).toJSON()),r&&e.dataTransfer.setData(rS.FORMAT,rS.fromScoreContainer(r).toJSON())}incrementCount(){this._count+=this.scrollIncrement(),this._cdr.markForCheck(),!1===this._updateScroll&&(this._updateScroll=!0,setTimeout(()=>{this._eventBusService.publish(new ia(new ao(fr.SCROLL))),this._updateScroll=!1},250))}decrementCount(){this._count=Math.max(this._count-this.scrollIncrement(),this.scrollIncrement()),this._cdr.markForCheck(),!1===this._updateScroll&&(this._updateScroll=!0,setTimeout(()=>{this._eventBusService.publish(new ia(new ao(fr.SCROLL))),this._updateScroll=!1},250))}onQueryStateChange(e){switch(e){case"STARTED":this._loading=!0,this.subscribe(this._queryService.results);break;case"ENDED":case"ERROR":this._loading=!1;break;case"CLEAR":this._dataSource=aa}this._cdr.markForCheck()}}return i.\u0275fac=function(e){return new(e||i)(B(Pn),B(Rc),B(Rp),B(Bh),B(Zc),B(Ql),B(Ru))},i.\u0275dir=Be({type:i}),i})();var bo=(()=>{return(i=bo||(bo={})).OBJECT_ID=":o",i.OBJECT_NAME=":n",i.OBJECT_PATH=":p",i.OBJECT_TYPE_LOWER=":t",i.OBJECT_TYPE_UPPER=":T",i.SEGMENT_ID=":s",i.SEGMENT_ID_NO_PREFIX=":S",i.SUFFIX=":x",bo;var i})();class Ts{constructor(t){t.configAsObservable.subscribe(e=>{this.host_thumbnails=e.get("resources.host_thumbnails"),this.host_objects=e.get("resources.host_objects");const n=e.get("resources.suffix_default"),r=e.get("resources.suffix");for(const s of Object.keys(Kd.MediatypeEnum).map(a=>Kd.MediatypeEnum[a])){const a=r[s];Ts.suffices.set(s,"string"==typeof a?("."===a.charAt(0)?"":".")+a:("."===n.charAt(0)?"":".")+n)}})}static prefixForMediatype(t){switch(t){case Kd.MediatypeEnum.Audio:return"a_";case Kd.MediatypeEnum.Image:return"i_";case Kd.MediatypeEnum.ImageSequence:return"is_";case Kd.MediatypeEnum.Model3D:return"m_";case Kd.MediatypeEnum.Video:return"v_";default:return""}}static iiifUrlToObject(t,e,n,r){const s=t.metadata;if(!s)return null;let a=s.get("IIIF.resourceUrl");if(null!=a&&0!==a.trim().length){if(a.endsWith("/")||(a=a.concat("/")),!e){const l=r||"",u=n||"",h="IIIF",m=n||r?l+","+u:s.get(h+".size")||"full",_=s.get(h+".region")||"full",v=s.get(h+".rotation")||"0",S=s.get(h+".quality")||"default",T=s.get(h+".extension")||"jpg";a=a.concat(`${_}/${m}/${v}/${S}.${T}`)}return a}return null}pathToObject(t){const e=Ts.iiifUrlToObject(t);if(e)return e;const n={};return n[bo.OBJECT_ID]=t.objectid,n[bo.OBJECT_NAME]=t.name,n[bo.OBJECT_PATH]=t.path,n[bo.OBJECT_TYPE_LOWER]=t.mediatype.toLowerCase(),n[bo.OBJECT_TYPE_UPPER]=t.mediatype,n[bo.SUFFIX]=Ts.suffices.get(t.mediatype),this.host_objects.replace(Ts._regex,r=>n[r]||r)}pathToThumbnail(t,e,n,r){const s=Ts.iiifUrlToObject(t,!1,n,r);if(s)return s;const a={};return a[bo.OBJECT_ID]=t.objectid,a[bo.OBJECT_NAME]=t.name,a[bo.OBJECT_PATH]=t.path,a[bo.OBJECT_TYPE_LOWER]=t.mediatype.toLowerCase(),a[bo.OBJECT_TYPE_UPPER]=t.mediatype,a[bo.SUFFIX]=Ts.suffices.get(t.mediatype),a[bo.SEGMENT_ID]=e.segmentId,this.host_thumbnails.replace(Ts._regex,l=>a[l]||l)}pathToSegment(t){const e={};return e[bo.OBJECT_ID]=t.objectScoreContainer.objectid,e[bo.OBJECT_NAME]=t.objectScoreContainer.name,e[bo.OBJECT_PATH]=t.objectScoreContainer.path,e[bo.OBJECT_TYPE_LOWER]=t.objectScoreContainer.mediatype.toLowerCase(),e[bo.OBJECT_TYPE_UPPER]=t.objectScoreContainer.mediatype,e[bo.SUFFIX]=Ts.suffices.get(t.objectScoreContainer.mediatype),e[bo.SEGMENT_ID]=t.segmentId,e[bo.SEGMENT_ID_NO_PREFIX]=t.segmentId.replace(Ts.prefixForMediatype(t.objectScoreContainer.mediatype),""),this.host_objects.replace(Ts._regex,n=>e[n]||n)}}function Epe(i,t){}Ts.suffices=new Map,Ts._regex=new RegExp("("+[bo.OBJECT_ID,bo.OBJECT_NAME,bo.OBJECT_PATH,bo.OBJECT_TYPE_LOWER,bo.OBJECT_TYPE_UPPER,bo.SEGMENT_ID,bo.SEGMENT_ID_NO_PREFIX,bo.SUFFIX].join("|")+")","g"),Ts.\u0275fac=function(t){return new(t||Ts)(Ve(dr))},Ts.\u0275prov=Nt({token:Ts,factory:Ts.\u0275fac});class CP{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.maxWidth="80vw",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.delayFocusTrap=!0,this.closeOnNavigation=!0}}const Ape={dialogContainer:Xd("dialogContainer",[Cl("void, exit",Xs({opacity:0,transform:"scale(0.7)"})),Cl("enter",Xs({transform:"none"})),Ml("* => enter",YR([ql("150ms cubic-bezier(0, 0, 0.2, 1)",Xs({transform:"none",opacity:1})),w1("@*",x1(),{optional:!0})])),Ml("* => void, * => exit",YR([ql("75ms cubic-bezier(0.4, 0.0, 0.2, 1)",Xs({opacity:0})),w1("@*",x1(),{optional:!0})]))])};let Dpe=(()=>{class i extends L1{constructor(e,n,r,s,a,l,u,h){super(),this._elementRef=e,this._focusTrapFactory=n,this._changeDetectorRef=r,this._config=a,this._interactivityChecker=l,this._ngZone=u,this._focusMonitor=h,this._animationStateChanged=new Si,this._elementFocusedBeforeDialogWasOpened=null,this._closeInteractionType=null,this.attachDomPortal=m=>(this._portalOutlet.hasAttached(),this._portalOutlet.attachDomPortal(m)),this._ariaLabelledBy=a.ariaLabelledBy||null,this._document=s}_initializeWithAttachedContent(){this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._document&&(this._elementFocusedBeforeDialogWasOpened=zw())}attachComponentPortal(e){return this._portalOutlet.hasAttached(),this._portalOutlet.attachComponentPortal(e)}attachTemplatePortal(e){return this._portalOutlet.hasAttached(),this._portalOutlet.attachTemplatePortal(e)}_recaptureFocus(){this._containsFocus()||this._trapFocus()}_forceFocus(e,n){this._interactivityChecker.isFocusable(e)||(e.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const r=()=>{e.removeEventListener("blur",r),e.removeEventListener("mousedown",r),e.removeAttribute("tabindex")};e.addEventListener("blur",r),e.addEventListener("mousedown",r)})),e.focus(n)}_focusByCssSelector(e,n){let r=this._elementRef.nativeElement.querySelector(e);r&&this._forceFocus(r,n)}_trapFocus(){const e=this._elementRef.nativeElement;switch(this._config.autoFocus){case!1:case"dialog":this._containsFocus()||e.focus();break;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(n=>{n||this._focusDialogContainer()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this._config.autoFocus)}}_restoreFocus(){const e=this._elementFocusedBeforeDialogWasOpened;if(this._config.restoreFocus&&e&&"function"==typeof e.focus){const n=zw(),r=this._elementRef.nativeElement;(!n||n===this._document.body||n===r||r.contains(n))&&(this._focusMonitor?(this._focusMonitor.focusVia(e,this._closeInteractionType),this._closeInteractionType=null):e.focus())}this._focusTrap&&this._focusTrap.destroy()}_focusDialogContainer(){this._elementRef.nativeElement.focus&&this._elementRef.nativeElement.focus()}_containsFocus(){const e=this._elementRef.nativeElement,n=zw();return e===n||e.contains(n)}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(JB),B(Pn),B(ar,8),B(CP),B(Tk),B(Rn),B(ch))},i.\u0275dir=Be({type:i,viewQuery:function(e,n){if(1&e&&ji(Wm,7),2&e){let r;jt(r=qt())&&(n._portalOutlet=r.first)}},features:[It]}),i})(),Rpe=(()=>{class i extends Dpe{constructor(){super(...arguments),this._state="enter"}_onAnimationDone({toState:e,totalTime:n}){"enter"===e?(this._config.delayFocusTrap&&this._trapFocus(),this._animationStateChanged.next({state:"opened",totalTime:n})):"exit"===e&&(this._restoreFocus(),this._animationStateChanged.next({state:"closed",totalTime:n}))}_onAnimationStart({toState:e,totalTime:n}){"enter"===e?this._animationStateChanged.next({state:"opening",totalTime:n}):("exit"===e||"void"===e)&&this._animationStateChanged.next({state:"closing",totalTime:n})}_startExitAnimation(){this._state="exit",this._changeDetectorRef.markForCheck()}_initializeWithAttachedContent(){super._initializeWithAttachedContent(),this._config.delayFocusTrap||this._trapFocus()}}return i.\u0275fac=function(){let t;return function(n){return(t||(t=Ki(i)))(n||i)}}(),i.\u0275cmp=ei({type:i,selectors:[["mat-dialog-container"]],hostAttrs:["tabindex","-1","aria-modal","true",1,"mat-dialog-container"],hostVars:6,hostBindings:function(e,n){1&e&&Q_("@dialogContainer.start",function(s){return n._onAnimationStart(s)})("@dialogContainer.done",function(s){return n._onAnimationDone(s)}),2&e&&(dn("id",n._id),Vi("role",n._config.role)("aria-labelledby",n._config.ariaLabel?null:n._ariaLabelledBy)("aria-label",n._config.ariaLabel)("aria-describedby",n._config.ariaDescribedBy||null),Cr("@dialogContainer",n._state))},features:[It],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(e,n){1&e&&Ue(0,Epe,0,0,"ng-template",0)},directives:[Wm],styles:[".mat-dialog-container{display:block;padding:24px;border-radius:4px;box-sizing:border-box;overflow:auto;outline:0;width:100%;height:100%;min-height:inherit;max-height:inherit}.cdk-high-contrast-active .mat-dialog-container{outline:solid 1px}.mat-dialog-content{display:block;margin:0 -24px;padding:0 24px;max-height:65vh;overflow:auto;-webkit-overflow-scrolling:touch}.mat-dialog-title{margin:0 0 20px;display:block}.mat-dialog-actions{padding:8px 0;display:flex;flex-wrap:wrap;min-height:52px;align-items:center;box-sizing:content-box;margin-bottom:-24px}.mat-dialog-actions[align=end]{justify-content:flex-end}.mat-dialog-actions[align=center]{justify-content:center}.mat-dialog-actions .mat-button-base+.mat-button-base,.mat-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}\n"],encapsulation:2,data:{animation:[Ape.dialogContainer]}}),i})(),kpe=0;class Ip{constructor(t,e,n="mat-dialog-"+kpe++){this._overlayRef=t,this._containerInstance=e,this.id=n,this.disableClose=this._containerInstance._config.disableClose,this._afterOpened=new ii,this._afterClosed=new ii,this._beforeClosed=new ii,this._state=0,e._id=n,e._animationStateChanged.pipe(vr(r=>"opened"===r.state),Qr(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),e._animationStateChanged.pipe(vr(r=>"closed"===r.state),Qr(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._finishDialogClose()}),t.detachments().subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._afterClosed.next(this._result),this._afterClosed.complete(),this.componentInstance=null,this._overlayRef.dispose()}),t.keydownEvents().pipe(vr(r=>27===r.keyCode&&!this.disableClose&&!dc(r))).subscribe(r=>{r.preventDefault(),BH(this,"keyboard")}),t.backdropClick().subscribe(()=>{this.disableClose?this._containerInstance._recaptureFocus():BH(this,"mouse")})}close(t){this._result=t,this._containerInstance._animationStateChanged.pipe(vr(e=>"closing"===e.state),Qr(1)).subscribe(e=>{this._beforeClosed.next(t),this._beforeClosed.complete(),this._overlayRef.detachBackdrop(),this._closeFallbackTimeout=setTimeout(()=>this._finishDialogClose(),e.totalTime+100)}),this._state=1,this._containerInstance._startExitAnimation()}afterOpened(){return this._afterOpened}afterClosed(){return this._afterClosed}beforeClosed(){return this._beforeClosed}backdropClick(){return this._overlayRef.backdropClick()}keydownEvents(){return this._overlayRef.keydownEvents()}updatePosition(t){let e=this._getPositionStrategy();return t&&(t.left||t.right)?t.left?e.left(t.left):e.right(t.right):e.centerHorizontally(),t&&(t.top||t.bottom)?t.top?e.top(t.top):e.bottom(t.bottom):e.centerVertically(),this._overlayRef.updatePosition(),this}updateSize(t="",e=""){return this._overlayRef.updateSize({width:t,height:e}),this._overlayRef.updatePosition(),this}addPanelClass(t){return this._overlayRef.addPanelClass(t),this}removePanelClass(t){return this._overlayRef.removePanelClass(t),this}getState(){return this._state}_finishDialogClose(){this._state=2,this._overlayRef.dispose()}_getPositionStrategy(){return this._overlayRef.getConfig().positionStrategy}}function BH(i,t,e){return void 0!==i._containerInstance&&(i._containerInstance._closeInteractionType=t),i.close(e)}const Cy=new gi("MatDialogData"),Ppe=new gi("mat-dialog-default-options"),Y9=new gi("mat-dialog-scroll-strategy"),Lpe={provide:Y9,deps:[Du],useFactory:function Ipe(i){return()=>i.scrollStrategies.block()}};let Ope=(()=>{class i{constructor(e,n,r,s,a,l,u,h,m,_){this._overlay=e,this._injector=n,this._defaultOptions=r,this._parentDialog=s,this._overlayContainer=a,this._dialogRefConstructor=u,this._dialogContainerType=h,this._dialogDataToken=m,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new ii,this._afterOpenedAtThisLevel=new ii,this._ariaHiddenElements=new Map,this.afterAllClosed=hT(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(Tl(void 0))),this._scrollStrategy=l}get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}_getAfterAllClosed(){const e=this._parentDialog;return e?e._getAfterAllClosed():this._afterAllClosedAtThisLevel}open(e,n){n=function Fpe(i,t){return Object.assign(Object.assign({},t),i)}(n,this._defaultOptions||new CP),n.id&&this.getDialogById(n.id);const r=this._createOverlay(n),s=this._attachDialogContainer(r,n),a=this._attachDialogContent(e,s,r,n);return this.openDialogs.length||this._hideNonDialogContentFromAssistiveTechnology(),this.openDialogs.push(a),a.afterClosed().subscribe(()=>this._removeOpenDialog(a)),this.afterOpened.next(a),s._initializeWithAttachedContent(),a}closeAll(){this._closeDialogs(this.openDialogs)}getDialogById(e){return this.openDialogs.find(n=>n.id===e)}ngOnDestroy(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete()}_createOverlay(e){const n=this._getOverlayConfig(e);return this._overlay.create(n)}_getOverlayConfig(e){const n=new Fb({positionStrategy:this._overlay.position().global(),scrollStrategy:e.scrollStrategy||this._scrollStrategy(),panelClass:e.panelClass,hasBackdrop:e.hasBackdrop,direction:e.direction,minWidth:e.minWidth,minHeight:e.minHeight,maxWidth:e.maxWidth,maxHeight:e.maxHeight,disposeOnNavigation:e.closeOnNavigation});return e.backdropClass&&(n.backdropClass=e.backdropClass),n}_attachDialogContainer(e,n){const s=Os.create({parent:n&&n.viewContainerRef&&n.viewContainerRef.injector||this._injector,providers:[{provide:CP,useValue:n}]}),a=new hy(this._dialogContainerType,n.viewContainerRef,s,n.componentFactoryResolver);return e.attach(a).instance}_attachDialogContent(e,n,r,s){const a=new this._dialogRefConstructor(r,n,s.id);if(e instanceof Xo)n.attachTemplatePortal(new Ep(e,null,{$implicit:s.data,dialogRef:a}));else{const l=this._createInjector(s,a,n),u=n.attachComponentPortal(new hy(e,s.viewContainerRef,l,s.componentFactoryResolver));a.componentInstance=u.instance}return a.updateSize(s.width,s.height).updatePosition(s.position),a}_createInjector(e,n,r){const s=e&&e.viewContainerRef&&e.viewContainerRef.injector,a=[{provide:this._dialogContainerType,useValue:r},{provide:this._dialogDataToken,useValue:e.data},{provide:this._dialogRefConstructor,useValue:n}];return e.direction&&(!s||!s.get(Ia,null,wr.Optional))&&a.push({provide:Ia,useValue:{value:e.direction,change:Qn()}}),Os.create({parent:s||this._injector,providers:a})}_removeOpenDialog(e){const n=this.openDialogs.indexOf(e);n>-1&&(this.openDialogs.splice(n,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((r,s)=>{r?s.setAttribute("aria-hidden",r):s.removeAttribute("aria-hidden")}),this._ariaHiddenElements.clear(),this._getAfterAllClosed().next()))}_hideNonDialogContentFromAssistiveTechnology(){const e=this._overlayContainer.getContainerElement();if(e.parentElement){const n=e.parentElement.children;for(let r=n.length-1;r>-1;r--){let s=n[r];s!==e&&"SCRIPT"!==s.nodeName&&"STYLE"!==s.nodeName&&!s.hasAttribute("aria-live")&&(this._ariaHiddenElements.set(s,s.getAttribute("aria-hidden")),s.setAttribute("aria-hidden","true"))}}}_closeDialogs(e){let n=e.length;for(;n--;)e[n].close()}}return i.\u0275fac=function(e){Nd()},i.\u0275dir=Be({type:i}),i})(),Lu=(()=>{class i extends Ope{constructor(e,n,r,s,a,l,u,h){super(e,n,s,l,u,a,Ip,Rpe,Cy,h)}}return i.\u0275fac=function(e){return new(e||i)(Ve(Du),Ve(Os),Ve(l1,8),Ve(Ppe,8),Ve(Y9),Ve(i,12),Ve(KB),Ve(ga,8))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})(),Bpe=0,Npe=(()=>{class i{constructor(e,n,r){this.dialogRef=e,this._elementRef=n,this._dialog=r,this.type="button"}ngOnInit(){this.dialogRef||(this.dialogRef=Q9(this._elementRef,this._dialog.openDialogs))}ngOnChanges(e){const n=e._matDialogClose||e._matDialogCloseResult;n&&(this.dialogResult=n.currentValue)}_onButtonClick(e){BH(this.dialogRef,0===e.screenX&&0===e.screenY?"keyboard":"mouse",this.dialogResult)}}return i.\u0275fac=function(e){return new(e||i)(B(Ip,8),B(ai),B(Lu))},i.\u0275dir=Be({type:i,selectors:[["","mat-dialog-close",""],["","matDialogClose",""]],hostVars:2,hostBindings:function(e,n){1&e&&je("click",function(s){return n._onButtonClick(s)}),2&e&&Vi("aria-label",n.ariaLabel||null)("type",n.type)},inputs:{ariaLabel:["aria-label","ariaLabel"],type:"type",dialogResult:["mat-dialog-close","dialogResult"],_matDialogClose:["matDialogClose","_matDialogClose"]},exportAs:["matDialogClose"],features:[Ls]}),i})(),K9=(()=>{class i{constructor(e,n,r){this._dialogRef=e,this._elementRef=n,this._dialog=r,this.id="mat-dialog-title-"+Bpe++}ngOnInit(){this._dialogRef||(this._dialogRef=Q9(this._elementRef,this._dialog.openDialogs)),this._dialogRef&&Promise.resolve().then(()=>{const e=this._dialogRef._containerInstance;e&&!e._ariaLabelledBy&&(e._ariaLabelledBy=this.id)})}}return i.\u0275fac=function(e){return new(e||i)(B(Ip,8),B(ai),B(Lu))},i.\u0275dir=Be({type:i,selectors:[["","mat-dialog-title",""],["","matDialogTitle",""]],hostAttrs:[1,"mat-dialog-title"],hostVars:1,hostBindings:function(e,n){2&e&&dn("id",n.id)},inputs:{id:"id"},exportAs:["matDialogTitle"]}),i})(),cS=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275dir=Be({type:i,selectors:[["","mat-dialog-content",""],["mat-dialog-content"],["","matDialogContent",""]],hostAttrs:[1,"mat-dialog-content"]}),i})(),Hpe=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275dir=Be({type:i,selectors:[["","mat-dialog-actions",""],["mat-dialog-actions"],["","matDialogActions",""]],hostAttrs:[1,"mat-dialog-actions"]}),i})();function Q9(i,t){let e=i.nativeElement.parentElement;for(;e&&!e.classList.contains("mat-dialog-container");)e=e.parentElement;return e?t.find(n=>n.id===e.id):null}let NH=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({providers:[Lu,Lpe],imports:[[Nb,O1,jn],jn]}),i})(),HH=(()=>{class i extends FH{constructor(e,n,r,s,a,l,u,h,m,_){super(e,n,r,s,a,l,u),this._configService=h,this._resolver=m,this._dialog=_}}return i.\u0275fac=function(e){return new(e||i)(B(Pn),B(Rc),B(Rp),B(Bh),B(Zc),B(Ql),B(Ru),B(dr),B(Ts),B(Lu))},i.\u0275dir=Be({type:i,features:[It]}),i})();function Vpe(i,t){1&i&&(Z(0,"p",4),ue(1,"No results available. Please start a search..."),J())}function zpe(i,t){1&i&&(Z(0,"p",4),yt(1,"mat-spinner"),J())}function Upe(i,t){if(1&i&&yt(0,"app-result-segment-preview-tile",13),2&i){const e=t.$implicit,n=Re().$implicit;fe("container",Re(2))("score",e._score)("segment",e)("temporalObject",n)}}function Gpe(i,t){if(1&i){const e=Wi();Z(0,"div")(1,"span",6)(2,"div",7)(3,"button",8),je("click",function(){const s=gt(e).index;return Re(2).toggleItem(s)}),Z(4,"mat-icon",9),ue(5,"check_box"),J()(),Z(6,"div",10),Ue(7,Upe,1,4,"app-result-segment-preview-tile",11),ti(8,"FilterPipe"),ti(9,"async"),J()()(),Z(10,"span",6)(11,"div",12)(12,"button",8),je("click",function(){const s=gt(e).index;return Re(2).toggleItem(s)}),Z(13,"mat-icon",9),ue(14,"check_box_outline_blank"),J()(),yt(15,"HR"),J()()()}if(2&i){const e=t.$implicit,n=t.index,r=Re(2);se(1),fe("hidden",!r.getToggle(n)),se(6),fe("ngForOf",Bs(8,3,e.segments,Qi(9,6,r._filterService._segmentFilters))),se(3),fe("hidden",r.getToggle(n))}}function Wpe(i,t){if(1&i&&(Wo(0),Ue(1,Gpe,16,8,"div",5),jo()),2&i){const e=t.ngIf,n=Re();se(1),fe("ngForOf",e[0])("ngForTrackBy",n.trackByFunction)}}let MP=(()=>{class i extends HH{constructor(e,n,r,s,a,l,u,h,m,_){super(e,n,r,s,a,u,h,l,m,_),this.name=i.COMPONENT_NAME,this.toggle=[],this._count=5*this.scrollIncrement()}scrollIncrement(){return 100}toggleItem(e){this.toggle[e]=!this.toggle[e]}getToggle(e){return this.toggle[e]}subscribe(e){e&&(this.toggle=[],this._dataSource=e.temporalObjectsAsObservable.pipe(Ui(n=>{if(0===n.length)return[];for(let r=0;r<n.length;r++)this.toggle.push(!0);return n})))}trackByFunction(e,n){return n.object.objectid+"_"+n.segments.length}}return i.COMPONENT_NAME="temporal_list",i.\u0275fac=function(e){return new(e||i)(B(Pn),B(Rc),B(Rp),B(Bh),B(Zc),B(dr),B(Ql),B(Ru),B(Ts),B(Lu))},i.\u0275cmp=ei({type:i,selectors:[["app-temporal-list"]],features:[It],decls:12,vars:24,consts:[[2,"padding","10px"],["class","background-prompt",4,"ngIf"],["infiniteScroll","",1,"list",3,"fromRoot","infiniteScrollContainer","infiniteScrollDistance","infiniteScrollUpDistance","alwaysCallback","scrolled"],[4,"ngIf"],[1,"background-prompt"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"hidden"],[1,"container"],["mat-mini-fab","","color","warn","matTooltip","Toggle object container",1,"icon-button","right-corner",3,"click"],["inline","true",2,"font-size","1.5em","vertical-align","top"],[1,"objectPathContainer"],["class","",3,"container","score","segment","temporalObject",4,"ngFor","ngForOf"],[1,"borderless-container"],[1,"",3,"container","score","segment","temporalObject"]],template:function(e,n){1&e&&(Z(0,"div",0),Ue(1,Vpe,2,0,"p",1),ti(2,"async"),Ue(3,zpe,2,0,"p",1),ti(4,"async"),Z(5,"div",2),je("scrolled",function(){return n.incrementCount()}),Ue(6,Wpe,2,2,"ng-container",3),ti(7,"LimitPathsPipe"),ti(8,"FilterPipe"),ti(9,"async"),ti(10,"ObjectFilterTemporalPipe"),ti(11,"async"),J()()),2&e&&(se(1),fe("ngIf",!Qi(2,8,n._dataSource)&&!n._loading),se(2),fe("ngIf",!Qi(4,10,n._dataSource)&&n._loading),se(2),fe("fromRoot",!0)("infiniteScrollContainer","#scrollable")("infiniteScrollDistance",1)("infiniteScrollUpDistance",2)("alwaysCallback",!0),se(1),fe("ngIf",Bs(7,12,Bs(8,15,Qi(9,18,n._dataSource),Qi(10,20,Qi(11,22,n._filterService._objectFilters))),n._count)))},styles:[".objectPathContainer[_ngcontent-%COMP%]{padding:4px;display:grid;grid-template-columns:repeat(auto-fill,120px);grid-template-rows:repeat(auto-fill,110px);grid-auto-flow:row;grid-row-gap:5px;grid-column-gap:5px}.top-right-button-toggled[_ngcontent-%COMP%]{position:absolute;right:-5px}.right-corner[_ngcontent-%COMP%]{position:relative;top:5px;right:5px;float:right;border:none;outline:none}.container[_ngcontent-%COMP%]{position:relative;border:1px solid black;margin-bottom:10px}.borderless-container[_ngcontent-%COMP%]{position:relative;margin-bottom:50px;border:none}.segment[_ngcontent-%COMP%]{width:120px;height:110px;position:relative}app-result-segment-preview-tile.marked[_ngcontent-%COMP%]{box-shadow:4px 4px 2px gray}.segment[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;object-fit:contain}.segment[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{position:absolute;top:0;height:25px;left:0;right:0;z-index:100;background-color:#000;opacity:.65;color:#fff}.segment[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{position:absolute;top:75px;left:0;right:0;height:25px;z-index:100;background-color:#000;opacity:.65;color:#fff}.header[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{max-height:20px!important;max-width:20px!important;line-height:0!important}.header[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{max-height:18px;max-width:18px}.header[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:16px!important}.footer[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{max-height:20px!important;max-width:20px!important;line-height:0!important}.footer[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{max-height:18px;max-width:18px}.footer[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:16px!important}"],changeDetection:0}),i})();class J9{constructor(t,e,n,r,s){this.objectId=t,this.segmentId=e,this.startabs=n,this.endabs=r,this._score=s}}class uS{encodeKey(t){return encodeURIComponent(t)}encodeValue(t){return encodeURIComponent(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}const hS=new gi("basePath");class fh{constructor(t={}){this.apiKeys=t.apiKeys,this.username=t.username,this.password=t.password,this.accessToken=t.accessToken,this.basePath=t.basePath,this.withCredentials=t.withCredentials,this.encoder=t.encoder,this.credentials=t.credentials?t.credentials:{}}selectHeaderContentType(t){if(0===t.length)return;const e=t.find(n=>this.isJsonMime(n));return void 0===e?t[0]:e}selectHeaderAccept(t){if(0===t.length)return;const e=t.find(n=>this.isJsonMime(n));return void 0===e?t[0]:e}isJsonMime(t){const e=new RegExp("^(application/json|[^;/ \t]+/[^;/ \t]+[+]json)[ \t]*(;.*)?$","i");return null!==t&&(e.test(t)||"application/json-patch+json"===t.toLowerCase())}lookupCredential(t){const e=this.credentials[t];return"function"==typeof e?e():e}}let VH=(()=>{class i{constructor(e,n,r){this.httpClient=e,this.basePath="http://localhost",this.defaultHeaders=new Pa,this.configuration=new fh,r&&(this.configuration=r),"string"!=typeof this.configuration.basePath&&("string"!=typeof n&&(n=this.basePath),this.configuration.basePath=n),this.encoder=this.configuration.encoder||new uS}addToHttpParams(e,n,r){return"object"!=typeof n||n instanceof Date?this.addToHttpParamsRecursive(e,n,r):this.addToHttpParamsRecursive(e,n)}addToHttpParamsRecursive(e,n,r){if(null==n)return e;if("object"==typeof n)if(Array.isArray(n))n.forEach(s=>e=this.addToHttpParamsRecursive(e,s,r));else if(n instanceof Date){if(null==r)throw Error("key may not be null if value is Date");e=e.append(r,n.toISOString().substr(0,10))}else Object.keys(n).forEach(s=>e=this.addToHttpParamsRecursive(e,n[s],null!=r?`${r}.${s}`:s));else{if(null==r)throw Error("key may not be null if value is not object or array");e=e.append(r,n)}return e}getApiV1ClientRunInfoCurrenttaskWithRunid(e,n,r="body",s=!1,a){if(null==e)throw new Error("Required parameter runId was null or undefined when calling getApiV1ClientRunInfoCurrenttaskWithRunid.");if(null==n)throw new Error("Required parameter session was null or undefined when calling getApiV1ClientRunInfoCurrenttaskWithRunid.");let l=new oh({encoder:this.encoder});null!=n&&(l=this.addToHttpParams(l,n,"session"));let u=this.defaultHeaders,h=a&&a.httpHeaderAccept;void 0===h&&(h=this.configuration.selectHeaderAccept(["application/json"])),void 0!==h&&(u=u.set("Accept",h));let m=a&&a.context;void 0===m&&(m=new Fr);let _="json";return h&&(_=h.startsWith("text")?"text":this.configuration.isJsonMime(h)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/api/v1/client/run/info/currentTask/${encodeURIComponent(String(e))}`,{context:m,params:l,responseType:_,withCredentials:this.configuration.withCredentials,headers:u,observe:r,reportProgress:s})}getApiV1ClientRunInfoList(e,n="body",r=!1,s){if(null==e)throw new Error("Required parameter session was null or undefined when calling getApiV1ClientRunInfoList.");let a=new oh({encoder:this.encoder});null!=e&&(a=this.addToHttpParams(a,e,"session"));let l=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(l=l.set("Accept",u));let h=s&&s.context;void 0===h&&(h=new Fr);let m="json";return u&&(m=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/api/v1/client/run/info/list`,{context:h,params:a,responseType:m,withCredentials:this.configuration.withCredentials,headers:l,observe:n,reportProgress:r})}}return i.\u0275fac=function(e){return new(e||i)(Ve(ma),Ve(hS,8),Ve(fh,8))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),$9=(()=>{class i{constructor(e,n,r){this.httpClient=e,this.basePath="http://localhost",this.defaultHeaders=new Pa,this.configuration=new fh,r&&(this.configuration=r),"string"!=typeof this.configuration.basePath&&("string"!=typeof n&&(n=this.basePath),this.configuration.basePath=n),this.encoder=this.configuration.encoder||new uS}addToHttpParams(e,n,r){return"object"!=typeof n||n instanceof Date?this.addToHttpParamsRecursive(e,n,r):this.addToHttpParamsRecursive(e,n)}addToHttpParamsRecursive(e,n,r){if(null==n)return e;if("object"==typeof n)if(Array.isArray(n))n.forEach(s=>e=this.addToHttpParamsRecursive(e,s,r));else if(n instanceof Date){if(null==r)throw Error("key may not be null if value is Date");e=e.append(r,n.toISOString().substr(0,10))}else Object.keys(n).forEach(s=>e=this.addToHttpParamsRecursive(e,n[s],null!=r?`${r}.${s}`:s));else{if(null==r)throw Error("key may not be null if value is not object or array");e=e.append(r,n)}return e}postApiV1LogQuery(e,n,r="body",s=!1,a){if(null==e)throw new Error("Required parameter session was null or undefined when calling postApiV1LogQuery.");let l=new oh({encoder:this.encoder});null!=e&&(l=this.addToHttpParams(l,e,"session"));let u=this.defaultHeaders,h=a&&a.httpHeaderAccept;void 0===h&&(h=this.configuration.selectHeaderAccept(["application/json"])),void 0!==h&&(u=u.set("Accept",h));let m=a&&a.context;void 0===m&&(m=new Fr);const v=this.configuration.selectHeaderContentType(["application/json"]);void 0!==v&&(u=u.set("Content-Type",v));let S="json";return h&&(S=h.startsWith("text")?"text":this.configuration.isJsonMime(h)?"json":"blob"),this.httpClient.post(`${this.configuration.basePath}/api/v1/log/query`,n,{context:m,params:l,responseType:S,withCredentials:this.configuration.withCredentials,headers:u,observe:r,reportProgress:s})}postApiV1LogResult(e,n,r="body",s=!1,a){if(null==e)throw new Error("Required parameter session was null or undefined when calling postApiV1LogResult.");let l=new oh({encoder:this.encoder});null!=e&&(l=this.addToHttpParams(l,e,"session"));let u=this.defaultHeaders,h=a&&a.httpHeaderAccept;void 0===h&&(h=this.configuration.selectHeaderAccept(["application/json"])),void 0!==h&&(u=u.set("Accept",h));let m=a&&a.context;void 0===m&&(m=new Fr);const v=this.configuration.selectHeaderContentType(["application/json"]);void 0!==v&&(u=u.set("Content-Type",v));let S="json";return h&&(S=h.startsWith("text")?"text":this.configuration.isJsonMime(h)?"json":"blob"),this.httpClient.post(`${this.configuration.basePath}/api/v1/log/result`,n,{context:m,params:l,responseType:S,withCredentials:this.configuration.withCredentials,headers:u,observe:r,reportProgress:s})}}return i.\u0275fac=function(e){return new(e||i)(Ve(ma),Ve(hS,8),Ve(fh,8))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),eq=(()=>{class i{constructor(e,n,r){this.httpClient=e,this.basePath="http://localhost",this.defaultHeaders=new Pa,this.configuration=new fh,r&&(this.configuration=r),"string"!=typeof this.configuration.basePath&&("string"!=typeof n&&(n=this.basePath),this.configuration.basePath=n),this.encoder=this.configuration.encoder||new uS}addToHttpParams(e,n,r){return"object"!=typeof n||n instanceof Date?this.addToHttpParamsRecursive(e,n,r):this.addToHttpParamsRecursive(e,n)}addToHttpParamsRecursive(e,n,r){if(null==n)return e;if("object"==typeof n)if(Array.isArray(n))n.forEach(s=>e=this.addToHttpParamsRecursive(e,s,r));else if(n instanceof Date){if(null==r)throw Error("key may not be null if value is Date");e=e.append(r,n.toISOString().substr(0,10))}else Object.keys(n).forEach(s=>e=this.addToHttpParamsRecursive(e,n[s],null!=r?`${r}.${s}`:s));else{if(null==r)throw Error("key may not be null if value is not object or array");e=e.append(r,n)}return e}getApiV1Submit(e,n,r,s,a,l,u,h="body",m=!1,_){let v=new oh({encoder:this.encoder});null!=e&&(v=this.addToHttpParams(v,e,"collection")),null!=n&&(v=this.addToHttpParams(v,n,"item")),null!=r&&(v=this.addToHttpParams(v,r,"text")),null!=s&&(v=this.addToHttpParams(v,s,"frame")),null!=a&&(v=this.addToHttpParams(v,a,"shot")),null!=l&&(v=this.addToHttpParams(v,l,"timecode")),null!=u&&(v=this.addToHttpParams(v,u,"session"));let S=this.defaultHeaders,T=_&&_.httpHeaderAccept;void 0===T&&(T=this.configuration.selectHeaderAccept(["application/json"])),void 0!==T&&(S=S.set("Accept",T));let I=_&&_.context;void 0===I&&(I=new Fr);let j="json";return T&&(j=T.startsWith("text")?"text":this.configuration.isJsonMime(T)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/api/v1/submit`,{context:I,params:v,responseType:j,withCredentials:this.configuration.withCredentials,headers:S,observe:h,reportProgress:m})}}return i.\u0275fac=function(e){return new(e||i)(Ve(ma),Ve(hS,8),Ve(fh,8))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),zH=(()=>{class i{constructor(e,n,r){this.httpClient=e,this.basePath="http://localhost",this.defaultHeaders=new Pa,this.configuration=new fh,r&&(this.configuration=r),"string"!=typeof this.configuration.basePath&&("string"!=typeof n&&(n=this.basePath),this.configuration.basePath=n),this.encoder=this.configuration.encoder||new uS}addToHttpParams(e,n,r){return"object"!=typeof n||n instanceof Date?this.addToHttpParamsRecursive(e,n,r):this.addToHttpParamsRecursive(e,n)}addToHttpParamsRecursive(e,n,r){if(null==n)return e;if("object"==typeof n)if(Array.isArray(n))n.forEach(s=>e=this.addToHttpParamsRecursive(e,s,r));else if(n instanceof Date){if(null==r)throw Error("key may not be null if value is Date");e=e.append(r,n.toISOString().substr(0,10))}else Object.keys(n).forEach(s=>e=this.addToHttpParamsRecursive(e,n[s],null!=r?`${r}.${s}`:s));else{if(null==r)throw Error("key may not be null if value is not object or array");e=e.append(r,n)}return e}getApiV1Logout(e,n="body",r=!1,s){let a=new oh({encoder:this.encoder});null!=e&&(a=this.addToHttpParams(a,e,"session"));let l=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(l=l.set("Accept",u));let h=s&&s.context;void 0===h&&(h=new Fr);let m="json";return u&&(m=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/api/v1/logout`,{context:h,params:a,responseType:m,withCredentials:this.configuration.withCredentials,headers:l,observe:n,reportProgress:r})}getApiV1User(e="body",n=!1,r){let s=this.defaultHeaders,a=r&&r.httpHeaderAccept;void 0===a&&(a=this.configuration.selectHeaderAccept(["application/json"])),void 0!==a&&(s=s.set("Accept",a));let l=r&&r.context;void 0===l&&(l=new Fr);let u="json";return a&&(u=a.startsWith("text")?"text":this.configuration.isJsonMime(a)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/api/v1/user`,{context:l,responseType:u,withCredentials:this.configuration.withCredentials,headers:s,observe:e,reportProgress:n})}postApiV1Login(e,n="body",r=!1,s){let a=this.defaultHeaders,l=s&&s.httpHeaderAccept;void 0===l&&(l=this.configuration.selectHeaderAccept(["application/json"])),void 0!==l&&(a=a.set("Accept",l));let u=s&&s.context;void 0===u&&(u=new Fr);const m=this.configuration.selectHeaderContentType(["application/json"]);void 0!==m&&(a=a.set("Content-Type",m));let _="json";return l&&(_=l.startsWith("text")?"text":this.configuration.isJsonMime(l)?"json":"blob"),this.httpClient.post(`${this.configuration.basePath}/api/v1/login`,e,{context:u,responseType:_,withCredentials:this.configuration.withCredentials,headers:a,observe:n,reportProgress:r})}}return i.\u0275fac=function(e){return new(e||i)(Ve(ma),Ve(hS,8),Ve(fh,8))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Xpe=(()=>{class i{constructor(e,n){if(e)throw new Error("ApiModule is already loaded. Import in your base AppModule only.");if(!n)throw new Error("You need to import the HttpClientModule in your AppModule! \nSee also https://github.com/angular/angular/issues/20575")}static forRoot(e){return{ngModule:i,providers:[{provide:fh,useFactory:e}]}}}return i.\u0275fac=function(e){return new(e||i)(Ve(i,12),Ve(ma,8))},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({providers:[],imports:[[]]}),i})(),wT=(()=>{class i{constructor(e,n,r){this._configService=e,this._runInfo=n,this._dresUser=r,this._status=new gs(null),this._activeRun=new gs(null),this._activeTask=new gs(null),this._configService.configAsObservable.subscribe(s=>{null!=(null==s?void 0:s.dresEndpointRest)&&this._dresUser.getApiV1User().subscribe({next:a=>{this._status.next(a)},error:a=>{this._status.error(a)}})}),this.updateDresInfo(),setInterval(()=>{this.updateDresInfo()},5e3)}updateDresInfo(){var e;null!=this.getStatus()&&this._runInfo.getApiV1ClientRunInfoList(null===(e=this.getStatus())||void 0===e?void 0:e.sessionId).subscribe(n=>{const r=n.runs.filter(a=>"ACTIVE"==a.status),s=0==r.length?null:r[0];this._activeRun.next(s),s&&this._runInfo.getApiV1ClientRunInfoCurrenttaskWithRunid(this._activeRun.getValue().id,this.getStatus().sessionId).subscribe(a=>{this._activeTask.next(a)})})}statusObservable(){return this._status.asObservable()}activeTaskObservable(){return this._activeTask.asObservable()}activeRunObservable(){return this._activeRun.asObservable()}activeTask(){return this._activeTask.getValue()}activeRun(){return this._activeRun.getValue()}getStatus(){try{return this._status.getValue()?this._status.getValue():null}catch(e){return null}}}return i.\u0275fac=function(e){return new(e||i)(Ve(dr),Ve(VH),Ve(zH))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})(),sg=(()=>{class i{constructor(e,n,r,s,a,l,u,h,m,_,v,S,T){this._config=e,this._eventbus=n,this._queryService=r,this._selection=s,this._metadata=a,this._http=l,this._snackBar=u,this._dresSubmit=h,this._dresLog=m,this._dresUser=_,this._filterService=S,this._dresService=T,this._submitSubject=new ii,this._submitTextSubject=new ii,this._vbs=!1,this._lsc=!1,this._log=!1,this._sessionId=void 0,e.configAsObservable.subscribe(I=>{!I||(this._log=I._config.competition.log,this._log&&(this._dresResultsLogTable=v.db.table("log_results_dres"),this._resultsLogTable=v.db.table("log_results"),this._queryLogTable=v.db.table("log_queries"),this._dresInteractionLogTable=v.db.table("log_interaction_dres"),this._dresSubmissionLogTable=v.db.table("log_submission_dres")),this.reset(I))}),this._dresService.statusObservable().subscribe({next:I=>{I&&(this._sessionId=I.sessionId)},error:I=>{console.error("failed to connect to DRES",I)}})}get isOn(){return this._config.configAsObservable.pipe(Ui(e=>null==e.dresEndpointRest))}static timeToFrame(e,n){return Math.floor(e*n)}submitSegment(e){this.isOn&&this.submit(e,(e.startabs+e.endabs)/2)}submitText(e){this.isOn&&(console.log(`Submitting text ${e}`),this._submitTextSubject.next(e))}submit(e,n){this._log&&this._dresSubmissionLogTable.add([e.segmentId,n]),console.debug(`Submitting segment ${e.segmentId} @ ${n}`),this._submitSubject.next([e,n]),this._selection.add(this._selection._available[1],e.segmentId)}reset(e){if(this._lsc=e._config.competition.lsc,this._vbs=e._config.competition.vbs,this.cleanup(),this._log){console.log("setting up logging for interactions and results"),this._interactionlogSubscription=$b.mapEventStream(this._eventbus.observable()).pipe(function _de(i,...t){var e,n;const r=null!==(e=tu(t))&&void 0!==e?e:Hw,s=null!==(n=t[0])&&void 0!==n?n:null,a=t[1]||1/0;return gr((l,u)=>{let h=[],m=!1;const _=T=>{const{buffer:I,subs:j}=T;j.unsubscribe(),te(h,T),u.next(I),m&&v()},v=()=>{if(h){const T=new Q;u.add(T);const j={buffer:[],subs:T};h.push(j),Fc(T,r,()=>_(j),i)}};null!==s&&s>=0?Fc(u,r,v,s,!0):m=!0,v();const S=qn(u,T=>{const I=h.slice();for(const j of I){const{buffer:P}=j;P.push(T),a<=P.length&&_(j)}},()=>{for(;null==h?void 0:h.length;)u.next(h.shift().buffer);null==S||S.unsubscribe(),u.complete(),u.unsubscribe()},void 0,()=>h=null);l.subscribe(S)})}(e._config.competition.loginterval),Ui(a=>{if(a&&a.length>0){const l={timestamp:Date.now(),events:[]};for(const u of a)l.events.push(...u.events);return l}return null}),vr(a=>null!=a),ks(a=>(this._dresInteractionLogTable.add(a),this._sessionId?(console.log("Submitting interaction log to DRES."),this._dresLog.postApiV1LogQuery(this._sessionId,a).pipe(Po(l=>{console.log("Successfully submitted interaction log to DRES.")}),Iu(l=>Qn(`Failed to submit segment to DRES due to a HTTP error (${l}).`)))):aa))).subscribe();const n=this._queryService.observable.pipe(vr(a=>"ENDED"===a),ks(a=>this._queryService.results.segmentsAsObservable),jm(1e3)),r=this._queryService.observable.pipe(vr(a=>"ENDED"===a),ks(a=>this._queryService.results.temporalObjectsAsObservable),jm(1e3)),s=this._filterService.filterSubject.pipe(jm(1e3));this._queryService.observable.pipe(vr(a=>"STARTED"==a),Po(()=>{const a=this._dresService.activeTask(),l=this._dresService.activeRun(),h={query:this._queryService.lastQueryIssued(),dresTask:a,dresRun:l};console.log("logging query"),this._queryLogTable.add(h)})).subscribe(),this._resultsSubscription=zb([n,r,this._eventbus.currentView(),s]).pipe(jm(200),vr(()=>null===this._eventbus.lastQueryInteractionEvent()?(console.error("no query logged for interaction logging, not logging anything"),!1):null!==this._queryService.lastQueryIssued()||(console.error("no query logged in query service, not logging anything"),!1)),Po(([a,l,u,h])=>{console.log("logging results");const m=this._queryService.lastQueryIssued();let _;_=u===MP.COMPONENT_NAME?l.flatMap(S=>S.segments.map(T=>new J9(S.object.objectid,T.segmentId,T.startabs,T.endabs,S.score))):a.map(S=>new J9(S.objectId,S.segmentId,S.startabs,S.endabs,S.score)),this._resultsLogTable.add({filter:h,query:m,results:_})}),Ui(([a,l,u,h])=>{const m=this._eventbus.lastQueryInteractionEvent();return u===MP.COMPONENT_NAME?$b.mapTemporalScoreContainer(u,l,m):$b.mapSegmentScoreContainer(u,a,m)}),vr(a=>null!=a),ks(a=>this._sessionId?(this._dresResultsLogTable.add(a),console.log("Submitting result log to DRES..."),this._dresLog.postApiV1LogResult(this._sessionId,a).pipe(Po(l=>{console.log("Successfully submitted result log to DRES!")}),Iu(l=>Qn(`Failed to submit segment to DRES due to a HTTP error (${l.status}).`)))):aa)).subscribe()}console.debug("setting up regular submissions"),this._submitSubscription=this._submitSubject.pipe(Ui(([n,r])=>this.convertToAppropriateRepresentation(n,r)),ks(([n,r,s])=>(console.debug(`planning to submit ${s} to DRES: ${n} @ ${r}`),this._sessionId?(this._log&&this._dresSubmissionLogTable.add([n,r]),this._dresSubmit.getApiV1Submit(null,n,null,r).pipe(Po(a=>{this.handleSubmissionResponse(a,s)}),Iu(a=>this.handleSubmissionError(a,s)))):(console.error("no session id set, not submitting"),aa)))).subscribe(),this._config.config._config.competition.textualInput&&(console.log("setting up textual submissions"),this._submitTextSubscription=this._submitTextSubject.pipe(ks(n=>(console.debug(`planning to submit ${n} to DRES`),this._sessionId?(this._log&&this._dresSubmissionLogTable.add(n),this._dresSubmit.getApiV1Submit(null,null,n).pipe(Po(r=>{this.handleSubmissionResponse(r,null)}),Iu(r=>this.handleSubmissionError(r,null)))):(console.error("no session id set, not submitting"),aa)))).subscribe())}handleSubmissionError(e,n){return this._selection.add(this._selection._available[3],n),this._snackBar.open(e.error?`Submissions error: ${e.error.description}`:`Submissions error: ${e.message}`,null,{duration:Pb.SNACKBAR_DURATION,panelClass:"snackbar-error"}),Qn(null)}handleSubmissionResponse(e,n){switch(e.submission){case"CORRECT":this._selection.add(this._selection._available[2],n),this._snackBar.open(e.description,null,{duration:Pb.SNACKBAR_DURATION,panelClass:"snackbar-success"});break;case"WRONG":this._selection.add(this._selection._available[0],n),this._snackBar.open(e.description,null,{duration:Pb.SNACKBAR_DURATION,panelClass:"snackbar-warning"});break;default:this._snackBar.open(e.description,null,{duration:Pb.SNACKBAR_DURATION})}}convertToAppropriateRepresentation(e,n){if(this._vbs){let r=Number.parseFloat(e.objectScoreContainer.metadata.get("technical.fps"));return(Number.isNaN(r)||!Number.isFinite(r))&&(r=class gde{static bestEffortFPS(t){return(t.end-t.start)/(t.endabs-t.startabs)}}.bestEffortFPS(e)),[e.objectId.replace("v_",""),i.timeToFrame(n,r),e.segmentId]}return this._lsc?[e.segmentId.replace("is_",""),n,e.segmentId]:[e.segmentId,n,e.segmentId]}cleanup(){null!=this._submitSubscription&&(this._submitSubscription.unsubscribe(),this._submitSubscription=null),null!=this._submitTextSubscription&&(this._submitTextSubscription.unsubscribe(),this._submitTextSubscription=null),null!=this._interactionlogSubscription&&(this._interactionlogSubscription.unsubscribe(),this._interactionlogSubscription=null),null!=this._resultsSubscription&&(this._resultsSubscription.unsubscribe(),this._interactionlogSubscription=null)}}return i.\u0275fac=function(e){return new(e||i)(Ve(dr),Ve(Zc),Ve(Rc),Ve(Bh),Ve(Kb),Ve(ma),Ve(Ru),Ve(eq),Ve($9),Ve(zH),Ve(Fh),Ve(Rp),Ve(wT))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})(),TP=(()=>{class i{constructor(e,n,r){this._submissionService=e,this._configService=n,this._dresService=r,this._dresStatusBadge=new gs(""),zb([this._dresService.statusObservable(),this._configService.configAsObservable]).pipe(Po(([s,a])=>{a._config.competition.host&&s&&this._dresStatusBadge.next("")}),Iu(s=>(this._configService.config._config.competition.host&&this._dresStatusBadge.next(Wj.getNotificationSymbol()),Qn()))).subscribe()}getDresStatusBadgeObservable(){return this._dresStatusBadge.asObservable()}}return i.\u0275fac=function(e){return new(e||i)(Ve(sg),Ve(dr),Ve(wT))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})();const Zpe=["*",[["mat-toolbar-row"]]],Ype=["*","mat-toolbar-row"],Kpe=Vf(class{constructor(i){this._elementRef=i}});let Qpe=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275dir=Be({type:i,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"]}),i})(),My=(()=>{class i extends Kpe{constructor(e,n,r){super(e),this._platform=n,this._document=r}ngAfterViewInit(){this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(ta),B(ar))},i.\u0275cmp=ei({type:i,selectors:[["mat-toolbar"]],contentQueries:function(e,n,r){if(1&e&&Er(r,Qpe,5),2&e){let s;jt(s=qt())&&(n._toolbarRows=s)}},hostAttrs:[1,"mat-toolbar"],hostVars:4,hostBindings:function(e,n){2&e&&N("mat-toolbar-multiple-rows",n._toolbarRows.length>0)("mat-toolbar-single-row",0===n._toolbarRows.length)},inputs:{color:"color"},exportAs:["matToolbar"],features:[It],ngContentSelectors:Ype,decls:2,vars:0,template:function(e,n){1&e&&(As(Zpe),hr(0),hr(1,1))},styles:[".cdk-high-contrast-active .mat-toolbar{outline:solid 1px}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%}\n"],encapsulation:2,changeDetection:0}),i})(),tq=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[jn],jn]}),i})(),Jpe=0;const $pe=Hf(class{}),iq="mat-badge-content";let UH=(()=>{class i extends $pe{constructor(e,n,r,s,a){super(),this._ngZone=e,this._elementRef=n,this._ariaDescriber=r,this._renderer=s,this._animationMode=a,this._color="primary",this._overlap=!0,this.position="above after",this.size="medium",this._id=Jpe++,this._isInitialized=!1}get color(){return this._color}set color(e){this._setColor(e),this._color=e}get overlap(){return this._overlap}set overlap(e){this._overlap=tn(e)}get content(){return this._content}set content(e){this._updateRenderedContent(e)}get description(){return this._description}set description(e){this._updateHostAriaDescription(e)}get hidden(){return this._hidden}set hidden(e){this._hidden=tn(e)}isAbove(){return-1===this.position.indexOf("below")}isAfter(){return-1===this.position.indexOf("before")}getBadgeElement(){return this._badgeElement}ngOnInit(){this._clearExistingBadges(),this.content&&!this._badgeElement&&(this._badgeElement=this._createBadgeElement(),this._updateRenderedContent(this.content)),this._isInitialized=!0}ngOnDestroy(){this._renderer.destroyNode&&this._renderer.destroyNode(this._badgeElement),this._ariaDescriber.removeDescription(this._elementRef.nativeElement,this.description)}_createBadgeElement(){const e=this._renderer.createElement("span"),n="mat-badge-active";return e.setAttribute("id",`mat-badge-content-${this._id}`),e.setAttribute("aria-hidden","true"),e.classList.add(iq),"NoopAnimations"===this._animationMode&&e.classList.add("_mat-animation-noopable"),this._elementRef.nativeElement.appendChild(e),"function"==typeof requestAnimationFrame&&"NoopAnimations"!==this._animationMode?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{e.classList.add(n)})}):e.classList.add(n),e}_updateRenderedContent(e){const n=`${null!=e?e:""}`.trim();this._isInitialized&&n&&!this._badgeElement&&(this._badgeElement=this._createBadgeElement()),this._badgeElement&&(this._badgeElement.textContent=n),this._content=n}_updateHostAriaDescription(e){this._ariaDescriber.removeDescription(this._elementRef.nativeElement,this.description),e&&this._ariaDescriber.describe(this._elementRef.nativeElement,e),this._description=e}_setColor(e){const n=this._elementRef.nativeElement.classList;n.remove(`mat-badge-${this._color}`),e&&n.add(`mat-badge-${e}`)}_clearExistingBadges(){const e=this._elementRef.nativeElement.querySelectorAll(`:scope > .${iq}`);for(const n of Array.from(e))n!==this._badgeElement&&n.remove()}}return i.\u0275fac=function(e){return new(e||i)(B(Rn),B(ai),B(r7),B(nu),B(ga,8))},i.\u0275dir=Be({type:i,selectors:[["","matBadge",""]],hostAttrs:[1,"mat-badge"],hostVars:20,hostBindings:function(e,n){2&e&&N("mat-badge-overlap",n.overlap)("mat-badge-above",n.isAbove())("mat-badge-below",!n.isAbove())("mat-badge-before",!n.isAfter())("mat-badge-after",n.isAfter())("mat-badge-small","small"===n.size)("mat-badge-medium","medium"===n.size)("mat-badge-large","large"===n.size)("mat-badge-hidden",n.hidden||!n.content)("mat-badge-disabled",n.disabled)},inputs:{disabled:["matBadgeDisabled","disabled"],color:["matBadgeColor","color"],overlap:["matBadgeOverlap","overlap"],position:["matBadgePosition","position"],content:["matBadge","content"],description:["matBadgeDescription","description"],size:["matBadgeSize","size"],hidden:["matBadgeHidden","hidden"]},features:[It]}),i})(),nq=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[nN,jn],jn]}),i})();const eme=["connectionContainer"],tme=["inputContainer"],ime=["label"];function nme(i,t){1&i&&(Wo(0),Z(1,"div",14),yt(2,"div",15)(3,"div",16)(4,"div",17),J(),Z(5,"div",18),yt(6,"div",15)(7,"div",16)(8,"div",17),J(),jo())}function rme(i,t){if(1&i){const e=Wi();Z(0,"div",19),je("cdkObserveContent",function(){return gt(e),Re().updateOutlineGap()}),hr(1,1),J()}2&i&&fe("cdkObserveContentDisabled","outline"!=Re().appearance)}function sme(i,t){if(1&i&&(Wo(0),hr(1,2),Z(2,"span"),ue(3),J(),jo()),2&i){const e=Re(2);se(3),Xt(e._control.placeholder)}}function ome(i,t){1&i&&hr(0,3,["*ngSwitchCase","true"])}function ame(i,t){1&i&&(Z(0,"span",23),ue(1," *"),J())}function lme(i,t){if(1&i){const e=Wi();Z(0,"label",20,21),je("cdkObserveContent",function(){return gt(e),Re().updateOutlineGap()}),Ue(2,sme,4,1,"ng-container",12),Ue(3,ome,1,0,"ng-content",12),Ue(4,ame,2,0,"span",22),J()}if(2&i){const e=Re();N("mat-empty",e._control.empty&&!e._shouldAlwaysFloat())("mat-form-field-empty",e._control.empty&&!e._shouldAlwaysFloat())("mat-accent","accent"==e.color)("mat-warn","warn"==e.color),fe("cdkObserveContentDisabled","outline"!=e.appearance)("id",e._labelId)("ngSwitch",e._hasLabel()),Vi("for",e._control.id)("aria-owns",e._control.id),se(2),fe("ngSwitchCase",!1),se(1),fe("ngSwitchCase",!0),se(1),fe("ngIf",!e.hideRequiredMarker&&e._control.required&&!e._control.disabled)}}function cme(i,t){1&i&&(Z(0,"div",24),hr(1,4),J())}function ume(i,t){if(1&i&&(Z(0,"div",25),yt(1,"span",26),J()),2&i){const e=Re();se(1),N("mat-accent","accent"==e.color)("mat-warn","warn"==e.color)}}function hme(i,t){1&i&&(Z(0,"div"),hr(1,5),J()),2&i&&fe("@transitionMessages",Re()._subscriptAnimationState)}function dme(i,t){if(1&i&&(Z(0,"div",30),ue(1),J()),2&i){const e=Re(2);fe("id",e._hintLabelId),se(1),Xt(e.hintLabel)}}function fme(i,t){if(1&i&&(Z(0,"div",27),Ue(1,dme,2,2,"div",28),hr(2,6),yt(3,"div",29),hr(4,7),J()),2&i){const e=Re();fe("@transitionMessages",e._subscriptAnimationState),se(1),fe("ngIf",e.hintLabel)}}const pme=["*",[["","matPrefix",""]],[["mat-placeholder"]],[["mat-label"]],[["","matSuffix",""]],[["mat-error"]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],mme=["*","[matPrefix]","mat-placeholder","mat-label","[matSuffix]","mat-error","mat-hint:not([align='end'])","mat-hint[align='end']"],gme=new gi("MatError"),_me={transitionMessages:Xd("transitionMessages",[Cl("enter",Xs({opacity:1,transform:"translateY(0%)"})),Ml("void => enter",[Xs({opacity:0,transform:"translateY(-5px)"}),ql("300ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])};let ST=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275dir=Be({type:i}),i})(),yme=0;const rq=new gi("MatHint");let vme=(()=>{class i{constructor(){this.align="start",this.id="mat-hint-"+yme++}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275dir=Be({type:i,selectors:[["mat-hint"]],hostAttrs:[1,"mat-hint"],hostVars:4,hostBindings:function(e,n){2&e&&(Vi("id",n.id)("align",null),N("mat-form-field-hint-end","end"===n.align))},inputs:{align:"align",id:"id"},features:[Sn([{provide:rq,useExisting:i}])]}),i})(),EP=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275dir=Be({type:i,selectors:[["mat-label"]]}),i})(),bme=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275dir=Be({type:i,selectors:[["mat-placeholder"]]}),i})();const xme=new gi("MatPrefix"),sq=new gi("MatSuffix");let GH=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275dir=Be({type:i,selectors:[["","matSuffix",""]],features:[Sn([{provide:sq,useExisting:i}])]}),i})(),oq=0;const Sme=Vf(class{constructor(i){this._elementRef=i}},"primary"),Cme=new gi("MAT_FORM_FIELD_DEFAULT_OPTIONS"),AP=new gi("MatFormField");let og=(()=>{class i extends Sme{constructor(e,n,r,s,a,l,u){super(e),this._changeDetectorRef=n,this._dir=r,this._defaults=s,this._platform=a,this._ngZone=l,this._outlineGapCalculationNeededImmediately=!1,this._outlineGapCalculationNeededOnStable=!1,this._destroyed=new ii,this._showAlwaysAnimate=!1,this._subscriptAnimationState="",this._hintLabel="",this._hintLabelId="mat-hint-"+oq++,this._labelId="mat-form-field-label-"+oq++,this.floatLabel=this._getDefaultFloatLabelState(),this._animationsEnabled="NoopAnimations"!==u,this.appearance=s&&s.appearance?s.appearance:"legacy",this._hideRequiredMarker=!(!s||null==s.hideRequiredMarker)&&s.hideRequiredMarker}get appearance(){return this._appearance}set appearance(e){const n=this._appearance;this._appearance=e||this._defaults&&this._defaults.appearance||"legacy","outline"===this._appearance&&n!==e&&(this._outlineGapCalculationNeededOnStable=!0)}get hideRequiredMarker(){return this._hideRequiredMarker}set hideRequiredMarker(e){this._hideRequiredMarker=tn(e)}_shouldAlwaysFloat(){return"always"===this.floatLabel&&!this._showAlwaysAnimate}_canLabelFloat(){return"never"!==this.floatLabel}get hintLabel(){return this._hintLabel}set hintLabel(e){this._hintLabel=e,this._processHints()}get floatLabel(){return"legacy"!==this.appearance&&"never"===this._floatLabel?"auto":this._floatLabel}set floatLabel(e){e!==this._floatLabel&&(this._floatLabel=e||this._getDefaultFloatLabelState(),this._changeDetectorRef.markForCheck())}get _control(){return this._explicitFormFieldControl||this._controlNonStatic||this._controlStatic}set _control(e){this._explicitFormFieldControl=e}getLabelId(){return this._hasFloatingLabel()?this._labelId:null}getConnectedOverlayOrigin(){return this._connectionContainerRef||this._elementRef}ngAfterContentInit(){this._validateControlChild();const e=this._control;e.controlType&&this._elementRef.nativeElement.classList.add(`mat-form-field-type-${e.controlType}`),e.stateChanges.pipe(Tl(null)).subscribe(()=>{this._validatePlaceholders(),this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),e.ngControl&&e.ngControl.valueChanges&&e.ngControl.valueChanges.pipe($n(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck()),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe($n(this._destroyed)).subscribe(()=>{this._outlineGapCalculationNeededOnStable&&this.updateOutlineGap()})}),uo(this._prefixChildren.changes,this._suffixChildren.changes).subscribe(()=>{this._outlineGapCalculationNeededOnStable=!0,this._changeDetectorRef.markForCheck()}),this._hintChildren.changes.pipe(Tl(null)).subscribe(()=>{this._processHints(),this._changeDetectorRef.markForCheck()}),this._errorChildren.changes.pipe(Tl(null)).subscribe(()=>{this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._dir&&this._dir.change.pipe($n(this._destroyed)).subscribe(()=>{"function"==typeof requestAnimationFrame?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>this.updateOutlineGap())}):this.updateOutlineGap()})}ngAfterContentChecked(){this._validateControlChild(),this._outlineGapCalculationNeededImmediately&&this.updateOutlineGap()}ngAfterViewInit(){this._subscriptAnimationState="enter",this._changeDetectorRef.detectChanges()}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_shouldForward(e){const n=this._control?this._control.ngControl:null;return n&&n[e]}_hasPlaceholder(){return!!(this._control&&this._control.placeholder||this._placeholderChild)}_hasLabel(){return!(!this._labelChildNonStatic&&!this._labelChildStatic)}_shouldLabelFloat(){return this._canLabelFloat()&&(this._control&&this._control.shouldLabelFloat||this._shouldAlwaysFloat())}_hideControlPlaceholder(){return"legacy"===this.appearance&&!this._hasLabel()||this._hasLabel()&&!this._shouldLabelFloat()}_hasFloatingLabel(){return this._hasLabel()||"legacy"===this.appearance&&this._hasPlaceholder()}_getDisplayedMessages(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}_animateAndLockLabel(){this._hasFloatingLabel()&&this._canLabelFloat()&&(this._animationsEnabled&&this._label&&(this._showAlwaysAnimate=!0,os(this._label.nativeElement,"transitionend").pipe(Qr(1)).subscribe(()=>{this._showAlwaysAnimate=!1})),this.floatLabel="always",this._changeDetectorRef.markForCheck())}_validatePlaceholders(){}_processHints(){this._validateHints(),this._syncDescribedByIds()}_validateHints(){}_getDefaultFloatLabelState(){return this._defaults&&this._defaults.floatLabel||"auto"}_syncDescribedByIds(){if(this._control){let e=[];if(this._control.userAriaDescribedBy&&"string"==typeof this._control.userAriaDescribedBy&&e.push(...this._control.userAriaDescribedBy.split(" ")),"hint"===this._getDisplayedMessages()){const n=this._hintChildren?this._hintChildren.find(s=>"start"===s.align):null,r=this._hintChildren?this._hintChildren.find(s=>"end"===s.align):null;n?e.push(n.id):this._hintLabel&&e.push(this._hintLabelId),r&&e.push(r.id)}else this._errorChildren&&e.push(...this._errorChildren.map(n=>n.id));this._control.setDescribedByIds(e)}}_validateControlChild(){}updateOutlineGap(){const e=this._label?this._label.nativeElement:null,n=this._connectionContainerRef.nativeElement,r=".mat-form-field-outline-start",s=".mat-form-field-outline-gap";if("outline"!==this.appearance||!this._platform.isBrowser)return;if(!e||!e.children.length||!e.textContent.trim()){const m=n.querySelectorAll(`${r}, ${s}`);for(let _=0;_<m.length;_++)m[_].style.width="0";return}if(!this._isAttachedToDOM())return void(this._outlineGapCalculationNeededImmediately=!0);let a=0,l=0;const u=n.querySelectorAll(r),h=n.querySelectorAll(s);if(this._label&&this._label.nativeElement.children.length){const m=n.getBoundingClientRect();if(0===m.width&&0===m.height)return this._outlineGapCalculationNeededOnStable=!0,void(this._outlineGapCalculationNeededImmediately=!1);const _=this._getStartEnd(m),v=e.children,S=this._getStartEnd(v[0].getBoundingClientRect());let T=0;for(let I=0;I<v.length;I++)T+=v[I].offsetWidth;a=Math.abs(S-_)-5,l=T>0?.75*T+10:0}for(let m=0;m<u.length;m++)u[m].style.width=`${a}px`;for(let m=0;m<h.length;m++)h[m].style.width=`${l}px`;this._outlineGapCalculationNeededOnStable=this._outlineGapCalculationNeededImmediately=!1}_getStartEnd(e){return this._dir&&"rtl"===this._dir.value?e.right:e.left}_isAttachedToDOM(){const e=this._elementRef.nativeElement;if(e.getRootNode){const n=e.getRootNode();return n&&n!==e}return document.documentElement.contains(e)}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(Pn),B(Ia,8),B(Cme,8),B(ta),B(Rn),B(ga,8))},i.\u0275cmp=ei({type:i,selectors:[["mat-form-field"]],contentQueries:function(e,n,r){if(1&e&&(Er(r,ST,5),Er(r,ST,7),Er(r,EP,5),Er(r,EP,7),Er(r,bme,5),Er(r,gme,5),Er(r,rq,5),Er(r,xme,5),Er(r,sq,5)),2&e){let s;jt(s=qt())&&(n._controlNonStatic=s.first),jt(s=qt())&&(n._controlStatic=s.first),jt(s=qt())&&(n._labelChildNonStatic=s.first),jt(s=qt())&&(n._labelChildStatic=s.first),jt(s=qt())&&(n._placeholderChild=s.first),jt(s=qt())&&(n._errorChildren=s),jt(s=qt())&&(n._hintChildren=s),jt(s=qt())&&(n._prefixChildren=s),jt(s=qt())&&(n._suffixChildren=s)}},viewQuery:function(e,n){if(1&e&&(ji(eme,7),ji(tme,5),ji(ime,5)),2&e){let r;jt(r=qt())&&(n._connectionContainerRef=r.first),jt(r=qt())&&(n._inputContainerRef=r.first),jt(r=qt())&&(n._label=r.first)}},hostAttrs:[1,"mat-form-field"],hostVars:40,hostBindings:function(e,n){2&e&&N("mat-form-field-appearance-standard","standard"==n.appearance)("mat-form-field-appearance-fill","fill"==n.appearance)("mat-form-field-appearance-outline","outline"==n.appearance)("mat-form-field-appearance-legacy","legacy"==n.appearance)("mat-form-field-invalid",n._control.errorState)("mat-form-field-can-float",n._canLabelFloat())("mat-form-field-should-float",n._shouldLabelFloat())("mat-form-field-has-label",n._hasFloatingLabel())("mat-form-field-hide-placeholder",n._hideControlPlaceholder())("mat-form-field-disabled",n._control.disabled)("mat-form-field-autofilled",n._control.autofilled)("mat-focused",n._control.focused)("ng-untouched",n._shouldForward("untouched"))("ng-touched",n._shouldForward("touched"))("ng-pristine",n._shouldForward("pristine"))("ng-dirty",n._shouldForward("dirty"))("ng-valid",n._shouldForward("valid"))("ng-invalid",n._shouldForward("invalid"))("ng-pending",n._shouldForward("pending"))("_mat-animation-noopable",!n._animationsEnabled)},inputs:{color:"color",appearance:"appearance",hideRequiredMarker:"hideRequiredMarker",hintLabel:"hintLabel",floatLabel:"floatLabel"},exportAs:["matFormField"],features:[Sn([{provide:AP,useExisting:i}]),It],ngContentSelectors:mme,decls:15,vars:8,consts:[[1,"mat-form-field-wrapper"],[1,"mat-form-field-flex",3,"click"],["connectionContainer",""],[4,"ngIf"],["class","mat-form-field-prefix",3,"cdkObserveContentDisabled","cdkObserveContent",4,"ngIf"],[1,"mat-form-field-infix"],["inputContainer",""],[1,"mat-form-field-label-wrapper"],["class","mat-form-field-label",3,"cdkObserveContentDisabled","id","mat-empty","mat-form-field-empty","mat-accent","mat-warn","ngSwitch","cdkObserveContent",4,"ngIf"],["class","mat-form-field-suffix",4,"ngIf"],["class","mat-form-field-underline",4,"ngIf"],[1,"mat-form-field-subscript-wrapper",3,"ngSwitch"],[4,"ngSwitchCase"],["class","mat-form-field-hint-wrapper",4,"ngSwitchCase"],[1,"mat-form-field-outline"],[1,"mat-form-field-outline-start"],[1,"mat-form-field-outline-gap"],[1,"mat-form-field-outline-end"],[1,"mat-form-field-outline","mat-form-field-outline-thick"],[1,"mat-form-field-prefix",3,"cdkObserveContentDisabled","cdkObserveContent"],[1,"mat-form-field-label",3,"cdkObserveContentDisabled","id","ngSwitch","cdkObserveContent"],["label",""],["class","mat-placeholder-required mat-form-field-required-marker","aria-hidden","true",4,"ngIf"],["aria-hidden","true",1,"mat-placeholder-required","mat-form-field-required-marker"],[1,"mat-form-field-suffix"],[1,"mat-form-field-underline"],[1,"mat-form-field-ripple"],[1,"mat-form-field-hint-wrapper"],["class","mat-hint",3,"id",4,"ngIf"],[1,"mat-form-field-hint-spacer"],[1,"mat-hint",3,"id"]],template:function(e,n){1&e&&(As(pme),Z(0,"div",0)(1,"div",1,2),je("click",function(s){return n._control.onContainerClick&&n._control.onContainerClick(s)}),Ue(3,nme,9,0,"ng-container",3),Ue(4,rme,2,1,"div",4),Z(5,"div",5,6),hr(7),Z(8,"span",7),Ue(9,lme,5,16,"label",8),J()(),Ue(10,cme,2,0,"div",9),J(),Ue(11,ume,2,4,"div",10),Z(12,"div",11),Ue(13,hme,2,1,"div",12),Ue(14,fme,5,2,"div",13),J()()),2&e&&(se(3),fe("ngIf","outline"==n.appearance),se(1),fe("ngIf",n._prefixChildren.length),se(5),fe("ngIf",n._hasFloatingLabel()),se(1),fe("ngIf",n._suffixChildren.length),se(1),fe("ngIf","outline"!=n.appearance),se(1),fe("ngSwitch",n._getDisplayedMessages()),se(1),fe("ngSwitchCase","error"),se(1),fe("ngSwitchCase","hint"))},directives:[ms,wk,Dw,AR],styles:[".mat-form-field{display:inline-block;position:relative;text-align:left}[dir=rtl] .mat-form-field{text-align:right}.mat-form-field-wrapper{position:relative}.mat-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-form-field-prefix,.mat-form-field-suffix{white-space:nowrap;flex:none;position:relative}.mat-form-field-infix{display:block;position:relative;flex:auto;min-width:0;width:180px}.cdk-high-contrast-active .mat-form-field-infix{border-image:linear-gradient(transparent, transparent)}.mat-form-field-label-wrapper{position:absolute;left:0;box-sizing:content-box;width:100%;height:100%;overflow:hidden;pointer-events:none}[dir=rtl] .mat-form-field-label-wrapper{left:auto;right:0}.mat-form-field-label{position:absolute;left:0;font:inherit;pointer-events:none;width:100%;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;transform-origin:0 0;transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1),color 400ms cubic-bezier(0.25, 0.8, 0.25, 1),width 400ms cubic-bezier(0.25, 0.8, 0.25, 1);display:none}[dir=rtl] .mat-form-field-label{transform-origin:100% 0;left:auto;right:0}.cdk-high-contrast-active .mat-form-field-disabled .mat-form-field-label{color:GrayText}.mat-form-field-empty.mat-form-field-label,.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-label{display:block}.mat-form-field-autofill-control:-webkit-autofill+.mat-form-field-label-wrapper .mat-form-field-label{display:none}.mat-form-field-can-float .mat-form-field-autofill-control:-webkit-autofill+.mat-form-field-label-wrapper .mat-form-field-label{display:block;transition:none}.mat-input-server:focus+.mat-form-field-label-wrapper .mat-form-field-label,.mat-input-server[placeholder]:not(:placeholder-shown)+.mat-form-field-label-wrapper .mat-form-field-label{display:none}.mat-form-field-can-float .mat-input-server:focus+.mat-form-field-label-wrapper .mat-form-field-label,.mat-form-field-can-float .mat-input-server[placeholder]:not(:placeholder-shown)+.mat-form-field-label-wrapper .mat-form-field-label{display:block}.mat-form-field-label:not(.mat-form-field-empty){transition:none}.mat-form-field-underline{position:absolute;width:100%;pointer-events:none;transform:scale3d(1, 1.0001, 1)}.mat-form-field-ripple{position:absolute;left:0;width:100%;transform-origin:50%;transform:scaleX(0.5);opacity:0;transition:background-color 300ms cubic-bezier(0.55, 0, 0.55, 0.2)}.mat-form-field.mat-focused .mat-form-field-ripple,.mat-form-field.mat-form-field-invalid .mat-form-field-ripple{opacity:1;transform:none;transition:transform 300ms cubic-bezier(0.25, 0.8, 0.25, 1),opacity 100ms cubic-bezier(0.25, 0.8, 0.25, 1),background-color 300ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-subscript-wrapper{position:absolute;box-sizing:border-box;width:100%;overflow:hidden}.mat-form-field-subscript-wrapper .mat-icon,.mat-form-field-label-wrapper .mat-icon{width:1em;height:1em;font-size:inherit;vertical-align:baseline}.mat-form-field-hint-wrapper{display:flex}.mat-form-field-hint-spacer{flex:1 0 1em}.mat-error{display:block}.mat-form-field-control-wrapper{position:relative}.mat-form-field-hint-end{order:1}.mat-form-field._mat-animation-noopable .mat-form-field-label,.mat-form-field._mat-animation-noopable .mat-form-field-ripple{transition:none}\n",'.mat-form-field-appearance-fill .mat-form-field-flex{border-radius:4px 4px 0 0;padding:.75em .75em 0 .75em}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-form-field-flex{outline:solid 1px}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-form-field-disabled .mat-form-field-flex{outline-color:GrayText}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-focused .mat-form-field-flex{outline:dashed 3px}.mat-form-field-appearance-fill .mat-form-field-underline::before{content:"";display:block;position:absolute;bottom:0;height:1px;width:100%}.mat-form-field-appearance-fill .mat-form-field-ripple{bottom:0;height:2px}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-form-field-ripple{height:0}.mat-form-field-appearance-fill:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{opacity:1;transform:none;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-fill._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{transition:none}.mat-form-field-appearance-fill .mat-form-field-subscript-wrapper{padding:0 1em}\n','.mat-input-element{font:inherit;background:transparent;color:currentColor;border:none;outline:none;padding:0;margin:0;width:100%;max-width:100%;vertical-align:bottom;text-align:inherit;box-sizing:content-box}.mat-input-element:-moz-ui-invalid{box-shadow:none}.mat-input-element,.mat-input-element::-webkit-search-cancel-button,.mat-input-element::-webkit-search-decoration,.mat-input-element::-webkit-search-results-button,.mat-input-element::-webkit-search-results-decoration{-webkit-appearance:none}.mat-input-element::-webkit-contacts-auto-fill-button,.mat-input-element::-webkit-caps-lock-indicator,.mat-input-element:not([type=password])::-webkit-credentials-auto-fill-button{visibility:hidden}.mat-input-element[type=date],.mat-input-element[type=datetime],.mat-input-element[type=datetime-local],.mat-input-element[type=month],.mat-input-element[type=week],.mat-input-element[type=time]{line-height:1}.mat-input-element[type=date]::after,.mat-input-element[type=datetime]::after,.mat-input-element[type=datetime-local]::after,.mat-input-element[type=month]::after,.mat-input-element[type=week]::after,.mat-input-element[type=time]::after{content:" ";white-space:pre;width:1px}.mat-input-element::-webkit-inner-spin-button,.mat-input-element::-webkit-calendar-picker-indicator,.mat-input-element::-webkit-clear-button{font-size:.75em}.mat-input-element::placeholder{-webkit-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element::-moz-placeholder{-webkit-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element::-webkit-input-placeholder{-webkit-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element:-ms-input-placeholder{-webkit-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-hide-placeholder .mat-input-element::placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-input-element::placeholder{opacity:0}.mat-form-field-hide-placeholder .mat-input-element::-moz-placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-input-element::-moz-placeholder{opacity:0}.mat-form-field-hide-placeholder .mat-input-element::-webkit-input-placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-input-element::-webkit-input-placeholder{opacity:0}.mat-form-field-hide-placeholder .mat-input-element:-ms-input-placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-input-element:-ms-input-placeholder{opacity:0}textarea.mat-input-element{resize:vertical;overflow:auto}textarea.mat-input-element.cdk-textarea-autosize{resize:none}textarea.mat-input-element{padding:2px 0;margin:-2px 0}select.mat-input-element{-moz-appearance:none;-webkit-appearance:none;position:relative;background-color:transparent;display:inline-flex;box-sizing:border-box;padding-top:1em;top:-1em;margin-bottom:-1em}select.mat-input-element::-moz-focus-inner{border:0}select.mat-input-element:not(:disabled){cursor:pointer}.mat-form-field-type-mat-native-select .mat-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:5px solid;position:absolute;top:50%;right:0;margin-top:-2.5px;pointer-events:none}[dir=rtl] .mat-form-field-type-mat-native-select .mat-form-field-infix::after{right:auto;left:0}.mat-form-field-type-mat-native-select .mat-input-element{padding-right:15px}[dir=rtl] .mat-form-field-type-mat-native-select .mat-input-element{padding-right:0;padding-left:15px}.mat-form-field-type-mat-native-select .mat-form-field-label-wrapper{max-width:calc(100% - 10px)}.mat-form-field-type-mat-native-select.mat-form-field-appearance-outline .mat-form-field-infix::after{margin-top:-5px}.mat-form-field-type-mat-native-select.mat-form-field-appearance-fill .mat-form-field-infix::after{margin-top:-10px}\n',".mat-form-field-appearance-legacy .mat-form-field-label{transform:perspective(100px)}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon{width:1em}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon-button,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon-button{font:inherit;vertical-align:baseline}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon-button .mat-icon{font-size:inherit}.mat-form-field-appearance-legacy .mat-form-field-underline{height:1px}.cdk-high-contrast-active .mat-form-field-appearance-legacy .mat-form-field-underline{height:0;border-top:solid 1px}.mat-form-field-appearance-legacy .mat-form-field-ripple{top:0;height:2px;overflow:hidden}.cdk-high-contrast-active .mat-form-field-appearance-legacy .mat-form-field-ripple{height:0;border-top:solid 2px}.mat-form-field-appearance-legacy.mat-form-field-disabled .mat-form-field-underline{background-position:0;background-color:transparent}.cdk-high-contrast-active .mat-form-field-appearance-legacy.mat-form-field-disabled .mat-form-field-underline{border-top-style:dotted;border-top-width:2px;border-top-color:GrayText}.mat-form-field-appearance-legacy.mat-form-field-invalid:not(.mat-focused) .mat-form-field-ripple{height:1px}\n",".mat-form-field-appearance-outline .mat-form-field-wrapper{margin:.25em 0}.mat-form-field-appearance-outline .mat-form-field-flex{padding:0 .75em 0 .75em;margin-top:-0.25em;position:relative}.mat-form-field-appearance-outline .mat-form-field-prefix,.mat-form-field-appearance-outline .mat-form-field-suffix{top:.25em}.mat-form-field-appearance-outline .mat-form-field-outline{display:flex;position:absolute;top:.25em;left:0;right:0;bottom:0;pointer-events:none}.mat-form-field-appearance-outline .mat-form-field-outline-start,.mat-form-field-appearance-outline .mat-form-field-outline-end{border:1px solid currentColor;min-width:5px}.mat-form-field-appearance-outline .mat-form-field-outline-start{border-radius:5px 0 0 5px;border-right-style:none}[dir=rtl] .mat-form-field-appearance-outline .mat-form-field-outline-start{border-right-style:solid;border-left-style:none;border-radius:0 5px 5px 0}.mat-form-field-appearance-outline .mat-form-field-outline-end{border-radius:0 5px 5px 0;border-left-style:none;flex-grow:1}[dir=rtl] .mat-form-field-appearance-outline .mat-form-field-outline-end{border-left-style:solid;border-right-style:none;border-radius:5px 0 0 5px}.mat-form-field-appearance-outline .mat-form-field-outline-gap{border-radius:.000001px;border:1px solid currentColor;border-left-style:none;border-right-style:none}.mat-form-field-appearance-outline.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-outline-gap{border-top-color:transparent}.mat-form-field-appearance-outline .mat-form-field-outline-thick{opacity:0}.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-start,.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-end,.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-gap{border-width:2px}.mat-form-field-appearance-outline.mat-focused .mat-form-field-outline,.mat-form-field-appearance-outline.mat-form-field-invalid .mat-form-field-outline{opacity:0;transition:opacity 100ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-outline.mat-focused .mat-form-field-outline-thick,.mat-form-field-appearance-outline.mat-form-field-invalid .mat-form-field-outline-thick{opacity:1}.cdk-high-contrast-active .mat-form-field-appearance-outline.mat-focused .mat-form-field-outline-thick{border:3px dashed}.mat-form-field-appearance-outline:not(.mat-form-field-disabled) .mat-form-field-flex:hover .mat-form-field-outline{opacity:0;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-outline:not(.mat-form-field-disabled) .mat-form-field-flex:hover .mat-form-field-outline-thick{opacity:1}.mat-form-field-appearance-outline .mat-form-field-subscript-wrapper{padding:0 1em}.cdk-high-contrast-active .mat-form-field-appearance-outline.mat-form-field-disabled .mat-form-field-outline{color:GrayText}.mat-form-field-appearance-outline._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-outline,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-start,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-end,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-gap{transition:none}\n",".mat-form-field-appearance-standard .mat-form-field-flex{padding-top:.75em}.mat-form-field-appearance-standard .mat-form-field-underline{height:1px}.cdk-high-contrast-active .mat-form-field-appearance-standard .mat-form-field-underline{height:0;border-top:solid 1px}.mat-form-field-appearance-standard .mat-form-field-ripple{bottom:0;height:2px}.cdk-high-contrast-active .mat-form-field-appearance-standard .mat-form-field-ripple{height:0;border-top:solid 2px}.mat-form-field-appearance-standard.mat-form-field-disabled .mat-form-field-underline{background-position:0;background-color:transparent}.cdk-high-contrast-active .mat-form-field-appearance-standard.mat-form-field-disabled .mat-form-field-underline{border-top-style:dotted;border-top-width:2px}.mat-form-field-appearance-standard:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{opacity:1;transform:none;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-standard._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{transition:none}\n"],encapsulation:2,data:{animation:[_me.transitionMessages]},changeDetection:0}),i})(),WH=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[ka,jn,H1],jn]}),i})();const lq=ly({passive:!0});let Mme=(()=>{class i{constructor(e,n){this._platform=e,this._ngZone=n,this._monitoredElements=new Map}monitor(e){if(!this._platform.isBrowser)return aa;const n=Gm(e),r=this._monitoredElements.get(n);if(r)return r.subject;const s=new ii,a="cdk-text-field-autofilled",l=u=>{"cdk-text-field-autofill-start"!==u.animationName||n.classList.contains(a)?"cdk-text-field-autofill-end"===u.animationName&&n.classList.contains(a)&&(n.classList.remove(a),this._ngZone.run(()=>s.next({target:u.target,isAutofilled:!1}))):(n.classList.add(a),this._ngZone.run(()=>s.next({target:u.target,isAutofilled:!0})))};return this._ngZone.runOutsideAngular(()=>{n.addEventListener("animationstart",l,lq),n.classList.add("cdk-text-field-autofill-monitored")}),this._monitoredElements.set(n,{subject:s,unlisten:()=>{n.removeEventListener("animationstart",l,lq)}}),s}stopMonitoring(e){const n=Gm(e),r=this._monitoredElements.get(n);r&&(r.unlisten(),r.subject.complete(),n.classList.remove("cdk-text-field-autofill-monitored"),n.classList.remove("cdk-text-field-autofilled"),this._monitoredElements.delete(n))}ngOnDestroy(){this._monitoredElements.forEach((e,n)=>this.stopMonitoring(n))}}return i.\u0275fac=function(e){return new(e||i)(Ve(ta),Ve(Rn))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),cq=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({}),i})();const Tme=new gi("MAT_INPUT_VALUE_ACCESSOR"),Eme=["button","checkbox","file","hidden","image","radio","range","reset","submit"];let Ame=0;const Dme=rN(class{constructor(i,t,e,n){this._defaultErrorStateMatcher=i,this._parentForm=t,this._parentFormGroup=e,this.ngControl=n}});let Ty=(()=>{class i extends Dme{constructor(e,n,r,s,a,l,u,h,m,_){super(l,s,a,r),this._elementRef=e,this._platform=n,this._autofillMonitor=h,this._formField=_,this._uid="mat-input-"+Ame++,this.focused=!1,this.stateChanges=new ii,this.controlType="mat-input",this.autofilled=!1,this._disabled=!1,this._type="text",this._readonly=!1,this._neverEmptyInputTypes=["date","datetime","datetime-local","month","time","week"].filter(T=>OW().has(T)),this._iOSKeyupListener=T=>{const I=T.target;!I.value&&0===I.selectionStart&&0===I.selectionEnd&&(I.setSelectionRange(1,1),I.setSelectionRange(0,0))};const v=this._elementRef.nativeElement,S=v.nodeName.toLowerCase();this._inputValueAccessor=u||v,this._previousNativeValue=this.value,this.id=this.id,n.IOS&&m.runOutsideAngular(()=>{e.nativeElement.addEventListener("keyup",this._iOSKeyupListener)}),this._isServer=!this._platform.isBrowser,this._isNativeSelect="select"===S,this._isTextarea="textarea"===S,this._isInFormField=!!_,this._isNativeSelect&&(this.controlType=v.multiple?"mat-native-select-multiple":"mat-native-select")}get disabled(){return this.ngControl&&null!==this.ngControl.disabled?this.ngControl.disabled:this._disabled}set disabled(e){this._disabled=tn(e),this.focused&&(this.focused=!1,this.stateChanges.next())}get id(){return this._id}set id(e){this._id=e||this._uid}get required(){var e,n,r,s;return null!==(s=null!==(e=this._required)&&void 0!==e?e:null===(r=null===(n=this.ngControl)||void 0===n?void 0:n.control)||void 0===r?void 0:r.hasValidator(j3.required))&&void 0!==s&&s}set required(e){this._required=tn(e)}get type(){return this._type}set type(e){this._type=e||"text",this._validateType(),!this._isTextarea&&OW().has(this._type)&&(this._elementRef.nativeElement.type=this._type)}get value(){return this._inputValueAccessor.value}set value(e){e!==this.value&&(this._inputValueAccessor.value=e,this.stateChanges.next())}get readonly(){return this._readonly}set readonly(e){this._readonly=tn(e)}ngAfterViewInit(){this._platform.isBrowser&&this._autofillMonitor.monitor(this._elementRef.nativeElement).subscribe(e=>{this.autofilled=e.isAutofilled,this.stateChanges.next()})}ngOnChanges(){this.stateChanges.next()}ngOnDestroy(){this.stateChanges.complete(),this._platform.isBrowser&&this._autofillMonitor.stopMonitoring(this._elementRef.nativeElement),this._platform.IOS&&this._elementRef.nativeElement.removeEventListener("keyup",this._iOSKeyupListener)}ngDoCheck(){this.ngControl&&this.updateErrorState(),this._dirtyCheckNativeValue(),this._dirtyCheckPlaceholder()}focus(e){this._elementRef.nativeElement.focus(e)}_focusChanged(e){e!==this.focused&&(this.focused=e,this.stateChanges.next())}_onInput(){}_dirtyCheckPlaceholder(){var e,n;const r=(null===(n=null===(e=this._formField)||void 0===e?void 0:e._hideControlPlaceholder)||void 0===n?void 0:n.call(e))?null:this.placeholder;if(r!==this._previousPlaceholder){const s=this._elementRef.nativeElement;this._previousPlaceholder=r,r?s.setAttribute("placeholder",r):s.removeAttribute("placeholder")}}_dirtyCheckNativeValue(){const e=this._elementRef.nativeElement.value;this._previousNativeValue!==e&&(this._previousNativeValue=e,this.stateChanges.next())}_validateType(){Eme.indexOf(this._type)}_isNeverEmpty(){return this._neverEmptyInputTypes.indexOf(this._type)>-1}_isBadInput(){let e=this._elementRef.nativeElement.validity;return e&&e.badInput}get empty(){return!(this._isNeverEmpty()||this._elementRef.nativeElement.value||this._isBadInput()||this.autofilled)}get shouldLabelFloat(){if(this._isNativeSelect){const e=this._elementRef.nativeElement,n=e.options[0];return this.focused||e.multiple||!this.empty||!!(e.selectedIndex>-1&&n&&n.label)}return this.focused||!this.empty}setDescribedByIds(e){e.length?this._elementRef.nativeElement.setAttribute("aria-describedby",e.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focused||this.focus()}_isInlineSelect(){const e=this._elementRef.nativeElement;return this._isNativeSelect&&(e.multiple||e.size>1)}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(ta),B(Nf,10),B(Cb,8),B(Ow,8),B(z1),B(Tme,10),B(Mme),B(Rn),B(AP,8))},i.\u0275dir=Be({type:i,selectors:[["input","matInput",""],["textarea","matInput",""],["select","matNativeControl",""],["input","matNativeControl",""],["textarea","matNativeControl",""]],hostAttrs:[1,"mat-input-element","mat-form-field-autofill-control"],hostVars:12,hostBindings:function(e,n){1&e&&je("focus",function(){return n._focusChanged(!0)})("blur",function(){return n._focusChanged(!1)})("input",function(){return n._onInput()}),2&e&&(dn("disabled",n.disabled)("required",n.required),Vi("id",n.id)("data-placeholder",n.placeholder)("name",n.name||null)("readonly",n.readonly&&!n._isNativeSelect||null)("aria-invalid",n.empty&&n.required?null:n.errorState)("aria-required",n.required),N("mat-input-server",n._isServer)("mat-native-select-inline",n._isInlineSelect()))},inputs:{disabled:"disabled",id:"id",placeholder:"placeholder",name:"name",required:"required",type:"type",errorStateMatcher:"errorStateMatcher",userAriaDescribedBy:["aria-describedby","userAriaDescribedBy"],value:"value",readonly:"readonly"},exportAs:["matInput"],features:[Sn([{provide:ST,useExisting:i}]),It,Ls]}),i})(),uq=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({providers:[z1],imports:[[cq,WH,jn],cq,WH]}),i})();function Rme(i,t){if(1&i){const e=Wi();Z(0,"button",5),je("click",function(){return gt(e),Re().value=""}),Z(1,"mat-icon"),ue(2,"close"),J()()}}let kme=(()=>{class i{constructor(e){this._submissionService=e,this.smallFont=!1}submit(){this._submissionService.submitText(this.value)}}return i.\u0275fac=function(e){return new(e||i)(B(sg))},i.\u0275cmp=ei({type:i,selectors:[["app-textual-submission"]],inputs:{smallFont:"smallFont"},decls:9,vars:5,consts:[[2,"padding","1rem"],["appearance","fill",1,"example-form-field"],["matInput","","type","text",3,"ngModel","ngModelChange","keyup.enter"],["matSuffix","","mat-icon-button","","aria-label","Clear",3,"click",4,"ngIf"],["mat-icon-button","","aria-label","Submit",3,"click"],["matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"]],template:function(e,n){1&e&&(Z(0,"div",0)(1,"mat-form-field",1)(2,"mat-label"),ue(3,"Textual Submission"),J(),Z(4,"input",2),je("ngModelChange",function(s){return n.value=s})("keyup.enter",function(){return n.submit()}),J(),Ue(5,Rme,3,0,"button",3),J(),Z(6,"button",4),je("click",function(){return n.submit()}),Z(7,"mat-icon"),ue(8,"send"),J()()()),2&e&&(se(2),Y(n.smallFont?"small-font":""),se(2),fe("ngModel",n.value),se(1),fe("ngIf",n.value))},directives:[og,EP,Ty,Bf,ah,lh,ms,Mo,GH,vo],styles:[".small-font[_ngcontent-%COMP%]{font-size:12px}"]}),i})(),dS=(()=>{class i{transform(e,n){return e?n(e):null}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275pipe=Hn({name:"GetConfigVariablePipe",type:i,pure:!0}),i})();function Pme(i,t){if(1&i&&(Z(0,"div",1),ue(1),J()),2&i){const e=Re();se(1),ui(" ",e.statusStr," ")}}let Ime=(()=>{class i{constructor(e,n,r){this.configService=e,this.cdr=n,this.dresService=r,this.taskSecondsRemaining=0,this.countDownFun=null,this.activeTask=null,this.competitionHost=s=>s._config.competition.host,this.statusStr="loading task information...",this.configService.configAsObservable.subscribe(s=>{this.config=s,this.cdr.markForCheck()})}ngOnInit(){this.dresService.statusObservable().subscribe({error:e=>{this.statusStr="Error while connecting to DRES",this.cdr.markForCheck()}}),this.dresService.activeTaskObservable().pipe(N1(1),Po(e=>{if(e&&e.running)return this.activeTask=e,clearInterval(this.countDownFun),this.taskSecondsRemaining=e.remainingTime,this.countDownFun=setInterval(()=>this.tic(),1e3),void this.renderSeconds();this.countDownFun=null,this.statusStr="no active task",this.cdr.markForCheck()})).subscribe()}tic(){this.taskSecondsRemaining=Math.max(0,this.taskSecondsRemaining-1),this.renderSeconds()}renderSeconds(){this.statusStr=`${this.activeTask.name}: ${i.toHHMMSS(this.taskSecondsRemaining)} remaining`,this.cdr.markForCheck()}static toHHMMSS(e){const n=parseInt(e,10),r=Math.floor(n/3600),s=Math.floor(n/60)%60,a=n%60;let l=[];return l=r>0?[r,s,a]:[s,a],l.map(u=>u<10?"0"+u:u).filter((u,h)=>"00"!==u||h>0).join(":")}}return i.\u0275fac=function(e){return new(e||i)(B(dr),B(Pn),B(wT))},i.\u0275cmp=ei({type:i,selectors:[["app-dres-timer"]],decls:2,vars:4,consts:[["class","mat-body-2",4,"ngIf"],[1,"mat-body-2"]],template:function(e,n){1&e&&(Ue(0,Pme,2,1,"div",0),ti(1,"GetConfigVariablePipe")),2&e&&fe("ngIf",Bs(1,1,n.config,n.competitionHost))},directives:[ms],pipes:[dS],encapsulation:2,changeDetection:0}),i})();const Lme=ks;class jH{constructor(t,e,n){this.timestamp=t,this.status=e,this.latency=n}}let Ome=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=ei({type:i,selectors:[["app-no-connect-dialog"]],decls:10,vars:1,consts:[["mat-dialog-title",""],[1,"mat-typography"],["mat-button","","mat-dialog-close",""],["mat-button","",3,"mat-dialog-close"]],template:function(e,n){1&e&&(Z(0,"h2",0),ue(1,"Could not connect to Cineast"),J(),Z(2,"mat-dialog-content",1)(3,"p"),ue(4,"Could not connect to Cineast. Please check the URL in your config and the status of your Cineast instance."),J()(),Z(5,"mat-dialog-actions")(6,"button",2),ue(7,"Ignore"),J(),Z(8,"button",3),ue(9,"Reconnect"),J()()),2&e&&(se(8),fe("mat-dialog-close",!0))},directives:[K9,cS,Hpe,Mo,Npe],encapsulation:2}),i})(),hq=(()=>{class i extends gs{constructor(e,n,r,s,a){super(new jH(Date.now(),"DISCONNECTED",Number.MAX_VALUE)),this._factory=e,this._snackBar=r,this._queryService=s,this._dialog=a,this._last=0,this._transit=0,this._currentStatus="",e.asObservable().pipe(vr(l=>null!=l)).subscribe(l=>{this._socket=l,this._socket.pipe(vr(u=>["PING"].indexOf(u.messageType)>-1)).subscribe(u=>this.onPingResponse(u))}),this.pipe(N1(1)).subscribe(l=>{l.status!==this._currentStatus&&"DISCONNECTED"===l.status&&(this._dialogRef=this._dialog.open(Ome),this._dialogRef.afterClosed().subscribe(u=>{u&&(this._dialogRef=void 0,this._factory.reconnect(!0))})),"OK"===l.status&&this._dialogRef&&this._dialogRef.close(!1),this._currentStatus=l.status}),n.configAsObservable.pipe(Lme(l=>ay(0,l.get("api.ping_interval")))).subscribe(()=>this.onTimer())}onTimer(){this._socket&&(this._last=Date.now(),this._transit+=1,this._socket.next({messageType:"PING"}),this._transit>1&&(this.next(new jH(Date.now(),"DISCONNECTED",Number.MAX_VALUE)),this._transit=0,!this._queryService.running&&!this._dialogRef&&this._factory.reconnect(!1)))}onPingResponse(e){const n=Date.now();this._transit-=1,this.next(new jH(n,e.status,n-this._last))}}return i.\u0275fac=function(e){return new(e||i)(Ve(iP),Ve(dr),Ve(Ru),Ve(Rc),Ve(Lu))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})();function qH(i){return Ui(()=>i)}function dq(i,t){return t?e=>V1(t.pipe(Qr(1),function Fme(){return gr((i,t)=>{i.subscribe(qn(t,G))})}()),e.pipe(dq(i))):ks((e,n)=>i(e,n).pipe(Qr(1),qH(e)))}function XH(i,t=Hw){const e=ay(i,t);return dq(()=>e)}const Bme=["mat-menu-item",""];function Nme(i,t){1&i&&(Zu(),Z(0,"svg",2),yt(1,"polygon",3),J())}const fq=["*"];function Hme(i,t){if(1&i){const e=Wi();Z(0,"div",0),je("keydown",function(r){return gt(e),Re()._handleKeydown(r)})("click",function(){return gt(e),Re().closed.emit("click")})("@transformMenu.start",function(r){return gt(e),Re()._onAnimationStart(r)})("@transformMenu.done",function(r){return gt(e),Re()._onAnimationDone(r)}),Z(1,"div",1),hr(2),J()()}if(2&i){const e=Re();fe("id",e.panelId)("ngClass",e._classList)("@transformMenu",e._panelAnimationState),Vi("aria-label",e.ariaLabel||null)("aria-labelledby",e.ariaLabelledby||null)("aria-describedby",e.ariaDescribedby||null)}}const DP={transformMenu:Xd("transformMenu",[Cl("void",Xs({opacity:0,transform:"scale(0.8)"})),Ml("void => enter",ql("120ms cubic-bezier(0, 0, 0.2, 1)",Xs({opacity:1,transform:"scale(1)"}))),Ml("* => void",ql("100ms 25ms linear",Xs({opacity:0})))]),fadeInItems:Xd("fadeInItems",[Cl("showing",Xs({opacity:1})),Ml("void => *",[Xs({opacity:0}),ql("400ms 100ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])},pq=new gi("MatMenuContent");let Vme=(()=>{class i{constructor(e,n,r,s,a,l,u){this._template=e,this._componentFactoryResolver=n,this._appRef=r,this._injector=s,this._viewContainerRef=a,this._document=l,this._changeDetectorRef=u,this._attached=new ii}attach(e={}){var n;this._portal||(this._portal=new Ep(this._template,this._viewContainerRef)),this.detach(),this._outlet||(this._outlet=new NW(this._document.createElement("div"),this._componentFactoryResolver,this._appRef,this._injector));const r=this._template.elementRef.nativeElement;r.parentNode.insertBefore(this._outlet.outletElement,r),null===(n=this._changeDetectorRef)||void 0===n||n.markForCheck(),this._portal.attach(this._outlet,e),this._attached.next()}detach(){this._portal.isAttached&&this._portal.detach()}ngOnDestroy(){this._outlet&&this._outlet.dispose()}}return i.\u0275fac=function(e){return new(e||i)(B(Xo),B(xp),B(Ew),B(Os),B(Ko),B(ar),B(Pn))},i.\u0275dir=Be({type:i}),i})(),zme=(()=>{class i extends Vme{}return i.\u0275fac=function(){let t;return function(n){return(t||(t=Ki(i)))(n||i)}}(),i.\u0275dir=Be({type:i,selectors:[["ng-template","matMenuContent",""]],features:[Sn([{provide:pq,useExisting:i}]),It]}),i})();const ZH=new gi("MAT_MENU_PANEL"),Ume=uh(Hf(class{}));let fS=(()=>{class i extends Ume{constructor(e,n,r,s,a){var l;super(),this._elementRef=e,this._document=n,this._focusMonitor=r,this._parentMenu=s,this._changeDetectorRef=a,this.role="menuitem",this._hovered=new ii,this._focused=new ii,this._highlighted=!1,this._triggersSubmenu=!1,null===(l=null==s?void 0:s.addItem)||void 0===l||l.call(s,this)}focus(e,n){this._focusMonitor&&e?this._focusMonitor.focusVia(this._getHostElement(),e,n):this._getHostElement().focus(n),this._focused.next(this)}ngAfterViewInit(){this._focusMonitor&&this._focusMonitor.monitor(this._elementRef,!1)}ngOnDestroy(){this._focusMonitor&&this._focusMonitor.stopMonitoring(this._elementRef),this._parentMenu&&this._parentMenu.removeItem&&this._parentMenu.removeItem(this),this._hovered.complete(),this._focused.complete()}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._elementRef.nativeElement}_checkDisabled(e){this.disabled&&(e.preventDefault(),e.stopPropagation())}_handleMouseEnter(){this._hovered.next(this)}getLabel(){var e;const n=this._elementRef.nativeElement.cloneNode(!0),r=n.querySelectorAll("mat-icon, .material-icons");for(let s=0;s<r.length;s++)r[s].remove();return(null===(e=n.textContent)||void 0===e?void 0:e.trim())||""}_setHighlighted(e){var n;this._highlighted=e,null===(n=this._changeDetectorRef)||void 0===n||n.markForCheck()}_hasFocus(){return this._document&&this._document.activeElement===this._getHostElement()}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(ar),B(ch),B(ZH,8),B(Pn))},i.\u0275cmp=ei({type:i,selectors:[["","mat-menu-item",""]],hostAttrs:[1,"mat-focus-indicator"],hostVars:10,hostBindings:function(e,n){1&e&&je("click",function(s){return n._checkDisabled(s)})("mouseenter",function(){return n._handleMouseEnter()}),2&e&&(Vi("role",n.role)("tabindex",n._getTabIndex())("aria-disabled",n.disabled.toString())("disabled",n.disabled||null),N("mat-menu-item",!0)("mat-menu-item-highlighted",n._highlighted)("mat-menu-item-submenu-trigger",n._triggersSubmenu))},inputs:{disabled:"disabled",disableRipple:"disableRipple",role:"role"},exportAs:["matMenuItem"],features:[It],attrs:Bme,ngContentSelectors:fq,decls:3,vars:3,consts:[["matRipple","",1,"mat-menu-ripple",3,"matRippleDisabled","matRippleTrigger"],["class","mat-menu-submenu-icon","viewBox","0 0 5 10","focusable","false",4,"ngIf"],["viewBox","0 0 5 10","focusable","false",1,"mat-menu-submenu-icon"],["points","0,0 5,5 0,10"]],template:function(e,n){1&e&&(As(),hr(0),yt(1,"div",0),Ue(2,Nme,2,0,"svg",1)),2&e&&(se(1),fe("matRippleDisabled",n.disableRipple||n.disabled)("matRippleTrigger",n._getHostElement()),se(1),fe("ngIf",n._triggersSubmenu))},directives:[hh,ms],encapsulation:2,changeDetection:0}),i})();const mq=new gi("mat-menu-default-options",{providedIn:"root",factory:function Gme(){return{overlapTrigger:!1,xPosition:"after",yPosition:"below",backdropClass:"cdk-overlay-transparent-backdrop"}}});let Wme=0,CT=(()=>{class i{constructor(e,n,r,s){this._elementRef=e,this._ngZone=n,this._defaultOptions=r,this._changeDetectorRef=s,this._xPosition=this._defaultOptions.xPosition,this._yPosition=this._defaultOptions.yPosition,this._directDescendantItems=new ey,this._tabSubscription=Q.EMPTY,this._classList={},this._panelAnimationState="void",this._animationDone=new ii,this.overlayPanelClass=this._defaultOptions.overlayPanelClass||"",this.backdropClass=this._defaultOptions.backdropClass,this._overlapTrigger=this._defaultOptions.overlapTrigger,this._hasBackdrop=this._defaultOptions.hasBackdrop,this.closed=new Si,this.close=this.closed,this.panelId="mat-menu-panel-"+Wme++}get xPosition(){return this._xPosition}set xPosition(e){this._xPosition=e,this.setPositionClasses()}get yPosition(){return this._yPosition}set yPosition(e){this._yPosition=e,this.setPositionClasses()}get overlapTrigger(){return this._overlapTrigger}set overlapTrigger(e){this._overlapTrigger=tn(e)}get hasBackdrop(){return this._hasBackdrop}set hasBackdrop(e){this._hasBackdrop=tn(e)}set panelClass(e){const n=this._previousPanelClass;n&&n.length&&n.split(" ").forEach(r=>{this._classList[r]=!1}),this._previousPanelClass=e,e&&e.length&&(e.split(" ").forEach(r=>{this._classList[r]=!0}),this._elementRef.nativeElement.className="")}get classList(){return this.panelClass}set classList(e){this.panelClass=e}ngOnInit(){this.setPositionClasses()}ngAfterContentInit(){this._updateDirectDescendants(),this._keyManager=new Mk(this._directDescendantItems).withWrap().withTypeAhead().withHomeAndEnd(),this._tabSubscription=this._keyManager.tabOut.subscribe(()=>this.closed.emit("tab")),this._directDescendantItems.changes.pipe(Tl(this._directDescendantItems),dh(e=>uo(...e.map(n=>n._focused)))).subscribe(e=>this._keyManager.updateActiveItem(e)),this._directDescendantItems.changes.subscribe(e=>{var n;const r=this._keyManager;if("enter"===this._panelAnimationState&&(null===(n=r.activeItem)||void 0===n?void 0:n._hasFocus())){const s=e.toArray(),a=Math.max(0,Math.min(s.length-1,r.activeItemIndex||0));s[a]&&!s[a].disabled?r.setActiveItem(a):r.setNextItemActive()}})}ngOnDestroy(){this._directDescendantItems.destroy(),this._tabSubscription.unsubscribe(),this.closed.complete()}_hovered(){return this._directDescendantItems.changes.pipe(Tl(this._directDescendantItems),dh(n=>uo(...n.map(r=>r._hovered))))}addItem(e){}removeItem(e){}_handleKeydown(e){const n=e.keyCode,r=this._keyManager;switch(n){case 27:dc(e)||(e.preventDefault(),this.closed.emit("keydown"));break;case 37:this.parentMenu&&"ltr"===this.direction&&this.closed.emit("keydown");break;case 39:this.parentMenu&&"rtl"===this.direction&&this.closed.emit("keydown");break;default:return(38===n||40===n)&&r.setFocusOrigin("keyboard"),void r.onKeydown(e)}e.stopPropagation()}focusFirstItem(e="program"){this.lazyContent?this._ngZone.onStable.pipe(Qr(1)).subscribe(()=>this._focusFirstItem(e)):this._focusFirstItem(e)}_focusFirstItem(e){const n=this._keyManager;if(n.setFocusOrigin(e).setFirstItemActive(),!n.activeItem&&this._directDescendantItems.length){let r=this._directDescendantItems.first._getHostElement().parentElement;for(;r;){if("menu"===r.getAttribute("role")){r.focus();break}r=r.parentElement}}}resetActiveItem(){this._keyManager.setActiveItem(-1)}setElevation(e){const n=Math.min(this._baseElevation+e,24),r=`${this._elevationPrefix}${n}`,s=Object.keys(this._classList).find(a=>a.startsWith(this._elevationPrefix));(!s||s===this._previousElevation)&&(this._previousElevation&&(this._classList[this._previousElevation]=!1),this._classList[r]=!0,this._previousElevation=r)}setPositionClasses(e=this.xPosition,n=this.yPosition){var r;const s=this._classList;s["mat-menu-before"]="before"===e,s["mat-menu-after"]="after"===e,s["mat-menu-above"]="above"===n,s["mat-menu-below"]="below"===n,null===(r=this._changeDetectorRef)||void 0===r||r.markForCheck()}_startAnimation(){this._panelAnimationState="enter"}_resetAnimation(){this._panelAnimationState="void"}_onAnimationDone(e){this._animationDone.next(e),this._isAnimating=!1}_onAnimationStart(e){this._isAnimating=!0,"enter"===e.toState&&0===this._keyManager.activeItemIndex&&(e.element.scrollTop=0)}_updateDirectDescendants(){this._allItems.changes.pipe(Tl(this._allItems)).subscribe(e=>{this._directDescendantItems.reset(e.filter(n=>n._parentMenu===this)),this._directDescendantItems.notifyOnChanges()})}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(Rn),B(mq),B(Pn))},i.\u0275dir=Be({type:i,contentQueries:function(e,n,r){if(1&e&&(Er(r,pq,5),Er(r,fS,5),Er(r,fS,4)),2&e){let s;jt(s=qt())&&(n.lazyContent=s.first),jt(s=qt())&&(n._allItems=s),jt(s=qt())&&(n.items=s)}},viewQuery:function(e,n){if(1&e&&ji(Xo,5),2&e){let r;jt(r=qt())&&(n.templateRef=r.first)}},inputs:{backdropClass:"backdropClass",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],ariaDescribedby:["aria-describedby","ariaDescribedby"],xPosition:"xPosition",yPosition:"yPosition",overlapTrigger:"overlapTrigger",hasBackdrop:"hasBackdrop",panelClass:["class","panelClass"],classList:"classList"},outputs:{closed:"closed",close:"close"}}),i})(),RP=(()=>{class i extends CT{constructor(e,n,r,s){super(e,n,r,s),this._elevationPrefix="mat-elevation-z",this._baseElevation=4}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(Rn),B(mq),B(Pn))},i.\u0275cmp=ei({type:i,selectors:[["mat-menu"]],hostVars:3,hostBindings:function(e,n){2&e&&Vi("aria-label",null)("aria-labelledby",null)("aria-describedby",null)},exportAs:["matMenu"],features:[Sn([{provide:ZH,useExisting:i}]),It],ngContentSelectors:fq,decls:1,vars:0,consts:[["tabindex","-1","role","menu",1,"mat-menu-panel",3,"id","ngClass","keydown","click"],[1,"mat-menu-content"]],template:function(e,n){1&e&&(As(),Ue(0,Hme,3,6,"ng-template"))},directives:[Cp],styles:['mat-menu{display:none}.mat-menu-panel{min-width:112px;max-width:280px;overflow:auto;-webkit-overflow-scrolling:touch;max-height:calc(100vh - 48px);border-radius:4px;outline:0;min-height:64px}.mat-menu-panel.ng-animating{pointer-events:none}.cdk-high-contrast-active .mat-menu-panel{outline:solid 1px}.mat-menu-content:not(:empty){padding-top:8px;padding-bottom:8px}.mat-menu-item{-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;line-height:48px;height:48px;padding:0 16px;text-align:left;text-decoration:none;max-width:100%;position:relative}.mat-menu-item::-moz-focus-inner{border:0}.mat-menu-item[disabled]{cursor:default}[dir=rtl] .mat-menu-item{text-align:right}.mat-menu-item .mat-icon{margin-right:16px;vertical-align:middle}.mat-menu-item .mat-icon svg{vertical-align:top}[dir=rtl] .mat-menu-item .mat-icon{margin-left:16px;margin-right:0}.mat-menu-item[disabled]::before{display:block;position:absolute;content:"";top:0;left:0;bottom:0;right:0}.cdk-high-contrast-active .mat-menu-item{margin-top:1px}.cdk-high-contrast-active .mat-menu-item.cdk-program-focused,.cdk-high-contrast-active .mat-menu-item.cdk-keyboard-focused,.cdk-high-contrast-active .mat-menu-item-highlighted{outline:dotted 1px}.mat-menu-item-submenu-trigger{padding-right:32px}[dir=rtl] .mat-menu-item-submenu-trigger{padding-right:16px;padding-left:32px}.mat-menu-submenu-icon{position:absolute;top:50%;right:16px;transform:translateY(-50%);width:5px;height:10px;fill:currentColor}[dir=rtl] .mat-menu-submenu-icon{right:auto;left:16px;transform:translateY(-50%) scaleX(-1)}.cdk-high-contrast-active .mat-menu-submenu-icon{fill:CanvasText}button.mat-menu-item{width:100%}.mat-menu-item .mat-menu-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}\n'],encapsulation:2,data:{animation:[DP.transformMenu,DP.fadeInItems]},changeDetection:0}),i})();const gq=new gi("mat-menu-scroll-strategy"),qme={provide:gq,deps:[Du],useFactory:function jme(i){return()=>i.scrollStrategies.reposition()}},yq=ly({passive:!0});let Xme=(()=>{class i{constructor(e,n,r,s,a,l,u,h,m){this._overlay=e,this._element=n,this._viewContainerRef=r,this._menuItemInstance=l,this._dir=u,this._focusMonitor=h,this._ngZone=m,this._overlayRef=null,this._menuOpen=!1,this._closingActionsSubscription=Q.EMPTY,this._hoverSubscription=Q.EMPTY,this._menuCloseSubscription=Q.EMPTY,this._handleTouchStart=_=>{eN(_)||(this._openedBy="touch")},this._openedBy=void 0,this.restoreFocus=!0,this.menuOpened=new Si,this.onMenuOpen=this.menuOpened,this.menuClosed=new Si,this.onMenuClose=this.menuClosed,this._scrollStrategy=s,this._parentMaterialMenu=a instanceof CT?a:void 0,n.nativeElement.addEventListener("touchstart",this._handleTouchStart,yq),l&&(l._triggersSubmenu=this.triggersSubmenu())}get _deprecatedMatMenuTriggerFor(){return this.menu}set _deprecatedMatMenuTriggerFor(e){this.menu=e}get menu(){return this._menu}set menu(e){e!==this._menu&&(this._menu=e,this._menuCloseSubscription.unsubscribe(),e&&(this._menuCloseSubscription=e.close.subscribe(n=>{this._destroyMenu(n),("click"===n||"tab"===n)&&this._parentMaterialMenu&&this._parentMaterialMenu.closed.emit(n)})))}ngAfterContentInit(){this._checkMenu(),this._handleHover()}ngOnDestroy(){this._overlayRef&&(this._overlayRef.dispose(),this._overlayRef=null),this._element.nativeElement.removeEventListener("touchstart",this._handleTouchStart,yq),this._menuCloseSubscription.unsubscribe(),this._closingActionsSubscription.unsubscribe(),this._hoverSubscription.unsubscribe()}get menuOpen(){return this._menuOpen}get dir(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}triggersSubmenu(){return!(!this._menuItemInstance||!this._parentMaterialMenu)}toggleMenu(){return this._menuOpen?this.closeMenu():this.openMenu()}openMenu(){if(this._menuOpen)return;this._checkMenu();const e=this._createOverlay(),n=e.getConfig(),r=n.positionStrategy;this._setPosition(r),n.hasBackdrop=null==this.menu.hasBackdrop?!this.triggersSubmenu():this.menu.hasBackdrop,e.attach(this._getPortal()),this.menu.lazyContent&&this.menu.lazyContent.attach(this.menuData),this._closingActionsSubscription=this._menuClosingActions().subscribe(()=>this.closeMenu()),this._initMenu(),this.menu instanceof CT&&(this.menu._startAnimation(),this.menu._directDescendantItems.changes.pipe($n(this.menu.close)).subscribe(()=>{r.withLockedPosition(!1).reapplyLastPosition(),r.withLockedPosition(!0)}))}closeMenu(){this.menu.close.emit()}focus(e,n){this._focusMonitor&&e?this._focusMonitor.focusVia(this._element,e,n):this._element.nativeElement.focus(n)}updatePosition(){var e;null===(e=this._overlayRef)||void 0===e||e.updatePosition()}_destroyMenu(e){if(!this._overlayRef||!this.menuOpen)return;const n=this.menu;this._closingActionsSubscription.unsubscribe(),this._overlayRef.detach(),this.restoreFocus&&("keydown"===e||!this._openedBy||!this.triggersSubmenu())&&this.focus(this._openedBy),this._openedBy=void 0,n instanceof CT?(n._resetAnimation(),n.lazyContent?n._animationDone.pipe(vr(r=>"void"===r.toState),Qr(1),$n(n.lazyContent._attached)).subscribe({next:()=>n.lazyContent.detach(),complete:()=>this._setIsMenuOpen(!1)}):this._setIsMenuOpen(!1)):(this._setIsMenuOpen(!1),n.lazyContent&&n.lazyContent.detach())}_initMenu(){this.menu.parentMenu=this.triggersSubmenu()?this._parentMaterialMenu:void 0,this.menu.direction=this.dir,this._setMenuElevation(),this.menu.focusFirstItem(this._openedBy||"program"),this._setIsMenuOpen(!0)}_setMenuElevation(){if(this.menu.setElevation){let e=0,n=this.menu.parentMenu;for(;n;)e++,n=n.parentMenu;this.menu.setElevation(e)}}_setIsMenuOpen(e){this._menuOpen=e,this._menuOpen?this.menuOpened.emit():this.menuClosed.emit(),this.triggersSubmenu()&&this._menuItemInstance._setHighlighted(e)}_checkMenu(){}_createOverlay(){if(!this._overlayRef){const e=this._getOverlayConfig();this._subscribeToPositions(e.positionStrategy),this._overlayRef=this._overlay.create(e),this._overlayRef.keydownEvents().subscribe()}return this._overlayRef}_getOverlayConfig(){return new Fb({positionStrategy:this._overlay.position().flexibleConnectedTo(this._element).withLockedPosition().withGrowAfterOpen().withTransformOriginOn(".mat-menu-panel, .mat-mdc-menu-panel"),backdropClass:this.menu.backdropClass||"cdk-overlay-transparent-backdrop",panelClass:this.menu.overlayPanelClass,scrollStrategy:this._scrollStrategy(),direction:this._dir})}_subscribeToPositions(e){this.menu.setPositionClasses&&e.positionChanges.subscribe(n=>{const r="start"===n.connectionPair.overlayX?"after":"before",s="top"===n.connectionPair.overlayY?"below":"above";this._ngZone?this._ngZone.run(()=>this.menu.setPositionClasses(r,s)):this.menu.setPositionClasses(r,s)})}_setPosition(e){let[n,r]="before"===this.menu.xPosition?["end","start"]:["start","end"],[s,a]="above"===this.menu.yPosition?["bottom","top"]:["top","bottom"],[l,u]=[s,a],[h,m]=[n,r],_=0;this.triggersSubmenu()?(m=n="before"===this.menu.xPosition?"start":"end",r=h="end"===n?"start":"end",_="bottom"===s?8:-8):this.menu.overlapTrigger||(l="top"===s?"bottom":"top",u="top"===a?"bottom":"top"),e.withPositions([{originX:n,originY:l,overlayX:h,overlayY:s,offsetY:_},{originX:r,originY:l,overlayX:m,overlayY:s,offsetY:_},{originX:n,originY:u,overlayX:h,overlayY:a,offsetY:-_},{originX:r,originY:u,overlayX:m,overlayY:a,offsetY:-_}])}_menuClosingActions(){const e=this._overlayRef.backdropClick(),n=this._overlayRef.detachments();return uo(e,this._parentMaterialMenu?this._parentMaterialMenu.closed:Qn(),this._parentMaterialMenu?this._parentMaterialMenu._hovered().pipe(vr(a=>a!==this._menuItemInstance),vr(()=>this._menuOpen)):Qn(),n)}_handleMousedown(e){$B(e)||(this._openedBy=0===e.button?"mouse":void 0,this.triggersSubmenu()&&e.preventDefault())}_handleKeydown(e){const n=e.keyCode;(13===n||32===n)&&(this._openedBy="keyboard"),this.triggersSubmenu()&&(39===n&&"ltr"===this.dir||37===n&&"rtl"===this.dir)&&(this._openedBy="keyboard",this.openMenu())}_handleClick(e){this.triggersSubmenu()?(e.stopPropagation(),this.openMenu()):this.toggleMenu()}_handleHover(){!this.triggersSubmenu()||!this._parentMaterialMenu||(this._hoverSubscription=this._parentMaterialMenu._hovered().pipe(vr(e=>e===this._menuItemInstance&&!e.disabled),XH(0,VB)).subscribe(()=>{this._openedBy="mouse",this.menu instanceof CT&&this.menu._isAnimating?this.menu._animationDone.pipe(Qr(1),XH(0,VB),$n(this._parentMaterialMenu._hovered())).subscribe(()=>this.openMenu()):this.openMenu()}))}_getPortal(){return(!this._portal||this._portal.templateRef!==this.menu.templateRef)&&(this._portal=new Ep(this.menu.templateRef,this._viewContainerRef)),this._portal}}return i.\u0275fac=function(e){return new(e||i)(B(Du),B(ai),B(Ko),B(gq),B(ZH,8),B(fS,10),B(Ia,8),B(ch),B(Rn))},i.\u0275dir=Be({type:i,hostAttrs:["aria-haspopup","true"],hostVars:2,hostBindings:function(e,n){1&e&&je("click",function(s){return n._handleClick(s)})("mousedown",function(s){return n._handleMousedown(s)})("keydown",function(s){return n._handleKeydown(s)}),2&e&&Vi("aria-expanded",n.menuOpen||null)("aria-controls",n.menuOpen?n.menu.panelId:null)},inputs:{_deprecatedMatMenuTriggerFor:["mat-menu-trigger-for","_deprecatedMatMenuTriggerFor"],menu:["matMenuTriggerFor","menu"],menuData:["matMenuTriggerData","menuData"],restoreFocus:["matMenuTriggerRestoreFocus","restoreFocus"]},outputs:{menuOpened:"menuOpened",onMenuOpen:"onMenuOpen",menuClosed:"menuClosed",onMenuClose:"onMenuClose"}}),i})(),YH=(()=>{class i extends Xme{}return i.\u0275fac=function(){let t;return function(n){return(t||(t=Ki(i)))(n||i)}}(),i.\u0275dir=Be({type:i,selectors:[["","mat-menu-trigger-for",""],["","matMenuTriggerFor",""]],hostAttrs:[1,"mat-menu-trigger"],exportAs:["matMenuTrigger"],features:[It]}),i})(),vq=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({providers:[qme],imports:[[ka,jn,zf,Nb],uy,jn]}),i})();function Zme(i,t){1&i&&yt(0,"mat-divider")}let Yme=(()=>{class i{constructor(e,n,r,s){this._ping=e,this._collabordinator=n,this._factory=r,this.ref=s}reconnectCineast(){this._factory.reconnect(!0)}reconnectCollabordinator(){this._collabordinator.connect()}ngOnInit(){this._ping.subscribe(e=>{switch(e.status){case"DISCONNECTED":this._icon="flash_off";break;case"ERROR":this._icon="error";break;case"OK":this._icon="check_circle";break;default:this._icon="watch_later"}this.ref.detectChanges()}),this._ping.asObservable().subscribe(e=>{this._latency=e.latency,this.ref.detectChanges()})}}return i.\u0275fac=function(e){return new(e||i)(B(hq),B(fH),B(iP),B(Pn))},i.\u0275cmp=ei({type:i,selectors:[["app-api-status"]],decls:14,vars:6,consts:[["mat-button","",3,"matMenuTriggerFor"],[1,"mat-body-2"],["appMenu","matMenu"],["mat-menu-item","",3,"click"],[4,"ngIf"]],template:function(e,n){1&e&&(Z(0,"button",0),Wo(1),Z(2,"mat-icon"),ue(3),J(),jo(),Wo(4,1),ue(5),jo(),J(),Z(6,"mat-menu",null,2)(8,"button",3),je("click",function(){return n.reconnectCineast()}),ue(9,"Reconnect to Cineast"),J(),Ue(10,Zme,1,0,"mat-divider",4),ti(11,"async"),Z(12,"button",3),je("click",function(){return n.reconnectCollabordinator()}),ue(13,"Reconnect to Collabordinator"),J()()),2&e&&(fe("matMenuTriggerFor",Yo(7)),se(3),Xt(n._icon),se(2),ui(" ",n._latency<1e5?"("+n._latency+"ms)":"(\u221e)"," "),se(5),fe("ngIf",Qi(11,4,n._collabordinator._online)))},directives:[Mo,YH,vo,RP,fS,ms,ig],pipes:[Xc],encapsulation:2,changeDetection:0}),i})();const Kme=["primaryValueBar"],Qme=Vf(class{constructor(i){this._elementRef=i}},"primary"),Jme=new gi("mat-progress-bar-location",{providedIn:"root",factory:function $me(){const i=f_(ar),t=i?i.location:null;return{getPathname:()=>t?t.pathname+t.search:""}}}),ege=new gi("MAT_PROGRESS_BAR_DEFAULT_OPTIONS");let tge=0,kP=(()=>{class i extends Qme{constructor(e,n,r,s,a,l){super(e),this._ngZone=n,this._animationMode=r,this._changeDetectorRef=l,this._isNoopAnimation=!1,this._value=0,this._bufferValue=0,this.animationEnd=new Si,this._animationEndSubscription=Q.EMPTY,this.mode="determinate",this.progressbarId="mat-progress-bar-"+tge++;const u=s?s.getPathname().split("#")[0]:"";this._rectangleFillValue=`url('${u}#${this.progressbarId}')`,this._isNoopAnimation="NoopAnimations"===r,a&&(a.color&&(this.color=this.defaultColor=a.color),this.mode=a.mode||this.mode)}get value(){return this._value}set value(e){var n;this._value=bq(Qo(e)||0),null===(n=this._changeDetectorRef)||void 0===n||n.markForCheck()}get bufferValue(){return this._bufferValue}set bufferValue(e){var n;this._bufferValue=bq(e||0),null===(n=this._changeDetectorRef)||void 0===n||n.markForCheck()}_primaryTransform(){return{transform:`scale3d(${this.value/100}, 1, 1)`}}_bufferTransform(){return"buffer"===this.mode?{transform:`scale3d(${this.bufferValue/100}, 1, 1)`}:null}ngAfterViewInit(){this._ngZone.runOutsideAngular(()=>{const e=this._primaryValueBar.nativeElement;this._animationEndSubscription=os(e,"transitionend").pipe(vr(n=>n.target===e)).subscribe(()=>{("determinate"===this.mode||"buffer"===this.mode)&&this._ngZone.run(()=>this.animationEnd.next({value:this.value}))})})}ngOnDestroy(){this._animationEndSubscription.unsubscribe()}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(Rn),B(ga,8),B(Jme,8),B(ege,8),B(Pn))},i.\u0275cmp=ei({type:i,selectors:[["mat-progress-bar"]],viewQuery:function(e,n){if(1&e&&ji(Kme,5),2&e){let r;jt(r=qt())&&(n._primaryValueBar=r.first)}},hostAttrs:["role","progressbar","aria-valuemin","0","aria-valuemax","100","tabindex","-1",1,"mat-progress-bar"],hostVars:4,hostBindings:function(e,n){2&e&&(Vi("aria-valuenow","indeterminate"===n.mode||"query"===n.mode?null:n.value)("mode",n.mode),N("_mat-animation-noopable",n._isNoopAnimation))},inputs:{color:"color",value:"value",bufferValue:"bufferValue",mode:"mode"},outputs:{animationEnd:"animationEnd"},exportAs:["matProgressBar"],features:[It],decls:10,vars:4,consts:[["aria-hidden","true"],["width","100%","height","4","focusable","false",1,"mat-progress-bar-background","mat-progress-bar-element"],["x","4","y","0","width","8","height","4","patternUnits","userSpaceOnUse",3,"id"],["cx","2","cy","2","r","2"],["width","100%","height","100%"],[1,"mat-progress-bar-buffer","mat-progress-bar-element",3,"ngStyle"],[1,"mat-progress-bar-primary","mat-progress-bar-fill","mat-progress-bar-element",3,"ngStyle"],["primaryValueBar",""],[1,"mat-progress-bar-secondary","mat-progress-bar-fill","mat-progress-bar-element"]],template:function(e,n){1&e&&(Z(0,"div",0),Zu(),Z(1,"svg",1)(2,"defs")(3,"pattern",2),yt(4,"circle",3),J()(),yt(5,"rect",4),J(),xd(),yt(6,"div",5)(7,"div",6,7)(9,"div",8),J()),2&e&&(se(3),fe("id",n.progressbarId),se(2),Vi("fill",n._rectangleFillValue),se(1),fe("ngStyle",n._bufferTransform()),se(1),fe("ngStyle",n._primaryTransform()))},directives:[Rw],styles:['.mat-progress-bar{display:block;height:4px;overflow:hidden;position:relative;transition:opacity 250ms linear;width:100%}._mat-animation-noopable.mat-progress-bar{transition:none;animation:none}.mat-progress-bar .mat-progress-bar-element,.mat-progress-bar .mat-progress-bar-fill::after{height:100%;position:absolute;width:100%}.mat-progress-bar .mat-progress-bar-background{width:calc(100% + 10px)}.cdk-high-contrast-active .mat-progress-bar .mat-progress-bar-background{display:none}.mat-progress-bar .mat-progress-bar-buffer{transform-origin:top left;transition:transform 250ms ease}.cdk-high-contrast-active .mat-progress-bar .mat-progress-bar-buffer{border-top:solid 5px;opacity:.5}.mat-progress-bar .mat-progress-bar-secondary{display:none}.mat-progress-bar .mat-progress-bar-fill{animation:none;transform-origin:top left;transition:transform 250ms ease}.cdk-high-contrast-active .mat-progress-bar .mat-progress-bar-fill{border-top:solid 4px}.mat-progress-bar .mat-progress-bar-fill::after{animation:none;content:"";display:inline-block;left:0}.mat-progress-bar[dir=rtl],[dir=rtl] .mat-progress-bar{transform:rotateY(180deg)}.mat-progress-bar[mode=query]{transform:rotateZ(180deg)}.mat-progress-bar[mode=query][dir=rtl],[dir=rtl] .mat-progress-bar[mode=query]{transform:rotateZ(180deg) rotateY(180deg)}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-fill,.mat-progress-bar[mode=query] .mat-progress-bar-fill{transition:none}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-primary,.mat-progress-bar[mode=query] .mat-progress-bar-primary{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-primary-indeterminate-translate 2000ms infinite linear;left:-145.166611%}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-primary.mat-progress-bar-fill::after,.mat-progress-bar[mode=query] .mat-progress-bar-primary.mat-progress-bar-fill::after{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-primary-indeterminate-scale 2000ms infinite linear}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-secondary,.mat-progress-bar[mode=query] .mat-progress-bar-secondary{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-secondary-indeterminate-translate 2000ms infinite linear;left:-54.888891%;display:block}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-secondary.mat-progress-bar-fill::after,.mat-progress-bar[mode=query] .mat-progress-bar-secondary.mat-progress-bar-fill::after{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-secondary-indeterminate-scale 2000ms infinite linear}.mat-progress-bar[mode=buffer] .mat-progress-bar-background{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-background-scroll 250ms infinite linear;display:block}.mat-progress-bar._mat-animation-noopable .mat-progress-bar-fill,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-fill::after,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-buffer,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-primary,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-primary.mat-progress-bar-fill::after,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-secondary,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-secondary.mat-progress-bar-fill::after,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-background{animation:none;transition-duration:1ms}@keyframes mat-progress-bar-primary-indeterminate-translate{0%{transform:translateX(0)}20%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(0)}59.15%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(83.67142%)}100%{transform:translateX(200.611057%)}}@keyframes mat-progress-bar-primary-indeterminate-scale{0%{transform:scaleX(0.08)}36.65%{animation-timing-function:cubic-bezier(0.334731, 0.12482, 0.785844, 1);transform:scaleX(0.08)}69.15%{animation-timing-function:cubic-bezier(0.06, 0.11, 0.6, 1);transform:scaleX(0.661479)}100%{transform:scaleX(0.08)}}@keyframes mat-progress-bar-secondary-indeterminate-translate{0%{animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);transform:translateX(0)}25%{animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);transform:translateX(37.651913%)}48.35%{animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);transform:translateX(84.386165%)}100%{transform:translateX(160.277782%)}}@keyframes mat-progress-bar-secondary-indeterminate-scale{0%{animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);transform:scaleX(0.08)}19.15%{animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);transform:scaleX(0.457104)}44.15%{animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);transform:scaleX(0.72796)}100%{transform:scaleX(0.08)}}@keyframes mat-progress-bar-background-scroll{to{transform:translateX(-8px)}}\n'],encapsulation:2,changeDetection:0}),i})();function bq(i,t=0,e=100){return Math.max(t,Math.min(e,i))}let KH=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[ka,jn],jn]}),i})();const PP=["*"],ige=["content"];function nge(i,t){if(1&i){const e=Wi();Z(0,"div",2),je("click",function(){return gt(e),Re()._onBackdropClicked()}),J()}2&i&&N("mat-drawer-shown",Re()._isShowingBackdrop())}function rge(i,t){1&i&&(Z(0,"mat-drawer-content"),hr(1,2),J())}const sge=[[["mat-drawer"]],[["mat-drawer-content"]],"*"],oge=["mat-drawer","mat-drawer-content","*"];function age(i,t){if(1&i){const e=Wi();Z(0,"div",2),je("click",function(){return gt(e),Re()._onBackdropClicked()}),J()}2&i&&N("mat-drawer-shown",Re()._isShowingBackdrop())}function lge(i,t){1&i&&(Z(0,"mat-sidenav-content"),hr(1,2),J())}const cge=[[["mat-sidenav"]],[["mat-sidenav-content"]],"*"],uge=["mat-sidenav","mat-sidenav-content","*"],xq={transformDrawer:Xd("transform",[Cl("open, open-instant",Xs({transform:"none",visibility:"visible"})),Cl("void",Xs({"box-shadow":"none",visibility:"hidden"})),Ml("void => open-instant",ql("0ms")),Ml("void <=> open, open-instant => void",ql("400ms cubic-bezier(0.25, 0.8, 0.25, 1)"))])},dge=new gi("MAT_DRAWER_DEFAULT_AUTOSIZE",{providedIn:"root",factory:function fge(){return!1}}),QH=new gi("MAT_DRAWER_CONTAINER");let IP=(()=>{class i extends I1{constructor(e,n,r,s,a){super(r,s,a),this._changeDetectorRef=e,this._container=n}ngAfterContentInit(){this._container._contentMarginChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})}}return i.\u0275fac=function(e){return new(e||i)(B(Pn),B(rs(()=>Sq)),B(ai),B(P1),B(Rn))},i.\u0275cmp=ei({type:i,selectors:[["mat-drawer-content"]],hostAttrs:[1,"mat-drawer-content"],hostVars:4,hostBindings:function(e,n){2&e&&A("margin-left",n._container._contentMargins.left,"px")("margin-right",n._container._contentMargins.right,"px")},features:[Sn([{provide:I1,useExisting:i}]),It],ngContentSelectors:PP,decls:1,vars:0,template:function(e,n){1&e&&(As(),hr(0))},encapsulation:2,changeDetection:0}),i})(),wq=(()=>{class i{constructor(e,n,r,s,a,l,u,h){this._elementRef=e,this._focusTrapFactory=n,this._focusMonitor=r,this._platform=s,this._ngZone=a,this._interactivityChecker=l,this._doc=u,this._container=h,this._elementFocusedBeforeDrawerWasOpened=null,this._enableAnimations=!1,this._position="start",this._mode="over",this._disableClose=!1,this._opened=!1,this._animationStarted=new ii,this._animationEnd=new ii,this._animationState="void",this.openedChange=new Si(!0),this._openedStream=this.openedChange.pipe(vr(m=>m),Ui(()=>{})),this.openedStart=this._animationStarted.pipe(vr(m=>m.fromState!==m.toState&&0===m.toState.indexOf("open")),qH(void 0)),this._closedStream=this.openedChange.pipe(vr(m=>!m),Ui(()=>{})),this.closedStart=this._animationStarted.pipe(vr(m=>m.fromState!==m.toState&&"void"===m.toState),qH(void 0)),this._destroyed=new ii,this.onPositionChanged=new Si,this._modeChanged=new ii,this.openedChange.subscribe(m=>{m?(this._doc&&(this._elementFocusedBeforeDrawerWasOpened=this._doc.activeElement),this._takeFocus()):this._isFocusWithinDrawer()&&this._restoreFocus(this._openedVia||"program")}),this._ngZone.runOutsideAngular(()=>{os(this._elementRef.nativeElement,"keydown").pipe(vr(m=>27===m.keyCode&&!this.disableClose&&!dc(m)),$n(this._destroyed)).subscribe(m=>this._ngZone.run(()=>{this.close(),m.stopPropagation(),m.preventDefault()}))}),this._animationEnd.pipe(xk((m,_)=>m.fromState===_.fromState&&m.toState===_.toState)).subscribe(m=>{const{fromState:_,toState:v}=m;(0===v.indexOf("open")&&"void"===_||"void"===v&&0===_.indexOf("open"))&&this.openedChange.emit(this._opened)})}get position(){return this._position}set position(e){(e="end"===e?"end":"start")!==this._position&&(this._isAttached&&this._updatePositionInParent(e),this._position=e,this.onPositionChanged.emit())}get mode(){return this._mode}set mode(e){this._mode=e,this._updateFocusTrapState(),this._modeChanged.next()}get disableClose(){return this._disableClose}set disableClose(e){this._disableClose=tn(e)}get autoFocus(){const e=this._autoFocus;return null==e?"side"===this.mode?"dialog":"first-tabbable":e}set autoFocus(e){("true"===e||"false"===e||null==e)&&(e=tn(e)),this._autoFocus=e}get opened(){return this._opened}set opened(e){this.toggle(tn(e))}_forceFocus(e,n){this._interactivityChecker.isFocusable(e)||(e.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const r=()=>{e.removeEventListener("blur",r),e.removeEventListener("mousedown",r),e.removeAttribute("tabindex")};e.addEventListener("blur",r),e.addEventListener("mousedown",r)})),e.focus(n)}_focusByCssSelector(e,n){let r=this._elementRef.nativeElement.querySelector(e);r&&this._forceFocus(r,n)}_takeFocus(){if(!this._focusTrap)return;const e=this._elementRef.nativeElement;switch(this.autoFocus){case!1:case"dialog":return;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(n=>{!n&&"function"==typeof this._elementRef.nativeElement.focus&&e.focus()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this.autoFocus)}}_restoreFocus(e){"dialog"!==this.autoFocus&&(this._elementFocusedBeforeDrawerWasOpened?this._focusMonitor.focusVia(this._elementFocusedBeforeDrawerWasOpened,e):this._elementRef.nativeElement.blur(),this._elementFocusedBeforeDrawerWasOpened=null)}_isFocusWithinDrawer(){const e=this._doc.activeElement;return!!e&&this._elementRef.nativeElement.contains(e)}ngAfterViewInit(){this._isAttached=!0,this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._updateFocusTrapState(),"end"===this._position&&this._updatePositionInParent("end")}ngAfterContentChecked(){this._platform.isBrowser&&(this._enableAnimations=!0)}ngOnDestroy(){var e;this._focusTrap&&this._focusTrap.destroy(),null===(e=this._anchor)||void 0===e||e.remove(),this._anchor=null,this._animationStarted.complete(),this._animationEnd.complete(),this._modeChanged.complete(),this._destroyed.next(),this._destroyed.complete()}open(e){return this.toggle(!0,e)}close(){return this.toggle(!1)}_closeViaBackdropClick(){return this._setOpen(!1,!0,"mouse")}toggle(e=!this.opened,n){e&&n&&(this._openedVia=n);const r=this._setOpen(e,!e&&this._isFocusWithinDrawer(),this._openedVia||"program");return e||(this._openedVia=null),r}_setOpen(e,n,r){return this._opened=e,e?this._animationState=this._enableAnimations?"open":"open-instant":(this._animationState="void",n&&this._restoreFocus(r)),this._updateFocusTrapState(),new Promise(s=>{this.openedChange.pipe(Qr(1)).subscribe(a=>s(a?"open":"close"))})}_getWidth(){return this._elementRef.nativeElement&&this._elementRef.nativeElement.offsetWidth||0}_updateFocusTrapState(){this._focusTrap&&(this._focusTrap.enabled=this.opened&&"side"!==this.mode)}_updatePositionInParent(e){const n=this._elementRef.nativeElement,r=n.parentNode;"end"===e?(this._anchor||(this._anchor=this._doc.createComment("mat-drawer-anchor"),r.insertBefore(this._anchor,n)),r.appendChild(n)):this._anchor&&this._anchor.parentNode.insertBefore(n,this._anchor)}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(JB),B(ch),B(ta),B(Rn),B(Tk),B(ar,8),B(QH,8))},i.\u0275cmp=ei({type:i,selectors:[["mat-drawer"]],viewQuery:function(e,n){if(1&e&&ji(ige,5),2&e){let r;jt(r=qt())&&(n._content=r.first)}},hostAttrs:["tabIndex","-1",1,"mat-drawer"],hostVars:12,hostBindings:function(e,n){1&e&&Q_("@transform.start",function(s){return n._animationStarted.next(s)})("@transform.done",function(s){return n._animationEnd.next(s)}),2&e&&(Vi("align",null),Cr("@transform",n._animationState),N("mat-drawer-end","end"===n.position)("mat-drawer-over","over"===n.mode)("mat-drawer-push","push"===n.mode)("mat-drawer-side","side"===n.mode)("mat-drawer-opened",n.opened))},inputs:{position:"position",mode:"mode",disableClose:"disableClose",autoFocus:"autoFocus",opened:"opened"},outputs:{openedChange:"openedChange",_openedStream:"opened",openedStart:"openedStart",_closedStream:"closed",closedStart:"closedStart",onPositionChanged:"positionChanged"},exportAs:["matDrawer"],ngContentSelectors:PP,decls:3,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"],["content",""]],template:function(e,n){1&e&&(As(),Z(0,"div",0,1),hr(2),J())},directives:[I1],encapsulation:2,data:{animation:[xq.transformDrawer]},changeDetection:0}),i})(),Sq=(()=>{class i{constructor(e,n,r,s,a,l=!1,u){this._dir=e,this._element=n,this._ngZone=r,this._changeDetectorRef=s,this._animationMode=u,this._drawers=new ey,this.backdropClick=new Si,this._destroyed=new ii,this._doCheckSubject=new ii,this._contentMargins={left:null,right:null},this._contentMarginChanges=new ii,e&&e.change.pipe($n(this._destroyed)).subscribe(()=>{this._validateDrawers(),this.updateContentMargins()}),a.change().pipe($n(this._destroyed)).subscribe(()=>this.updateContentMargins()),this._autosize=l}get start(){return this._start}get end(){return this._end}get autosize(){return this._autosize}set autosize(e){this._autosize=tn(e)}get hasBackdrop(){return null==this._backdropOverride?!this._start||"side"!==this._start.mode||!this._end||"side"!==this._end.mode:this._backdropOverride}set hasBackdrop(e){this._backdropOverride=null==e?null:tn(e)}get scrollable(){return this._userContent||this._content}ngAfterContentInit(){this._allDrawers.changes.pipe(Tl(this._allDrawers),$n(this._destroyed)).subscribe(e=>{this._drawers.reset(e.filter(n=>!n._container||n._container===this)),this._drawers.notifyOnChanges()}),this._drawers.changes.pipe(Tl(null)).subscribe(()=>{this._validateDrawers(),this._drawers.forEach(e=>{this._watchDrawerToggle(e),this._watchDrawerPosition(e),this._watchDrawerMode(e)}),(!this._drawers.length||this._isDrawerOpen(this._start)||this._isDrawerOpen(this._end))&&this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),this._ngZone.runOutsideAngular(()=>{this._doCheckSubject.pipe(jm(10),$n(this._destroyed)).subscribe(()=>this.updateContentMargins())})}ngOnDestroy(){this._contentMarginChanges.complete(),this._doCheckSubject.complete(),this._drawers.destroy(),this._destroyed.next(),this._destroyed.complete()}open(){this._drawers.forEach(e=>e.open())}close(){this._drawers.forEach(e=>e.close())}updateContentMargins(){let e=0,n=0;if(this._left&&this._left.opened)if("side"==this._left.mode)e+=this._left._getWidth();else if("push"==this._left.mode){const r=this._left._getWidth();e+=r,n-=r}if(this._right&&this._right.opened)if("side"==this._right.mode)n+=this._right._getWidth();else if("push"==this._right.mode){const r=this._right._getWidth();n+=r,e-=r}e=e||null,n=n||null,(e!==this._contentMargins.left||n!==this._contentMargins.right)&&(this._contentMargins={left:e,right:n},this._ngZone.run(()=>this._contentMarginChanges.next(this._contentMargins)))}ngDoCheck(){this._autosize&&this._isPushed()&&this._ngZone.runOutsideAngular(()=>this._doCheckSubject.next())}_watchDrawerToggle(e){e._animationStarted.pipe(vr(n=>n.fromState!==n.toState),$n(this._drawers.changes)).subscribe(n=>{"open-instant"!==n.toState&&"NoopAnimations"!==this._animationMode&&this._element.nativeElement.classList.add("mat-drawer-transition"),this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),"side"!==e.mode&&e.openedChange.pipe($n(this._drawers.changes)).subscribe(()=>this._setContainerClass(e.opened))}_watchDrawerPosition(e){!e||e.onPositionChanged.pipe($n(this._drawers.changes)).subscribe(()=>{this._ngZone.onMicrotaskEmpty.pipe(Qr(1)).subscribe(()=>{this._validateDrawers()})})}_watchDrawerMode(e){e&&e._modeChanged.pipe($n(uo(this._drawers.changes,this._destroyed))).subscribe(()=>{this.updateContentMargins(),this._changeDetectorRef.markForCheck()})}_setContainerClass(e){const n=this._element.nativeElement.classList,r="mat-drawer-container-has-open";e?n.add(r):n.remove(r)}_validateDrawers(){this._start=this._end=null,this._drawers.forEach(e=>{"end"==e.position?this._end=e:this._start=e}),this._right=this._left=null,this._dir&&"rtl"===this._dir.value?(this._left=this._end,this._right=this._start):(this._left=this._start,this._right=this._end)}_isPushed(){return this._isDrawerOpen(this._start)&&"over"!=this._start.mode||this._isDrawerOpen(this._end)&&"over"!=this._end.mode}_onBackdropClicked(){this.backdropClick.emit(),this._closeModalDrawersViaBackdrop()}_closeModalDrawersViaBackdrop(){[this._start,this._end].filter(e=>e&&!e.disableClose&&this._canHaveBackdrop(e)).forEach(e=>e._closeViaBackdropClick())}_isShowingBackdrop(){return this._isDrawerOpen(this._start)&&this._canHaveBackdrop(this._start)||this._isDrawerOpen(this._end)&&this._canHaveBackdrop(this._end)}_canHaveBackdrop(e){return"side"!==e.mode||!!this._backdropOverride}_isDrawerOpen(e){return null!=e&&e.opened}}return i.\u0275fac=function(e){return new(e||i)(B(Ia,8),B(ai),B(Rn),B(Pn),B(Tp),B(dge),B(ga,8))},i.\u0275cmp=ei({type:i,selectors:[["mat-drawer-container"]],contentQueries:function(e,n,r){if(1&e&&(Er(r,IP,5),Er(r,wq,5)),2&e){let s;jt(s=qt())&&(n._content=s.first),jt(s=qt())&&(n._allDrawers=s)}},viewQuery:function(e,n){if(1&e&&ji(IP,5),2&e){let r;jt(r=qt())&&(n._userContent=r.first)}},hostAttrs:[1,"mat-drawer-container"],hostVars:2,hostBindings:function(e,n){2&e&&N("mat-drawer-container-explicit-backdrop",n._backdropOverride)},inputs:{autosize:"autosize",hasBackdrop:"hasBackdrop"},outputs:{backdropClick:"backdropClick"},exportAs:["matDrawerContainer"],features:[Sn([{provide:QH,useExisting:i}])],ngContentSelectors:oge,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(e,n){1&e&&(As(sge),Ue(0,nge,1,2,"div",0),hr(1),hr(2,1),Ue(3,rge,2,0,"mat-drawer-content",1)),2&e&&(fe("ngIf",n.hasBackdrop),se(3),fe("ngIf",!n._content))},directives:[IP,ms],styles:['.mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer[style*="visibility: hidden"]{display:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}\n'],encapsulation:2,changeDetection:0}),i})(),JH=(()=>{class i extends IP{constructor(e,n,r,s,a){super(e,n,r,s,a)}}return i.\u0275fac=function(e){return new(e||i)(B(Pn),B(rs(()=>Mq)),B(ai),B(P1),B(Rn))},i.\u0275cmp=ei({type:i,selectors:[["mat-sidenav-content"]],hostAttrs:[1,"mat-drawer-content","mat-sidenav-content"],hostVars:4,hostBindings:function(e,n){2&e&&A("margin-left",n._container._contentMargins.left,"px")("margin-right",n._container._contentMargins.right,"px")},features:[Sn([{provide:I1,useExisting:i}]),It],ngContentSelectors:PP,decls:1,vars:0,template:function(e,n){1&e&&(As(),hr(0))},encapsulation:2,changeDetection:0}),i})(),Cq=(()=>{class i extends wq{constructor(){super(...arguments),this._fixedInViewport=!1,this._fixedTopGap=0,this._fixedBottomGap=0}get fixedInViewport(){return this._fixedInViewport}set fixedInViewport(e){this._fixedInViewport=tn(e)}get fixedTopGap(){return this._fixedTopGap}set fixedTopGap(e){this._fixedTopGap=Qo(e)}get fixedBottomGap(){return this._fixedBottomGap}set fixedBottomGap(e){this._fixedBottomGap=Qo(e)}}return i.\u0275fac=function(){let t;return function(n){return(t||(t=Ki(i)))(n||i)}}(),i.\u0275cmp=ei({type:i,selectors:[["mat-sidenav"]],hostAttrs:["tabIndex","-1",1,"mat-drawer","mat-sidenav"],hostVars:17,hostBindings:function(e,n){2&e&&(Vi("align",null),A("top",n.fixedInViewport?n.fixedTopGap:null,"px")("bottom",n.fixedInViewport?n.fixedBottomGap:null,"px"),N("mat-drawer-end","end"===n.position)("mat-drawer-over","over"===n.mode)("mat-drawer-push","push"===n.mode)("mat-drawer-side","side"===n.mode)("mat-drawer-opened",n.opened)("mat-sidenav-fixed",n.fixedInViewport))},inputs:{fixedInViewport:"fixedInViewport",fixedTopGap:"fixedTopGap",fixedBottomGap:"fixedBottomGap"},exportAs:["matSidenav"],features:[It],ngContentSelectors:PP,decls:3,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"],["content",""]],template:function(e,n){1&e&&(As(),Z(0,"div",0,1),hr(2),J())},directives:[I1],encapsulation:2,data:{animation:[xq.transformDrawer]},changeDetection:0}),i})(),Mq=(()=>{class i extends Sq{}return i.\u0275fac=function(){let t;return function(n){return(t||(t=Ki(i)))(n||i)}}(),i.\u0275cmp=ei({type:i,selectors:[["mat-sidenav-container"]],contentQueries:function(e,n,r){if(1&e&&(Er(r,JH,5),Er(r,Cq,5)),2&e){let s;jt(s=qt())&&(n._content=s.first),jt(s=qt())&&(n._allDrawers=s)}},hostAttrs:[1,"mat-drawer-container","mat-sidenav-container"],hostVars:2,hostBindings:function(e,n){2&e&&N("mat-drawer-container-explicit-backdrop",n._backdropOverride)},exportAs:["matSidenavContainer"],features:[Sn([{provide:QH,useExisting:i}]),It],ngContentSelectors:uge,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(e,n){1&e&&(As(cge),Ue(0,age,1,2,"div",0),hr(1),hr(2,1),Ue(3,lge,2,0,"mat-sidenav-content",1)),2&e&&(fe("ngIf",n.hasBackdrop),se(3),fe("ngIf",!n._content))},directives:[JH,ms],styles:['.mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer[style*="visibility: hidden"]{display:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}\n'],encapsulation:2,changeDetection:0}),i})(),Tq=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[ka,jn,uy],uy,jn]}),i})();class ag{constructor(t,e=[]){this.type=t,this.categories=e}pushCategory(t){-1===this.categories.indexOf(t)&&this.categories.push(t)}hasCategory(t){return this.categories.indexOf(t)>-1}removeCategory(t){const e=this.categories.indexOf(t);e>-1&&this.categories.splice(e,1)}setCategories(t){this.categories.splice(0,this.categories.length);for(const e of t)this.categories.push(e)}}class pge extends ag{constructor(){super(El.TypeEnum.Image,[])}}class mge extends ag{constructor(){super(El.TypeEnum.Audio,["audiofingerprint"])}}class gge extends ag{constructor(){super(El.TypeEnum.Model3D,["sphericalharmonicsdefault"])}}class Gf{static strToBase64(t){return Gf.base64EncArr(Gf.strToUTF8Arr(t))}static Base64ToStr(t){return Gf.UTF8ArrToStr(Gf.base64DecToArr(t))}static b64ToUint6(t){return t>64&&t<91?t-65:t>96&&t<123?t-71:t>47&&t<58?t+4:43===t?62:47===t?63:0}static base64DecToArr(t,e){const n=t.replace(/[^A-Za-z0-9\+\/]/g,""),r=n.length,s=e?Math.ceil((3*r+1>>>2)/e)*e:3*r+1>>>2,a=new Uint8Array(s);for(let l,u,h=0,m=0,_=0;_<r;_++)if(u=3&_,h|=Gf.b64ToUint6(n.charCodeAt(_))<<18-6*u,3===u||r-_==1){for(l=0;l<3&&m<s;l++,m++)a[m]=h>>>(16>>>l&24)&255;h=0}return a}static uint6ToB64(t){return t<26?t+65:t<52?t+71:t<62?t-4:62===t?43:63===t?47:65}static base64EncArr(t){let e=(3-t.length%3)%3,n="";for(let r,s=t.length,a=0,l=0;l<s;l++)r=l%3,a|=t[l]<<(16>>>r&24),(2===r||t.length-l==1)&&(n+=String.fromCharCode(Gf.uint6ToB64(a>>>18&63),Gf.uint6ToB64(a>>>12&63),Gf.uint6ToB64(a>>>6&63),Gf.uint6ToB64(63&a)),a=0);return 0===e?n:n.substring(0,n.length-e)+(1===e?"=":"==")}static UTF8ArrToStr(t){let e="";for(let n,r=t.length,s=0;s<r;s++)n=t[s],e+=String.fromCharCode(n>251&&n<254&&s+5<r?1073741824*(n-252)+(t[++s]-128<<24)+(t[++s]-128<<18)+(t[++s]-128<<12)+(t[++s]-128<<6)+t[++s]-128:n>247&&n<252&&s+4<r?(n-248<<24)+(t[++s]-128<<18)+(t[++s]-128<<12)+(t[++s]-128<<6)+t[++s]-128:n>239&&n<248&&s+3<r?(n-240<<18)+(t[++s]-128<<12)+(t[++s]-128<<6)+t[++s]-128:n>223&&n<240&&s+2<r?(n-224<<12)+(t[++s]-128<<6)+t[++s]-128:n>191&&n<224&&s+1<r?(n-192<<6)+t[++s]-128:n);return e}static strToUTF8Arr(t){let e,n,r=t.length,s=0;for(let a=0;a<r;a++)n=t.charCodeAt(a),s+=n<128?1:n<2048?2:n<65536?3:n<2097152?4:n<67108864?5:6;e=new Uint8Array(s);for(let a=0,l=0;a<s;l++)n=t.charCodeAt(l),n<128?e[a++]=n:n<2048?(e[a++]=192+(n>>>6),e[a++]=128+(63&n)):n<65536?(e[a++]=224+(n>>>12),e[a++]=128+(n>>>6&63),e[a++]=128+(63&n)):n<2097152?(e[a++]=240+(n>>>18),e[a++]=128+(n>>>12&63),e[a++]=128+(n>>>6&63),e[a++]=128+(63&n)):n<67108864?(e[a++]=248+(n>>>24),e[a++]=128+(n>>>18&63),e[a++]=128+(n>>>12&63),e[a++]=128+(n>>>6&63),e[a++]=128+(63&n)):(e[a++]=252+(n>>>30),e[a++]=128+(n>>>24&63),e[a++]=128+(n>>>18&63),e[a++]=128+(n>>>12&63),e[a++]=128+(n>>>6&63),e[a++]=128+(63&n));return e}}class _ge extends ag{constructor(){super(El.TypeEnum.Boolean,["boolean"]),this.terms=[]}removeTerm(t){this.terms.splice(this.terms.indexOf(t),1),this.update()}update(){this.data="data:application/json;base64,"+Gf.strToBase64(JSON.stringify(this.terms))}}class yge extends ag{constructor(){super(El.TypeEnum.Text,[])}}class vge extends ag{constructor(){super(El.TypeEnum.Tag,["tags"])}}class bge extends ag{constructor(){super(El.TypeEnum.Skeleton,["skeletonpose"])}}class xge extends ag{constructor(){super(El.TypeEnum.Semantic,["semantic"]),this._map=[]}get image(){return this._image}set image(t){this._image=t,this.refresh()}get map(){return this._map}set map(t){this._map=t,this.refresh()}refresh(){this._image&&this._map&&(this.data="data:application/json;base64,"+btoa(JSON.stringify({image:this.image,map:this.map.map(t=>{const e={};return e[t.name]=t.color,e})})))}}class $H{constructor(t=[]){this.terms=t}}class wge extends ag{constructor(){super(El.TypeEnum.Location,["spatialdistance"]),this.location={latitude:51.50906,longitude:-.15095}}write(){this.setLocation(this.location)}read(){this.location=this.getLocation()}setLocation(t){this.data=`[${t.latitude},${t.longitude}]`}getLocation(){try{if(0===this.data.length)return null;const t=JSON.parse(this.data);return t?{latitude:t[0],longitude:t[1]}:null}catch(t){return null}}}let Sge=(()=>{class i{constructor(){this.stages=[],this._cache=new Map,this.stages.push(new $H)}addTerm(e){if(this._cache.has(e))return!1;switch(e){case El.TypeEnum.Image:this._cache.set(e,new pge);break;case El.TypeEnum.Audio:this._cache.set(e,new mge);break;case El.TypeEnum.Model3D:this._cache.set(e,new gge);break;case El.TypeEnum.Text:this._cache.set(e,new yge);break;case El.TypeEnum.Tag:this._cache.set(e,new vge);break;case El.TypeEnum.Semantic:this._cache.set(e,new xge);break;case El.TypeEnum.Boolean:this._cache.set(e,new _ge);break;case El.TypeEnum.Location:this._cache.set(e,new wge);break;case El.TypeEnum.Skeleton:this._cache.set(e,new bge);break;default:return!1}return 0===this.stages.length&&this.stages.push(new $H),this.stages[this.stages.length-1].terms.push(this._cache.get(e)),!0}removeTerm(e){if(this._cache.has(e))return this.stages.forEach(n=>{n.terms.indexOf(this._cache.get(e))>-1&&(n.terms.splice(n.terms.indexOf(this._cache.get(e)),1),0===n.terms.length&&this.stages.splice(this.stages.indexOf(n),1))}),this._cache.delete(e)}hasTerm(e){return this._cache.has(e)}getTerm(e){return this._cache.get(e)}}return i.i=0,i})();function Eq(i){for(let t in i){let e=i[t]||"";switch(t){case"display":i.display="flex"===e?["-webkit-flex","flex"]:"inline-flex"===e?["-webkit-inline-flex","inline-flex"]:e;break;case"align-items":case"align-self":case"align-content":case"flex":case"flex-basis":case"flex-flow":case"flex-grow":case"flex-shrink":case"flex-wrap":case"justify-content":i["-webkit-"+t]=e;break;case"flex-direction":e=e||"row",i["-webkit-flex-direction"]=e,i["flex-direction"]=e;break;case"order":i.order=i["-webkit-"+t]=isNaN(+e)?"0":e}}return i}const eV="inline",LP=["row","column","row-reverse","column-reverse"];function Aq(i){let[t,e,n]=Dq(i);return function Mge(i,t=null,e=!1){return{display:e?"inline-flex":"flex","box-sizing":"border-box","flex-direction":i,"flex-wrap":t||null}}(t,e,n)}function Dq(i){var t;i=null!==(t=null==i?void 0:i.toLowerCase())&&void 0!==t?t:"";let[e,n,r]=i.split(" ");return LP.find(s=>s===e)||(e=LP[0]),n===eV&&(n=r!==eV?r:"",r=eV),[e,Cge(n),!!r]}function MT(i){let[t]=Dq(i);return t.indexOf("row")>-1}function Cge(i){if(i)switch(i.toLowerCase()){case"reverse":case"wrap-reverse":case"reverse-wrap":i="wrap-reverse";break;case"no":case"none":case"nowrap":i="nowrap";break;default:i="wrap"}return i}function lg(i,...t){if(null==i)throw TypeError("Cannot convert undefined or null to object");for(let e of t)if(null!=e)for(let n in e)e.hasOwnProperty(n)&&(i[n]=e[n]);return i}const Ege={provide:a3,useFactory:function Tge(i,t){return()=>{if(wb(t)){const e=Array.from(i.querySelectorAll(`[class*=${Rq}]`)),n=/\bflex-layout-.+?\b/g;e.forEach(r=>{r.classList.contains(`${Rq}ssr`)&&r.parentNode?r.parentNode.removeChild(r):r.className.replace(n,"")})}}},deps:[ar,kh],multi:!0},Rq="flex-layout-";let tV=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({providers:[Ege]}),i})();class s0{constructor(t=!1,e="all",n="",r="",s=0){this.matches=t,this.mediaQuery=e,this.mqAlias=n,this.suffix=r,this.priority=s,this.property=""}clone(){return new s0(this.matches,this.mediaQuery,this.mqAlias,this.suffix)}}let Age=(()=>{class i{constructor(){this.stylesheet=new Map}addStyleToElement(e,n,r){const s=this.stylesheet.get(e);s?s.set(n,r):this.stylesheet.set(e,new Map([[n,r]]))}clearStyles(){this.stylesheet.clear()}getStyleForElement(e,n){const r=this.stylesheet.get(e);let s="";if(r){const a=r.get(n);("number"==typeof a||"string"==typeof a)&&(s=a+"")}return s}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const iV={addFlexToParent:!0,addOrientationBps:!1,disableDefaultBps:!1,disableVendorPrefixes:!1,serverLoaded:!1,useColumnBasisZero:!0,printWithBreakpoints:[],mediaTriggerAutoRestore:!0,ssrObserveBreakpoints:[],multiplier:void 0,defaultUnit:"px",detectLayoutDisplay:!1},Wf=new gi("Flex Layout token, config options for the library",{providedIn:"root",factory:()=>iV}),pS=new gi("FlexLayoutServerLoaded",{providedIn:"root",factory:()=>!1}),nV=new gi("Flex Layout token, collect all breakpoints into one provider",{providedIn:"root",factory:()=>null});function kq(i,t){return i=i?i.clone():new s0,t&&(i.mqAlias=t.alias,i.mediaQuery=t.mediaQuery,i.suffix=t.suffix,i.priority=t.priority),i}class ll{constructor(){this.shouldCache=!0}sideEffect(t,e,n){}}let va=(()=>{class i{constructor(e,n,r,s){this._serverStylesheet=e,this._serverModuleLoaded=n,this._platformId=r,this.layoutConfig=s}applyStyleToElement(e,n,r=null){let s={};"string"==typeof n&&(s[n]=r,n=s),s=this.layoutConfig.disableVendorPrefixes?n:Eq(n),this._applyMultiValueStyleToElement(s,e)}applyStyleToElements(e,n=[]){const r=this.layoutConfig.disableVendorPrefixes?e:Eq(e);n.forEach(s=>{this._applyMultiValueStyleToElement(r,s)})}getFlowDirection(e){const n="flex-direction";let r=this.lookupStyle(e,n);return[r||"row",this.lookupInlineStyle(e,n)||kw(this._platformId)&&this._serverModuleLoaded?r:""]}hasWrap(e){return"wrap"===this.lookupStyle(e,"flex-wrap")}lookupAttributeValue(e,n){var r;return null!==(r=e.getAttribute(n))&&void 0!==r?r:""}lookupInlineStyle(e,n){return wb(this._platformId)?e.style.getPropertyValue(n):function Dge(i,t){var e;return null!==(e=Pq(i)[t])&&void 0!==e?e:""}(e,n)}lookupStyle(e,n,r=!1){let s="";return e&&((s=this.lookupInlineStyle(e,n))||(wb(this._platformId)?r||(s=getComputedStyle(e).getPropertyValue(n)):this._serverModuleLoaded&&(s=this._serverStylesheet.getStyleForElement(e,n)))),s?s.trim():""}_applyMultiValueStyleToElement(e,n){Object.keys(e).sort().forEach(r=>{const s=e[r],a=Array.isArray(s)?s:[s];a.sort();for(let l of a)l=l?l+"":"",wb(this._platformId)||!this._serverModuleLoaded?wb(this._platformId)?n.style.setProperty(r,l):Rge(n,r,l):this._serverStylesheet.addStyleToElement(n,r,l)})}}return i.\u0275fac=function(e){return new(e||i)(Ve(Age),Ve(pS),Ve(kh),Ve(Wf))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function Rge(i,t,e){t=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();const n=Pq(i);n[t]=null!=e?e:"",function kge(i,t){let e="";for(const n in t)t[n]&&(e+=`${n}:${t[n]};`);i.setAttribute("style",e)}(i,n)}function Pq(i){const t={},e=i.getAttribute("style");if(e){const n=e.split(/;+/g);for(let r=0;r<n.length;r++){const s=n[r].trim();if(s.length>0){const a=s.indexOf(":");if(-1===a)throw new Error(`Invalid CSS style: ${s}`);t[s.substr(0,a).trim()]=s.substr(a+1).trim()}}}return t}function TT(i,t){return(t&&t.priority||0)-(i&&i.priority||0)}function Pge(i,t){return(i.priority||0)-(t.priority||0)}let rV=(()=>{class i{constructor(e,n,r){this._zone=e,this._platformId=n,this._document=r,this.source=new gs(new s0(!0)),this.registry=new Map,this.pendingRemoveListenerFns=[],this._observable$=this.source.asObservable()}get activations(){const e=[];return this.registry.forEach((n,r)=>{n.matches&&e.push(r)}),e}isActive(e){var n;const r=this.registry.get(e);return null!==(n=null==r?void 0:r.matches)&&void 0!==n?n:this.registerQuery(e).some(s=>s.matches)}observe(e,n=!1){if(e&&e.length){const r=this._observable$.pipe(vr(a=>!n||e.indexOf(a.mediaQuery)>-1));return uo(new ft(a=>{const l=this.registerQuery(e);if(l.length){const u=l.pop();l.forEach(h=>{a.next(h)}),this.source.next(u)}a.complete()}),r)}return this._observable$}registerQuery(e){const n=Array.isArray(e)?e:[e],r=[];return function Ige(i,t){const e=i.filter(n=>!Iq[n]);if(e.length>0){const n=e.join(", ");try{const r=t.createElement("style");r.setAttribute("type","text/css"),r.styleSheet||r.appendChild(t.createTextNode(`\n/*\n  @angular/flex-layout - workaround for possible browser quirk with mediaQuery listeners\n  see http://bit.ly/2sd4HMP\n*/\n@media ${n} {.fx-query-test{ }}\n`)),t.head.appendChild(r),e.forEach(s=>Iq[s]=r)}catch(r){console.error(r)}}}(n,this._document),n.forEach(s=>{const a=u=>{this._zone.run(()=>this.source.next(new s0(u.matches,s)))};let l=this.registry.get(s);l||(l=this.buildMQL(s),l.addListener(a),this.pendingRemoveListenerFns.push(()=>l.removeListener(a)),this.registry.set(s,l)),l.matches&&r.push(new s0(!0,s))}),r}ngOnDestroy(){let e;for(;e=this.pendingRemoveListenerFns.pop();)e()}buildMQL(e){return function Lge(i,t){return t&&window.matchMedia("all").addListener?window.matchMedia(i):{matches:"all"===i||""===i,media:i,addListener:()=>{},removeListener:()=>{},onchange:null,addEventListener(){},removeEventListener(){},dispatchEvent:()=>!1}}(e,wb(this._platformId))}}return i.\u0275fac=function(e){return new(e||i)(Ve(Rn),Ve(kh),Ve(ar))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const Iq={},Oge=[{alias:"xs",mediaQuery:"screen and (min-width: 0px) and (max-width: 599.98px)",priority:1e3},{alias:"sm",mediaQuery:"screen and (min-width: 600px) and (max-width: 959.98px)",priority:900},{alias:"md",mediaQuery:"screen and (min-width: 960px) and (max-width: 1279.98px)",priority:800},{alias:"lg",mediaQuery:"screen and (min-width: 1280px) and (max-width: 1919.98px)",priority:700},{alias:"xl",mediaQuery:"screen and (min-width: 1920px) and (max-width: 4999.98px)",priority:600},{alias:"lt-sm",overlapping:!0,mediaQuery:"screen and (max-width: 599.98px)",priority:950},{alias:"lt-md",overlapping:!0,mediaQuery:"screen and (max-width: 959.98px)",priority:850},{alias:"lt-lg",overlapping:!0,mediaQuery:"screen and (max-width: 1279.98px)",priority:750},{alias:"lt-xl",overlapping:!0,priority:650,mediaQuery:"screen and (max-width: 1919.98px)"},{alias:"gt-xs",overlapping:!0,mediaQuery:"screen and (min-width: 600px)",priority:-950},{alias:"gt-sm",overlapping:!0,mediaQuery:"screen and (min-width: 960px)",priority:-850},{alias:"gt-md",overlapping:!0,mediaQuery:"screen and (min-width: 1280px)",priority:-750},{alias:"gt-lg",overlapping:!0,mediaQuery:"screen and (min-width: 1920px)",priority:-650}],Lq="(orientation: portrait) and (max-width: 599.98px)",Oq="(orientation: landscape) and (max-width: 959.98px)",Fq="(orientation: portrait) and (min-width: 600px) and (max-width: 839.98px)",Bq="(orientation: landscape) and (min-width: 960px) and (max-width: 1279.98px)",Nq="(orientation: portrait) and (min-width: 840px)",Hq="(orientation: landscape) and (min-width: 1280px)",cg={HANDSET:`${Lq}, ${Oq}`,TABLET:`${Fq} , ${Bq}`,WEB:`${Nq}, ${Hq} `,HANDSET_PORTRAIT:`${Lq}`,TABLET_PORTRAIT:`${Fq} `,WEB_PORTRAIT:`${Nq}`,HANDSET_LANDSCAPE:`${Oq}`,TABLET_LANDSCAPE:`${Bq}`,WEB_LANDSCAPE:`${Hq}`},Fge=[{alias:"handset",priority:2e3,mediaQuery:cg.HANDSET},{alias:"handset.landscape",priority:2e3,mediaQuery:cg.HANDSET_LANDSCAPE},{alias:"handset.portrait",priority:2e3,mediaQuery:cg.HANDSET_PORTRAIT},{alias:"tablet",priority:2100,mediaQuery:cg.TABLET},{alias:"tablet.landscape",priority:2100,mediaQuery:cg.TABLET_LANDSCAPE},{alias:"tablet.portrait",priority:2100,mediaQuery:cg.TABLET_PORTRAIT},{alias:"web",priority:2200,mediaQuery:cg.WEB,overlapping:!0},{alias:"web.landscape",priority:2200,mediaQuery:cg.WEB_LANDSCAPE,overlapping:!0},{alias:"web.portrait",priority:2200,mediaQuery:cg.WEB_PORTRAIT,overlapping:!0}],Bge=/(\.|-|_)/g;function Nge(i){let t=i.length>0?i.charAt(0):"",e=i.length>1?i.slice(1):"";return t.toUpperCase()+e}const Uge=new gi("Token (@angular/flex-layout) Breakpoints",{providedIn:"root",factory:()=>{const i=f_(nV),t=f_(Wf),e=[].concat.apply([],(i||[]).map(r=>Array.isArray(r)?r:[r]));return function zge(i,t=[]){const e={};return i.forEach(n=>{e[n.alias]=n}),t.forEach(n=>{e[n.alias]?lg(e[n.alias],n):e[n.alias]=n}),function Vge(i){return i.forEach(t=>{t.suffix||(t.suffix=function Hge(i){return i.replace(Bge,"|").split("|").map(Nge).join("")}(t.alias),t.overlapping=!!t.overlapping)}),i}(Object.keys(e).map(n=>e[n]))}((t.disableDefaultBps?[]:Oge).concat(t.addOrientationBps?Fge:[]),e)}});let sV=(()=>{class i{constructor(e){this.findByMap=new Map,this.items=[...e].sort(Pge)}findByAlias(e){return e?this.findWithPredicate(e,n=>n.alias===e):null}findByQuery(e){return this.findWithPredicate(e,n=>n.mediaQuery===e)}get overlappings(){return this.items.filter(e=>e.overlapping)}get aliases(){return this.items.map(e=>e.alias)}get suffixes(){return this.items.map(e=>{var n;return null!==(n=null==e?void 0:e.suffix)&&void 0!==n?n:""})}findWithPredicate(e,n){var r;let s=this.findByMap.get(e);return s||(s=null!==(r=this.items.find(n))&&void 0!==r?r:null,this.findByMap.set(e,s)),null!=s?s:null}}return i.\u0275fac=function(e){return new(e||i)(Ve(Uge))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const mS="print",Gge={alias:mS,mediaQuery:mS,priority:1e3};let Wge=(()=>{class i{constructor(e,n,r){this.breakpoints=e,this.layoutConfig=n,this._document=r,this.registeredBeforeAfterPrintHooks=!1,this.isPrintingBeforeAfterEvent=!1,this.beforePrintEventListeners=[],this.afterPrintEventListeners=[],this.formerActivations=null,this.isPrinting=!1,this.queue=new jge,this.deactivations=[]}withPrintQuery(e){return[...e,mS]}isPrintEvent(e){return e.mediaQuery.startsWith(mS)}get printAlias(){var e;return[...null!==(e=this.layoutConfig.printWithBreakpoints)&&void 0!==e?e:[]]}get printBreakPoints(){return this.printAlias.map(e=>this.breakpoints.findByAlias(e)).filter(e=>null!==e)}getEventBreakpoints({mediaQuery:e}){const n=this.breakpoints.findByQuery(e);return(n?[...this.printBreakPoints,n]:this.printBreakPoints).sort(TT)}updateEvent(e){var n;let r=this.breakpoints.findByQuery(e.mediaQuery);return this.isPrintEvent(e)&&(r=this.getEventBreakpoints(e)[0],e.mediaQuery=null!==(n=null==r?void 0:r.mediaQuery)&&void 0!==n?n:""),kq(e,r)}registerBeforeAfterPrintHooks(e){if(!this._document.defaultView||this.registeredBeforeAfterPrintHooks)return;this.registeredBeforeAfterPrintHooks=!0;const n=()=>{this.isPrinting||(this.isPrintingBeforeAfterEvent=!0,this.startPrinting(e,this.getEventBreakpoints(new s0(!0,mS))),e.updateStyles())},r=()=>{this.isPrintingBeforeAfterEvent=!1,this.isPrinting&&(this.stopPrinting(e),e.updateStyles())};this._document.defaultView.addEventListener("beforeprint",n),this._document.defaultView.addEventListener("afterprint",r),this.beforePrintEventListeners.push(n),this.afterPrintEventListeners.push(r)}interceptEvents(e){return n=>{this.isPrintEvent(n)?n.matches&&!this.isPrinting?(this.startPrinting(e,this.getEventBreakpoints(n)),e.updateStyles()):!n.matches&&this.isPrinting&&!this.isPrintingBeforeAfterEvent&&(this.stopPrinting(e),e.updateStyles()):this.collectActivations(e,n)}}blockPropagation(){return e=>!(this.isPrinting||this.isPrintEvent(e))}startPrinting(e,n){this.isPrinting=!0,this.formerActivations=e.activatedBreakpoints,e.activatedBreakpoints=this.queue.addPrintBreakpoints(n)}stopPrinting(e){e.activatedBreakpoints=this.deactivations,this.deactivations=[],this.formerActivations=null,this.queue.clear(),this.isPrinting=!1}collectActivations(e,n){if(!this.isPrinting||this.isPrintingBeforeAfterEvent){if(!this.isPrintingBeforeAfterEvent)return void(this.deactivations=[]);if(!n.matches){const r=this.breakpoints.findByQuery(n.mediaQuery);if(r){const s=this.formerActivations&&this.formerActivations.includes(r),a=!this.formerActivations&&e.activatedBreakpoints.includes(r);(s||a)&&(this.deactivations.push(r),this.deactivations.sort(TT))}}}}ngOnDestroy(){this._document.defaultView&&(this.beforePrintEventListeners.forEach(e=>this._document.defaultView.removeEventListener("beforeprint",e)),this.afterPrintEventListeners.forEach(e=>this._document.defaultView.removeEventListener("afterprint",e)))}}return i.\u0275fac=function(e){return new(e||i)(Ve(sV),Ve(Wf),Ve(ar))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();class jge{constructor(){this.printBreakpoints=[]}addPrintBreakpoints(t){return t.push(Gge),t.sort(TT),t.forEach(e=>this.addBreakpoint(e)),this.printBreakpoints}addBreakpoint(t){t&&void 0===this.printBreakpoints.find(n=>n.mediaQuery===t.mediaQuery)&&(this.printBreakpoints=function qge(i){var t;return null!==(t=null==i?void 0:i.mediaQuery.startsWith(mS))&&void 0!==t&&t}(t)?[t,...this.printBreakpoints]:[...this.printBreakpoints,t])}clear(){this.printBreakpoints=[]}}let Oa=(()=>{class i{constructor(e,n,r){this.matchMedia=e,this.breakpoints=n,this.hook=r,this._useFallbacks=!0,this._activatedBreakpoints=[],this.elementMap=new Map,this.elementKeyMap=new WeakMap,this.watcherMap=new WeakMap,this.updateMap=new WeakMap,this.clearMap=new WeakMap,this.subject=new ii,this.observeActivations()}get activatedAlias(){var e,n;return null!==(n=null===(e=this.activatedBreakpoints[0])||void 0===e?void 0:e.alias)&&void 0!==n?n:""}set activatedBreakpoints(e){this._activatedBreakpoints=[...e]}get activatedBreakpoints(){return[...this._activatedBreakpoints]}set useFallbacks(e){this._useFallbacks=e}onMediaChange(e){const n=this.findByQuery(e.mediaQuery);if(n){e=kq(e,n);const r=this.activatedBreakpoints.indexOf(n);e.matches&&-1===r?(this._activatedBreakpoints.push(n),this._activatedBreakpoints.sort(TT),this.updateStyles()):!e.matches&&-1!==r&&(this._activatedBreakpoints.splice(r,1),this._activatedBreakpoints.sort(TT),this.updateStyles())}}init(e,n,r,s,a=[]){Vq(this.updateMap,e,n,r),Vq(this.clearMap,e,n,s),this.buildElementKeyMap(e,n),this.watchExtraTriggers(e,n,a)}getValue(e,n,r){const s=this.elementMap.get(e);if(s){const a=void 0!==r?s.get(r):this.getActivatedValues(s,n);if(a)return a.get(n)}}hasValue(e,n){const r=this.elementMap.get(e);if(r){const s=this.getActivatedValues(r,n);if(s)return void 0!==s.get(n)||!1}return!1}setValue(e,n,r,s){var a;let l=this.elementMap.get(e);if(l){const h=(null!==(a=l.get(s))&&void 0!==a?a:new Map).set(n,r);l.set(s,h),this.elementMap.set(e,l)}else l=(new Map).set(s,(new Map).set(n,r)),this.elementMap.set(e,l);const u=this.getValue(e,n);void 0!==u&&this.updateElement(e,n,u)}trackValue(e,n){return this.subject.asObservable().pipe(vr(r=>r.element===e&&r.key===n))}updateStyles(){this.elementMap.forEach((e,n)=>{const r=new Set(this.elementKeyMap.get(n));let s=this.getActivatedValues(e);s&&s.forEach((a,l)=>{this.updateElement(n,l,a),r.delete(l)}),r.forEach(a=>{if(s=this.getActivatedValues(e,a),s){const l=s.get(a);this.updateElement(n,a,l)}else this.clearElement(n,a)})})}clearElement(e,n){const r=this.clearMap.get(e);if(r){const s=r.get(n);s&&(s(),this.subject.next({element:e,key:n,value:""}))}}updateElement(e,n,r){const s=this.updateMap.get(e);if(s){const a=s.get(n);a&&(a(r),this.subject.next({element:e,key:n,value:r}))}}releaseElement(e){const n=this.watcherMap.get(e);n&&(n.forEach(s=>s.unsubscribe()),this.watcherMap.delete(e));const r=this.elementMap.get(e);r&&(r.forEach((s,a)=>r.delete(a)),this.elementMap.delete(e))}triggerUpdate(e,n){const r=this.elementMap.get(e);if(r){const s=this.getActivatedValues(r,n);s&&(n?this.updateElement(e,n,s.get(n)):s.forEach((a,l)=>this.updateElement(e,l,a)))}}buildElementKeyMap(e,n){let r=this.elementKeyMap.get(e);r||(r=new Set,this.elementKeyMap.set(e,r)),r.add(n)}watchExtraTriggers(e,n,r){if(r&&r.length){let s=this.watcherMap.get(e);if(s||(s=new Map,this.watcherMap.set(e,s)),!s.get(n)){const l=uo(...r).subscribe(()=>{const u=this.getValue(e,n);this.updateElement(e,n,u)});s.set(n,l)}}}findByQuery(e){return this.breakpoints.findByQuery(e)}getActivatedValues(e,n){for(let s=0;s<this.activatedBreakpoints.length;s++){const l=e.get(this.activatedBreakpoints[s].alias);if(l&&(void 0===n||l.has(n)&&null!=l.get(n)))return l}if(!this._useFallbacks)return;const r=e.get("");return void 0===n||r&&r.has(n)?r:void 0}observeActivations(){const e=this.breakpoints.items.map(n=>n.mediaQuery);this.hook.registerBeforeAfterPrintHooks(this),this.matchMedia.observe(this.hook.withPrintQuery(e)).pipe(Po(this.hook.interceptEvents(this)),vr(this.hook.blockPropagation())).subscribe(this.onMediaChange.bind(this))}}return i.\u0275fac=function(e){return new(e||i)(Ve(rV),Ve(sV),Ve(Wge))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function Vq(i,t,e,n){var r;if(void 0!==n){const s=null!==(r=i.get(t))&&void 0!==r?r:new Map;s.set(e,n),i.set(t,s)}}let Ya=(()=>{class i{constructor(e,n,r,s){this.elementRef=e,this.styleBuilder=n,this.styler=r,this.marshal=s,this.DIRECTIVE_KEY="",this.inputs=[],this.mru={},this.destroySubject=new ii,this.styleCache=new Map}get parentElement(){return this.elementRef.nativeElement.parentElement}get nativeElement(){return this.elementRef.nativeElement}get activatedValue(){return this.marshal.getValue(this.nativeElement,this.DIRECTIVE_KEY)}set activatedValue(e){this.marshal.setValue(this.nativeElement,this.DIRECTIVE_KEY,e,this.marshal.activatedAlias)}ngOnChanges(e){Object.keys(e).forEach(n=>{if(-1!==this.inputs.indexOf(n)){const r=n.split(".").slice(1).join(".");this.setValue(e[n].currentValue,r)}})}ngOnDestroy(){this.destroySubject.next(),this.destroySubject.complete(),this.marshal.releaseElement(this.nativeElement)}init(e=[]){this.marshal.init(this.elementRef.nativeElement,this.DIRECTIVE_KEY,this.updateWithValue.bind(this),this.clearStyles.bind(this),e)}addStyles(e,n){const r=this.styleBuilder,s=r.shouldCache;let a=this.styleCache.get(e);(!a||!s)&&(a=r.buildStyles(e,n),s&&this.styleCache.set(e,a)),this.mru=Object.assign({},a),this.applyStyleToElement(a),r.sideEffect(e,a,n)}clearStyles(){Object.keys(this.mru).forEach(e=>{this.mru[e]=""}),this.applyStyleToElement(this.mru),this.mru={},this.currentValue=void 0}triggerUpdate(){this.marshal.triggerUpdate(this.nativeElement,this.DIRECTIVE_KEY)}getFlexFlowDirection(e,n=!1){if(e){const[r,s]=this.styler.getFlowDirection(e);if(!s&&n){const a=Aq(r);this.styler.applyStyleToElements(a,[e])}return r.trim()}return"row"}hasWrap(e){return this.styler.hasWrap(e)}applyStyleToElement(e,n,r=this.nativeElement){this.styler.applyStyleToElement(r,e,n)}setValue(e,n){this.marshal.setValue(this.nativeElement,this.DIRECTIVE_KEY,e,n)}updateWithValue(e){this.currentValue!==e&&(this.addStyles(e),this.currentValue=e)}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(ll),B(va),B(Oa))},i.\u0275dir=Be({type:i,features:[Ls]}),i})();function zq(i,t="1",e="1"){let n=[t,e,i],r=i.indexOf("calc");if(r>0){n[2]=Uq(i.substring(r).trim());let s=i.substr(0,r).trim().split(" ");2==s.length&&(n[0]=s[0],n[1]=s[1])}else if(0==r)n[2]=Uq(i.trim());else{let s=i.split(" ");n=3===s.length?s:[t,e,i]}return n}function Uq(i){return i.replace(/[\s]/g,"").replace(/[\/\*\+\-]/g," $& ")}function OP(i,t){if(void 0===t)return i;const e=n=>{const r=+n.slice(0,-"x".length);return i.endsWith("x")&&!isNaN(r)?`${r*t.value}${t.unit}`:i};return i.includes(" ")?i.split(" ").map(e).join(" "):e(i)}let Yge=(()=>{class i extends ll{buildStyles(e,{display:n}){const r=Aq(e);return Object.assign(Object.assign({},r),{display:"none"===n?n:r.display})}}return i.\u0275fac=function(){let t;return function(n){return(t||(t=Ki(i)))(n||i)}}(),i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const Kge=["fxLayout","fxLayout.xs","fxLayout.sm","fxLayout.md","fxLayout.lg","fxLayout.xl","fxLayout.lt-sm","fxLayout.lt-md","fxLayout.lt-lg","fxLayout.lt-xl","fxLayout.gt-xs","fxLayout.gt-sm","fxLayout.gt-md","fxLayout.gt-lg"];let Qge=(()=>{class i extends Ya{constructor(e,n,r,s,a){super(e,r,n,s),this._config=a,this.DIRECTIVE_KEY="layout",this.init()}updateWithValue(e){var n;const s=this._config.detectLayoutDisplay?this.styler.lookupStyle(this.nativeElement,"display"):"";this.styleCache=null!==(n=Wq.get(s))&&void 0!==n?n:new Map,Wq.set(s,this.styleCache),this.currentValue!==e&&(this.addStyles(e,{display:s}),this.currentValue=e)}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(va),B(Yge),B(Oa),B(Wf))},i.\u0275dir=Be({type:i,features:[It]}),i})(),ug=(()=>{class i extends Qge{constructor(){super(...arguments),this.inputs=Kge}}return i.\u0275fac=function(){let t;return function(n){return(t||(t=Ki(i)))(n||i)}}(),i.\u0275dir=Be({type:i,selectors:[["","fxLayout",""],["","fxLayout.xs",""],["","fxLayout.sm",""],["","fxLayout.md",""],["","fxLayout.lg",""],["","fxLayout.xl",""],["","fxLayout.lt-sm",""],["","fxLayout.lt-md",""],["","fxLayout.lt-lg",""],["","fxLayout.lt-xl",""],["","fxLayout.gt-xs",""],["","fxLayout.gt-sm",""],["","fxLayout.gt-md",""],["","fxLayout.gt-lg",""]],inputs:{fxLayout:"fxLayout","fxLayout.xs":"fxLayout.xs","fxLayout.sm":"fxLayout.sm","fxLayout.md":"fxLayout.md","fxLayout.lg":"fxLayout.lg","fxLayout.xl":"fxLayout.xl","fxLayout.lt-sm":"fxLayout.lt-sm","fxLayout.lt-md":"fxLayout.lt-md","fxLayout.lt-lg":"fxLayout.lt-lg","fxLayout.lt-xl":"fxLayout.lt-xl","fxLayout.gt-xs":"fxLayout.gt-xs","fxLayout.gt-sm":"fxLayout.gt-sm","fxLayout.gt-md":"fxLayout.gt-md","fxLayout.gt-lg":"fxLayout.gt-lg"},features:[It]}),i})();const Wq=new Map,jq={"margin-left":null,"margin-right":null,"margin-top":null,"margin-bottom":null};let Jge=(()=>{class i extends ll{constructor(e,n){super(),this._styler=e,this._config=n}buildStyles(e,n){return e.endsWith(FP)?function o_e(i,t){const[e,n]=i.split(" "),s=h=>`-${h}`;let a="0px",l=s(null!=n?n:e),u="0px";return"rtl"===t?u=s(e):a=s(e),{margin:`0px ${a} ${l} ${u}`}}(e=OP(e=e.slice(0,e.indexOf(FP)),this._config.multiplier),n.directionality):{}}sideEffect(e,n,r){const s=r.items;if(e.endsWith(FP)){const a=function s_e(i,t){const[e,n]=i.split(" ");let s="0px",l="0px";return"rtl"===t?l=e:s=e,{padding:`0px ${s} ${null!=n?n:e} ${l}`}}(e=OP(e=e.slice(0,e.indexOf(FP)),this._config.multiplier),r.directionality);this._styler.applyStyleToElements(a,r.items)}else{e=OP(e,this._config.multiplier),e=this.addFallbackUnit(e);const a=s.pop(),l=function a_e(i,t){const e=qq(t.directionality,t.layout),n=Object.assign({},jq);return n[e]=i,n}(e,r);this._styler.applyStyleToElements(l,s),this._styler.applyStyleToElements(jq,[a])}}addFallbackUnit(e){return isNaN(+e)?e:`${e}${this._config.defaultUnit}`}}return i.\u0275fac=function(e){return new(e||i)(Ve(va),Ve(Wf))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const $ge=["fxLayoutGap","fxLayoutGap.xs","fxLayoutGap.sm","fxLayoutGap.md","fxLayoutGap.lg","fxLayoutGap.xl","fxLayoutGap.lt-sm","fxLayoutGap.lt-md","fxLayoutGap.lt-lg","fxLayoutGap.lt-xl","fxLayoutGap.gt-xs","fxLayoutGap.gt-sm","fxLayoutGap.gt-md","fxLayoutGap.gt-lg"];let e_e=(()=>{class i extends Ya{constructor(e,n,r,s,a,l){super(e,a,s,l),this.zone=n,this.directionality=r,this.styleUtils=s,this.layout="row",this.DIRECTIVE_KEY="layout-gap",this.observerSubject=new ii;const u=[this.directionality.change,this.observerSubject.asObservable()];this.init(u),this.marshal.trackValue(this.nativeElement,"layout").pipe($n(this.destroySubject)).subscribe(this.onLayoutChange.bind(this))}get childrenNodes(){const e=this.nativeElement.children,n=[];for(let r=e.length;r--;)n[r]=e[r];return n}ngAfterContentInit(){this.buildChildObservable(),this.triggerUpdate()}ngOnDestroy(){super.ngOnDestroy(),this.observer&&this.observer.disconnect()}onLayoutChange(e){const r=e.value.split(" ");this.layout=r[0],LP.find(s=>s===this.layout)||(this.layout="row"),this.triggerUpdate()}updateWithValue(e){const n=this.childrenNodes.filter(r=>1===r.nodeType&&this.willDisplay(r)).sort((r,s)=>{const a=+this.styler.lookupStyle(r,"order"),l=+this.styler.lookupStyle(s,"order");return isNaN(a)||isNaN(l)||a===l?0:a>l?1:-1});if(n.length>0){const r=this.directionality.value,s=this.layout;"row"===s&&"rtl"===r?this.styleCache=t_e:"row"===s&&"rtl"!==r?this.styleCache=n_e:"column"===s&&"rtl"===r?this.styleCache=i_e:"column"===s&&"rtl"!==r&&(this.styleCache=r_e),this.addStyles(e,{directionality:r,items:n,layout:s})}}clearStyles(){const e=Object.keys(this.mru).length>0,n=e?"padding":qq(this.directionality.value,this.layout);e&&super.clearStyles(),this.styleUtils.applyStyleToElements({[n]:""},this.childrenNodes)}willDisplay(e){const n=this.marshal.getValue(e,"show-hide");return!0===n||void 0===n&&"none"!==this.styleUtils.lookupStyle(e,"display")}buildChildObservable(){this.zone.runOutsideAngular(()=>{"undefined"!=typeof MutationObserver&&(this.observer=new MutationObserver(e=>{e.some(r=>r.addedNodes&&r.addedNodes.length>0||r.removedNodes&&r.removedNodes.length>0)&&this.observerSubject.next()}),this.observer.observe(this.nativeElement,{childList:!0}))})}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(Rn),B(Ia),B(va),B(Jge),B(Oa))},i.\u0275dir=Be({type:i,features:[It]}),i})(),oV=(()=>{class i extends e_e{constructor(){super(...arguments),this.inputs=$ge}}return i.\u0275fac=function(){let t;return function(n){return(t||(t=Ki(i)))(n||i)}}(),i.\u0275dir=Be({type:i,selectors:[["","fxLayoutGap",""],["","fxLayoutGap.xs",""],["","fxLayoutGap.sm",""],["","fxLayoutGap.md",""],["","fxLayoutGap.lg",""],["","fxLayoutGap.xl",""],["","fxLayoutGap.lt-sm",""],["","fxLayoutGap.lt-md",""],["","fxLayoutGap.lt-lg",""],["","fxLayoutGap.lt-xl",""],["","fxLayoutGap.gt-xs",""],["","fxLayoutGap.gt-sm",""],["","fxLayoutGap.gt-md",""],["","fxLayoutGap.gt-lg",""]],inputs:{fxLayoutGap:"fxLayoutGap","fxLayoutGap.xs":"fxLayoutGap.xs","fxLayoutGap.sm":"fxLayoutGap.sm","fxLayoutGap.md":"fxLayoutGap.md","fxLayoutGap.lg":"fxLayoutGap.lg","fxLayoutGap.xl":"fxLayoutGap.xl","fxLayoutGap.lt-sm":"fxLayoutGap.lt-sm","fxLayoutGap.lt-md":"fxLayoutGap.lt-md","fxLayoutGap.lt-lg":"fxLayoutGap.lt-lg","fxLayoutGap.lt-xl":"fxLayoutGap.lt-xl","fxLayoutGap.gt-xs":"fxLayoutGap.gt-xs","fxLayoutGap.gt-sm":"fxLayoutGap.gt-sm","fxLayoutGap.gt-md":"fxLayoutGap.gt-md","fxLayoutGap.gt-lg":"fxLayoutGap.gt-lg"},features:[It]}),i})();const t_e=new Map,i_e=new Map,n_e=new Map,r_e=new Map,FP=" grid";function qq(i,t){switch(t){case"column":return"margin-bottom";case"column-reverse":return"margin-top";case"row":default:return"rtl"===i?"margin-left":"margin-right";case"row-reverse":return"rtl"===i?"margin-right":"margin-left"}}let l_e=(()=>{class i extends ll{constructor(e){super(),this.layoutConfig=e}buildStyles(e,n){let[r,s,...a]=e.split(" "),l=a.join(" ");const u=n.direction.indexOf("column")>-1?"column":"row",h=MT(u)?"max-width":"max-height",m=MT(u)?"min-width":"min-height",_=String(l).indexOf("calc")>-1,v=_||"auto"===l,S=String(l).indexOf("%")>-1&&!_,T=String(l).indexOf("px")>-1||String(l).indexOf("rem")>-1||String(l).indexOf("em")>-1||String(l).indexOf("vw")>-1||String(l).indexOf("vh")>-1;let I=_||T;r="0"==r?0:r,s="0"==s?0:s;const j=!r&&!s;let P={};const E={"max-width":null,"max-height":null,"min-width":null,"min-height":null};switch(l||""){case"":const ie=!1!==this.layoutConfig.useColumnBasisZero;l="row"===u?"0%":ie?"0.000000001px":"auto";break;case"initial":case"nogrow":r=0,l="auto";break;case"grow":l="100%";break;case"noshrink":s=0,l="auto";break;case"auto":break;case"none":r=0,s=0,l="auto";break;default:!I&&!S&&!isNaN(l)&&(l+="%"),"0%"===l&&(I=!0),"0px"===l&&(l="0%"),P=lg(E,_?{"flex-grow":r,"flex-shrink":s,"flex-basis":I?l:"100%"}:{flex:`${r} ${s} ${I?l:"100%"}`})}return P.flex||P["flex-grow"]||(P=lg(E,_?{"flex-grow":r,"flex-shrink":s,"flex-basis":l}:{flex:`${r} ${s} ${l}`})),"0%"!==l&&"0px"!==l&&"0.000000001px"!==l&&"auto"!==l&&(P[m]=j||I&&r?l:null,P[h]=j||!v&&s?l:null),P[m]||P[h]?n.hasWrap&&(P[_?"flex-basis":"flex"]=P[h]?_?P[h]:`${r} ${s} ${P[h]}`:_?P[m]:`${r} ${s} ${P[m]}`):P=lg(E,_?{"flex-grow":r,"flex-shrink":s,"flex-basis":l}:{flex:`${r} ${s} ${l}`}),lg(P,{"box-sizing":"border-box"})}}return i.\u0275fac=function(e){return new(e||i)(Ve(Wf))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const c_e=["fxFlex","fxFlex.xs","fxFlex.sm","fxFlex.md","fxFlex.lg","fxFlex.xl","fxFlex.lt-sm","fxFlex.lt-md","fxFlex.lt-lg","fxFlex.lt-xl","fxFlex.gt-xs","fxFlex.gt-sm","fxFlex.gt-md","fxFlex.gt-lg"];let u_e=(()=>{class i extends Ya{constructor(e,n,r,s,a){super(e,s,n,a),this.layoutConfig=r,this.marshal=a,this.DIRECTIVE_KEY="flex",this.direction=void 0,this.wrap=void 0,this.flexGrow="1",this.flexShrink="1",this.init()}get shrink(){return this.flexShrink}set shrink(e){this.flexShrink=e||"1",this.triggerReflow()}get grow(){return this.flexGrow}set grow(e){this.flexGrow=e||"1",this.triggerReflow()}ngOnInit(){this.parentElement&&(this.marshal.trackValue(this.parentElement,"layout").pipe($n(this.destroySubject)).subscribe(this.onLayoutChange.bind(this)),this.marshal.trackValue(this.nativeElement,"layout-align").pipe($n(this.destroySubject)).subscribe(this.triggerReflow.bind(this)))}onLayoutChange(e){const r=e.value.split(" ");this.direction=r[0],this.wrap=void 0!==r[1]&&"wrap"===r[1],this.triggerUpdate()}updateWithValue(e){void 0===this.direction&&(this.direction=this.getFlexFlowDirection(this.parentElement,!1!==this.layoutConfig.addFlexToParent)),void 0===this.wrap&&(this.wrap=this.hasWrap(this.parentElement));const r=this.direction,s=r.startsWith("row"),a=this.wrap;s&&a?this.styleCache=f_e:s&&!a?this.styleCache=h_e:!s&&a?this.styleCache=p_e:!s&&!a&&(this.styleCache=d_e);const u=zq(String(e).replace(";",""),this.flexGrow,this.flexShrink);this.addStyles(u.join(" "),{direction:r,hasWrap:a})}triggerReflow(){const e=this.activatedValue;if(void 0!==e){const n=zq(e+"",this.flexGrow,this.flexShrink);this.marshal.updateElement(this.nativeElement,this.DIRECTIVE_KEY,n.join(" "))}}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(va),B(Wf),B(l_e),B(Oa))},i.\u0275dir=Be({type:i,inputs:{shrink:["fxShrink","shrink"],grow:["fxGrow","grow"]},features:[It]}),i})(),aV=(()=>{class i extends u_e{constructor(){super(...arguments),this.inputs=c_e}}return i.\u0275fac=function(){let t;return function(n){return(t||(t=Ki(i)))(n||i)}}(),i.\u0275dir=Be({type:i,selectors:[["","fxFlex",""],["","fxFlex.xs",""],["","fxFlex.sm",""],["","fxFlex.md",""],["","fxFlex.lg",""],["","fxFlex.xl",""],["","fxFlex.lt-sm",""],["","fxFlex.lt-md",""],["","fxFlex.lt-lg",""],["","fxFlex.lt-xl",""],["","fxFlex.gt-xs",""],["","fxFlex.gt-sm",""],["","fxFlex.gt-md",""],["","fxFlex.gt-lg",""]],inputs:{fxFlex:"fxFlex","fxFlex.xs":"fxFlex.xs","fxFlex.sm":"fxFlex.sm","fxFlex.md":"fxFlex.md","fxFlex.lg":"fxFlex.lg","fxFlex.xl":"fxFlex.xl","fxFlex.lt-sm":"fxFlex.lt-sm","fxFlex.lt-md":"fxFlex.lt-md","fxFlex.lt-lg":"fxFlex.lt-lg","fxFlex.lt-xl":"fxFlex.lt-xl","fxFlex.gt-xs":"fxFlex.gt-xs","fxFlex.gt-sm":"fxFlex.gt-sm","fxFlex.gt-md":"fxFlex.gt-md","fxFlex.gt-lg":"fxFlex.gt-lg"},features:[It]}),i})();const h_e=new Map,d_e=new Map,f_e=new Map,p_e=new Map;let B_e=(()=>{class i extends ll{buildStyles(e,n){const r={},[s,a]=e.split(" ");switch(s){case"center":r["justify-content"]="center";break;case"space-around":r["justify-content"]="space-around";break;case"space-between":r["justify-content"]="space-between";break;case"space-evenly":r["justify-content"]="space-evenly";break;case"end":case"flex-end":r["justify-content"]="flex-end";break;default:r["justify-content"]="flex-start"}switch(a){case"start":case"flex-start":r["align-items"]=r["align-content"]="flex-start";break;case"center":r["align-items"]=r["align-content"]="center";break;case"end":case"flex-end":r["align-items"]=r["align-content"]="flex-end";break;case"space-between":r["align-content"]="space-between",r["align-items"]="stretch";break;case"space-around":r["align-content"]="space-around",r["align-items"]="stretch";break;case"baseline":r["align-content"]="stretch",r["align-items"]="baseline";break;default:r["align-items"]=r["align-content"]="stretch"}return lg(r,{display:n.inline?"inline-flex":"flex","flex-direction":n.layout,"box-sizing":"border-box","max-width":"stretch"===a?MT(n.layout)?null:"100%":null,"max-height":"stretch"===a&&MT(n.layout)?"100%":null})}}return i.\u0275fac=function(){let t;return function(n){return(t||(t=Ki(i)))(n||i)}}(),i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const N_e=["fxLayoutAlign","fxLayoutAlign.xs","fxLayoutAlign.sm","fxLayoutAlign.md","fxLayoutAlign.lg","fxLayoutAlign.xl","fxLayoutAlign.lt-sm","fxLayoutAlign.lt-md","fxLayoutAlign.lt-lg","fxLayoutAlign.lt-xl","fxLayoutAlign.gt-xs","fxLayoutAlign.gt-sm","fxLayoutAlign.gt-md","fxLayoutAlign.gt-lg"];let H_e=(()=>{class i extends Ya{constructor(e,n,r,s){super(e,r,n,s),this.DIRECTIVE_KEY="layout-align",this.layout="row",this.inline=!1,this.init(),this.marshal.trackValue(this.nativeElement,"layout").pipe($n(this.destroySubject)).subscribe(this.onLayoutChange.bind(this))}updateWithValue(e){const n=this.layout||"row",r=this.inline;"row"===n&&r?this.styleCache=W_e:"row"!==n||r?"row-reverse"===n&&r?this.styleCache=q_e:"row-reverse"!==n||r?"column"===n&&r?this.styleCache=j_e:"column"!==n||r?"column-reverse"===n&&r?this.styleCache=X_e:"column-reverse"===n&&!r&&(this.styleCache=G_e):this.styleCache=z_e:this.styleCache=U_e:this.styleCache=V_e,this.addStyles(e,{layout:n,inline:r})}onLayoutChange(e){const n=e.value.split(" ");this.layout=n[0],this.inline=e.value.includes("inline"),LP.find(r=>r===this.layout)||(this.layout="row"),this.triggerUpdate()}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(va),B(B_e),B(Oa))},i.\u0275dir=Be({type:i,features:[It]}),i})(),hg=(()=>{class i extends H_e{constructor(){super(...arguments),this.inputs=N_e}}return i.\u0275fac=function(){let t;return function(n){return(t||(t=Ki(i)))(n||i)}}(),i.\u0275dir=Be({type:i,selectors:[["","fxLayoutAlign",""],["","fxLayoutAlign.xs",""],["","fxLayoutAlign.sm",""],["","fxLayoutAlign.md",""],["","fxLayoutAlign.lg",""],["","fxLayoutAlign.xl",""],["","fxLayoutAlign.lt-sm",""],["","fxLayoutAlign.lt-md",""],["","fxLayoutAlign.lt-lg",""],["","fxLayoutAlign.lt-xl",""],["","fxLayoutAlign.gt-xs",""],["","fxLayoutAlign.gt-sm",""],["","fxLayoutAlign.gt-md",""],["","fxLayoutAlign.gt-lg",""]],inputs:{fxLayoutAlign:"fxLayoutAlign","fxLayoutAlign.xs":"fxLayoutAlign.xs","fxLayoutAlign.sm":"fxLayoutAlign.sm","fxLayoutAlign.md":"fxLayoutAlign.md","fxLayoutAlign.lg":"fxLayoutAlign.lg","fxLayoutAlign.xl":"fxLayoutAlign.xl","fxLayoutAlign.lt-sm":"fxLayoutAlign.lt-sm","fxLayoutAlign.lt-md":"fxLayoutAlign.lt-md","fxLayoutAlign.lt-lg":"fxLayoutAlign.lt-lg","fxLayoutAlign.lt-xl":"fxLayoutAlign.lt-xl","fxLayoutAlign.gt-xs":"fxLayoutAlign.gt-xs","fxLayoutAlign.gt-sm":"fxLayoutAlign.gt-sm","fxLayoutAlign.gt-md":"fxLayoutAlign.gt-md","fxLayoutAlign.gt-lg":"fxLayoutAlign.gt-lg"},features:[It]}),i})();const V_e=new Map,z_e=new Map,U_e=new Map,G_e=new Map,W_e=new Map,j_e=new Map,q_e=new Map,X_e=new Map;let Xq=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[tV,Uw]]}),i})(),Zq=(()=>{class i{constructor(e){this._configService=e,this.time=10,e.configAsObservable.subscribe(n=>this.time=n._config.query.default_temporal_distance)}getTemporalDistanceFromUser(){return this.time}}return i.\u0275fac=function(e){return new(e||i)(B(dr))},i.\u0275cmp=ei({type:i,selectors:[["app-temporal-distance"]],decls:5,vars:1,consts:[["fxLayout","row","fxLayoutAlign","space-evenly center"],[2,"font-size","14px"],["matInput","","type","number","value","30",2,"text-align","right",3,"ngModel","ngModelChange"],["matSuffix",""]],template:function(e,n){1&e&&(Z(0,"div",0)(1,"mat-form-field",1)(2,"input",2),je("ngModelChange",function(s){return n.time=s}),J(),Z(3,"span",3),ue(4,"sec."),J()()()),2&e&&(se(2),fe("ngModel",n.time))},directives:[ug,hg,og,Ty,WR,Bf,ah,lh,GH],styles:["app-temporal-distance[_ngcontent-%COMP%]{font-size:14px!important}"]}),i})();var o0=(()=>{return(i=o0||(o0={}))[i.EARLIER_STAGE=0]="EARLIER_STAGE",i[i.LATER_STAGE=1]="LATER_STAGE",o0;var i})();const Z_e=["sliderWrapper"],Jd=ly({passive:!1}),$_e={provide:Ac,useExisting:rs(()=>Ey),multi:!0};class eye{}const tye=Ww(Vf(Hf(class{constructor(i){this._elementRef=i}}),"accent"));let Ey=(()=>{class i extends tye{constructor(e,n,r,s,a,l,u,h){super(e),this._focusMonitor=n,this._changeDetectorRef=r,this._dir=s,this._ngZone=l,this._animationMode=h,this._invert=!1,this._max=100,this._min=0,this._step=1,this._thumbLabel=!1,this._tickInterval=0,this._value=null,this._vertical=!1,this.change=new Si,this.input=new Si,this.valueChange=new Si,this.onTouched=()=>{},this._percent=0,this._isSliding=null,this._isActive=!1,this._tickIntervalPercent=0,this._sliderDimensions=null,this._controlValueAccessorChangeFn=()=>{},this._dirChangeSubscription=Q.EMPTY,this._pointerDown=m=>{this.disabled||this._isSliding||!ET(m)&&0!==m.button||this._ngZone.run(()=>{this._touchId=ET(m)?function iye(i,t){for(let e=0;e<i.touches.length;e++){const n=i.touches[e].target;if(t===n||t.contains(n))return i.touches[e].identifier}}(m,this._elementRef.nativeElement):void 0;const _=Kq(m,this._touchId);if(_){const v=this.value;this._isSliding="pointer",this._lastPointerEvent=m,this._focusHostElement(),this._onMouseenter(),this._bindGlobalEvents(m),this._focusHostElement(),this._updateValueFromPosition(_),this._valueOnSlideStart=v,m.cancelable&&m.preventDefault(),v!=this.value&&this._emitInputEvent()}})},this._pointerMove=m=>{if("pointer"===this._isSliding){const _=Kq(m,this._touchId);if(_){m.preventDefault();const v=this.value;this._lastPointerEvent=m,this._updateValueFromPosition(_),v!=this.value&&this._emitInputEvent()}}},this._pointerUp=m=>{"pointer"===this._isSliding&&(!ET(m)||"number"!=typeof this._touchId||lV(m.changedTouches,this._touchId))&&(m.preventDefault(),this._removeGlobalEvents(),this._isSliding=null,this._touchId=void 0,this._valueOnSlideStart!=this.value&&!this.disabled&&this._emitChangeEvent(),this._valueOnSlideStart=this._lastPointerEvent=null)},this._windowBlur=()=>{this._lastPointerEvent&&this._pointerUp(this._lastPointerEvent)},this._document=u,this.tabIndex=parseInt(a)||0,l.runOutsideAngular(()=>{const m=e.nativeElement;m.addEventListener("mousedown",this._pointerDown,Jd),m.addEventListener("touchstart",this._pointerDown,Jd)})}get invert(){return this._invert}set invert(e){this._invert=tn(e)}get max(){return this._max}set max(e){this._max=Qo(e,this._max),this._percent=this._calculatePercentage(this._value),this._changeDetectorRef.markForCheck()}get min(){return this._min}set min(e){this._min=Qo(e,this._min),this._percent=this._calculatePercentage(this._value),this._changeDetectorRef.markForCheck()}get step(){return this._step}set step(e){this._step=Qo(e,this._step),this._step%1!=0&&(this._roundToDecimal=this._step.toString().split(".").pop().length),this._changeDetectorRef.markForCheck()}get thumbLabel(){return this._thumbLabel}set thumbLabel(e){this._thumbLabel=tn(e)}get tickInterval(){return this._tickInterval}set tickInterval(e){this._tickInterval="auto"===e?"auto":"number"==typeof e||"string"==typeof e?Qo(e,this._tickInterval):0}get value(){return null===this._value&&(this.value=this._min),this._value}set value(e){if(e!==this._value){let n=Qo(e,0);this._roundToDecimal&&n!==this.min&&n!==this.max&&(n=parseFloat(n.toFixed(this._roundToDecimal))),this._value=n,this._percent=this._calculatePercentage(this._value),this._changeDetectorRef.markForCheck()}}get vertical(){return this._vertical}set vertical(e){this._vertical=tn(e)}get displayValue(){return this.displayWith?this.displayWith(this.value):this._roundToDecimal&&this.value&&this.value%1!=0?this.value.toFixed(this._roundToDecimal):this.value||0}focus(e){this._focusHostElement(e)}blur(){this._blurHostElement()}get percent(){return this._clamp(this._percent)}_shouldInvertAxis(){return this.vertical?!this.invert:this.invert}_isMinValue(){return 0===this.percent}_getThumbGap(){return this.disabled?7:this._isMinValue()&&!this.thumbLabel?this._isActive?10:7:0}_getTrackBackgroundStyles(){const n=this.vertical?`1, ${1-this.percent}, 1`:1-this.percent+", 1, 1";return{transform:`translate${this.vertical?"Y":"X"}(${this._shouldInvertMouseCoords()?"-":""}${this._getThumbGap()}px) scale3d(${n})`}}_getTrackFillStyles(){const e=this.percent,r=this.vertical?`1, ${e}, 1`:`${e}, 1, 1`;return{transform:`translate${this.vertical?"Y":"X"}(${this._shouldInvertMouseCoords()?"":"-"}${this._getThumbGap()}px) scale3d(${r})`,display:0===e?"none":""}}_getTicksContainerStyles(){return{transform:`translate${this.vertical?"Y":"X"}(${this.vertical||"rtl"!=this._getDirection()?"-":""}${this._tickIntervalPercent/2*100}%)`}}_getTicksStyles(){let e=100*this._tickIntervalPercent,l={backgroundSize:this.vertical?`2px ${e}%`:`${e}% 2px`,transform:`translateZ(0) translate${this.vertical?"Y":"X"}(${this.vertical||"rtl"!=this._getDirection()?"":"-"}${e/2}%)${this.vertical||"rtl"!=this._getDirection()?"":" rotate(180deg)"}`};if(this._isMinValue()&&this._getThumbGap()){const u=this._shouldInvertAxis();let h;h=this.vertical?u?"Bottom":"Top":u?"Right":"Left",l[`padding${h}`]=`${this._getThumbGap()}px`}return l}_getThumbContainerStyles(){const e=this._shouldInvertAxis();return{transform:`translate${this.vertical?"Y":"X"}(-${100*(("rtl"!=this._getDirection()||this.vertical?e:!e)?this.percent:1-this.percent)}%)`}}_shouldInvertMouseCoords(){const e=this._shouldInvertAxis();return"rtl"!=this._getDirection()||this.vertical?e:!e}_getDirection(){return this._dir&&"rtl"==this._dir.value?"rtl":"ltr"}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(e=>{this._isActive=!!e&&"keyboard"!==e,this._changeDetectorRef.detectChanges()}),this._dir&&(this._dirChangeSubscription=this._dir.change.subscribe(()=>{this._changeDetectorRef.markForCheck()}))}ngOnDestroy(){const e=this._elementRef.nativeElement;e.removeEventListener("mousedown",this._pointerDown,Jd),e.removeEventListener("touchstart",this._pointerDown,Jd),this._lastPointerEvent=null,this._removeGlobalEvents(),this._focusMonitor.stopMonitoring(this._elementRef),this._dirChangeSubscription.unsubscribe()}_onMouseenter(){this.disabled||(this._sliderDimensions=this._getSliderDimensions(),this._updateTickIntervalPercent())}_onFocus(){this._sliderDimensions=this._getSliderDimensions(),this._updateTickIntervalPercent()}_onBlur(){this.onTouched()}_onKeydown(e){if(this.disabled||dc(e)||this._isSliding&&"keyboard"!==this._isSliding)return;const n=this.value;switch(e.keyCode){case 33:this._increment(10);break;case 34:this._increment(-10);break;case 35:this.value=this.max;break;case 36:this.value=this.min;break;case 37:this._increment("rtl"==this._getDirection()?1:-1);break;case 38:this._increment(1);break;case 39:this._increment("rtl"==this._getDirection()?-1:1);break;case 40:this._increment(-1);break;default:return}n!=this.value&&(this._emitInputEvent(),this._emitChangeEvent()),this._isSliding="keyboard",e.preventDefault()}_onKeyup(){"keyboard"===this._isSliding&&(this._isSliding=null)}_getWindow(){return this._document.defaultView||window}_bindGlobalEvents(e){const n=this._document,r=ET(e),a=r?"touchend":"mouseup";n.addEventListener(r?"touchmove":"mousemove",this._pointerMove,Jd),n.addEventListener(a,this._pointerUp,Jd),r&&n.addEventListener("touchcancel",this._pointerUp,Jd);const l=this._getWindow();void 0!==l&&l&&l.addEventListener("blur",this._windowBlur)}_removeGlobalEvents(){const e=this._document;e.removeEventListener("mousemove",this._pointerMove,Jd),e.removeEventListener("mouseup",this._pointerUp,Jd),e.removeEventListener("touchmove",this._pointerMove,Jd),e.removeEventListener("touchend",this._pointerUp,Jd),e.removeEventListener("touchcancel",this._pointerUp,Jd);const n=this._getWindow();void 0!==n&&n&&n.removeEventListener("blur",this._windowBlur)}_increment(e){const n=this._clamp(this.value||0,this.min,this.max);this.value=this._clamp(n+this.step*e,this.min,this.max)}_updateValueFromPosition(e){if(!this._sliderDimensions)return;let a=this._clamp(((this.vertical?e.y:e.x)-(this.vertical?this._sliderDimensions.top:this._sliderDimensions.left))/(this.vertical?this._sliderDimensions.height:this._sliderDimensions.width));if(this._shouldInvertMouseCoords()&&(a=1-a),0===a)this.value=this.min;else if(1===a)this.value=this.max;else{const l=this._calculateValue(a),u=Math.round((l-this.min)/this.step)*this.step+this.min;this.value=this._clamp(u,this.min,this.max)}}_emitChangeEvent(){this._controlValueAccessorChangeFn(this.value),this.valueChange.emit(this.value),this.change.emit(this._createChangeEvent())}_emitInputEvent(){this.input.emit(this._createChangeEvent())}_updateTickIntervalPercent(){if(!this.tickInterval||!this._sliderDimensions)return;let e;if("auto"==this.tickInterval){let n=this.vertical?this._sliderDimensions.height:this._sliderDimensions.width;e=Math.ceil(30/(n*this.step/(this.max-this.min)))*this.step/n}else e=this.tickInterval*this.step/(this.max-this.min);this._tickIntervalPercent=Yq(e)?e:0}_createChangeEvent(e=this.value){let n=new eye;return n.source=this,n.value=e,n}_calculatePercentage(e){const n=((e||0)-this.min)/(this.max-this.min);return Yq(n)?n:0}_calculateValue(e){return this.min+e*(this.max-this.min)}_clamp(e,n=0,r=1){return Math.max(n,Math.min(e,r))}_getSliderDimensions(){return this._sliderWrapper?this._sliderWrapper.nativeElement.getBoundingClientRect():null}_focusHostElement(e){this._elementRef.nativeElement.focus(e)}_blurHostElement(){this._elementRef.nativeElement.blur()}writeValue(e){this.value=e}registerOnChange(e){this._controlValueAccessorChangeFn=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this.disabled=e}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(ch),B(Pn),B(Ia,8),zc("tabindex"),B(Rn),B(ar),B(ga,8))},i.\u0275cmp=ei({type:i,selectors:[["mat-slider"]],viewQuery:function(e,n){if(1&e&&ji(Z_e,5),2&e){let r;jt(r=qt())&&(n._sliderWrapper=r.first)}},hostAttrs:["role","slider",1,"mat-slider","mat-focus-indicator"],hostVars:29,hostBindings:function(e,n){1&e&&je("focus",function(){return n._onFocus()})("blur",function(){return n._onBlur()})("keydown",function(s){return n._onKeydown(s)})("keyup",function(){return n._onKeyup()})("mouseenter",function(){return n._onMouseenter()})("selectstart",function(s){return s.preventDefault()}),2&e&&(dn("tabIndex",n.tabIndex),Vi("aria-disabled",n.disabled)("aria-valuemax",n.max)("aria-valuemin",n.min)("aria-valuenow",n.value)("aria-valuetext",null==n.valueText?n.displayValue:n.valueText)("aria-orientation",n.vertical?"vertical":"horizontal"),N("mat-slider-disabled",n.disabled)("mat-slider-has-ticks",n.tickInterval)("mat-slider-horizontal",!n.vertical)("mat-slider-axis-inverted",n._shouldInvertAxis())("mat-slider-invert-mouse-coords",n._shouldInvertMouseCoords())("mat-slider-sliding",n._isSliding)("mat-slider-thumb-label-showing",n.thumbLabel)("mat-slider-vertical",n.vertical)("mat-slider-min-value",n._isMinValue())("mat-slider-hide-last-tick",n.disabled||n._isMinValue()&&n._getThumbGap()&&n._shouldInvertAxis())("_mat-animation-noopable","NoopAnimations"===n._animationMode))},inputs:{disabled:"disabled",color:"color",tabIndex:"tabIndex",invert:"invert",max:"max",min:"min",step:"step",thumbLabel:"thumbLabel",tickInterval:"tickInterval",value:"value",displayWith:"displayWith",valueText:"valueText",vertical:"vertical"},outputs:{change:"change",input:"input",valueChange:"valueChange"},exportAs:["matSlider"],features:[Sn([$_e]),It],decls:13,vars:6,consts:[[1,"mat-slider-wrapper"],["sliderWrapper",""],[1,"mat-slider-track-wrapper"],[1,"mat-slider-track-background",3,"ngStyle"],[1,"mat-slider-track-fill",3,"ngStyle"],[1,"mat-slider-ticks-container",3,"ngStyle"],[1,"mat-slider-ticks",3,"ngStyle"],[1,"mat-slider-thumb-container",3,"ngStyle"],[1,"mat-slider-focus-ring"],[1,"mat-slider-thumb"],[1,"mat-slider-thumb-label"],[1,"mat-slider-thumb-label-text"]],template:function(e,n){1&e&&(Z(0,"div",0,1)(2,"div",2),yt(3,"div",3)(4,"div",4),J(),Z(5,"div",5),yt(6,"div",6),J(),Z(7,"div",7),yt(8,"div",8)(9,"div",9),Z(10,"div",10)(11,"span",11),ue(12),J()()()()),2&e&&(se(3),fe("ngStyle",n._getTrackBackgroundStyles()),se(1),fe("ngStyle",n._getTrackFillStyles()),se(1),fe("ngStyle",n._getTicksContainerStyles()),se(1),fe("ngStyle",n._getTicksStyles()),se(1),fe("ngStyle",n._getThumbContainerStyles()),se(5),Xt(n.displayValue))},directives:[Rw],styles:['.mat-slider{display:inline-block;position:relative;box-sizing:border-box;padding:8px;outline:none;vertical-align:middle}.mat-slider:not(.mat-slider-disabled):active,.mat-slider.mat-slider-sliding:not(.mat-slider-disabled){cursor:grabbing}.mat-slider-wrapper{-webkit-print-color-adjust:exact;color-adjust:exact;position:absolute}.mat-slider-track-wrapper{position:absolute;top:0;left:0;overflow:hidden}.mat-slider-track-fill{position:absolute;transform-origin:0 0;transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1),background-color 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-slider-track-background{position:absolute;transform-origin:100% 100%;transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1),background-color 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-slider-ticks-container{position:absolute;left:0;top:0;overflow:hidden}.mat-slider-ticks{-webkit-background-clip:content-box;background-clip:content-box;background-repeat:repeat;box-sizing:border-box;opacity:0;transition:opacity 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-slider-thumb-container{position:absolute;z-index:1;transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-slider-focus-ring{position:absolute;width:30px;height:30px;border-radius:50%;transform:scale(0);opacity:0;transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1),background-color 400ms cubic-bezier(0.25, 0.8, 0.25, 1),opacity 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-slider.cdk-keyboard-focused .mat-slider-focus-ring,.mat-slider.cdk-program-focused .mat-slider-focus-ring{transform:scale(1);opacity:1}.mat-slider:not(.mat-slider-disabled):not(.mat-slider-sliding) .mat-slider-thumb-label,.mat-slider:not(.mat-slider-disabled):not(.mat-slider-sliding) .mat-slider-thumb{cursor:grab}.mat-slider-thumb{position:absolute;right:-10px;bottom:-10px;box-sizing:border-box;width:20px;height:20px;border:3px solid transparent;border-radius:50%;transform:scale(0.7);transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1),background-color 400ms cubic-bezier(0.25, 0.8, 0.25, 1),border-color 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-slider-thumb-label{display:none;align-items:center;justify-content:center;position:absolute;width:28px;height:28px;border-radius:50%;transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1),border-radius 400ms cubic-bezier(0.25, 0.8, 0.25, 1),background-color 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.cdk-high-contrast-active .mat-slider-thumb-label{outline:solid 1px}.mat-slider-thumb-label-text{z-index:1;opacity:0;transition:opacity 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-slider-sliding .mat-slider-track-fill,.mat-slider-sliding .mat-slider-track-background,.mat-slider-sliding .mat-slider-thumb-container{transition-duration:0ms}.mat-slider-has-ticks .mat-slider-wrapper::after{content:"";position:absolute;border-width:0;border-style:solid;opacity:0;transition:opacity 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-slider-has-ticks.cdk-focused:not(.mat-slider-hide-last-tick) .mat-slider-wrapper::after,.mat-slider-has-ticks:hover:not(.mat-slider-hide-last-tick) .mat-slider-wrapper::after{opacity:1}.mat-slider-has-ticks.cdk-focused:not(.mat-slider-disabled) .mat-slider-ticks,.mat-slider-has-ticks:hover:not(.mat-slider-disabled) .mat-slider-ticks{opacity:1}.mat-slider-thumb-label-showing .mat-slider-focus-ring{display:none}.mat-slider-thumb-label-showing .mat-slider-thumb-label{display:flex}.mat-slider-axis-inverted .mat-slider-track-fill{transform-origin:100% 100%}.mat-slider-axis-inverted .mat-slider-track-background{transform-origin:0 0}.mat-slider:not(.mat-slider-disabled).cdk-focused.mat-slider-thumb-label-showing .mat-slider-thumb{transform:scale(0)}.mat-slider:not(.mat-slider-disabled).cdk-focused .mat-slider-thumb-label{border-radius:50% 50% 0}.mat-slider:not(.mat-slider-disabled).cdk-focused .mat-slider-thumb-label-text{opacity:1}.mat-slider:not(.mat-slider-disabled).cdk-mouse-focused .mat-slider-thumb,.mat-slider:not(.mat-slider-disabled).cdk-touch-focused .mat-slider-thumb,.mat-slider:not(.mat-slider-disabled).cdk-program-focused .mat-slider-thumb{border-width:2px;transform:scale(1)}.mat-slider-disabled .mat-slider-focus-ring{transform:scale(0);opacity:0}.mat-slider-disabled .mat-slider-thumb{border-width:4px;transform:scale(0.5)}.mat-slider-disabled .mat-slider-thumb-label{display:none}.mat-slider-horizontal{height:48px;min-width:128px}.mat-slider-horizontal .mat-slider-wrapper{height:2px;top:23px;left:8px;right:8px}.mat-slider-horizontal .mat-slider-wrapper::after{height:2px;border-left-width:2px;right:0;top:0}.mat-slider-horizontal .mat-slider-track-wrapper{height:2px;width:100%}.mat-slider-horizontal .mat-slider-track-fill{height:2px;width:100%;transform:scaleX(0)}.mat-slider-horizontal .mat-slider-track-background{height:2px;width:100%;transform:scaleX(1)}.mat-slider-horizontal .mat-slider-ticks-container{height:2px;width:100%}.cdk-high-contrast-active .mat-slider-horizontal .mat-slider-ticks-container{height:0;outline:solid 2px;top:1px}.mat-slider-horizontal .mat-slider-ticks{height:2px;width:100%}.mat-slider-horizontal .mat-slider-thumb-container{width:100%;height:0;top:50%}.mat-slider-horizontal .mat-slider-focus-ring{top:-15px;right:-15px}.mat-slider-horizontal .mat-slider-thumb-label{right:-14px;top:-40px;transform:translateY(26px) scale(0.01) rotate(45deg)}.mat-slider-horizontal .mat-slider-thumb-label-text{transform:rotate(-45deg)}.mat-slider-horizontal.cdk-focused .mat-slider-thumb-label{transform:rotate(45deg)}.cdk-high-contrast-active .mat-slider-horizontal.cdk-focused .mat-slider-thumb-label,.cdk-high-contrast-active .mat-slider-horizontal.cdk-focused .mat-slider-thumb-label-text{transform:none}.mat-slider-vertical{width:48px;min-height:128px}.mat-slider-vertical .mat-slider-wrapper{width:2px;top:8px;bottom:8px;left:23px}.mat-slider-vertical .mat-slider-wrapper::after{width:2px;border-top-width:2px;bottom:0;left:0}.mat-slider-vertical .mat-slider-track-wrapper{height:100%;width:2px}.mat-slider-vertical .mat-slider-track-fill{height:100%;width:2px;transform:scaleY(0)}.mat-slider-vertical .mat-slider-track-background{height:100%;width:2px;transform:scaleY(1)}.mat-slider-vertical .mat-slider-ticks-container{width:2px;height:100%}.cdk-high-contrast-active .mat-slider-vertical .mat-slider-ticks-container{width:0;outline:solid 2px;left:1px}.mat-slider-vertical .mat-slider-focus-ring{bottom:-15px;left:-15px}.mat-slider-vertical .mat-slider-ticks{width:2px;height:100%}.mat-slider-vertical .mat-slider-thumb-container{height:100%;width:0;left:50%}.mat-slider-vertical .mat-slider-thumb{-webkit-backface-visibility:hidden;backface-visibility:hidden}.mat-slider-vertical .mat-slider-thumb-label{bottom:-14px;left:-40px;transform:translateX(26px) scale(0.01) rotate(-45deg)}.mat-slider-vertical .mat-slider-thumb-label-text{transform:rotate(45deg)}.mat-slider-vertical.cdk-focused .mat-slider-thumb-label{transform:rotate(-45deg)}[dir=rtl] .mat-slider-wrapper::after{left:0;right:auto}[dir=rtl] .mat-slider-horizontal .mat-slider-track-fill{transform-origin:100% 100%}[dir=rtl] .mat-slider-horizontal .mat-slider-track-background{transform-origin:0 0}[dir=rtl] .mat-slider-horizontal.mat-slider-axis-inverted .mat-slider-track-fill{transform-origin:0 0}[dir=rtl] .mat-slider-horizontal.mat-slider-axis-inverted .mat-slider-track-background{transform-origin:100% 100%}.mat-slider._mat-animation-noopable .mat-slider-track-fill,.mat-slider._mat-animation-noopable .mat-slider-track-background,.mat-slider._mat-animation-noopable .mat-slider-ticks,.mat-slider._mat-animation-noopable .mat-slider-thumb-container,.mat-slider._mat-animation-noopable .mat-slider-focus-ring,.mat-slider._mat-animation-noopable .mat-slider-thumb,.mat-slider._mat-animation-noopable .mat-slider-thumb-label,.mat-slider._mat-animation-noopable .mat-slider-thumb-label-text,.mat-slider._mat-animation-noopable .mat-slider-has-ticks .mat-slider-wrapper::after{transition:none}\n'],encapsulation:2,changeDetection:0}),i})();function Yq(i){return!isNaN(i)&&isFinite(i)}function ET(i){return"t"===i.type[0]}function Kq(i,t){let e;return e=ET(i)?"number"==typeof t?lV(i.touches,t)||lV(i.changedTouches,t):i.touches[0]||i.changedTouches[0]:i,e?{x:e.clientX,y:e.clientY}:void 0}function lV(i,t){for(let e=0;e<i.length;e++)if(i[e].identifier===t)return i[e]}let Qq=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[ka,jn],jn]}),i})();class BP{constructor(t,e){this.x=t,this.y=e}static drawCircle(t,e){t.beginPath(),t.arc(e.x,e.y,t.lineWidth/2,0,2*Math.PI),t.lineJoin="round",t.closePath(),t.fill()}static drawLine(t,e,n){t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(n.x,n.y),t.lineJoin="round",t.closePath(),t.stroke()}distance(t){return Math.sqrt(Math.pow(t.x-this.x,2)+Math.pow(t.y-this.y,2))}draw(t){t.beginPath(),t.arc(this.x,this.y,t.lineWidth/2,0,2*Math.PI),t.lineJoin="round",t.closePath(),t.fill()}append(t){return!1}}const nye=["sketch"];let cV=(()=>{class i{constructor(){this.width=400,this.height=400,this.paint=!1,this.last=null,this.current=null}ngOnInit(){this.context=this.canvas.nativeElement.getContext("2d")}onMousedown(e){this.paint=!0,this.current=new BP(e.offsetX,e.offsetY),BP.drawCircle(this.context,this.current),this.last=this.current}onMouseup(e){this.paint=!1}onMouseLeave(e){this.paint=!1}onMousemove(e){this.paint&&e.target===this.canvas.nativeElement&&(this.current=new BP(e.offsetX,e.offsetY),null!==this.last&&BP.drawLine(this.context,this.last,this.current),this.last=this.current)}onCanvasDragOver(e){e.preventDefault()}onCanvasDropped(e){e.preventDefault(),e.stopPropagation(),e.dataTransfer.files.length>0&&this.setImageBase64(URL.createObjectURL(e.dataTransfer.files.item(0)))}onResize(e){}clearCanvas(){this.context.clearRect(0,0,this.context.canvas.width,this.context.canvas.height)}getImage(){return this.context.getImageData(0,0,this.width,this.height)}getImageBase64(){return this.context.canvas.toDataURL("image/png")}setImageBase64(e){const n=new Image;n.src=e,n.onload=function(){this.context.drawImage(n,0,0,this.context.canvas.width,this.context.canvas.height)}.bind(this)}setActiveColor(e){this.context.strokeStyle=e,this.context.fillStyle=e}setLineSize(e){e>0&&(this.context.lineWidth=e)}fillCanvas(){this.context.beginPath(),this.context.rect(0,0,this.context.canvas.width,this.context.canvas.height),this.context.fill()}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=ei({type:i,selectors:[["app-sketch-canvas"]],viewQuery:function(e,n){if(1&e&&ji(nye,7),2&e){let r;jt(r=qt())&&(n.canvas=r.first)}},hostBindings:function(e,n){1&e&&je("resize",function(s){return n.onResize(s)},!1,Ex)},inputs:{width:"width",height:"height"},decls:2,vars:2,consts:[[2,"display","block","border","solid 1px","background-image","url('assets/images/transparent.png')",3,"width","height","mousedown","mouseup","mouseleave","mousemove","drop","dragover"],["sketch",""]],template:function(e,n){1&e&&(Z(0,"canvas",0,1),je("mousedown",function(s){return n.onMousedown(s)})("mouseup",function(s){return n.onMouseup(s)})("mouseleave",function(s){return n.onMouseLeave(s)})("mousemove",function(s){return n.onMousemove(s)})("drop",function(s){return n.onCanvasDropped(s)})("dragover",function(s){return n.onCanvasDragOver(s)}),J()),2&e&&(_o("width",n.width),_o("height",n.height))},encapsulation:2}),i})();const rye=["dialogPopup"],sye=["hueSlider"],oye=["alphaSlider"];function aye(i,t){if(1&i&&yt(0,"div"),2&i){const e=Re();Nr("arrow arrow-",e.cpUsePosition,""),A("top",e.arrowTop,"px")}}function lye(i,t){if(1&i){const e=Wi();Z(0,"div",26),je("newValue",function(r){return gt(e),Re().onColorChange(r)})("dragStart",function(){return gt(e),Re().onDragStart("saturation-lightness")})("dragEnd",function(){return gt(e),Re().onDragEnd("saturation-lightness")}),yt(1,"div",13),J()}if(2&i){const e=Re();A("background-color",e.hueSliderColor),fe("rgX",1)("rgY",1),se(1),A("top",null==e.slider?null:e.slider.v,"px")("left",null==e.slider?null:e.slider.s,"px")}}function cye(i,t){if(1&i){const e=Wi();Z(0,"button",27),je("click",function(r){gt(e);const s=Re();return s.onAddPresetColor(r,s.selectedColor)}),ue(1),J()}if(2&i){const e=Re();Y(e.cpAddColorButtonClass),fe("disabled",e.cpPresetColors&&e.cpPresetColors.length>=e.cpMaxPresetColorsLength),se(1),ui(" ",e.cpAddColorButtonText," ")}}function uye(i,t){1&i&&yt(0,"div",28)}function hye(i,t){if(1&i){const e=Wi();Z(0,"input",34),je("keyup.enter",function(r){return gt(e),Re(2).onAcceptColor(r)})("newValue",function(r){return gt(e),Re(2).onAlphaInput(r)}),J()}if(2&i){const e=Re(2);fe("rg",1)("value",null==e.cmykText?null:e.cmykText.a)}}function dye(i,t){1&i&&(Z(0,"div"),ue(1,"A"),J())}function fye(i,t){if(1&i){const e=Wi();Z(0,"div",29)(1,"div",30)(2,"input",31),je("keyup.enter",function(r){return gt(e),Re().onAcceptColor(r)})("newValue",function(r){return gt(e),Re().onCyanInput(r)}),J(),Z(3,"input",31),je("keyup.enter",function(r){return gt(e),Re().onAcceptColor(r)})("newValue",function(r){return gt(e),Re().onMagentaInput(r)}),J(),Z(4,"input",31),je("keyup.enter",function(r){return gt(e),Re().onAcceptColor(r)})("newValue",function(r){return gt(e),Re().onYellowInput(r)}),J(),Z(5,"input",31),je("keyup.enter",function(r){return gt(e),Re().onAcceptColor(r)})("newValue",function(r){return gt(e),Re().onBlackInput(r)}),J(),Ue(6,hye,1,2,"input",32),J(),Z(7,"div",30)(8,"div"),ue(9,"C"),J(),Z(10,"div"),ue(11,"M"),J(),Z(12,"div"),ue(13,"Y"),J(),Z(14,"div"),ue(15,"K"),J(),Ue(16,dye,2,0,"div",33),J()()}if(2&i){const e=Re();A("display",3!==e.format?"none":"block"),se(2),fe("rg",100)("value",null==e.cmykText?null:e.cmykText.c),se(1),fe("rg",100)("value",null==e.cmykText?null:e.cmykText.m),se(1),fe("rg",100)("value",null==e.cmykText?null:e.cmykText.y),se(1),fe("rg",100)("value",null==e.cmykText?null:e.cmykText.k),se(1),fe("ngIf","disabled"!==e.cpAlphaChannel),se(10),fe("ngIf","disabled"!==e.cpAlphaChannel)}}function pye(i,t){if(1&i){const e=Wi();Z(0,"input",34),je("keyup.enter",function(r){return gt(e),Re(2).onAcceptColor(r)})("newValue",function(r){return gt(e),Re(2).onAlphaInput(r)}),J()}if(2&i){const e=Re(2);fe("rg",1)("value",null==e.hslaText?null:e.hslaText.a)}}function mye(i,t){1&i&&(Z(0,"div"),ue(1,"A"),J())}function gye(i,t){if(1&i){const e=Wi();Z(0,"div",35)(1,"div",30)(2,"input",36),je("keyup.enter",function(r){return gt(e),Re().onAcceptColor(r)})("newValue",function(r){return gt(e),Re().onHueInput(r)}),J(),Z(3,"input",31),je("keyup.enter",function(r){return gt(e),Re().onAcceptColor(r)})("newValue",function(r){return gt(e),Re().onSaturationInput(r)}),J(),Z(4,"input",31),je("keyup.enter",function(r){return gt(e),Re().onAcceptColor(r)})("newValue",function(r){return gt(e),Re().onLightnessInput(r)}),J(),Ue(5,pye,1,2,"input",32),J(),Z(6,"div",30)(7,"div"),ue(8,"H"),J(),Z(9,"div"),ue(10,"S"),J(),Z(11,"div"),ue(12,"L"),J(),Ue(13,mye,2,0,"div",33),J()()}if(2&i){const e=Re();A("display",2!==e.format?"none":"block"),se(2),fe("rg",360)("value",null==e.hslaText?null:e.hslaText.h),se(1),fe("rg",100)("value",null==e.hslaText?null:e.hslaText.s),se(1),fe("rg",100)("value",null==e.hslaText?null:e.hslaText.l),se(1),fe("ngIf","disabled"!==e.cpAlphaChannel),se(8),fe("ngIf","disabled"!==e.cpAlphaChannel)}}function _ye(i,t){if(1&i){const e=Wi();Z(0,"input",34),je("keyup.enter",function(r){return gt(e),Re(2).onAcceptColor(r)})("newValue",function(r){return gt(e),Re(2).onAlphaInput(r)}),J()}if(2&i){const e=Re(2);fe("rg",1)("value",null==e.rgbaText?null:e.rgbaText.a)}}function yye(i,t){1&i&&(Z(0,"div"),ue(1,"A"),J())}function vye(i,t){if(1&i){const e=Wi();Z(0,"div",37)(1,"div",30)(2,"input",38),je("keyup.enter",function(r){return gt(e),Re().onAcceptColor(r)})("newValue",function(r){return gt(e),Re().onRedInput(r)}),J(),Z(3,"input",38),je("keyup.enter",function(r){return gt(e),Re().onAcceptColor(r)})("newValue",function(r){return gt(e),Re().onGreenInput(r)}),J(),Z(4,"input",38),je("keyup.enter",function(r){return gt(e),Re().onAcceptColor(r)})("newValue",function(r){return gt(e),Re().onBlueInput(r)}),J(),Ue(5,_ye,1,2,"input",32),J(),Z(6,"div",30)(7,"div"),ue(8,"R"),J(),Z(9,"div"),ue(10,"G"),J(),Z(11,"div"),ue(12,"B"),J(),Ue(13,yye,2,0,"div",33),J()()}if(2&i){const e=Re();A("display",1!==e.format?"none":"block"),se(2),fe("rg",255)("value",null==e.rgbaText?null:e.rgbaText.r),se(1),fe("rg",255)("value",null==e.rgbaText?null:e.rgbaText.g),se(1),fe("rg",255)("value",null==e.rgbaText?null:e.rgbaText.b),se(1),fe("ngIf","disabled"!==e.cpAlphaChannel),se(8),fe("ngIf","disabled"!==e.cpAlphaChannel)}}function bye(i,t){if(1&i){const e=Wi();Z(0,"input",34),je("keyup.enter",function(r){return gt(e),Re(2).onAcceptColor(r)})("newValue",function(r){return gt(e),Re(2).onAlphaInput(r)}),J()}if(2&i){const e=Re(2);fe("rg",1)("value",e.hexAlpha)}}function xye(i,t){1&i&&(Z(0,"div"),ue(1,"A"),J())}function wye(i,t){if(1&i){const e=Wi();Z(0,"div",39)(1,"div",30)(2,"input",40),je("blur",function(){return gt(e),Re().onHexInput(null)})("keyup.enter",function(r){return gt(e),Re().onAcceptColor(r)})("newValue",function(r){return gt(e),Re().onHexInput(r)}),J(),Ue(3,bye,1,2,"input",32),J(),Z(4,"div",30)(5,"div"),ue(6,"Hex"),J(),Ue(7,xye,2,0,"div",33),J()()}if(2&i){const e=Re();A("display",0!==e.format?"none":"block"),N("hex-alpha","forced"===e.cpAlphaChannel),se(2),fe("value",e.hexText),se(1),fe("ngIf","forced"===e.cpAlphaChannel),se(4),fe("ngIf","forced"===e.cpAlphaChannel)}}function Sye(i,t){if(1&i){const e=Wi();Z(0,"input",34),je("keyup.enter",function(r){return gt(e),Re(2).onAcceptColor(r)})("newValue",function(r){return gt(e),Re(2).onAlphaInput(r)}),J()}if(2&i){const e=Re(2);fe("rg",1)("value",null==e.hslaText?null:e.hslaText.a)}}function Cye(i,t){if(1&i){const e=Wi();Z(0,"div",41)(1,"div",30)(2,"input",31),je("keyup.enter",function(r){return gt(e),Re().onAcceptColor(r)})("newValue",function(r){return gt(e),Re().onValueInput(r)}),J(),Ue(3,Sye,1,2,"input",32),J(),Z(4,"div",30)(5,"div"),ue(6,"V"),J(),Z(7,"div"),ue(8,"A"),J()()()}if(2&i){const e=Re();se(2),fe("rg",100)("value",null==e.hslaText?null:e.hslaText.l),se(1),fe("ngIf","disabled"!==e.cpAlphaChannel)}}function Mye(i,t){if(1&i){const e=Wi();Z(0,"div",42)(1,"span",43),je("click",function(){return gt(e),Re().onFormatToggle(-1)}),J(),Z(2,"span",43),je("click",function(){return gt(e),Re().onFormatToggle(1)}),J()()}}function Tye(i,t){if(1&i){const e=Wi();Z(0,"span",50),je("click",function(r){gt(e);const s=Re().$implicit;return Re(3).onRemovePresetColor(r,s)}),J()}2&i&&Y(Re(4).cpRemoveColorButtonClass)}function Eye(i,t){if(1&i){const e=Wi();Z(0,"div",48),je("click",function(){const s=gt(e).$implicit;return Re(3).setColorFromString(s)}),Ue(1,Tye,1,3,"span",49),J()}if(2&i){const e=t.$implicit,n=Re(3);A("background-color",e),se(1),fe("ngIf",n.cpAddColorButton)}}function Aye(i,t){if(1&i&&(Z(0,"div"),Ue(1,Eye,2,3,"div",47),J()),2&i){const e=Re(2);Y(e.cpPresetColorsClass),se(1),fe("ngForOf",e.cpPresetColors)}}function Dye(i,t){if(1&i&&(Z(0,"div"),ue(1),J()),2&i){const e=Re(2);Y(e.cpPresetEmptyMessageClass),se(1),Xt(e.cpPresetEmptyMessage)}}function Rye(i,t){if(1&i&&(Z(0,"div",44),yt(1,"hr"),Z(2,"div",45),ue(3),J(),Ue(4,Aye,2,4,"div",46),Ue(5,Dye,2,4,"div",46),J()),2&i){const e=Re();se(3),Xt(e.cpPresetLabel),se(1),fe("ngIf",null==e.cpPresetColors?null:e.cpPresetColors.length),se(1),fe("ngIf",!(null!=e.cpPresetColors&&e.cpPresetColors.length)&&e.cpAddColorButton)}}function kye(i,t){if(1&i){const e=Wi();Z(0,"button",53),je("click",function(r){return gt(e),Re(2).onCancelColor(r)}),ue(1),J()}if(2&i){const e=Re(2);Y(e.cpCancelButtonClass),se(1),Xt(e.cpCancelButtonText)}}function Pye(i,t){if(1&i){const e=Wi();Z(0,"button",53),je("click",function(r){return gt(e),Re(2).onAcceptColor(r)}),ue(1),J()}if(2&i){const e=Re(2);Y(e.cpOKButtonClass),se(1),Xt(e.cpOKButtonText)}}function Iye(i,t){if(1&i&&(Z(0,"div",51),Ue(1,kye,2,4,"button",52),Ue(2,Pye,2,4,"button",52),J()),2&i){const e=Re();se(1),fe("ngIf",e.cpCancelButton),se(1),fe("ngIf",e.cpOKButton)}}var ou=(()=>{return(i=ou||(ou={}))[i.HEX=0]="HEX",i[i.RGBA=1]="RGBA",i[i.HSLA=2]="HSLA",i[i.CMYK=3]="CMYK",ou;var i})();class dg{constructor(t,e,n,r){this.r=t,this.g=e,this.b=n,this.a=r}}class NP{constructor(t,e,n,r){this.h=t,this.s=e,this.v=n,this.a=r}}class a0{constructor(t,e,n,r){this.h=t,this.s=e,this.l=n,this.a=r}}class AT{constructor(t,e,n,r,s=1){this.c=t,this.m=e,this.y=n,this.k=r,this.a=s}}let Fye=(()=>{class i{constructor(){this.newValue=new Si}inputChange(e){const n=e.target.value;if(void 0===this.rg)this.newValue.emit(n);else{const r=parseFloat(n);this.newValue.emit({v:r,rg:this.rg})}}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275dir=Be({type:i,selectors:[["","text",""]],hostBindings:function(e,n){1&e&&je("input",function(s){return n.inputChange(s)})},inputs:{rg:"rg",text:"text"},outputs:{newValue:"newValue"}}),i})(),Bye=(()=>{class i{constructor(e){this.elRef=e,this.dragEnd=new Si,this.dragStart=new Si,this.newValue=new Si,this.listenerMove=n=>this.move(n),this.listenerStop=()=>this.stop()}mouseDown(e){this.start(e)}touchStart(e){this.start(e)}move(e){e.preventDefault(),this.setCursor(e)}start(e){this.setCursor(e),e.stopPropagation(),document.addEventListener("mouseup",this.listenerStop),document.addEventListener("touchend",this.listenerStop),document.addEventListener("mousemove",this.listenerMove),document.addEventListener("touchmove",this.listenerMove),this.dragStart.emit()}stop(){document.removeEventListener("mouseup",this.listenerStop),document.removeEventListener("touchend",this.listenerStop),document.removeEventListener("mousemove",this.listenerMove),document.removeEventListener("touchmove",this.listenerMove),this.dragEnd.emit()}getX(e){const n=this.elRef.nativeElement.getBoundingClientRect();return(void 0!==e.pageX?e.pageX:e.touches[0].pageX)-n.left-window.pageXOffset}getY(e){const n=this.elRef.nativeElement.getBoundingClientRect();return(void 0!==e.pageY?e.pageY:e.touches[0].pageY)-n.top-window.pageYOffset}setCursor(e){const n=this.elRef.nativeElement.offsetWidth,r=this.elRef.nativeElement.offsetHeight,s=Math.max(0,Math.min(this.getX(e),n)),a=Math.max(0,Math.min(this.getY(e),r));void 0!==this.rgX&&void 0!==this.rgY?this.newValue.emit({s:s/n,v:1-a/r,rgX:this.rgX,rgY:this.rgY}):void 0===this.rgX&&void 0!==this.rgY?this.newValue.emit({v:a/r,rgY:this.rgY}):void 0!==this.rgX&&void 0===this.rgY&&this.newValue.emit({v:s/n,rgX:this.rgX})}}return i.\u0275fac=function(e){return new(e||i)(B(ai))},i.\u0275dir=Be({type:i,selectors:[["","slider",""]],hostBindings:function(e,n){1&e&&je("mousedown",function(s){return n.mouseDown(s)})("touchstart",function(s){return n.touchStart(s)})},inputs:{rgX:"rgX",rgY:"rgY",slider:"slider"},outputs:{dragEnd:"dragEnd",dragStart:"dragStart",newValue:"newValue"}}),i})();class Jq{constructor(t,e,n,r){this.h=t,this.s=e,this.v=n,this.a=r}}class $q{constructor(t,e,n,r){this.h=t,this.s=e,this.v=n,this.a=r}}let uV=(()=>{class i{constructor(){this.active=null}setActive(e){this.active&&this.active!==e&&"inline"!==this.active.cpDialogDisplay&&this.active.closeDialog(),this.active=e}hsva2hsla(e){const n=e.h,r=e.s,s=e.v,a=e.a;if(0===s)return new a0(n,0,0,a);if(0===r&&1===s)return new a0(n,1,1,a);{const l=s*(2-r)/2;return new a0(n,s*r/(1-Math.abs(2*l-1)),l,a)}}hsla2hsva(e){const n=Math.min(e.h,1),r=Math.min(e.s,1),s=Math.min(e.l,1),a=Math.min(e.a,1);if(0===s)return new NP(n,0,0,a);{const l=s+r*(1-Math.abs(2*s-1))/2;return new NP(n,2*(l-s)/l,l,a)}}hsvaToRgba(e){let n,r,s;const a=e.h,l=e.s,u=e.v,h=e.a,m=Math.floor(6*a),_=6*a-m,v=u*(1-l),S=u*(1-_*l),T=u*(1-(1-_)*l);switch(m%6){case 0:n=u,r=T,s=v;break;case 1:n=S,r=u,s=v;break;case 2:n=v,r=u,s=T;break;case 3:n=v,r=S,s=u;break;case 4:n=T,r=v,s=u;break;case 5:n=u,r=v,s=S;break;default:n=0,r=0,s=0}return new dg(n,r,s,h)}cmykToRgb(e){return new dg((1-e.c)*(1-e.k),(1-e.m)*(1-e.k),(1-e.y)*(1-e.k),e.a)}rgbaToCmyk(e){const n=1-Math.max(e.r,e.g,e.b);return 1===n?new AT(0,0,0,1,e.a):new AT((1-e.r-n)/(1-n),(1-e.g-n)/(1-n),(1-e.b-n)/(1-n),n,e.a)}rgbaToHsva(e){let n,r;const s=Math.min(e.r,1),a=Math.min(e.g,1),l=Math.min(e.b,1),u=Math.min(e.a,1),h=Math.max(s,a,l),m=Math.min(s,a,l),_=h,v=h-m;if(r=0===h?0:v/h,h===m)n=0;else{switch(h){case s:n=(a-l)/v+(a<l?6:0);break;case a:n=(l-s)/v+2;break;case l:n=(s-a)/v+4;break;default:n=0}n/=6}return new NP(n,r,_,u)}rgbaToHex(e,n){let r="#"+(16777216|e.r<<16|e.g<<8|e.b).toString(16).substr(1);return n&&(r+=(256|Math.round(255*e.a)).toString(16).substr(1)),r}normalizeCMYK(e){return new AT(e.c/100,e.m/100,e.y/100,e.k/100,e.a)}denormalizeCMYK(e){return new AT(Math.floor(100*e.c),Math.floor(100*e.m),Math.floor(100*e.y),Math.floor(100*e.k),e.a)}denormalizeRGBA(e){return new dg(Math.round(255*e.r),Math.round(255*e.g),Math.round(255*e.b),e.a)}stringToHsva(e="",n=!1){let r=null;e=(e||"").toLowerCase();const s=[{re:/(rgb)a?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*%?,\s*(\d{1,3})\s*%?(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(a){return new dg(parseInt(a[2],10)/255,parseInt(a[3],10)/255,parseInt(a[4],10)/255,isNaN(parseFloat(a[5]))?1:parseFloat(a[5]))}},{re:/(hsl)a?\(\s*(\d{1,3})\s*,\s*(\d{1,3})%\s*,\s*(\d{1,3})%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(a){return new a0(parseInt(a[2],10)/360,parseInt(a[3],10)/100,parseInt(a[4],10)/100,isNaN(parseFloat(a[5]))?1:parseFloat(a[5]))}}];s.push(n?{re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})?$/,parse:function(a){return new dg(parseInt(a[1],16)/255,parseInt(a[2],16)/255,parseInt(a[3],16)/255,parseInt(a[4]||"FF",16)/255)}}:{re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/,parse:function(a){return new dg(parseInt(a[1],16)/255,parseInt(a[2],16)/255,parseInt(a[3],16)/255,1)}}),s.push({re:/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/,parse:function(a){return new dg(parseInt(a[1]+a[1],16)/255,parseInt(a[2]+a[2],16)/255,parseInt(a[3]+a[3],16)/255,1)}});for(const a in s)if(s.hasOwnProperty(a)){const l=s[a],u=l.re.exec(e),h=u&&l.parse(u);if(h)return h instanceof dg?r=this.rgbaToHsva(h):h instanceof a0&&(r=this.hsla2hsva(h)),r}return r}outputFormat(e,n,r){switch("auto"===n&&(n=e.a<1?"rgba":"hex"),n){case"hsla":const s=this.hsva2hsla(e),a=new a0(Math.round(360*s.h),Math.round(100*s.s),Math.round(100*s.l),Math.round(100*s.a)/100);return e.a<1||"always"===r?"hsla("+a.h+","+a.s+"%,"+a.l+"%,"+a.a+")":"hsl("+a.h+","+a.s+"%,"+a.l+"%)";case"rgba":const l=this.denormalizeRGBA(this.hsvaToRgba(e));return e.a<1||"always"===r?"rgba("+l.r+","+l.g+","+l.b+","+Math.round(100*l.a)/100+")":"rgb("+l.r+","+l.g+","+l.b+")";default:const u="always"===r||"forced"===r;return this.rgbaToHex(this.denormalizeRGBA(this.hsvaToRgba(e)),u)}}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})(),Nye=(()=>{class i{constructor(e,n,r){this.elRef=e,this.cdRef=n,this.service=r,this.isIE10=!1,this.dialogArrowSize=10,this.dialogArrowOffset=15,this.dialogInputFields=[ou.HEX,ou.RGBA,ou.HSLA,ou.CMYK],this.useRootViewContainer=!1}handleEsc(e){this.show&&"popup"===this.cpDialogDisplay&&this.onCancelColor(e)}handleEnter(e){this.show&&"popup"===this.cpDialogDisplay&&this.onAcceptColor(e)}ngOnInit(){this.slider=new Jq(0,0,0,0),this.sliderDimMax=new $q(this.hueSlider.nativeElement.offsetWidth||140,this.cpWidth,130,this.alphaSlider.nativeElement.offsetWidth||140),this.format=this.cpCmykEnabled?ou.CMYK:"rgba"===this.cpOutputFormat?ou.RGBA:"hsla"===this.cpOutputFormat?ou.HSLA:ou.HEX,this.listenerMouseDown=r=>{this.onMouseDown(r)},this.listenerResize=()=>{this.onResize()},this.openDialog(this.initialColor,!1)}ngOnDestroy(){this.closeDialog()}ngAfterViewInit(){230===this.cpWidth&&"inline"!==this.cpDialogDisplay||(this.sliderDimMax=new $q(this.hueSlider.nativeElement.offsetWidth||140,this.cpWidth,130,this.alphaSlider.nativeElement.offsetWidth||140),this.updateColorPicker(!1),this.cdRef.detectChanges())}openDialog(e,n=!0){this.service.setActive(this),this.width||(this.cpWidth=this.directiveElementRef.nativeElement.offsetWidth),this.height||(this.height=320),this.setInitialColor(e),this.setColorFromString(e,n),this.openColorPicker()}closeDialog(){this.closeColorPicker()}setupDialog(e,n,r,s,a,l,u,h,m,_,v,S,T,I,j,P,E,ie,ee,ce,ye,Ce,Ge,Qe,nt,ge,Je,mt,pt,Pt,et,vt,kt,pi,Ht,ct){this.setInitialColor(r),this.setColorMode(h),this.isIE10=10===function Oye(){let i="";"undefined"!=typeof navigator&&(i=navigator.userAgent.toLowerCase());const t=i.indexOf("msie ");return t>0&&parseInt(i.substring(t+5,i.indexOf(".",t)),10)}(),this.directiveInstance=e,this.directiveElementRef=n,this.cpDisableInput=S,this.cpCmykEnabled=m,this.cpAlphaChannel=_,this.cpOutputFormat=v,this.cpDialogDisplay=l,this.cpIgnoredElements=T,this.cpSaveClickOutside=I,this.cpCloseClickOutside=j,this.useRootViewContainer=P,this.width=this.cpWidth=parseInt(s,10),this.height=this.cpHeight=parseInt(a,10),this.cpPosition=E,this.cpPositionOffset=parseInt(ie,10),this.cpOKButton=ge,this.cpOKButtonText=mt,this.cpOKButtonClass=Je,this.cpCancelButton=pt,this.cpCancelButtonText=et,this.cpCancelButtonClass=Pt,this.fallbackColor=u||"#fff",this.setPresetConfig(ce,ye),this.cpPresetColorsClass=Ce,this.cpMaxPresetColorsLength=Ge,this.cpPresetEmptyMessage=Qe,this.cpPresetEmptyMessageClass=nt,this.cpAddColorButton=vt,this.cpAddColorButtonText=pi,this.cpAddColorButtonClass=kt,this.cpRemoveColorButtonClass=Ht,this.cpTriggerElement=ct,ee||(this.dialogArrowOffset=0),"inline"===l&&(this.dialogArrowSize=0,this.dialogArrowOffset=0),"hex"===v&&"always"!==_&&"forced"!==_&&(this.cpAlphaChannel="disabled")}setColorMode(e){switch(e.toString().toUpperCase()){case"1":case"C":case"COLOR":default:this.cpColorMode=1;break;case"2":case"G":case"GRAYSCALE":this.cpColorMode=2;break;case"3":case"P":case"PRESETS":this.cpColorMode=3}}setInitialColor(e){this.initialColor=e}setPresetConfig(e,n){this.cpPresetLabel=e,this.cpPresetColors=n}setColorFromString(e,n=!0,r=!0){let s;"always"===this.cpAlphaChannel||"forced"===this.cpAlphaChannel?(s=this.service.stringToHsva(e,!0),!s&&!this.hsva&&(s=this.service.stringToHsva(e,!1))):s=this.service.stringToHsva(e,!1),!s&&!this.hsva&&(s=this.service.stringToHsva(this.fallbackColor,!1)),s&&(this.hsva=s,this.sliderH=this.hsva.h,"hex"===this.cpOutputFormat&&"disabled"===this.cpAlphaChannel&&(this.hsva.a=1),this.updateColorPicker(n,r))}onResize(){"fixed"===this.position?this.setDialogPosition():"inline"!==this.cpDialogDisplay&&this.closeColorPicker()}onDragEnd(e){this.directiveInstance.sliderDragEnd({slider:e,color:this.outputColor})}onDragStart(e){this.directiveInstance.sliderDragStart({slider:e,color:this.outputColor})}onMouseDown(e){this.show&&!this.isIE10&&"popup"===this.cpDialogDisplay&&e.target!==this.directiveElementRef.nativeElement&&!this.isDescendant(this.elRef.nativeElement,e.target)&&!this.isDescendant(this.directiveElementRef.nativeElement,e.target)&&0===this.cpIgnoredElements.filter(n=>n===e.target).length&&(this.cpSaveClickOutside?this.directiveInstance.colorSelected(this.outputColor):(this.hsva=null,this.setColorFromString(this.initialColor,!1),this.cpCmykEnabled&&this.directiveInstance.cmykChanged(this.cmykColor),this.directiveInstance.colorChanged(this.initialColor),this.directiveInstance.colorCanceled()),this.cpCloseClickOutside&&this.closeColorPicker())}onAcceptColor(e){e.stopPropagation(),this.outputColor&&this.directiveInstance.colorSelected(this.outputColor),"popup"===this.cpDialogDisplay&&this.closeColorPicker()}onCancelColor(e){this.hsva=null,e.stopPropagation(),this.directiveInstance.colorCanceled(),this.setColorFromString(this.initialColor,!0),"popup"===this.cpDialogDisplay&&(this.cpCmykEnabled&&this.directiveInstance.cmykChanged(this.cmykColor),this.directiveInstance.colorChanged(this.initialColor,!0),this.closeColorPicker())}onFormatToggle(e){const n=this.dialogInputFields.length-(this.cpCmykEnabled?0:1),r=((this.dialogInputFields.indexOf(this.format)+e)%n+n)%n;this.format=this.dialogInputFields[r]}onColorChange(e){this.hsva.s=e.s/e.rgX,this.hsva.v=e.v/e.rgY,this.updateColorPicker(),this.directiveInstance.sliderChanged({slider:"lightness",value:this.hsva.v,color:this.outputColor}),this.directiveInstance.sliderChanged({slider:"saturation",value:this.hsva.s,color:this.outputColor})}onHueChange(e){this.hsva.h=e.v/e.rgX,this.sliderH=this.hsva.h,this.updateColorPicker(),this.directiveInstance.sliderChanged({slider:"hue",value:this.hsva.h,color:this.outputColor})}onValueChange(e){this.hsva.v=e.v/e.rgX,this.updateColorPicker(),this.directiveInstance.sliderChanged({slider:"value",value:this.hsva.v,color:this.outputColor})}onAlphaChange(e){this.hsva.a=e.v/e.rgX,this.updateColorPicker(),this.directiveInstance.sliderChanged({slider:"alpha",value:this.hsva.a,color:this.outputColor})}onHexInput(e){if(null===e)this.updateColorPicker();else{e&&"#"!==e[0]&&(e="#"+e);let n=/^#([a-f0-9]{3}|[a-f0-9]{6})$/gi;"always"===this.cpAlphaChannel&&(n=/^#([a-f0-9]{3}|[a-f0-9]{6}|[a-f0-9]{8})$/gi);const r=n.test(e);r&&(e.length<5&&(e="#"+e.substring(1).split("").map(s=>s+s).join("")),"forced"===this.cpAlphaChannel&&(e+=Math.round(255*this.hsva.a).toString(16)),this.setColorFromString(e,!0,!1)),this.directiveInstance.inputChanged({input:"hex",valid:r,value:e,color:this.outputColor})}}onRedInput(e){const n=this.service.hsvaToRgba(this.hsva),r=!isNaN(e.v)&&e.v>=0&&e.v<=e.rg;r&&(n.r=e.v/e.rg,this.hsva=this.service.rgbaToHsva(n),this.sliderH=this.hsva.h,this.updateColorPicker()),this.directiveInstance.inputChanged({input:"red",valid:r,value:n.r,color:this.outputColor})}onBlueInput(e){const n=this.service.hsvaToRgba(this.hsva),r=!isNaN(e.v)&&e.v>=0&&e.v<=e.rg;r&&(n.b=e.v/e.rg,this.hsva=this.service.rgbaToHsva(n),this.sliderH=this.hsva.h,this.updateColorPicker()),this.directiveInstance.inputChanged({input:"blue",valid:r,value:n.b,color:this.outputColor})}onGreenInput(e){const n=this.service.hsvaToRgba(this.hsva),r=!isNaN(e.v)&&e.v>=0&&e.v<=e.rg;r&&(n.g=e.v/e.rg,this.hsva=this.service.rgbaToHsva(n),this.sliderH=this.hsva.h,this.updateColorPicker()),this.directiveInstance.inputChanged({input:"green",valid:r,value:n.g,color:this.outputColor})}onHueInput(e){const n=!isNaN(e.v)&&e.v>=0&&e.v<=e.rg;n&&(this.hsva.h=e.v/e.rg,this.sliderH=this.hsva.h,this.updateColorPicker()),this.directiveInstance.inputChanged({input:"hue",valid:n,value:this.hsva.h,color:this.outputColor})}onValueInput(e){const n=!isNaN(e.v)&&e.v>=0&&e.v<=e.rg;n&&(this.hsva.v=e.v/e.rg,this.updateColorPicker()),this.directiveInstance.inputChanged({input:"value",valid:n,value:this.hsva.v,color:this.outputColor})}onAlphaInput(e){const n=!isNaN(e.v)&&e.v>=0&&e.v<=e.rg;n&&(this.hsva.a=e.v/e.rg,this.updateColorPicker()),this.directiveInstance.inputChanged({input:"alpha",valid:n,value:this.hsva.a,color:this.outputColor})}onLightnessInput(e){const n=this.service.hsva2hsla(this.hsva),r=!isNaN(e.v)&&e.v>=0&&e.v<=e.rg;r&&(n.l=e.v/e.rg,this.hsva=this.service.hsla2hsva(n),this.sliderH=this.hsva.h,this.updateColorPicker()),this.directiveInstance.inputChanged({input:"lightness",valid:r,value:n.l,color:this.outputColor})}onSaturationInput(e){const n=this.service.hsva2hsla(this.hsva),r=!isNaN(e.v)&&e.v>=0&&e.v<=e.rg;r&&(n.s=e.v/e.rg,this.hsva=this.service.hsla2hsva(n),this.sliderH=this.hsva.h,this.updateColorPicker()),this.directiveInstance.inputChanged({input:"saturation",valid:r,value:n.s,color:this.outputColor})}onCyanInput(e){!isNaN(e.v)&&e.v>=0&&e.v<=e.rg&&(this.cmyk.c=e.v,this.updateColorPicker(!1,!0,!0)),this.directiveInstance.inputChanged({input:"cyan",valid:!0,value:this.cmyk.c,color:this.outputColor})}onMagentaInput(e){!isNaN(e.v)&&e.v>=0&&e.v<=e.rg&&(this.cmyk.m=e.v,this.updateColorPicker(!1,!0,!0)),this.directiveInstance.inputChanged({input:"magenta",valid:!0,value:this.cmyk.m,color:this.outputColor})}onYellowInput(e){!isNaN(e.v)&&e.v>=0&&e.v<=e.rg&&(this.cmyk.y=e.v,this.updateColorPicker(!1,!0,!0)),this.directiveInstance.inputChanged({input:"yellow",valid:!0,value:this.cmyk.y,color:this.outputColor})}onBlackInput(e){!isNaN(e.v)&&e.v>=0&&e.v<=e.rg&&(this.cmyk.k=e.v,this.updateColorPicker(!1,!0,!0)),this.directiveInstance.inputChanged({input:"black",valid:!0,value:this.cmyk.k,color:this.outputColor})}onAddPresetColor(e,n){e.stopPropagation(),this.cpPresetColors.filter(r=>r===n).length||(this.cpPresetColors=this.cpPresetColors.concat(n),this.directiveInstance.presetColorsChanged(this.cpPresetColors))}onRemovePresetColor(e,n){e.stopPropagation(),this.cpPresetColors=this.cpPresetColors.filter(r=>r!==n),this.directiveInstance.presetColorsChanged(this.cpPresetColors)}openColorPicker(){this.show||(this.show=!0,this.hidden=!0,setTimeout(()=>{this.hidden=!1,this.setDialogPosition(),this.cdRef.detectChanges()},0),this.directiveInstance.stateChanged(!0),this.isIE10||(document.addEventListener("mousedown",this.listenerMouseDown),document.addEventListener("touchstart",this.listenerMouseDown)),window.addEventListener("resize",this.listenerResize))}closeColorPicker(){this.show&&(this.show=!1,this.directiveInstance.stateChanged(!1),this.isIE10||(document.removeEventListener("mousedown",this.listenerMouseDown),document.removeEventListener("touchstart",this.listenerMouseDown)),window.removeEventListener("resize",this.listenerResize),this.cdRef.destroyed||this.cdRef.detectChanges())}updateColorPicker(e=!0,n=!0,r=!1){if(this.sliderDimMax){let s,a,l;2===this.cpColorMode&&(this.hsva.s=0);const u=this.outputColor;if(a=this.service.hsva2hsla(this.hsva),this.cpCmykEnabled?(r?(l=this.service.cmykToRgb(this.service.normalizeCMYK(this.cmyk)),this.hsva=this.service.rgbaToHsva(l)):(l=this.service.hsvaToRgba(this.hsva),this.cmyk=this.service.denormalizeCMYK(this.service.rgbaToCmyk(l))),l=this.service.denormalizeRGBA(l),this.sliderH=this.hsva.h):l=this.service.denormalizeRGBA(this.service.hsvaToRgba(this.hsva)),s=this.service.denormalizeRGBA(this.service.hsvaToRgba(new NP(this.sliderH||this.hsva.h,1,1,1))),n&&(this.hslaText=new a0(Math.round(360*a.h),Math.round(100*a.s),Math.round(100*a.l),Math.round(100*a.a)/100),this.rgbaText=new dg(l.r,l.g,l.b,Math.round(100*l.a)/100),this.cpCmykEnabled&&(this.cmykText=new AT(this.cmyk.c,this.cmyk.m,this.cmyk.y,this.cmyk.k,Math.round(100*this.cmyk.a)/100)),this.hexText=this.service.rgbaToHex(l,"always"===this.cpAlphaChannel),this.hexAlpha=this.rgbaText.a),"auto"===this.cpOutputFormat&&this.format!==ou.RGBA&&this.format!==ou.CMYK&&this.hsva.a<1&&(this.format=this.hsva.a<1?ou.RGBA:ou.HEX),this.hueSliderColor="rgb("+s.r+","+s.g+","+s.b+")",this.alphaSliderColor="rgb("+l.r+","+l.g+","+l.b+")",this.outputColor=this.service.outputFormat(this.hsva,this.cpOutputFormat,this.cpAlphaChannel),this.selectedColor=this.service.outputFormat(this.hsva,"rgba",null),this.format!==ou.CMYK)this.cmykColor="";else if("always"===this.cpAlphaChannel||"enabled"===this.cpAlphaChannel||"forced"===this.cpAlphaChannel){const h=Math.round(100*this.cmyk.a)/100;this.cmykColor=`cmyka(${this.cmyk.c},${this.cmyk.m},${this.cmyk.y},${this.cmyk.k},${h})`}else this.cmykColor=`cmyk(${this.cmyk.c},${this.cmyk.m},${this.cmyk.y},${this.cmyk.k})`;this.slider=new Jq((this.sliderH||this.hsva.h)*this.sliderDimMax.h-8,this.hsva.s*this.sliderDimMax.s-8,(1-this.hsva.v)*this.sliderDimMax.v-8,this.hsva.a*this.sliderDimMax.a-8),e&&u!==this.outputColor&&(this.cpCmykEnabled&&this.directiveInstance.cmykChanged(this.cmykColor),this.directiveInstance.colorChanged(this.outputColor))}}setDialogPosition(){if("inline"===this.cpDialogDisplay)this.position="relative";else{let r,e="static",n="",s=null,a=null,l=this.directiveElementRef.nativeElement.parentNode;const u=this.dialogElement.nativeElement.offsetHeight;for(;null!==l&&"HTML"!==l.tagName;){if(r=window.getComputedStyle(l),e=r.getPropertyValue("position"),n=r.getPropertyValue("transform"),"static"!==e&&null===s&&(s=l),n&&"none"!==n&&null===a&&(a=l),"fixed"===e){s=a;break}l=l.parentNode}const h=this.createDialogBox(this.directiveElementRef.nativeElement,"fixed"!==e);if(this.useRootViewContainer||"fixed"===e&&(!s||s instanceof HTMLUnknownElement))this.top=h.top,this.left=h.left;else{null===s&&(s=l);const _=this.createDialogBox(s,"fixed"!==e);this.top=h.top-_.top,this.left=h.left-_.left}"fixed"===e&&(this.position="fixed");let m=this.cpPosition;"auto"===this.cpPosition&&(m=function Lye(i,t){let e="right",n="bottom";const{height:r,width:s}=i,{top:a,left:l}=t,u=a+t.height,h=l+t.width,m=a-r<0,_=u+r>(window.innerHeight||document.documentElement.clientHeight),v=l-s<0,S=h+s>(window.innerWidth||document.documentElement.clientWidth);return _&&(n="top"),m&&(n="bottom"),v&&(e="right"),S&&(e="left"),m&&_&&v&&S?["left","right","top","bottom"].reduce((j,P)=>i[j]>i[P]?j:P):v&&S?m?"bottom":_||a>u?"top":"bottom":m&&_?v?"right":S||l>h?"left":"right":`${n}-${e}`}(this.dialogElement.nativeElement.getBoundingClientRect(),this.cpTriggerElement.nativeElement.getBoundingClientRect())),"top"===m?(this.arrowTop=u-1,this.top-=u+this.dialogArrowSize,this.left+=this.cpPositionOffset/100*h.width-this.dialogArrowOffset):"bottom"===m?(this.top+=h.height+this.dialogArrowSize,this.left+=this.cpPositionOffset/100*h.width-this.dialogArrowOffset):"top-left"===m||"left-top"===m?(this.top-=u-h.height+h.height*this.cpPositionOffset/100,this.left-=this.cpWidth+this.dialogArrowSize-2-this.dialogArrowOffset):"top-right"===m||"right-top"===m?(this.top-=u-h.height+h.height*this.cpPositionOffset/100,this.left+=h.width+this.dialogArrowSize-2-this.dialogArrowOffset):"left"===m||"bottom-left"===m||"left-bottom"===m?(this.top+=h.height*this.cpPositionOffset/100-this.dialogArrowOffset,this.left-=this.cpWidth+this.dialogArrowSize-2):(this.top+=h.height*this.cpPositionOffset/100-this.dialogArrowOffset,this.left+=h.width+this.dialogArrowSize-2),this.cpUsePosition=m}}isDescendant(e,n){let r=n.parentNode;for(;null!==r;){if(r===e)return!0;r=r.parentNode}return!1}createDialogBox(e,n){return{top:e.getBoundingClientRect().top+(n?window.pageYOffset:0),left:e.getBoundingClientRect().left+(n?window.pageXOffset:0),width:e.offsetWidth,height:e.offsetHeight}}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(Pn),B(uV))},i.\u0275cmp=ei({type:i,selectors:[["color-picker"]],viewQuery:function(e,n){if(1&e&&(ji(rye,7),ji(sye,7),ji(oye,7)),2&e){let r;jt(r=qt())&&(n.dialogElement=r.first),jt(r=qt())&&(n.hueSlider=r.first),jt(r=qt())&&(n.alphaSlider=r.first)}},hostBindings:function(e,n){1&e&&je("keyup.esc",function(s){return n.handleEsc(s)},!1,Mh)("keyup.enter",function(s){return n.handleEnter(s)},!1,Mh)},decls:28,vars:47,consts:[[1,"color-picker",3,"click"],["dialogPopup",""],[3,"class","top",4,"ngIf"],["class","saturation-lightness",3,"slider","rgX","rgY","background-color","newValue","dragStart","dragEnd",4,"ngIf"],[1,"hue-alpha","box"],[1,"left"],[1,"selected-color-background"],[1,"selected-color"],["type","button",3,"class","disabled","click",4,"ngIf"],[1,"right"],["style","height: 16px;",4,"ngIf"],[1,"hue",3,"slider","rgX","newValue","dragStart","dragEnd"],["hueSlider",""],[1,"cursor"],[1,"value",3,"slider","rgX","newValue","dragStart","dragEnd"],["valueSlider",""],[1,"alpha",3,"slider","rgX","newValue","dragStart","dragEnd"],["alphaSlider",""],["class","cmyk-text",3,"display",4,"ngIf"],["class","hsla-text",3,"display",4,"ngIf"],["class","rgba-text",3,"display",4,"ngIf"],["class","hex-text",3,"hex-alpha","display",4,"ngIf"],["class","value-text",4,"ngIf"],["class","type-policy",4,"ngIf"],["class","preset-area",4,"ngIf"],["class","button-area",4,"ngIf"],[1,"saturation-lightness",3,"slider","rgX","rgY","newValue","dragStart","dragEnd"],["type","button",3,"disabled","click"],[2,"height","16px"],[1,"cmyk-text"],[1,"box"],["type","number","pattern","[0-9]*","min","0","max","100",3,"text","rg","value","keyup.enter","newValue"],["type","number","pattern","[0-9]+([\\.,][0-9]{1,2})?","min","0","max","1","step","0.1",3,"text","rg","value","keyup.enter","newValue",4,"ngIf"],[4,"ngIf"],["type","number","pattern","[0-9]+([\\.,][0-9]{1,2})?","min","0","max","1","step","0.1",3,"text","rg","value","keyup.enter","newValue"],[1,"hsla-text"],["type","number","pattern","[0-9]*","min","0","max","360",3,"text","rg","value","keyup.enter","newValue"],[1,"rgba-text"],["type","number","pattern","[0-9]*","min","0","max","255",3,"text","rg","value","keyup.enter","newValue"],[1,"hex-text"],[3,"text","value","blur","keyup.enter","newValue"],[1,"value-text"],[1,"type-policy"],[1,"type-policy-arrow",3,"click"],[1,"preset-area"],[1,"preset-label"],[3,"class",4,"ngIf"],["class","preset-color",3,"backgroundColor","click",4,"ngFor","ngForOf"],[1,"preset-color",3,"click"],[3,"class","click",4,"ngIf"],[3,"click"],[1,"button-area"],["type","button",3,"class","click",4,"ngIf"],["type","button",3,"click"]],template:function(e,n){1&e&&(Z(0,"div",0,1),je("click",function(s){return s.stopPropagation()}),Ue(2,aye,1,5,"div",2),Ue(3,lye,2,8,"div",3),Z(4,"div",4)(5,"div",5),yt(6,"div",6)(7,"div",7),Ue(8,cye,2,5,"button",8),J(),Z(9,"div",9),Ue(10,uye,1,0,"div",10),Z(11,"div",11,12),je("newValue",function(s){return n.onHueChange(s)})("dragStart",function(){return n.onDragStart("hue")})("dragEnd",function(){return n.onDragEnd("hue")}),yt(13,"div",13),J(),Z(14,"div",14,15),je("newValue",function(s){return n.onValueChange(s)})("dragStart",function(){return n.onDragStart("value")})("dragEnd",function(){return n.onDragEnd("value")}),yt(16,"div",13),J(),Z(17,"div",16,17),je("newValue",function(s){return n.onAlphaChange(s)})("dragStart",function(){return n.onDragStart("alpha")})("dragEnd",function(){return n.onDragEnd("alpha")}),yt(19,"div",13),J()()(),Ue(20,fye,17,12,"div",18),Ue(21,gye,14,10,"div",19),Ue(22,vye,14,10,"div",20),Ue(23,wye,8,7,"div",21),Ue(24,Cye,9,3,"div",22),Ue(25,Mye,3,0,"div",23),Ue(26,Rye,6,3,"div",24),Ue(27,Iye,3,2,"div",25),J()),2&e&&(A("display",n.show?"block":"none")("visibility",n.hidden?"hidden":"visible")("top",n.top,"px")("left",n.left,"px")("position",n.position)("height",n.cpHeight,"px")("width",n.cpWidth,"px"),N("open",n.show),se(2),fe("ngIf","popup"==n.cpDialogDisplay),se(1),fe("ngIf",1===(n.cpColorMode||1)),se(4),A("background-color",n.selectedColor),se(1),fe("ngIf",n.cpAddColorButton),se(2),fe("ngIf","disabled"===n.cpAlphaChannel),se(1),A("display",1===(n.cpColorMode||1)?"block":"none"),fe("rgX",1),se(2),A("left",null==n.slider?null:n.slider.h,"px"),se(1),A("display",2===(n.cpColorMode||1)?"block":"none"),fe("rgX",1),se(2),A("right",null==n.slider?null:n.slider.v,"px"),se(1),A("display","disabled"===n.cpAlphaChannel?"none":"block")("background-color",n.alphaSliderColor),fe("rgX",1),se(2),A("left",null==n.slider?null:n.slider.a,"px"),se(1),fe("ngIf",!n.cpDisableInput&&1===(n.cpColorMode||1)),se(1),fe("ngIf",!n.cpDisableInput&&1===(n.cpColorMode||1)),se(1),fe("ngIf",!n.cpDisableInput&&1===(n.cpColorMode||1)),se(1),fe("ngIf",!n.cpDisableInput&&1===(n.cpColorMode||1)),se(1),fe("ngIf",!n.cpDisableInput&&2===(n.cpColorMode||1)),se(1),fe("ngIf",!n.cpDisableInput&&1===(n.cpColorMode||1)),se(1),fe("ngIf",(null==n.cpPresetColors?null:n.cpPresetColors.length)||n.cpAddColorButton),se(1),fe("ngIf",n.cpOKButton||n.cpCancelButton))},directives:[ms,Bye,Fye,mo],styles:['.color-picker{-moz-user-select:none;-ms-user-select:none;-webkit-user-select:none;background-color:#fff;border:1px solid #777;cursor:default;height:auto;position:absolute;user-select:none;width:230px;z-index:1000}.color-picker *{box-sizing:border-box;font-size:11px;margin:0}.color-picker input{color:#000;font-size:13px;height:26px;min-width:0;text-align:center;width:0}.color-picker input:-moz-submit-invalid,.color-picker input:-moz-ui-invalid,.color-picker input:invalid{box-shadow:none}.color-picker input::-webkit-inner-spin-button,.color-picker input::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.color-picker .arrow{border-style:solid;height:0;position:absolute;width:0;z-index:999999}.color-picker .arrow.arrow-top{border-color:#777 transparent transparent;border-width:10px 5px;left:8px}.color-picker .arrow.arrow-bottom{border-color:transparent transparent #777;border-width:10px 5px;left:8px;top:-20px}.color-picker .arrow.arrow-left-top,.color-picker .arrow.arrow-top-left{border-color:transparent transparent transparent #777;border-width:5px 10px;bottom:8px;right:-21px}.color-picker .arrow.arrow-right-top,.color-picker .arrow.arrow-top-right{border-color:transparent #777 transparent transparent;border-width:5px 10px;bottom:8px;left:-20px}.color-picker .arrow.arrow-bottom-left,.color-picker .arrow.arrow-left,.color-picker .arrow.arrow-left-bottom{border-color:transparent transparent transparent #777;border-width:5px 10px;right:-21px;top:8px}.color-picker .arrow.arrow-bottom-right,.color-picker .arrow.arrow-right,.color-picker .arrow.arrow-right-bottom{border-color:transparent #777 transparent transparent;border-width:5px 10px;left:-20px;top:8px}.color-picker .cursor{border:2px solid #222;border-radius:50%;cursor:default;height:16px;position:relative;width:16px}.color-picker .box{display:flex;padding:4px 8px}.color-picker .left{padding:16px 8px;position:relative}.color-picker .right{flex:1 1 auto;padding:12px 8px}.color-picker .button-area{padding:0 16px 16px;text-align:right}.color-picker .button-area button{margin-left:8px}.color-picker .preset-area{padding:4px 15px}.color-picker .preset-area .preset-label{color:#555;font-size:11px;overflow:hidden;padding:4px;text-align:left;text-overflow:ellipsis;white-space:nowrap;width:100%}.color-picker .preset-area .preset-color{border:1px solid #a9a9a9;border-radius:25%;cursor:pointer;display:inline-block;height:18px;margin:4px 6px 8px;position:relative;width:18px}.color-picker .preset-area .preset-empty-message{font-style:italic;margin-bottom:8px;margin-top:4px;min-height:18px;text-align:center}.color-picker .hex-text{font-size:11px;padding:4px 8px;width:100%}.color-picker .hex-text .box{padding:0 24px 8px 8px}.color-picker .hex-text .box div{clear:left;color:#555;flex:1 1 auto;float:left;text-align:center}.color-picker .hex-text .box input{border:1px solid #a9a9a9;flex:1 1 auto;padding:1px}.color-picker .hex-alpha .box div:first-child,.color-picker .hex-alpha .box input:first-child{flex-grow:3;margin-right:8px}.color-picker .cmyk-text,.color-picker .hsla-text,.color-picker .rgba-text,.color-picker .value-text{font-size:11px;padding:4px 8px;width:100%}.color-picker .cmyk-text .box,.color-picker .hsla-text .box,.color-picker .rgba-text .box{padding:0 24px 8px 8px}.color-picker .value-text .box{padding:0 8px 8px}.color-picker .cmyk-text .box div,.color-picker .hsla-text .box div,.color-picker .rgba-text .box div,.color-picker .value-text .box div{color:#555;flex:1 1 auto;margin-right:8px;text-align:center}.color-picker .cmyk-text .box div:last-child,.color-picker .hsla-text .box div:last-child,.color-picker .rgba-text .box div:last-child,.color-picker .value-text .box div:last-child{margin-right:0}.color-picker .cmyk-text .box input,.color-picker .hsla-text .box input,.color-picker .rgba-text .box input,.color-picker .value-text .box input{border:1px solid #a9a9a9;flex:1;float:left;margin:0 8px 0 0;padding:1px}.color-picker .cmyk-text .box input:last-child,.color-picker .hsla-text .box input:last-child,.color-picker .rgba-text .box input:last-child,.color-picker .value-text .box input:last-child{margin-right:0}.color-picker .hue-alpha{align-items:center;margin-bottom:3px}.color-picker .hue{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAAAQCAYAAAD06IYnAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AIWDwkUFWbCCAAAAFxJREFUaN7t0kEKg0AQAME2x83/n2qu5qCgD1iDhCoYdpnbQC9bbY1qVO/jvc6k3ad91s7/7F1/csgPrujuQ17BDYSFsBAWwgJhISyEBcJCWAgLhIWwEBYIi2f7Ar/1TCgFH2X9AAAAAElFTkSuQmCC");direction:ltr}.color-picker .hue,.color-picker .value{background-size:100% 100%;border:none;cursor:pointer;height:16px;margin-bottom:16px;width:100%}.color-picker .value{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAAAQCAYAAAD06IYnAAACTklEQVR42u3SYUcrABhA4U2SkmRJMmWSJklKJiWZZpKUJJskKUmaTFImKZOUzMySpGRmliRNJilJSpKSJEtmSpIpmWmSdO736/6D+x7OP3gUCoWCv1cqlSQlJZGcnExKSgqpqamkpaWRnp5ORkYGmZmZqFQqsrKyyM7OJicnh9zcXNRqNXl5eeTn56PRaCgoKKCwsJCioiK0Wi3FxcWUlJRQWlpKWVkZ5eXlVFRUUFlZiU6no6qqiurqampqaqitraWurg69Xk99fT0GgwGj0UhDQwONjY00NTXR3NxMS0sLra2ttLW10d7ejslkwmw209HRQWdnJ11dXXR3d9PT00Nvby99fX309/czMDDA4OAgFouFoaEhrFYrw8PDjIyMMDo6ytjYGDabjfHxcSYmJpicnGRqagq73c709DQzMzPMzs4yNzfH/Pw8DocDp9OJy+XC7XazsLDA4uIiS0tLLC8vs7KywurqKmtra3g8HrxeLz6fD7/fz/r6OhsbG2xubrK1tcX29jaBQICdnR2CwSC7u7vs7e2xv7/PwcEBh4eHHB0dcXx8zMnJCaenp5ydnXF+fs7FxQWXl5dcXV1xfX3Nzc0Nt7e33N3dEQqFuL+/5+HhgXA4TCQS4fHxkaenJ56fn3l5eeH19ZVoNMrb2xvv7+98fHwQi8WIx+N8fn6SSCT4+vri+/ubn58ffn9/+VcKgSWwBJbAElgCS2AJLIElsASWwBJYAktgCSyBJbAElsASWAJLYAksgSWwBJbAElgCS2AJLIElsP4/WH8AmJ5Z6jHS4h8AAAAASUVORK5CYII=");direction:rtl}.color-picker .alpha{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAAAQCAYAAAD06IYnAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AIWDwYQlZMa3gAAAWVJREFUaN7tmEGO6jAQRCsOArHgBpyAJYGjcGocxAm4A2IHpmoWE0eBH+ezmFlNvU06shJ3W6VEelWMUQAIIF9f6qZpimsA1LYtS2uF51/u27YVAFZVRUkEoGHdPV/sIcbIEIIkUdI/9Xa7neyv61+SWFUVAVCSct00TWn2fv6u3+Ecfd3tXzy/0+nEUu+SPjo/kqzrmiQpScN6v98XewfA8/lMkiLJ2WxGSUopcT6fM6U0NX9/frfbjev1WtfrlZfLhYfDQQHG/AIOlnGwjINlHCxjHCzjYJm/TJWdCwquJXseFFzGwDNNeiKMOJTO8xQdDQaeB29+K9efeLaBo9J7vdvtJj1RjFFjfiv7qv95tjx/7leSQgh93e1ffMeIp6O+YQjho/N791t1XVOSSI7N//K+4/GoxWLBx+PB5/Op5XLJ+/3OlJJWqxU3m83ovv5iGf8KjYNlHCxjHCzjYBkHy5gf5gusvQU7U37jTAAAAABJRU5ErkJggg==");background-size:100% 100%;border:none;cursor:pointer;direction:ltr;height:16px;width:100%}.color-picker .type-policy{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAAgCAYAAAAffCjxAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAACewAAAnsB01CO3AAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAIASURBVEiJ7ZY9axRRFIafsxMStrLQJpAgpBFhi+C9w1YSo00I6RZ/g9vZpBf/QOr4GyRgkSKNSrAadsZqQGwCkuAWyRZJsySwvhZ7N/vhzrgbLH3Ld8597jlzz50zJokyxXH8DqDVar0qi6v8BbItqSGpEcfxdlmsFWXkvX8AfAVWg3UKPEnT9GKujMzsAFgZsVaCN1VTQd77XUnrgE1kv+6935268WRpzrnHZvYRWC7YvC3pRZZl3wozqtVqiyH9IgjAspkd1Gq1xUJQtVrdB9ZKIAOthdg/Qc65LUk7wNIMoCVJO865rYFhkqjX6/d7vV4GPJwBMqofURS5JEk6FYBer/eeYb/Mo9WwFnPOvQbeAvfuAAK4BN4sAJtAG/gJIElmNuiJyba3EGNmZiPeZuEVmVell/Y/6N+CzDn3AXhEOOo7Hv/3BeAz8IzQkMPnJbuPx1wC+yYJ7/0nYIP5S/0FHKdp+rwCEEXRS/rf5Hl1Gtb2M0iSpCOpCZzPATmX1EySpHMLAsiy7MjMDoHrGSDXZnaYZdnRwBh7J91utwmczAA6CbG3GgPleX4jqUH/a1CktqRGnuc3hSCAMB32gKspkCtgb3KCQMmkjeP4WNJThrNNZval1WptTIsv7JtQ4tmIdRa8qSoEpWl6YWZNoAN0zKxZNPehpLSBZv2t+Q0CJ9lLnARQLAAAAABJRU5ErkJggg==");background-position:50%;background-repeat:no-repeat;background-size:8px 16px;height:24px;position:absolute;right:12px;top:218px;width:16px}.color-picker .type-policy .type-policy-arrow{display:block;height:50%;width:100%}.color-picker .selected-color{border:1px solid #a9a9a9;border-radius:50%;height:40px;left:8px;position:absolute;top:16px;width:40px}.color-picker .selected-color-background{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAh0lEQVRYR+2W0QlAMQgD60zdfwOdqa8TmI/wQMr5K0I5bZLIzLOa2nt37VVVbd+dDx5obgCC3KBLwJ2ff4PnVidkf+ucIhw80HQaCLo3DMH3CRK3iFsmAWVl6hPNDwt8EvNE5q+YuEXcMgkonVM6SdyCoEvAnZ8v1Hjx817MilmxSUB5rdLJDycZgUAZUch/AAAAAElFTkSuQmCC");border-radius:50%;height:40px;width:40px}.color-picker .saturation-lightness{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOYAAACCCAYAAABSD7T3AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AIWDwksPWR6lgAAIABJREFUeNrtnVuT47gRrAHN+P//Or/61Y5wONZ7mZ1u3XAeLMjJZGZVgdKsfc5xR3S0RIIUW+CHzCpc2McYo7XGv3ex7UiZd57rjyzzv+v+33X/R/+3r/f7vR386Y+TvKNcf/wdhTLPcv9qU2wZd74uth0t1821jkIZLPcsI/6nWa4XvutquU0Z85mnx80S/ZzgpnLnOtHNt7/ofx1TKXcSNzN/7qbMQ3ju7rNQmMYYd/4s2j9aa+P+gGaMcZrb1M/tdrvf7/d2v99P9/t93O/3cbvdxu12G9frdVwul3E+n8c///nP+2+//Xb66aefxl//+tfx5z//2YK5Al2rgvf4UsbpdGrB52bAvArXpuzjmiqAVSGz5eDmGYXzhbAZmCrnmzddpUU+8Y1dAOYeXCtDUwVwV7YCGH6uAmyMcZ9l5vkUaBPGMUZ7/J5w/792/fvv9Xq93263dr/fTxPECeME8nK5jM/Pz/HTTz/dv337dvrll1/GP/7xj/G3v/1t/OUvfwkVswongjdOp9PzH3U3D3zmWGnZVXn4jCqs7wC2BKP4/8tAzkZsoWx6XrqeHZymvp4ABCBJhTQwKfDT8gzrZCIqi5AhiACjBfEB2rP8/X63MM7f6/V6v9/v7Xa7bYC83W7jcrlsVHIq5ffv30+//fbb+OWXX8ZPP/00/v73v4+ff/75JSvbeu+bL2WMMaFbAlpBNM85QX+ct6qoSqkPAwuQlBVKqGNFSUOAA3Bmu7gC5hNOd15nSwvAOUW7C4giUCV8Sgn5L9hNFIqTsp0GxI0ysioyjAjkY/tGJVEpz+fz+OWXX+7fv38//f777+Pbt2/j119/HT///PP49ddfx8fHRwrmTjV779EXu2px2xhjwtdJZQcAWQIPLPISsMJaSwiD8gzIKrwSyATE5j5nAbR5c1dBUwBlsEWW0h6LqiYsqFPAQxCyRZ3wOSARxmlXMX5k64pQfvv27f75+dk+Pj5OHx8f4/v37+Pbt2/jt99+G9++fRsfHx/jcrmUFLO31gYDWblxRIs/TqfT7ousxJsAxXA2Gc7TA9XdgfdoHbFsj76X2+1WArgI1ageGwA3qupqoHsmcbI6Fu93quggFa9d7LeDtgKfAFHBJ+NEByIkcJ5KervdTmhhGcgJJSZ5vn//fj+fz+18Pp8+Pz/H5+fnmGD+/vvv4/v37+Pj42N8fn6O2+1Ws7JjjP6wraMI5E4RZ8x2vV5TSwkquotV7/d7Tz6HFWsD/qNcdw0CQ3q/321c686TwDVIdbuy73zNldhSHb8I2klZznm+InBS4U6n0302aBFsLhHDAKJVJVglfI9jhvu53W53sLANYNxAiDA6MCeUHx8f9+v12i6XS7tcLqcZW57P5yeY8/fz83Ocz+fnsSmYUyknWEG85WBst9stzSLyMdfr9Qi08iY15UZ0LlDGLhR3o5zK2j7OPUTD0E+nU3tk7Xb/16NFbhloAMuY1zjLUOO3BKeIDe+Z8s3/J4gFo4TM5jPmuRg28foUKKVSwo16TgA5npywcWLHgYl/Pz8/73/605/ab7/91m63W7tcLie0sZj4mao5gTyfz88E0f1+j8EcYzwTPEG2cqjyfHNF0M8fuqEiaOVnRzZZQNh5fwQyHg/HDGfJo89Q1zb/quu5XC6773I2XKfTqd/v9+d3wuqWva/YTdUdEV3fhIv/Viyps6YE3x3r43K5bJQS66zaxVGFsvd+//j4aF+/fm3fv39vt9utff36tf3+++/tdrudvn37ZuNLBaaCMgUzC+rZRiFowxUuJI8YMqcCp9Opq5vagaYU6lGJA1XQqejchw6Cj0Gw5nYBrGw01A2O206n04BGouNNyTfp/FwElhUey6nXrIKw7QQWddxuN2ldL5fL839gSPF8ahu/JvBO48CPSuqMf8Vp9/P53L58+dLu93s7n8/tfr8/39/v9/b5+TkhPJ3P56mQ436/j+/fv+/iSgbzer0+AZx/5+88bv6OMda6S5z6kd21fYC9dxv7cIJJ2d9AOS30fPMzyHiTM8B4DF6XUlYHp4KQW3W+1t77MNB1vGHxWq7Xa7vf78+y5/N5A+H1et29xuP5dbYtyaRu4AksbPq6936fjRzXRxBbPr/b+b18+fKljTHaBBBfn8/n0/1+H1++fBnn8zm0sB8fH5u4cr5GuBhMVk0EEn9RsctgVhM+ixlJtMA23R8B6yysAstBOgFXIKKCMIgToMqNEu2fYMH7ztc732dQKkCj1ytAZtY0Kx8pIr8GGJ+AT3V+2Hirhl++fBmXy2Wz73w+b17P8p+fn8/tUwGVleVkTyUb68DkfayWY4zxNRihU4EpLJPZVrK+u7J4/mgfKqeLW9X2REWlItL1diynbDDb3+jXgYjQqn0rrxWc+NkILP7F7xIbMvx7vV53x40xnlbWJF12ZSag/N0pW6t+ZzmOMzHjajKwDfond78zYTdfq18up97zr2q8v3IioBprRtBl0EZ9og5WBRGOdOHjIjXF7UotFbgOWnXzIJyzYvjG5IYgsmMOxHkz8OsMSrVNWeq5T8DaOcbEv1Od5rbs9aO7YvMet63EkF++fMExq+MRl4/L5bLZN/+ez+fnZ6KazuMqXSQVO5spJXflHAIzes/xJseckRJiDMog9d6VfRrqXMr6KpVV27jRwJacGovOAM1zMdQMnwK1AubK63kdCChvI1C7g0z9nf/D+Xze2Vj8H7Gx4P9duQlsYCrqyN8XqG3Hm/10Oj3jw/n+crlstuM+jPmmxT2dTuPz83Pzt2pn1XsEHX/bnPaVqVmh0xwOt0o6XLLAHePUU203wHfcrspCwmV3TryB5s0Mseeg97x/BwzCjBlbB+pRAPla0BVQuT6V6QHdBlj3d0KG147b+DqxQeUymDO43W4dQar+TIjwmAd0z8/h65vf0/yLv3Pb5XLpru/ydDo9s7ET0I+Pj6dKK9VUEIeKWQWPAOrJ8LKd4vE+t91Y3e7UFlWatg2VwJnb+HPmtvm/sfK59/OaWF3x/eP1UPHvA5DDYDpYXfb0drv1V2DkBkxtw/tEWVVlXWdC9pFYs5/jfh9dS/16vW7s6lTG+TfqsxSJHxkXXq/Xdr1eu4LsfD6P3vsT3N77DkL+zPm5jSdKL4zR3AxQd6rHkLkYlSowsrq7znzu6wSwdsMJOXmA5fBcjxtgMGBYHlr5zokhtsMCTgXLQOW4XC6dEyEMprL8mAQzXRgduix2yZzorxkYsDn3hB1VeMLGsXsVtgl2pW8S3svk0vw7R4hNaHvv4cACl5HFzwIH0Kc6zu4XjDPR/jpAVxWzO1Xk2DDb3vTcxeGU1iWZHkmIDWziWKvirCJ4Dravs6IJ/GG6cTqWdXDy+fArQDVVkLqkVjAoZIITdmmIqXwqa95N3+MGYoZQdRVNO53Y1xRkhO16vY7eu507Ca9lJnbGpxOemQhSw/AQsmmp5zU9BiU8G6wvX76M6/U6Pj4+do0Bz4CpgiknTUeDqwlKBmg3u4OVjrZ1A+rAcgaejWq6eJCvCYFDONSwOgHX4EQRw8lxbzDOdEK6gZ3Hk1b+8g2o1JFtKXyv/fEdTXuWjWXdAZiBp6ADeDrCFiim7B6ZFneeI7Gvm/PMkUDX67W7xI8b0D7/v8dA9qfN5oaCf74WZjH0mf1cmfY1Y0JUFmVrTWu8uzkNcLtEj7u5FXBTkfC6GOA5q8YMxO8KVvF6sAVGdcrUbsKODcQKkLMOMdmlxum642YrPm26AlhZW1YB1R+rrGswE8TaYAWeUMxdf+WjwSvZ2Ef3ytOyfn5+PpVPAaqOn43MtNBqvmjjxbjM4lZjZY4gqNMI5ktaW/sYKNwS+9lFQzGihmMCKPa7+Z0V6Eb0GRmobtpX8JljWu5FMLN5ja6hG9kwQgZqf5+1NH5UxzkFReCdWhJ8XdlGUkxO7HRlYRm4mVO43W7ter12TPJEw/rmEN3L5SKHIWZg9mz+pUoKOYq5bJTJdX2gme1UcxMZQFaEQIlHct32M+Y1BzGkGuzfiyAN9z+ugplZ1symCrDCYYkGxDTpI9RzBy0rHyeDUC1nWaeUaD9n4xkNyYMBDZtzZ3B++fJlY21XFDOcARJlabOyiS3uCpLI9jrZjCDkaVvcCCjwognKShWdzXZWlZMvVTgD8LpqlCLrqgbcB+qYwrgKYpT0ccCqbKyCValkEabn/FynogCrPKfqf51xJ7sGB2ZXcZmxoSOztjx300DZi7a0/2AIR0UlBag9SuDw6KcAzlaB7vHZvWpjK90dyrq6bKyDUZQbR0B05biLQkHIcSUmgIK+SwuqgHCnoio2RQU1yj+BnBy9pphVKLGyC7ZzFK1pxWK+E8IhVCWLN/uLtnUU4ayoYLoaANz8FdtaSvY4pV0BEW2ls61czqllBKpTyKgMAhrZ1cdc1RROtPmvWNkdcKZ7ZKxaWjiPLJMpp7OZKxA+rqG/oJLjxf0pnJlqLoDZo3gyU0mKGys2taKecj/d1C+rJSplBqlTyAqgR+D8KjKlmRL2gtUcAdCtsL+ijCNT1oqqqkH2OHEbG5sDFnUg5Aa+yLou2VU1ptj1S2ZQqv1ORZN9IWzRfgaRBxKoBE8UWyqlJFtrIc0AxNjSjed99CTY/XDfSzCz5M0IZoVEsWnPFNTsl8ooVC1TzbGgqFZNDSgVwKK+1sGDMKqxZCWGVMDysiEr1jVSQJUYwj5iHOlThdHt44SQg9CN+nl8D90NMIgAdgr46JqRiR9I8vRdFvbr17m/yxUMKjNLMiVUADwu2CWGhhi+F55TWM9M9cogzms1dnM4uOF/LAEYWdcqnM7yFmyq3IfwmOROd7Y1iFWtOjoY8To41mTV5IysgFFuRzsbWFGbNIIJCDv1dOo4lZG7jWBwRFtVTKuWyeCByJKOan8oZ3ep9XddNl0tDuaywLz9cXPYeDAA0SpkBO9sbVcTOVWldPv4uyzEkzxHtjvonHoSkFEWNoo1d8DhcQputd2ppNon4BzoAiJ1hBFQg0dVtdbGHHDQWushmNEQukLM2QO1G2Y8bgTXqFhcBJj7EjPgcPts8US8qPpPB/dXznOh5Z438tzH5ec6QgrOKrRRfKmysBmUDB+PhYabMlVPER+GCSITTzr7am2tArH3bgcEzPJm+cr5jJ4NnHNFDVrFXcI5Le9k5Jnw+bedbV+FfRzZIHaOOaOsLY0/7UGs58DjrGwKMIMFIGzOEW1/jGsdAtCN6hEAI4hBe9YXeRROBSVPAVPAqvIM5bx5hVKWAMP6zBRy3iescridVdFBinBxXDnG2GRY2XbCvp1lhvGtO9Bxu5h908XQu42lnSArMFdizMim8uwRCxPGnnOS8lwpnbOiDqTAjsrRN/PcoAScCbaACqVM40ylnjjTBs+bwWlAG23/UKbdkiwKWIQPGzWaczpoSlxPEj822cNWkpS7FyzsDrqpfgpG3jahw2vgbaSQAxuLWZYt7JzyNe8JoZpNAcvDFOdw0wqYT9AK1rZz/DdbSlLPp0ryIxgQJlK9AZlEq7IOXpohg9PIhrCng88JsOxiV4ZWAYfg4sikx/8ky2Z9l862uqwrfscIH8+ugTmVGyiddeVYUgEMn4GZzg14EwIsh9sx2cKKiWXReuOE5gzGOQgdlRKVVdlevqb279Xq0Qnsts2VDaBO0coezsruWtHApu6sKG4IBhN0aGU2kLrMKGRTN3HmbCDwKV14zvkMEDG4QfZVspVlaNU2mhc5TEZ3N1h/zqTheuLpW05ZWTGVjb3dbnNmxKZBnN8JqidaVLKAOyARNLS+MB54Z2+VaqoMLKroVBlngefnTPAcoHNWCSvlfA8CI0HEmBNBnBlXyMrzU7A7WVm94PPqQ2gmqKx+WDGsnvilmcSOBJqOK1nYyAIzuAyesq3UdSK3KfWcYKD95HmfYOU3qser2CtYEUA+FpfqdNvgPBZUBhDrGONRVlQsh8rLcaUCykHG0OOUwTlLBrsh5soEMGezi1E4HRVt1icp5wZEFXdibCkG8Y8vX75sbO4E0iom9z+hjSiOfy3DhpXItpVhE+UGQdvoWjtChmrGHf4YAzKgBNnGtuJxFCeGdhUAfQLLK8kBYAP6gvFJZajMG3Xkycy8KuC0q4Eyymwtwdxdv2M0mIBtK0LKnf640j00Auq4gUkdWGlhs22qJc6dZCsL19oxnlTJG4SYVRIGpD8TPFBuM6OElbS1pldid4mGAyN6ZIupbC5bXJN9fdpbThSxLUaI8IG1XIYBxW3Tjs6KQosKcxfxcQmdnwRGM10GnFcCy2XYunLMyAkdgk4mePiczsLygthcBut6goOqS7YVFXADLjaosB6s6ofcZWAZSIRYqSUkizYwttYab3vUOQ9w2HRxIIg8WwRVeE68xi4UtL3zRphxplzwuZrcqYCq1I3jPI5dnJIygEohMbPqVJSzrwzxBJTs5zN+ReUSgxikPQVF3JVBeNQxbHENrEMNvEdFZVV9lH9+ORGEsNZQpyTNc4C3AG7XF4ngzq+DrO2zbuaaOXgdaFcdkEotoSFBVX2qJ0C8OWZeG4KGlpghA0XfTOPCqV2qqwQ26QWfF2PMLhI2w1lVAa2aPsYd0za25MQRwgcZN6uQDCi+ZxiD4XEM2kZxOT41FnZnaRlcpZouzlRqqdbQVWopQoSB58RV50lBNrHi/AwXS5LrwDVlpY3Fc3ByiYGc52Trist6kOXdwInAQtJpp5QchyaquYOV7Su+fxVMaV3dc0RE2S6mUY0gLt2pMcYqrKIQ9w2l1gpQUMtQYcmmbt5DTNxdhnUCjQqtbK9SUSzvrC0mmhhE1e2FS2+oxypy/ZASutkmtjx3vcBC24PX65nbqkBCRhfjS9kIYPnee8cMagVOhI/3T1fAmdtAWZsCswTJCkQVNa0qWKSKPOpHAUhD9DrbVcyoYkwqhvh17vYAayXLQyKGYdxlUDFp494rBXRjYgO17DDYetNIUj/ezp6S0lnlpEwsWmJMkOwsKXeZKEAjIHn0EQJISaRBcO6UMINz7p/bEjjnw4ft+xmDvksxX4G2rIris7qaeKwAFMP2Oi7n4criuZwtpSUwpfLxSnORSrIqusc5ZFaXysqRWjiZ2DyAWEIL35tVSoQElFACjOeGGSE7AHEQgdo/LSvCOgGBvkxsmDbvlS3Fp5vhaB2TAGqRKrKKMrhLVpaGzEVjZ0OQxDhaCTA+QyRR1d15aQzrJntL3RibsipjG6jlgL4yqbS0sNYg1e84vhbBVrElK64CUcWYXDfKxhpIuxiVJZUxsbMy/uRBKTNRQ4kQ3LdRYLS0rJjRPlTPqY6gdJsEDc+aQXAn+HgsNUCbRuF0Oj0zwnA7bWDkbhO5Ens00qeQhS1laBMl5M/cAaxsLF8rKyql+Tf7ELLEGu/ixiimdCvo0TjfpjKwaggen4eh5v7LokLKbLuyvHhcZG8dhGrEDx7Hg93ZppJF7qBqO3iVveXEDQNInzeoe8Yq6ePaZBZ2JviM3W2UAGotekRCAGq4EkF1X3DOnR11yRsBL1tRa0PVcZiNFXZ2c34FskvomInQQ6lzpJoZbJxk43NwKJFBquJSsrByHydxKOnTxQASBmS3j+JMnsHSla3Ec6K9VWoJVn9zfjwOM7hqYAAqJQwE2a3nA48J2QGegRkpZNivSY+ys3EkKd4oJIwsvIHl3cWgLt5k4NH6OmtLWdpurOkwEMupYc7eMtDRhOcI2ui5JhVIzXzLyto/GAPuZoyo8wkoduVgJglCt7OhGbgID4Mq4si+63zUS1FuFFXFlqyaj2emHlLMcBqYu0FMuR28BbB7lOxRMSiCQXFhCKuwkhZ+pYDiGSgbsKKV8MiSRsuHSIWM9rklRiIlZZuqXjsQK8ooYJMgq3JKWVkhHbhsVxFUzthOWPkYijcbx54IKsSdT+uLr3crGKyoYgFiGR9iBk4kfloUX+JIlQRQqabmpgnhqtpQpb6RVQ1WH5DnrS4hEoGZqaerQ2dhFbz8XePxShmDbo70eISjoorO2vK8SJXI4SUmEU4zWKDzUDtWTYw7xXlbSTEj4FRg7zKnKoGRALv0Gs9Tgc1BpCywGZRQAtqVz2xrBcAMzEpfZwFSa2G5W0QBFjSMapWAEFa3HcGN7CxDzECyIkJ97qwrqWNTWVo876PPsjPkj2wvgroM5lLZKMETKVql/CvnWVFiFa/SzJUQwkoZsr67Y6vlSRV3/2tmNTOY3vnaxYwMuoPKqdzR1w7IqHymlPxaAThfU7Ko2ZXYj4AYJHL+kNdKwRQYESTRa5fsUZ/rVC1TMTyWVyYoqNtuzaHsMyv2tvoarxdfqwYgU1axFo/cnql1FGsqK+uAROV8BX4GU8WcZTATi2q7Qcyi0O0V+GhWBMNRUkn8H1SsWVE5By3Gi0ECqUeJoBfAtDa4amkdXG37AGP5Ggeb84p7UazpoKRzdFzeQ8HkoHGxprKy/Hpm5t12p47J6xTYDEz7uINEXSuxYXvFskYAc+ySxH9sf5ftKzU6IbwVBcUGg5e5FMCEXSErZR0wGayV19woM9guPjTqJdVTqR4uE4nJnLldWVkECCZLd2VLF+xtamex7IpiriSDUpvrpn9lrwGMCHyppMH+ps6LILsuFGUj1XEOXiqbqSHPUKnClpWV68kqtURVNDY4TNaocykoYeTU5ngGEQa/S1DnnE4AeXMcKjHPAmFVjCBENaeyLVNHfr3px8xUstJ94hIpfH4HKE/eDaArK6lSyVVFbdt1gxTIVk3pppVlFXi4pEhVBTObquohU85MLXn1iahvUkHJjSCMc01tLFveVVBx0DodM6jftCu7DOtIzYxrc0qp1JGP2ayYFz2Gb6HvMrO8cnGtV6Gjm3uImSfD2GpWK6uowbZGMxFKQCo1pOMtcMXFpRst+hXGoAomF3sSTBGgTglbBKWwsQ3tZqaYSp0Z1CimRDWFcCJUPYJ00BI5FkKYNoifuQxmN88SWVXWLMaUqqqgC0BmQJR6sk3u9NCf6jYLXxAfqsYEgVLAhRY2AtgtflZNFmFyhxdrLkAdWlk4D88M2ixHyepIdhMHrG/iR1ZGtq0MGpbDbRPYOXeSY1M6Ny4ZstvGSktK+XbFPATj2D371saPEsAMXhXrsZ0km/XStkhhMyBfsa6uXFZe2VCe+YMr1+GKgwrQyNYq1VRrB+EizAow6NsdNKcyVEkYeM73ys6q4kAHp6BiFklTkIrVC5oYV7uzwOGCz4UJ0Stq2lWMJy4wtb+RetL6tZFicnJmBw5UjCvXXMZVJX2MQkbf+XN5EWd78Vz8/JEsMZTBiKNzsm1inLRUQ74H4NidaqI68j5sAFgxcRveC7ieLJXfQYxjZZ2CsiWFewZXJmBIlZ1tdtrX4hSuateKso/RZOtOKW2nmq1oTzeK6dRWAWu2NRVb4hq0SXm1GvtugHrbr5IXqmSktg5CuDE2MSlPwsY5kNE2Wp3AqiZbWVLAxiBF+2iBZbuNj6MB6rsMLC7FyasaYDyo7KkoPyEtw3pEMXfPvxAJi2jAQQgjrz0rLIZSWZlIoNhwd5xK4AR9mYNjWAaLrnuImJeBVN9zBORObVvbr+mTTfFSEJLSRnHo7hEJoIi8MFqjxmvgmF5URZz4zLFgZZ8Ctu2X7ggVccKm9gVxIsOHqxXgNMKnFWZYnf1dBnOhayXq17QwFlWW09eNKyVJFmXqaONGA5aCegMbJ3UUkGY1ic3nKWgjq8qfVYGQG1gRt6rs62a6HiqqUOqdesK5NmX4nGofJoiE1d0dF9lVVkvT1/kEEaaCoYOwFpcVcoLM+7669PxC9rWqktH0sWUYld0VCpuBZ/stVRcGgy9WX2+U1Qthi9SzAqSxzZsy+OiFzBYnySGV6Gku44rD8BCOZBV3BvD5+AKRHNwMEsB6EzHnJpkTAeiUlEGkcECeB6GDZTp5YEJTlvdrknxYjTllMkfNtXwDjM7uVjK5JXUUn43rrqpK2jytaxHW0M5G8DC8rtHMYs7KSgduVQMGTYFqFvVS6rkD3sDJ46afdYFwoq11AOKCBLhvwoUgc8IGANycR6knZrdJPdsuxnyjfd3FovTlRMdEdtOl5CMV5EHsXQBis7TOwvIDZaGj2Vnpbh7cpK63VwYEMLwqbjzyl699sawFFkF1yqjUU31HfC6sW1ZFVFuXVXVgz9keEaw0ys1lWfm+azQAQSWA+hKYVfsZjPncAcUB9oIayy/UZXRNckDGji77GsWbvBo6tPrWPqOyVkBUq+INeqpzNdYs/u0ifh5qmpqIW+33JVSUcwY70KL4U9lYdU6ljtSls7lmfi9g3YzeQfVkaGFaV3ODCnaD2N8wsEDFklE3RzM3ZghdYkWHsszq70FIecnKkVkt8ezMzRq9bkGuKojRLBVSod3Y1yPqKgYW7JRQTPVyy5xIYLjOgxgT52RKJUY1dOrIiRd4futQx/A5AcSmEjz0vFWrkLzvbWAu9HOWbGgxFk1VNTpnBKk6TgwisI/HcxYXP1uAWO72ULFlBTq+aSu2VTUs6hrxM2CF+hEor1VIA9ZmFUaab1lSSgZsVs4sxzHlVLoJHr9H4DhONTkI1XC0/wiY2NoWAG5RlnHFnq6oLccpQddMuJ/O17JVA5OHLi0BqCztq7Y1++ucCd98qLI8MIHBV/cKjxQTme3hFBS3MyCqnDsuym2o80HjvFFTtrURmNaGJsmVahImjTsUXKtQZTAVs7Mvv8/+fzUrZAXcLJ6M4koe6XP0b6SmWWNDzyUpQ8bl+LtWx4tuqZ36cRYV3yuVxPNwvIiqiQCSmu7srgTzR6nkyhpCarXwFy1vGd5iP2cY06lFr5Njhhg1Y6+NB28ftbK83s8rf7kLJbKwDFPbLg25a0AdZJEiqr5phixKMDlRUtcssq1hriLqGoH+zeNgVm9OemjsETV8JdF0NHnkIFxWY1OB4Yrp7rtWJ7NgAAAPXklEQVQ3oNs5nplyVf8u2FoLu1JrHveaZWQjqAkshtFa2gzsSG3Zpkbvg3HafF9slPPlldjFlK80Gysm8Mr4MPhneNWENPGjAIpmilTPATdTRTXlCBYHYAQuPwA36xIpWtGN4q3Y2MhiGsUpuSSnlEJRD8PorC7CFYVw+F51qThgabxsTxWzCGY0ZSsb3lfqAy0OPNjNy8xiQQKsHYFQ2HBZVvVbBuq3m1oWKajqaonsM6uZUr6CjXWNZ0l5E3h3jURma6kP3MJIiy1Lm+kahQq41N2iZja5sjtlLYNZHZrH6qUGm4vMbDp6Rw2CFmvuyFkrBcCyMtFqBaECmsHoK9BZ2LA/lJcRqSaDqnaWbrZdGaz3DLgIvBln4woGztbyJGqslwxkhhHrTjTYFXCtOoKS8uLdofVdAbOylGU6nlYpXWZts4nXBq6WxJitMNokHUJnbnJplQm+aGpY2a5GMV2QD1hRubBPFKdumf5OHkLHz0F9luE5kjBjRa0nFE5CUGqHw32MmjZ6xkgINVnSnZ1VZStK2qKlRaLlQgK7uTq7JFXJwM+3SOEKyhZNI+tJ0I5qMYy9k2qJD7dVWdqKXa0CKNR0Ccjg+B2IYu2fcBZJZkMFgM11r0X92wilghFGgzVnexlqB7xL9mS29SiYUVY2nXOZjNBRsyDsQPRWW5hrZ4XcdC4HVWRbjgJr4sFofK5SzjQ7rhI1UebdPdEbj6sqIvTZQZ5va08rABsAW0UxeWytAk7A2KJ9ZpxzCioB24XFtYAeXYxr6anSqhLgppEqWbGwLunTgrV+IjWlL29ljaAl4EQMGsErp4apeZiquwRXLXAqOCeru32mmydc6oWTSWpFAGdzeTB8RTHVMEtlM90CbbQCYhPjq3egYr1FGdYIQjiuDGZ5zZ/AzobKGOyLxti6c4Rwtv2anyWlLICnlLhxJRXt6A5ebDBWFNONbxWZ2d02mnu4S9YECpeppV1zSWRBWxHYzVIv1CXSouwqqX3jBBBDZdYQbpTQW4ZQlS8r5kH4suSRmg2++3JN10x1PaAmEkmtYlEdeGpJEM6kOuCqCR22oSujj5IV2HdT0zj5prLKTjXFAPjdQlyq7xIBxAQP5yMczG4VxAKw0n6ilZ2QBce2pLulkuxxqnoIzFfgqyqjil9S1VNwBrFmeyeops8yOjZUybZdfS8CuaTIJumzs5tODaNtLpFDQ/PcJGweLhmeL1nB0KqiUDScsiUVD89Di3HtrKtSULw3RLiygZD+7sF8JTObgYsrGvDNUFRGl1iy0Ll1YkUc2aJYMog920I8qW6YDCg1Mqk0JHJFKXkbgbRreI+qpYNOZHrVcDUba7pjsphSJNtK6upgRNAVoOS0mugBeN4bIZgHhuPZ/s1ENaX6KsVr+YNrh1Nb7ipR0PE5zbNRegCbrHRUw6Yf07dLBJl1f8KB9as2V1nNqAsl62LBBhehwalerkHmB1JFIEZKSEusdl5JQj1nJlHXSCF342gJ9CYGrXelknJIXqVP8sD+qtplCR3XH2qfKq0ygMp+KnVkKxNlZ8m2YkIlVMiCnXUwl7qznBKSvQz3m3Pt6oQbXO5b5FixCh/fHxUQW/AEcK6zCNqKQnL9sywqmKuwvqSYzT/aPVNNpVyhvRW21aqciCsjdWvBwILUvh5VyCzbWoC1pJjJ680CWsl+udKB6T5RwG1mlohnlpbg47iz5U9ha0FGtmRLFYBtO99y97Ap0z+ZDTAog6kSLZsMHg/IFkkgp6CpvU2U0cYVSdnmkjwBdOmXbxTWNWzuIbipMioVxEckZEoahSOiy2M3K0jcC1LhVDwaqG0ZvkcWqCnrG4GIxykrqlbWdw6LQyBaZR8HmLRIhQWsHswD42ZXVLNkf9l+FlW0HVQ2lwFsC/Z1FdzlQR0KaPfo+Fdfu+/dwVRICu1CGR7AEIiAhc+AZUF0kOBaPxmUqg4i64vQnU4nFDYJ9Nz+1fVXveH9qmr+kPILx8oKcRV/BFbxbE0JMT0kSD4w6L/lNY8ocsqagVdU3A3MjxhxcGuqzsPH4irpaow1q6OyrVjvp9Npc59E91LldboYVzJWdimWfAW2SNEKcDaX2FmBLLA/uKxlmhh613Is1URQApbKfttwxL02q6Onx5pQxSbPojAg+v5hAnN6LHVRDXIsvKtRjiS0qJUyZTAXVbAK82ElFJWaQdVoqUC1Unt7BVaTQudM6SuqexjQJN4+0icaxv/utbKv83ETbT8H8gjcOKxOJmbUa6OOVXht3dFY6rHv9XoNzFLceEA1o8+pKm0LAHPHZ2rYKjFq0hfZFixsqHJgD3eD5n+U0kb1mFjXkn2lvMSSOsNE/CdIAKF0Sytq6urOHUN5gwg4GZosgbmggM5ucra2qrS2Ig1cbiBBcxYzgzUDNLCvL8GbZXNp6ORy3LmS+Kk83zRIAK6A1ioKa2I9NapIuiUFdfC9766PFZUtqUr6KbWk+zZU1a/ZrIXEztrjTOfz7hwKziCeXIaraHtbZIMz+2pGgazCmw4qWAFvEdhodYp0Xq0pV7G1YWYWbO4qhGq42+Z8BYtrLWvluNPpZAeaFFS1vubPgbgxsqcpnAaszBovKaFoDQ8BGtjfUOl4NAG2nmQV04feJgumvX2fsrQEWZghL0JnVdYkn3DOZIeRN86RqPWCmsvGVqEMRnwxQAxwS8EMYo3IzmY2+BCcLp4MKiuyuhImamlbZFcNoNl7tp+RHd18ZjQIRKyXdFRhN98/hyKqwXWNo7O1wiaXoHN108REZZWEq6grnIfjzeg8jdRf1XEL4kkXa5bBjKxoKaljBjeHlVxQ4GaycpW4lDOAKtnTxHAtOfzOtZwHAM7sqVXkV6yu6kap1nHkXKqWF/4XHqjenNKqBjpR3l1ch3Ejg1+EsgdQhsdG0B4FM9sWAVWpuAyiwTPleZxt9VyZVS2qXfReWqTAilpr9ApoWTjxymit7NwV4JTriZyOA9B0k7HFfULourmKYHVnRQvqGL5HMHdqFcR2qWpmcK6eTwx2dipWrviDilr+fKWq3OWRWdHKwA4eu8wjchbeRzFilqjjZN3ufCpfkJ0/scVpnYk6L0PI77lxdWCZ87WiWm7B/AGquQSnujGKsB8CJmiJq8q1pKIVWyqOiTK66r18BN8r74/AE71fdC3yPS2MxdOpnE1tlVxD9JmVOoggN+r4PjAXVFPa3Eg5jVJGFVUGNolH20GVrUB7BOySWq6WqYQdWR92pcFMYMwckbSgCKCqD67DiiWu1g8MQC9ByfcFqW1L+jL714qNCuznoSxt0da2gtWN1G8F0BK0NN0nuimelUF9dIdAfjO44UT3CjQLoUeLHJFTO3gmpRuIIOvwBQCbqNeo3qtZ9iF6xVK13GRlo4zqimq+CGdTiR1uRY8oqgE02hZBa79kZXPMquxRHKla2saZWN4mRqZUj0vLCKhkjKnqOQHNuSZVJoKvAqS1wpEquvWDC1B2ypwrCPsRMEPVTODMLJMDv6qeKXwi2JYV5Sq4qKyvgGsHCLiuj2jR59V8gMqSJ2FJZRXEHVRHj3sFPrct6OpqlW1GpatQdt0GvwfM6n63InsGVFhJGaBqgqqIV6IsXllZgySPq4R3bnt3wi5cv+cN2yqQLW1T95KYVsWWtKk4cB9W53WQQflQYR6Wl4HaJZjvVE0D5yvq+RKgZCs5qdBEP5sD94cAvQLlSgNaSMAtHx88BuNQ41zdFsX30zKbcs0MLD/ihkpQzl0wiTqKLTfbKmCmyYICnK0IbaieC4CG9iSyLQ7cIMGQwau6TKoq60Apl3WN40LZpca1CKKK9VQyyIEn8w0F8F6CL2h8o3ixGwC7s7EWzCOqmcApYxYD4jsAzVS0sl2t98pA7vrKophCVSonbYpgH6mvSn24pTBV4sdtV3BtMq5k82y+IADvUJ0uAlkCVTxIaPm+UNu/qkV4F1TzHXCGrXIAqItBKypqK99VtAOVs64O4ObX7pHLVCpYHcRmwvLR7TvYAKBBN58LGVzDuFz+hQbWgncQyCZAk+VbsPSouf93261iZgmfCpwRbAvqmSqriU2PwhjaoOyYqtIegVXViTsmyta6bGySpY3gyRrpIyAeaWDDxtpsXwKyalMDKNP7YBXMqEskUsi2uC8FNAPxAKTVfT1o6VzM0E0jF+1rWcUuHvdyg7vgoFplX8HpvHpMCOMRUPHzZkInsqlFKNX/EIO52E0SxSzOwob2VmRLW5D1XIU0rbgM1AzWgyC7fe8G7xUAK/taEBat7luqtyP7EmsaJQOj5F+mrnZfCuYCfBUAWwShyd6pMY/vAHG1UqOYpbI/gy5T0CMKm+UO3gFuC85dgfDVeguPDfITrIBLsLrcgdh3CFgFZjaKJ4Iv3F8ANEqvuxR1tVKOgLoCa1jxboBAkj6v7j/icFbA7f4rfRnQDLRViG13i0vqBQrYVqBbADZT0ZpiHoSzvQpopKIFS3sE1HfBWlHXd0H7LnArqvougMtljHBgZnh3Eoz/BKjLML4Z2Aq0+hEJr9jaVUBbvNzCIUiroC7AWmmFw4o5AK3MtB5VypZMSFgs05JyGVwlwBqsEGAAa2ZU1CjUexXGsE4rKriilBvFzOKKo3AuAroE6QFQU3u8YpNXwS5k+1TZt5UrwouN4KiUEw+k3ZWDp1RXHNRqXb21Ts39945yZSg3VnZFNQ9CF3XeZyr5DgBXKiwCMa2MxeTDYXgP1Fsf9QNKZc0k81RJk3r6EQ3rCmBVyLL75EjZ1pIVDHoFtiOAHoB0BdTVylqBsKKKS+AeBXJVLY+CXASuGvO/Auq7GuEjDfGKg1oKa1z/dmmi9I9SUGNhl0AtfulHAawoYrnSkmNXAVuGEhrEVXvUF+A5Ct2PqNOjDetyna4CmeUolmeXLN4Aq7C5Sj10Q7yjgl+t6CNxSRHmI5X+CpwreYB3Qfdqna4q21KdBuc4GoZsn49ZOOiVinwHqK9WzjvgeweEh2AU5+vtxZ9Cd9Wqkh49V18E5oj6vVyn0RStAyGIO5edXRKd5B0VGVXq2yr3xYp+5Ut+C4QJ4P1N339pQMjRejj4vb/Dcr6rQc3O/0rjmtZpeYCBiCHfCemRbNhbK/pNUPc3wfKy5f2D7OlL3/uPhve/oU4T0F8f+VNM2vyoiv0jK+KHQfdHq+0bncz4oz73/+Y6LbKw1o/5B7eOf1Rl/0du9B9tn/9bvrf/j+v0h6ttn2tp/r/4819y4/zv5391uvzzfwDifz6phT1MPgAAAABJRU5ErkJggg==");background-size:100% 100%;border:none;cursor:pointer;direction:ltr;height:130px;touch-action:manipulation;width:100%}.color-picker .cp-add-color-button-class{background:transparent;border:0;cursor:pointer;display:inline;margin:3px -3px;padding:0;position:absolute}.color-picker .cp-add-color-button-class:hover{text-decoration:underline}.color-picker .cp-add-color-button-class:disabled{color:#999;cursor:not-allowed}.color-picker .cp-add-color-button-class:disabled:hover{text-decoration:none}.color-picker .cp-remove-color-button-class{background:#fff;border-radius:50%;box-shadow:1px 1px 5px #333;cursor:pointer;display:block;height:10px;position:absolute;right:-5px;text-align:center;top:-5px;width:10px}.color-picker .cp-remove-color-button-class:before{bottom:3.5px;content:"x";display:inline-block;font-size:10px;position:relative}'],encapsulation:2}),i})(),Hye=(()=>{class i{constructor(e,n,r,s,a,l){this.injector=e,this.cfr=n,this.appRef=r,this.vcRef=s,this.elRef=a,this._service=l,this.dialogCreated=!1,this.ignoreChanges=!1,this.viewAttachedToAppRef=!1,this.cpWidth="230px",this.cpHeight="auto",this.cpToggle=!1,this.cpDisabled=!1,this.cpIgnoredElements=[],this.cpFallbackColor="",this.cpColorMode="color",this.cpCmykEnabled=!1,this.cpOutputFormat="auto",this.cpAlphaChannel="enabled",this.cpDisableInput=!1,this.cpDialogDisplay="popup",this.cpSaveClickOutside=!0,this.cpCloseClickOutside=!0,this.cpUseRootViewContainer=!1,this.cpPosition="auto",this.cpPositionOffset="0%",this.cpPositionRelativeToArrow=!1,this.cpOKButton=!1,this.cpOKButtonText="OK",this.cpOKButtonClass="cp-ok-button-class",this.cpCancelButton=!1,this.cpCancelButtonText="Cancel",this.cpCancelButtonClass="cp-cancel-button-class",this.cpPresetLabel="Preset colors",this.cpPresetColorsClass="cp-preset-colors-class",this.cpMaxPresetColorsLength=6,this.cpPresetEmptyMessage="No colors added",this.cpPresetEmptyMessageClass="preset-empty-message",this.cpAddColorButton=!1,this.cpAddColorButtonText="Add color",this.cpAddColorButtonClass="cp-add-color-button-class",this.cpRemoveColorButtonClass="cp-remove-color-button-class",this.cpInputChange=new Si(!0),this.cpToggleChange=new Si(!0),this.cpSliderChange=new Si(!0),this.cpSliderDragEnd=new Si(!0),this.cpSliderDragStart=new Si(!0),this.colorPickerOpen=new Si(!0),this.colorPickerClose=new Si(!0),this.colorPickerCancel=new Si(!0),this.colorPickerSelect=new Si(!0),this.colorPickerChange=new Si(!1),this.cpCmykColorChange=new Si(!0),this.cpPresetColorsChange=new Si(!0)}handleClick(){this.inputFocus()}handleFocus(){this.inputFocus()}handleInput(e){this.inputChange(e)}ngOnDestroy(){null!=this.cmpRef&&(this.viewAttachedToAppRef&&this.appRef.detachView(this.cmpRef.hostView),this.cmpRef.destroy(),this.cmpRef=null,this.dialog=null)}ngOnChanges(e){e.cpToggle&&!this.cpDisabled&&(e.cpToggle.currentValue?this.openDialog():e.cpToggle.currentValue||this.closeDialog()),e.colorPicker&&(this.dialog&&!this.ignoreChanges&&("inline"===this.cpDialogDisplay&&this.dialog.setInitialColor(e.colorPicker.currentValue),this.dialog.setColorFromString(e.colorPicker.currentValue,!1),this.cpUseRootViewContainer&&"inline"!==this.cpDialogDisplay&&this.cmpRef.changeDetectorRef.detectChanges()),this.ignoreChanges=!1),(e.cpPresetLabel||e.cpPresetColors)&&this.dialog&&this.dialog.setPresetConfig(this.cpPresetLabel,this.cpPresetColors)}openDialog(){if(this.dialogCreated)this.dialog&&this.dialog.openDialog(this.colorPicker);else{let e=this.vcRef;if(this.dialogCreated=!0,this.viewAttachedToAppRef=!1,this.cpUseRootViewContainer&&"inline"!==this.cpDialogDisplay){const s=this.injector.get(this.appRef.componentTypes[0],Os.NULL);s!==Os.NULL?(e=s.vcRef||s.viewContainerRef||this.vcRef,e===this.vcRef&&console.warn("You are using cpUseRootViewContainer, but the root component is not exposing viewContainerRef!Please expose it by adding 'public vcRef: ViewContainerRef' to the constructor.")):this.viewAttachedToAppRef=!0}const n=this.cfr.resolveComponentFactory(Nye);if(this.viewAttachedToAppRef)this.cmpRef=n.create(this.injector),this.appRef.attachView(this.cmpRef.hostView),document.body.appendChild(this.cmpRef.hostView.rootNodes[0]);else{const r=K_.fromResolvedProviders([],e.parentInjector);this.cmpRef=e.createComponent(n,0,r,[])}this.cmpRef.instance.setupDialog(this,this.elRef,this.colorPicker,this.cpWidth,this.cpHeight,this.cpDialogDisplay,this.cpFallbackColor,this.cpColorMode,this.cpCmykEnabled,this.cpAlphaChannel,this.cpOutputFormat,this.cpDisableInput,this.cpIgnoredElements,this.cpSaveClickOutside,this.cpCloseClickOutside,this.cpUseRootViewContainer,this.cpPosition,this.cpPositionOffset,this.cpPositionRelativeToArrow,this.cpPresetLabel,this.cpPresetColors,this.cpPresetColorsClass,this.cpMaxPresetColorsLength,this.cpPresetEmptyMessage,this.cpPresetEmptyMessageClass,this.cpOKButton,this.cpOKButtonClass,this.cpOKButtonText,this.cpCancelButton,this.cpCancelButtonClass,this.cpCancelButtonText,this.cpAddColorButton,this.cpAddColorButtonClass,this.cpAddColorButtonText,this.cpRemoveColorButtonClass,this.elRef),this.dialog=this.cmpRef.instance,this.vcRef!==e&&this.cmpRef.changeDetectorRef.detectChanges()}}closeDialog(){this.dialog&&"popup"===this.cpDialogDisplay&&this.dialog.closeDialog()}cmykChanged(e){this.cpCmykColorChange.emit(e)}stateChanged(e){this.cpToggleChange.emit(e),e?this.colorPickerOpen.emit(this.colorPicker):this.colorPickerClose.emit(this.colorPicker)}colorChanged(e,n=!0){this.ignoreChanges=n,this.colorPickerChange.emit(e)}colorSelected(e){this.colorPickerSelect.emit(e)}colorCanceled(){this.colorPickerCancel.emit()}inputFocus(){const e=this.elRef.nativeElement,n=this.cpIgnoredElements.filter(r=>r===e);!this.cpDisabled&&!n.length&&("undefined"!=typeof document&&e===document.activeElement?this.openDialog():this.dialog&&this.dialog.show?this.closeDialog():this.openDialog())}inputChange(e){this.dialog?this.dialog.setColorFromString(e.target.value,!0):(this.colorPicker=e.target.value,this.colorPickerChange.emit(this.colorPicker))}inputChanged(e){this.cpInputChange.emit(e)}sliderChanged(e){this.cpSliderChange.emit(e)}sliderDragEnd(e){this.cpSliderDragEnd.emit(e)}sliderDragStart(e){this.cpSliderDragStart.emit(e)}presetColorsChanged(e){this.cpPresetColorsChange.emit(e)}}return i.\u0275fac=function(e){return new(e||i)(B(Os),B(xp),B(Ew),B(Ko),B(ai),B(uV))},i.\u0275dir=Be({type:i,selectors:[["","colorPicker",""]],hostBindings:function(e,n){1&e&&je("click",function(){return n.handleClick()})("focus",function(){return n.handleFocus()})("input",function(s){return n.handleInput(s)})},inputs:{cpWidth:"cpWidth",cpHeight:"cpHeight",cpToggle:"cpToggle",cpDisabled:"cpDisabled",cpIgnoredElements:"cpIgnoredElements",cpFallbackColor:"cpFallbackColor",cpColorMode:"cpColorMode",cpCmykEnabled:"cpCmykEnabled",cpOutputFormat:"cpOutputFormat",cpAlphaChannel:"cpAlphaChannel",cpDisableInput:"cpDisableInput",cpDialogDisplay:"cpDialogDisplay",cpSaveClickOutside:"cpSaveClickOutside",cpCloseClickOutside:"cpCloseClickOutside",cpUseRootViewContainer:"cpUseRootViewContainer",cpPosition:"cpPosition",cpPositionOffset:"cpPositionOffset",cpPositionRelativeToArrow:"cpPositionRelativeToArrow",cpOKButton:"cpOKButton",cpOKButtonText:"cpOKButtonText",cpOKButtonClass:"cpOKButtonClass",cpCancelButton:"cpCancelButton",cpCancelButtonText:"cpCancelButtonText",cpCancelButtonClass:"cpCancelButtonClass",cpPresetLabel:"cpPresetLabel",cpPresetColorsClass:"cpPresetColorsClass",cpMaxPresetColorsLength:"cpMaxPresetColorsLength",cpPresetEmptyMessage:"cpPresetEmptyMessage",cpPresetEmptyMessageClass:"cpPresetEmptyMessageClass",cpAddColorButton:"cpAddColorButton",cpAddColorButtonText:"cpAddColorButtonText",cpAddColorButtonClass:"cpAddColorButtonClass",cpRemoveColorButtonClass:"cpRemoveColorButtonClass",colorPicker:"colorPicker",cpPresetColors:"cpPresetColors"},outputs:{cpInputChange:"cpInputChange",cpToggleChange:"cpToggleChange",cpSliderChange:"cpSliderChange",cpSliderDragEnd:"cpSliderDragEnd",cpSliderDragStart:"cpSliderDragStart",colorPickerOpen:"colorPickerOpen",colorPickerClose:"colorPickerClose",colorPickerCancel:"colorPickerCancel",colorPickerSelect:"colorPickerSelect",colorPickerChange:"colorPickerChange",cpCmykColorChange:"cpCmykColorChange",cpPresetColorsChange:"cpPresetColorsChange"},exportAs:["ngxColorPicker"],features:[Ls]}),i})(),Vye=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({providers:[uV],imports:[[ka]]}),i})();const zye=["imageloader"],Uye=["sketch"];let Gye=(()=>{class i{constructor(e,n){this._dialogRef=e,this._data=n,this.color="#000000",this.linesize=i.DEFAULT_LINESIZE,this.preset=["#FF6347","#FF4500","#FF0000","#DC143C","#B22222","#8B0000","#00FF00","#32CD32","#00FF00","#ADFF2F","#6B8E23","#556B2F","#87CEFA","#00BFFF","#0000FF","#0000CD","#00008B","#191970","#E0FFFF","#AFEEEE","#00FFFF","#7FFFD4","#40E0D0","#00CED1","#DDA0DD","#EE82EE","#FF00FF","#BA55D3","#9400D3","#800080","#FFFFE0","#FAFACD","#FFFF00","#F0E68C","#FFE4B5","#FFD700","#FFD9C2","#FFDBAC","#F1C27D","#E0AC69","#C68642","#8D5524","#FFFFFF","#DCDCDC","#C0C0C0","#808080","#696969","#000000"],e.disableClose=!0}ngAfterViewInit(){this._data&&"string"==typeof this._data&&this._sketchpad.setImageBase64(this._data),this._sketchpad.setLineSize(this.linesize),this._sketchpad.setActiveColor(this.color)}onFileAvailable(e){this._sketchpad.setImageBase64(window.URL.createObjectURL(e.target.files[0])),this.imageloader.nativeElement.value=null}onColorChange(e){this._sketchpad.setActiveColor(e)}onLineSizeChange(){this._sketchpad.setLineSize(this.linesize)}onClearCanvasClicked(){this._sketchpad.clearCanvas()}onFillCanvasClicked(){this._sketchpad.fillCanvas()}onLoadImage(){this.imageloader.nativeElement.click()}close(){this._dialogRef.close(this._sketchpad.getImageBase64())}}return i.DEFAULT_LINESIZE=10,i.\u0275fac=function(e){return new(e||i)(B(Ip),B(Cy))},i.\u0275cmp=ei({type:i,selectors:[["app-sketchpad"]],viewQuery:function(e,n){if(1&e&&(ji(zye,5),ji(Uye,5)),2&e){let r;jt(r=qt())&&(n.imageloader=r.first),jt(r=qt())&&(n._sketchpad=r.first)}},decls:26,vars:13,consts:[["color","primary"],["matTooltip","Pencil size"],[1,"spacer-tiny"],["max","100","min","1","step","1","tickInterval","auto",3,"ngModel","change","ngModelChange"],[1,"spacer-flex"],["mat-icon-button","","matTooltip","Fill canvas with color.",3,"click"],["mat-icon-button","","matTooltip","Clear canvas.",3,"click"],["mat-icon-button","","matTooltip","Load image from computer.",3,"click"],["mat-icon-button","",3,"click"],["matTooltip","Close window and save."],[3,"height","width"],["sketch",""],["hidden","","type","file",3,"change"],["imageloader",""],[1,"picker"],[3,"colorPicker","cpAlphaChannel","cpDialogDisplay","cpPresetColors","cpToggle","cpUseRootViewContainer","colorPickerChange"]],template:function(e,n){1&e&&(Z(0,"mat-dialog-content")(1,"mat-toolbar",0)(2,"mat-icon",1),ue(3,"border_color"),J(),yt(4,"span",2),Z(5,"mat-slider",3),je("change",function(){return n.onLineSizeChange()})("ngModelChange",function(s){return n.linesize=s}),J(),yt(6,"span",4),Z(7,"button",5),je("click",function(){return n.onFillCanvasClicked()}),Z(8,"mat-icon"),ue(9,"format_color_fill"),J()(),Z(10,"button",6),je("click",function(){return n.onClearCanvasClicked()}),Z(11,"mat-icon"),ue(12,"delete"),J()(),yt(13,"span",4),Z(14,"button",7),je("click",function(){return n.onLoadImage()}),Z(15,"mat-icon"),ue(16,"file_upload"),J()(),Z(17,"button",8),je("click",function(){return n.close()}),Z(18,"mat-icon",9),ue(19,"close"),J()()(),yt(20,"app-sketch-canvas",10,11),Z(22,"input",12,13),je("change",function(s){return n.onFileAvailable(s)}),J(),Z(24,"div",14)(25,"span",15),je("colorPickerChange",function(s){return n.onColorChange(s)})("colorPickerChange",function(s){return n.color=s}),J()()()),2&e&&(se(5),A("min-width","100px"),fe("ngModel",n.linesize),se(15),fe("height",450)("width",450),se(5),A("display","none"),fe("colorPicker",n.color)("cpAlphaChannel","disabled")("cpDialogDisplay","inline")("cpPresetColors",n.preset)("cpToggle",!0)("cpUseRootViewContainer",!0))},directives:[cS,My,vo,Fo,Ey,ah,lh,Mo,cV,Hye],styles:["mat-dialog-content[_ngcontent-%COMP%]{display:grid;grid-template-columns:60% 40%;grid-template-rows:64px auto;grid-column-gap:5px;grid-row-gap:5px;max-height:100%}mat-toolbar[_ngcontent-%COMP%]{grid-column:1 / span 2;grid-row:1 / span 1}app-sketch-canvas[_ngcontent-%COMP%]{grid-column:1 / span 1;grid-row:2 / span 1;justify-self:start}div.picker[_ngcontent-%COMP%]{grid-column:2 / span 1;grid-row:2 / span 1;justify-self:end}mat-slider[_ngcontent-%COMP%]{width:200px}"]}),i})();const Wye=["previewimg"];let jye=(()=>{class i{constructor(e,n,r){this._dialog=e,this._resolver=n,this._http=r,this.sliderSetting=1}ngOnInit(){if(this.imageTerm.data)return this.applyImageData(this.imageTerm.data),void(this.sliderSetting=this.imageTerm.sliderSetting);this.onSettingsChanged(null)}onSettingsChanged(e){switch(this.imageTerm.sliderSetting=this.sliderSetting,this.sliderSetting){case 0:case 1:default:this.imageTerm.setCategories(["globalcolor","localcolor"]);break;case 2:this.imageTerm.setCategories(["globalcolor","localcolor","edge"]);break;case 3:case 4:this.imageTerm.setCategories(["localcolor","localfeatures","edge"])}}onViewerClicked(){this.openSketchDialog(this.previewimg.nativeElement.src)}onViewerDragEnter(e){e.preventDefault(),e.target.classList.add("ondrag")}onViewerDragOver(e){e.preventDefault()}onViewerDragExit(e){e.preventDefault(),e.target.classList.remove("ondrag")}onViewerDropped(e){e.preventDefault(),e.stopPropagation(),e.target.classList.remove("ondrag");const n=new FileReader;if(n.addEventListener("load",()=>{this.applyImageData(n.result)}),e.dataTransfer.files.length>0)n.readAsDataURL(e.dataTransfer.files.item(0));else if(e.dataTransfer.getData("application/vitrivr-mediasegment")){const r=xy.fromJSON(e.dataTransfer.getData(xy.FORMAT)),s=this._resolver.pathToThumbnail(r.object,r.segment);this._http.get(s,{responseType:"blob"}).pipe(Xl()).subscribe(a=>{n.readAsDataURL(a)})}}applyImageData(e){this.previewimg.nativeElement.src=e,this.imageTerm.data=e}openSketchDialog(e){this._dialog.open(Gye,{data:e,width:"750px",height:"690px"}).afterClosed().pipe(Xl()).subscribe(r=>{r&&this.applyImageData(r)})}}return i.\u0275fac=function(e){return new(e||i)(B(Lu),B(Ts),B(ma))},i.\u0275cmp=ei({type:i,selectors:[["app-qt-image"]],viewQuery:function(e,n){if(1&e&&ji(Wye,7),2&e){let r;jt(r=qt())&&(n.previewimg=r.first)}},inputs:{imageTerm:"imageTerm"},decls:10,vars:1,consts:[["matTooltip","Click to change image...","width","150",1,"previewimg",2,"background-image","url('assets/images/transparent.png')",3,"click","dragenter","dragleave","dragover","drop"],["previewimg",""],[2,"display","flex","align-items","center","justify-content","center"],["matTooltip","Rough sketch",1,"muted"],[1,"toolbar-spacer-small"],["max","4","min","0","step","1","value","2",3,"ngModel","change","ngModelChange"],["matTooltip","Example image",1,"muted"]],template:function(e,n){1&e&&(Z(0,"img",0,1),je("click",function(){return n.onViewerClicked()})("dragenter",function(s){return n.onViewerDragEnter(s)})("dragleave",function(s){return n.onViewerDragExit(s)})("dragover",function(s){return n.onViewerDragOver(s)})("drop",function(s){return n.onViewerDropped(s)}),J(),Z(2,"div",2)(3,"mat-icon",3),ue(4,"brush"),J(),yt(5,"div",4),Z(6,"mat-slider",5),je("change",function(s){return n.onSettingsChanged(s)})("ngModelChange",function(s){return n.sliderSetting=s}),J(),yt(7,"div",4),Z(8,"mat-icon",6),ue(9,"insert_photo"),J()()),2&e&&(se(6),fe("ngModel",n.sliderSetting))},directives:[Fo,vo,Ey,ah,lh],styles:["img.previewimg[_ngcontent-%COMP%]{width:150px;height:150px;border:rgb(235,235,235) solid .5px;display:inline-block}img.ondrag[_ngcontent-%COMP%]{border:solid 2px}"]}),i})();class hV{static toTimer(t){let e=t/1e3,n=0,r=0;return e>3600&&(r=Math.floor(e/3600),e-=3600*r),e>60&&(n=Math.floor(e/60),e-=60*n),e=Math.floor(e),(r<10?"0"+r:r)+":"+(n<10?"0"+n:n)+":"+(e<10?"0"+e:e)}}class dV{static toWav(t,e,n){return dV.resample(t,e,n).then(r=>{const s=r.length*r.numberOfChannels*2,a=new ArrayBuffer(44+s),l=new DataView(a);return this.writeWavHeader(l,s,r.sampleRate,1),this.floatToShortPCM(l,r,44),new Blob([l],{type:"audio/wav"})})}static resample(t,e,n){if(t.sampleRate===n&&t.numberOfChannels===e)return Promise.resolve(t);const s=new OfflineAudioContext(e,Math.ceil(t.length*(n/t.sampleRate)),n),a=s.createBufferSource();return a.buffer=t,a.connect(s.destination),a.start(),s.startRendering()}static writeWavHeader(t,e,n,r){this.writeString(t,0,"RIFF"),t.setUint32(4,36+e,!0),this.writeString(t,8,"WAVE"),this.writeString(t,12,"fmt "),t.setUint32(16,16,!0),t.setUint16(20,1,!0),t.setUint16(22,r,!0),t.setUint32(24,n,!0),t.setUint32(28,4*n,!0),t.setUint16(32,2*r,!0),t.setUint16(34,16,!0),this.writeString(t,36,"data"),t.setUint32(40,e,!0)}static writeString(t,e,n){for(let r=0;r<n.length;r++)t.setUint8(e+r,n.charCodeAt(r))}static floatToShortPCM(t,e,n){for(let r=0;r<e.length;r+=1,n+=2)for(let s=0;s<e.numberOfChannels;s++){const a=Math.max(-1,Math.min(1,e.getChannelData(s)[r]));t.setInt16(n,a<0?32768*a:32767*a,!0)}}}const Xye=["visualize"];let Zye=(()=>{class i{constructor(){this.width=400,this.height=150,this.recording=!1,this.playing=!1}ngOnInit(){navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(e=>this.onStreamAvailable(e),e=>this.onStreamError(e)),this.audiocontext=new AudioContext,this.setupAudioNodes()}ngOnDestroy(){this.stop(),this.stream&&(this.stream.getTracks().forEach(e=>{e.stop()}),this.stream=null),this.audiocontext&&(this.audiocontext.close(),this.audiocontext=null)}record(){void 0!==this.audiocontext&&void 0!==this.stream&&!this.recording&&!this.playing&&(this.recordingBuffer=null,this.wireRecording(),this.recording=!0)}recordingAvailable(){return null!==this.source}play(){void 0!==this.audiocontext&&!this.recording&&!this.playing&&this.recordingBuffer&&(this.playing=!0,this.bufferSource=this.audiocontext.createBufferSource(),this.bufferSource.buffer=this.recordingBuffer,this.wirePlayback(),this.bufferSource.start(),this.bufferSource.onended=()=>{this.wireIdle(),this.playing=!1})}stop(){void 0!==this.audiocontext&&(this.recording&&(this.recording=!1),this.playing&&(this.bufferSource.stop(),this.bufferSource=null),this.wireIdle())}isRecording(){return this.recording}isPlaying(){return this.playing}duration(){return this.recordingBuffer?this.recordingBuffer.duration:0}length(){return this.recordingBuffer?this.recordingBuffer.length:0}sampleRate(){return this.recordingBuffer?this.recordingBuffer.sampleRate:0}channels(){return this.recordingBuffer?this.recordingBuffer.numberOfChannels:0}data(){return this.recordingBuffer}supportsRecording(){return void 0!==this.audiocontext&&void 0!==this.stream}loadAudioFromBuffer(e){void 0!==this.audiocontext&&!this.recording&&this.audiocontext.decodeAudioData(e,n=>{this.recordingBuffer=n})}loadAudioFromFile(e){(this.isPlaying()||this.isRecording())&&this.stop();const n=new FileReader;n.addEventListener("load",()=>{this.loadAudioFromBuffer(n.result)}),n.readAsArrayBuffer(e)}onRecorderDragOver(e){e.preventDefault()}onRecorderDropped(e){e.preventDefault(),e.stopPropagation(),e.dataTransfer.files.length>0&&this.loadAudioFromFile(e.dataTransfer.files.item(0))}onStreamAvailable(e){this.stream=e,this.source=this.audiocontext.createMediaStreamSource(this.stream),this.wireIdle(),this.visualize()}onStreamError(e){console.log(e),this.wireIdle(),this.visualize()}wireRecording(){this.unwire(),this.source&&(this.source.connect(this.analyser),this.analyser.connect(this.processor),this.processor.connect(this.audiocontext.destination))}wirePlayback(){this.unwire(),this.bufferSource&&(this.bufferSource.connect(this.analyser),this.analyser.connect(this.audiocontext.destination))}wireIdle(){this.unwire(),this.source&&this.source.connect(this.analyser)}unwire(){this.source&&this.source.disconnect(),this.analyser&&this.analyser.disconnect(),this.processor&&this.processor.disconnect(),this.bufferSource&&this.bufferSource.disconnect()}setupAudioNodes(){void 0!==this.audiocontext&&(this.analyser=this.audiocontext.createAnalyser(),this.processor=this.audiocontext.createScriptProcessor(),this.processor.onaudioprocess=e=>this.process(e.inputBuffer),this.bufferSource=this.audiocontext.createBufferSource(),this.analyser.fftSize=2048,this.frequencyBinCount=this.analyser.frequencyBinCount,this.visualizationDataArray=new Uint8Array(this.frequencyBinCount),this.wireIdle())}process(e){let n;n=this.audiocontext.createBuffer(e.numberOfChannels,null===this.recordingBuffer?e.length:this.recordingBuffer.length+e.length,e.sampleRate);for(let r=0;r<e.numberOfChannels;r++)null!==this.recordingBuffer?(n.copyToChannel(this.recordingBuffer.getChannelData(r),r,0),n.copyToChannel(e.getChannelData(r),r,this.recordingBuffer.length)):n.copyToChannel(e.getChannelData(r),r,0);this.recordingBuffer=n}visualize(){window.requestAnimationFrame(()=>this.visualize());const n=this.canvas.nativeElement.getContext("2d"),r=n.canvas.width/this.frequencyBinCount*2.5;let s,a=0;this.analyser.getByteFrequencyData(this.visualizationDataArray),n.fillStyle="#000000",n.fillRect(0,0,n.canvas.width,n.canvas.height);for(let u=0;u<this.frequencyBinCount;u++)s=this.visualizationDataArray[u],this.playing&&(n.fillStyle="rgb(50,"+(s+100)+",50)"),this.recording&&(n.fillStyle="rgb("+(s+100)+",50,50)"),!this.playing&&!this.recording&&(n.fillStyle="rgb(50,50,"+(s+100)+")"),n.fillRect(a,n.canvas.height-s/2,r,s/2),a+=r+1}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=ei({type:i,selectors:[["app-record-audio"]],viewQuery:function(e,n){if(1&e&&ji(Xye,5),2&e){let r;jt(r=qt())&&(n.canvas=r.first)}},inputs:{width:"width",height:"height"},decls:2,vars:2,consts:[[3,"width","height","drop","dragover"]],template:function(e,n){1&e&&(Z(0,"div")(1,"canvas",0),je("drop",function(s){return n.onRecorderDropped(s)})("dragover",function(s){return n.onRecorderDragOver(s)}),J()()),2&e&&(se(1),_o("width",n.width),_o("height",n.height))},encapsulation:2}),i})();const Yye=["audioloader"],Kye=["recorder"];function Qye(i,t){if(1&i){const e=Wi();Z(0,"button",2),je("click",function(){return gt(e),Re().onRecordButtonPressed()}),Z(1,"mat-icon"),ue(2," fiber_manual_record "),J()()}if(2&i){Re();const e=Yo(17);se(1),Vi("class",e.isRecording()?"material-icons rec-active":"material-icons")}}let Jye=(()=>{class i{constructor(e,n){this.dialogRef=e,this._data=n,this.status="Idle"}get recorder(){return this._recorder}get statustext(){return this._statustext}ngOnInit(){this._data&&this._data instanceof File&&this._recorder.loadAudioFromFile(this._data),this._data=null,this._timer=ay(0,500).pipe(function qye(i=_k){return Ui(t=>({value:t,timestamp:i.now()}))}()).subscribe(e=>{this._recorder.isPlaying()&&"Playing"!==this.status?(this.start=e.timestamp,this.status="Playing"):this._recorder.isRecording()&&"Recording"!==this.status?(this.start=e.timestamp,this.status="Recording"):this._recorder.isPlaying()||this._recorder.isRecording()||"Idle"===this.status?"Recording"===this.status?this._statustext="Recording: "+hV.toTimer(e.timestamp-this.start):"Playing"===this.status?this._statustext="Playing: "+hV.toTimer(e.timestamp-this.start)+" / "+hV.toTimer(1e3*this._recorder.duration()):"Idle"===this.status&&(this._statustext=this._recorder.length()>0?"Idle (Audio available)":"Idle (No audio)"):(this.start=0,this.status="Idle")})}ngOnDestroy(){this._timer.unsubscribe()}onFileAvailable(e){this._recorder.loadAudioFromFile(e.target.files[0]),this.audioloader.nativeElement.value=null}onRecordButtonPressed(){this._recorder.isRecording()?this._recorder.stop():this._recorder.isPlaying()?(this._recorder.stop(),this._recorder.record()):this._recorder.record()}onPlayButtonPressed(){this._recorder.isPlaying()?this._recorder.stop():this._recorder.isRecording()?(this._recorder.stop(),this._recorder.play()):this._recorder.play()}onLoadAudioPressed(){this.audioloader.nativeElement.click()}onSaveButtonPressed(){this._recorder.data()?this.dialogRef.close(dV.toWav(this._recorder.data(),1,22050)):this.dialogRef.close()}}return i.\u0275fac=function(e){return new(e||i)(B(Ip),B(Cy,8))},i.\u0275cmp=ei({type:i,selectors:[["app-audio-recorder"]],viewQuery:function(e,n){if(1&e&&(ji(Yye,5),ji(Kye,5)),2&e){let r;jt(r=qt())&&(n.audioloader=r.first),jt(r=qt())&&(n._recorder=r.first)}},decls:20,vars:3,consts:[["color","primary"],["mat-icon-button","",3,"click",4,"ngIf"],["mat-icon-button","",3,"click"],[1,"spacer-tiny"],[1,"label",2,"color","white"],[1,"spacer-flex"],["recorder",""],["hidden","","type","file",3,"change"],["audioloader",""]],template:function(e,n){if(1&e&&(Z(0,"mat-toolbar",0),Ue(1,Qye,3,1,"button",1),Z(2,"button",2),je("click",function(){return n.onPlayButtonPressed()}),Z(3,"mat-icon"),ue(4,"play_arrow "),J()(),yt(5,"span",3),Z(6,"span",4),ue(7),J(),yt(8,"span",5),Z(9,"button",2),je("click",function(){return n.onLoadAudioPressed()}),Z(10,"mat-icon"),ue(11,"file_upload"),J()(),yt(12,"span",3),Z(13,"button",2),je("click",function(){return n.onSaveButtonPressed()}),Z(14,"mat-icon"),ue(15,"save"),J()()(),yt(16,"app-record-audio",null,6),Z(18,"input",7,8),je("change",function(s){return n.onFileAvailable(s)}),J()),2&e){const r=Yo(17);se(1),fe("ngIf",r.recordingAvailable()),se(2),Vi("class",r.isPlaying()?"material-icons play-active":"material-icons"),se(4),Xt(n.statustext)}},directives:[My,ms,Mo,vo,Zye],styles:[".play-active[_ngcontent-%COMP%]{color:green;text-shadow:0 0 6px #009800}",".rec-active[_ngcontent-%COMP%]{color:#980000;text-shadow:0 0 6px #B00000}"]}),i})();const $ye=["player"];let eve=(()=>{class i{constructor(e,n){this.dialog=e,this._snackBar=n}ngOnInit(){this.audioTerm.data&&(this.sliderSetting=this.audioTerm.sliderSetting,this._snackBar.open("Transferring audio between stages is currently not supported","",{duration:5e3}))}onSliderChanged(e){switch(this.audioTerm.sliderSetting=this.sliderSetting,this.sliderSetting){case 0:this.audioTerm.setCategories(["audiofingerprint"]);break;case 1:default:this.audioTerm.setCategories(["audiofingerprint","audiomatching"]);break;case 2:this.audioTerm.setCategories(["audiomatching","hpcpaverage"]);break;case 3:this.audioTerm.setCategories(["audiomelody","pitchsequence"]);break;case 4:this.audioTerm.setCategories(["pitchsequence"])}}onViewerClicked(){this.openAudioRecorderDialog()}onAudioDragEnter(e){e.preventDefault(),e.target.classList.add("ondrag")}onAudioDragOver(e){e.preventDefault()}onAudioDragExit(e){e.preventDefault(),e.target.classList.remove("ondrag")}onAudioDropped(e){if(e.preventDefault(),e.stopPropagation(),e.target.classList.remove("ondrag"),e.dataTransfer.files.length>0){const n=e.dataTransfer.files.item(0);this.openAudioRecorderDialog(n)}}openAudioRecorderDialog(e){const r=this.dialog.open(Jye,{data:e}).afterClosed().pipe(Xl()).subscribe(s=>{s&&s.then(a=>{this.player.nativeElement.src=URL.createObjectURL(a);const l=new FileReader;l.onloadend=()=>{this.audioTerm.data=l.result},l.readAsDataURL(a)}),r.unsubscribe()})}}return i.\u0275fac=function(e){return new(e||i)(B(Lu),B(Ru))},i.\u0275cmp=ei({type:i,selectors:[["app-qt-audio"]],viewQuery:function(e,n){if(1&e&&ji($ye,5),2&e){let r;jt(r=qt())&&(n.player=r.first)}},inputs:{audioTerm:"audioTerm"},decls:14,vars:1,consts:[[2,"display","flex","align-items","center","justify-content","center"],["controls","",1,"preview",3,"click","dragenter","dragleave","dragover","drop"],["player",""],["mat-icon-button","","matTooltip","Click to change audio clip...",3,"click"],["matTooltip","Audio fingerprinting",1,"muted"],[1,"toolbar-spacer-small"],["max","4","min","0","step","1","value","1",3,"ngModel","change","ngModelChange"],["matTooltip","Query-by-Humming",1,"muted"]],template:function(e,n){1&e&&(Z(0,"div",0)(1,"audio",1,2),je("click",function(){return n.onViewerClicked()})("dragenter",function(s){return n.onAudioDragEnter(s)})("dragleave",function(s){return n.onAudioDragExit(s)})("dragover",function(s){return n.onAudioDragOver(s)})("drop",function(s){return n.onAudioDropped(s)}),J(),Z(3,"button",3),je("click",function(){return n.onViewerClicked()}),Z(4,"mat-icon"),ue(5,"more_horiz"),J()()(),Z(6,"div",0)(7,"mat-icon",4),ue(8,"fingerprint"),J(),yt(9,"div",5),Z(10,"mat-slider",6),je("change",function(s){return n.onSliderChanged(s)})("ngModelChange",function(s){return n.sliderSetting=s}),J(),yt(11,"div",5),Z(12,"mat-icon",7),ue(13,"record_voice_over"),J()()),2&e&&(se(10),fe("ngModel",n.sliderSetting))},directives:[Mo,Fo,vo,Ey,ah,lh],styles:["audio.preview[_ngcontent-%COMP%]{width:150px}audio.ondrag[_ngcontent-%COMP%]{border:solid 2px}"]}),i})();function eX(i,t,e,n,r,s,a){try{var l=i[s](a),u=l.value}catch(h){return void e(h)}l.done?t(u):Promise.resolve(u).then(n,r)}function DT(i){return function(){var t=this,e=arguments;return new Promise(function(n,r){var s=i.apply(t,e);function a(u){eX(s,n,r,a,l,"next",u)}function l(u){eX(s,n,r,a,l,"throw",u)}a(void 0)})}}const HP="137",tve={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},ive={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},tX=0,fV=1,iX=2,nve=3,rve=0,pV=1,nX=2,gS=3,l0=0,Al=1,c0=2,mV=1,sve=2,fg=0,_S=1,gV=2,_V=3,yV=4,rX=5,u0=100,sX=101,oX=102,vV=103,bV=104,aX=200,lX=201,cX=202,uX=203,xV=204,wV=205,hX=206,dX=207,fX=208,pX=209,mX=210,gX=0,_X=1,yX=2,VP=3,vX=4,bX=5,xX=6,wX=7,RT=0,SX=1,CX=2,pg=0,MX=1,TX=2,EX=3,AX=4,DX=5,zP=300,h0=301,d0=302,kT=303,PT=304,yS=306,IT=307,LT=1e3,Kc=1001,OT=1002,Dl=1003,UP=1004,ove=1004,GP=1005,ave=1005,Ka=1006,SV=1007,lve=1007,f0=1008,cve=1008,mg=1009,RX=1010,kX=1011,vS=1012,PX=1013,FT=1014,gg=1015,p0=1016,IX=1017,LX=1018,m0=1020,OX=1021,Qc=1023,FX=1024,BX=1025,Ay=1026,g0=1027,NX=1028,HX=1029,VX=1030,zX=1031,UX=1033,WP=33776,jP=33777,qP=33778,XP=33779,CV=35840,MV=35841,TV=35842,EV=35843,GX=36196,AV=37492,DV=37496,RV=37808,kV=37809,PV=37810,IV=37811,LV=37812,OV=37813,FV=37814,BV=37815,NV=37816,HV=37817,VV=37818,zV=37819,UV=37820,GV=37821,WV=36492,WX=2200,jX=2201,qX=2202,BT=2300,NT=2301,ZP=2302,_0=2400,y0=2401,HT=2402,YP=2500,jV=2501,XX=0,uve=1,hve=2,_g=3e3,ba=3001,ZX=3200,YX=3201,v0=0,KX=1,dve=0,KP=7680,fve=7681,pve=7682,mve=7683,gve=34055,_ve=34056,yve=5386,vve=512,bve=513,xve=514,wve=515,Sve=516,Cve=517,Mve=518,QX=519,bS=35044,xS=35048,Tve=35040,Eve=35045,Ave=35049,Dve=35041,Rve=35046,kve=35050,Pve=35042,Ive="100",qV="300 es",QP=1035;class Dy{addEventListener(t,e){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)}hasEventListener(t,e){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)}removeEventListener(t,e){if(void 0===this._listeners)return;const r=this._listeners[t];if(void 0!==r){const s=r.indexOf(e);-1!==s&&r.splice(s,1)}}dispatchEvent(t){if(void 0===this._listeners)return;const n=this._listeners[t.type];if(void 0!==n){t.target=this;const r=n.slice(0);for(let s=0,a=r.length;s<a;s++)r[s].call(this,t);t.target=null}}}const Jc=[];for(let i=0;i<256;i++)Jc[i]=(i<16?"0":"")+i.toString(16);let JP=1234567;const b0=Math.PI/180,VT=180/Math.PI;function Nh(){const i=4294967295*Math.random()|0,t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(Jc[255&i]+Jc[i>>8&255]+Jc[i>>16&255]+Jc[i>>24&255]+"-"+Jc[255&t]+Jc[t>>8&255]+"-"+Jc[t>>16&15|64]+Jc[t>>24&255]+"-"+Jc[63&e|128]+Jc[e>>8&255]+"-"+Jc[e>>16&255]+Jc[e>>24&255]+Jc[255&n]+Jc[n>>8&255]+Jc[n>>16&255]+Jc[n>>24&255]).toUpperCase()}function $c(i,t,e){return Math.max(t,Math.min(e,i))}function XV(i,t){return(i%t+t)%t}function zT(i,t,e){return(1-e)*i+e*t}function ZV(i){return 0==(i&i-1)&&0!==i}function JX(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function $X(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}var eZ=Object.freeze({__proto__:null,DEG2RAD:b0,RAD2DEG:VT,generateUUID:Nh,clamp:$c,euclideanModulo:XV,mapLinear:function Lve(i,t,e,n,r){return n+(i-t)*(r-n)/(e-t)},inverseLerp:function Ove(i,t,e){return i!==t?(e-i)/(t-i):0},lerp:zT,damp:function Fve(i,t,e,n){return zT(i,t,1-Math.exp(-e*n))},pingpong:function Bve(i,t=1){return t-Math.abs(XV(i,2*t)-t)},smoothstep:function Nve(i,t,e){return i<=t?0:i>=e?1:(i=(i-t)/(e-t))*i*(3-2*i)},smootherstep:function Hve(i,t,e){return i<=t?0:i>=e?1:(i=(i-t)/(e-t))*i*i*(i*(6*i-15)+10)},randInt:function Vve(i,t){return i+Math.floor(Math.random()*(t-i+1))},randFloat:function zve(i,t){return i+Math.random()*(t-i)},randFloatSpread:function Uve(i){return i*(.5-Math.random())},seededRandom:function Gve(i){return void 0!==i&&(JP=i%2147483647),JP=16807*JP%2147483647,(JP-1)/2147483646},degToRad:function Wve(i){return i*b0},radToDeg:function jve(i){return i*VT},isPowerOfTwo:ZV,ceilPowerOfTwo:JX,floorPowerOfTwo:$X,setQuaternionFromProperEuler:function qve(i,t,e,n,r){const s=Math.cos,a=Math.sin,l=s(e/2),u=a(e/2),h=s((t+n)/2),m=a((t+n)/2),_=s((t-n)/2),v=a((t-n)/2),S=s((n-t)/2),T=a((n-t)/2);switch(r){case"XYX":i.set(l*m,u*_,u*v,l*h);break;case"YZY":i.set(u*v,l*m,u*_,l*h);break;case"ZXZ":i.set(u*_,u*v,l*m,l*h);break;case"XZX":i.set(l*m,u*T,u*S,l*h);break;case"YXY":i.set(u*S,l*m,u*T,l*h);break;case"ZYZ":i.set(u*T,u*S,l*m,l*h);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}});class Oi{constructor(t=0,e=0){this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,n=this.y,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6],this.y=r[1]*e+r[4]*n+r[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y;return e*e+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const n=Math.cos(e),r=Math.sin(e),s=this.x-t.x,a=this.y-t.y;return this.x=s*n-a*r+t.x,this.y=s*r+a*n+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}Oi.prototype.isVector2=!0;class pc{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(t,e,n,r,s,a,l,u,h){const m=this.elements;return m[0]=t,m[1]=r,m[2]=l,m[3]=e,m[4]=s,m[5]=u,m[6]=n,m[7]=a,m[8]=h,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this}extractBasis(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,r=e.elements,s=this.elements,a=n[0],l=n[3],u=n[6],h=n[1],m=n[4],_=n[7],v=n[2],S=n[5],T=n[8],I=r[0],j=r[3],P=r[6],E=r[1],ie=r[4],ee=r[7],ce=r[2],ye=r[5],Ce=r[8];return s[0]=a*I+l*E+u*ce,s[3]=a*j+l*ie+u*ye,s[6]=a*P+l*ee+u*Ce,s[1]=h*I+m*E+_*ce,s[4]=h*j+m*ie+_*ye,s[7]=h*P+m*ee+_*Ce,s[2]=v*I+S*E+T*ce,s[5]=v*j+S*ie+T*ye,s[8]=v*P+S*ee+T*Ce,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[1],r=t[2],s=t[3],a=t[4],l=t[5],u=t[6],h=t[7],m=t[8];return e*a*m-e*l*h-n*s*m+n*l*u+r*s*h-r*a*u}invert(){const t=this.elements,e=t[0],n=t[1],r=t[2],s=t[3],a=t[4],l=t[5],u=t[6],h=t[7],m=t[8],_=m*a-l*h,v=l*u-m*s,S=h*s-a*u,T=e*_+n*v+r*S;if(0===T)return this.set(0,0,0,0,0,0,0,0,0);const I=1/T;return t[0]=_*I,t[1]=(r*h-m*n)*I,t[2]=(l*n-r*a)*I,t[3]=v*I,t[4]=(m*e-r*u)*I,t[5]=(r*s-l*e)*I,t[6]=S*I,t[7]=(n*u-h*e)*I,t[8]=(a*e-n*s)*I,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,n,r,s,a,l){const u=Math.cos(s),h=Math.sin(s);return this.set(n*u,n*h,-n*(u*a+h*l)+a+t,-r*h,r*u,-r*(-h*a+u*l)+l+e,0,0,1),this}scale(t,e){const n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this}rotate(t){const e=Math.cos(t),n=Math.sin(t),r=this.elements,s=r[0],a=r[3],l=r[6],u=r[1],h=r[4],m=r[7];return r[0]=e*s+n*u,r[3]=e*a+n*h,r[6]=e*l+n*m,r[1]=-n*s+e*u,r[4]=-n*a+e*h,r[7]=-n*l+e*m,this}translate(t,e){const n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this}equals(t){const e=this.elements,n=t.elements;for(let r=0;r<9;r++)if(e[r]!==n[r])return!1;return!0}fromArray(t,e=0){for(let n=0;n<9;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}clone(){return(new this.constructor).fromArray(this.elements)}}function tZ(i){for(let t=i.length-1;t>=0;--t)if(i[t]>65535)return!0;return!1}pc.prototype.isMatrix3=!0;const Xve={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function wS(i,t){return new Xve[i](t)}function UT(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}const iZ={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},jf={h:0,s:0,l:0},$P={h:0,s:0,l:0};function YV(i,t,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?i+6*(t-i)*e:e<.5?t:e<2/3?i+6*(t-i)*(2/3-e):i}function SS(i){return i<.04045?.0773993808*i:Math.pow(.9478672986*i+.0521327014,2.4)}function KV(i){return i<.0031308?12.92*i:1.055*Math.pow(i,.41666)-.055}let CS,En=(()=>{class i{constructor(e,n,r){return void 0===n&&void 0===r?this.set(e):this.setRGB(e,n,r)}set(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this}setRGB(e,n,r){return this.r=e,this.g=n,this.b=r,this}setHSL(e,n,r){if(e=XV(e,1),n=$c(n,0,1),r=$c(r,0,1),0===n)this.r=this.g=this.b=r;else{const s=r<=.5?r*(1+n):r+n-r*n,a=2*r-s;this.r=YV(a,s,e+1/3),this.g=YV(a,s,e),this.b=YV(a,s,e-1/3)}return this}setStyle(e){function n(s){void 0!==s&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let s;const l=r[2];switch(r[1]){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return this.r=Math.min(255,parseInt(s[1],10))/255,this.g=Math.min(255,parseInt(s[2],10))/255,this.b=Math.min(255,parseInt(s[3],10))/255,n(s[4]),this;if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return this.r=Math.min(100,parseInt(s[1],10))/100,this.g=Math.min(100,parseInt(s[2],10))/100,this.b=Math.min(100,parseInt(s[3],10))/100,n(s[4]),this;break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l)){const u=parseFloat(s[1])/360,h=parseInt(s[2],10)/100,m=parseInt(s[3],10)/100;return n(s[4]),this.setHSL(u,h,m)}}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],a=s.length;if(3===a)return this.r=parseInt(s.charAt(0)+s.charAt(0),16)/255,this.g=parseInt(s.charAt(1)+s.charAt(1),16)/255,this.b=parseInt(s.charAt(2)+s.charAt(2),16)/255,this;if(6===a)return this.r=parseInt(s.charAt(0)+s.charAt(1),16)/255,this.g=parseInt(s.charAt(2)+s.charAt(3),16)/255,this.b=parseInt(s.charAt(4)+s.charAt(5),16)/255,this}return e&&e.length>0?this.setColorName(e):this}setColorName(e){const n=iZ[e.toLowerCase()];return void 0!==n?this.setHex(n):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=SS(e.r),this.g=SS(e.g),this.b=SS(e.b),this}copyLinearToSRGB(e){return this.r=KV(e.r),this.g=KV(e.g),this.b=KV(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(e){const n=this.r,r=this.g,s=this.b,a=Math.max(n,r,s),l=Math.min(n,r,s);let u,h;const m=(l+a)/2;if(l===a)u=0,h=0;else{const _=a-l;switch(h=m<=.5?_/(a+l):_/(2-a-l),a){case n:u=(r-s)/_+(r<s?6:0);break;case r:u=(s-n)/_+2;break;case s:u=(n-r)/_+4}u/=6}return e.h=u,e.s=h,e.l=m,e}getStyle(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}offsetHSL(e,n,r){return this.getHSL(jf),jf.h+=e,jf.s+=n,jf.l+=r,this.setHSL(jf.h,jf.s,jf.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,n){return this.r=e.r+n.r,this.g=e.g+n.g,this.b=e.b+n.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,n){return this.r+=(e.r-this.r)*n,this.g+=(e.g-this.g)*n,this.b+=(e.b-this.b)*n,this}lerpColors(e,n,r){return this.r=e.r+(n.r-e.r)*r,this.g=e.g+(n.g-e.g)*r,this.b=e.b+(n.b-e.b)*r,this}lerpHSL(e,n){this.getHSL(jf),e.getHSL($P);const r=zT(jf.h,$P.h,n),s=zT(jf.s,$P.s,n),a=zT(jf.l,$P.l,n);return this.setHSL(r,s,a),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,n=0){return this.r=e[n],this.g=e[n+1],this.b=e[n+2],this}toArray(e=[],n=0){return e[n]=this.r,e[n+1]=this.g,e[n+2]=this.b,e}fromBufferAttribute(e,n){return this.r=e.getX(n),this.g=e.getY(n),this.b=e.getZ(n),!0===e.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}return i.NAMES=iZ,i})();En.prototype.isColor=!0,En.prototype.r=1,En.prototype.g=1,En.prototype.b=1;class Ry{static getDataURL(t){if(/^data:/i.test(t.src)||"undefined"==typeof HTMLCanvasElement)return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{void 0===CS&&(CS=UT("canvas")),CS.width=t.width,CS.height=t.height;const n=CS.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=CS}return e.width>2048||e.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),e.toDataURL("image/jpeg",.6)):e.toDataURL("image/png")}static sRGBToLinear(t){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){const e=UT("canvas");e.width=t.width,e.height=t.height;const n=e.getContext("2d");n.drawImage(t,0,0,t.width,t.height);const r=n.getImageData(0,0,t.width,t.height),s=r.data;for(let a=0;a<s.length;a++)s[a]=255*SS(s[a]/255);return n.putImageData(r,0,0),e}if(t.data){const e=t.data.slice(0);for(let n=0;n<e.length;n++)e[n]=e instanceof Uint8Array||e instanceof Uint8ClampedArray?Math.floor(255*SS(e[n]/255)):SS(e[n]);return{data:e,width:t.width,height:t.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),t}}let Zve=0;class Jl extends Dy{constructor(t=Jl.DEFAULT_IMAGE,e=Jl.DEFAULT_MAPPING,n=Kc,r=Kc,s=Ka,a=f0,l=Qc,u=mg,h=1,m=_g){super(),Object.defineProperty(this,"id",{value:Zve++}),this.uuid=Nh(),this.name="",this.image=t,this.mipmaps=[],this.mapping=e,this.wrapS=n,this.wrapT=r,this.magFilter=s,this.minFilter=a,this.anisotropy=h,this.format=l,this.internalFormat=null,this.type=u,this.offset=new Oi(0,0),this.repeat=new Oi(1,1),this.center=new Oi(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new pc,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=m,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this}toJSON(t){const e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){const r=this.image;if(void 0===r.uuid&&(r.uuid=Nh()),!e&&void 0===t.images[r.uuid]){let s;if(Array.isArray(r)){s=[];for(let a=0,l=r.length;a<l;a++)s.push(QV(r[a].isDataTexture?r[a].image:r[a]))}else s=QV(r);t.images[r.uuid]={uuid:r.uuid,url:s}}n.image=r.uuid}return"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),e||(t.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==zP)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case LT:t.x=t.x-Math.floor(t.x);break;case Kc:t.x=t.x<0?0:1;break;case OT:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case LT:t.y=t.y-Math.floor(t.y);break;case Kc:t.y=t.y<0?0:1;break;case OT:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&this.version++}}function QV(i){return"undefined"!=typeof HTMLImageElement&&i instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&i instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&i instanceof ImageBitmap?Ry.getDataURL(i):i.data?{data:Array.prototype.slice.call(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}Jl.DEFAULT_IMAGE=void 0,Jl.DEFAULT_MAPPING=zP,Jl.prototype.isTexture=!0;class Bo{constructor(t=0,e=0,n=0,r=1){this.x=t,this.y=e,this.z=n,this.w=r}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,n,r){return this.x=t,this.y=e,this.z=n,this.w=r,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const e=this.x,n=this.y,r=this.z,s=this.w,a=t.elements;return this.x=a[0]*e+a[4]*n+a[8]*r+a[12]*s,this.y=a[1]*e+a[5]*n+a[9]*r+a[13]*s,this.z=a[2]*e+a[6]*n+a[10]*r+a[14]*s,this.w=a[3]*e+a[7]*n+a[11]*r+a[15]*s,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,n,r,s;const u=t.elements,h=u[0],m=u[4],_=u[8],v=u[1],S=u[5],T=u[9],I=u[2],j=u[6],P=u[10];if(Math.abs(m-v)<.01&&Math.abs(_-I)<.01&&Math.abs(T-j)<.01){if(Math.abs(m+v)<.1&&Math.abs(_+I)<.1&&Math.abs(T+j)<.1&&Math.abs(h+S+P-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;const ie=(h+1)/2,ee=(S+1)/2,ce=(P+1)/2,ye=(m+v)/4,Ce=(_+I)/4,Ge=(T+j)/4;return ie>ee&&ie>ce?ie<.01?(n=0,r=.707106781,s=.707106781):(n=Math.sqrt(ie),r=ye/n,s=Ce/n):ee>ce?ee<.01?(n=.707106781,r=0,s=.707106781):(r=Math.sqrt(ee),n=ye/r,s=Ge/r):ce<.01?(n=.707106781,r=.707106781,s=0):(s=Math.sqrt(ce),n=Ce/s,r=Ge/s),this.set(n,r,s,e),this}let E=Math.sqrt((j-T)*(j-T)+(_-I)*(_-I)+(v-m)*(v-m));return Math.abs(E)<.001&&(E=1),this.x=(j-T)/E,this.y=(_-I)/E,this.z=(v-m)/E,this.w=Math.acos((h+S+P-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this.w=t.w+(e.w-t.w)*n,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}Bo.prototype.isVector4=!0;class Hh extends Dy{constructor(t,e,n={}){super(),this.width=t,this.height=e,this.depth=1,this.scissor=new Bo(0,0,t,e),this.scissorTest=!1,this.viewport=new Bo(0,0,t,e),this.texture=new Jl(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.image={width:t,height:e,depth:1},this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.internalFormat=void 0!==n.internalFormat?n.internalFormat:null,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:Ka,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0!==n.stencilBuffer&&n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}setTexture(t){t.image={width:this.width,height:this.height,depth:this.depth},this.texture=t}setSize(t,e,n=1){(this.width!==t||this.height!==e||this.depth!==n)&&(this.width=t,this.height=e,this.depth=n,this.texture.image.width=t,this.texture.image.height=e,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)}clone(){return(new this.constructor).copy(this)}copy(t){return this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.texture.image=Object.assign({},t.texture.image),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}Hh.prototype.isWebGLRenderTarget=!0;class nZ extends Hh{constructor(t,e,n){super(t,e);const r=this.texture;this.texture=[];for(let s=0;s<n;s++)this.texture[s]=r.clone()}setSize(t,e,n=1){if(this.width!==t||this.height!==e||this.depth!==n){this.width=t,this.height=e,this.depth=n;for(let r=0,s=this.texture.length;r<s;r++)this.texture[r].image.width=t,this.texture[r].image.height=e,this.texture[r].image.depth=n;this.dispose()}return this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e),this}copy(t){this.dispose(),this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this.texture.length=0;for(let e=0,n=t.texture.length;e<n;e++)this.texture[e]=t.texture[e].clone();return this}}nZ.prototype.isWebGLMultipleRenderTargets=!0;class e2 extends Hh{constructor(t,e,n={}){super(t,e,n),this.samples=4,this.ignoreDepthForMultisampleCopy=void 0===n.ignoreDepth||n.ignoreDepth,this.useRenderToTexture=void 0!==n.useRenderToTexture&&n.useRenderToTexture,this.useRenderbuffer=!1===this.useRenderToTexture}copy(t){return super.copy.call(this,t),this.samples=t.samples,this.useRenderToTexture=t.useRenderToTexture,this.useRenderbuffer=t.useRenderbuffer,this}}e2.prototype.isWebGLMultisampleRenderTarget=!0;class eu{constructor(t=0,e=0,n=0,r=1){this._x=t,this._y=e,this._z=n,this._w=r}static slerp(t,e,n,r){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),n.slerpQuaternions(t,e,r)}static slerpFlat(t,e,n,r,s,a,l){let u=n[r+0],h=n[r+1],m=n[r+2],_=n[r+3];const v=s[a+0],S=s[a+1],T=s[a+2],I=s[a+3];if(0===l)return t[e+0]=u,t[e+1]=h,t[e+2]=m,void(t[e+3]=_);if(1===l)return t[e+0]=v,t[e+1]=S,t[e+2]=T,void(t[e+3]=I);if(_!==I||u!==v||h!==S||m!==T){let j=1-l;const P=u*v+h*S+m*T+_*I,E=P>=0?1:-1,ie=1-P*P;if(ie>Number.EPSILON){const ce=Math.sqrt(ie),ye=Math.atan2(ce,P*E);j=Math.sin(j*ye)/ce,l=Math.sin(l*ye)/ce}const ee=l*E;if(u=u*j+v*ee,h=h*j+S*ee,m=m*j+T*ee,_=_*j+I*ee,j===1-l){const ce=1/Math.sqrt(u*u+h*h+m*m+_*_);u*=ce,h*=ce,m*=ce,_*=ce}}t[e]=u,t[e+1]=h,t[e+2]=m,t[e+3]=_}static multiplyQuaternionsFlat(t,e,n,r,s,a){const l=n[r],u=n[r+1],h=n[r+2],m=n[r+3],_=s[a],v=s[a+1],S=s[a+2],T=s[a+3];return t[e]=l*T+m*_+u*S-h*v,t[e+1]=u*T+m*v+h*_-l*S,t[e+2]=h*T+m*S+l*v-u*_,t[e+3]=m*T-l*_-u*v-h*S,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const n=t._x,r=t._y,s=t._z,a=t._order,l=Math.cos,u=Math.sin,h=l(n/2),m=l(r/2),_=l(s/2),v=u(n/2),S=u(r/2),T=u(s/2);switch(a){case"XYZ":this._x=v*m*_+h*S*T,this._y=h*S*_-v*m*T,this._z=h*m*T+v*S*_,this._w=h*m*_-v*S*T;break;case"YXZ":this._x=v*m*_+h*S*T,this._y=h*S*_-v*m*T,this._z=h*m*T-v*S*_,this._w=h*m*_+v*S*T;break;case"ZXY":this._x=v*m*_-h*S*T,this._y=h*S*_+v*m*T,this._z=h*m*T+v*S*_,this._w=h*m*_-v*S*T;break;case"ZYX":this._x=v*m*_-h*S*T,this._y=h*S*_+v*m*T,this._z=h*m*T-v*S*_,this._w=h*m*_+v*S*T;break;case"YZX":this._x=v*m*_+h*S*T,this._y=h*S*_+v*m*T,this._z=h*m*T-v*S*_,this._w=h*m*_-v*S*T;break;case"XZY":this._x=v*m*_-h*S*T,this._y=h*S*_-v*m*T,this._z=h*m*T+v*S*_,this._w=h*m*_+v*S*T;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return!1!==e&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const n=e/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,n=e[0],r=e[4],s=e[8],a=e[1],l=e[5],u=e[9],h=e[2],m=e[6],_=e[10],v=n+l+_;if(v>0){const S=.5/Math.sqrt(v+1);this._w=.25/S,this._x=(m-u)*S,this._y=(s-h)*S,this._z=(a-r)*S}else if(n>l&&n>_){const S=2*Math.sqrt(1+n-l-_);this._w=(m-u)/S,this._x=.25*S,this._y=(r+a)/S,this._z=(s+h)/S}else if(l>_){const S=2*Math.sqrt(1+l-n-_);this._w=(s-h)/S,this._x=(r+a)/S,this._y=.25*S,this._z=(u+m)/S}else{const S=2*Math.sqrt(1+_-n-l);this._w=(a-r)/S,this._x=(s+h)/S,this._y=(u+m)/S,this._z=.25*S}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let n=t.dot(e)+1;return n<Number.EPSILON?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs($c(this.dot(t),-1,1)))}rotateTowards(t,e){const n=this.angleTo(t);if(0===n)return this;const r=Math.min(1,e/n);return this.slerp(t,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const n=t._x,r=t._y,s=t._z,a=t._w,l=e._x,u=e._y,h=e._z,m=e._w;return this._x=n*m+a*l+r*h-s*u,this._y=r*m+a*u+s*l-n*h,this._z=s*m+a*h+n*u-r*l,this._w=a*m-n*l-r*u-s*h,this._onChangeCallback(),this}slerp(t,e){if(0===e)return this;if(1===e)return this.copy(t);const n=this._x,r=this._y,s=this._z,a=this._w;let l=a*t._w+n*t._x+r*t._y+s*t._z;if(l<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,l=-l):this.copy(t),l>=1)return this._w=a,this._x=n,this._y=r,this._z=s,this;const u=1-l*l;if(u<=Number.EPSILON){const S=1-e;return this._w=S*a+e*this._w,this._x=S*n+e*this._x,this._y=S*r+e*this._y,this._z=S*s+e*this._z,this.normalize(),this._onChangeCallback(),this}const h=Math.sqrt(u),m=Math.atan2(h,l),_=Math.sin((1-e)*m)/h,v=Math.sin(e*m)/h;return this._w=a*_+this._w*v,this._x=n*_+this._x*v,this._y=r*_+this._y*v,this._z=s*_+this._z*v,this._onChangeCallback(),this}slerpQuaternions(t,e,n){return this.copy(t).slerp(e,n)}random(){const t=Math.random(),e=Math.sqrt(1-t),n=Math.sqrt(t),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(e*Math.cos(r),n*Math.sin(s),n*Math.cos(s),e*Math.sin(r))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}}eu.prototype.isQuaternion=!0;class He{constructor(t=0,e=0,n=0){this.x=t,this.y=e,this.z=n}set(t,e,n){return void 0===n&&(n=this.z),this.x=t,this.y=e,this.z=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(rZ.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(rZ.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,n=this.y,r=this.z,s=t.elements;return this.x=s[0]*e+s[3]*n+s[6]*r,this.y=s[1]*e+s[4]*n+s[7]*r,this.z=s[2]*e+s[5]*n+s[8]*r,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,n=this.y,r=this.z,s=t.elements,a=1/(s[3]*e+s[7]*n+s[11]*r+s[15]);return this.x=(s[0]*e+s[4]*n+s[8]*r+s[12])*a,this.y=(s[1]*e+s[5]*n+s[9]*r+s[13])*a,this.z=(s[2]*e+s[6]*n+s[10]*r+s[14])*a,this}applyQuaternion(t){const e=this.x,n=this.y,r=this.z,s=t.x,a=t.y,l=t.z,u=t.w,h=u*e+a*r-l*n,m=u*n+l*e-s*r,_=u*r+s*n-a*e,v=-s*e-a*n-l*r;return this.x=h*u+v*-s+m*-l-_*-a,this.y=m*u+v*-a+_*-s-h*-l,this.z=_*u+v*-l+h*-a-m*-s,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,n=this.y,r=this.z,s=t.elements;return this.x=s[0]*e+s[4]*n+s[8]*r,this.y=s[1]*e+s[5]*n+s[9]*r,this.z=s[2]*e+s[6]*n+s[10]*r,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this}cross(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)}crossVectors(t,e){const n=t.x,r=t.y,s=t.z,a=e.x,l=e.y,u=e.z;return this.x=r*u-s*l,this.y=s*a-n*u,this.z=n*l-r*a,this}projectOnVector(t){const e=t.lengthSq();if(0===e)return this.set(0,0,0);const n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)}projectOnPlane(t){return JV.copy(this).projectOnVector(t),this.sub(JV)}reflect(t){return this.sub(JV.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const n=this.dot(t)/e;return Math.acos($c(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return e*e+n*n+r*r}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,n){const r=Math.sin(e)*t;return this.x=r*Math.sin(n),this.y=Math.cos(e)*t,this.z=r*Math.cos(n),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=r,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,4*e)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,3*e)}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=2*(Math.random()-.5),e=Math.random()*Math.PI*2,n=Math.sqrt(1-t**2);return this.x=n*Math.cos(e),this.y=n*Math.sin(e),this.z=t,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}He.prototype.isVector3=!0;const JV=new He,rZ=new eu;class Vh{constructor(t=new He(1/0,1/0,1/0),e=new He(-1/0,-1/0,-1/0)){this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){let e=1/0,n=1/0,r=1/0,s=-1/0,a=-1/0,l=-1/0;for(let u=0,h=t.length;u<h;u+=3){const m=t[u],_=t[u+1],v=t[u+2];m<e&&(e=m),_<n&&(n=_),v<r&&(r=v),m>s&&(s=m),_>a&&(a=_),v>l&&(l=v)}return this.min.set(e,n,r),this.max.set(s,a,l),this}setFromBufferAttribute(t){let e=1/0,n=1/0,r=1/0,s=-1/0,a=-1/0,l=-1/0;for(let u=0,h=t.count;u<h;u++){const m=t.getX(u),_=t.getY(u),v=t.getZ(u);m<e&&(e=m),_<n&&(n=_),v<r&&(r=v),m>s&&(s=m),_>a&&(a=_),v>l&&(l=v)}return this.min.set(e,n,r),this.max.set(s,a,l),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=x0.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}setFromObject(t,e=!1){return this.makeEmpty(),this.expandByObject(t,e)}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,e=!1){t.updateWorldMatrix(!1,!1);const n=t.geometry;if(void 0!==n)if(e&&null!=n.attributes&&void 0!==n.attributes.position){const s=n.attributes.position;for(let a=0,l=s.count;a<l;a++)x0.fromBufferAttribute(s,a).applyMatrix4(t.matrixWorld),this.expandByPoint(x0)}else null===n.boundingBox&&n.computeBoundingBox(),$V.copy(n.boundingBox),$V.applyMatrix4(t.matrixWorld),this.union($V);const r=t.children;for(let s=0,a=r.length;s<a;s++)this.expandByObject(r[s],e);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,x0),x0.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(GT),t2.subVectors(this.max,GT),MS.subVectors(t.a,GT),TS.subVectors(t.b,GT),ES.subVectors(t.c,GT),ky.subVectors(TS,MS),Py.subVectors(ES,TS),w0.subVectors(MS,ES);let e=[0,-ky.z,ky.y,0,-Py.z,Py.y,0,-w0.z,w0.y,ky.z,0,-ky.x,Py.z,0,-Py.x,w0.z,0,-w0.x,-ky.y,ky.x,0,-Py.y,Py.x,0,-w0.y,w0.x,0];return!(!e5(e,MS,TS,ES,t2)||(e=[1,0,0,0,1,0,0,0,1],!e5(e,MS,TS,ES,t2)))&&(n2.crossVectors(ky,Py),e=[n2.x,n2.y,n2.z],e5(e,MS,TS,ES,t2))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return x0.copy(t).clamp(this.min,this.max).sub(t).length()}getBoundingSphere(t){return this.getCenter(t.center),t.radius=.5*this.getSize(x0).length(),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()||(yg[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),yg[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),yg[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),yg[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),yg[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),yg[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),yg[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),yg[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(yg)),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}Vh.prototype.isBox3=!0;const yg=[new He,new He,new He,new He,new He,new He,new He,new He],x0=new He,$V=new Vh,MS=new He,TS=new He,ES=new He,ky=new He,Py=new He,w0=new He,GT=new He,t2=new He,n2=new He,S0=new He;function e5(i,t,e,n,r){for(let s=0,a=i.length-3;s<=a;s+=3){S0.fromArray(i,s);const l=r.x*Math.abs(S0.x)+r.y*Math.abs(S0.y)+r.z*Math.abs(S0.z),u=t.dot(S0),h=e.dot(S0),m=n.dot(S0);if(Math.max(-Math.max(u,h,m),Math.min(u,h,m))>l)return!1}return!0}const Yve=new Vh,sZ=new He,r2=new He,t5=new He;class Iy{constructor(t=new He,e=-1){this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const n=this.center;void 0!==e?n.copy(e):Yve.setFromPoints(t).getCenter(n);let r=0;for(let s=0,a=t.length;s<a;s++)r=Math.max(r,n.distanceToSquared(t[s]));return this.radius=Math.sqrt(r),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const n=this.center.distanceToSquared(t);return e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){t5.subVectors(t,this.center);const e=t5.lengthSq();if(e>this.radius*this.radius){const n=Math.sqrt(e),r=.5*(n-this.radius);this.center.add(t5.multiplyScalar(r/n)),this.radius+=r}return this}union(t){return!0===this.center.equals(t.center)?r2.set(0,0,1).multiplyScalar(t.radius):r2.subVectors(t.center,this.center).normalize().multiplyScalar(t.radius),this.expandByPoint(sZ.copy(t.center).add(r2)),this.expandByPoint(sZ.copy(t.center).sub(r2)),this}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const vg=new He,n5=new He,s2=new He,Ly=new He,r5=new He,o2=new He,s5=new He;class Oy{constructor(t=new He,e=new He(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.direction).multiplyScalar(t).add(this.origin)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,vg)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);const n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const e=vg.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(vg.copy(this.direction).multiplyScalar(e).add(this.origin),vg.distanceToSquared(t))}distanceSqToSegment(t,e,n,r){n5.copy(t).add(e).multiplyScalar(.5),s2.copy(e).sub(t).normalize(),Ly.copy(this.origin).sub(n5);const s=.5*t.distanceTo(e),a=-this.direction.dot(s2),l=Ly.dot(this.direction),u=-Ly.dot(s2),h=Ly.lengthSq(),m=Math.abs(1-a*a);let _,v,S,T;if(m>0)if(_=a*u-l,v=a*l-u,T=s*m,_>=0)if(v>=-T)if(v<=T){const I=1/m;_*=I,v*=I,S=_*(_+a*v+2*l)+v*(a*_+v+2*u)+h}else v=s,_=Math.max(0,-(a*v+l)),S=-_*_+v*(v+2*u)+h;else v=-s,_=Math.max(0,-(a*v+l)),S=-_*_+v*(v+2*u)+h;else v<=-T?(_=Math.max(0,-(-a*s+l)),v=_>0?-s:Math.min(Math.max(-s,-u),s),S=-_*_+v*(v+2*u)+h):v<=T?(_=0,v=Math.min(Math.max(-s,-u),s),S=v*(v+2*u)+h):(_=Math.max(0,-(a*s+l)),v=_>0?s:Math.min(Math.max(-s,-u),s),S=-_*_+v*(v+2*u)+h);else v=a>0?-s:s,_=Math.max(0,-(a*v+l)),S=-_*_+v*(v+2*u)+h;return n&&n.copy(this.direction).multiplyScalar(_).add(this.origin),r&&r.copy(s2).multiplyScalar(v).add(n5),S}intersectSphere(t,e){vg.subVectors(t.center,this.origin);const n=vg.dot(this.direction),r=vg.dot(vg)-n*n,s=t.radius*t.radius;if(r>s)return null;const a=Math.sqrt(s-r),l=n-a,u=n+a;return l<0&&u<0?null:this.at(l<0?u:l,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null}intersectPlane(t,e){const n=this.distanceToPlane(t);return null===n?null:this.at(n,e)}intersectsPlane(t){const e=t.distanceToPoint(this.origin);return 0===e||t.normal.dot(this.direction)*e<0}intersectBox(t,e){let n,r,s,a,l,u;const h=1/this.direction.x,m=1/this.direction.y,_=1/this.direction.z,v=this.origin;return h>=0?(n=(t.min.x-v.x)*h,r=(t.max.x-v.x)*h):(n=(t.max.x-v.x)*h,r=(t.min.x-v.x)*h),m>=0?(s=(t.min.y-v.y)*m,a=(t.max.y-v.y)*m):(s=(t.max.y-v.y)*m,a=(t.min.y-v.y)*m),n>a||s>r||((s>n||n!=n)&&(n=s),(a<r||r!=r)&&(r=a),_>=0?(l=(t.min.z-v.z)*_,u=(t.max.z-v.z)*_):(l=(t.max.z-v.z)*_,u=(t.min.z-v.z)*_),n>u||l>r)||((l>n||n!=n)&&(n=l),(u<r||r!=r)&&(r=u),r<0)?null:this.at(n>=0?n:r,e)}intersectsBox(t){return null!==this.intersectBox(t,vg)}intersectTriangle(t,e,n,r,s){r5.subVectors(e,t),o2.subVectors(n,t),s5.crossVectors(r5,o2);let l,a=this.direction.dot(s5);if(a>0){if(r)return null;l=1}else{if(!(a<0))return null;l=-1,a=-a}Ly.subVectors(this.origin,t);const u=l*this.direction.dot(o2.crossVectors(Ly,o2));if(u<0)return null;const h=l*this.direction.dot(r5.cross(Ly));if(h<0||u+h>a)return null;const m=-l*Ly.dot(s5);return m<0?null:this.at(m/a,s)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class nr{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(t,e,n,r,s,a,l,u,h,m,_,v,S,T,I,j){const P=this.elements;return P[0]=t,P[4]=e,P[8]=n,P[12]=r,P[1]=s,P[5]=a,P[9]=l,P[13]=u,P[2]=h,P[6]=m,P[10]=_,P[14]=v,P[3]=S,P[7]=T,P[11]=I,P[15]=j,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new nr).fromArray(this.elements)}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this}copyPosition(t){const e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,n=t.elements,r=1/AS.setFromMatrixColumn(t,0).length(),s=1/AS.setFromMatrixColumn(t,1).length(),a=1/AS.setFromMatrixColumn(t,2).length();return e[0]=n[0]*r,e[1]=n[1]*r,e[2]=n[2]*r,e[3]=0,e[4]=n[4]*s,e[5]=n[5]*s,e[6]=n[6]*s,e[7]=0,e[8]=n[8]*a,e[9]=n[9]*a,e[10]=n[10]*a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const e=this.elements,n=t.x,r=t.y,s=t.z,a=Math.cos(n),l=Math.sin(n),u=Math.cos(r),h=Math.sin(r),m=Math.cos(s),_=Math.sin(s);if("XYZ"===t.order){const v=a*m,S=a*_,T=l*m,I=l*_;e[0]=u*m,e[4]=-u*_,e[8]=h,e[1]=S+T*h,e[5]=v-I*h,e[9]=-l*u,e[2]=I-v*h,e[6]=T+S*h,e[10]=a*u}else if("YXZ"===t.order){const v=u*m,S=u*_,T=h*m,I=h*_;e[0]=v+I*l,e[4]=T*l-S,e[8]=a*h,e[1]=a*_,e[5]=a*m,e[9]=-l,e[2]=S*l-T,e[6]=I+v*l,e[10]=a*u}else if("ZXY"===t.order){const v=u*m,S=u*_,T=h*m,I=h*_;e[0]=v-I*l,e[4]=-a*_,e[8]=T+S*l,e[1]=S+T*l,e[5]=a*m,e[9]=I-v*l,e[2]=-a*h,e[6]=l,e[10]=a*u}else if("ZYX"===t.order){const v=a*m,S=a*_,T=l*m,I=l*_;e[0]=u*m,e[4]=T*h-S,e[8]=v*h+I,e[1]=u*_,e[5]=I*h+v,e[9]=S*h-T,e[2]=-h,e[6]=l*u,e[10]=a*u}else if("YZX"===t.order){const v=a*u,S=a*h,T=l*u,I=l*h;e[0]=u*m,e[4]=I-v*_,e[8]=T*_+S,e[1]=_,e[5]=a*m,e[9]=-l*m,e[2]=-h*m,e[6]=S*_+T,e[10]=v-I*_}else if("XZY"===t.order){const v=a*u,S=a*h,T=l*u,I=l*h;e[0]=u*m,e[4]=-_,e[8]=h*m,e[1]=v*_+I,e[5]=a*m,e[9]=S*_-T,e[2]=T*_-S,e[6]=l*m,e[10]=I*_+v}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(Kve,t,Qve)}lookAt(t,e,n){const r=this.elements;return zh.subVectors(t,e),0===zh.lengthSq()&&(zh.z=1),zh.normalize(),Fy.crossVectors(n,zh),0===Fy.lengthSq()&&(1===Math.abs(n.z)?zh.x+=1e-4:zh.z+=1e-4,zh.normalize(),Fy.crossVectors(n,zh)),Fy.normalize(),a2.crossVectors(zh,Fy),r[0]=Fy.x,r[4]=a2.x,r[8]=zh.x,r[1]=Fy.y,r[5]=a2.y,r[9]=zh.y,r[2]=Fy.z,r[6]=a2.z,r[10]=zh.z,this}multiply(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,r=e.elements,s=this.elements,a=n[0],l=n[4],u=n[8],h=n[12],m=n[1],_=n[5],v=n[9],S=n[13],T=n[2],I=n[6],j=n[10],P=n[14],E=n[3],ie=n[7],ee=n[11],ce=n[15],ye=r[0],Ce=r[4],Ge=r[8],Qe=r[12],nt=r[1],ge=r[5],Je=r[9],mt=r[13],pt=r[2],Pt=r[6],et=r[10],vt=r[14],kt=r[3],pi=r[7],Ht=r[11],ct=r[15];return s[0]=a*ye+l*nt+u*pt+h*kt,s[4]=a*Ce+l*ge+u*Pt+h*pi,s[8]=a*Ge+l*Je+u*et+h*Ht,s[12]=a*Qe+l*mt+u*vt+h*ct,s[1]=m*ye+_*nt+v*pt+S*kt,s[5]=m*Ce+_*ge+v*Pt+S*pi,s[9]=m*Ge+_*Je+v*et+S*Ht,s[13]=m*Qe+_*mt+v*vt+S*ct,s[2]=T*ye+I*nt+j*pt+P*kt,s[6]=T*Ce+I*ge+j*Pt+P*pi,s[10]=T*Ge+I*Je+j*et+P*Ht,s[14]=T*Qe+I*mt+j*vt+P*ct,s[3]=E*ye+ie*nt+ee*pt+ce*kt,s[7]=E*Ce+ie*ge+ee*Pt+ce*pi,s[11]=E*Ge+ie*Je+ee*et+ce*Ht,s[15]=E*Qe+ie*mt+ee*vt+ce*ct,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[4],r=t[8],s=t[12],a=t[1],l=t[5],u=t[9],h=t[13],m=t[2],_=t[6],v=t[10],S=t[14];return t[3]*(+s*u*_-r*h*_-s*l*v+n*h*v+r*l*S-n*u*S)+t[7]*(+e*u*S-e*h*v+s*a*v-r*a*S+r*h*m-s*u*m)+t[11]*(+e*h*_-e*l*S-s*a*_+n*a*S+s*l*m-n*h*m)+t[15]*(-r*l*m-e*u*_+e*l*v+r*a*_-n*a*v+n*u*m)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,n){const r=this.elements;return t.isVector3?(r[12]=t.x,r[13]=t.y,r[14]=t.z):(r[12]=t,r[13]=e,r[14]=n),this}invert(){const t=this.elements,e=t[0],n=t[1],r=t[2],s=t[3],a=t[4],l=t[5],u=t[6],h=t[7],m=t[8],_=t[9],v=t[10],S=t[11],T=t[12],I=t[13],j=t[14],P=t[15],E=_*j*h-I*v*h+I*u*S-l*j*S-_*u*P+l*v*P,ie=T*v*h-m*j*h-T*u*S+a*j*S+m*u*P-a*v*P,ee=m*I*h-T*_*h+T*l*S-a*I*S-m*l*P+a*_*P,ce=T*_*u-m*I*u-T*l*v+a*I*v+m*l*j-a*_*j,ye=e*E+n*ie+r*ee+s*ce;if(0===ye)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const Ce=1/ye;return t[0]=E*Ce,t[1]=(I*v*s-_*j*s-I*r*S+n*j*S+_*r*P-n*v*P)*Ce,t[2]=(l*j*s-I*u*s+I*r*h-n*j*h-l*r*P+n*u*P)*Ce,t[3]=(_*u*s-l*v*s-_*r*h+n*v*h+l*r*S-n*u*S)*Ce,t[4]=ie*Ce,t[5]=(m*j*s-T*v*s+T*r*S-e*j*S-m*r*P+e*v*P)*Ce,t[6]=(T*u*s-a*j*s-T*r*h+e*j*h+a*r*P-e*u*P)*Ce,t[7]=(a*v*s-m*u*s+m*r*h-e*v*h-a*r*S+e*u*S)*Ce,t[8]=ee*Ce,t[9]=(T*_*s-m*I*s-T*n*S+e*I*S+m*n*P-e*_*P)*Ce,t[10]=(a*I*s-T*l*s+T*n*h-e*I*h-a*n*P+e*l*P)*Ce,t[11]=(m*l*s-a*_*s-m*n*h+e*_*h+a*n*S-e*l*S)*Ce,t[12]=ce*Ce,t[13]=(m*I*r-T*_*r+T*n*v-e*I*v-m*n*j+e*_*j)*Ce,t[14]=(T*l*r-a*I*r-T*n*u+e*I*u+a*n*j-e*l*j)*Ce,t[15]=(a*_*r-m*l*r+m*n*u-e*_*u-a*n*v+e*l*v)*Ce,this}scale(t){const e=this.elements,n=t.x,r=t.y,s=t.z;return e[0]*=n,e[4]*=r,e[8]*=s,e[1]*=n,e[5]*=r,e[9]*=s,e[2]*=n,e[6]*=r,e[10]*=s,e[3]*=n,e[7]*=r,e[11]*=s,this}getMaxScaleOnAxis(){const t=this.elements;return Math.sqrt(Math.max(t[0]*t[0]+t[1]*t[1]+t[2]*t[2],t[4]*t[4]+t[5]*t[5]+t[6]*t[6],t[8]*t[8]+t[9]*t[9]+t[10]*t[10]))}makeTranslation(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const n=Math.cos(e),r=Math.sin(e),s=1-n,a=t.x,l=t.y,u=t.z,h=s*a,m=s*l;return this.set(h*a+n,h*l-r*u,h*u+r*l,0,h*l+r*u,m*l+n,m*u-r*a,0,h*u-r*l,m*u+r*a,s*u*u+n,0,0,0,0,1),this}makeScale(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this}makeShear(t,e,n,r,s,a){return this.set(1,n,s,0,t,1,a,0,e,r,1,0,0,0,0,1),this}compose(t,e,n){const r=this.elements,s=e._x,a=e._y,l=e._z,u=e._w,h=s+s,m=a+a,_=l+l,v=s*h,S=s*m,T=s*_,I=a*m,j=a*_,P=l*_,E=u*h,ie=u*m,ee=u*_,ce=n.x,ye=n.y,Ce=n.z;return r[0]=(1-(I+P))*ce,r[1]=(S+ee)*ce,r[2]=(T-ie)*ce,r[3]=0,r[4]=(S-ee)*ye,r[5]=(1-(v+P))*ye,r[6]=(j+E)*ye,r[7]=0,r[8]=(T+ie)*Ce,r[9]=(j-E)*Ce,r[10]=(1-(v+I))*Ce,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,this}decompose(t,e,n){const r=this.elements;let s=AS.set(r[0],r[1],r[2]).length();const a=AS.set(r[4],r[5],r[6]).length(),l=AS.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),t.x=r[12],t.y=r[13],t.z=r[14],qf.copy(this);const h=1/s,m=1/a,_=1/l;return qf.elements[0]*=h,qf.elements[1]*=h,qf.elements[2]*=h,qf.elements[4]*=m,qf.elements[5]*=m,qf.elements[6]*=m,qf.elements[8]*=_,qf.elements[9]*=_,qf.elements[10]*=_,e.setFromRotationMatrix(qf),n.x=s,n.y=a,n.z=l,this}makePerspective(t,e,n,r,s,a){void 0===a&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const l=this.elements,h=2*s/(n-r),m=(e+t)/(e-t),_=(n+r)/(n-r),v=-(a+s)/(a-s),S=-2*a*s/(a-s);return l[0]=2*s/(e-t),l[4]=0,l[8]=m,l[12]=0,l[1]=0,l[5]=h,l[9]=_,l[13]=0,l[2]=0,l[6]=0,l[10]=v,l[14]=S,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(t,e,n,r,s,a){const l=this.elements,u=1/(e-t),h=1/(n-r),m=1/(a-s),_=(e+t)*u,v=(n+r)*h,S=(a+s)*m;return l[0]=2*u,l[4]=0,l[8]=0,l[12]=-_,l[1]=0,l[5]=2*h,l[9]=0,l[13]=-v,l[2]=0,l[6]=0,l[10]=-2*m,l[14]=-S,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(t){const e=this.elements,n=t.elements;for(let r=0;r<16;r++)if(e[r]!==n[r])return!1;return!0}fromArray(t,e=0){for(let n=0;n<16;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}}nr.prototype.isMatrix4=!0;const AS=new He,qf=new nr,Kve=new He(0,0,0),Qve=new He(1,1,1),Fy=new He,a2=new He,zh=new He,oZ=new nr,aZ=new eu;class C0{constructor(t=0,e=0,n=0,r=C0.DefaultOrder){this._x=t,this._y=e,this._z=n,this._order=r}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,n,r=this._order){return this._x=t,this._y=e,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,n=!0){const r=t.elements,s=r[0],a=r[4],l=r[8],u=r[1],h=r[5],m=r[9],_=r[2],v=r[6],S=r[10];switch(e){case"XYZ":this._y=Math.asin($c(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-m,S),this._z=Math.atan2(-a,s)):(this._x=Math.atan2(v,h),this._z=0);break;case"YXZ":this._x=Math.asin(-$c(m,-1,1)),Math.abs(m)<.9999999?(this._y=Math.atan2(l,S),this._z=Math.atan2(u,h)):(this._y=Math.atan2(-_,s),this._z=0);break;case"ZXY":this._x=Math.asin($c(v,-1,1)),Math.abs(v)<.9999999?(this._y=Math.atan2(-_,S),this._z=Math.atan2(-a,h)):(this._y=0,this._z=Math.atan2(u,s));break;case"ZYX":this._y=Math.asin(-$c(_,-1,1)),Math.abs(_)<.9999999?(this._x=Math.atan2(v,S),this._z=Math.atan2(u,s)):(this._x=0,this._z=Math.atan2(-a,h));break;case"YZX":this._z=Math.asin($c(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-m,h),this._y=Math.atan2(-_,s)):(this._x=0,this._y=Math.atan2(l,S));break;case"XZY":this._z=Math.asin(-$c(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(v,h),this._y=Math.atan2(l,s)):(this._x=Math.atan2(-m,S),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,!0===n&&this._onChangeCallback(),this}setFromQuaternion(t,e,n){return oZ.makeRotationFromQuaternion(t),this.setFromRotationMatrix(oZ,e,n)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return aZ.setFromEuler(this),this.setFromQuaternion(aZ,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}toVector3(t){return t?t.set(this._x,this._y,this._z):new He(this._x,this._y,this._z)}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}}C0.prototype.isEuler=!0,C0.DefaultOrder="XYZ",C0.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class l2{constructor(){this.mask=1}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return 0!=(this.mask&t.mask)}isEnabled(t){return 0!=(this.mask&(1<<t|0))}}let Jve=0;const lZ=new He,DS=new eu,bg=new nr,c2=new He,WT=new He,$ve=new He,ebe=new eu,cZ=new He(1,0,0),uZ=new He(0,1,0),hZ=new He(0,0,1),tbe={type:"added"},dZ={type:"removed"};class Zs extends Dy{constructor(){super(),Object.defineProperty(this,"id",{value:Jve++}),this.uuid=Nh(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Zs.DefaultUp.clone();const t=new He,e=new C0,n=new eu,r=new He(1,1,1);e._onChange(function s(){n.setFromEuler(e,!1)}),n._onChange(function a(){e.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new nr},normalMatrix:{value:new pc}}),this.matrix=new nr,this.matrixWorld=new nr,this.matrixAutoUpdate=Zs.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new l2,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return DS.setFromAxisAngle(t,e),this.quaternion.multiply(DS),this}rotateOnWorldAxis(t,e){return DS.setFromAxisAngle(t,e),this.quaternion.premultiply(DS),this}rotateX(t){return this.rotateOnAxis(cZ,t)}rotateY(t){return this.rotateOnAxis(uZ,t)}rotateZ(t){return this.rotateOnAxis(hZ,t)}translateOnAxis(t,e){return lZ.copy(t).applyQuaternion(this.quaternion),this.position.add(lZ.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis(cZ,t)}translateY(t){return this.translateOnAxis(uZ,t)}translateZ(t){return this.translateOnAxis(hZ,t)}localToWorld(t){return t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return t.applyMatrix4(bg.copy(this.matrixWorld).invert())}lookAt(t,e,n){t.isVector3?c2.copy(t):c2.set(t,e,n);const r=this.parent;this.updateWorldMatrix(!0,!1),WT.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?bg.lookAt(WT,c2,this.up):bg.lookAt(c2,WT,this.up),this.quaternion.setFromRotationMatrix(bg),r&&(bg.extractRotation(r.matrixWorld),DS.setFromRotationMatrix(bg),this.quaternion.premultiply(DS.invert()))}add(t){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(tbe)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const e=this.children.indexOf(t);return-1!==e&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(dZ)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const e=this.children[t];e.parent=null,e.dispatchEvent(dZ)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),bg.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),bg.multiply(t.parent.matrixWorld)),t.applyMatrix4(bg),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let n=0,r=this.children.length;n<r;n++){const a=this.children[n].getObjectByProperty(t,e);if(void 0!==a)return a}}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(WT,t,$ve),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(WT,ebe,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);const e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].traverseVisible(t)}traverseAncestors(t){const e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].updateMatrixWorld(t)}updateWorldMatrix(t,e){const n=this.parent;if(!0===t&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e){const r=this.children;for(let s=0,a=r.length;s<a;s++)r[s].updateWorldMatrix(!1,!0)}}toJSON(t){const e=void 0===t||"string"==typeof t,n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const r={};function s(l,u){return void 0===l[u.uuid]&&(l[u.uuid]=u.toJSON(t)),u.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&(r.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(t.geometries,this.geometry);const l=this.geometry.parameters;if(void 0!==l&&void 0!==l.shapes){const u=l.shapes;if(Array.isArray(u))for(let h=0,m=u.length;h<m;h++)s(t.shapes,u[h]);else s(t.shapes,u)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(s(t.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const l=[];for(let u=0,h=this.material.length;u<h;u++)l.push(s(t.materials,this.material[u]));r.material=l}else r.material=s(t.materials,this.material);if(this.children.length>0){r.children=[];for(let l=0;l<this.children.length;l++)r.children.push(this.children[l].toJSON(t).object)}if(this.animations.length>0){r.animations=[];for(let l=0;l<this.animations.length;l++)r.animations.push(s(t.animations,this.animations[l]))}if(e){const l=a(t.geometries),u=a(t.materials),h=a(t.textures),m=a(t.images),_=a(t.shapes),v=a(t.skeletons),S=a(t.animations);l.length>0&&(n.geometries=l),u.length>0&&(n.materials=u),h.length>0&&(n.textures=h),m.length>0&&(n.images=m),_.length>0&&(n.shapes=_),v.length>0&&(n.skeletons=v),S.length>0&&(n.animations=S)}return n.object=r,n;function a(l){const u=[];for(const h in l){const m=l[h];delete m.metadata,u.push(m)}return u}}clone(t){return(new this.constructor).copy(this,t)}copy(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(let n=0;n<t.children.length;n++)this.add(t.children[n].clone());return this}}Zs.DefaultUp=new He(0,1,0),Zs.DefaultMatrixAutoUpdate=!0,Zs.prototype.isObject3D=!0;const Xf=new He,xg=new He,o5=new He,wg=new He,RS=new He,kS=new He,fZ=new He,a5=new He,l5=new He,c5=new He;class Rl{constructor(t=new He,e=new He,n=new He){this.a=t,this.b=e,this.c=n}static getNormal(t,e,n,r){r.subVectors(n,e),Xf.subVectors(t,e),r.cross(Xf);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(t,e,n,r,s){Xf.subVectors(r,e),xg.subVectors(n,e),o5.subVectors(t,e);const a=Xf.dot(Xf),l=Xf.dot(xg),u=Xf.dot(o5),h=xg.dot(xg),m=xg.dot(o5),_=a*h-l*l;if(0===_)return s.set(-2,-1,-1);const v=1/_,S=(h*u-l*m)*v,T=(a*m-l*u)*v;return s.set(1-S-T,T,S)}static containsPoint(t,e,n,r){return this.getBarycoord(t,e,n,r,wg),wg.x>=0&&wg.y>=0&&wg.x+wg.y<=1}static getUV(t,e,n,r,s,a,l,u){return this.getBarycoord(t,e,n,r,wg),u.set(0,0),u.addScaledVector(s,wg.x),u.addScaledVector(a,wg.y),u.addScaledVector(l,wg.z),u}static isFrontFacing(t,e,n,r){return Xf.subVectors(n,e),xg.subVectors(t,e),Xf.cross(xg).dot(r)<0}set(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this}setFromPointsAndIndices(t,e,n,r){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[r]),this}setFromAttributeAndIndices(t,e,n,r){return this.a.fromBufferAttribute(t,e),this.b.fromBufferAttribute(t,n),this.c.fromBufferAttribute(t,r),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return Xf.subVectors(this.c,this.b),xg.subVectors(this.a,this.b),.5*Xf.cross(xg).length()}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return Rl.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return Rl.getBarycoord(t,this.a,this.b,this.c,e)}getUV(t,e,n,r,s){return Rl.getUV(t,this.a,this.b,this.c,e,n,r,s)}containsPoint(t){return Rl.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return Rl.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){const n=this.a,r=this.b,s=this.c;let a,l;RS.subVectors(r,n),kS.subVectors(s,n),a5.subVectors(t,n);const u=RS.dot(a5),h=kS.dot(a5);if(u<=0&&h<=0)return e.copy(n);l5.subVectors(t,r);const m=RS.dot(l5),_=kS.dot(l5);if(m>=0&&_<=m)return e.copy(r);const v=u*_-m*h;if(v<=0&&u>=0&&m<=0)return a=u/(u-m),e.copy(n).addScaledVector(RS,a);c5.subVectors(t,s);const S=RS.dot(c5),T=kS.dot(c5);if(T>=0&&S<=T)return e.copy(s);const I=S*h-u*T;if(I<=0&&h>=0&&T<=0)return l=h/(h-T),e.copy(n).addScaledVector(kS,l);const j=m*T-S*_;if(j<=0&&_-m>=0&&S-T>=0)return fZ.subVectors(s,r),l=(_-m)/(_-m+(S-T)),e.copy(r).addScaledVector(fZ,l);const P=1/(j+I+v);return a=I*P,l=v*P,e.copy(n).addScaledVector(RS,a).addScaledVector(kS,l)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}let ibe=0;class kc extends Dy{constructor(){super(),Object.defineProperty(this,"id",{value:ibe++}),this.uuid=Nh(),this.name="",this.type="Material",this.fog=!0,this.blending=_S,this.side=l0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=xV,this.blendDst=wV,this.blendEquation=u0,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=VP,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=QX,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=KP,this.stencilZFail=KP,this.stencilZPass=KP,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.alphaWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(void 0!==t)for(const e in t){const n=t[e];if(void 0===n){console.warn("THREE.Material: '"+e+"' parameter is undefined.");continue}if("shading"===e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===mV;continue}const r=this[e];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[e]=n:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}}toJSON(t){const e=void 0===t||"string"==typeof t;e&&(t={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(s){const a=[];for(const l in s){const u=s[l];delete u.metadata,a.push(u)}return a}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(t).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(t).uuid),void 0!==this.attenuationDistance&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==_S&&(n.blending=this.blending),this.side!==l0&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.alphaWrite=this.alphaWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),e){const s=r(t.textures),a=r(t.images);s.length>0&&(n.textures=s),a.length>0&&(n.images=a)}return n}clone(){return(new this.constructor).copy(this)}copy(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let n=null;if(null!==e){const r=e.length;n=new Array(r);for(let s=0;s!==r;++s)n[s]=e[s].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.alphaWrite=t.alphaWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){!0===t&&this.version++}}kc.prototype.isMaterial=!0;class Sg extends kc{constructor(t){super(),this.type="MeshBasicMaterial",this.color=new En(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=RT,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this}}Sg.prototype.isMeshBasicMaterial=!0;const na=new He,u2=new Oi;class lo{constructor(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===n,this.usage=bS,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this}copyAt(t,e,n){t*=this.itemSize,n*=e.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[t+r]=e.array[n+r];return this}copyArray(t){return this.array.set(t),this}copyColorsArray(t){const e=this.array;let n=0;for(let r=0,s=t.length;r<s;r++){let a=t[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),a=new En),e[n++]=a.r,e[n++]=a.g,e[n++]=a.b}return this}copyVector2sArray(t){const e=this.array;let n=0;for(let r=0,s=t.length;r<s;r++){let a=t[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),a=new Oi),e[n++]=a.x,e[n++]=a.y}return this}copyVector3sArray(t){const e=this.array;let n=0;for(let r=0,s=t.length;r<s;r++){let a=t[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),a=new He),e[n++]=a.x,e[n++]=a.y,e[n++]=a.z}return this}copyVector4sArray(t){const e=this.array;let n=0;for(let r=0,s=t.length;r<s;r++){let a=t[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),a=new Bo),e[n++]=a.x,e[n++]=a.y,e[n++]=a.z,e[n++]=a.w}return this}applyMatrix3(t){if(2===this.itemSize)for(let e=0,n=this.count;e<n;e++)u2.fromBufferAttribute(this,e),u2.applyMatrix3(t),this.setXY(e,u2.x,u2.y);else if(3===this.itemSize)for(let e=0,n=this.count;e<n;e++)na.fromBufferAttribute(this,e),na.applyMatrix3(t),this.setXYZ(e,na.x,na.y,na.z);return this}applyMatrix4(t){for(let e=0,n=this.count;e<n;e++)na.x=this.getX(e),na.y=this.getY(e),na.z=this.getZ(e),na.applyMatrix4(t),this.setXYZ(e,na.x,na.y,na.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)na.x=this.getX(e),na.y=this.getY(e),na.z=this.getZ(e),na.applyNormalMatrix(t),this.setXYZ(e,na.x,na.y,na.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)na.x=this.getX(e),na.y=this.getY(e),na.z=this.getZ(e),na.transformDirection(t),this.setXYZ(e,na.x,na.y,na.z);return this}set(t,e=0){return this.array.set(t,e),this}getX(t){return this.array[t*this.itemSize]}setX(t,e){return this.array[t*this.itemSize]=e,this}getY(t){return this.array[t*this.itemSize+1]}setY(t,e){return this.array[t*this.itemSize+1]=e,this}getZ(t){return this.array[t*this.itemSize+2]}setZ(t,e){return this.array[t*this.itemSize+2]=e,this}getW(t){return this.array[t*this.itemSize+3]}setW(t,e){return this.array[t*this.itemSize+3]=e,this}setXY(t,e,n){return this.array[0+(t*=this.itemSize)]=e,this.array[t+1]=n,this}setXYZ(t,e,n,r){return this.array[0+(t*=this.itemSize)]=e,this.array[t+1]=n,this.array[t+2]=r,this}setXYZW(t,e,n,r,s){return this.array[0+(t*=this.itemSize)]=e,this.array[t+1]=n,this.array[t+2]=r,this.array[t+3]=s,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(t.name=this.name),this.usage!==bS&&(t.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(t.updateRange=this.updateRange),t}}lo.prototype.isBufferAttribute=!0;class pZ extends lo{constructor(t,e,n){super(new Int8Array(t),e,n)}}class mZ extends lo{constructor(t,e,n){super(new Uint8Array(t),e,n)}}class gZ extends lo{constructor(t,e,n){super(new Uint8ClampedArray(t),e,n)}}class _Z extends lo{constructor(t,e,n){super(new Int16Array(t),e,n)}}class h2 extends lo{constructor(t,e,n){super(new Uint16Array(t),e,n)}}class yZ extends lo{constructor(t,e,n){super(new Int32Array(t),e,n)}}class d2 extends lo{constructor(t,e,n){super(new Uint32Array(t),e,n)}}class vZ extends lo{constructor(t,e,n){super(new Uint16Array(t),e,n)}}vZ.prototype.isFloat16BufferAttribute=!0;class Jn extends lo{constructor(t,e,n){super(new Float32Array(t),e,n)}}class bZ extends lo{constructor(t,e,n){super(new Float64Array(t),e,n)}}let nbe=0;const $d=new nr,u5=new Zs,PS=new He,Uh=new Vh,jT=new Vh,Pc=new He;class Ir extends Dy{constructor(){super(),Object.defineProperty(this,"id",{value:nbe++}),this.uuid=Nh(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return this.index=Array.isArray(t)?new(tZ(t)?d2:h2)(t,1):t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return void 0!==this.attributes[t]}addGroup(t,e,n=0){this.groups.push({start:t,count:e,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){const e=this.attributes.position;void 0!==e&&(e.applyMatrix4(t),e.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const s=(new pc).getNormalMatrix(t);n.applyNormalMatrix(s),n.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(t),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(t){return $d.makeRotationFromQuaternion(t),this.applyMatrix4($d),this}rotateX(t){return $d.makeRotationX(t),this.applyMatrix4($d),this}rotateY(t){return $d.makeRotationY(t),this.applyMatrix4($d),this}rotateZ(t){return $d.makeRotationZ(t),this.applyMatrix4($d),this}translate(t,e,n){return $d.makeTranslation(t,e,n),this.applyMatrix4($d),this}scale(t,e,n){return $d.makeScale(t,e,n),this.applyMatrix4($d),this}lookAt(t){return u5.lookAt(t),u5.updateMatrix(),this.applyMatrix4(u5.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(PS).negate(),this.translate(PS.x,PS.y,PS.z),this}setFromPoints(t){const e=[];for(let n=0,r=t.length;n<r;n++){const s=t[n];e.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new Jn(e,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Vh);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new He(-1/0,-1/0,-1/0),new He(1/0,1/0,1/0));if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(let n=0,r=e.length;n<r;n++)Uh.setFromBufferAttribute(e[n]),this.morphTargetsRelative?(Pc.addVectors(this.boundingBox.min,Uh.min),this.boundingBox.expandByPoint(Pc),Pc.addVectors(this.boundingBox.max,Uh.max),this.boundingBox.expandByPoint(Pc)):(this.boundingBox.expandByPoint(Uh.min),this.boundingBox.expandByPoint(Uh.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Iy);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new He,1/0);if(t){const n=this.boundingSphere.center;if(Uh.setFromBufferAttribute(t),e)for(let s=0,a=e.length;s<a;s++)jT.setFromBufferAttribute(e[s]),this.morphTargetsRelative?(Pc.addVectors(Uh.min,jT.min),Uh.expandByPoint(Pc),Pc.addVectors(Uh.max,jT.max),Uh.expandByPoint(Pc)):(Uh.expandByPoint(jT.min),Uh.expandByPoint(jT.max));Uh.getCenter(n);let r=0;for(let s=0,a=t.count;s<a;s++)Pc.fromBufferAttribute(t,s),r=Math.max(r,n.distanceToSquared(Pc));if(e)for(let s=0,a=e.length;s<a;s++){const l=e[s],u=this.morphTargetsRelative;for(let h=0,m=l.count;h<m;h++)Pc.fromBufferAttribute(l,h),u&&(PS.fromBufferAttribute(t,h),Pc.add(PS)),r=Math.max(r,n.distanceToSquared(Pc))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const t=this.index,e=this.attributes;if(null===t||void 0===e.position||void 0===e.normal||void 0===e.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=t.array,r=e.position.array,s=e.normal.array,a=e.uv.array,l=r.length/3;void 0===e.tangent&&this.setAttribute("tangent",new lo(new Float32Array(4*l),4));const u=e.tangent.array,h=[],m=[];for(let nt=0;nt<l;nt++)h[nt]=new He,m[nt]=new He;const _=new He,v=new He,S=new He,T=new Oi,I=new Oi,j=new Oi,P=new He,E=new He;function ie(nt,ge,Je){_.fromArray(r,3*nt),v.fromArray(r,3*ge),S.fromArray(r,3*Je),T.fromArray(a,2*nt),I.fromArray(a,2*ge),j.fromArray(a,2*Je),v.sub(_),S.sub(_),I.sub(T),j.sub(T);const mt=1/(I.x*j.y-j.x*I.y);!isFinite(mt)||(P.copy(v).multiplyScalar(j.y).addScaledVector(S,-I.y).multiplyScalar(mt),E.copy(S).multiplyScalar(I.x).addScaledVector(v,-j.x).multiplyScalar(mt),h[nt].add(P),h[ge].add(P),h[Je].add(P),m[nt].add(E),m[ge].add(E),m[Je].add(E))}let ee=this.groups;0===ee.length&&(ee=[{start:0,count:n.length}]);for(let nt=0,ge=ee.length;nt<ge;++nt){const Je=ee[nt],mt=Je.start;for(let Pt=mt,et=mt+Je.count;Pt<et;Pt+=3)ie(n[Pt+0],n[Pt+1],n[Pt+2])}const ce=new He,ye=new He,Ce=new He,Ge=new He;function Qe(nt){Ce.fromArray(s,3*nt),Ge.copy(Ce);const ge=h[nt];ce.copy(ge),ce.sub(Ce.multiplyScalar(Ce.dot(ge))).normalize(),ye.crossVectors(Ge,ge);const mt=ye.dot(m[nt])<0?-1:1;u[4*nt]=ce.x,u[4*nt+1]=ce.y,u[4*nt+2]=ce.z,u[4*nt+3]=mt}for(let nt=0,ge=ee.length;nt<ge;++nt){const Je=ee[nt],mt=Je.start;for(let Pt=mt,et=mt+Je.count;Pt<et;Pt+=3)Qe(n[Pt+0]),Qe(n[Pt+1]),Qe(n[Pt+2])}}computeVertexNormals(){const t=this.index,e=this.getAttribute("position");if(void 0!==e){let n=this.getAttribute("normal");if(void 0===n)n=new lo(new Float32Array(3*e.count),3),this.setAttribute("normal",n);else for(let v=0,S=n.count;v<S;v++)n.setXYZ(v,0,0,0);const r=new He,s=new He,a=new He,l=new He,u=new He,h=new He,m=new He,_=new He;if(t)for(let v=0,S=t.count;v<S;v+=3){const T=t.getX(v+0),I=t.getX(v+1),j=t.getX(v+2);r.fromBufferAttribute(e,T),s.fromBufferAttribute(e,I),a.fromBufferAttribute(e,j),m.subVectors(a,s),_.subVectors(r,s),m.cross(_),l.fromBufferAttribute(n,T),u.fromBufferAttribute(n,I),h.fromBufferAttribute(n,j),l.add(m),u.add(m),h.add(m),n.setXYZ(T,l.x,l.y,l.z),n.setXYZ(I,u.x,u.y,u.z),n.setXYZ(j,h.x,h.y,h.z)}else for(let v=0,S=e.count;v<S;v+=3)r.fromBufferAttribute(e,v+0),s.fromBufferAttribute(e,v+1),a.fromBufferAttribute(e,v+2),m.subVectors(a,s),_.subVectors(r,s),m.cross(_),n.setXYZ(v+0,m.x,m.y,m.z),n.setXYZ(v+1,m.x,m.y,m.z),n.setXYZ(v+2,m.x,m.y,m.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(t,e){if(!t||!t.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);void 0===e&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const n=this.attributes;for(const r in n){if(void 0===t.attributes[r])continue;const a=n[r].array,l=t.attributes[r],u=l.array,h=l.itemSize*e,m=Math.min(u.length,a.length-h);for(let _=0,v=h;_<m;_++,v++)a[v]=u[_]}return this}normalizeNormals(){const t=this.attributes.normal;for(let e=0,n=t.count;e<n;e++)Pc.fromBufferAttribute(t,e),Pc.normalize(),t.setXYZ(e,Pc.x,Pc.y,Pc.z)}toNonIndexed(){function t(l,u){const h=l.array,m=l.itemSize,_=l.normalized,v=new h.constructor(u.length*m);let S=0,T=0;for(let I=0,j=u.length;I<j;I++){S=l.isInterleavedBufferAttribute?u[I]*l.data.stride+l.offset:u[I]*m;for(let P=0;P<m;P++)v[T++]=h[S++]}return new lo(v,m,_)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const e=new Ir,n=this.index.array,r=this.attributes;for(const l in r){const h=t(r[l],n);e.setAttribute(l,h)}const s=this.morphAttributes;for(const l in s){const u=[],h=s[l];for(let m=0,_=h.length;m<_;m++){const S=t(h[m],n);u.push(S)}e.morphAttributes[l]=u}e.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let l=0,u=a.length;l<u;l++){const h=a[l];e.addGroup(h.start,h.count,h.materialIndex)}return e}toJSON(){const t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){const u=this.parameters;for(const h in u)void 0!==u[h]&&(t[h]=u[h]);return t}t.data={attributes:{}};const e=this.index;null!==e&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const n=this.attributes;for(const u in n)t.data.attributes[u]=n[u].toJSON(t.data);const r={};let s=!1;for(const u in this.morphAttributes){const h=this.morphAttributes[u],m=[];for(let _=0,v=h.length;_<v;_++)m.push(h[_].toJSON(t.data));m.length>0&&(r[u]=m,s=!0)}s&&(t.data.morphAttributes=r,t.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(t.data.groups=JSON.parse(JSON.stringify(a)));const l=this.boundingSphere;return null!==l&&(t.data.boundingSphere={center:l.center.toArray(),radius:l.radius}),t}clone(){return(new this.constructor).copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const n=t.index;null!==n&&this.setIndex(n.clone(e));const r=t.attributes;for(const h in r)this.setAttribute(h,r[h].clone(e));const s=t.morphAttributes;for(const h in s){const m=[],_=s[h];for(let v=0,S=_.length;v<S;v++)m.push(_[v].clone(e));this.morphAttributes[h]=m}this.morphTargetsRelative=t.morphTargetsRelative;const a=t.groups;for(let h=0,m=a.length;h<m;h++){const _=a[h];this.addGroup(_.start,_.count,_.materialIndex)}const l=t.boundingBox;null!==l&&(this.boundingBox=l.clone());const u=t.boundingSphere;return null!==u&&(this.boundingSphere=u.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,void 0!==t.parameters&&(this.parameters=Object.assign({},t.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}Ir.prototype.isBufferGeometry=!0;const xZ=new nr,IS=new Oy,h5=new Iy,By=new He,Ny=new He,Hy=new He,d5=new He,f5=new He,p5=new He,f2=new He,p2=new He,m2=new He,g2=new Oi,_2=new Oi,y2=new Oi,m5=new He,v2=new He;class Qa extends Zs{constructor(t=new Ir,e=new Sg){super(),this.type="Mesh",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t){return super.copy(t),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this}updateMorphTargets(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const r=e[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=r.length;s<a;s++){const l=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=s}}}}else{const e=t.morphTargets;void 0!==e&&e.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(t,e){const n=this.geometry,r=this.material,s=this.matrixWorld;if(void 0===r||(null===n.boundingSphere&&n.computeBoundingSphere(),h5.copy(n.boundingSphere),h5.applyMatrix4(s),!1===t.ray.intersectsSphere(h5))||(xZ.copy(s).invert(),IS.copy(t.ray).applyMatrix4(xZ),null!==n.boundingBox&&!1===IS.intersectsBox(n.boundingBox)))return;let a;if(n.isBufferGeometry){const l=n.index,u=n.attributes.position,h=n.morphAttributes.position,m=n.morphTargetsRelative,_=n.attributes.uv,v=n.attributes.uv2,S=n.groups,T=n.drawRange;if(null!==l)if(Array.isArray(r))for(let I=0,j=S.length;I<j;I++){const P=S[I],E=r[P.materialIndex];for(let ce=Math.max(P.start,T.start),ye=Math.min(l.count,Math.min(P.start+P.count,T.start+T.count));ce<ye;ce+=3){const Ce=l.getX(ce),Ge=l.getX(ce+1),Qe=l.getX(ce+2);a=b2(this,E,t,IS,u,h,m,_,v,Ce,Ge,Qe),a&&(a.faceIndex=Math.floor(ce/3),a.face.materialIndex=P.materialIndex,e.push(a))}}else for(let P=Math.max(0,T.start),E=Math.min(l.count,T.start+T.count);P<E;P+=3){const ie=l.getX(P),ee=l.getX(P+1),ce=l.getX(P+2);a=b2(this,r,t,IS,u,h,m,_,v,ie,ee,ce),a&&(a.faceIndex=Math.floor(P/3),e.push(a))}else if(void 0!==u)if(Array.isArray(r))for(let I=0,j=S.length;I<j;I++){const P=S[I],E=r[P.materialIndex];for(let ce=Math.max(P.start,T.start),ye=Math.min(u.count,Math.min(P.start+P.count,T.start+T.count));ce<ye;ce+=3)a=b2(this,E,t,IS,u,h,m,_,v,ce,ce+1,ce+2),a&&(a.faceIndex=Math.floor(ce/3),a.face.materialIndex=P.materialIndex,e.push(a))}else for(let P=Math.max(0,T.start),E=Math.min(u.count,T.start+T.count);P<E;P+=3)a=b2(this,r,t,IS,u,h,m,_,v,P,P+1,P+2),a&&(a.faceIndex=Math.floor(P/3),e.push(a))}else n.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}function b2(i,t,e,n,r,s,a,l,u,h,m,_){By.fromBufferAttribute(r,h),Ny.fromBufferAttribute(r,m),Hy.fromBufferAttribute(r,_);const v=i.morphTargetInfluences;if(s&&v){f2.set(0,0,0),p2.set(0,0,0),m2.set(0,0,0);for(let T=0,I=s.length;T<I;T++){const j=v[T],P=s[T];0!==j&&(d5.fromBufferAttribute(P,h),f5.fromBufferAttribute(P,m),p5.fromBufferAttribute(P,_),a?(f2.addScaledVector(d5,j),p2.addScaledVector(f5,j),m2.addScaledVector(p5,j)):(f2.addScaledVector(d5.sub(By),j),p2.addScaledVector(f5.sub(Ny),j),m2.addScaledVector(p5.sub(Hy),j)))}By.add(f2),Ny.add(p2),Hy.add(m2)}i.isSkinnedMesh&&(i.boneTransform(h,By),i.boneTransform(m,Ny),i.boneTransform(_,Hy));const S=function rbe(i,t,e,n,r,s,a,l){let u;if(u=t.side===Al?n.intersectTriangle(a,s,r,!0,l):n.intersectTriangle(r,s,a,t.side!==c0,l),null===u)return null;v2.copy(l),v2.applyMatrix4(i.matrixWorld);const h=e.ray.origin.distanceTo(v2);return h<e.near||h>e.far?null:{distance:h,point:v2.clone(),object:i}}(i,t,e,n,By,Ny,Hy,m5);if(S){l&&(g2.fromBufferAttribute(l,h),_2.fromBufferAttribute(l,m),y2.fromBufferAttribute(l,_),S.uv=Rl.getUV(m5,By,Ny,Hy,g2,_2,y2,new Oi)),u&&(g2.fromBufferAttribute(u,h),_2.fromBufferAttribute(u,m),y2.fromBufferAttribute(u,_),S.uv2=Rl.getUV(m5,By,Ny,Hy,g2,_2,y2,new Oi));const T={a:h,b:m,c:_,normal:new He,materialIndex:0};Rl.getNormal(By,Ny,Hy,T.normal),S.face=T}return S}Qa.prototype.isMesh=!0;class Cg extends Ir{constructor(t=1,e=1,n=1,r=1,s=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:r,heightSegments:s,depthSegments:a};const l=this;r=Math.floor(r),s=Math.floor(s),a=Math.floor(a);const u=[],h=[],m=[],_=[];let v=0,S=0;function T(I,j,P,E,ie,ee,ce,ye,Ce,Ge,Qe){const nt=ee/Ce,ge=ce/Ge,Je=ee/2,mt=ce/2,pt=ye/2,Pt=Ce+1,et=Ge+1;let vt=0,kt=0;const pi=new He;for(let Ht=0;Ht<et;Ht++){const ct=Ht*ge-mt;for(let mi=0;mi<Pt;mi++)pi[I]=(mi*nt-Je)*E,pi[j]=ct*ie,pi[P]=pt,h.push(pi.x,pi.y,pi.z),pi[I]=0,pi[j]=0,pi[P]=ye>0?1:-1,m.push(pi.x,pi.y,pi.z),_.push(mi/Ce),_.push(1-Ht/Ge),vt+=1}for(let Ht=0;Ht<Ge;Ht++)for(let ct=0;ct<Ce;ct++){const Zi=v+ct+Pt*(Ht+1),zi=v+(ct+1)+Pt*(Ht+1),Zt=v+(ct+1)+Pt*Ht;u.push(v+ct+Pt*Ht,Zi,Zt),u.push(Zi,zi,Zt),kt+=6}l.addGroup(S,kt,Qe),S+=kt,v+=vt}T("z","y","x",-1,-1,n,e,t,a,s,0),T("z","y","x",1,-1,n,e,-t,a,s,1),T("x","z","y",1,1,t,n,e,r,a,2),T("x","z","y",1,-1,t,n,-e,r,a,3),T("x","y","z",1,-1,t,e,n,r,s,4),T("x","y","z",-1,-1,t,e,-n,r,s,5),this.setIndex(u),this.setAttribute("position",new Jn(h,3)),this.setAttribute("normal",new Jn(m,3)),this.setAttribute("uv",new Jn(_,2))}static fromJSON(t){return new Cg(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}}function LS(i){const t={};for(const e in i){t[e]={};for(const n in i[e]){const r=i[e][n];t[e][n]=r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.clone():Array.isArray(r)?r.slice():r}}return t}function au(i){const t={};for(let e=0;e<i.length;e++){const n=LS(i[e]);for(const r in n)t[r]=n[r]}return t}const wZ={clone:LS,merge:au};class Mg extends kc{constructor(t){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=LS(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){const e=super.toJSON(t);e.glslVersion=this.glslVersion,e.uniforms={};for(const r in this.uniforms){const a=this.uniforms[r].value;e.uniforms[r]=a&&a.isTexture?{type:"t",value:a.toJSON(t).uuid}:a&&a.isColor?{type:"c",value:a.getHex()}:a&&a.isVector2?{type:"v2",value:a.toArray()}:a&&a.isVector3?{type:"v3",value:a.toArray()}:a&&a.isVector4?{type:"v4",value:a.toArray()}:a&&a.isMatrix3?{type:"m3",value:a.toArray()}:a&&a.isMatrix4?{type:"m4",value:a.toArray()}:{value:a}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;const n={};for(const r in this.extensions)!0===this.extensions[r]&&(n[r]=!0);return Object.keys(n).length>0&&(e.extensions=n),e}}Mg.prototype.isShaderMaterial=!0;class qT extends Zs{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new nr,this.projectionMatrix=new nr,this.projectionMatrixInverse=new nr}copy(t,e){return super.copy(t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}qT.prototype.isCamera=!0;class mc extends qT{constructor(t=50,e=1,n=.1,r=2e3){super(),this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){const e=.5*this.getFilmHeight()/t;this.fov=2*VT*Math.atan(e),this.updateProjectionMatrix()}getFocalLength(){const t=Math.tan(.5*b0*this.fov);return.5*this.getFilmHeight()/t}getEffectiveFOV(){return 2*VT*Math.atan(Math.tan(.5*b0*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(t,e,n,r,s,a){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=this.near;let e=t*Math.tan(.5*b0*this.fov)/this.zoom,n=2*e,r=this.aspect*n,s=-.5*r;const a=this.view;if(null!==this.view&&this.view.enabled){const u=a.fullWidth,h=a.fullHeight;s+=a.offsetX*r/u,e-=a.offsetY*n/h,r*=a.width/u,n*=a.height/h}const l=this.filmOffset;0!==l&&(s+=t*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,e,e-n,t,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}mc.prototype.isPerspectiveCamera=!0;class x2 extends Zs{constructor(t,e,n){if(super(),this.type="CubeCamera",!0!==n.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=n;const r=new mc(90,1,t,e);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new He(1,0,0)),this.add(r);const s=new mc(90,1,t,e);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new He(-1,0,0)),this.add(s);const a=new mc(90,1,t,e);a.layers=this.layers,a.up.set(0,0,1),a.lookAt(new He(0,1,0)),this.add(a);const l=new mc(90,1,t,e);l.layers=this.layers,l.up.set(0,0,-1),l.lookAt(new He(0,-1,0)),this.add(l);const u=new mc(90,1,t,e);u.layers=this.layers,u.up.set(0,-1,0),u.lookAt(new He(0,0,1)),this.add(u);const h=new mc(90,1,t,e);h.layers=this.layers,h.up.set(0,-1,0),h.lookAt(new He(0,0,-1)),this.add(h)}update(t,e){null===this.parent&&this.updateMatrixWorld();const n=this.renderTarget,[r,s,a,l,u,h]=this.children,m=t.xr.enabled,_=t.getRenderTarget();t.xr.enabled=!1;const v=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,t.setRenderTarget(n,0),t.render(e,r),t.setRenderTarget(n,1),t.render(e,s),t.setRenderTarget(n,2),t.render(e,a),t.setRenderTarget(n,3),t.render(e,l),t.setRenderTarget(n,4),t.render(e,u),n.texture.generateMipmaps=v,t.setRenderTarget(n,5),t.render(e,h),t.setRenderTarget(_),t.xr.enabled=m,n.texture.needsPMREMUpdate=!0}}class BS extends Jl{constructor(t,e,n,r,s,a,l,u,h,m){super(t=void 0!==t?t:[],e=void 0!==e?e:h0,n,r,s,a,l,u,h,m),this.flipY=!1}get images(){return this.image}set images(t){this.image=t}}BS.prototype.isCubeTexture=!0;class w2 extends Hh{constructor(t,e,n){Number.isInteger(e)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),e=n),super(t,t,e),this.texture=new BS(void 0,(e=e||{}).mapping,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.format,e.type,e.anisotropy,e.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==e.generateMipmaps&&e.generateMipmaps,this.texture.minFilter=void 0!==e.minFilter?e.minFilter:Ka}fromEquirectangularTexture(t,e){this.texture.type=e.type,this.texture.format=Qc,this.texture.encoding=e.encoding,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;const n_uniforms={tEquirect:{value:null}},n_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",n_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",r=new Cg(5,5,5),s=new Mg({name:"CubemapFromEquirect",uniforms:LS(n_uniforms),vertexShader:n_vertexShader,fragmentShader:n_fragmentShader,side:Al,blending:fg});s.uniforms.tEquirect.value=e;const a=new Qa(r,s),l=e.minFilter;return e.minFilter===f0&&(e.minFilter=Ka),new x2(1,10,this).update(t,a),e.minFilter=l,a.geometry.dispose(),a.material.dispose(),this}clear(t,e,n,r){const s=t.getRenderTarget();for(let a=0;a<6;a++)t.setRenderTarget(this,a),t.clear(e,n,r);t.setRenderTarget(s)}}w2.prototype.isWebGLCubeRenderTarget=!0;const g5=new He,abe=new He,lbe=new pc;class Lp{constructor(t=new He(1,0,0),e=0){this.normal=t,this.constant=e}set(t,e){return this.normal.copy(t),this.constant=e,this}setComponents(t,e,n,r){return this.normal.set(t,e,n),this.constant=r,this}setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(t,e,n){const r=g5.subVectors(n,e).cross(abe.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(r,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,e){return e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)}intersectLine(t,e){const n=t.delta(g5),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(t.start)?e.copy(t.start):null;const s=-(t.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:e.copy(n).multiplyScalar(s).add(t.start)}intersectsLine(t){const e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,e){const n=e||lbe.getNormalMatrix(t),r=this.coplanarPoint(g5).applyMatrix4(t),s=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(s),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return(new this.constructor).copy(this)}}Lp.prototype.isPlane=!0;const NS=new Iy,S2=new He;class XT{constructor(t=new Lp,e=new Lp,n=new Lp,r=new Lp,s=new Lp,a=new Lp){this.planes=[t,e,n,r,s,a]}set(t,e,n,r,s,a){const l=this.planes;return l[0].copy(t),l[1].copy(e),l[2].copy(n),l[3].copy(r),l[4].copy(s),l[5].copy(a),this}copy(t){const e=this.planes;for(let n=0;n<6;n++)e[n].copy(t.planes[n]);return this}setFromProjectionMatrix(t){const e=this.planes,n=t.elements,r=n[0],s=n[1],a=n[2],l=n[3],u=n[4],h=n[5],m=n[6],_=n[7],v=n[8],S=n[9],T=n[10],I=n[11],j=n[12],P=n[13],E=n[14],ie=n[15];return e[0].setComponents(l-r,_-u,I-v,ie-j).normalize(),e[1].setComponents(l+r,_+u,I+v,ie+j).normalize(),e[2].setComponents(l+s,_+h,I+S,ie+P).normalize(),e[3].setComponents(l-s,_-h,I-S,ie-P).normalize(),e[4].setComponents(l-a,_-m,I-T,ie-E).normalize(),e[5].setComponents(l+a,_+m,I+T,ie+E).normalize(),this}intersectsObject(t){const e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),NS.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(NS)}intersectsSprite(t){return NS.center.set(0,0,0),NS.radius=.7071067811865476,NS.applyMatrix4(t.matrixWorld),this.intersectsSphere(NS)}intersectsSphere(t){const e=this.planes,n=t.center,r=-t.radius;for(let s=0;s<6;s++)if(e[s].distanceToPoint(n)<r)return!1;return!0}intersectsBox(t){const e=this.planes;for(let n=0;n<6;n++){const r=e[n];if(S2.x=r.normal.x>0?t.max.x:t.min.x,S2.y=r.normal.y>0?t.max.y:t.min.y,S2.z=r.normal.z>0?t.max.z:t.min.z,r.distanceToPoint(S2)<0)return!1}return!0}containsPoint(t){const e=this.planes;for(let n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function SZ(){let i=null,t=!1,e=null,n=null;function r(s,a){e(s,a),n=i.requestAnimationFrame(r)}return{start:function(){!0!==t&&null!==e&&(n=i.requestAnimationFrame(r),t=!0)},stop:function(){i.cancelAnimationFrame(n),t=!1},setAnimationLoop:function(s){e=s},setContext:function(s){i=s}}}function cbe(i,t){const e=t.isWebGL2,n=new WeakMap;return{get:function a(h){return h.isInterleavedBufferAttribute&&(h=h.data),n.get(h)},remove:function l(h){h.isInterleavedBufferAttribute&&(h=h.data);const m=n.get(h);m&&(i.deleteBuffer(m.buffer),n.delete(h))},update:function u(h,m){if(h.isGLBufferAttribute){const v=n.get(h);return void((!v||v.version<h.version)&&n.set(h,{buffer:h.buffer,type:h.type,bytesPerElement:h.elementSize,version:h.version}))}h.isInterleavedBufferAttribute&&(h=h.data);const _=n.get(h);void 0===_?n.set(h,function r(h,m){const _=h.array,v=h.usage,S=i.createBuffer();i.bindBuffer(m,S),i.bufferData(m,_,v),h.onUploadCallback();let T=5126;return _ instanceof Float32Array?T=5126:_ instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):_ instanceof Uint16Array?h.isFloat16BufferAttribute?e?T=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):T=5123:_ instanceof Int16Array?T=5122:_ instanceof Uint32Array?T=5125:_ instanceof Int32Array?T=5124:_ instanceof Int8Array?T=5120:(_ instanceof Uint8Array||_ instanceof Uint8ClampedArray)&&(T=5121),{buffer:S,type:T,bytesPerElement:_.BYTES_PER_ELEMENT,version:h.version}}(h,m)):_.version<h.version&&(function s(h,m,_){const v=m.array,S=m.updateRange;i.bindBuffer(_,h),-1===S.count?i.bufferSubData(_,0,v):(e?i.bufferSubData(_,S.offset*v.BYTES_PER_ELEMENT,v,S.offset,S.count):i.bufferSubData(_,S.offset*v.BYTES_PER_ELEMENT,v.subarray(S.offset,S.offset+S.count)),S.count=-1)}(_.buffer,h,m),_.version=h.version)}}}class M0 extends Ir{constructor(t=1,e=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r};const s=t/2,a=e/2,l=Math.floor(n),u=Math.floor(r),h=l+1,m=u+1,_=t/l,v=e/u,S=[],T=[],I=[],j=[];for(let P=0;P<m;P++){const E=P*v-a;for(let ie=0;ie<h;ie++)T.push(ie*_-s,-E,0),I.push(0,0,1),j.push(ie/l),j.push(1-P/u)}for(let P=0;P<u;P++)for(let E=0;E<l;E++){const ee=E+h*(P+1),ce=E+1+h*(P+1),ye=E+1+h*P;S.push(E+h*P,ee,ye),S.push(ee,ce,ye)}this.setIndex(S),this.setAttribute("position",new Jn(T,3)),this.setAttribute("normal",new Jn(I,3)),this.setAttribute("uv",new Jn(j,2))}static fromJSON(t){return new M0(t.width,t.height,t.widthSegments,t.heightSegments)}}const Vs={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 ) + 0.5;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t}\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\t\tuv *= texelSize;\n\t\treturn texture2D( envMap, uv ).rgb;\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec;\n\t\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\t\treflectVec = reflect( - viewDir, normal );\n\t\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\t#else\n\t\t\t\treflectVec = refract( - viewDir, normal, refractionRatio );\n\t\t\t#endif\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tlightMapIrradiance *= PI;\n\t#endif\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\tvec3 FssEss = specularColor * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1, 2 ) * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform vec2 morphTargetsTextureSize;\n\t\tvec3 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset, const in int stride ) {\n\t\t\tfloat texelIndex = float( vertexIndex * stride + offset );\n\t\t\tfloat y = floor( texelIndex / morphTargetsTextureSize.x );\n\t\t\tfloat x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tvec3 morphUV = vec3( ( x + 0.5 ) / morphTargetsTextureSize.x, y / morphTargetsTextureSize.y, morphTargetIndex );\n\t\t\treturn texture( morphTargetsTexture, morphUV ).xyz;\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\t#ifndef USE_MORPHNORMALS\n\t\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 1 ) * morphTargetInfluences[ i ];\n\t\t\t#else\n\t\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 2 ) * morphTargetInfluences[ i ];\n\t\t\t#endif\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationColor, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tgl_FragColor = texture2D( t2D, vUv );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},mn={common:{diffuse:{value:new En(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new pc},uv2Transform:{value:new pc},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Oi(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new En(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new En(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new pc}},sprite:{diffuse:{value:new En(16777215)},opacity:{value:1},center:{value:new Oi(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new pc}}},Zf={basic:{uniforms:au([mn.common,mn.specularmap,mn.envmap,mn.aomap,mn.lightmap,mn.fog]),vertexShader:Vs.meshbasic_vert,fragmentShader:Vs.meshbasic_frag},lambert:{uniforms:au([mn.common,mn.specularmap,mn.envmap,mn.aomap,mn.lightmap,mn.emissivemap,mn.fog,mn.lights,{emissive:{value:new En(0)}}]),vertexShader:Vs.meshlambert_vert,fragmentShader:Vs.meshlambert_frag},phong:{uniforms:au([mn.common,mn.specularmap,mn.envmap,mn.aomap,mn.lightmap,mn.emissivemap,mn.bumpmap,mn.normalmap,mn.displacementmap,mn.fog,mn.lights,{emissive:{value:new En(0)},specular:{value:new En(1118481)},shininess:{value:30}}]),vertexShader:Vs.meshphong_vert,fragmentShader:Vs.meshphong_frag},standard:{uniforms:au([mn.common,mn.envmap,mn.aomap,mn.lightmap,mn.emissivemap,mn.bumpmap,mn.normalmap,mn.displacementmap,mn.roughnessmap,mn.metalnessmap,mn.fog,mn.lights,{emissive:{value:new En(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Vs.meshphysical_vert,fragmentShader:Vs.meshphysical_frag},toon:{uniforms:au([mn.common,mn.aomap,mn.lightmap,mn.emissivemap,mn.bumpmap,mn.normalmap,mn.displacementmap,mn.gradientmap,mn.fog,mn.lights,{emissive:{value:new En(0)}}]),vertexShader:Vs.meshtoon_vert,fragmentShader:Vs.meshtoon_frag},matcap:{uniforms:au([mn.common,mn.bumpmap,mn.normalmap,mn.displacementmap,mn.fog,{matcap:{value:null}}]),vertexShader:Vs.meshmatcap_vert,fragmentShader:Vs.meshmatcap_frag},points:{uniforms:au([mn.points,mn.fog]),vertexShader:Vs.points_vert,fragmentShader:Vs.points_frag},dashed:{uniforms:au([mn.common,mn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Vs.linedashed_vert,fragmentShader:Vs.linedashed_frag},depth:{uniforms:au([mn.common,mn.displacementmap]),vertexShader:Vs.depth_vert,fragmentShader:Vs.depth_frag},normal:{uniforms:au([mn.common,mn.bumpmap,mn.normalmap,mn.displacementmap,{opacity:{value:1}}]),vertexShader:Vs.meshnormal_vert,fragmentShader:Vs.meshnormal_frag},sprite:{uniforms:au([mn.sprite,mn.fog]),vertexShader:Vs.sprite_vert,fragmentShader:Vs.sprite_frag},background:{uniforms:{uvTransform:{value:new pc},t2D:{value:null}},vertexShader:Vs.background_vert,fragmentShader:Vs.background_frag},cube:{uniforms:au([mn.envmap,{opacity:{value:1}}]),vertexShader:Vs.cube_vert,fragmentShader:Vs.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Vs.equirect_vert,fragmentShader:Vs.equirect_frag},distanceRGBA:{uniforms:au([mn.common,mn.displacementmap,{referencePosition:{value:new He},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Vs.distanceRGBA_vert,fragmentShader:Vs.distanceRGBA_frag},shadow:{uniforms:au([mn.lights,mn.fog,{color:{value:new En(0)},opacity:{value:1}}]),vertexShader:Vs.shadow_vert,fragmentShader:Vs.shadow_frag}};function rxe(i,t,e,n,r,s){const a=new En(0);let u,h,l=!0===r?0:1,m=null,_=0,v=null;function T(I,j){e.buffers.color.setClear(I.r,I.g,I.b,j,s)}return{getClearColor:function(){return a},setClearColor:function(I,j=1){a.set(I),l=j,T(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(I){l=I,T(a,l)},render:function S(I,j){let P=!1,E=!0===j.isScene?j.background:null;E&&E.isTexture&&(E=t.get(E));const ie=i.xr,ee=ie.getSession&&ie.getSession();ee&&"additive"===ee.environmentBlendMode&&(E=null),null===E?T(a,l):E&&E.isColor&&(T(E,1),P=!0),(i.autoClear||P)&&i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil),E&&(E.isCubeTexture||E.mapping===yS)?(void 0===h&&(h=new Qa(new Cg(1,1,1),new Mg({name:"BackgroundCubeMaterial",uniforms:LS(Zf.cube.uniforms),vertexShader:Zf.cube.vertexShader,fragmentShader:Zf.cube.fragmentShader,side:Al,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),h.geometry.deleteAttribute("uv"),h.onBeforeRender=function(ce,ye,Ce){this.matrixWorld.copyPosition(Ce.matrixWorld)},Object.defineProperty(h.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(h)),h.material.uniforms.envMap.value=E,h.material.uniforms.flipEnvMap.value=E.isCubeTexture&&!1===E.isRenderTargetTexture?-1:1,(m!==E||_!==E.version||v!==i.toneMapping)&&(h.material.needsUpdate=!0,m=E,_=E.version,v=i.toneMapping),I.unshift(h,h.geometry,h.material,0,0,null)):E&&E.isTexture&&(void 0===u&&(u=new Qa(new M0(2,2),new Mg({name:"BackgroundMaterial",uniforms:LS(Zf.background.uniforms),vertexShader:Zf.background.vertexShader,fragmentShader:Zf.background.fragmentShader,side:l0,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),Object.defineProperty(u.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(u)),u.material.uniforms.t2D.value=E,!0===E.matrixAutoUpdate&&E.updateMatrix(),u.material.uniforms.uvTransform.value.copy(E.matrix),(m!==E||_!==E.version||v!==i.toneMapping)&&(u.material.needsUpdate=!0,m=E,_=E.version,v=i.toneMapping),I.unshift(u,u.geometry,u.material,0,0,null))}}}function sxe(i,t,e,n){const r=i.getParameter(34921),s=n.isWebGL2?null:t.get("OES_vertex_array_object"),a=n.isWebGL2||null!==s,l={},u=I(null);let h=u;function v(mt){return n.isWebGL2?i.bindVertexArray(mt):s.bindVertexArrayOES(mt)}function S(mt){return n.isWebGL2?i.deleteVertexArray(mt):s.deleteVertexArrayOES(mt)}function I(mt){const pt=[],Pt=[],et=[];for(let vt=0;vt<r;vt++)pt[vt]=0,Pt[vt]=0,et[vt]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:pt,enabledAttributes:Pt,attributeDivisors:et,object:mt,attributes:{},index:null}}function E(){const mt=h.newAttributes;for(let pt=0,Pt=mt.length;pt<Pt;pt++)mt[pt]=0}function ie(mt){ee(mt,0)}function ee(mt,pt){const et=h.enabledAttributes,vt=h.attributeDivisors;h.newAttributes[mt]=1,0===et[mt]&&(i.enableVertexAttribArray(mt),et[mt]=1),vt[mt]!==pt&&((n.isWebGL2?i:t.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](mt,pt),vt[mt]=pt)}function ce(){const mt=h.newAttributes,pt=h.enabledAttributes;for(let Pt=0,et=pt.length;Pt<et;Pt++)pt[Pt]!==mt[Pt]&&(i.disableVertexAttribArray(Pt),pt[Pt]=0)}function ye(mt,pt,Pt,et,vt,kt){!0!==n.isWebGL2||5124!==Pt&&5125!==Pt?i.vertexAttribPointer(mt,pt,Pt,et,vt,kt):i.vertexAttribIPointer(mt,pt,Pt,vt,kt)}function ge(){Je(),h!==u&&(h=u,v(h.object))}function Je(){u.geometry=null,u.program=null,u.wireframe=!1}return{setup:function m(mt,pt,Pt,et,vt){let kt=!1;if(a){const pi=function T(mt,pt,Pt){const et=!0===Pt.wireframe;let vt=l[mt.id];void 0===vt&&(vt={},l[mt.id]=vt);let kt=vt[pt.id];void 0===kt&&(kt={},vt[pt.id]=kt);let pi=kt[et];return void 0===pi&&(pi=I(function _(){return n.isWebGL2?i.createVertexArray():s.createVertexArrayOES()}()),kt[et]=pi),pi}(et,Pt,pt);h!==pi&&(h=pi,v(h.object)),kt=function j(mt,pt){const Pt=h.attributes,et=mt.attributes;let vt=0;for(const kt in et){const pi=Pt[kt],Ht=et[kt];if(void 0===pi||pi.attribute!==Ht||pi.data!==Ht.data)return!0;vt++}return h.attributesNum!==vt||h.index!==pt}(et,vt),kt&&function P(mt,pt){const Pt={},et=mt.attributes;let vt=0;for(const kt in et){const pi=et[kt],Ht={};Ht.attribute=pi,pi.data&&(Ht.data=pi.data),Pt[kt]=Ht,vt++}h.attributes=Pt,h.attributesNum=vt,h.index=pt}(et,vt)}else{const pi=!0===pt.wireframe;(h.geometry!==et.id||h.program!==Pt.id||h.wireframe!==pi)&&(h.geometry=et.id,h.program=Pt.id,h.wireframe=pi,kt=!0)}!0===mt.isInstancedMesh&&(kt=!0),null!==vt&&e.update(vt,34963),kt&&(function Ce(mt,pt,Pt,et){if(!1===n.isWebGL2&&(mt.isInstancedMesh||et.isInstancedBufferGeometry)&&null===t.get("ANGLE_instanced_arrays"))return;E();const vt=et.attributes,kt=Pt.getAttributes(),pi=pt.defaultAttributeValues;for(const Ht in kt){const ct=kt[Ht];if(ct.location>=0){let mi=vt[Ht];if(void 0===mi&&("instanceMatrix"===Ht&&mt.instanceMatrix&&(mi=mt.instanceMatrix),"instanceColor"===Ht&&mt.instanceColor&&(mi=mt.instanceColor)),void 0!==mi){const Zi=mi.normalized,zi=mi.itemSize,Zt=e.get(mi);if(void 0===Zt)continue;const tr=Zt.buffer,nn=Zt.type,Un=Zt.bytesPerElement;if(mi.isInterleavedBufferAttribute){const Cn=mi.data,ts=Cn.stride,Hr=mi.offset;if(Cn&&Cn.isInstancedInterleavedBuffer){for(let Ri=0;Ri<ct.locationSize;Ri++)ee(ct.location+Ri,Cn.meshPerAttribute);!0!==mt.isInstancedMesh&&void 0===et._maxInstanceCount&&(et._maxInstanceCount=Cn.meshPerAttribute*Cn.count)}else for(let Ri=0;Ri<ct.locationSize;Ri++)ie(ct.location+Ri);i.bindBuffer(34962,tr);for(let Ri=0;Ri<ct.locationSize;Ri++)ye(ct.location+Ri,zi/ct.locationSize,nn,Zi,ts*Un,(Hr+zi/ct.locationSize*Ri)*Un)}else{if(mi.isInstancedBufferAttribute){for(let Cn=0;Cn<ct.locationSize;Cn++)ee(ct.location+Cn,mi.meshPerAttribute);!0!==mt.isInstancedMesh&&void 0===et._maxInstanceCount&&(et._maxInstanceCount=mi.meshPerAttribute*mi.count)}else for(let Cn=0;Cn<ct.locationSize;Cn++)ie(ct.location+Cn);i.bindBuffer(34962,tr);for(let Cn=0;Cn<ct.locationSize;Cn++)ye(ct.location+Cn,zi/ct.locationSize,nn,Zi,zi*Un,zi/ct.locationSize*Cn*Un)}}else if(void 0!==pi){const Zi=pi[Ht];if(void 0!==Zi)switch(Zi.length){case 2:i.vertexAttrib2fv(ct.location,Zi);break;case 3:i.vertexAttrib3fv(ct.location,Zi);break;case 4:i.vertexAttrib4fv(ct.location,Zi);break;default:i.vertexAttrib1fv(ct.location,Zi)}}}}ce()}(mt,pt,Pt,et),null!==vt&&i.bindBuffer(34963,e.get(vt).buffer))},reset:ge,resetDefaultState:Je,dispose:function Ge(){ge();for(const mt in l){const pt=l[mt];for(const Pt in pt){const et=pt[Pt];for(const vt in et)S(et[vt].object),delete et[vt];delete pt[Pt]}delete l[mt]}},releaseStatesOfGeometry:function Qe(mt){if(void 0===l[mt.id])return;const pt=l[mt.id];for(const Pt in pt){const et=pt[Pt];for(const vt in et)S(et[vt].object),delete et[vt];delete pt[Pt]}delete l[mt.id]},releaseStatesOfProgram:function nt(mt){for(const pt in l){const Pt=l[pt];if(void 0===Pt[mt.id])continue;const et=Pt[mt.id];for(const vt in et)S(et[vt].object),delete et[vt];delete Pt[mt.id]}},initAttributes:E,enableAttribute:ie,disableUnusedAttributes:ce}}function oxe(i,t,e,n){const r=n.isWebGL2;let s;this.setMode=function a(h){s=h},this.render=function l(h,m){i.drawArrays(s,h,m),e.update(m,s,1)},this.renderInstances=function u(h,m,_){if(0===_)return;let v,S;if(r)v=i,S="drawArraysInstanced";else if(v=t.get("ANGLE_instanced_arrays"),S="drawArraysInstancedANGLE",null===v)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");v[S](s,h,m,_),e.update(m,s,_)}}function axe(i,t,e){let n;function s(Ce){if("highp"===Ce){if(i.getShaderPrecisionFormat(35633,36338).precision>0&&i.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";Ce="mediump"}return"mediump"===Ce&&i.getShaderPrecisionFormat(35633,36337).precision>0&&i.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const a="undefined"!=typeof WebGL2RenderingContext&&i instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&i instanceof WebGL2ComputeRenderingContext;let l=void 0!==e.precision?e.precision:"highp";const u=s(l);u!==l&&(console.warn("THREE.WebGLRenderer:",l,"not supported, using",u,"instead."),l=u);const h=a||t.has("WEBGL_draw_buffers"),m=!0===e.logarithmicDepthBuffer,_=i.getParameter(34930),v=i.getParameter(35660),S=i.getParameter(3379),T=i.getParameter(34076),I=i.getParameter(34921),j=i.getParameter(36347),P=i.getParameter(36348),E=i.getParameter(36349),ie=v>0,ee=a||t.has("OES_texture_float");return{isWebGL2:a,drawBuffers:h,getMaxAnisotropy:function r(){if(void 0!==n)return n;if(!0===t.has("EXT_texture_filter_anisotropic")){const Ce=t.get("EXT_texture_filter_anisotropic");n=i.getParameter(Ce.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n},getMaxPrecision:s,precision:l,logarithmicDepthBuffer:m,maxTextures:_,maxVertexTextures:v,maxTextureSize:S,maxCubemapSize:T,maxAttributes:I,maxVertexUniforms:j,maxVaryings:P,maxFragmentUniforms:E,vertexTextures:ie,floatFragmentTextures:ee,floatVertexTextures:ie&&ee,maxSamples:a?i.getParameter(36183):0}}function lxe(i){const t=this;let e=null,n=0,r=!1,s=!1;const a=new Lp,l=new pc,u={value:null,needsUpdate:!1};function h(){u.value!==e&&(u.value=e,u.needsUpdate=n>0),t.numPlanes=n,t.numIntersection=0}function m(_,v,S,T){const I=null!==_?_.length:0;let j=null;if(0!==I){if(j=u.value,!0!==T||null===j){const P=S+4*I,E=v.matrixWorldInverse;l.getNormalMatrix(E),(null===j||j.length<P)&&(j=new Float32Array(P));for(let ie=0,ee=S;ie!==I;++ie,ee+=4)a.copy(_[ie]).applyMatrix4(E,l),a.normal.toArray(j,ee),j[ee+3]=a.constant}u.value=j,u.needsUpdate=!0}return t.numPlanes=I,t.numIntersection=0,j}this.uniform=u,this.numPlanes=0,this.numIntersection=0,this.init=function(_,v,S){const T=0!==_.length||v||0!==n||r;return r=v,e=m(_,S,0),n=_.length,T},this.beginShadows=function(){s=!0,m(null)},this.endShadows=function(){s=!1,h()},this.setState=function(_,v,S){const T=_.clippingPlanes,I=_.clipIntersection,j=_.clipShadows,P=i.get(_);if(!r||null===T||0===T.length||s&&!j)s?m(null):h();else{const E=s?0:n,ie=4*E;let ee=P.clippingState||null;u.value=ee,ee=m(T,v,ie,S);for(let ce=0;ce!==ie;++ce)ee[ce]=e[ce];P.clippingState=ee,this.numIntersection=I?this.numPlanes:0,this.numPlanes+=E}}}function cxe(i){let t=new WeakMap;function e(a,l){return l===kT?a.mapping=h0:l===PT&&(a.mapping=d0),a}function r(a){const l=a.target;l.removeEventListener("dispose",r);const u=t.get(l);void 0!==u&&(t.delete(l),u.dispose())}return{get:function n(a){if(a&&a.isTexture&&!1===a.isRenderTargetTexture){const l=a.mapping;if(l===kT||l===PT){if(t.has(a))return e(t.get(a).texture,a.mapping);{const u=a.image;if(u&&u.height>0){const h=new w2(u.height/2);return h.fromEquirectangularTexture(i,a),t.set(a,h),a.addEventListener("dispose",r),e(h.texture,a.mapping)}return null}}}return a},dispose:function s(){t=new WeakMap}}}Zf.physical={uniforms:au([Zf.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Oi(1,1)},clearcoatNormalMap:{value:null},sheen:{value:0},sheenColor:{value:new En(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Oi},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new En(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new En(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Vs.meshphysical_vert,fragmentShader:Vs.meshphysical_frag};class ZT extends qT{constructor(t=-1,e=1,n=1,r=-1,s=.1,a=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=n,this.bottom=r,this.near=s,this.far=a,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this}setViewOffset(t,e,n,r,s,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=n-t,a=n+t,l=r+e,u=r-e;if(null!==this.view&&this.view.enabled){const h=(this.right-this.left)/this.view.fullWidth/this.zoom,m=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=h*this.view.offsetX,a=s+h*this.view.width,l-=m*this.view.offsetY,u=l-m*this.view.height}this.projectionMatrix.makeOrthographic(s,a,l,u,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}ZT.prototype.isOrthographicCamera=!0;class HS extends Mg{constructor(t){super(t),this.type="RawShaderMaterial"}}HS.prototype.isRawShaderMaterial=!0;const Op=Math.pow(2,8),CZ=[.125,.215,.35,.446,.526,.582],MZ=5+CZ.length,_5=new ZT,{_lodPlanes:YT,_sizeLods:TZ,_sigmas:C2}=uxe(),EZ=new En;let y5=null;const T0=(1+Math.sqrt(5))/2,US=1/T0,AZ=[new He(1,1,1),new He(-1,1,1),new He(1,1,-1),new He(-1,1,-1),new He(0,T0,US),new He(0,T0,-US),new He(US,0,T0),new He(-US,0,T0),new He(T0,US,0),new He(-T0,US,0)];class v5{constructor(t){this._renderer=t,this._pingPongRenderTarget=null,this._blurMaterial=function hxe(i){const t=new Float32Array(i),e=new He(0,1,0);return new HS({name:"SphericalGaussianBlur",defines:{n:i},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:t},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:e}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:fg,depthTest:!1,depthWrite:!1})}(20),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}fromScene(t,e=0,n=.1,r=100){y5=this._renderer.getRenderTarget();const s=this._allocateTargets();return this._sceneToCubeUV(t,n,r,s),e>0&&this._blur(s,0,0,e),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(t,e=null){return this._fromTexture(t,e)}fromCubemap(t,e=null){return this._fromTexture(t,e)}compileCubemapShader(){null===this._cubemapShader&&(this._cubemapShader=kZ(),this._compileMaterial(this._cubemapShader))}compileEquirectangularShader(){null===this._equirectShader&&(this._equirectShader=RZ(),this._compileMaterial(this._equirectShader))}dispose(){this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(let t=0;t<YT.length;t++)YT[t].dispose()}_cleanup(t){this._renderer.setRenderTarget(y5),t.scissorTest=!1,M2(t,0,0,t.width,t.height)}_fromTexture(t,e){y5=this._renderer.getRenderTarget();const n=e||this._allocateTargets(t);return this._textureToCubeUV(t,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(t){const e={magFilter:Ka,minFilter:Ka,generateMipmaps:!1,type:p0,format:Qc,encoding:_g,depthBuffer:!1},n=DZ(e);return n.depthBuffer=!t,null===this._pingPongRenderTarget&&(this._pingPongRenderTarget=DZ(e)),n}_compileMaterial(t){const e=new Qa(YT[0],t);this._renderer.compile(e,_5)}_sceneToCubeUV(t,e,n,r){const l=new mc(90,1,e,n),u=[1,-1,1,1,1,1],h=[1,1,1,-1,-1,-1],m=this._renderer,_=m.autoClear,v=m.toneMapping;m.getClearColor(EZ),m.toneMapping=pg,m.autoClear=!1;const S=new Sg({name:"PMREM.Background",side:Al,depthWrite:!1,depthTest:!1}),T=new Qa(new Cg,S);let I=!1;const j=t.background;j?j.isColor&&(S.color.copy(j),t.background=null,I=!0):(S.color.copy(EZ),I=!0);for(let P=0;P<6;P++){const E=P%3;0===E?(l.up.set(0,u[P],0),l.lookAt(h[P],0,0)):1===E?(l.up.set(0,0,u[P]),l.lookAt(0,h[P],0)):(l.up.set(0,u[P],0),l.lookAt(0,0,h[P])),M2(r,E*Op,P>2?Op:0,Op,Op),m.setRenderTarget(r),I&&m.render(T,l),m.render(t,l)}T.geometry.dispose(),T.material.dispose(),m.toneMapping=v,m.autoClear=_,t.background=j}_textureToCubeUV(t,e){const n=this._renderer,r=t.mapping===h0||t.mapping===d0;r?(null===this._cubemapShader&&(this._cubemapShader=kZ()),this._cubemapShader.uniforms.flipEnvMap.value=!1===t.isRenderTargetTexture?-1:1):null===this._equirectShader&&(this._equirectShader=RZ());const s=r?this._cubemapShader:this._equirectShader,a=new Qa(YT[0],s),l=s.uniforms;l.envMap.value=t,r||l.texelSize.value.set(1/t.image.width,1/t.image.height),M2(e,0,0,3*Op,2*Op),n.setRenderTarget(e),n.render(a,_5)}_applyPMREM(t){const e=this._renderer,n=e.autoClear;e.autoClear=!1;for(let r=1;r<MZ;r++){const s=Math.sqrt(C2[r]*C2[r]-C2[r-1]*C2[r-1]);this._blur(t,r-1,r,s,AZ[(r-1)%AZ.length])}e.autoClear=n}_blur(t,e,n,r,s){const a=this._pingPongRenderTarget;this._halfBlur(t,a,e,n,r,"latitudinal",s),this._halfBlur(a,t,n,n,r,"longitudinal",s)}_halfBlur(t,e,n,r,s,a,l){const u=this._renderer,h=this._blurMaterial;"latitudinal"!==a&&"longitudinal"!==a&&console.error("blur direction must be either latitudinal or longitudinal!");const _=new Qa(YT[r],h),v=h.uniforms,S=TZ[n]-1,T=isFinite(s)?Math.PI/(2*S):2*Math.PI/39,I=s/T,j=isFinite(s)?1+Math.floor(3*I):20;j>20&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${j} samples when the maximum is set to 20`);const P=[];let E=0;for(let ye=0;ye<20;++ye){const Ce=ye/I,Ge=Math.exp(-Ce*Ce/2);P.push(Ge),0===ye?E+=Ge:ye<j&&(E+=2*Ge)}for(let ye=0;ye<P.length;ye++)P[ye]=P[ye]/E;v.envMap.value=t.texture,v.samples.value=j,v.weights.value=P,v.latitudinal.value="latitudinal"===a,l&&(v.poleAxis.value=l),v.dTheta.value=T,v.mipInt.value=8-n;const ie=TZ[r];M2(e,3*Math.max(0,Op-2*ie),(0===r?0:2*Op)+2*ie*(r>4?r-8+4:0),3*ie,2*ie),u.setRenderTarget(e),u.render(_,_5)}}function uxe(){const i=[],t=[],e=[];let n=8;for(let r=0;r<MZ;r++){const s=Math.pow(2,n);t.push(s);let a=1/s;r>4?a=CZ[r-8+4-1]:0===r&&(a=0),e.push(a);const l=1/(s-1),u=-l/2,h=1+l/2,m=[u,u,h,u,h,h,u,u,h,h,u,h],_=6,v=6,S=3,T=2,I=1,j=new Float32Array(S*v*_),P=new Float32Array(T*v*_),E=new Float32Array(I*v*_);for(let ee=0;ee<_;ee++){const ce=ee%3*2/3-1,ye=ee>2?0:-1;j.set([ce,ye,0,ce+2/3,ye,0,ce+2/3,ye+1,0,ce,ye,0,ce+2/3,ye+1,0,ce,ye+1,0],S*v*ee),P.set(m,T*v*ee),E.set([ee,ee,ee,ee,ee,ee],I*v*ee)}const ie=new Ir;ie.setAttribute("position",new lo(j,S)),ie.setAttribute("uv",new lo(P,T)),ie.setAttribute("faceIndex",new lo(E,I)),i.push(ie),n>4&&n--}return{_lodPlanes:i,_sizeLods:t,_sigmas:e}}function DZ(i){const t=new Hh(3*Op,3*Op,i);return t.texture.mapping=yS,t.texture.name="PMREM.cubeUv",t.scissorTest=!0,t}function M2(i,t,e,n,r){i.viewport.set(t,e,n,r),i.scissor.set(t,e,n,r)}function RZ(){const i=new Oi(1,1);return new HS({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:i}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = texture2D ( envMap, uv ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = texture2D ( envMap, uv ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = texture2D ( envMap, uv ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = texture2D ( envMap, uv ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t}\n\t\t",blending:fg,depthTest:!1,depthWrite:!1})}function kZ(){return new HS({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:fg,depthTest:!1,depthWrite:!1})}function dxe(i){let t=new WeakMap,e=null;function s(l){const u=l.target;u.removeEventListener("dispose",s);const h=t.get(u);void 0!==h&&(t.delete(u),h.dispose())}return{get:function n(l){if(l&&l.isTexture){const u=l.mapping,h=u===kT||u===PT,m=u===h0||u===d0;if(h||m){if(l.isRenderTargetTexture&&!0===l.needsPMREMUpdate){l.needsPMREMUpdate=!1;let _=t.get(l);return null===e&&(e=new v5(i)),_=h?e.fromEquirectangular(l,_):e.fromCubemap(l,_),t.set(l,_),_.texture}if(t.has(l))return t.get(l).texture;{const _=l.image;if(h&&_&&_.height>0||m&&_&&function r(l){let u=0;for(let m=0;m<6;m++)void 0!==l[m]&&u++;return 6===u}(_)){null===e&&(e=new v5(i));const v=h?e.fromEquirectangular(l):e.fromCubemap(l);return t.set(l,v),l.addEventListener("dispose",s),v.texture}return null}}}return l},dispose:function a(){t=new WeakMap,null!==e&&(e.dispose(),e=null)}}}function fxe(i){const t={};function e(n){if(void 0!==t[n])return t[n];let r;switch(n){case"WEBGL_depth_texture":r=i.getExtension("WEBGL_depth_texture")||i.getExtension("MOZ_WEBGL_depth_texture")||i.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=i.getExtension(n)}return t[n]=r,r}return{has:function(n){return null!==e(n)},init:function(n){n.isWebGL2?e("EXT_color_buffer_float"):(e("WEBGL_depth_texture"),e("OES_texture_float"),e("OES_texture_half_float"),e("OES_texture_half_float_linear"),e("OES_standard_derivatives"),e("OES_element_index_uint"),e("OES_vertex_array_object"),e("ANGLE_instanced_arrays")),e("OES_texture_float_linear"),e("EXT_color_buffer_half_float"),e("WEBGL_multisampled_render_to_texture")},get:function(n){const r=e(n);return null===r&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),r}}}function pxe(i,t,e,n){const r={},s=new WeakMap;function a(_){const v=_.target;null!==v.index&&t.remove(v.index);for(const T in v.attributes)t.remove(v.attributes[T]);v.removeEventListener("dispose",a),delete r[v.id];const S=s.get(v);S&&(t.remove(S),s.delete(v)),n.releaseStatesOfGeometry(v),!0===v.isInstancedBufferGeometry&&delete v._maxInstanceCount,e.memory.geometries--}function h(_){const v=[],S=_.index,T=_.attributes.position;let I=0;if(null!==S){const E=S.array;I=S.version;for(let ie=0,ee=E.length;ie<ee;ie+=3){const ce=E[ie+0],ye=E[ie+1],Ce=E[ie+2];v.push(ce,ye,ye,Ce,Ce,ce)}}else{I=T.version;for(let ie=0,ee=T.array.length/3-1;ie<ee;ie+=3){const ce=ie+0,ye=ie+1,Ce=ie+2;v.push(ce,ye,ye,Ce,Ce,ce)}}const j=new(tZ(v)?d2:h2)(v,1);j.version=I;const P=s.get(_);P&&t.remove(P),s.set(_,j)}return{get:function l(_,v){return!0===r[v.id]||(v.addEventListener("dispose",a),r[v.id]=!0,e.memory.geometries++),v},update:function u(_){const v=_.attributes;for(const T in v)t.update(v[T],34962);const S=_.morphAttributes;for(const T in S){const I=S[T];for(let j=0,P=I.length;j<P;j++)t.update(I[j],34962)}},getWireframeAttribute:function m(_){const v=s.get(_);if(v){const S=_.index;null!==S&&v.version<S.version&&h(_)}else h(_);return s.get(_)}}}function mxe(i,t,e,n){const r=n.isWebGL2;let s,l,u;this.setMode=function a(v){s=v},this.setIndex=function h(v){l=v.type,u=v.bytesPerElement},this.render=function m(v,S){i.drawElements(s,S,l,v*u),e.update(S,s,1)},this.renderInstances=function _(v,S,T){if(0===T)return;let I,j;if(r)I=i,j="drawElementsInstanced";else if(I=t.get("ANGLE_instanced_arrays"),j="drawElementsInstancedANGLE",null===I)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");I[j](s,S,l,v*u,T),e.update(S,s,T)}}function gxe(i){const e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function r(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function n(s,a,l){switch(e.calls++,a){case 4:e.triangles+=l*(s/3);break;case 1:e.lines+=l*(s/2);break;case 3:e.lines+=l*(s-1);break;case 2:e.lines+=l*s;break;case 0:e.points+=l*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",a)}}}}class T2 extends Jl{constructor(t=null,e=1,n=1,r=1){super(null),this.image={data:t,width:e,height:n,depth:r},this.magFilter=Dl,this.minFilter=Dl,this.wrapR=Kc,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}function _xe(i,t){return i[0]-t[0]}function yxe(i,t){return Math.abs(t[1])-Math.abs(i[1])}function PZ(i,t){let e=1;const n=t.isInterleavedBufferAttribute?t.data.array:t.array;n instanceof Int8Array?e=127:n instanceof Int16Array?e=32767:n instanceof Int32Array?e=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",n),i.divideScalar(e)}function vxe(i,t,e){const n={},r=new Float32Array(8),s=new WeakMap,a=new He,l=[];for(let h=0;h<8;h++)l[h]=[h,0];return{update:function u(h,m,_,v){const S=h.morphTargetInfluences;if(!0===t.isWebGL2){const T=m.morphAttributes.position.length;let I=s.get(m);if(void 0===I||I.count!==T){let Je=function(){nt.dispose(),s.delete(m),m.removeEventListener("dispose",Je)};void 0!==I&&I.texture.dispose();const E=void 0!==m.morphAttributes.normal,ie=m.morphAttributes.position,ee=m.morphAttributes.normal||[],ye=!0===E?2:1;let Ce=m.attributes.position.count*ye,Ge=1;Ce>t.maxTextureSize&&(Ge=Math.ceil(Ce/t.maxTextureSize),Ce=t.maxTextureSize);const Qe=new Float32Array(Ce*Ge*4*T),nt=new T2(Qe,Ce,Ge,T);nt.format=Qc,nt.type=gg,nt.needsUpdate=!0;const ge=4*ye;for(let mt=0;mt<T;mt++){const pt=ie[mt],Pt=ee[mt],et=Ce*Ge*4*mt;for(let vt=0;vt<pt.count;vt++){a.fromBufferAttribute(pt,vt),!0===pt.normalized&&PZ(a,pt);const kt=vt*ge;Qe[et+kt+0]=a.x,Qe[et+kt+1]=a.y,Qe[et+kt+2]=a.z,Qe[et+kt+3]=0,!0===E&&(a.fromBufferAttribute(Pt,vt),!0===Pt.normalized&&PZ(a,Pt),Qe[et+kt+4]=a.x,Qe[et+kt+5]=a.y,Qe[et+kt+6]=a.z,Qe[et+kt+7]=0)}}I={count:T,texture:nt,size:new Oi(Ce,Ge)},s.set(m,I),m.addEventListener("dispose",Je)}let j=0;for(let E=0;E<S.length;E++)j+=S[E];const P=m.morphTargetsRelative?1:1-j;v.getUniforms().setValue(i,"morphTargetBaseInfluence",P),v.getUniforms().setValue(i,"morphTargetInfluences",S),v.getUniforms().setValue(i,"morphTargetsTexture",I.texture,e),v.getUniforms().setValue(i,"morphTargetsTextureSize",I.size)}else{const T=void 0===S?0:S.length;let I=n[m.id];if(void 0===I||I.length!==T){I=[];for(let ee=0;ee<T;ee++)I[ee]=[ee,0];n[m.id]=I}for(let ee=0;ee<T;ee++){const ce=I[ee];ce[0]=ee,ce[1]=S[ee]}I.sort(yxe);for(let ee=0;ee<8;ee++)ee<T&&I[ee][1]?(l[ee][0]=I[ee][0],l[ee][1]=I[ee][1]):(l[ee][0]=Number.MAX_SAFE_INTEGER,l[ee][1]=0);l.sort(_xe);const j=m.morphAttributes.position,P=m.morphAttributes.normal;let E=0;for(let ee=0;ee<8;ee++){const ce=l[ee],ye=ce[0],Ce=ce[1];ye!==Number.MAX_SAFE_INTEGER&&Ce?(j&&m.getAttribute("morphTarget"+ee)!==j[ye]&&m.setAttribute("morphTarget"+ee,j[ye]),P&&m.getAttribute("morphNormal"+ee)!==P[ye]&&m.setAttribute("morphNormal"+ee,P[ye]),r[ee]=Ce,E+=Ce):(j&&!0===m.hasAttribute("morphTarget"+ee)&&m.deleteAttribute("morphTarget"+ee),P&&!0===m.hasAttribute("morphNormal"+ee)&&m.deleteAttribute("morphNormal"+ee),r[ee]=0)}const ie=m.morphTargetsRelative?1:1-E;v.getUniforms().setValue(i,"morphTargetBaseInfluence",ie),v.getUniforms().setValue(i,"morphTargetInfluences",r)}}}}function bxe(i,t,e,n){let r=new WeakMap;function l(u){const h=u.target;h.removeEventListener("dispose",l),e.remove(h.instanceMatrix),null!==h.instanceColor&&e.remove(h.instanceColor)}return{update:function s(u){const h=n.render.frame,_=t.get(u,u.geometry);return r.get(_)!==h&&(t.update(_),r.set(_,h)),u.isInstancedMesh&&(!1===u.hasEventListener("dispose",l)&&u.addEventListener("dispose",l),e.update(u.instanceMatrix,34962),null!==u.instanceColor&&e.update(u.instanceColor,34962)),_},dispose:function a(){r=new WeakMap}}}T2.prototype.isDataTexture2DArray=!0;class x5 extends Jl{constructor(t=null,e=1,n=1,r=1){super(null),this.image={data:t,width:e,height:n,depth:r},this.magFilter=Dl,this.minFilter=Dl,this.wrapR=Kc,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}x5.prototype.isDataTexture3D=!0;const IZ=new Jl,LZ=new T2,OZ=new x5,FZ=new BS,BZ=[],NZ=[],HZ=new Float32Array(16),VZ=new Float32Array(9),zZ=new Float32Array(4);function GS(i,t,e){const n=i[0];if(n<=0||n>0)return i;const r=t*e;let s=BZ[r];if(void 0===s&&(s=new Float32Array(r),BZ[r]=s),0!==t){n.toArray(s,0);for(let a=1,l=0;a!==t;++a)l+=e,i[a].toArray(s,l)}return s}function Ou(i,t){if(i.length!==t.length)return!1;for(let e=0,n=i.length;e<n;e++)if(i[e]!==t[e])return!1;return!0}function lu(i,t){for(let e=0,n=t.length;e<n;e++)i[e]=t[e]}function E2(i,t){let e=NZ[t];void 0===e&&(e=new Int32Array(t),NZ[t]=e);for(let n=0;n!==t;++n)e[n]=i.allocateTextureUnit();return e}function xxe(i,t){const e=this.cache;e[0]!==t&&(i.uniform1f(this.addr,t),e[0]=t)}function wxe(i,t){const e=this.cache;if(void 0!==t.x)(e[0]!==t.x||e[1]!==t.y)&&(i.uniform2f(this.addr,t.x,t.y),e[0]=t.x,e[1]=t.y);else{if(Ou(e,t))return;i.uniform2fv(this.addr,t),lu(e,t)}}function Sxe(i,t){const e=this.cache;if(void 0!==t.x)(e[0]!==t.x||e[1]!==t.y||e[2]!==t.z)&&(i.uniform3f(this.addr,t.x,t.y,t.z),e[0]=t.x,e[1]=t.y,e[2]=t.z);else if(void 0!==t.r)(e[0]!==t.r||e[1]!==t.g||e[2]!==t.b)&&(i.uniform3f(this.addr,t.r,t.g,t.b),e[0]=t.r,e[1]=t.g,e[2]=t.b);else{if(Ou(e,t))return;i.uniform3fv(this.addr,t),lu(e,t)}}function Cxe(i,t){const e=this.cache;if(void 0!==t.x)(e[0]!==t.x||e[1]!==t.y||e[2]!==t.z||e[3]!==t.w)&&(i.uniform4f(this.addr,t.x,t.y,t.z,t.w),e[0]=t.x,e[1]=t.y,e[2]=t.z,e[3]=t.w);else{if(Ou(e,t))return;i.uniform4fv(this.addr,t),lu(e,t)}}function Mxe(i,t){const e=this.cache,n=t.elements;if(void 0===n){if(Ou(e,t))return;i.uniformMatrix2fv(this.addr,!1,t),lu(e,t)}else{if(Ou(e,n))return;zZ.set(n),i.uniformMatrix2fv(this.addr,!1,zZ),lu(e,n)}}function Txe(i,t){const e=this.cache,n=t.elements;if(void 0===n){if(Ou(e,t))return;i.uniformMatrix3fv(this.addr,!1,t),lu(e,t)}else{if(Ou(e,n))return;VZ.set(n),i.uniformMatrix3fv(this.addr,!1,VZ),lu(e,n)}}function Exe(i,t){const e=this.cache,n=t.elements;if(void 0===n){if(Ou(e,t))return;i.uniformMatrix4fv(this.addr,!1,t),lu(e,t)}else{if(Ou(e,n))return;HZ.set(n),i.uniformMatrix4fv(this.addr,!1,HZ),lu(e,n)}}function Axe(i,t){const e=this.cache;e[0]!==t&&(i.uniform1i(this.addr,t),e[0]=t)}function Dxe(i,t){const e=this.cache;Ou(e,t)||(i.uniform2iv(this.addr,t),lu(e,t))}function Rxe(i,t){const e=this.cache;Ou(e,t)||(i.uniform3iv(this.addr,t),lu(e,t))}function kxe(i,t){const e=this.cache;Ou(e,t)||(i.uniform4iv(this.addr,t),lu(e,t))}function Pxe(i,t){const e=this.cache;e[0]!==t&&(i.uniform1ui(this.addr,t),e[0]=t)}function Ixe(i,t){const e=this.cache;Ou(e,t)||(i.uniform2uiv(this.addr,t),lu(e,t))}function Lxe(i,t){const e=this.cache;Ou(e,t)||(i.uniform3uiv(this.addr,t),lu(e,t))}function Oxe(i,t){const e=this.cache;Ou(e,t)||(i.uniform4uiv(this.addr,t),lu(e,t))}function Fxe(i,t,e){const n=this.cache,r=e.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),e.safeSetTexture2D(t||IZ,r)}function Bxe(i,t,e){const n=this.cache,r=e.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),e.setTexture3D(t||OZ,r)}function Nxe(i,t,e){const n=this.cache,r=e.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),e.safeSetTextureCube(t||FZ,r)}function Hxe(i,t,e){const n=this.cache,r=e.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),e.setTexture2DArray(t||LZ,r)}function zxe(i,t){i.uniform1fv(this.addr,t)}function Uxe(i,t){const e=GS(t,this.size,2);i.uniform2fv(this.addr,e)}function Gxe(i,t){const e=GS(t,this.size,3);i.uniform3fv(this.addr,e)}function Wxe(i,t){const e=GS(t,this.size,4);i.uniform4fv(this.addr,e)}function jxe(i,t){const e=GS(t,this.size,4);i.uniformMatrix2fv(this.addr,!1,e)}function qxe(i,t){const e=GS(t,this.size,9);i.uniformMatrix3fv(this.addr,!1,e)}function Xxe(i,t){const e=GS(t,this.size,16);i.uniformMatrix4fv(this.addr,!1,e)}function Zxe(i,t){i.uniform1iv(this.addr,t)}function Yxe(i,t){i.uniform2iv(this.addr,t)}function Kxe(i,t){i.uniform3iv(this.addr,t)}function Qxe(i,t){i.uniform4iv(this.addr,t)}function Jxe(i,t){i.uniform1uiv(this.addr,t)}function $xe(i,t){i.uniform2uiv(this.addr,t)}function ewe(i,t){i.uniform3uiv(this.addr,t)}function twe(i,t){i.uniform4uiv(this.addr,t)}function iwe(i,t,e){const n=t.length,r=E2(e,n);i.uniform1iv(this.addr,r);for(let s=0;s!==n;++s)e.safeSetTexture2D(t[s]||IZ,r[s])}function nwe(i,t,e){const n=t.length,r=E2(e,n);i.uniform1iv(this.addr,r);for(let s=0;s!==n;++s)e.setTexture3D(t[s]||OZ,r[s])}function rwe(i,t,e){const n=t.length,r=E2(e,n);i.uniform1iv(this.addr,r);for(let s=0;s!==n;++s)e.safeSetTextureCube(t[s]||FZ,r[s])}function swe(i,t,e){const n=t.length,r=E2(e,n);i.uniform1iv(this.addr,r);for(let s=0;s!==n;++s)e.setTexture2DArray(t[s]||LZ,r[s])}function awe(i,t,e){this.id=i,this.addr=e,this.cache=[],this.setValue=function Vxe(i){switch(i){case 5126:return xxe;case 35664:return wxe;case 35665:return Sxe;case 35666:return Cxe;case 35674:return Mxe;case 35675:return Txe;case 35676:return Exe;case 5124:case 35670:return Axe;case 35667:case 35671:return Dxe;case 35668:case 35672:return Rxe;case 35669:case 35673:return kxe;case 5125:return Pxe;case 36294:return Ixe;case 36295:return Lxe;case 36296:return Oxe;case 35678:case 36198:case 36298:case 36306:case 35682:return Fxe;case 35679:case 36299:case 36307:return Bxe;case 35680:case 36300:case 36308:case 36293:return Nxe;case 36289:case 36303:case 36311:case 36292:return Hxe}}(t.type)}function UZ(i,t,e){this.id=i,this.addr=e,this.cache=[],this.size=t.size,this.setValue=function owe(i){switch(i){case 5126:return zxe;case 35664:return Uxe;case 35665:return Gxe;case 35666:return Wxe;case 35674:return jxe;case 35675:return qxe;case 35676:return Xxe;case 5124:case 35670:return Zxe;case 35667:case 35671:return Yxe;case 35668:case 35672:return Kxe;case 35669:case 35673:return Qxe;case 5125:return Jxe;case 36294:return $xe;case 36295:return ewe;case 36296:return twe;case 35678:case 36198:case 36298:case 36306:case 35682:return iwe;case 35679:case 36299:case 36307:return nwe;case 35680:case 36300:case 36308:case 36293:return rwe;case 36289:case 36303:case 36311:case 36292:return swe}}(t.type)}function GZ(i){this.id=i,this.seq=[],this.map={}}UZ.prototype.updateCache=function(i){const t=this.cache;i instanceof Float32Array&&t.length!==i.length&&(this.cache=new Float32Array(i.length)),lu(t,i)},GZ.prototype.setValue=function(i,t,e){const n=this.seq;for(let r=0,s=n.length;r!==s;++r){const a=n[r];a.setValue(i,t[a.id],e)}};const w5=/(\w+)(\])?(\[|\.)?/g;function WZ(i,t){i.seq.push(t),i.map[t.id]=t}function lwe(i,t,e){const n=i.name,r=n.length;for(w5.lastIndex=0;;){const s=w5.exec(n),a=w5.lastIndex;let l=s[1];const h=s[3];if("]"===s[2]&&(l|=0),void 0===h||"["===h&&a+2===r){WZ(e,void 0===h?new awe(l,i,t):new UZ(l,i,t));break}{let _=e.map[l];void 0===_&&(_=new GZ(l),WZ(e,_)),e=_}}}function zy(i,t){this.seq=[],this.map={};const e=i.getProgramParameter(t,35718);for(let n=0;n<e;++n){const r=i.getActiveUniform(t,n);lwe(r,i.getUniformLocation(t,r.name),this)}}function jZ(i,t,e){const n=i.createShader(t);return i.shaderSource(n,e),i.compileShader(n),n}zy.prototype.setValue=function(i,t,e,n){const r=this.map[t];void 0!==r&&r.setValue(i,e,n)},zy.prototype.setOptional=function(i,t,e){const n=t[e];void 0!==n&&this.setValue(i,e,n)},zy.upload=function(i,t,e,n){for(let r=0,s=t.length;r!==s;++r){const a=t[r],l=e[a.id];!1!==l.needsUpdate&&a.setValue(i,l.value,n)}},zy.seqWithValue=function(i,t){const e=[];for(let n=0,r=i.length;n!==r;++n){const s=i[n];s.id in t&&e.push(s)}return e};let cwe=0;function qZ(i,t,e){const n=i.getShaderParameter(t,35713),r=i.getShaderInfoLog(t).trim();return n&&""===r?"":e.toUpperCase()+"\n\n"+r+"\n\n"+function uwe(i){const t=i.split("\n");for(let e=0;e<t.length;e++)t[e]=e+1+": "+t[e];return t.join("\n")}(i.getShaderSource(t))}function dwe(i,t){const e=function hwe(i){switch(i){case _g:return["Linear","( value )"];case ba:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",i),["Linear","( value )"]}}(t);return"vec4 "+i+"( vec4 value ) { return LinearTo"+e[0]+e[1]+"; }"}function fwe(i,t){let e;switch(t){case MX:e="Linear";break;case TX:e="Reinhard";break;case EX:e="OptimizedCineon";break;case AX:e="ACESFilmic";break;case DX:e="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),e="Linear"}return"vec3 "+i+"( vec3 color ) { return "+e+"ToneMapping( color ); }"}function KT(i){return""!==i}function XZ(i,t){return i.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function ZZ(i,t){return i.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const _we=/^[ \t]*#include +<([\w\d./]+)>/gm;function S5(i){return i.replace(_we,ywe)}function ywe(i,t){const e=Vs[t];if(void 0===e)throw new Error("Can not resolve #include <"+t+">");return S5(e)}const vwe=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,bwe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function YZ(i){return i.replace(bwe,KZ).replace(vwe,xwe)}function xwe(i,t,e,n){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),KZ(0,t,e,n)}function KZ(i,t,e,n){let r="";for(let s=parseInt(t);s<parseInt(e);s++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function QZ(i){let t="precision "+i.precision+" float;\nprecision "+i.precision+" int;";return"highp"===i.precision?t+="\n#define HIGH_PRECISION":"mediump"===i.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===i.precision&&(t+="\n#define LOW_PRECISION"),t}function Twe(i,t,e,n){const r=i.getContext(),s=e.defines;let a=e.vertexShader,l=e.fragmentShader;const u=function wwe(i){let t="SHADOWMAP_TYPE_BASIC";return i.shadowMapType===pV?t="SHADOWMAP_TYPE_PCF":i.shadowMapType===nX?t="SHADOWMAP_TYPE_PCF_SOFT":i.shadowMapType===gS&&(t="SHADOWMAP_TYPE_VSM"),t}(e),h=function Swe(i){let t="ENVMAP_TYPE_CUBE";if(i.envMap)switch(i.envMapMode){case h0:case d0:t="ENVMAP_TYPE_CUBE";break;case yS:case IT:t="ENVMAP_TYPE_CUBE_UV"}return t}(e),m=function Cwe(i){let t="ENVMAP_MODE_REFLECTION";if(i.envMap)switch(i.envMapMode){case d0:case IT:t="ENVMAP_MODE_REFRACTION"}return t}(e),_=function Mwe(i){let t="ENVMAP_BLENDING_NONE";if(i.envMap)switch(i.combine){case RT:t="ENVMAP_BLENDING_MULTIPLY";break;case SX:t="ENVMAP_BLENDING_MIX";break;case CX:t="ENVMAP_BLENDING_ADD"}return t}(e),v=e.isWebGL2?"":function pwe(i){return[i.extensionDerivatives||i.envMapCubeUV||i.bumpMap||i.tangentSpaceNormalMap||i.clearcoatNormalMap||i.flatShading||"physical"===i.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(i.extensionFragDepth||i.logarithmicDepthBuffer)&&i.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",i.extensionDrawBuffers&&i.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(i.extensionShaderTextureLOD||i.envMap||i.transmission)&&i.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(KT).join("\n")}(e),S=function mwe(i){const t=[];for(const e in i){const n=i[e];!1!==n&&t.push("#define "+e+" "+n)}return t.join("\n")}(s),T=r.createProgram();let I,j,P=e.glslVersion?"#version "+e.glslVersion+"\n":"";e.isRawShaderMaterial?(I=[S].filter(KT).join("\n"),I.length>0&&(I+="\n"),j=[v,S].filter(KT).join("\n"),j.length>0&&(j+="\n")):(I=[QZ(e),"#define SHADER_NAME "+e.shaderName,S,e.instancing?"#define USE_INSTANCING":"",e.instancingColor?"#define USE_INSTANCING_COLOR":"",e.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define MAX_BONES "+e.maxBones,e.useFog&&e.fog?"#define USE_FOG":"",e.useFog&&e.fogExp2?"#define FOG_EXP2":"",e.map?"#define USE_MAP":"",e.envMap?"#define USE_ENVMAP":"",e.envMap?"#define "+m:"",e.lightMap?"#define USE_LIGHTMAP":"",e.aoMap?"#define USE_AOMAP":"",e.emissiveMap?"#define USE_EMISSIVEMAP":"",e.bumpMap?"#define USE_BUMPMAP":"",e.normalMap?"#define USE_NORMALMAP":"",e.normalMap&&e.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",e.normalMap&&e.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",e.clearcoatMap?"#define USE_CLEARCOATMAP":"",e.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",e.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",e.displacementMap&&e.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",e.specularMap?"#define USE_SPECULARMAP":"",e.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",e.specularColorMap?"#define USE_SPECULARCOLORMAP":"",e.roughnessMap?"#define USE_ROUGHNESSMAP":"",e.metalnessMap?"#define USE_METALNESSMAP":"",e.alphaMap?"#define USE_ALPHAMAP":"",e.transmission?"#define USE_TRANSMISSION":"",e.transmissionMap?"#define USE_TRANSMISSIONMAP":"",e.thicknessMap?"#define USE_THICKNESSMAP":"",e.sheenColorMap?"#define USE_SHEENCOLORMAP":"",e.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",e.vertexTangents?"#define USE_TANGENT":"",e.vertexColors?"#define USE_COLOR":"",e.vertexAlphas?"#define USE_COLOR_ALPHA":"",e.vertexUvs?"#define USE_UV":"",e.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",e.flatShading?"#define FLAT_SHADED":"",e.skinning?"#define USE_SKINNING":"",e.useVertexTexture?"#define BONE_TEXTURE":"",e.morphTargets?"#define USE_MORPHTARGETS":"",e.morphNormals&&!1===e.flatShading?"#define USE_MORPHNORMALS":"",e.morphTargets&&e.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",e.morphTargets&&e.isWebGL2?"#define MORPHTARGETS_COUNT "+e.morphTargetsCount:"",e.doubleSided?"#define DOUBLE_SIDED":"",e.flipSided?"#define FLIP_SIDED":"",e.shadowMapEnabled?"#define USE_SHADOWMAP":"",e.shadowMapEnabled?"#define "+u:"",e.sizeAttenuation?"#define USE_SIZEATTENUATION":"",e.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",e.logarithmicDepthBuffer&&e.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(KT).join("\n"),j=[v,QZ(e),"#define SHADER_NAME "+e.shaderName,S,e.useFog&&e.fog?"#define USE_FOG":"",e.useFog&&e.fogExp2?"#define FOG_EXP2":"",e.map?"#define USE_MAP":"",e.matcap?"#define USE_MATCAP":"",e.envMap?"#define USE_ENVMAP":"",e.envMap?"#define "+h:"",e.envMap?"#define "+m:"",e.envMap?"#define "+_:"",e.lightMap?"#define USE_LIGHTMAP":"",e.aoMap?"#define USE_AOMAP":"",e.emissiveMap?"#define USE_EMISSIVEMAP":"",e.bumpMap?"#define USE_BUMPMAP":"",e.normalMap?"#define USE_NORMALMAP":"",e.normalMap&&e.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",e.normalMap&&e.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",e.clearcoat?"#define USE_CLEARCOAT":"",e.clearcoatMap?"#define USE_CLEARCOATMAP":"",e.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",e.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",e.specularMap?"#define USE_SPECULARMAP":"",e.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",e.specularColorMap?"#define USE_SPECULARCOLORMAP":"",e.roughnessMap?"#define USE_ROUGHNESSMAP":"",e.metalnessMap?"#define USE_METALNESSMAP":"",e.alphaMap?"#define USE_ALPHAMAP":"",e.alphaTest?"#define USE_ALPHATEST":"",e.sheen?"#define USE_SHEEN":"",e.sheenColorMap?"#define USE_SHEENCOLORMAP":"",e.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",e.transmission?"#define USE_TRANSMISSION":"",e.transmissionMap?"#define USE_TRANSMISSIONMAP":"",e.thicknessMap?"#define USE_THICKNESSMAP":"",e.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",e.vertexTangents?"#define USE_TANGENT":"",e.vertexColors||e.instancingColor?"#define USE_COLOR":"",e.vertexAlphas?"#define USE_COLOR_ALPHA":"",e.vertexUvs?"#define USE_UV":"",e.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",e.gradientMap?"#define USE_GRADIENTMAP":"",e.flatShading?"#define FLAT_SHADED":"",e.doubleSided?"#define DOUBLE_SIDED":"",e.flipSided?"#define FLIP_SIDED":"",e.shadowMapEnabled?"#define USE_SHADOWMAP":"",e.shadowMapEnabled?"#define "+u:"",e.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",e.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",e.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",e.logarithmicDepthBuffer&&e.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(e.extensionShaderTextureLOD||e.envMap)&&e.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",e.toneMapping!==pg?"#define TONE_MAPPING":"",e.toneMapping!==pg?Vs.tonemapping_pars_fragment:"",e.toneMapping!==pg?fwe("toneMapping",e.toneMapping):"",e.dithering?"#define DITHERING":"",e.alphaWrite?"":"#define OPAQUE",Vs.encodings_pars_fragment,dwe("linearToOutputTexel",e.outputEncoding),e.depthPacking?"#define DEPTH_PACKING "+e.depthPacking:"","\n"].filter(KT).join("\n")),a=S5(a),a=XZ(a,e),a=ZZ(a,e),l=S5(l),l=XZ(l,e),l=ZZ(l,e),a=YZ(a),l=YZ(l),e.isWebGL2&&!0!==e.isRawShaderMaterial&&(P="#version 300 es\n",I=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+I,j=["#define varying in",e.glslVersion===qV?"":"layout(location = 0) out highp vec4 pc_fragColor;",e.glslVersion===qV?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+j);const ie=P+j+l,ee=jZ(r,35633,P+I+a),ce=jZ(r,35632,ie);if(r.attachShader(T,ee),r.attachShader(T,ce),void 0!==e.index0AttributeName?r.bindAttribLocation(T,0,e.index0AttributeName):!0===e.morphTargets&&r.bindAttribLocation(T,0,"position"),r.linkProgram(T),i.debug.checkShaderErrors){const Ge=r.getProgramInfoLog(T).trim(),Qe=r.getShaderInfoLog(ee).trim(),nt=r.getShaderInfoLog(ce).trim();let ge=!0,Je=!0;if(!1===r.getProgramParameter(T,35714)){ge=!1;const mt=qZ(r,ee,"vertex"),pt=qZ(r,ce,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(T,35715)+"\n\nProgram Info Log: "+Ge+"\n"+mt+"\n"+pt)}else""!==Ge?console.warn("THREE.WebGLProgram: Program Info Log:",Ge):(""===Qe||""===nt)&&(Je=!1);Je&&(this.diagnostics={runnable:ge,programLog:Ge,vertexShader:{log:Qe,prefix:I},fragmentShader:{log:nt,prefix:j}})}let ye,Ce;return r.deleteShader(ee),r.deleteShader(ce),this.getUniforms=function(){return void 0===ye&&(ye=new zy(r,T)),ye},this.getAttributes=function(){return void 0===Ce&&(Ce=function gwe(i,t){const e={},n=i.getProgramParameter(t,35721);for(let r=0;r<n;r++){const s=i.getActiveAttrib(t,r),a=s.name;let l=1;35674===s.type&&(l=2),35675===s.type&&(l=3),35676===s.type&&(l=4),e[a]={type:s.type,location:i.getAttribLocation(t,a),locationSize:l}}return e}(r,T)),Ce},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(T),this.program=void 0},this.name=e.shaderName,this.id=cwe++,this.cacheKey=t,this.usedTimes=1,this.program=T,this.vertexShader=ee,this.fragmentShader=ce,this}let Ewe=0;class Awe{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(t){const n=t.fragmentShader,r=this._getShaderStage(t.vertexShader),s=this._getShaderStage(n),a=this._getShaderCacheForMaterial(t);return!1===a.has(r)&&(a.add(r),r.usedTimes++),!1===a.has(s)&&(a.add(s),s.usedTimes++),this}remove(t){const e=this.materialCache.get(t);for(const n of e)n.usedTimes--,0===n.usedTimes&&this.shaderCache.delete(n);return this.materialCache.delete(t),this}getVertexShaderID(t){return this._getShaderStage(t.vertexShader).id}getFragmentShaderID(t){return this._getShaderStage(t.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(t){const e=this.materialCache;return!1===e.has(t)&&e.set(t,new Set),e.get(t)}_getShaderStage(t){const e=this.shaderCache;if(!1===e.has(t)){const n=new Dwe;e.set(t,n)}return e.get(t)}}class Dwe{constructor(){this.id=Ewe++,this.usedTimes=0}}function Rwe(i,t,e,n,r,s,a){const l=new l2,u=new Awe,h=[],m=r.isWebGL2,_=r.logarithmicDepthBuffer,v=r.floatVertexTextures,S=r.maxVertexUniforms,T=r.vertexTextures;let I=r.precision;const j={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function E(ge,Je,mt,pt,Pt){const et=pt.fog,kt=(ge.isMeshStandardMaterial?e:t).get(ge.envMap||(ge.isMeshStandardMaterial?pt.environment:null)),pi=j[ge.type],Ht=Pt.isSkinnedMesh?function P(ge){const mt=ge.skeleton.bones;if(v)return 1024;{const Pt=Math.floor((S-20)/4),et=Math.min(Pt,mt.length);return et<mt.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+mt.length+" bones. This GPU supports "+et+"."),0):et}}(Pt):0;let ct,mi,Zi,zi;if(null!==ge.precision&&(I=r.getMaxPrecision(ge.precision),I!==ge.precision&&console.warn("THREE.WebGLProgram.getParameters:",ge.precision,"not supported, using",I,"instead.")),pi){const Cn=Zf[pi];ct=Cn.vertexShader,mi=Cn.fragmentShader}else ct=ge.vertexShader,mi=ge.fragmentShader,u.update(ge),Zi=u.getVertexShaderID(ge),zi=u.getFragmentShaderID(ge);const Zt=i.getRenderTarget(),nn=ge.clearcoat>0;return{isWebGL2:m,shaderID:pi,shaderName:ge.type,vertexShader:ct,fragmentShader:mi,defines:ge.defines,customVertexShaderID:Zi,customFragmentShaderID:zi,isRawShaderMaterial:!0===ge.isRawShaderMaterial,glslVersion:ge.glslVersion,precision:I,instancing:!0===Pt.isInstancedMesh,instancingColor:!0===Pt.isInstancedMesh&&null!==Pt.instanceColor,supportsVertexTextures:T,outputEncoding:null===Zt?i.outputEncoding:!0===Zt.isXRRenderTarget?Zt.texture.encoding:_g,map:!!ge.map,matcap:!!ge.matcap,envMap:!!kt,envMapMode:kt&&kt.mapping,envMapCubeUV:!!kt&&(kt.mapping===yS||kt.mapping===IT),lightMap:!!ge.lightMap,aoMap:!!ge.aoMap,emissiveMap:!!ge.emissiveMap,bumpMap:!!ge.bumpMap,normalMap:!!ge.normalMap,objectSpaceNormalMap:ge.normalMapType===KX,tangentSpaceNormalMap:ge.normalMapType===v0,decodeVideoTexture:!!ge.map&&!0===ge.map.isVideoTexture&&ge.map.encoding===ba,clearcoat:nn,clearcoatMap:nn&&!!ge.clearcoatMap,clearcoatRoughnessMap:nn&&!!ge.clearcoatRoughnessMap,clearcoatNormalMap:nn&&!!ge.clearcoatNormalMap,displacementMap:!!ge.displacementMap,roughnessMap:!!ge.roughnessMap,metalnessMap:!!ge.metalnessMap,specularMap:!!ge.specularMap,specularIntensityMap:!!ge.specularIntensityMap,specularColorMap:!!ge.specularColorMap,alphaMap:!!ge.alphaMap,alphaTest:ge.alphaTest>0,alphaWrite:ge.alphaWrite||ge.transparent,gradientMap:!!ge.gradientMap,sheen:ge.sheen>0,sheenColorMap:!!ge.sheenColorMap,sheenRoughnessMap:!!ge.sheenRoughnessMap,transmission:ge.transmission>0,transmissionMap:!!ge.transmissionMap,thicknessMap:!!ge.thicknessMap,combine:ge.combine,vertexTangents:!!ge.normalMap&&!!Pt.geometry&&!!Pt.geometry.attributes.tangent,vertexColors:ge.vertexColors,vertexAlphas:!0===ge.vertexColors&&!!Pt.geometry&&!!Pt.geometry.attributes.color&&4===Pt.geometry.attributes.color.itemSize,vertexUvs:!!(ge.map||ge.bumpMap||ge.normalMap||ge.specularMap||ge.alphaMap||ge.emissiveMap||ge.roughnessMap||ge.metalnessMap||ge.clearcoatMap||ge.clearcoatRoughnessMap||ge.clearcoatNormalMap||ge.displacementMap||ge.transmissionMap||ge.thicknessMap||ge.specularIntensityMap||ge.specularColorMap||ge.sheenColorMap||ge.sheenRoughnessMap),uvsVertexOnly:!(ge.map||ge.bumpMap||ge.normalMap||ge.specularMap||ge.alphaMap||ge.emissiveMap||ge.roughnessMap||ge.metalnessMap||ge.clearcoatNormalMap||ge.transmission>0||ge.transmissionMap||ge.thicknessMap||ge.specularIntensityMap||ge.specularColorMap||ge.sheen>0||ge.sheenColorMap||ge.sheenRoughnessMap||!ge.displacementMap),fog:!!et,useFog:ge.fog,fogExp2:et&&et.isFogExp2,flatShading:!!ge.flatShading,sizeAttenuation:ge.sizeAttenuation,logarithmicDepthBuffer:_,skinning:!0===Pt.isSkinnedMesh&&Ht>0,maxBones:Ht,useVertexTexture:v,morphTargets:!!Pt.geometry&&!!Pt.geometry.morphAttributes.position,morphNormals:!!Pt.geometry&&!!Pt.geometry.morphAttributes.normal,morphTargetsCount:Pt.geometry&&Pt.geometry.morphAttributes.position?Pt.geometry.morphAttributes.position.length:0,numDirLights:Je.directional.length,numPointLights:Je.point.length,numSpotLights:Je.spot.length,numRectAreaLights:Je.rectArea.length,numHemiLights:Je.hemi.length,numDirLightShadows:Je.directionalShadowMap.length,numPointLightShadows:Je.pointShadowMap.length,numSpotLightShadows:Je.spotShadowMap.length,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:ge.dithering,shadowMapEnabled:i.shadowMap.enabled&&mt.length>0,shadowMapType:i.shadowMap.type,toneMapping:ge.toneMapped?i.toneMapping:pg,physicallyCorrectLights:i.physicallyCorrectLights,premultipliedAlpha:ge.premultipliedAlpha,doubleSided:ge.side===c0,flipSided:ge.side===Al,depthPacking:void 0!==ge.depthPacking&&ge.depthPacking,index0AttributeName:ge.index0AttributeName,extensionDerivatives:ge.extensions&&ge.extensions.derivatives,extensionFragDepth:ge.extensions&&ge.extensions.fragDepth,extensionDrawBuffers:ge.extensions&&ge.extensions.drawBuffers,extensionShaderTextureLOD:ge.extensions&&ge.extensions.shaderTextureLOD,rendererExtensionFragDepth:m||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:m||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:m||n.has("EXT_shader_texture_lod"),customProgramCacheKey:ge.customProgramCacheKey()}},getProgramCacheKey:function ie(ge){const Je=[];if(ge.shaderID?Je.push(ge.shaderID):(Je.push(ge.customVertexShaderID),Je.push(ge.customFragmentShaderID)),void 0!==ge.defines)for(const mt in ge.defines)Je.push(mt),Je.push(ge.defines[mt]);return!1===ge.isRawShaderMaterial&&(function ee(ge,Je){ge.push(Je.precision),ge.push(Je.outputEncoding),ge.push(Je.envMapMode),ge.push(Je.combine),ge.push(Je.vertexUvs),ge.push(Je.fogExp2),ge.push(Je.sizeAttenuation),ge.push(Je.maxBones),ge.push(Je.morphTargetsCount),ge.push(Je.numDirLights),ge.push(Je.numPointLights),ge.push(Je.numSpotLights),ge.push(Je.numHemiLights),ge.push(Je.numRectAreaLights),ge.push(Je.numDirLightShadows),ge.push(Je.numPointLightShadows),ge.push(Je.numSpotLightShadows),ge.push(Je.shadowMapType),ge.push(Je.toneMapping),ge.push(Je.numClippingPlanes),ge.push(Je.numClipIntersection),ge.push(Je.alphaWrite)}(Je,ge),function ce(ge,Je){l.disableAll(),Je.isWebGL2&&l.enable(0),Je.supportsVertexTextures&&l.enable(1),Je.instancing&&l.enable(2),Je.instancingColor&&l.enable(3),Je.map&&l.enable(4),Je.matcap&&l.enable(5),Je.envMap&&l.enable(6),Je.envMapCubeUV&&l.enable(7),Je.lightMap&&l.enable(8),Je.aoMap&&l.enable(9),Je.emissiveMap&&l.enable(10),Je.bumpMap&&l.enable(11),Je.normalMap&&l.enable(12),Je.objectSpaceNormalMap&&l.enable(13),Je.tangentSpaceNormalMap&&l.enable(14),Je.clearcoat&&l.enable(15),Je.clearcoatMap&&l.enable(16),Je.clearcoatRoughnessMap&&l.enable(17),Je.clearcoatNormalMap&&l.enable(18),Je.displacementMap&&l.enable(19),Je.specularMap&&l.enable(20),Je.roughnessMap&&l.enable(21),Je.metalnessMap&&l.enable(22),Je.gradientMap&&l.enable(23),Je.alphaMap&&l.enable(24),Je.alphaTest&&l.enable(25),Je.vertexColors&&l.enable(26),Je.vertexAlphas&&l.enable(27),Je.vertexUvs&&l.enable(28),Je.vertexTangents&&l.enable(29),Je.uvsVertexOnly&&l.enable(30),Je.fog&&l.enable(31),ge.push(l.mask),l.disableAll(),Je.useFog&&l.enable(0),Je.flatShading&&l.enable(1),Je.logarithmicDepthBuffer&&l.enable(2),Je.skinning&&l.enable(3),Je.useVertexTexture&&l.enable(4),Je.morphTargets&&l.enable(5),Je.morphNormals&&l.enable(6),Je.premultipliedAlpha&&l.enable(7),Je.shadowMapEnabled&&l.enable(8),Je.physicallyCorrectLights&&l.enable(9),Je.doubleSided&&l.enable(10),Je.flipSided&&l.enable(11),Je.depthPacking&&l.enable(12),Je.dithering&&l.enable(13),Je.specularIntensityMap&&l.enable(14),Je.specularColorMap&&l.enable(15),Je.transmission&&l.enable(16),Je.transmissionMap&&l.enable(17),Je.thicknessMap&&l.enable(18),Je.sheen&&l.enable(19),Je.sheenColorMap&&l.enable(20),Je.sheenRoughnessMap&&l.enable(21),Je.decodeVideoTexture&&l.enable(22),ge.push(l.mask)}(Je,ge),Je.push(i.outputEncoding)),Je.push(ge.customProgramCacheKey),Je.join()},getUniforms:function ye(ge){const Je=j[ge.type];let mt;return mt=Je?wZ.clone(Zf[Je].uniforms):ge.uniforms,mt},acquireProgram:function Ce(ge,Je){let mt;for(let pt=0,Pt=h.length;pt<Pt;pt++){const et=h[pt];if(et.cacheKey===Je){mt=et,++mt.usedTimes;break}}return void 0===mt&&(mt=new Twe(i,Je,ge,s),h.push(mt)),mt},releaseProgram:function Ge(ge){if(0==--ge.usedTimes){const Je=h.indexOf(ge);h[Je]=h[h.length-1],h.pop(),ge.destroy()}},releaseShaderCache:function Qe(ge){u.remove(ge)},programs:h,dispose:function nt(){u.dispose()}}}function kwe(){let i=new WeakMap;return{get:function t(s){let a=i.get(s);return void 0===a&&(a={},i.set(s,a)),a},remove:function e(s){i.delete(s)},update:function n(s,a,l){i.get(s)[a]=l},dispose:function r(){i=new WeakMap}}}function Pwe(i,t){return i.groupOrder!==t.groupOrder?i.groupOrder-t.groupOrder:i.renderOrder!==t.renderOrder?i.renderOrder-t.renderOrder:i.material.id!==t.material.id?i.material.id-t.material.id:i.z!==t.z?i.z-t.z:i.id-t.id}function JZ(i,t){return i.groupOrder!==t.groupOrder?i.groupOrder-t.groupOrder:i.renderOrder!==t.renderOrder?i.renderOrder-t.renderOrder:i.z!==t.z?t.z-i.z:i.id-t.id}function $Z(){const i=[];let t=0;const e=[],n=[],r=[];function a(_,v,S,T,I,j){let P=i[t];return void 0===P?(P={id:_.id,object:_,geometry:v,material:S,groupOrder:T,renderOrder:_.renderOrder,z:I,group:j},i[t]=P):(P.id=_.id,P.object=_,P.geometry=v,P.material=S,P.groupOrder=T,P.renderOrder=_.renderOrder,P.z=I,P.group=j),t++,P}return{opaque:e,transmissive:n,transparent:r,init:function s(){t=0,e.length=0,n.length=0,r.length=0},push:function l(_,v,S,T,I,j){const P=a(_,v,S,T,I,j);S.transmission>0?n.push(P):!0===S.transparent?r.push(P):e.push(P)},unshift:function u(_,v,S,T,I,j){const P=a(_,v,S,T,I,j);S.transmission>0?n.unshift(P):!0===S.transparent?r.unshift(P):e.unshift(P)},finish:function m(){for(let _=t,v=i.length;_<v;_++){const S=i[_];if(null===S.id)break;S.id=null,S.object=null,S.geometry=null,S.material=null,S.group=null}},sort:function h(_,v){e.length>1&&e.sort(_||Pwe),n.length>1&&n.sort(v||JZ),r.length>1&&r.sort(v||JZ)}}}function Iwe(){let i=new WeakMap;return{get:function t(n,r){let s;return!1===i.has(n)?(s=new $Z,i.set(n,[s])):r>=i.get(n).length?(s=new $Z,i.get(n).push(s)):s=i.get(n)[r],s},dispose:function e(){i=new WeakMap}}}function Lwe(){const i={};return{get:function(t){if(void 0!==i[t.id])return i[t.id];let e;switch(t.type){case"DirectionalLight":e={direction:new He,color:new En};break;case"SpotLight":e={position:new He,direction:new He,color:new En,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":e={position:new He,color:new En,distance:0,decay:0};break;case"HemisphereLight":e={direction:new He,skyColor:new En,groundColor:new En};break;case"RectAreaLight":e={color:new En,position:new He,halfWidth:new He,halfHeight:new He}}return i[t.id]=e,e}}}let Fwe=0;function Bwe(i,t){return(t.castShadow?1:0)-(i.castShadow?1:0)}function Nwe(i,t){const e=new Lwe,n=function Owe(){const i={};return{get:function(t){if(void 0!==i[t.id])return i[t.id];let e;switch(t.type){case"DirectionalLight":case"SpotLight":e={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Oi};break;case"PointLight":e={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Oi,shadowCameraNear:1,shadowCameraFar:1e3}}return i[t.id]=e,e}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let m=0;m<9;m++)r.probe.push(new He);const s=new He,a=new nr,l=new nr;return{setup:function u(m,_){let v=0,S=0,T=0;for(let Qe=0;Qe<9;Qe++)r.probe[Qe].set(0,0,0);let I=0,j=0,P=0,E=0,ie=0,ee=0,ce=0,ye=0;m.sort(Bwe);const Ce=!0!==_?Math.PI:1;for(let Qe=0,nt=m.length;Qe<nt;Qe++){const ge=m[Qe],Je=ge.color,mt=ge.intensity,pt=ge.distance,Pt=ge.shadow&&ge.shadow.map?ge.shadow.map.texture:null;if(ge.isAmbientLight)v+=Je.r*mt*Ce,S+=Je.g*mt*Ce,T+=Je.b*mt*Ce;else if(ge.isLightProbe)for(let et=0;et<9;et++)r.probe[et].addScaledVector(ge.sh.coefficients[et],mt);else if(ge.isDirectionalLight){const et=e.get(ge);if(et.color.copy(ge.color).multiplyScalar(ge.intensity*Ce),ge.castShadow){const vt=ge.shadow,kt=n.get(ge);kt.shadowBias=vt.bias,kt.shadowNormalBias=vt.normalBias,kt.shadowRadius=vt.radius,kt.shadowMapSize=vt.mapSize,r.directionalShadow[I]=kt,r.directionalShadowMap[I]=Pt,r.directionalShadowMatrix[I]=ge.shadow.matrix,ee++}r.directional[I]=et,I++}else if(ge.isSpotLight){const et=e.get(ge);if(et.position.setFromMatrixPosition(ge.matrixWorld),et.color.copy(Je).multiplyScalar(mt*Ce),et.distance=pt,et.coneCos=Math.cos(ge.angle),et.penumbraCos=Math.cos(ge.angle*(1-ge.penumbra)),et.decay=ge.decay,ge.castShadow){const vt=ge.shadow,kt=n.get(ge);kt.shadowBias=vt.bias,kt.shadowNormalBias=vt.normalBias,kt.shadowRadius=vt.radius,kt.shadowMapSize=vt.mapSize,r.spotShadow[P]=kt,r.spotShadowMap[P]=Pt,r.spotShadowMatrix[P]=ge.shadow.matrix,ye++}r.spot[P]=et,P++}else if(ge.isRectAreaLight){const et=e.get(ge);et.color.copy(Je).multiplyScalar(mt),et.halfWidth.set(.5*ge.width,0,0),et.halfHeight.set(0,.5*ge.height,0),r.rectArea[E]=et,E++}else if(ge.isPointLight){const et=e.get(ge);if(et.color.copy(ge.color).multiplyScalar(ge.intensity*Ce),et.distance=ge.distance,et.decay=ge.decay,ge.castShadow){const vt=ge.shadow,kt=n.get(ge);kt.shadowBias=vt.bias,kt.shadowNormalBias=vt.normalBias,kt.shadowRadius=vt.radius,kt.shadowMapSize=vt.mapSize,kt.shadowCameraNear=vt.camera.near,kt.shadowCameraFar=vt.camera.far,r.pointShadow[j]=kt,r.pointShadowMap[j]=Pt,r.pointShadowMatrix[j]=ge.shadow.matrix,ce++}r.point[j]=et,j++}else if(ge.isHemisphereLight){const et=e.get(ge);et.skyColor.copy(ge.color).multiplyScalar(mt*Ce),et.groundColor.copy(ge.groundColor).multiplyScalar(mt*Ce),r.hemi[ie]=et,ie++}}E>0&&(t.isWebGL2||!0===i.has("OES_texture_float_linear")?(r.rectAreaLTC1=mn.LTC_FLOAT_1,r.rectAreaLTC2=mn.LTC_FLOAT_2):!0===i.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=mn.LTC_HALF_1,r.rectAreaLTC2=mn.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=v,r.ambient[1]=S,r.ambient[2]=T;const Ge=r.hash;(Ge.directionalLength!==I||Ge.pointLength!==j||Ge.spotLength!==P||Ge.rectAreaLength!==E||Ge.hemiLength!==ie||Ge.numDirectionalShadows!==ee||Ge.numPointShadows!==ce||Ge.numSpotShadows!==ye)&&(r.directional.length=I,r.spot.length=P,r.rectArea.length=E,r.point.length=j,r.hemi.length=ie,r.directionalShadow.length=ee,r.directionalShadowMap.length=ee,r.pointShadow.length=ce,r.pointShadowMap.length=ce,r.spotShadow.length=ye,r.spotShadowMap.length=ye,r.directionalShadowMatrix.length=ee,r.pointShadowMatrix.length=ce,r.spotShadowMatrix.length=ye,Ge.directionalLength=I,Ge.pointLength=j,Ge.spotLength=P,Ge.rectAreaLength=E,Ge.hemiLength=ie,Ge.numDirectionalShadows=ee,Ge.numPointShadows=ce,Ge.numSpotShadows=ye,r.version=Fwe++)},setupView:function h(m,_){let v=0,S=0,T=0,I=0,j=0;const P=_.matrixWorldInverse;for(let E=0,ie=m.length;E<ie;E++){const ee=m[E];if(ee.isDirectionalLight){const ce=r.directional[v];ce.direction.setFromMatrixPosition(ee.matrixWorld),s.setFromMatrixPosition(ee.target.matrixWorld),ce.direction.sub(s),ce.direction.transformDirection(P),v++}else if(ee.isSpotLight){const ce=r.spot[T];ce.position.setFromMatrixPosition(ee.matrixWorld),ce.position.applyMatrix4(P),ce.direction.setFromMatrixPosition(ee.matrixWorld),s.setFromMatrixPosition(ee.target.matrixWorld),ce.direction.sub(s),ce.direction.transformDirection(P),T++}else if(ee.isRectAreaLight){const ce=r.rectArea[I];ce.position.setFromMatrixPosition(ee.matrixWorld),ce.position.applyMatrix4(P),l.identity(),a.copy(ee.matrixWorld),a.premultiply(P),l.extractRotation(a),ce.halfWidth.set(.5*ee.width,0,0),ce.halfHeight.set(0,.5*ee.height,0),ce.halfWidth.applyMatrix4(l),ce.halfHeight.applyMatrix4(l),I++}else if(ee.isPointLight){const ce=r.point[S];ce.position.setFromMatrixPosition(ee.matrixWorld),ce.position.applyMatrix4(P),S++}else if(ee.isHemisphereLight){const ce=r.hemi[j];ce.direction.setFromMatrixPosition(ee.matrixWorld),ce.direction.transformDirection(P),ce.direction.normalize(),j++}}},state:r}}function eY(i,t){const e=new Nwe(i,t),n=[],r=[];return{init:function s(){n.length=0,r.length=0},state:{lightsArray:n,shadowsArray:r,lights:e},setupLights:function u(_){e.setup(n,_)},setupLightsView:function h(_){e.setupView(n,_)},pushLight:function a(_){n.push(_)},pushShadow:function l(_){r.push(_)}}}function Hwe(i,t){let e=new WeakMap;return{get:function n(s,a=0){let l;return!1===e.has(s)?(l=new eY(i,t),e.set(s,[l])):a>=e.get(s).length?(l=new eY(i,t),e.get(s).push(l)):l=e.get(s)[a],l},dispose:function r(){e=new WeakMap}}}class A2 extends kc{constructor(t){super(),this.type="MeshDepthMaterial",this.depthPacking=ZX,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}}A2.prototype.isMeshDepthMaterial=!0;class D2 extends kc{constructor(t){super(),this.type="MeshDistanceMaterial",this.referencePosition=new He,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}copy(t){return super.copy(t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}}function tY(i,t,e){let n=new XT;const r=new Oi,s=new Oi,a=new Bo,l=new A2({depthPacking:YX}),u=new D2,h={},m=e.maxTextureSize,_={0:Al,1:l0,2:c0},v=new Mg({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Oi},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),S=v.clone();S.defines.HORIZONTAL_PASS=1;const T=new Ir;T.setAttribute("position",new lo(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const I=new Qa(T,v),j=this;function P(ee,ce){const ye=t.update(I);v.defines.VSM_SAMPLES!==ee.blurSamples&&(v.defines.VSM_SAMPLES=ee.blurSamples,S.defines.VSM_SAMPLES=ee.blurSamples,v.needsUpdate=!0,S.needsUpdate=!0),v.uniforms.shadow_pass.value=ee.map.texture,v.uniforms.resolution.value=ee.mapSize,v.uniforms.radius.value=ee.radius,i.setRenderTarget(ee.mapPass),i.clear(),i.renderBufferDirect(ce,null,ye,v,I,null),S.uniforms.shadow_pass.value=ee.mapPass.texture,S.uniforms.resolution.value=ee.mapSize,S.uniforms.radius.value=ee.radius,i.setRenderTarget(ee.map),i.clear(),i.renderBufferDirect(ce,null,ye,S,I,null)}function E(ee,ce,ye,Ce,Ge,Qe,nt){let ge=null;const Je=!0===Ce.isPointLight?ee.customDistanceMaterial:ee.customDepthMaterial;if(ge=void 0!==Je?Je:!0===Ce.isPointLight?u:l,i.localClippingEnabled&&!0===ye.clipShadows&&0!==ye.clippingPlanes.length||ye.displacementMap&&0!==ye.displacementScale||ye.alphaMap&&ye.alphaTest>0){const mt=ge.uuid,pt=ye.uuid;let Pt=h[mt];void 0===Pt&&(Pt={},h[mt]=Pt);let et=Pt[pt];void 0===et&&(et=ge.clone(),Pt[pt]=et),ge=et}return ge.visible=ye.visible,ge.wireframe=ye.wireframe,ge.side=nt===gS?null!==ye.shadowSide?ye.shadowSide:ye.side:null!==ye.shadowSide?ye.shadowSide:_[ye.side],ge.alphaMap=ye.alphaMap,ge.alphaTest=ye.alphaTest,ge.clipShadows=ye.clipShadows,ge.clippingPlanes=ye.clippingPlanes,ge.clipIntersection=ye.clipIntersection,ge.displacementMap=ye.displacementMap,ge.displacementScale=ye.displacementScale,ge.displacementBias=ye.displacementBias,ge.wireframeLinewidth=ye.wireframeLinewidth,ge.linewidth=ye.linewidth,!0===Ce.isPointLight&&!0===ge.isMeshDistanceMaterial&&(ge.referencePosition.setFromMatrixPosition(Ce.matrixWorld),ge.nearDistance=Ge,ge.farDistance=Qe),ge}function ie(ee,ce,ye,Ce,Ge){if(!1===ee.visible)return;if(ee.layers.test(ce.layers)&&(ee.isMesh||ee.isLine||ee.isPoints)&&(ee.castShadow||ee.receiveShadow&&Ge===gS)&&(!ee.frustumCulled||n.intersectsObject(ee))){ee.modelViewMatrix.multiplyMatrices(ye.matrixWorldInverse,ee.matrixWorld);const ge=t.update(ee),Je=ee.material;if(Array.isArray(Je)){const mt=ge.groups;for(let pt=0,Pt=mt.length;pt<Pt;pt++){const et=mt[pt],vt=Je[et.materialIndex];if(vt&&vt.visible){const kt=E(ee,0,vt,Ce,ye.near,ye.far,Ge);i.renderBufferDirect(ye,null,ge,kt,ee,et)}}}else if(Je.visible){const mt=E(ee,0,Je,Ce,ye.near,ye.far,Ge);i.renderBufferDirect(ye,null,ge,mt,ee,null)}}const nt=ee.children;for(let ge=0,Je=nt.length;ge<Je;ge++)ie(nt[ge],ce,ye,Ce,Ge)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=pV,this.render=function(ee,ce,ye){if(!1===j.enabled||!1===j.autoUpdate&&!1===j.needsUpdate||0===ee.length)return;const Ce=i.getRenderTarget(),Ge=i.getActiveCubeFace(),Qe=i.getActiveMipmapLevel(),nt=i.state;nt.setBlending(fg),nt.buffers.color.setClear(1,1,1,1),nt.buffers.depth.setTest(!0),nt.setScissorTest(!1);for(let ge=0,Je=ee.length;ge<Je;ge++){const mt=ee[ge],pt=mt.shadow;if(void 0===pt){console.warn("THREE.WebGLShadowMap:",mt,"has no shadow.");continue}if(!1===pt.autoUpdate&&!1===pt.needsUpdate)continue;r.copy(pt.mapSize);const Pt=pt.getFrameExtents();if(r.multiply(Pt),s.copy(pt.mapSize),(r.x>m||r.y>m)&&(r.x>m&&(s.x=Math.floor(m/Pt.x),r.x=s.x*Pt.x,pt.mapSize.x=s.x),r.y>m&&(s.y=Math.floor(m/Pt.y),r.y=s.y*Pt.y,pt.mapSize.y=s.y)),null===pt.map&&!pt.isPointLightShadow&&this.type===gS){const vt={minFilter:Ka,magFilter:Ka,format:Qc};pt.map=new Hh(r.x,r.y,vt),pt.map.texture.name=mt.name+".shadowMap",pt.mapPass=new Hh(r.x,r.y,vt),pt.camera.updateProjectionMatrix()}null===pt.map&&(pt.map=new Hh(r.x,r.y,{minFilter:Dl,magFilter:Dl,format:Qc}),pt.map.texture.name=mt.name+".shadowMap",pt.camera.updateProjectionMatrix()),i.setRenderTarget(pt.map),i.clear();const et=pt.getViewportCount();for(let vt=0;vt<et;vt++){const kt=pt.getViewport(vt);a.set(s.x*kt.x,s.y*kt.y,s.x*kt.z,s.y*kt.w),nt.viewport(a),pt.updateMatrices(mt,vt),n=pt.getFrustum(),ie(ce,ye,pt.camera,mt,this.type)}!pt.isPointLightShadow&&this.type===gS&&P(pt,ye),pt.needsUpdate=!1}j.needsUpdate=!1,i.setRenderTarget(Ce,Ge,Qe)}}function Uwe(i,t,e){const n=e.isWebGL2,l=new function r(){let Mt=!1;const lr=new Bo;let Vn=null;const ns=new Bo(0,0,0,0);return{setMask:function(Ii){Vn!==Ii&&!Mt&&(i.colorMask(Ii,Ii,Ii,Ii),Vn=Ii)},setLocked:function(Ii){Mt=Ii},setClear:function(Ii,Vr,io,$a,$h){!0===$h&&(Ii*=$a,Vr*=$a,io*=$a),lr.set(Ii,Vr,io,$a),!1===ns.equals(lr)&&(i.clearColor(Ii,Vr,io,$a),ns.copy(lr))},reset:function(){Mt=!1,Vn=null,ns.set(-1,0,0,0)}}},u=new function s(){let Mt=!1,lr=null,Vn=null,ns=null;return{setTest:function(Ii){Ii?Zt(2929):tr(2929)},setMask:function(Ii){lr!==Ii&&!Mt&&(i.depthMask(Ii),lr=Ii)},setFunc:function(Ii){if(Vn!==Ii){if(Ii)switch(Ii){case gX:i.depthFunc(512);break;case _X:i.depthFunc(519);break;case yX:i.depthFunc(513);break;case VP:i.depthFunc(515);break;case vX:i.depthFunc(514);break;case bX:i.depthFunc(518);break;case xX:i.depthFunc(516);break;case wX:i.depthFunc(517);break;default:i.depthFunc(515)}else i.depthFunc(515);Vn=Ii}},setLocked:function(Ii){Mt=Ii},setClear:function(Ii){ns!==Ii&&(i.clearDepth(Ii),ns=Ii)},reset:function(){Mt=!1,lr=null,Vn=null,ns=null}}},h=new function a(){let Mt=!1,lr=null,Vn=null,ns=null,Ii=null,Vr=null,io=null,$a=null,$h=null;return{setTest:function(dl){Mt||(dl?Zt(2960):tr(2960))},setMask:function(dl){lr!==dl&&!Mt&&(i.stencilMask(dl),lr=dl)},setFunc:function(dl,qp,Og){(Vn!==dl||ns!==qp||Ii!==Og)&&(i.stencilFunc(dl,qp,Og),Vn=dl,ns=qp,Ii=Og)},setOp:function(dl,qp,Og){(Vr!==dl||io!==qp||$a!==Og)&&(i.stencilOp(dl,qp,Og),Vr=dl,io=qp,$a=Og)},setLocked:function(dl){Mt=dl},setClear:function(dl){$h!==dl&&(i.clearStencil(dl),$h=dl)},reset:function(){Mt=!1,lr=null,Vn=null,ns=null,Ii=null,Vr=null,io=null,$a=null,$h=null}}};let m={},_={},v=new WeakMap,S=[],T=null,I=!1,j=null,P=null,E=null,ie=null,ee=null,ce=null,ye=null,Ce=!1,Ge=null,Qe=null,nt=null,ge=null,Je=null;const mt=i.getParameter(35661);let pt=!1,Pt=0;const et=i.getParameter(7938);-1!==et.indexOf("WebGL")?(Pt=parseFloat(/^WebGL (\d)/.exec(et)[1]),pt=Pt>=1):-1!==et.indexOf("OpenGL ES")&&(Pt=parseFloat(/^OpenGL ES (\d)/.exec(et)[1]),pt=Pt>=2);let vt=null,kt={};const pi=i.getParameter(3088),Ht=i.getParameter(2978),ct=(new Bo).fromArray(pi),mi=(new Bo).fromArray(Ht);function Zi(Mt,lr,Vn){const ns=new Uint8Array(4),Ii=i.createTexture();i.bindTexture(Mt,Ii),i.texParameteri(Mt,10241,9728),i.texParameteri(Mt,10240,9728);for(let Vr=0;Vr<Vn;Vr++)i.texImage2D(lr+Vr,0,6408,1,1,0,6408,5121,ns);return Ii}const zi={};function Zt(Mt){!0!==m[Mt]&&(i.enable(Mt),m[Mt]=!0)}function tr(Mt){!1!==m[Mt]&&(i.disable(Mt),m[Mt]=!1)}zi[3553]=Zi(3553,3553,1),zi[34067]=Zi(34067,34069,6),l.setClear(0,0,0,1),u.setClear(1),h.setClear(0),Zt(2929),u.setFunc(VP),sn(!1),Gn(fV),Zt(2884),Ri(fg);const ts={[u0]:32774,[sX]:32778,[oX]:32779};if(n)ts[vV]=32775,ts[bV]=32776;else{const Mt=t.get("EXT_blend_minmax");null!==Mt&&(ts[vV]=Mt.MIN_EXT,ts[bV]=Mt.MAX_EXT)}const Hr={[aX]:0,[lX]:1,[cX]:768,[xV]:770,[mX]:776,[fX]:774,[hX]:772,[uX]:769,[wV]:771,[pX]:775,[dX]:773};function Ri(Mt,lr,Vn,ns,Ii,Vr,io,$a){if(Mt!==fg){if(!1===I&&(Zt(3042),I=!0),Mt===rX)Ii=Ii||lr,Vr=Vr||Vn,io=io||ns,(lr!==P||Ii!==ee)&&(i.blendEquationSeparate(ts[lr],ts[Ii]),P=lr,ee=Ii),(Vn!==E||ns!==ie||Vr!==ce||io!==ye)&&(i.blendFuncSeparate(Hr[Vn],Hr[ns],Hr[Vr],Hr[io]),E=Vn,ie=ns,ce=Vr,ye=io),j=Mt,Ce=null;else if(Mt!==j||$a!==Ce){if((P!==u0||ee!==u0)&&(i.blendEquation(32774),P=u0,ee=u0),$a)switch(Mt){case _S:i.blendFuncSeparate(1,771,1,771);break;case gV:i.blendFunc(1,1);break;case _V:i.blendFuncSeparate(0,769,0,1);break;case yV:i.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",Mt)}else switch(Mt){case _S:i.blendFuncSeparate(770,771,1,771);break;case gV:i.blendFunc(770,1);break;case _V:i.blendFuncSeparate(0,769,0,1);break;case yV:i.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",Mt)}E=null,ie=null,ce=null,ye=null,j=Mt,Ce=$a}}else!0===I&&(tr(3042),I=!1)}function sn(Mt){Ge!==Mt&&(i.frontFace(Mt?2304:2305),Ge=Mt)}function Gn(Mt){Mt!==tX?(Zt(2884),Mt!==Qe&&i.cullFace(Mt===fV?1029:Mt===iX?1028:1032)):tr(2884),Qe=Mt}function is(Mt,lr,Vn){Mt?(Zt(32823),(ge!==lr||Je!==Vn)&&(i.polygonOffset(lr,Vn),ge=lr,Je=Vn)):tr(32823)}function co(Mt){void 0===Mt&&(Mt=33984+mt-1),vt!==Mt&&(i.activeTexture(Mt),vt=Mt)}return{buffers:{color:l,depth:u,stencil:h},enable:Zt,disable:tr,bindFramebuffer:function nn(Mt,lr){return _[Mt]!==lr&&(i.bindFramebuffer(Mt,lr),_[Mt]=lr,n&&(36009===Mt&&(_[36160]=lr),36160===Mt&&(_[36009]=lr)),!0)},drawBuffers:function Un(Mt,lr){let Vn=S,ns=!1;if(Mt)if(Vn=v.get(lr),void 0===Vn&&(Vn=[],v.set(lr,Vn)),Mt.isWebGLMultipleRenderTargets){const Ii=Mt.texture;if(Vn.length!==Ii.length||36064!==Vn[0]){for(let Vr=0,io=Ii.length;Vr<io;Vr++)Vn[Vr]=36064+Vr;Vn.length=Ii.length,ns=!0}}else 36064!==Vn[0]&&(Vn[0]=36064,ns=!0);else 1029!==Vn[0]&&(Vn[0]=1029,ns=!0);ns&&(e.isWebGL2?i.drawBuffers(Vn):t.get("WEBGL_draw_buffers").drawBuffersWEBGL(Vn))},useProgram:function Cn(Mt){return T!==Mt&&(i.useProgram(Mt),T=Mt,!0)},setBlending:Ri,setMaterial:function fn(Mt,lr){Mt.side===c0?tr(2884):Zt(2884);let Vn=Mt.side===Al;lr&&(Vn=!Vn),sn(Vn),Mt.blending===_S&&!1===Mt.transparent?Ri(fg):Ri(Mt.blending,Mt.blendEquation,Mt.blendSrc,Mt.blendDst,Mt.blendEquationAlpha,Mt.blendSrcAlpha,Mt.blendDstAlpha,Mt.premultipliedAlpha),u.setFunc(Mt.depthFunc),u.setTest(Mt.depthTest),u.setMask(Mt.depthWrite),l.setMask(Mt.colorWrite);const ns=Mt.stencilWrite;h.setTest(ns),ns&&(h.setMask(Mt.stencilWriteMask),h.setFunc(Mt.stencilFunc,Mt.stencilRef,Mt.stencilFuncMask),h.setOp(Mt.stencilFail,Mt.stencilZFail,Mt.stencilZPass)),is(Mt.polygonOffset,Mt.polygonOffsetFactor,Mt.polygonOffsetUnits),!0===Mt.alphaToCoverage?Zt(32926):tr(32926)},setFlipSided:sn,setCullFace:Gn,setLineWidth:function kn(Mt){Mt!==nt&&(pt&&i.lineWidth(Mt),nt=Mt)},setPolygonOffset:is,setScissorTest:function ls(Mt){Mt?Zt(3089):tr(3089)},activeTexture:co,bindTexture:function sa(Mt,lr){null===vt&&co();let Vn=kt[vt];void 0===Vn&&(Vn={type:void 0,texture:void 0},kt[vt]=Vn),(Vn.type!==Mt||Vn.texture!==lr)&&(i.bindTexture(Mt,lr||zi[Mt]),Vn.type=Mt,Vn.texture=lr)},unbindTexture:function Zo(){const Mt=kt[vt];void 0!==Mt&&void 0!==Mt.type&&(i.bindTexture(Mt.type,null),Mt.type=void 0,Mt.texture=void 0)},compressedTexImage2D:function ot(){try{i.compressedTexImage2D.apply(i,arguments)}catch(Mt){console.error("THREE.WebGLState:",Mt)}},texImage2D:function Lr(){try{i.texImage2D.apply(i,arguments)}catch(Mt){console.error("THREE.WebGLState:",Mt)}},texImage3D:function br(){try{i.texImage3D.apply(i,arguments)}catch(Mt){console.error("THREE.WebGLState:",Mt)}},texStorage2D:function pr(){try{i.texStorage2D.apply(i,arguments)}catch(Mt){console.error("THREE.WebGLState:",Mt)}},texStorage3D:function Ci(){try{i.texStorage3D.apply(i,arguments)}catch(Mt){console.error("THREE.WebGLState:",Mt)}},texSubImage2D:function Xe(){try{i.texSubImage2D.apply(i,arguments)}catch(Mt){console.error("THREE.WebGLState:",Mt)}},texSubImage3D:function Ti(){try{i.texSubImage3D.apply(i,arguments)}catch(Mt){console.error("THREE.WebGLState:",Mt)}},compressedTexSubImage2D:function un(){try{i.compressedTexSubImage2D.apply(i,arguments)}catch(Mt){console.error("THREE.WebGLState:",Mt)}},scissor:function Dn(Mt){!1===ct.equals(Mt)&&(i.scissor(Mt.x,Mt.y,Mt.z,Mt.w),ct.copy(Mt))},viewport:function An(Mt){!1===mi.equals(Mt)&&(i.viewport(Mt.x,Mt.y,Mt.z,Mt.w),mi.copy(Mt))},reset:function _s(){i.disable(3042),i.disable(2884),i.disable(2929),i.disable(32823),i.disable(3089),i.disable(2960),i.disable(32926),i.blendEquation(32774),i.blendFunc(1,0),i.blendFuncSeparate(1,0,1,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(513),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(519,0,4294967295),i.stencilOp(7680,7680,7680),i.clearStencil(0),i.cullFace(1029),i.frontFace(2305),i.polygonOffset(0,0),i.activeTexture(33984),i.bindFramebuffer(36160,null),!0===n&&(i.bindFramebuffer(36009,null),i.bindFramebuffer(36008,null)),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),m={},vt=null,kt={},_={},v=new WeakMap,S=[],T=null,I=!1,j=null,P=null,E=null,ie=null,ee=null,ce=null,ye=null,Ce=!1,Ge=null,Qe=null,nt=null,ge=null,Je=null,ct.set(0,0,i.canvas.width,i.canvas.height),mi.set(0,0,i.canvas.width,i.canvas.height),l.reset(),u.reset(),h.reset()}}}function Gwe(i,t,e,n,r,s,a){const l=r.isWebGL2,u=r.maxTextures,h=r.maxCubemapSize,m=r.maxTextureSize,_=r.maxSamples,S=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):void 0,T=new WeakMap;let I,j=!1;try{j="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(ot){}function P(ot,Xe){return j?new OffscreenCanvas(ot,Xe):UT("canvas")}function E(ot,Xe,Ti,un){let pr=1;if((ot.width>un||ot.height>un)&&(pr=un/Math.max(ot.width,ot.height)),pr<1||!0===Xe){if("undefined"!=typeof HTMLImageElement&&ot instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&ot instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&ot instanceof ImageBitmap){const Ci=Xe?$X:Math.floor,Lr=Ci(pr*ot.width),br=Ci(pr*ot.height);void 0===I&&(I=P(Lr,br));const Dn=Ti?P(Lr,br):I;return Dn.width=Lr,Dn.height=br,Dn.getContext("2d").drawImage(ot,0,0,Lr,br),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+ot.width+"x"+ot.height+") to ("+Lr+"x"+br+")."),Dn}return"data"in ot&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+ot.width+"x"+ot.height+")."),ot}return ot}function ie(ot){return ZV(ot.width)&&ZV(ot.height)}function ce(ot,Xe){return ot.generateMipmaps&&Xe&&ot.minFilter!==Dl&&ot.minFilter!==Ka}function ye(ot){i.generateMipmap(ot)}function Ce(ot,Xe,Ti,un,pr=!1){if(!1===l)return Xe;if(null!==ot){if(void 0!==i[ot])return i[ot];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+ot+"'")}let Ci=Xe;return 6403===Xe&&(5126===Ti&&(Ci=33326),5131===Ti&&(Ci=33325),5121===Ti&&(Ci=33321)),33319===Xe&&(5126===Ti&&(Ci=33328),5131===Ti&&(Ci=33327),5121===Ti&&(Ci=33323)),6408===Xe&&(5126===Ti&&(Ci=34836),5131===Ti&&(Ci=34842),5121===Ti&&(Ci=un===ba&&!1===pr?35907:32856),32819===Ti&&(Ci=32854),32820===Ti&&(Ci=32855)),(33325===Ci||33326===Ci||33327===Ci||33328===Ci||34842===Ci||34836===Ci)&&t.get("EXT_color_buffer_float"),Ci}function Ge(ot,Xe,Ti){return!0===ce(ot,Ti)||ot.isFramebufferTexture&&ot.minFilter!==Dl&&ot.minFilter!==Ka?Math.log2(Math.max(Xe.width,Xe.height))+1:void 0!==ot.mipmaps&&ot.mipmaps.length>0?ot.mipmaps.length:ot.isCompressedTexture&&Array.isArray(ot.image)?Xe.mipmaps.length:1}function Qe(ot){return ot===Dl||ot===UP||ot===GP?9728:9729}function nt(ot){const Xe=ot.target;Xe.removeEventListener("dispose",nt),function Je(ot){const Xe=n.get(ot);void 0!==Xe.__webglInit&&(i.deleteTexture(Xe.__webglTexture),n.remove(ot))}(Xe),Xe.isVideoTexture&&T.delete(Xe),a.memory.textures--}function ge(ot){const Xe=ot.target;Xe.removeEventListener("dispose",ge),function mt(ot){const Xe=ot.texture,Ti=n.get(ot),un=n.get(Xe);if(ot){if(void 0!==un.__webglTexture&&(i.deleteTexture(un.__webglTexture),a.memory.textures--),ot.depthTexture&&ot.depthTexture.dispose(),ot.isWebGLCubeRenderTarget)for(let pr=0;pr<6;pr++)i.deleteFramebuffer(Ti.__webglFramebuffer[pr]),Ti.__webglDepthbuffer&&i.deleteRenderbuffer(Ti.__webglDepthbuffer[pr]);else i.deleteFramebuffer(Ti.__webglFramebuffer),Ti.__webglDepthbuffer&&i.deleteRenderbuffer(Ti.__webglDepthbuffer),Ti.__webglMultisampledFramebuffer&&i.deleteFramebuffer(Ti.__webglMultisampledFramebuffer),Ti.__webglColorRenderbuffer&&i.deleteRenderbuffer(Ti.__webglColorRenderbuffer),Ti.__webglDepthRenderbuffer&&i.deleteRenderbuffer(Ti.__webglDepthRenderbuffer);if(ot.isWebGLMultipleRenderTargets)for(let pr=0,Ci=Xe.length;pr<Ci;pr++){const Lr=n.get(Xe[pr]);Lr.__webglTexture&&(i.deleteTexture(Lr.__webglTexture),a.memory.textures--),n.remove(Xe[pr])}n.remove(Xe),n.remove(ot)}}(Xe)}let pt=0;function vt(ot,Xe){const Ti=n.get(ot);if(ot.isVideoTexture&&function kn(ot){const Xe=a.render.frame;T.get(ot)!==Xe&&(T.set(ot,Xe),ot.update())}(ot),ot.version>0&&Ti.__version!==ot.version){const un=ot.image;if(void 0===un)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==un.complete)return void Zt(Ti,ot,Xe);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}e.activeTexture(33984+Xe),e.bindTexture(3553,Ti.__webglTexture)}function Ht(ot,Xe){const Ti=n.get(ot);ot.version>0&&Ti.__version!==ot.version?function tr(ot,Xe,Ti){if(6!==Xe.image.length)return;zi(ot,Xe),e.activeTexture(33984+Ti),e.bindTexture(34067,ot.__webglTexture),i.pixelStorei(37440,Xe.flipY),i.pixelStorei(37441,Xe.premultiplyAlpha),i.pixelStorei(3317,Xe.unpackAlignment),i.pixelStorei(37443,0);const un=Xe&&(Xe.isCompressedTexture||Xe.image[0].isCompressedTexture),pr=Xe.image[0]&&Xe.image[0].isDataTexture,Ci=[];for(let Ii=0;Ii<6;Ii++)Ci[Ii]=un||pr?pr?Xe.image[Ii].image:Xe.image[Ii]:E(Xe.image[Ii],!1,!0,h),Ci[Ii]=is(Xe,Ci[Ii]);const Lr=Ci[0],br=ie(Lr)||l,Dn=s.convert(Xe.format,Xe.encoding),An=s.convert(Xe.type),_s=Ce(Xe.internalFormat,Dn,An,Xe.encoding),Mt=l&&!0!==Xe.isVideoTexture,lr=void 0===ot.__version;let ns,Vn=Ge(Xe,Lr,br);if(Zi(34067,Xe,br),un){Mt&&lr&&e.texStorage2D(34067,Vn,_s,Lr.width,Lr.height);for(let Ii=0;Ii<6;Ii++){ns=Ci[Ii].mipmaps;for(let Vr=0;Vr<ns.length;Vr++){const io=ns[Vr];Xe.format!==Qc?null!==Dn?Mt?e.compressedTexSubImage2D(34069+Ii,Vr,0,0,io.width,io.height,Dn,io.data):e.compressedTexImage2D(34069+Ii,Vr,_s,io.width,io.height,0,io.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Mt?e.texSubImage2D(34069+Ii,Vr,0,0,io.width,io.height,Dn,An,io.data):e.texImage2D(34069+Ii,Vr,_s,io.width,io.height,0,Dn,An,io.data)}}}else{ns=Xe.mipmaps,Mt&&lr&&(ns.length>0&&Vn++,e.texStorage2D(34067,Vn,_s,Ci[0].width,Ci[0].height));for(let Ii=0;Ii<6;Ii++)if(pr){Mt?e.texSubImage2D(34069+Ii,0,0,0,Ci[Ii].width,Ci[Ii].height,Dn,An,Ci[Ii].data):e.texImage2D(34069+Ii,0,_s,Ci[Ii].width,Ci[Ii].height,0,Dn,An,Ci[Ii].data);for(let Vr=0;Vr<ns.length;Vr++){const $a=ns[Vr].image[Ii].image;Mt?e.texSubImage2D(34069+Ii,Vr+1,0,0,$a.width,$a.height,Dn,An,$a.data):e.texImage2D(34069+Ii,Vr+1,_s,$a.width,$a.height,0,Dn,An,$a.data)}}else{Mt?e.texSubImage2D(34069+Ii,0,0,0,Dn,An,Ci[Ii]):e.texImage2D(34069+Ii,0,_s,Dn,An,Ci[Ii]);for(let Vr=0;Vr<ns.length;Vr++){const io=ns[Vr];Mt?e.texSubImage2D(34069+Ii,Vr+1,0,0,Dn,An,io.image[Ii]):e.texImage2D(34069+Ii,Vr+1,_s,Dn,An,io.image[Ii])}}}ce(Xe,br)&&ye(34067),ot.__version=Xe.version,Xe.onUpdate&&Xe.onUpdate(Xe)}(Ti,ot,Xe):(e.activeTexture(33984+Xe),e.bindTexture(34067,Ti.__webglTexture))}const ct={[LT]:10497,[Kc]:33071,[OT]:33648},mi={[Dl]:9728,[UP]:9984,[GP]:9986,[Ka]:9729,[SV]:9985,[f0]:9987};function Zi(ot,Xe,Ti){if(Ti?(i.texParameteri(ot,10242,ct[Xe.wrapS]),i.texParameteri(ot,10243,ct[Xe.wrapT]),(32879===ot||35866===ot)&&i.texParameteri(ot,32882,ct[Xe.wrapR]),i.texParameteri(ot,10240,mi[Xe.magFilter]),i.texParameteri(ot,10241,mi[Xe.minFilter])):(i.texParameteri(ot,10242,33071),i.texParameteri(ot,10243,33071),(32879===ot||35866===ot)&&i.texParameteri(ot,32882,33071),(Xe.wrapS!==Kc||Xe.wrapT!==Kc)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),i.texParameteri(ot,10240,Qe(Xe.magFilter)),i.texParameteri(ot,10241,Qe(Xe.minFilter)),Xe.minFilter!==Dl&&Xe.minFilter!==Ka&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===t.has("EXT_texture_filter_anisotropic")){const un=t.get("EXT_texture_filter_anisotropic");if(Xe.type===gg&&!1===t.has("OES_texture_float_linear")||!1===l&&Xe.type===p0&&!1===t.has("OES_texture_half_float_linear"))return;(Xe.anisotropy>1||n.get(Xe).__currentAnisotropy)&&(i.texParameterf(ot,un.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Xe.anisotropy,r.getMaxAnisotropy())),n.get(Xe).__currentAnisotropy=Xe.anisotropy)}}function zi(ot,Xe){void 0===ot.__webglInit&&(ot.__webglInit=!0,Xe.addEventListener("dispose",nt),ot.__webglTexture=i.createTexture(),a.memory.textures++)}function Zt(ot,Xe,Ti){let un=3553;Xe.isDataTexture2DArray&&(un=35866),Xe.isDataTexture3D&&(un=32879),zi(ot,Xe),e.activeTexture(33984+Ti),e.bindTexture(un,ot.__webglTexture),i.pixelStorei(37440,Xe.flipY),i.pixelStorei(37441,Xe.premultiplyAlpha),i.pixelStorei(3317,Xe.unpackAlignment),i.pixelStorei(37443,0);const pr=function ee(ot){return!l&&(ot.wrapS!==Kc||ot.wrapT!==Kc||ot.minFilter!==Dl&&ot.minFilter!==Ka)}(Xe)&&!1===ie(Xe.image);let Ci=E(Xe.image,pr,!1,m);Ci=is(Xe,Ci);const Lr=ie(Ci)||l,br=s.convert(Xe.format,Xe.encoding);let _s,Dn=s.convert(Xe.type),An=Ce(Xe.internalFormat,br,Dn,Xe.encoding,Xe.isVideoTexture);Zi(un,Xe,Lr);const Mt=Xe.mipmaps,lr=l&&!0!==Xe.isVideoTexture,Vn=void 0===ot.__version,ns=Ge(Xe,Ci,Lr);if(Xe.isDepthTexture)An=6402,l?An=Xe.type===gg?36012:Xe.type===FT?33190:Xe.type===m0?35056:33189:Xe.type===gg&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),Xe.format===Ay&&6402===An&&Xe.type!==vS&&Xe.type!==FT&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),Xe.type=vS,Dn=s.convert(Xe.type)),Xe.format===g0&&6402===An&&(An=34041,Xe.type!==m0&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),Xe.type=m0,Dn=s.convert(Xe.type))),lr&&Vn?e.texStorage2D(3553,1,An,Ci.width,Ci.height):e.texImage2D(3553,0,An,Ci.width,Ci.height,0,br,Dn,null);else if(Xe.isDataTexture)if(Mt.length>0&&Lr){lr&&Vn&&e.texStorage2D(3553,ns,An,Mt[0].width,Mt[0].height);for(let Ii=0,Vr=Mt.length;Ii<Vr;Ii++)_s=Mt[Ii],lr?e.texSubImage2D(3553,0,0,0,_s.width,_s.height,br,Dn,_s.data):e.texImage2D(3553,Ii,An,_s.width,_s.height,0,br,Dn,_s.data);Xe.generateMipmaps=!1}else lr?(Vn&&e.texStorage2D(3553,ns,An,Ci.width,Ci.height),e.texSubImage2D(3553,0,0,0,Ci.width,Ci.height,br,Dn,Ci.data)):e.texImage2D(3553,0,An,Ci.width,Ci.height,0,br,Dn,Ci.data);else if(Xe.isCompressedTexture){lr&&Vn&&e.texStorage2D(3553,ns,An,Mt[0].width,Mt[0].height);for(let Ii=0,Vr=Mt.length;Ii<Vr;Ii++)_s=Mt[Ii],Xe.format!==Qc?null!==br?lr?e.compressedTexSubImage2D(3553,Ii,0,0,_s.width,_s.height,br,_s.data):e.compressedTexImage2D(3553,Ii,An,_s.width,_s.height,0,_s.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):lr?e.texSubImage2D(3553,Ii,0,0,_s.width,_s.height,br,Dn,_s.data):e.texImage2D(3553,Ii,An,_s.width,_s.height,0,br,Dn,_s.data)}else if(Xe.isDataTexture2DArray)lr?(Vn&&e.texStorage3D(35866,ns,An,Ci.width,Ci.height,Ci.depth),e.texSubImage3D(35866,0,0,0,0,Ci.width,Ci.height,Ci.depth,br,Dn,Ci.data)):e.texImage3D(35866,0,An,Ci.width,Ci.height,Ci.depth,0,br,Dn,Ci.data);else if(Xe.isDataTexture3D)lr?(Vn&&e.texStorage3D(32879,ns,An,Ci.width,Ci.height,Ci.depth),e.texSubImage3D(32879,0,0,0,0,Ci.width,Ci.height,Ci.depth,br,Dn,Ci.data)):e.texImage3D(32879,0,An,Ci.width,Ci.height,Ci.depth,0,br,Dn,Ci.data);else if(Xe.isFramebufferTexture)lr&&Vn?e.texStorage2D(3553,ns,An,Ci.width,Ci.height):e.texImage2D(3553,0,An,Ci.width,Ci.height,0,br,Dn,null);else if(Mt.length>0&&Lr){lr&&Vn&&e.texStorage2D(3553,ns,An,Mt[0].width,Mt[0].height);for(let Ii=0,Vr=Mt.length;Ii<Vr;Ii++)_s=Mt[Ii],lr?e.texSubImage2D(3553,Ii,0,0,br,Dn,_s):e.texImage2D(3553,Ii,An,br,Dn,_s);Xe.generateMipmaps=!1}else lr?(Vn&&e.texStorage2D(3553,ns,An,Ci.width,Ci.height),e.texSubImage2D(3553,0,0,0,br,Dn,Ci)):e.texImage2D(3553,0,An,br,Dn,Ci);ce(Xe,Lr)&&ye(un),ot.__version=Xe.version,Xe.onUpdate&&Xe.onUpdate(Xe)}function nn(ot,Xe,Ti,un,pr){const Ci=s.convert(Ti.format,Ti.encoding),Lr=s.convert(Ti.type),br=Ce(Ti.internalFormat,Ci,Lr,Ti.encoding);n.get(Xe).__hasExternalTextures||(32879===pr||35866===pr?e.texImage3D(pr,0,br,Xe.width,Xe.height,Xe.depth,0,Ci,Lr,null):e.texImage2D(pr,0,br,Xe.width,Xe.height,0,Ci,Lr,null)),e.bindFramebuffer(36160,ot),Xe.useRenderToTexture?S.framebufferTexture2DMultisampleEXT(36160,un,pr,n.get(Ti).__webglTexture,0,Gn(Xe)):i.framebufferTexture2D(36160,un,pr,n.get(Ti).__webglTexture,0),e.bindFramebuffer(36160,null)}function Un(ot,Xe,Ti){if(i.bindRenderbuffer(36161,ot),Xe.depthBuffer&&!Xe.stencilBuffer){let un=33189;if(Ti||Xe.useRenderToTexture){const pr=Xe.depthTexture;pr&&pr.isDepthTexture&&(pr.type===gg?un=36012:pr.type===FT&&(un=33190));const Ci=Gn(Xe);Xe.useRenderToTexture?S.renderbufferStorageMultisampleEXT(36161,Ci,un,Xe.width,Xe.height):i.renderbufferStorageMultisample(36161,Ci,un,Xe.width,Xe.height)}else i.renderbufferStorage(36161,un,Xe.width,Xe.height);i.framebufferRenderbuffer(36160,36096,36161,ot)}else if(Xe.depthBuffer&&Xe.stencilBuffer){const un=Gn(Xe);Ti&&Xe.useRenderbuffer?i.renderbufferStorageMultisample(36161,un,35056,Xe.width,Xe.height):Xe.useRenderToTexture?S.renderbufferStorageMultisampleEXT(36161,un,35056,Xe.width,Xe.height):i.renderbufferStorage(36161,34041,Xe.width,Xe.height),i.framebufferRenderbuffer(36160,33306,36161,ot)}else{const un=!0===Xe.isWebGLMultipleRenderTargets?Xe.texture[0]:Xe.texture,pr=s.convert(un.format,un.encoding),Ci=s.convert(un.type),Lr=Ce(un.internalFormat,pr,Ci,un.encoding),br=Gn(Xe);Ti&&Xe.useRenderbuffer?i.renderbufferStorageMultisample(36161,br,Lr,Xe.width,Xe.height):Xe.useRenderToTexture?S.renderbufferStorageMultisampleEXT(36161,br,Lr,Xe.width,Xe.height):i.renderbufferStorage(36161,Lr,Xe.width,Xe.height)}i.bindRenderbuffer(36161,null)}function ts(ot){const Xe=n.get(ot),Ti=!0===ot.isWebGLCubeRenderTarget;if(ot.depthTexture&&!Xe.__autoAllocateDepthBuffer){if(Ti)throw new Error("target.depthTexture not supported in Cube render targets");!function Cn(ot,Xe){if(Xe&&Xe.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(36160,ot),!Xe.depthTexture||!Xe.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(Xe.depthTexture).__webglTexture||Xe.depthTexture.image.width!==Xe.width||Xe.depthTexture.image.height!==Xe.height)&&(Xe.depthTexture.image.width=Xe.width,Xe.depthTexture.image.height=Xe.height,Xe.depthTexture.needsUpdate=!0),vt(Xe.depthTexture,0);const un=n.get(Xe.depthTexture).__webglTexture,pr=Gn(Xe);if(Xe.depthTexture.format===Ay)Xe.useRenderToTexture?S.framebufferTexture2DMultisampleEXT(36160,36096,3553,un,0,pr):i.framebufferTexture2D(36160,36096,3553,un,0);else{if(Xe.depthTexture.format!==g0)throw new Error("Unknown depthTexture format");Xe.useRenderToTexture?S.framebufferTexture2DMultisampleEXT(36160,33306,3553,un,0,pr):i.framebufferTexture2D(36160,33306,3553,un,0)}}(Xe.__webglFramebuffer,ot)}else if(Ti){Xe.__webglDepthbuffer=[];for(let un=0;un<6;un++)e.bindFramebuffer(36160,Xe.__webglFramebuffer[un]),Xe.__webglDepthbuffer[un]=i.createRenderbuffer(),Un(Xe.__webglDepthbuffer[un],ot,!1)}else e.bindFramebuffer(36160,Xe.__webglFramebuffer),Xe.__webglDepthbuffer=i.createRenderbuffer(),Un(Xe.__webglDepthbuffer,ot,!1);e.bindFramebuffer(36160,null)}function Gn(ot){return l&&(ot.useRenderbuffer||ot.useRenderToTexture)?Math.min(_,ot.samples):0}function is(ot,Xe){const Ti=ot.encoding,un=ot.format,pr=ot.type;return!0===ot.isCompressedTexture||!0===ot.isVideoTexture||ot.format===QP||Ti!==_g&&(Ti===ba?!1===l?!0===t.has("EXT_sRGB")&&un===Qc?(ot.format=QP,ot.minFilter=Ka,ot.generateMipmaps=!1):Xe=Ry.sRGBToLinear(Xe):(un!==Qc||pr!==mg)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",Ti)),Xe}let ls=!1,co=!1;this.allocateTextureUnit=function et(){const ot=pt;return ot>=u&&console.warn("THREE.WebGLTextures: Trying to use "+ot+" texture units while this GPU supports only "+u),pt+=1,ot},this.resetTextureUnits=function Pt(){pt=0},this.setTexture2D=vt,this.setTexture2DArray=function kt(ot,Xe){const Ti=n.get(ot);ot.version>0&&Ti.__version!==ot.version?Zt(Ti,ot,Xe):(e.activeTexture(33984+Xe),e.bindTexture(35866,Ti.__webglTexture))},this.setTexture3D=function pi(ot,Xe){const Ti=n.get(ot);ot.version>0&&Ti.__version!==ot.version?Zt(Ti,ot,Xe):(e.activeTexture(33984+Xe),e.bindTexture(32879,Ti.__webglTexture))},this.setTextureCube=Ht,this.rebindTextures=function Hr(ot,Xe,Ti){const un=n.get(ot);void 0!==Xe&&nn(un.__webglFramebuffer,ot,ot.texture,36064,3553),void 0!==Ti&&ts(ot)},this.setupRenderTarget=function Ri(ot){const Xe=ot.texture,Ti=n.get(ot),un=n.get(Xe);ot.addEventListener("dispose",ge),!0!==ot.isWebGLMultipleRenderTargets&&(void 0===un.__webglTexture&&(un.__webglTexture=i.createTexture()),un.__version=Xe.version,a.memory.textures++);const pr=!0===ot.isWebGLCubeRenderTarget,Ci=!0===ot.isWebGLMultipleRenderTargets,Lr=Xe.isDataTexture3D||Xe.isDataTexture2DArray,br=ie(ot)||l;if(pr){Ti.__webglFramebuffer=[];for(let Dn=0;Dn<6;Dn++)Ti.__webglFramebuffer[Dn]=i.createFramebuffer()}else if(Ti.__webglFramebuffer=i.createFramebuffer(),Ci)if(r.drawBuffers){const Dn=ot.texture;for(let An=0,_s=Dn.length;An<_s;An++){const Mt=n.get(Dn[An]);void 0===Mt.__webglTexture&&(Mt.__webglTexture=i.createTexture(),a.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(ot.useRenderbuffer)if(l){Ti.__webglMultisampledFramebuffer=i.createFramebuffer(),Ti.__webglColorRenderbuffer=i.createRenderbuffer(),i.bindRenderbuffer(36161,Ti.__webglColorRenderbuffer);const Dn=s.convert(Xe.format,Xe.encoding),An=s.convert(Xe.type),_s=Ce(Xe.internalFormat,Dn,An,Xe.encoding),Mt=Gn(ot);i.renderbufferStorageMultisample(36161,Mt,_s,ot.width,ot.height),e.bindFramebuffer(36160,Ti.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(36160,36064,36161,Ti.__webglColorRenderbuffer),i.bindRenderbuffer(36161,null),ot.depthBuffer&&(Ti.__webglDepthRenderbuffer=i.createRenderbuffer(),Un(Ti.__webglDepthRenderbuffer,ot,!0)),e.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(pr){e.bindTexture(34067,un.__webglTexture),Zi(34067,Xe,br);for(let Dn=0;Dn<6;Dn++)nn(Ti.__webglFramebuffer[Dn],ot,Xe,36064,34069+Dn);ce(Xe,br)&&ye(34067),e.unbindTexture()}else if(Ci){const Dn=ot.texture;for(let An=0,_s=Dn.length;An<_s;An++){const Mt=Dn[An],lr=n.get(Mt);e.bindTexture(3553,lr.__webglTexture),Zi(3553,Mt,br),nn(Ti.__webglFramebuffer,ot,Mt,36064+An,3553),ce(Mt,br)&&ye(3553)}e.unbindTexture()}else{let Dn=3553;Lr&&(l?Dn=Xe.isDataTexture3D?32879:35866:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),e.bindTexture(Dn,un.__webglTexture),Zi(Dn,Xe,br),nn(Ti.__webglFramebuffer,ot,Xe,36064,Dn),ce(Xe,br)&&ye(Dn),e.unbindTexture()}ot.depthBuffer&&ts(ot)},this.updateRenderTargetMipmap=function fn(ot){const Xe=ie(ot)||l,Ti=!0===ot.isWebGLMultipleRenderTargets?ot.texture:[ot.texture];for(let un=0,pr=Ti.length;un<pr;un++){const Ci=Ti[un];if(ce(Ci,Xe)){const Lr=ot.isWebGLCubeRenderTarget?34067:3553,br=n.get(Ci).__webglTexture;e.bindTexture(Lr,br),ye(Lr),e.unbindTexture()}}},this.updateMultisampleRenderTarget=function sn(ot){if(ot.useRenderbuffer)if(l){const Xe=ot.width,Ti=ot.height;let un=16384;const pr=[36064],Ci=ot.stencilBuffer?33306:36096;ot.depthBuffer&&pr.push(Ci),ot.ignoreDepthForMultisampleCopy||(ot.depthBuffer&&(un|=256),ot.stencilBuffer&&(un|=1024));const Lr=n.get(ot);e.bindFramebuffer(36008,Lr.__webglMultisampledFramebuffer),e.bindFramebuffer(36009,Lr.__webglFramebuffer),ot.ignoreDepthForMultisampleCopy&&(i.invalidateFramebuffer(36008,[Ci]),i.invalidateFramebuffer(36009,[Ci])),i.blitFramebuffer(0,0,Xe,Ti,0,0,Xe,Ti,un,9728),i.invalidateFramebuffer(36008,pr),e.bindFramebuffer(36008,null),e.bindFramebuffer(36009,Lr.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.setupDepthRenderbuffer=ts,this.setupFrameBufferTexture=nn,this.safeSetTexture2D=function sa(ot,Xe){ot&&ot.isWebGLRenderTarget&&(!1===ls&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),ls=!0),ot=ot.texture),vt(ot,Xe)},this.safeSetTextureCube=function Zo(ot,Xe){ot&&ot.isWebGLCubeRenderTarget&&(!1===co&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),co=!0),ot=ot.texture),Ht(ot,Xe)}}function iY(i,t,e){const n=e.isWebGL2;return{convert:function r(s,a=null){let l;if(s===mg)return 5121;if(s===IX)return 32819;if(s===LX)return 32820;if(s===RX)return 5120;if(s===kX)return 5122;if(s===vS)return 5123;if(s===PX)return 5124;if(s===FT)return 5125;if(s===gg)return 5126;if(s===p0)return n?5131:(l=t.get("OES_texture_half_float"),null!==l?l.HALF_FLOAT_OES:null);if(s===OX)return 6406;if(s===Qc)return 6408;if(s===FX)return 6409;if(s===BX)return 6410;if(s===Ay)return 6402;if(s===g0)return 34041;if(s===NX)return 6403;if(s===QP)return l=t.get("EXT_sRGB"),null!==l?l.SRGB_ALPHA_EXT:null;if(s===HX)return 36244;if(s===VX)return 33319;if(s===zX)return 33320;if(s===UX)return 36249;if(s===WP||s===jP||s===qP||s===XP)if(a===ba){if(l=t.get("WEBGL_compressed_texture_s3tc_srgb"),null===l)return null;if(s===WP)return l.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===jP)return l.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===qP)return l.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===XP)return l.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(l=t.get("WEBGL_compressed_texture_s3tc"),null===l)return null;if(s===WP)return l.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===jP)return l.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===qP)return l.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===XP)return l.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(s===CV||s===MV||s===TV||s===EV){if(l=t.get("WEBGL_compressed_texture_pvrtc"),null===l)return null;if(s===CV)return l.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===MV)return l.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===TV)return l.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===EV)return l.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(s===GX)return l=t.get("WEBGL_compressed_texture_etc1"),null!==l?l.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===AV||s===DV){if(l=t.get("WEBGL_compressed_texture_etc"),null===l)return null;if(s===AV)return a===ba?l.COMPRESSED_SRGB8_ETC2:l.COMPRESSED_RGB8_ETC2;if(s===DV)return a===ba?l.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:l.COMPRESSED_RGBA8_ETC2_EAC}if(s===RV||s===kV||s===PV||s===IV||s===LV||s===OV||s===FV||s===BV||s===NV||s===HV||s===VV||s===zV||s===UV||s===GV){if(l=t.get("WEBGL_compressed_texture_astc"),null===l)return null;if(s===RV)return a===ba?l.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:l.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===kV)return a===ba?l.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:l.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===PV)return a===ba?l.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:l.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===IV)return a===ba?l.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:l.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===LV)return a===ba?l.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:l.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===OV)return a===ba?l.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:l.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===FV)return a===ba?l.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:l.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===BV)return a===ba?l.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:l.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===NV)return a===ba?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:l.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===HV)return a===ba?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:l.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===VV)return a===ba?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:l.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===zV)return a===ba?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:l.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===UV)return a===ba?l.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:l.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===GV)return a===ba?l.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:l.COMPRESSED_RGBA_ASTC_12x12_KHR}if(s===WV){if(l=t.get("EXT_texture_compression_bptc"),null===l)return null;if(s===WV)return a===ba?l.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:l.COMPRESSED_RGBA_BPTC_UNORM_EXT}return s===m0?n?34042:(l=t.get("WEBGL_depth_texture"),null!==l?l.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}D2.prototype.isMeshDistanceMaterial=!0;class C5 extends mc{constructor(t=[]){super(),this.cameras=t}}C5.prototype.isArrayCamera=!0;class E0 extends Zs{constructor(){super(),this.type="Group"}}E0.prototype.isGroup=!0;const Wwe={type:"move"};class M5{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new E0,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new E0,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new He,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new He),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new E0,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new He,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new He),this._grip}dispatchEvent(t){return null!==this._targetRay&&this._targetRay.dispatchEvent(t),null!==this._grip&&this._grip.dispatchEvent(t),null!==this._hand&&this._hand.dispatchEvent(t),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(t,e,n){let r=null,s=null,a=null;const l=this._targetRay,u=this._grip,h=this._hand;if(t&&"visible-blurred"!==e.session.visibilityState)if(null!==l&&(r=e.getPose(t.targetRaySpace,n),null!==r&&(l.matrix.fromArray(r.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),r.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(r.linearVelocity)):l.hasLinearVelocity=!1,r.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(r.angularVelocity)):l.hasAngularVelocity=!1,this.dispatchEvent(Wwe))),h&&t.hand){a=!0;for(const I of t.hand.values()){const j=e.getJointPose(I,n);if(void 0===h.joints[I.jointName]){const E=new E0;E.matrixAutoUpdate=!1,E.visible=!1,h.joints[I.jointName]=E,h.add(E)}const P=h.joints[I.jointName];null!==j&&(P.matrix.fromArray(j.transform.matrix),P.matrix.decompose(P.position,P.rotation,P.scale),P.jointRadius=j.radius),P.visible=null!==j}const v=h.joints["index-finger-tip"].position.distanceTo(h.joints["thumb-tip"].position),S=.02,T=.005;h.inputState.pinching&&v>S+T?(h.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!h.inputState.pinching&&v<=S-T&&(h.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else null!==u&&t.gripSpace&&(s=e.getPose(t.gripSpace,n),null!==s&&(u.matrix.fromArray(s.transform.matrix),u.matrix.decompose(u.position,u.rotation,u.scale),s.linearVelocity?(u.hasLinearVelocity=!0,u.linearVelocity.copy(s.linearVelocity)):u.hasLinearVelocity=!1,s.angularVelocity?(u.hasAngularVelocity=!0,u.angularVelocity.copy(s.angularVelocity)):u.hasAngularVelocity=!1));return null!==l&&(l.visible=null!==r),null!==u&&(u.visible=null!==s),null!==h&&(h.visible=null!==a),this}}class R2 extends Jl{constructor(t,e,n,r,s,a,l,u,h,m){if((m=void 0!==m?m:Ay)!==Ay&&m!==g0)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&m===Ay&&(n=vS),void 0===n&&m===g0&&(n=m0),super(null,r,s,a,l,u,m,n,h),this.image={width:t,height:e},this.magFilter=void 0!==l?l:Dl,this.minFilter=void 0!==u?u:Dl,this.flipY=!1,this.generateMipmaps=!1}}R2.prototype.isDepthTexture=!0;class jwe extends Dy{constructor(t,e){super();const n=this;let r=null,s=1,a=null,l="local-floor";const u=t.extensions.has("WEBGL_multisampled_render_to_texture");let h=null,m=null,_=null,v=null,S=!1,T=null;const I=e.getContextAttributes();let j=null,P=null;const E=[],ie=new Map,ee=new mc;ee.layers.enable(1),ee.viewport=new Bo;const ce=new mc;ce.layers.enable(2),ce.viewport=new Bo;const ye=[ee,ce],Ce=new C5;Ce.layers.enable(1),Ce.layers.enable(2);let Ge=null,Qe=null;function nt(Ht){const ct=ie.get(Ht.inputSource);ct&&ct.dispatchEvent({type:Ht.type,data:Ht.inputSource})}function ge(){ie.forEach(function(Ht,ct){Ht.disconnect(ct)}),ie.clear(),Ge=null,Qe=null,t.setRenderTarget(j),v=null,_=null,m=null,r=null,P=null,pi.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function Je(Ht){const ct=r.inputSources;for(let mi=0;mi<E.length;mi++)ie.set(ct[mi],E[mi]);for(let mi=0;mi<Ht.removed.length;mi++){const Zi=Ht.removed[mi],zi=ie.get(Zi);zi&&(zi.dispatchEvent({type:"disconnected",data:Zi}),ie.delete(Zi))}for(let mi=0;mi<Ht.added.length;mi++){const Zi=Ht.added[mi],zi=ie.get(Zi);zi&&zi.dispatchEvent({type:"connected",data:Zi})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Ht){let ct=E[Ht];return void 0===ct&&(ct=new M5,E[Ht]=ct),ct.getTargetRaySpace()},this.getControllerGrip=function(Ht){let ct=E[Ht];return void 0===ct&&(ct=new M5,E[Ht]=ct),ct.getGripSpace()},this.getHand=function(Ht){let ct=E[Ht];return void 0===ct&&(ct=new M5,E[Ht]=ct),ct.getHandSpace()},this.setFramebufferScaleFactor=function(Ht){s=Ht,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Ht){l=Ht,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return a},this.getBaseLayer=function(){return null!==_?_:v},this.getBinding=function(){return m},this.getFrame=function(){return T},this.getSession=function(){return r},this.setSession=function(){var Ht=DT(function*(ct){if(r=ct,null!==r){if(j=t.getRenderTarget(),r.addEventListener("select",nt),r.addEventListener("selectstart",nt),r.addEventListener("selectend",nt),r.addEventListener("squeeze",nt),r.addEventListener("squeezestart",nt),r.addEventListener("squeezeend",nt),r.addEventListener("end",ge),r.addEventListener("inputsourceschange",Je),!0!==I.xrCompatible&&(yield e.makeXRCompatible()),void 0===r.renderState.layers||!1===t.capabilities.isWebGL2)v=new XRWebGLLayer(r,e,{antialias:void 0!==r.renderState.layers||I.antialias,alpha:I.alpha,depth:I.depth,stencil:I.stencil,framebufferScaleFactor:s}),r.updateRenderState({baseLayer:v}),P=new Hh(v.framebufferWidth,v.framebufferHeight,{format:Qc,type:mg,encoding:t.outputEncoding});else{S=I.antialias;let mi=null,Zi=null,zi=null;I.depth&&(zi=I.stencil?35056:33190,mi=I.stencil?g0:Ay,Zi=I.stencil?m0:vS);const Zt={colorFormat:t.outputEncoding===ba?35907:32856,depthFormat:zi,scaleFactor:s};m=new XRWebGLBinding(r,e),_=m.createProjectionLayer(Zt),r.updateRenderState({layers:[_]}),P=S?new e2(_.textureWidth,_.textureHeight,{format:Qc,type:mg,depthTexture:new R2(_.textureWidth,_.textureHeight,Zi,void 0,void 0,void 0,void 0,void 0,void 0,mi),stencilBuffer:I.stencil,ignoreDepth:_.ignoreDepthValues,useRenderToTexture:u,encoding:t.outputEncoding}):new Hh(_.textureWidth,_.textureHeight,{format:Qc,type:mg,depthTexture:new R2(_.textureWidth,_.textureHeight,Zi,void 0,void 0,void 0,void 0,void 0,void 0,mi),stencilBuffer:I.stencil,ignoreDepth:_.ignoreDepthValues,encoding:t.outputEncoding})}P.isXRRenderTarget=!0,this.setFoveation(1),a=yield r.requestReferenceSpace(l),pi.setContext(r),pi.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}});return function(ct){return Ht.apply(this,arguments)}}();const mt=new He,pt=new He;function et(Ht,ct){null===ct?Ht.matrixWorld.copy(Ht.matrix):Ht.matrixWorld.multiplyMatrices(ct.matrixWorld,Ht.matrix),Ht.matrixWorldInverse.copy(Ht.matrixWorld).invert()}this.updateCamera=function(Ht){if(null===r)return;Ce.near=ce.near=ee.near=Ht.near,Ce.far=ce.far=ee.far=Ht.far,(Ge!==Ce.near||Qe!==Ce.far)&&(r.updateRenderState({depthNear:Ce.near,depthFar:Ce.far}),Ge=Ce.near,Qe=Ce.far);const ct=Ht.parent,mi=Ce.cameras;et(Ce,ct);for(let zi=0;zi<mi.length;zi++)et(mi[zi],ct);Ce.matrixWorld.decompose(Ce.position,Ce.quaternion,Ce.scale),Ht.position.copy(Ce.position),Ht.quaternion.copy(Ce.quaternion),Ht.scale.copy(Ce.scale),Ht.matrix.copy(Ce.matrix),Ht.matrixWorld.copy(Ce.matrixWorld);const Zi=Ht.children;for(let zi=0,Zt=Zi.length;zi<Zt;zi++)Zi[zi].updateMatrixWorld(!0);2===mi.length?function Pt(Ht,ct,mi){mt.setFromMatrixPosition(ct.matrixWorld),pt.setFromMatrixPosition(mi.matrixWorld);const Zi=mt.distanceTo(pt),zi=ct.projectionMatrix.elements,Zt=mi.projectionMatrix.elements,tr=zi[14]/(zi[10]-1),nn=zi[14]/(zi[10]+1),Un=(zi[9]+1)/zi[5],Cn=(zi[9]-1)/zi[5],ts=(zi[8]-1)/zi[0],Hr=(Zt[8]+1)/Zt[0],Ri=tr*ts,fn=tr*Hr,sn=Zi/(-ts+Hr),Gn=sn*-ts;ct.matrixWorld.decompose(Ht.position,Ht.quaternion,Ht.scale),Ht.translateX(Gn),Ht.translateZ(sn),Ht.matrixWorld.compose(Ht.position,Ht.quaternion,Ht.scale),Ht.matrixWorldInverse.copy(Ht.matrixWorld).invert();const kn=tr+sn,is=nn+sn;Ht.projectionMatrix.makePerspective(Ri-Gn,fn+(Zi-Gn),Un*nn/is*kn,Cn*nn/is*kn,kn,is)}(Ce,ee,ce):Ce.projectionMatrix.copy(ee.projectionMatrix)},this.getCamera=function(){return Ce},this.getFoveation=function(){return null!==_?_.fixedFoveation:null!==v?v.fixedFoveation:void 0},this.setFoveation=function(Ht){null!==_&&(_.fixedFoveation=Ht),null!==v&&void 0!==v.fixedFoveation&&(v.fixedFoveation=Ht)};let vt=null;const pi=new SZ;pi.setAnimationLoop(function kt(Ht,ct){if(h=ct.getViewerPose(a),T=ct,null!==h){const Zi=h.views;null!==v&&(t.setRenderTargetFramebuffer(P,v.framebuffer),t.setRenderTarget(P));let zi=!1;Zi.length!==Ce.cameras.length&&(Ce.cameras.length=0,zi=!0);for(let Zt=0;Zt<Zi.length;Zt++){const tr=Zi[Zt];let nn=null;if(null!==v)nn=v.getViewport(tr);else{const Cn=m.getViewSubImage(_,tr);nn=Cn.viewport,0===Zt&&(t.setRenderTargetTextures(P,Cn.colorTexture,_.ignoreDepthValues?void 0:Cn.depthStencilTexture),t.setRenderTarget(P))}const Un=ye[Zt];Un.matrix.fromArray(tr.transform.matrix),Un.projectionMatrix.fromArray(tr.projectionMatrix),Un.viewport.set(nn.x,nn.y,nn.width,nn.height),0===Zt&&Ce.matrix.copy(Un.matrix),!0===zi&&Ce.cameras.push(Un)}}const mi=r.inputSources;for(let Zi=0;Zi<E.length;Zi++)E[Zi].update(mi[Zi],ct,a);vt&&vt(Ht,ct),T=null}),this.setAnimationLoop=function(Ht){vt=Ht},this.dispose=function(){}}}function qwe(i){function n(P,E){P.opacity.value=E.opacity,E.color&&P.diffuse.value.copy(E.color),E.emissive&&P.emissive.value.copy(E.emissive).multiplyScalar(E.emissiveIntensity),E.map&&(P.map.value=E.map),E.alphaMap&&(P.alphaMap.value=E.alphaMap),E.specularMap&&(P.specularMap.value=E.specularMap),E.alphaTest>0&&(P.alphaTest.value=E.alphaTest);const ie=i.get(E).envMap;let ee,ce;ie&&(P.envMap.value=ie,P.flipEnvMap.value=ie.isCubeTexture&&!1===ie.isRenderTargetTexture?-1:1,P.reflectivity.value=E.reflectivity,P.ior.value=E.ior,P.refractionRatio.value=E.refractionRatio),E.lightMap&&(P.lightMap.value=E.lightMap,P.lightMapIntensity.value=E.lightMapIntensity),E.aoMap&&(P.aoMap.value=E.aoMap,P.aoMapIntensity.value=E.aoMapIntensity),E.map?ee=E.map:E.specularMap?ee=E.specularMap:E.displacementMap?ee=E.displacementMap:E.normalMap?ee=E.normalMap:E.bumpMap?ee=E.bumpMap:E.roughnessMap?ee=E.roughnessMap:E.metalnessMap?ee=E.metalnessMap:E.alphaMap?ee=E.alphaMap:E.emissiveMap?ee=E.emissiveMap:E.clearcoatMap?ee=E.clearcoatMap:E.clearcoatNormalMap?ee=E.clearcoatNormalMap:E.clearcoatRoughnessMap?ee=E.clearcoatRoughnessMap:E.specularIntensityMap?ee=E.specularIntensityMap:E.specularColorMap?ee=E.specularColorMap:E.transmissionMap?ee=E.transmissionMap:E.thicknessMap?ee=E.thicknessMap:E.sheenColorMap?ee=E.sheenColorMap:E.sheenRoughnessMap&&(ee=E.sheenRoughnessMap),void 0!==ee&&(ee.isWebGLRenderTarget&&(ee=ee.texture),!0===ee.matrixAutoUpdate&&ee.updateMatrix(),P.uvTransform.value.copy(ee.matrix)),E.aoMap?ce=E.aoMap:E.lightMap&&(ce=E.lightMap),void 0!==ce&&(ce.isWebGLRenderTarget&&(ce=ce.texture),!0===ce.matrixAutoUpdate&&ce.updateMatrix(),P.uv2Transform.value.copy(ce.matrix))}function _(P,E){P.roughness.value=E.roughness,P.metalness.value=E.metalness,E.roughnessMap&&(P.roughnessMap.value=E.roughnessMap),E.metalnessMap&&(P.metalnessMap.value=E.metalnessMap),E.emissiveMap&&(P.emissiveMap.value=E.emissiveMap),E.bumpMap&&(P.bumpMap.value=E.bumpMap,P.bumpScale.value=E.bumpScale,E.side===Al&&(P.bumpScale.value*=-1)),E.normalMap&&(P.normalMap.value=E.normalMap,P.normalScale.value.copy(E.normalScale),E.side===Al&&P.normalScale.value.negate()),E.displacementMap&&(P.displacementMap.value=E.displacementMap,P.displacementScale.value=E.displacementScale,P.displacementBias.value=E.displacementBias),i.get(E).envMap&&(P.envMapIntensity.value=E.envMapIntensity)}return{refreshFogUniforms:function t(P,E){P.fogColor.value.copy(E.color),E.isFog?(P.fogNear.value=E.near,P.fogFar.value=E.far):E.isFogExp2&&(P.fogDensity.value=E.density)},refreshMaterialUniforms:function e(P,E,ie,ee,ce){E.isMeshBasicMaterial?n(P,E):E.isMeshLambertMaterial?(n(P,E),function u(P,E){E.emissiveMap&&(P.emissiveMap.value=E.emissiveMap)}(P,E)):E.isMeshToonMaterial?(n(P,E),function m(P,E){E.gradientMap&&(P.gradientMap.value=E.gradientMap),E.emissiveMap&&(P.emissiveMap.value=E.emissiveMap),E.bumpMap&&(P.bumpMap.value=E.bumpMap,P.bumpScale.value=E.bumpScale,E.side===Al&&(P.bumpScale.value*=-1)),E.normalMap&&(P.normalMap.value=E.normalMap,P.normalScale.value.copy(E.normalScale),E.side===Al&&P.normalScale.value.negate()),E.displacementMap&&(P.displacementMap.value=E.displacementMap,P.displacementScale.value=E.displacementScale,P.displacementBias.value=E.displacementBias)}(P,E)):E.isMeshPhongMaterial?(n(P,E),function h(P,E){P.specular.value.copy(E.specular),P.shininess.value=Math.max(E.shininess,1e-4),E.emissiveMap&&(P.emissiveMap.value=E.emissiveMap),E.bumpMap&&(P.bumpMap.value=E.bumpMap,P.bumpScale.value=E.bumpScale,E.side===Al&&(P.bumpScale.value*=-1)),E.normalMap&&(P.normalMap.value=E.normalMap,P.normalScale.value.copy(E.normalScale),E.side===Al&&P.normalScale.value.negate()),E.displacementMap&&(P.displacementMap.value=E.displacementMap,P.displacementScale.value=E.displacementScale,P.displacementBias.value=E.displacementBias)}(P,E)):E.isMeshStandardMaterial?(n(P,E),E.isMeshPhysicalMaterial?function v(P,E,ie){_(P,E),P.ior.value=E.ior,E.sheen>0&&(P.sheenColor.value.copy(E.sheenColor).multiplyScalar(E.sheen),P.sheenRoughness.value=E.sheenRoughness,E.sheenColorMap&&(P.sheenColorMap.value=E.sheenColorMap),E.sheenRoughnessMap&&(P.sheenRoughnessMap.value=E.sheenRoughnessMap)),E.clearcoat>0&&(P.clearcoat.value=E.clearcoat,P.clearcoatRoughness.value=E.clearcoatRoughness,E.clearcoatMap&&(P.clearcoatMap.value=E.clearcoatMap),E.clearcoatRoughnessMap&&(P.clearcoatRoughnessMap.value=E.clearcoatRoughnessMap),E.clearcoatNormalMap&&(P.clearcoatNormalScale.value.copy(E.clearcoatNormalScale),P.clearcoatNormalMap.value=E.clearcoatNormalMap,E.side===Al&&P.clearcoatNormalScale.value.negate())),E.transmission>0&&(P.transmission.value=E.transmission,P.transmissionSamplerMap.value=ie.texture,P.transmissionSamplerSize.value.set(ie.width,ie.height),E.transmissionMap&&(P.transmissionMap.value=E.transmissionMap),P.thickness.value=E.thickness,E.thicknessMap&&(P.thicknessMap.value=E.thicknessMap),P.attenuationDistance.value=E.attenuationDistance,P.attenuationColor.value.copy(E.attenuationColor)),P.specularIntensity.value=E.specularIntensity,P.specularColor.value.copy(E.specularColor),E.specularIntensityMap&&(P.specularIntensityMap.value=E.specularIntensityMap),E.specularColorMap&&(P.specularColorMap.value=E.specularColorMap)}(P,E,ce):_(P,E)):E.isMeshMatcapMaterial?(n(P,E),function S(P,E){E.matcap&&(P.matcap.value=E.matcap),E.bumpMap&&(P.bumpMap.value=E.bumpMap,P.bumpScale.value=E.bumpScale,E.side===Al&&(P.bumpScale.value*=-1)),E.normalMap&&(P.normalMap.value=E.normalMap,P.normalScale.value.copy(E.normalScale),E.side===Al&&P.normalScale.value.negate()),E.displacementMap&&(P.displacementMap.value=E.displacementMap,P.displacementScale.value=E.displacementScale,P.displacementBias.value=E.displacementBias)}(P,E)):E.isMeshDepthMaterial?(n(P,E),function T(P,E){E.displacementMap&&(P.displacementMap.value=E.displacementMap,P.displacementScale.value=E.displacementScale,P.displacementBias.value=E.displacementBias)}(P,E)):E.isMeshDistanceMaterial?(n(P,E),function I(P,E){E.displacementMap&&(P.displacementMap.value=E.displacementMap,P.displacementScale.value=E.displacementScale,P.displacementBias.value=E.displacementBias),P.referencePosition.value.copy(E.referencePosition),P.nearDistance.value=E.nearDistance,P.farDistance.value=E.farDistance}(P,E)):E.isMeshNormalMaterial?(n(P,E),function j(P,E){E.bumpMap&&(P.bumpMap.value=E.bumpMap,P.bumpScale.value=E.bumpScale,E.side===Al&&(P.bumpScale.value*=-1)),E.normalMap&&(P.normalMap.value=E.normalMap,P.normalScale.value.copy(E.normalScale),E.side===Al&&P.normalScale.value.negate()),E.displacementMap&&(P.displacementMap.value=E.displacementMap,P.displacementScale.value=E.displacementScale,P.displacementBias.value=E.displacementBias)}(P,E)):E.isLineBasicMaterial?(function r(P,E){P.diffuse.value.copy(E.color),P.opacity.value=E.opacity}(P,E),E.isLineDashedMaterial&&function s(P,E){P.dashSize.value=E.dashSize,P.totalSize.value=E.dashSize+E.gapSize,P.scale.value=E.scale}(P,E)):E.isPointsMaterial?function a(P,E,ie,ee){let ce;P.diffuse.value.copy(E.color),P.opacity.value=E.opacity,P.size.value=E.size*ie,P.scale.value=.5*ee,E.map&&(P.map.value=E.map),E.alphaMap&&(P.alphaMap.value=E.alphaMap),E.alphaTest>0&&(P.alphaTest.value=E.alphaTest),E.map?ce=E.map:E.alphaMap&&(ce=E.alphaMap),void 0!==ce&&(!0===ce.matrixAutoUpdate&&ce.updateMatrix(),P.uvTransform.value.copy(ce.matrix))}(P,E,ie,ee):E.isSpriteMaterial?function l(P,E){let ie;P.diffuse.value.copy(E.color),P.opacity.value=E.opacity,P.rotation.value=E.rotation,E.map&&(P.map.value=E.map),E.alphaMap&&(P.alphaMap.value=E.alphaMap),E.alphaTest>0&&(P.alphaTest.value=E.alphaTest),E.map?ie=E.map:E.alphaMap&&(ie=E.alphaMap),void 0!==ie&&(!0===ie.matrixAutoUpdate&&ie.updateMatrix(),P.uvTransform.value.copy(ie.matrix))}(P,E):E.isShadowMaterial?(P.color.value.copy(E.color),P.opacity.value=E.opacity):E.isShaderMaterial&&(E.uniformsNeedUpdate=!1)}}}function Io(i={}){const t=void 0!==i.canvas?i.canvas:function Xwe(){const i=UT("canvas");return i.style.display="block",i}(),e=void 0!==i.context?i.context:null,n=void 0!==i.alpha&&i.alpha,r=void 0===i.depth||i.depth,s=void 0===i.stencil||i.stencil,a=void 0!==i.antialias&&i.antialias,l=void 0===i.premultipliedAlpha||i.premultipliedAlpha,u=void 0!==i.preserveDrawingBuffer&&i.preserveDrawingBuffer,h=void 0!==i.powerPreference?i.powerPreference:"default",m=void 0!==i.failIfMajorPerformanceCaveat&&i.failIfMajorPerformanceCaveat;let _=null,v=null;const S=[],T=[];this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=_g,this.physicallyCorrectLights=!1,this.toneMapping=pg,this.toneMappingExposure=1;const I=this;let j=!1,P=0,E=0,ie=null,ee=-1,ce=null;const ye=new Bo,Ce=new Bo;let Ge=null,Qe=t.width,nt=t.height,ge=1,Je=null,mt=null;const pt=new Bo(0,0,Qe,nt),Pt=new Bo(0,0,Qe,nt);let et=!1;const vt=new XT;let kt=!1,pi=!1,Ht=null;const ct=new nr,mi=new He,Zi={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function zi(){return null===ie?ge:1}let nn,Un,Cn,ts,Hr,Ri,fn,sn,Gn,kn,is,ls,co,sa,Zo,ot,Xe,Ti,un,pr,Ci,Lr,br,Zt=e;function tr(Ye,Gt){for(let li=0;li<Ye.length;li++){const Li=t.getContext(Ye[li],Gt);if(null!==Li)return Li}return null}try{const Ye={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:u,powerPreference:h,failIfMajorPerformanceCaveat:m};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${HP}`),t.addEventListener("webglcontextlost",_s,!1),t.addEventListener("webglcontextrestored",Mt,!1),null===Zt){const Gt=["webgl2","webgl","experimental-webgl"];if(!0===I.isWebGL1Renderer&&Gt.shift(),Zt=tr(Gt,Ye),null===Zt)throw tr(Gt)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===Zt.getShaderPrecisionFormat&&(Zt.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Ye){throw console.error("THREE.WebGLRenderer: "+Ye.message),Ye}function Dn(){nn=new fxe(Zt),Un=new axe(Zt,nn,i),nn.init(Un),Lr=new iY(Zt,nn,Un),Cn=new Uwe(Zt,nn,Un),ts=new gxe(Zt),Hr=new kwe,Ri=new Gwe(Zt,nn,Cn,Hr,Un,Lr,ts),fn=new cxe(I),sn=new dxe(I),Gn=new cbe(Zt,Un),br=new sxe(Zt,nn,Gn,Un),kn=new pxe(Zt,Gn,ts,br),is=new bxe(Zt,kn,Gn,ts),un=new vxe(Zt,Un,Ri),ot=new lxe(Hr),ls=new Rwe(I,fn,sn,nn,Un,br,ot),co=new qwe(Hr),sa=new Iwe,Zo=new Hwe(nn,Un),Ti=new rxe(I,fn,Cn,is,n,l),Xe=new tY(I,is,Un),pr=new oxe(Zt,nn,ts,Un),Ci=new mxe(Zt,nn,ts,Un),ts.programs=ls.programs,I.capabilities=Un,I.extensions=nn,I.properties=Hr,I.renderLists=sa,I.shadowMap=Xe,I.state=Cn,I.info=ts}Dn();const An=new jwe(I,Zt);function _s(Ye){Ye.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),j=!0}function Mt(){console.log("THREE.WebGLRenderer: Context Restored."),j=!1;const Ye=ts.autoReset,Gt=Xe.enabled,li=Xe.autoUpdate,ni=Xe.needsUpdate,Li=Xe.type;Dn(),ts.autoReset=Ye,Xe.enabled=Gt,Xe.autoUpdate=li,Xe.needsUpdate=ni,Xe.type=Li}function lr(Ye){const Gt=Ye.target;Gt.removeEventListener("dispose",lr),function Vn(Ye){(function ns(Ye){const Gt=Hr.get(Ye).programs;void 0!==Gt&&(Gt.forEach(function(li){ls.releaseProgram(li)}),Ye.isShaderMaterial&&ls.releaseShaderCache(Ye))})(Ye),Hr.remove(Ye)}(Gt)}this.xr=An,this.getContext=function(){return Zt},this.getContextAttributes=function(){return Zt.getContextAttributes()},this.forceContextLoss=function(){const Ye=nn.get("WEBGL_lose_context");Ye&&Ye.loseContext()},this.forceContextRestore=function(){const Ye=nn.get("WEBGL_lose_context");Ye&&Ye.restoreContext()},this.getPixelRatio=function(){return ge},this.setPixelRatio=function(Ye){void 0!==Ye&&(ge=Ye,this.setSize(Qe,nt,!1))},this.getSize=function(Ye){return Ye.set(Qe,nt)},this.setSize=function(Ye,Gt,li){An.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(Qe=Ye,nt=Gt,t.width=Math.floor(Ye*ge),t.height=Math.floor(Gt*ge),!1!==li&&(t.style.width=Ye+"px",t.style.height=Gt+"px"),this.setViewport(0,0,Ye,Gt))},this.getDrawingBufferSize=function(Ye){return Ye.set(Qe*ge,nt*ge).floor()},this.setDrawingBufferSize=function(Ye,Gt,li){Qe=Ye,nt=Gt,ge=li,t.width=Math.floor(Ye*li),t.height=Math.floor(Gt*li),this.setViewport(0,0,Ye,Gt)},this.getCurrentViewport=function(Ye){return Ye.copy(ye)},this.getViewport=function(Ye){return Ye.copy(pt)},this.setViewport=function(Ye,Gt,li,ni){Ye.isVector4?pt.set(Ye.x,Ye.y,Ye.z,Ye.w):pt.set(Ye,Gt,li,ni),Cn.viewport(ye.copy(pt).multiplyScalar(ge).floor())},this.getScissor=function(Ye){return Ye.copy(Pt)},this.setScissor=function(Ye,Gt,li,ni){Ye.isVector4?Pt.set(Ye.x,Ye.y,Ye.z,Ye.w):Pt.set(Ye,Gt,li,ni),Cn.scissor(Ce.copy(Pt).multiplyScalar(ge).floor())},this.getScissorTest=function(){return et},this.setScissorTest=function(Ye){Cn.setScissorTest(et=Ye)},this.setOpaqueSort=function(Ye){Je=Ye},this.setTransparentSort=function(Ye){mt=Ye},this.getClearColor=function(Ye){return Ye.copy(Ti.getClearColor())},this.setClearColor=function(){Ti.setClearColor.apply(Ti,arguments)},this.getClearAlpha=function(){return Ti.getClearAlpha()},this.setClearAlpha=function(){Ti.setClearAlpha.apply(Ti,arguments)},this.clear=function(Ye,Gt,li){let ni=0;(void 0===Ye||Ye)&&(ni|=16384),(void 0===Gt||Gt)&&(ni|=256),(void 0===li||li)&&(ni|=1024),Zt.clear(ni)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",_s,!1),t.removeEventListener("webglcontextrestored",Mt,!1),sa.dispose(),Zo.dispose(),Hr.dispose(),fn.dispose(),sn.dispose(),is.dispose(),br.dispose(),ls.dispose(),An.dispose(),An.removeEventListener("sessionstart",io),An.removeEventListener("sessionend",$a),Ht&&(Ht.dispose(),Ht=null),$h.stop()},this.renderBufferDirect=function(Ye,Gt,li,ni,Li,fs){null===Gt&&(Gt=Zi);const ys=Li.isMesh&&Li.matrixWorld.determinant()<0,zs=function NOe(Ye,Gt,li,ni,Li){!0!==Gt.isScene&&(Gt=Zi),Ri.resetTextureUnits();const fs=Gt.fog,zs=null===ie?I.outputEncoding:!0===ie.isXRRenderTarget?ie.texture.encoding:_g,Rs=(ni.isMeshStandardMaterial?sn:fn).get(ni.envMap||(ni.isMeshStandardMaterial?Gt.environment:null)),Ho=!0===ni.vertexColors&&!!li.attributes.color&&4===li.attributes.color.itemSize,go=!!ni.normalMap&&!!li.attributes.tangent,wo=!!li.morphAttributes.position,fl=!!li.morphAttributes.normal,Y0=li.morphAttributes.position?li.morphAttributes.position.length:0,yC=ni.toneMapped?I.toneMapping:pg,To=Hr.get(ni),Xp=v.state.lights;!0!==kt||!0!==pi&&Ye===ce||ot.setState(ni,Ye,Ye===ce&&ni.id===ee);let yc=!1;ni.version===To.__version?(To.needsLights&&To.lightsStateVersion!==Xp.state.version||To.outputEncoding!==zs||Li.isInstancedMesh&&!1===To.instancing||!Li.isInstancedMesh&&!0===To.instancing||Li.isSkinnedMesh&&!1===To.skinning||!Li.isSkinnedMesh&&!0===To.skinning||To.envMap!==Rs||ni.fog&&To.fog!==fs||void 0!==To.numClippingPlanes&&(To.numClippingPlanes!==ot.numPlanes||To.numIntersection!==ot.numIntersection)||To.vertexAlphas!==Ho||To.vertexTangents!==go||To.morphTargets!==wo||To.morphNormals!==fl||To.toneMapping!==yC||!0===Un.isWebGL2&&To.morphTargetsCount!==Y0)&&(yc=!0):(yc=!0,To.__version=ni.version);let Zp=To.currentProgram;!0===yc&&(Zp=wz(ni,Gt,Li));let ML=!1,Yp=!1,Fg=!1;const uu=Zp.getUniforms(),HE=To.uniforms;if(Cn.useProgram(Zp.program)&&(ML=!0,Yp=!0,Fg=!0),ni.id!==ee&&(ee=ni.id,Yp=!0),ML||ce!==Ye){if(uu.setValue(Zt,"projectionMatrix",Ye.projectionMatrix),Un.logarithmicDepthBuffer&&uu.setValue(Zt,"logDepthBufFC",2/(Math.log(Ye.far+1)/Math.LN2)),ce!==Ye&&(ce=Ye,Yp=!0,Fg=!0),ni.isShaderMaterial||ni.isMeshPhongMaterial||ni.isMeshToonMaterial||ni.isMeshStandardMaterial||ni.envMap){const $f=uu.map.cameraPosition;void 0!==$f&&$f.setValue(Zt,mi.setFromMatrixPosition(Ye.matrixWorld))}(ni.isMeshPhongMaterial||ni.isMeshToonMaterial||ni.isMeshLambertMaterial||ni.isMeshBasicMaterial||ni.isMeshStandardMaterial||ni.isShaderMaterial)&&uu.setValue(Zt,"isOrthographic",!0===Ye.isOrthographicCamera),(ni.isMeshPhongMaterial||ni.isMeshToonMaterial||ni.isMeshLambertMaterial||ni.isMeshBasicMaterial||ni.isMeshStandardMaterial||ni.isShaderMaterial||ni.isShadowMaterial||Li.isSkinnedMesh)&&uu.setValue(Zt,"viewMatrix",Ye.matrixWorldInverse)}if(Li.isSkinnedMesh){uu.setOptional(Zt,Li,"bindMatrix"),uu.setOptional(Zt,Li,"bindMatrixInverse");const $f=Li.skeleton;$f&&(Un.floatVertexTextures?(null===$f.boneTexture&&$f.computeBoneTexture(),uu.setValue(Zt,"boneTexture",$f.boneTexture,Ri),uu.setValue(Zt,"boneTextureSize",$f.boneTextureSize)):uu.setOptional(Zt,$f,"boneMatrices"))}return!!li&&(void 0!==li.morphAttributes.position||void 0!==li.morphAttributes.normal)&&un.update(Li,li,ni,Zp),(Yp||To.receiveShadow!==Li.receiveShadow)&&(To.receiveShadow=Li.receiveShadow,uu.setValue(Zt,"receiveShadow",Li.receiveShadow)),Yp&&(uu.setValue(Zt,"toneMappingExposure",I.toneMappingExposure),To.needsLights&&function HOe(Ye,Gt){Ye.ambientLightColor.needsUpdate=Gt,Ye.lightProbe.needsUpdate=Gt,Ye.directionalLights.needsUpdate=Gt,Ye.directionalLightShadows.needsUpdate=Gt,Ye.pointLights.needsUpdate=Gt,Ye.pointLightShadows.needsUpdate=Gt,Ye.spotLights.needsUpdate=Gt,Ye.spotLightShadows.needsUpdate=Gt,Ye.rectAreaLights.needsUpdate=Gt,Ye.hemisphereLights.needsUpdate=Gt}(HE,Fg),fs&&ni.fog&&co.refreshFogUniforms(HE,fs),co.refreshMaterialUniforms(HE,ni,ge,nt,Ht),zy.upload(Zt,To.uniformsList,HE,Ri)),ni.isShaderMaterial&&!0===ni.uniformsNeedUpdate&&(zy.upload(Zt,To.uniformsList,HE,Ri),ni.uniformsNeedUpdate=!1),ni.isSpriteMaterial&&uu.setValue(Zt,"center",Li.center),uu.setValue(Zt,"modelViewMatrix",Li.modelViewMatrix),uu.setValue(Zt,"normalMatrix",Li.normalMatrix),uu.setValue(Zt,"modelMatrix",Li.matrixWorld),Zp}(Ye,Gt,li,ni,Li);Cn.setMaterial(ni,ys);let Rs=li.index;const Ho=li.attributes.position;if(null===Rs){if(void 0===Ho||0===Ho.count)return}else if(0===Rs.count)return;let go=1;!0===ni.wireframe&&(Rs=kn.getWireframeAttribute(li),go=2),br.setup(Li,ni,zs,li,Rs);let wo,fl=pr;null!==Rs&&(wo=Gn.get(Rs),fl=Ci,fl.setIndex(wo));const Y0=null!==Rs?Rs.count:Ho.count,yC=li.drawRange.start*go,To=li.drawRange.count*go,Xp=null!==fs?fs.start*go:0,yc=null!==fs?fs.count*go:1/0,Zp=Math.max(yC,Xp),ML=Math.min(Y0,yC+To,Xp+yc)-1,Yp=Math.max(0,ML-Zp+1);if(0!==Yp){if(Li.isMesh)!0===ni.wireframe?(Cn.setLineWidth(ni.wireframeLinewidth*zi()),fl.setMode(1)):fl.setMode(4);else if(Li.isLine){let Fg=ni.linewidth;void 0===Fg&&(Fg=1),Cn.setLineWidth(Fg*zi()),fl.setMode(Li.isLineSegments?1:Li.isLineLoop?2:3)}else Li.isPoints?fl.setMode(0):Li.isSprite&&fl.setMode(4);if(Li.isInstancedMesh)fl.renderInstances(Zp,Yp,Li.count);else if(li.isInstancedBufferGeometry){const Fg=Math.min(li.instanceCount,li._maxInstanceCount);fl.renderInstances(Zp,Yp,Fg)}else fl.render(Zp,Yp)}},this.compile=function(Ye,Gt){v=Zo.get(Ye),v.init(),T.push(v),Ye.traverseVisible(function(li){li.isLight&&li.layers.test(Gt.layers)&&(v.pushLight(li),li.castShadow&&v.pushShadow(li))}),v.setupLights(I.physicallyCorrectLights),Ye.traverse(function(li){const ni=li.material;if(ni)if(Array.isArray(ni))for(let Li=0;Li<ni.length;Li++)wz(ni[Li],Ye,li);else wz(ni,Ye,li)}),T.pop(),v=null};let Ii=null;function io(){$h.stop()}function $a(){$h.start()}const $h=new SZ;function dl(Ye,Gt,li,ni){if(!1===Ye.visible)return;if(Ye.layers.test(Gt.layers))if(Ye.isGroup)li=Ye.renderOrder;else if(Ye.isLOD)!0===Ye.autoUpdate&&Ye.update(Gt);else if(Ye.isLight)v.pushLight(Ye),Ye.castShadow&&v.pushShadow(Ye);else if(Ye.isSprite){if(!Ye.frustumCulled||vt.intersectsSprite(Ye)){ni&&mi.setFromMatrixPosition(Ye.matrixWorld).applyMatrix4(ct);const ys=is.update(Ye),zs=Ye.material;zs.visible&&_.push(Ye,ys,zs,li,mi.z,null)}}else if((Ye.isMesh||Ye.isLine||Ye.isPoints)&&(Ye.isSkinnedMesh&&Ye.skeleton.frame!==ts.render.frame&&(Ye.skeleton.update(),Ye.skeleton.frame=ts.render.frame),!Ye.frustumCulled||vt.intersectsObject(Ye))){ni&&mi.setFromMatrixPosition(Ye.matrixWorld).applyMatrix4(ct);const ys=is.update(Ye),zs=Ye.material;if(Array.isArray(zs)){const Rs=ys.groups;for(let Ho=0,go=Rs.length;Ho<go;Ho++){const wo=Rs[Ho],fl=zs[wo.materialIndex];fl&&fl.visible&&_.push(Ye,ys,fl,li,mi.z,wo)}}else zs.visible&&_.push(Ye,ys,zs,li,mi.z,null)}const fs=Ye.children;for(let ys=0,zs=fs.length;ys<zs;ys++)dl(fs[ys],Gt,li,ni)}function qp(Ye,Gt,li,ni){const Li=Ye.opaque,fs=Ye.transmissive,ys=Ye.transparent;v.setupLightsView(li),fs.length>0&&function Og(Ye,Gt,li){null===Ht&&(Ht=new(!0===a&&!0===Un.isWebGL2?e2:Hh)(1024,1024,{generateMipmaps:!0,type:null!==Lr.convert(p0)?p0:mg,minFilter:f0,magFilter:Dl,wrapS:Kc,wrapT:Kc,useRenderToTexture:nn.has("WEBGL_multisampled_render_to_texture")}));const ni=I.getRenderTarget();I.setRenderTarget(Ht),I.clear();const Li=I.toneMapping;I.toneMapping=pg,CL(Ye,Gt,li),I.toneMapping=Li,Ri.updateMultisampleRenderTarget(Ht),Ri.updateRenderTargetMipmap(Ht),I.setRenderTarget(ni)}(Li,Gt,li),ni&&Cn.viewport(ye.copy(ni)),Li.length>0&&CL(Li,Gt,li),fs.length>0&&CL(fs,Gt,li),ys.length>0&&CL(ys,Gt,li)}function CL(Ye,Gt,li){const ni=!0===Gt.isScene?Gt.overrideMaterial:null;for(let Li=0,fs=Ye.length;Li<fs;Li++){const ys=Ye[Li],zs=ys.object,Rs=ys.geometry,Ho=null===ni?ys.material:ni,go=ys.group;zs.layers.test(li.layers)&&BOe(zs,Gt,li,Rs,Ho,go)}}function BOe(Ye,Gt,li,ni,Li,fs){Ye.onBeforeRender(I,Gt,li,ni,Li,fs),Ye.modelViewMatrix.multiplyMatrices(li.matrixWorldInverse,Ye.matrixWorld),Ye.normalMatrix.getNormalMatrix(Ye.modelViewMatrix),Li.onBeforeRender(I,Gt,li,ni,Ye,fs),!0===Li.transparent&&Li.side===c0?(Li.side=Al,Li.needsUpdate=!0,I.renderBufferDirect(li,Gt,ni,Li,Ye,fs),Li.side=l0,Li.needsUpdate=!0,I.renderBufferDirect(li,Gt,ni,Li,Ye,fs),Li.side=c0):I.renderBufferDirect(li,Gt,ni,Li,Ye,fs),Ye.onAfterRender(I,Gt,li,ni,Li,fs)}function wz(Ye,Gt,li){!0!==Gt.isScene&&(Gt=Zi);const ni=Hr.get(Ye),Li=v.state.lights,ys=Li.state.version,zs=ls.getParameters(Ye,Li.state,v.state.shadowsArray,Gt,li),Rs=ls.getProgramCacheKey(zs);let Ho=ni.programs;ni.environment=Ye.isMeshStandardMaterial?Gt.environment:null,ni.fog=Gt.fog,ni.envMap=(Ye.isMeshStandardMaterial?sn:fn).get(Ye.envMap||ni.environment),void 0===Ho&&(Ye.addEventListener("dispose",lr),Ho=new Map,ni.programs=Ho);let go=Ho.get(Rs);if(void 0!==go){if(ni.currentProgram===go&&ni.lightsStateVersion===ys)return Mee(Ye,zs),go}else zs.uniforms=ls.getUniforms(Ye),Ye.onBuild(li,zs,I),Ye.onBeforeCompile(zs,I),go=ls.acquireProgram(zs,Rs),Ho.set(Rs,go),ni.uniforms=zs.uniforms;const wo=ni.uniforms;(!Ye.isShaderMaterial&&!Ye.isRawShaderMaterial||!0===Ye.clipping)&&(wo.clippingPlanes=ot.uniform),Mee(Ye,zs),ni.needsLights=function VOe(Ye){return Ye.isMeshLambertMaterial||Ye.isMeshToonMaterial||Ye.isMeshPhongMaterial||Ye.isMeshStandardMaterial||Ye.isShadowMaterial||Ye.isShaderMaterial&&!0===Ye.lights}(Ye),ni.lightsStateVersion=ys,ni.needsLights&&(wo.ambientLightColor.value=Li.state.ambient,wo.lightProbe.value=Li.state.probe,wo.directionalLights.value=Li.state.directional,wo.directionalLightShadows.value=Li.state.directionalShadow,wo.spotLights.value=Li.state.spot,wo.spotLightShadows.value=Li.state.spotShadow,wo.rectAreaLights.value=Li.state.rectArea,wo.ltc_1.value=Li.state.rectAreaLTC1,wo.ltc_2.value=Li.state.rectAreaLTC2,wo.pointLights.value=Li.state.point,wo.pointLightShadows.value=Li.state.pointShadow,wo.hemisphereLights.value=Li.state.hemi,wo.directionalShadowMap.value=Li.state.directionalShadowMap,wo.directionalShadowMatrix.value=Li.state.directionalShadowMatrix,wo.spotShadowMap.value=Li.state.spotShadowMap,wo.spotShadowMatrix.value=Li.state.spotShadowMatrix,wo.pointShadowMap.value=Li.state.pointShadowMap,wo.pointShadowMatrix.value=Li.state.pointShadowMatrix);const fl=go.getUniforms(),Y0=zy.seqWithValue(fl.seq,wo);return ni.currentProgram=go,ni.uniformsList=Y0,go}function Mee(Ye,Gt){const li=Hr.get(Ye);li.outputEncoding=Gt.outputEncoding,li.instancing=Gt.instancing,li.skinning=Gt.skinning,li.morphTargets=Gt.morphTargets,li.morphNormals=Gt.morphNormals,li.morphTargetsCount=Gt.morphTargetsCount,li.numClippingPlanes=Gt.numClippingPlanes,li.numIntersection=Gt.numClipIntersection,li.vertexAlphas=Gt.vertexAlphas,li.vertexTangents=Gt.vertexTangents,li.toneMapping=Gt.toneMapping}$h.setAnimationLoop(function Vr(Ye){Ii&&Ii(Ye)}),"undefined"!=typeof window&&$h.setContext(window),this.setAnimationLoop=function(Ye){Ii=Ye,An.setAnimationLoop(Ye),null===Ye?$h.stop():$h.start()},An.addEventListener("sessionstart",io),An.addEventListener("sessionend",$a),this.render=function(Ye,Gt){if(void 0===Gt||!0===Gt.isCamera){if(!0!==j){if(!0===Ye.autoUpdate&&Ye.updateMatrixWorld(),null===Gt.parent&&Gt.updateMatrixWorld(),!0===An.enabled&&!0===An.isPresenting&&(!0===An.cameraAutoUpdate&&An.updateCamera(Gt),Gt=An.getCamera()),!0===Ye.isScene&&Ye.onBeforeRender(I,Ye,Gt,ie),v=Zo.get(Ye,T.length),v.init(),T.push(v),ct.multiplyMatrices(Gt.projectionMatrix,Gt.matrixWorldInverse),vt.setFromProjectionMatrix(ct),pi=this.localClippingEnabled,kt=ot.init(this.clippingPlanes,pi,Gt),_=sa.get(Ye,S.length),_.init(),S.push(_),dl(Ye,Gt,0,I.sortObjects),_.finish(),!0===I.sortObjects&&_.sort(Je,mt),!0===kt&&ot.beginShadows(),Xe.render(v.state.shadowsArray,Ye,Gt),!0===kt&&ot.endShadows(),!0===this.info.autoReset&&this.info.reset(),Ti.render(_,Ye),v.setupLights(I.physicallyCorrectLights),Gt.isArrayCamera){const ni=Gt.cameras;for(let Li=0,fs=ni.length;Li<fs;Li++){const ys=ni[Li];qp(_,Ye,ys,ys.viewport)}}else qp(_,Ye,Gt);null!==ie&&(Ri.updateMultisampleRenderTarget(ie),Ri.updateRenderTargetMipmap(ie)),!0===Ye.isScene&&Ye.onAfterRender(I,Ye,Gt),Cn.buffers.depth.setTest(!0),Cn.buffers.depth.setMask(!0),Cn.buffers.color.setMask(!0),Cn.setPolygonOffset(!1),br.resetDefaultState(),ee=-1,ce=null,T.pop(),v=T.length>0?T[T.length-1]:null,S.pop(),_=S.length>0?S[S.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return P},this.getActiveMipmapLevel=function(){return E},this.getRenderTarget=function(){return ie},this.setRenderTargetTextures=function(Ye,Gt,li){Hr.get(Ye.texture).__webglTexture=Gt,Hr.get(Ye.depthTexture).__webglTexture=li;const ni=Hr.get(Ye);ni.__hasExternalTextures=!0,ni.__hasExternalTextures&&(ni.__autoAllocateDepthBuffer=void 0===li,ni.__autoAllocateDepthBuffer||Ye.useRenderToTexture&&(console.warn("render-to-texture extension was disabled because an external texture was provided"),Ye.useRenderToTexture=!1,Ye.useRenderbuffer=!0))},this.setRenderTargetFramebuffer=function(Ye,Gt){const li=Hr.get(Ye);li.__webglFramebuffer=Gt,li.__useDefaultFramebuffer=void 0===Gt},this.setRenderTarget=function(Ye,Gt=0,li=0){ie=Ye,P=Gt,E=li;let ni=!0;if(Ye){const Rs=Hr.get(Ye);void 0!==Rs.__useDefaultFramebuffer?(Cn.bindFramebuffer(36160,null),ni=!1):void 0===Rs.__webglFramebuffer?Ri.setupRenderTarget(Ye):Rs.__hasExternalTextures&&Ri.rebindTextures(Ye,Hr.get(Ye.texture).__webglTexture,Hr.get(Ye.depthTexture).__webglTexture)}let Li=null,fs=!1,ys=!1;if(Ye){const Rs=Ye.texture;(Rs.isDataTexture3D||Rs.isDataTexture2DArray)&&(ys=!0);const Ho=Hr.get(Ye).__webglFramebuffer;Ye.isWebGLCubeRenderTarget?(Li=Ho[Gt],fs=!0):Li=Ye.useRenderbuffer?Hr.get(Ye).__webglMultisampledFramebuffer:Ho,ye.copy(Ye.viewport),Ce.copy(Ye.scissor),Ge=Ye.scissorTest}else ye.copy(pt).multiplyScalar(ge).floor(),Ce.copy(Pt).multiplyScalar(ge).floor(),Ge=et;if(Cn.bindFramebuffer(36160,Li)&&Un.drawBuffers&&ni&&Cn.drawBuffers(Ye,Li),Cn.viewport(ye),Cn.scissor(Ce),Cn.setScissorTest(Ge),fs){const Rs=Hr.get(Ye.texture);Zt.framebufferTexture2D(36160,36064,34069+Gt,Rs.__webglTexture,li)}else if(ys){const Rs=Hr.get(Ye.texture);Zt.framebufferTextureLayer(36160,36064,Rs.__webglTexture,li||0,Gt||0)}ee=-1},this.readRenderTargetPixels=function(Ye,Gt,li,ni,Li,fs,ys){if(!Ye||!Ye.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let zs=Hr.get(Ye).__webglFramebuffer;if(Ye.isWebGLCubeRenderTarget&&void 0!==ys&&(zs=zs[ys]),zs){Cn.bindFramebuffer(36160,zs);try{const Rs=Ye.texture,Ho=Rs.format,go=Rs.type;if(Ho!==Qc&&Lr.convert(Ho)!==Zt.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const wo=go===p0&&(nn.has("EXT_color_buffer_half_float")||Un.isWebGL2&&nn.has("EXT_color_buffer_float"));if(!(go===mg||Lr.convert(go)===Zt.getParameter(35738)||go===gg&&(Un.isWebGL2||nn.has("OES_texture_float")||nn.has("WEBGL_color_buffer_float"))||wo))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===Zt.checkFramebufferStatus(36160)?Gt>=0&&Gt<=Ye.width-ni&&li>=0&&li<=Ye.height-Li&&Zt.readPixels(Gt,li,ni,Li,Lr.convert(Ho),Lr.convert(go),fs):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{const Rs=null!==ie?Hr.get(ie).__webglFramebuffer:null;Cn.bindFramebuffer(36160,Rs)}}},this.copyFramebufferToTexture=function(Ye,Gt,li=0){if(!0!==Gt.isFramebufferTexture)return void console.error("THREE.WebGLRenderer: copyFramebufferToTexture() can only be used with FramebufferTexture.");const ni=Math.pow(2,-li),Li=Math.floor(Gt.image.width*ni),fs=Math.floor(Gt.image.height*ni);Ri.setTexture2D(Gt,0),Zt.copyTexSubImage2D(3553,li,0,0,Ye.x,Ye.y,Li,fs),Cn.unbindTexture()},this.copyTextureToTexture=function(Ye,Gt,li,ni=0){const Li=Gt.image.width,fs=Gt.image.height,ys=Lr.convert(li.format),zs=Lr.convert(li.type);Ri.setTexture2D(li,0),Zt.pixelStorei(37440,li.flipY),Zt.pixelStorei(37441,li.premultiplyAlpha),Zt.pixelStorei(3317,li.unpackAlignment),Gt.isDataTexture?Zt.texSubImage2D(3553,ni,Ye.x,Ye.y,Li,fs,ys,zs,Gt.image.data):Gt.isCompressedTexture?Zt.compressedTexSubImage2D(3553,ni,Ye.x,Ye.y,Gt.mipmaps[0].width,Gt.mipmaps[0].height,ys,Gt.mipmaps[0].data):Zt.texSubImage2D(3553,ni,Ye.x,Ye.y,ys,zs,Gt.image),0===ni&&li.generateMipmaps&&Zt.generateMipmap(3553),Cn.unbindTexture()},this.copyTextureToTexture3D=function(Ye,Gt,li,ni,Li=0){if(I.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const fs=Ye.max.x-Ye.min.x+1,ys=Ye.max.y-Ye.min.y+1,zs=Ye.max.z-Ye.min.z+1,Rs=Lr.convert(ni.format),Ho=Lr.convert(ni.type);let go;if(ni.isDataTexture3D)Ri.setTexture3D(ni,0),go=32879;else{if(!ni.isDataTexture2DArray)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");Ri.setTexture2DArray(ni,0),go=35866}Zt.pixelStorei(37440,ni.flipY),Zt.pixelStorei(37441,ni.premultiplyAlpha),Zt.pixelStorei(3317,ni.unpackAlignment);const wo=Zt.getParameter(3314),fl=Zt.getParameter(32878),Y0=Zt.getParameter(3316),yC=Zt.getParameter(3315),To=Zt.getParameter(32877),Xp=li.isCompressedTexture?li.mipmaps[0]:li.image;Zt.pixelStorei(3314,Xp.width),Zt.pixelStorei(32878,Xp.height),Zt.pixelStorei(3316,Ye.min.x),Zt.pixelStorei(3315,Ye.min.y),Zt.pixelStorei(32877,Ye.min.z),li.isDataTexture||li.isDataTexture3D?Zt.texSubImage3D(go,Li,Gt.x,Gt.y,Gt.z,fs,ys,zs,Rs,Ho,Xp.data):li.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Zt.compressedTexSubImage3D(go,Li,Gt.x,Gt.y,Gt.z,fs,ys,zs,Rs,Xp.data)):Zt.texSubImage3D(go,Li,Gt.x,Gt.y,Gt.z,fs,ys,zs,Rs,Ho,Xp),Zt.pixelStorei(3314,wo),Zt.pixelStorei(32878,fl),Zt.pixelStorei(3316,Y0),Zt.pixelStorei(3315,yC),Zt.pixelStorei(32877,To),0===Li&&ni.generateMipmaps&&Zt.generateMipmap(go),Cn.unbindTexture()},this.initTexture=function(Ye){Ri.setTexture2D(Ye,0),Cn.unbindTexture()},this.resetState=function(){P=0,E=0,ie=null,Cn.reset(),br.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Io.prototype.isWebGLRenderer=!0;class nY extends Io{}nY.prototype.isWebGL1Renderer=!0;class QT{constructor(t,e=25e-5){this.name="",this.color=new En(t),this.density=e}clone(){return new QT(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}QT.prototype.isFogExp2=!0;class JT{constructor(t,e=1,n=1e3){this.name="",this.color=new En(t),this.near=e,this.far=n}clone(){return new JT(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}JT.prototype.isFog=!0;class $T extends Zs{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,e){return super.copy(t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){const e=super.toJSON(t);return null!==this.fog&&(e.object.fog=this.fog.toJSON()),e}}$T.prototype.isScene=!0;class A0{constructor(t,e){this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.usage=bS,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Nh()}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this}copyAt(t,e,n){t*=this.stride,n*=e.stride;for(let r=0,s=this.stride;r<s;r++)this.array[t+r]=e.array[n+r];return this}set(t,e=0){return this.array.set(t,e),this}clone(t){void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Nh()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const e=new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(e,this.stride);return n.setUsage(this.usage),n}onUpload(t){return this.onUploadCallback=t,this}toJSON(t){return void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Nh()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}A0.prototype.isInterleavedBuffer=!0;const kl=new He;class Uy{constructor(t,e,n,r=!1){this.name="",this.data=t,this.itemSize=e,this.offset=n,this.normalized=!0===r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(t){this.data.needsUpdate=t}applyMatrix4(t){for(let e=0,n=this.data.count;e<n;e++)kl.x=this.getX(e),kl.y=this.getY(e),kl.z=this.getZ(e),kl.applyMatrix4(t),this.setXYZ(e,kl.x,kl.y,kl.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)kl.x=this.getX(e),kl.y=this.getY(e),kl.z=this.getZ(e),kl.applyNormalMatrix(t),this.setXYZ(e,kl.x,kl.y,kl.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)kl.x=this.getX(e),kl.y=this.getY(e),kl.z=this.getZ(e),kl.transformDirection(t),this.setXYZ(e,kl.x,kl.y,kl.z);return this}setX(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this}setY(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this}setZ(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this}setW(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this}getX(t){return this.data.array[t*this.data.stride+this.offset]}getY(t){return this.data.array[t*this.data.stride+this.offset+1]}getZ(t){return this.data.array[t*this.data.stride+this.offset+2]}getW(t){return this.data.array[t*this.data.stride+this.offset+3]}setXY(t,e,n){return this.data.array[(t=t*this.data.stride+this.offset)+0]=e,this.data.array[t+1]=n,this}setXYZ(t,e,n,r){return this.data.array[(t=t*this.data.stride+this.offset)+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this}setXYZW(t,e,n,r,s){return this.data.array[(t=t*this.data.stride+this.offset)+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this.data.array[t+3]=s,this}clone(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const e=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)e.push(this.data.array[r+s])}return new lo(new this.array.constructor(e),this.itemSize,this.normalized)}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new Uy(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const e=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)e.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}Uy.prototype.isInterleavedBufferAttribute=!0;class k2 extends kc{constructor(t){super(),this.type="SpriteMaterial",this.color=new En(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this}}let WS;k2.prototype.isSpriteMaterial=!0;const eE=new He,jS=new He,qS=new He,XS=new Oi,tE=new Oi,rY=new nr,P2=new He,iE=new He,I2=new He,sY=new Oi,T5=new Oi,oY=new Oi;class L2 extends Zs{constructor(t){if(super(),this.type="Sprite",void 0===WS){WS=new Ir;const e=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new A0(e,5);WS.setIndex([0,1,2,0,2,3]),WS.setAttribute("position",new Uy(n,3,0,!1)),WS.setAttribute("uv",new Uy(n,2,3,!1))}this.geometry=WS,this.material=void 0!==t?t:new k2,this.center=new Oi(.5,.5)}raycast(t,e){null===t.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),jS.setFromMatrixScale(this.matrixWorld),rY.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),qS.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&jS.multiplyScalar(-qS.z);const n=this.material.rotation;let r,s;0!==n&&(s=Math.cos(n),r=Math.sin(n));const a=this.center;O2(P2.set(-.5,-.5,0),qS,a,jS,r,s),O2(iE.set(.5,-.5,0),qS,a,jS,r,s),O2(I2.set(.5,.5,0),qS,a,jS,r,s),sY.set(0,0),T5.set(1,0),oY.set(1,1);let l=t.ray.intersectTriangle(P2,iE,I2,!1,eE);if(null===l&&(O2(iE.set(-.5,.5,0),qS,a,jS,r,s),T5.set(0,1),l=t.ray.intersectTriangle(P2,I2,iE,!1,eE),null===l))return;const u=t.ray.origin.distanceTo(eE);u<t.near||u>t.far||e.push({distance:u,point:eE.clone(),uv:Rl.getUV(eE,P2,iE,I2,sY,T5,oY,new Oi),face:null,object:this})}copy(t){return super.copy(t),void 0!==t.center&&this.center.copy(t.center),this.material=t.material,this}}function O2(i,t,e,n,r,s){XS.subVectors(i,e).addScalar(.5).multiply(n),void 0!==r?(tE.x=s*XS.x-r*XS.y,tE.y=r*XS.x+s*XS.y):tE.copy(XS),i.copy(t),i.x+=tE.x,i.y+=tE.y,i.applyMatrix4(rY)}L2.prototype.isSprite=!0;const F2=new He,aY=new He;class lY extends Zs{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(t){super.copy(t,!1);const e=t.levels;for(let n=0,r=e.length;n<r;n++){const s=e[n];this.addLevel(s.object.clone(),s.distance)}return this.autoUpdate=t.autoUpdate,this}addLevel(t,e=0){e=Math.abs(e);const n=this.levels;let r;for(r=0;r<n.length&&!(e<n[r].distance);r++);return n.splice(r,0,{distance:e,object:t}),this.add(t),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(t){const e=this.levels;if(e.length>0){let n,r;for(n=1,r=e.length;n<r&&!(t<e[n].distance);n++);return e[n-1].object}return null}raycast(t,e){if(this.levels.length>0){F2.setFromMatrixPosition(this.matrixWorld);const r=t.ray.origin.distanceTo(F2);this.getObjectForDistance(r).raycast(t,e)}}update(t){const e=this.levels;if(e.length>1){F2.setFromMatrixPosition(t.matrixWorld),aY.setFromMatrixPosition(this.matrixWorld);const n=F2.distanceTo(aY)/t.zoom;let r,s;for(e[0].object.visible=!0,r=1,s=e.length;r<s&&n>=e[r].distance;r++)e[r-1].object.visible=!1,e[r].object.visible=!0;for(this._currentLevel=r-1;r<s;r++)e[r].object.visible=!1}}toJSON(t){const e=super.toJSON(t);!1===this.autoUpdate&&(e.object.autoUpdate=!1),e.object.levels=[];const n=this.levels;for(let r=0,s=n.length;r<s;r++){const a=n[r];e.object.levels.push({object:a.object.uuid,distance:a.distance})}return e}}const cY=new He,uY=new Bo,hY=new Bo,Zwe=new He,dY=new nr;class B2 extends Qa{constructor(t,e){super(t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new nr,this.bindMatrixInverse=new nr}copy(t){return super.copy(t),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,this}bind(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.copy(e).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const t=new Bo,e=this.geometry.attributes.skinWeight;for(let n=0,r=e.count;n<r;n++){t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.w=e.getW(n);const s=1/t.manhattanLength();s!==1/0?t.multiplyScalar(s):t.set(1,0,0,0),e.setXYZW(n,t.x,t.y,t.z,t.w)}}updateMatrixWorld(t){super.updateMatrixWorld(t),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(t,e){const n=this.skeleton,r=this.geometry;uY.fromBufferAttribute(r.attributes.skinIndex,t),hY.fromBufferAttribute(r.attributes.skinWeight,t),cY.copy(e).applyMatrix4(this.bindMatrix),e.set(0,0,0);for(let s=0;s<4;s++){const a=hY.getComponent(s);if(0!==a){const l=uY.getComponent(s);dY.multiplyMatrices(n.bones[l].matrixWorld,n.boneInverses[l]),e.addScaledVector(Zwe.copy(cY).applyMatrix4(dY),a)}}return e.applyMatrix4(this.bindMatrixInverse)}}B2.prototype.isSkinnedMesh=!0;class N2 extends Zs{constructor(){super(),this.type="Bone"}}N2.prototype.isBone=!0;class D0 extends Jl{constructor(t=null,e=1,n=1,r,s,a,l,u,h=Dl,m=Dl,_,v){super(null,a,l,u,h,m,r,s,_,v),this.image={data:t,width:e,height:n},this.magFilter=h,this.minFilter=m,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}D0.prototype.isDataTexture=!0;const fY=new nr,Ywe=new nr;class H2{constructor(t=[],e=[]){this.uuid=Nh(),this.bones=t.slice(0),this.boneInverses=e,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const t=this.bones,e=this.boneInverses;if(this.boneMatrices=new Float32Array(16*t.length),0===e.length)this.calculateInverses();else if(t.length!==e.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new nr)}}calculateInverses(){this.boneInverses.length=0;for(let t=0,e=this.bones.length;t<e;t++){const n=new nr;this.bones[t]&&n.copy(this.bones[t].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let t=0,e=this.bones.length;t<e;t++){const n=this.bones[t];n&&n.matrixWorld.copy(this.boneInverses[t]).invert()}for(let t=0,e=this.bones.length;t<e;t++){const n=this.bones[t];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const t=this.bones,e=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let s=0,a=t.length;s<a;s++)fY.multiplyMatrices(t[s]?t[s].matrixWorld:Ywe,e[s]),fY.toArray(n,16*s);null!==r&&(r.needsUpdate=!0)}clone(){return new H2(this.bones,this.boneInverses)}computeBoneTexture(){let t=Math.sqrt(4*this.bones.length);t=JX(t),t=Math.max(t,4);const e=new Float32Array(t*t*4);e.set(this.boneMatrices);const n=new D0(e,t,t,Qc,gg);return n.needsUpdate=!0,this.boneMatrices=e,this.boneTexture=n,this.boneTextureSize=t,this}getBoneByName(t){for(let e=0,n=this.bones.length;e<n;e++){const r=this.bones[e];if(r.name===t)return r}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(t,e){this.uuid=t.uuid;for(let n=0,r=t.bones.length;n<r;n++){const s=t.bones[n];let a=e[s];void 0===a&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),a=new N2),this.bones.push(a),this.boneInverses.push((new nr).fromArray(t.boneInverses[n]))}return this.init(),this}toJSON(){const t={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};t.uuid=this.uuid;const e=this.bones,n=this.boneInverses;for(let r=0,s=e.length;r<s;r++)t.bones.push(e[r].uuid),t.boneInverses.push(n[r].toArray());return t}}class R0 extends lo{constructor(t,e,n,r=1){"number"==typeof n&&(r=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(t,e,n),this.meshPerAttribute=r}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}toJSON(){const t=super.toJSON();return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}R0.prototype.isInstancedBufferAttribute=!0;const pY=new nr,mY=new nr,V2=[],nE=new Qa;class E5 extends Qa{constructor(t,e,n){super(t,e),this.instanceMatrix=new R0(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}copy(t){return super.copy(t),this.instanceMatrix.copy(t.instanceMatrix),null!==t.instanceColor&&(this.instanceColor=t.instanceColor.clone()),this.count=t.count,this}getColorAt(t,e){e.fromArray(this.instanceColor.array,3*t)}getMatrixAt(t,e){e.fromArray(this.instanceMatrix.array,16*t)}raycast(t,e){const n=this.matrixWorld,r=this.count;if(nE.geometry=this.geometry,nE.material=this.material,void 0!==nE.material)for(let s=0;s<r;s++){this.getMatrixAt(s,pY),mY.multiplyMatrices(n,pY),nE.matrixWorld=mY,nE.raycast(t,V2);for(let a=0,l=V2.length;a<l;a++){const u=V2[a];u.instanceId=s,u.object=this,e.push(u)}V2.length=0}}setColorAt(t,e){null===this.instanceColor&&(this.instanceColor=new R0(new Float32Array(3*this.instanceMatrix.count),3)),e.toArray(this.instanceColor.array,3*t)}setMatrixAt(t,e){e.toArray(this.instanceMatrix.array,16*t)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}E5.prototype.isInstancedMesh=!0;class Ic extends kc{constructor(t){super(),this.type="LineBasicMaterial",this.color=new En(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this}}Ic.prototype.isLineBasicMaterial=!0;const gY=new He,_Y=new He,yY=new nr,A5=new Oy,z2=new Iy;class Tg extends Zs{constructor(t=new Ir,e=new Ic){super(),this.type="Line",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t){return super.copy(t),this.material=t.material,this.geometry=t.geometry,this}computeLineDistances(){const t=this.geometry;if(t.isBufferGeometry)if(null===t.index){const e=t.attributes.position,n=[0];for(let r=1,s=e.count;r<s;r++)gY.fromBufferAttribute(e,r-1),_Y.fromBufferAttribute(e,r),n[r]=n[r-1],n[r]+=gY.distanceTo(_Y);t.setAttribute("lineDistance",new Jn(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(t,e){const n=this.geometry,r=this.matrixWorld,s=t.params.Line.threshold,a=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),z2.copy(n.boundingSphere),z2.applyMatrix4(r),z2.radius+=s,!1===t.ray.intersectsSphere(z2))return;yY.copy(r).invert(),A5.copy(t.ray).applyMatrix4(yY);const l=s/((this.scale.x+this.scale.y+this.scale.z)/3),u=l*l,h=new He,m=new He,_=new He,v=new He,S=this.isLineSegments?2:1;if(n.isBufferGeometry){const T=n.index,j=n.attributes.position;if(null!==T)for(let ie=Math.max(0,a.start),ee=Math.min(T.count,a.start+a.count)-1;ie<ee;ie+=S){const ce=T.getX(ie),ye=T.getX(ie+1);if(h.fromBufferAttribute(j,ce),m.fromBufferAttribute(j,ye),A5.distanceSqToSegment(h,m,v,_)>u)continue;v.applyMatrix4(this.matrixWorld);const Ge=t.ray.origin.distanceTo(v);Ge<t.near||Ge>t.far||e.push({distance:Ge,point:_.clone().applyMatrix4(this.matrixWorld),index:ie,face:null,faceIndex:null,object:this})}else for(let ie=Math.max(0,a.start),ee=Math.min(j.count,a.start+a.count)-1;ie<ee;ie+=S){if(h.fromBufferAttribute(j,ie),m.fromBufferAttribute(j,ie+1),A5.distanceSqToSegment(h,m,v,_)>u)continue;v.applyMatrix4(this.matrixWorld);const ye=t.ray.origin.distanceTo(v);ye<t.near||ye>t.far||e.push({distance:ye,point:_.clone().applyMatrix4(this.matrixWorld),index:ie,face:null,faceIndex:null,object:this})}}else n.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const r=e[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=r.length;s<a;s++){const l=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=s}}}}else{const e=t.morphTargets;void 0!==e&&e.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}Tg.prototype.isLine=!0;const vY=new He,bY=new He;class ph extends Tg{constructor(t,e){super(t,e),this.type="LineSegments"}computeLineDistances(){const t=this.geometry;if(t.isBufferGeometry)if(null===t.index){const e=t.attributes.position,n=[];for(let r=0,s=e.count;r<s;r+=2)vY.fromBufferAttribute(e,r),bY.fromBufferAttribute(e,r+1),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+vY.distanceTo(bY);t.setAttribute("lineDistance",new Jn(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}ph.prototype.isLineSegments=!0;class D5 extends Tg{constructor(t,e){super(t,e),this.type="LineLoop"}}D5.prototype.isLineLoop=!0;class k0 extends kc{constructor(t){super(),this.type="PointsMaterial",this.color=new En(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this}}k0.prototype.isPointsMaterial=!0;const xY=new nr,R5=new Oy,U2=new Iy,G2=new He;class rE extends Zs{constructor(t=new Ir,e=new k0){super(),this.type="Points",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t){return super.copy(t),this.material=t.material,this.geometry=t.geometry,this}raycast(t,e){const n=this.geometry,r=this.matrixWorld,s=t.params.Points.threshold,a=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),U2.copy(n.boundingSphere),U2.applyMatrix4(r),U2.radius+=s,!1===t.ray.intersectsSphere(U2))return;xY.copy(r).invert(),R5.copy(t.ray).applyMatrix4(xY);const l=s/((this.scale.x+this.scale.y+this.scale.z)/3),u=l*l;if(n.isBufferGeometry){const h=n.index,_=n.attributes.position;if(null!==h)for(let T=Math.max(0,a.start),I=Math.min(h.count,a.start+a.count);T<I;T++){const j=h.getX(T);G2.fromBufferAttribute(_,j),wY(G2,j,u,r,t,e,this)}else for(let T=Math.max(0,a.start),I=Math.min(_.count,a.start+a.count);T<I;T++)G2.fromBufferAttribute(_,T),wY(G2,T,u,r,t,e,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const r=e[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=r.length;s<a;s++){const l=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=s}}}}else{const e=t.morphTargets;void 0!==e&&e.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}function wY(i,t,e,n,r,s,a){const l=R5.distanceSqToPoint(i);if(l<e){const u=new He;R5.closestPointToPoint(i,u),u.applyMatrix4(n);const h=r.ray.origin.distanceTo(u);if(h<r.near||h>r.far)return;s.push({distance:h,distanceToRay:Math.sqrt(l),point:u,index:t,face:null,object:a})}}rE.prototype.isPoints=!0;class SY extends Jl{constructor(t,e,n,r,s,a,l,u,h){super(t,e,n,r,s,a,l,u,h),this.minFilter=void 0!==a?a:Ka,this.magFilter=void 0!==s?s:Ka,this.generateMipmaps=!1;const m=this;"requestVideoFrameCallback"in t&&t.requestVideoFrameCallback(function _(){m.needsUpdate=!0,t.requestVideoFrameCallback(_)})}clone(){return new this.constructor(this.image).copy(this)}update(){const t=this.image;"requestVideoFrameCallback"in t==0&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}SY.prototype.isVideoTexture=!0;class CY extends Jl{constructor(t,e,n){super({width:t,height:e}),this.format=n,this.magFilter=Dl,this.minFilter=Dl,this.generateMipmaps=!1,this.needsUpdate=!0}}CY.prototype.isFramebufferTexture=!0;class k5 extends Jl{constructor(t,e,n,r,s,a,l,u,h,m,_,v){super(null,a,l,u,h,m,r,s,_,v),this.image={width:e,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}}k5.prototype.isCompressedTexture=!0;class MY extends Jl{constructor(t,e,n,r,s,a,l,u,h){super(t,e,n,r,s,a,l,u,h),this.needsUpdate=!0}}MY.prototype.isCanvasTexture=!0;class ZS extends Ir{constructor(t=1,e=8,n=0,r=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:r},e=Math.max(3,e);const s=[],a=[],l=[],u=[],h=new He,m=new Oi;a.push(0,0,0),l.push(0,0,1),u.push(.5,.5);for(let _=0,v=3;_<=e;_++,v+=3){const S=n+_/e*r;h.x=t*Math.cos(S),h.y=t*Math.sin(S),a.push(h.x,h.y,h.z),l.push(0,0,1),m.x=(a[v]/t+1)/2,m.y=(a[v+1]/t+1)/2,u.push(m.x,m.y)}for(let _=1;_<=e;_++)s.push(_,_+1,0);this.setIndex(s),this.setAttribute("position",new Jn(a,3)),this.setAttribute("normal",new Jn(l,3)),this.setAttribute("uv",new Jn(u,2))}static fromJSON(t){return new ZS(t.radius,t.segments,t.thetaStart,t.thetaLength)}}class Gy extends Ir{constructor(t=1,e=1,n=1,r=8,s=1,a=!1,l=0,u=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:r,heightSegments:s,openEnded:a,thetaStart:l,thetaLength:u};const h=this;r=Math.floor(r),s=Math.floor(s);const m=[],_=[],v=[],S=[];let T=0;const I=[],j=n/2;let P=0;function ie(ee){const ce=T,ye=new Oi,Ce=new He;let Ge=0;const Qe=!0===ee?t:e,nt=!0===ee?1:-1;for(let Je=1;Je<=r;Je++)_.push(0,j*nt,0),v.push(0,nt,0),S.push(.5,.5),T++;const ge=T;for(let Je=0;Je<=r;Je++){const pt=Je/r*u+l,Pt=Math.cos(pt),et=Math.sin(pt);Ce.x=Qe*et,Ce.y=j*nt,Ce.z=Qe*Pt,_.push(Ce.x,Ce.y,Ce.z),v.push(0,nt,0),ye.x=.5*Pt+.5,ye.y=.5*et*nt+.5,S.push(ye.x,ye.y),T++}for(let Je=0;Je<r;Je++){const mt=ce+Je,pt=ge+Je;!0===ee?m.push(pt,pt+1,mt):m.push(pt+1,pt,mt),Ge+=3}h.addGroup(P,Ge,!0===ee?1:2),P+=Ge}(function E(){const ee=new He,ce=new He;let ye=0;const Ce=(e-t)/n;for(let Ge=0;Ge<=s;Ge++){const Qe=[],nt=Ge/s,ge=nt*(e-t)+t;for(let Je=0;Je<=r;Je++){const mt=Je/r,pt=mt*u+l,Pt=Math.sin(pt),et=Math.cos(pt);ce.x=ge*Pt,ce.y=-nt*n+j,ce.z=ge*et,_.push(ce.x,ce.y,ce.z),ee.set(Pt,Ce,et).normalize(),v.push(ee.x,ee.y,ee.z),S.push(mt,1-nt),Qe.push(T++)}I.push(Qe)}for(let Ge=0;Ge<r;Ge++)for(let Qe=0;Qe<s;Qe++){const ge=I[Qe+1][Ge],Je=I[Qe+1][Ge+1],mt=I[Qe][Ge+1];m.push(I[Qe][Ge],ge,mt),m.push(ge,Je,mt),ye+=6}h.addGroup(P,ye,0),P+=ye})(),!1===a&&(t>0&&ie(!0),e>0&&ie(!1)),this.setIndex(m),this.setAttribute("position",new Jn(_,3)),this.setAttribute("normal",new Jn(v,3)),this.setAttribute("uv",new Jn(S,2))}static fromJSON(t){return new Gy(t.radiusTop,t.radiusBottom,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}}class YS extends Gy{constructor(t=1,e=1,n=8,r=1,s=!1,a=0,l=2*Math.PI){super(0,t,e,n,r,s,a,l),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:r,openEnded:s,thetaStart:a,thetaLength:l}}static fromJSON(t){return new YS(t.radius,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}}class Fp extends Ir{constructor(t=[],e=[],n=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:r};const s=[],a=[];function u(E,ie,ee,ce){const ye=ce+1,Ce=[];for(let Ge=0;Ge<=ye;Ge++){Ce[Ge]=[];const Qe=E.clone().lerp(ee,Ge/ye),nt=ie.clone().lerp(ee,Ge/ye),ge=ye-Ge;for(let Je=0;Je<=ge;Je++)Ce[Ge][Je]=0===Je&&Ge===ye?Qe:Qe.clone().lerp(nt,Je/ge)}for(let Ge=0;Ge<ye;Ge++)for(let Qe=0;Qe<2*(ye-Ge)-1;Qe++){const nt=Math.floor(Qe/2);Qe%2==0?(v(Ce[Ge][nt+1]),v(Ce[Ge+1][nt]),v(Ce[Ge][nt])):(v(Ce[Ge][nt+1]),v(Ce[Ge+1][nt+1]),v(Ce[Ge+1][nt]))}}function v(E){s.push(E.x,E.y,E.z)}function S(E,ie){const ee=3*E;ie.x=t[ee+0],ie.y=t[ee+1],ie.z=t[ee+2]}function I(E,ie,ee,ce){ce<0&&1===E.x&&(a[ie]=E.x-1),0===ee.x&&0===ee.z&&(a[ie]=ce/2/Math.PI+.5)}function j(E){return Math.atan2(E.z,-E.x)}function P(E){return Math.atan2(-E.y,Math.sqrt(E.x*E.x+E.z*E.z))}(function l(E){const ie=new He,ee=new He,ce=new He;for(let ye=0;ye<e.length;ye+=3)S(e[ye+0],ie),S(e[ye+1],ee),S(e[ye+2],ce),u(ie,ee,ce,E)})(r),function h(E){const ie=new He;for(let ee=0;ee<s.length;ee+=3)ie.x=s[ee+0],ie.y=s[ee+1],ie.z=s[ee+2],ie.normalize().multiplyScalar(E),s[ee+0]=ie.x,s[ee+1]=ie.y,s[ee+2]=ie.z}(n),function m(){const E=new He;for(let ie=0;ie<s.length;ie+=3){E.x=s[ie+0],E.y=s[ie+1],E.z=s[ie+2];const ee=j(E)/2/Math.PI+.5,ce=P(E)/Math.PI+.5;a.push(ee,1-ce)}(function T(){const E=new He,ie=new He,ee=new He,ce=new He,ye=new Oi,Ce=new Oi,Ge=new Oi;for(let Qe=0,nt=0;Qe<s.length;Qe+=9,nt+=6){E.set(s[Qe+0],s[Qe+1],s[Qe+2]),ie.set(s[Qe+3],s[Qe+4],s[Qe+5]),ee.set(s[Qe+6],s[Qe+7],s[Qe+8]),ye.set(a[nt+0],a[nt+1]),Ce.set(a[nt+2],a[nt+3]),Ge.set(a[nt+4],a[nt+5]),ce.copy(E).add(ie).add(ee).divideScalar(3);const ge=j(ce);I(ye,nt+0,E,ge),I(Ce,nt+2,ie,ge),I(Ge,nt+4,ee,ge)}})(),function _(){for(let E=0;E<a.length;E+=6){const ie=a[E+0],ee=a[E+2],ce=a[E+4],ye=Math.max(ie,ee,ce),Ce=Math.min(ie,ee,ce);ye>.9&&Ce<.1&&(ie<.2&&(a[E+0]+=1),ee<.2&&(a[E+2]+=1),ce<.2&&(a[E+4]+=1))}}()}(),this.setAttribute("position",new Jn(s,3)),this.setAttribute("normal",new Jn(s.slice(),3)),this.setAttribute("uv",new Jn(a,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}static fromJSON(t){return new Fp(t.vertices,t.indices,t.radius,t.details)}}class KS extends Fp{constructor(t=1,e=0){const n=(1+Math.sqrt(5))/2,r=1/n;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,e),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new KS(t.radius,t.detail)}}const W2=new He,j2=new He,P5=new He,q2=new Rl;class I5 extends Ir{constructor(t=null,e=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:t,thresholdAngle:e},null!==t){const r=Math.pow(10,4),s=Math.cos(b0*e),a=t.getIndex(),l=t.getAttribute("position"),u=a?a.count:l.count,h=[0,0,0],m=["a","b","c"],_=new Array(3),v={},S=[];for(let T=0;T<u;T+=3){a?(h[0]=a.getX(T),h[1]=a.getX(T+1),h[2]=a.getX(T+2)):(h[0]=T,h[1]=T+1,h[2]=T+2);const{a:I,b:j,c:P}=q2;if(I.fromBufferAttribute(l,h[0]),j.fromBufferAttribute(l,h[1]),P.fromBufferAttribute(l,h[2]),q2.getNormal(P5),_[0]=`${Math.round(I.x*r)},${Math.round(I.y*r)},${Math.round(I.z*r)}`,_[1]=`${Math.round(j.x*r)},${Math.round(j.y*r)},${Math.round(j.z*r)}`,_[2]=`${Math.round(P.x*r)},${Math.round(P.y*r)},${Math.round(P.z*r)}`,_[0]!==_[1]&&_[1]!==_[2]&&_[2]!==_[0])for(let E=0;E<3;E++){const ie=(E+1)%3,ee=_[E],ce=_[ie],ye=q2[m[E]],Ce=q2[m[ie]],Ge=`${ee}_${ce}`,Qe=`${ce}_${ee}`;Qe in v&&v[Qe]?(P5.dot(v[Qe].normal)<=s&&(S.push(ye.x,ye.y,ye.z),S.push(Ce.x,Ce.y,Ce.z)),v[Qe]=null):Ge in v||(v[Ge]={index0:h[E],index1:h[ie],normal:P5.clone()})}}for(const T in v)if(v[T]){const{index0:I,index1:j}=v[T];W2.fromBufferAttribute(l,I),j2.fromBufferAttribute(l,j),S.push(W2.x,W2.y,W2.z),S.push(j2.x,j2.y,j2.z)}this.setAttribute("position",new Jn(S,3))}}}class Gh{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(t,e){const n=this.getUtoTmapping(t);return this.getPoint(n,e)}getPoints(t=5){const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return e}getSpacedPoints(t=5){const e=[];for(let n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e}getLength(){const t=this.getLengths();return t[t.length-1]}getLengths(t=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const e=[];let n,r=this.getPoint(0),s=0;e.push(0);for(let a=1;a<=t;a++)n=this.getPoint(a/t),s+=n.distanceTo(r),e.push(s),r=n;return this.cacheArcLengths=e,e}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(t,e){const n=this.getLengths();let r=0;const s=n.length;let a;a=e||t*n[s-1];let h,l=0,u=s-1;for(;l<=u;)if(r=Math.floor(l+(u-l)/2),h=n[r]-a,h<0)l=r+1;else{if(!(h>0)){u=r;break}u=r-1}if(r=u,n[r]===a)return r/(s-1);const m=n[r];return(r+(a-m)/(n[r+1]-m))/(s-1)}getTangent(t,e){let r=t-1e-4,s=t+1e-4;r<0&&(r=0),s>1&&(s=1);const a=this.getPoint(r),l=this.getPoint(s),u=e||(a.isVector2?new Oi:new He);return u.copy(l).sub(a).normalize(),u}getTangentAt(t,e){const n=this.getUtoTmapping(t);return this.getTangent(n,e)}computeFrenetFrames(t,e){const n=new He,r=[],s=[],a=[],l=new He,u=new nr;for(let S=0;S<=t;S++)r[S]=this.getTangentAt(S/t,new He);s[0]=new He,a[0]=new He;let h=Number.MAX_VALUE;const m=Math.abs(r[0].x),_=Math.abs(r[0].y),v=Math.abs(r[0].z);m<=h&&(h=m,n.set(1,0,0)),_<=h&&(h=_,n.set(0,1,0)),v<=h&&n.set(0,0,1),l.crossVectors(r[0],n).normalize(),s[0].crossVectors(r[0],l),a[0].crossVectors(r[0],s[0]);for(let S=1;S<=t;S++){if(s[S]=s[S-1].clone(),a[S]=a[S-1].clone(),l.crossVectors(r[S-1],r[S]),l.length()>Number.EPSILON){l.normalize();const T=Math.acos($c(r[S-1].dot(r[S]),-1,1));s[S].applyMatrix4(u.makeRotationAxis(l,T))}a[S].crossVectors(r[S],s[S])}if(!0===e){let S=Math.acos($c(s[0].dot(s[t]),-1,1));S/=t,r[0].dot(l.crossVectors(s[0],s[t]))>0&&(S=-S);for(let T=1;T<=t;T++)s[T].applyMatrix4(u.makeRotationAxis(r[T],S*T)),a[T].crossVectors(r[T],s[T])}return{tangents:r,normals:s,binormals:a}}clone(){return(new this.constructor).copy(this)}copy(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}toJSON(){const t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t}fromJSON(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}class sE extends Gh{constructor(t=0,e=0,n=1,r=1,s=0,a=2*Math.PI,l=!1,u=0){super(),this.type="EllipseCurve",this.aX=t,this.aY=e,this.xRadius=n,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=a,this.aClockwise=l,this.aRotation=u}getPoint(t,e){const n=e||new Oi,r=2*Math.PI;let s=this.aEndAngle-this.aStartAngle;const a=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(s=a?0:r),!0===this.aClockwise&&!a&&(s===r?s=-r:s-=r);const l=this.aStartAngle+t*s;let u=this.aX+this.xRadius*Math.cos(l),h=this.aY+this.yRadius*Math.sin(l);if(0!==this.aRotation){const m=Math.cos(this.aRotation),_=Math.sin(this.aRotation),v=u-this.aX,S=h-this.aY;u=v*m-S*_+this.aX,h=v*_+S*m+this.aY}return n.set(u,h)}copy(t){return super.copy(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}toJSON(){const t=super.toJSON();return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t}fromJSON(t){return super.fromJSON(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}}sE.prototype.isEllipseCurve=!0;class L5 extends sE{constructor(t,e,n,r,s,a){super(t,e,n,n,r,s,a),this.type="ArcCurve"}}function O5(){let i=0,t=0,e=0,n=0;function r(s,a,l,u){i=s,t=l,e=-3*s+3*a-2*l-u,n=2*s-2*a+l+u}return{initCatmullRom:function(s,a,l,u,h){r(a,l,h*(l-s),h*(u-a))},initNonuniformCatmullRom:function(s,a,l,u,h,m,_){let v=(a-s)/h-(l-s)/(h+m)+(l-a)/m,S=(l-a)/m-(u-a)/(m+_)+(u-l)/_;v*=m,S*=m,r(a,l,v,S)},calc:function(s){const a=s*s;return i+t*s+e*a+n*(a*s)}}}L5.prototype.isArcCurve=!0;const X2=new He,F5=new O5,B5=new O5,N5=new O5;class H5 extends Gh{constructor(t=[],e=!1,n="centripetal",r=.5){super(),this.type="CatmullRomCurve3",this.points=t,this.closed=e,this.curveType=n,this.tension=r}getPoint(t,e=new He){const n=e,r=this.points,s=r.length,a=(s-(this.closed?0:1))*t;let h,m,l=Math.floor(a),u=a-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/s)+1)*s:0===u&&l===s-1&&(l=s-2,u=1),this.closed||l>0?h=r[(l-1)%s]:(X2.subVectors(r[0],r[1]).add(r[0]),h=X2);const _=r[l%s],v=r[(l+1)%s];if(this.closed||l+2<s?m=r[(l+2)%s]:(X2.subVectors(r[s-1],r[s-2]).add(r[s-1]),m=X2),"centripetal"===this.curveType||"chordal"===this.curveType){const S="chordal"===this.curveType?.5:.25;let T=Math.pow(h.distanceToSquared(_),S),I=Math.pow(_.distanceToSquared(v),S),j=Math.pow(v.distanceToSquared(m),S);I<1e-4&&(I=1),T<1e-4&&(T=I),j<1e-4&&(j=I),F5.initNonuniformCatmullRom(h.x,_.x,v.x,m.x,T,I,j),B5.initNonuniformCatmullRom(h.y,_.y,v.y,m.y,T,I,j),N5.initNonuniformCatmullRom(h.z,_.z,v.z,m.z,T,I,j)}else"catmullrom"===this.curveType&&(F5.initCatmullRom(h.x,_.x,v.x,m.x,this.tension),B5.initCatmullRom(h.y,_.y,v.y,m.y,this.tension),N5.initCatmullRom(h.z,_.z,v.z,m.z,this.tension));return n.set(F5.calc(u),B5.calc(u),N5.calc(u)),n}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++)this.points.push(t.points[e].clone());return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++)t.points.push(this.points[e].toArray());return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const r=t.points[e];this.points.push((new He).fromArray(r))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}}function TY(i,t,e,n,r){const s=.5*(n-t),a=.5*(r-e),l=i*i;return(2*e-2*n+s+a)*(i*l)+(-3*e+3*n-2*s-a)*l+s*i+e}function oE(i,t,e,n){return function Kwe(i,t){const e=1-i;return e*e*t}(i,t)+function Qwe(i,t){return 2*(1-i)*i*t}(i,e)+function Jwe(i,t){return i*i*t}(i,n)}function aE(i,t,e,n,r){return function $we(i,t){const e=1-i;return e*e*e*t}(i,t)+function eSe(i,t){const e=1-i;return 3*e*e*i*t}(i,e)+function tSe(i,t){return 3*(1-i)*i*i*t}(i,n)+function iSe(i,t){return i*i*i*t}(i,r)}H5.prototype.isCatmullRomCurve3=!0;class Z2 extends Gh{constructor(t=new Oi,e=new Oi,n=new Oi,r=new Oi){super(),this.type="CubicBezierCurve",this.v0=t,this.v1=e,this.v2=n,this.v3=r}getPoint(t,e=new Oi){const n=e,r=this.v0,s=this.v1,a=this.v2,l=this.v3;return n.set(aE(t,r.x,s.x,a.x,l.x),aE(t,r.y,s.y,a.y,l.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}Z2.prototype.isCubicBezierCurve=!0;class V5 extends Gh{constructor(t=new He,e=new He,n=new He,r=new He){super(),this.type="CubicBezierCurve3",this.v0=t,this.v1=e,this.v2=n,this.v3=r}getPoint(t,e=new He){const n=e,r=this.v0,s=this.v1,a=this.v2,l=this.v3;return n.set(aE(t,r.x,s.x,a.x,l.x),aE(t,r.y,s.y,a.y,l.y),aE(t,r.z,s.z,a.z,l.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}V5.prototype.isCubicBezierCurve3=!0;class lE extends Gh{constructor(t=new Oi,e=new Oi){super(),this.type="LineCurve",this.v1=t,this.v2=e}getPoint(t,e=new Oi){const n=e;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,e){return this.getPoint(t,e)}getTangent(t,e){const n=e||new Oi;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}lE.prototype.isLineCurve=!0;class EY extends Gh{constructor(t=new He,e=new He){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=t,this.v2=e}getPoint(t,e=new He){const n=e;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,e){return this.getPoint(t,e)}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class Y2 extends Gh{constructor(t=new Oi,e=new Oi,n=new Oi){super(),this.type="QuadraticBezierCurve",this.v0=t,this.v1=e,this.v2=n}getPoint(t,e=new Oi){const n=e,r=this.v0,s=this.v1,a=this.v2;return n.set(oE(t,r.x,s.x,a.x),oE(t,r.y,s.y,a.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}Y2.prototype.isQuadraticBezierCurve=!0;class K2 extends Gh{constructor(t=new He,e=new He,n=new He){super(),this.type="QuadraticBezierCurve3",this.v0=t,this.v1=e,this.v2=n}getPoint(t,e=new He){const n=e,r=this.v0,s=this.v1,a=this.v2;return n.set(oE(t,r.x,s.x,a.x),oE(t,r.y,s.y,a.y),oE(t,r.z,s.z,a.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}K2.prototype.isQuadraticBezierCurve3=!0;class Q2 extends Gh{constructor(t=[]){super(),this.type="SplineCurve",this.points=t}getPoint(t,e=new Oi){const n=e,r=this.points,s=(r.length-1)*t,a=Math.floor(s),l=s-a,u=r[0===a?a:a-1],h=r[a],m=r[a>r.length-2?r.length-1:a+1],_=r[a>r.length-3?r.length-1:a+2];return n.set(TY(l,u.x,h.x,m.x,_.x),TY(l,u.y,h.y,m.y,_.y)),n}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++)this.points.push(t.points[e].clone());return this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++)t.points.push(this.points[e].toArray());return t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const r=t.points[e];this.points.push((new Oi).fromArray(r))}return this}}Q2.prototype.isSplineCurve=!0;var z5=Object.freeze({__proto__:null,ArcCurve:L5,CatmullRomCurve3:H5,CubicBezierCurve:Z2,CubicBezierCurve3:V5,EllipseCurve:sE,LineCurve:lE,LineCurve3:EY,QuadraticBezierCurve:Y2,QuadraticBezierCurve3:K2,SplineCurve:Q2});class AY extends Gh{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(t){this.curves.push(t)}closePath(){const t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new lE(e,t))}getPoint(t,e){const n=t*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=n){const a=r[s]-n,l=this.curves[s],u=l.getLength();return l.getPointAt(0===u?0:1-a/u,e)}s++}return null}getLength(){const t=this.getCurveLengths();return t[t.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const t=[];let e=0;for(let n=0,r=this.curves.length;n<r;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t}getSpacedPoints(t=40){const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e}getPoints(t=12){const e=[];let n;for(let r=0,s=this.curves;r<s.length;r++){const a=s[r],u=a.getPoints(a&&a.isEllipseCurve?2*t:a&&(a.isLineCurve||a.isLineCurve3)?1:a&&a.isSplineCurve?t*a.points.length:t);for(let h=0;h<u.length;h++){const m=u[h];n&&n.equals(m)||(e.push(m),n=m)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e}copy(t){super.copy(t),this.curves=[];for(let e=0,n=t.curves.length;e<n;e++)this.curves.push(t.curves[e].clone());return this.autoClose=t.autoClose,this}toJSON(){const t=super.toJSON();t.autoClose=this.autoClose,t.curves=[];for(let e=0,n=this.curves.length;e<n;e++)t.curves.push(this.curves[e].toJSON());return t}fromJSON(t){super.fromJSON(t),this.autoClose=t.autoClose,this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){const r=t.curves[e];this.curves.push((new z5[r.type]).fromJSON(r))}return this}}class cE extends AY{constructor(t){super(),this.type="Path",this.currentPoint=new Oi,t&&this.setFromPoints(t)}setFromPoints(t){this.moveTo(t[0].x,t[0].y);for(let e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y);return this}moveTo(t,e){return this.currentPoint.set(t,e),this}lineTo(t,e){const n=new lE(this.currentPoint.clone(),new Oi(t,e));return this.curves.push(n),this.currentPoint.set(t,e),this}quadraticCurveTo(t,e,n,r){const s=new Y2(this.currentPoint.clone(),new Oi(t,e),new Oi(n,r));return this.curves.push(s),this.currentPoint.set(n,r),this}bezierCurveTo(t,e,n,r,s,a){const l=new Z2(this.currentPoint.clone(),new Oi(t,e),new Oi(n,r),new Oi(s,a));return this.curves.push(l),this.currentPoint.set(s,a),this}splineThru(t){const e=[this.currentPoint.clone()].concat(t),n=new Q2(e);return this.curves.push(n),this.currentPoint.copy(t[t.length-1]),this}arc(t,e,n,r,s,a){return this.absarc(t+this.currentPoint.x,e+this.currentPoint.y,n,r,s,a),this}absarc(t,e,n,r,s,a){return this.absellipse(t,e,n,n,r,s,a),this}ellipse(t,e,n,r,s,a,l,u){return this.absellipse(t+this.currentPoint.x,e+this.currentPoint.y,n,r,s,a,l,u),this}absellipse(t,e,n,r,s,a,l,u){const h=new sE(t,e,n,r,s,a,l,u);if(this.curves.length>0){const _=h.getPoint(0);_.equals(this.currentPoint)||this.lineTo(_.x,_.y)}this.curves.push(h);const m=h.getPoint(1);return this.currentPoint.copy(m),this}copy(t){return super.copy(t),this.currentPoint.copy(t.currentPoint),this}toJSON(){const t=super.toJSON();return t.currentPoint=this.currentPoint.toArray(),t}fromJSON(t){return super.fromJSON(t),this.currentPoint.fromArray(t.currentPoint),this}}class Bp extends cE{constructor(t){super(t),this.uuid=Nh(),this.type="Shape",this.holes=[]}getPointsHoles(t){const e=[];for(let n=0,r=this.holes.length;n<r;n++)e[n]=this.holes[n].getPoints(t);return e}extractPoints(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}}copy(t){super.copy(t),this.holes=[];for(let e=0,n=t.holes.length;e<n;e++)this.holes.push(t.holes[e].clone());return this}toJSON(){const t=super.toJSON();t.uuid=this.uuid,t.holes=[];for(let e=0,n=this.holes.length;e<n;e++)t.holes.push(this.holes[e].toJSON());return t}fromJSON(t){super.fromJSON(t),this.uuid=t.uuid,this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){const r=t.holes[e];this.holes.push((new cE).fromJSON(r))}return this}}function DY(i,t,e,n,r){let s,a;if(r===function vSe(i,t,e,n){let r=0;for(let s=t,a=e-n;s<e;s+=n)r+=(i[a]-i[s])*(i[s+1]+i[a+1]),a=s;return r}(i,t,e,n)>0)for(s=t;s<e;s+=n)a=PY(s,i[s],i[s+1],a);else for(s=e-n;s>=t;s-=n)a=PY(s,i[s],i[s+1],a);return a&&J2(a,a.next)&&(dE(a),a=a.next),a}function Wy(i,t){if(!i)return i;t||(t=i);let n,e=i;do{if(n=!1,e.steiner||!J2(e,e.next)&&0!==Ja(e.prev,e,e.next))e=e.next;else{if(dE(e),e=t=e.prev,e===e.next)break;n=!0}}while(n||e!==t);return t}function uE(i,t,e,n,r,s,a){if(!i)return;!a&&s&&function fSe(i,t,e,n){let r=i;do{null===r.z&&(r.z=U5(r.x,r.y,t,e,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==i);r.prevZ.nextZ=null,r.prevZ=null,function pSe(i){let t,e,n,r,s,a,l,u,h=1;do{for(e=i,i=null,s=null,a=0;e;){for(a++,n=e,l=0,t=0;t<h&&(l++,n=n.nextZ,n);t++);for(u=h;l>0||u>0&&n;)0!==l&&(0===u||!n||e.z<=n.z)?(r=e,e=e.nextZ,l--):(r=n,n=n.nextZ,u--),s?s.nextZ=r:i=r,r.prevZ=s,s=r;e=n}s.nextZ=null,h*=2}while(a>1)}(r)}(i,n,r,s);let u,h,l=i;for(;i.prev!==i.next;)if(u=i.prev,h=i.next,s?sSe(i,n,r,s):rSe(i))t.push(u.i/e),t.push(i.i/e),t.push(h.i/e),dE(i),i=h.next,l=h.next;else if((i=h)===l){a?1===a?uE(i=oSe(Wy(i),t,e),t,e,n,r,s,2):2===a&&aSe(i,t,e,n,r,s):uE(Wy(i),t,e,n,r,s,1);break}}function rSe(i){const t=i.prev,e=i,n=i.next;if(Ja(t,e,n)>=0)return!1;let r=i.next.next;for(;r!==i.prev;){if(QS(t.x,t.y,e.x,e.y,n.x,n.y,r.x,r.y)&&Ja(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function sSe(i,t,e,n){const r=i.prev,s=i,a=i.next;if(Ja(r,s,a)>=0)return!1;const h=r.x>s.x?r.x>a.x?r.x:a.x:s.x>a.x?s.x:a.x,m=r.y>s.y?r.y>a.y?r.y:a.y:s.y>a.y?s.y:a.y,_=U5(r.x<s.x?r.x<a.x?r.x:a.x:s.x<a.x?s.x:a.x,r.y<s.y?r.y<a.y?r.y:a.y:s.y<a.y?s.y:a.y,t,e,n),v=U5(h,m,t,e,n);let S=i.prevZ,T=i.nextZ;for(;S&&S.z>=_&&T&&T.z<=v;){if(S!==i.prev&&S!==i.next&&QS(r.x,r.y,s.x,s.y,a.x,a.y,S.x,S.y)&&Ja(S.prev,S,S.next)>=0||(S=S.prevZ,T!==i.prev&&T!==i.next&&QS(r.x,r.y,s.x,s.y,a.x,a.y,T.x,T.y)&&Ja(T.prev,T,T.next)>=0))return!1;T=T.nextZ}for(;S&&S.z>=_;){if(S!==i.prev&&S!==i.next&&QS(r.x,r.y,s.x,s.y,a.x,a.y,S.x,S.y)&&Ja(S.prev,S,S.next)>=0)return!1;S=S.prevZ}for(;T&&T.z<=v;){if(T!==i.prev&&T!==i.next&&QS(r.x,r.y,s.x,s.y,a.x,a.y,T.x,T.y)&&Ja(T.prev,T,T.next)>=0)return!1;T=T.nextZ}return!0}function oSe(i,t,e){let n=i;do{const r=n.prev,s=n.next.next;!J2(r,s)&&RY(r,n,n.next,s)&&hE(r,s)&&hE(s,r)&&(t.push(r.i/e),t.push(n.i/e),t.push(s.i/e),dE(n),dE(n.next),n=i=s),n=n.next}while(n!==i);return Wy(n)}function aSe(i,t,e,n,r,s){let a=i;do{let l=a.next.next;for(;l!==a.prev;){if(a.i!==l.i&&gSe(a,l)){let u=kY(a,l);return a=Wy(a,a.next),u=Wy(u,u.next),uE(a,t,e,n,r,s),void uE(u,t,e,n,r,s)}l=l.next}a=a.next}while(a!==i)}function cSe(i,t){return i.x-t.x}function uSe(i,t){if(t=function hSe(i,t){let e=t;const n=i.x,r=i.y;let a,s=-1/0;do{if(r<=e.y&&r>=e.next.y&&e.next.y!==e.y){const v=e.x+(r-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(v<=n&&v>s){if(s=v,v===n){if(r===e.y)return e;if(r===e.next.y)return e.next}a=e.x<e.next.x?e:e.next}}e=e.next}while(e!==t);if(!a)return null;if(n===s)return a;const l=a,u=a.x,h=a.y;let _,m=1/0;e=a;do{n>=e.x&&e.x>=u&&n!==e.x&&QS(r<h?n:s,r,u,h,r<h?s:n,r,e.x,e.y)&&(_=Math.abs(r-e.y)/(n-e.x),hE(e,i)&&(_<m||_===m&&(e.x>a.x||e.x===a.x&&dSe(a,e)))&&(a=e,m=_)),e=e.next}while(e!==l);return a}(i,t),t){const e=kY(t,i);Wy(t,t.next),Wy(e,e.next)}}function dSe(i,t){return Ja(i.prev,i,t.prev)<0&&Ja(t.next,i,i.next)<0}function U5(i,t,e,n,r){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=32767*(i-e)*r)|i<<8))|i<<4))|i<<2))|i<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function mSe(i){let t=i,e=i;do{(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next}while(t!==i);return e}function QS(i,t,e,n,r,s,a,l){return(r-a)*(t-l)-(i-a)*(s-l)>=0&&(i-a)*(n-l)-(e-a)*(t-l)>=0&&(e-a)*(s-l)-(r-a)*(n-l)>=0}function gSe(i,t){return i.next.i!==t.i&&i.prev.i!==t.i&&!function _Se(i,t){let e=i;do{if(e.i!==i.i&&e.next.i!==i.i&&e.i!==t.i&&e.next.i!==t.i&&RY(e,e.next,i,t))return!0;e=e.next}while(e!==i);return!1}(i,t)&&(hE(i,t)&&hE(t,i)&&function ySe(i,t){let e=i,n=!1;const r=(i.x+t.x)/2,s=(i.y+t.y)/2;do{e.y>s!=e.next.y>s&&e.next.y!==e.y&&r<(e.next.x-e.x)*(s-e.y)/(e.next.y-e.y)+e.x&&(n=!n),e=e.next}while(e!==i);return n}(i,t)&&(Ja(i.prev,i,t.prev)||Ja(i,t.prev,t))||J2(i,t)&&Ja(i.prev,i,i.next)>0&&Ja(t.prev,t,t.next)>0)}function Ja(i,t,e){return(t.y-i.y)*(e.x-t.x)-(t.x-i.x)*(e.y-t.y)}function J2(i,t){return i.x===t.x&&i.y===t.y}function RY(i,t,e,n){const r=eI(Ja(i,t,e)),s=eI(Ja(i,t,n)),a=eI(Ja(e,n,i)),l=eI(Ja(e,n,t));return!!(r!==s&&a!==l||0===r&&$2(i,e,t)||0===s&&$2(i,n,t)||0===a&&$2(e,i,n)||0===l&&$2(e,t,n))}function $2(i,t,e){return t.x<=Math.max(i.x,e.x)&&t.x>=Math.min(i.x,e.x)&&t.y<=Math.max(i.y,e.y)&&t.y>=Math.min(i.y,e.y)}function eI(i){return i>0?1:i<0?-1:0}function hE(i,t){return Ja(i.prev,i,i.next)<0?Ja(i,t,i.next)>=0&&Ja(i,i.prev,t)>=0:Ja(i,t,i.prev)<0||Ja(i,i.next,t)<0}function kY(i,t){const e=new G5(i.i,i.x,i.y),n=new G5(t.i,t.x,t.y),r=i.next,s=t.prev;return i.next=t,t.prev=i,e.next=r,r.prev=e,n.next=e,e.prev=n,s.next=n,n.prev=s,n}function PY(i,t,e,n){const r=new G5(i,t,e);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function dE(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function G5(i,t,e){this.i=i,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}class Np{static area(t){const e=t.length;let n=0;for(let r=e-1,s=0;s<e;r=s++)n+=t[r].x*t[s].y-t[s].x*t[r].y;return.5*n}static isClockWise(t){return Np.area(t)<0}static triangulateShape(t,e){const n=[],r=[],s=[];IY(t),LY(n,t);let a=t.length;e.forEach(IY);for(let u=0;u<e.length;u++)r.push(a),a+=e[u].length,LY(n,e[u]);const l=function(i,t,e=2){const n=t&&t.length,r=n?t[0]*e:i.length;let s=DY(i,0,r,e,!0);const a=[];if(!s||s.next===s.prev)return a;let l,u,h,m,_,v,S;if(n&&(s=function lSe(i,t,e,n){const r=[];let s,a,l,u,h;for(s=0,a=t.length;s<a;s++)l=t[s]*n,u=s<a-1?t[s+1]*n:i.length,h=DY(i,l,u,n,!1),h===h.next&&(h.steiner=!0),r.push(mSe(h));for(r.sort(cSe),s=0;s<r.length;s++)uSe(r[s],e),e=Wy(e,e.next);return e}(i,t,s,e)),i.length>80*e){l=h=i[0],u=m=i[1];for(let T=e;T<r;T+=e)_=i[T],v=i[T+1],_<l&&(l=_),v<u&&(u=v),_>h&&(h=_),v>m&&(m=v);S=Math.max(h-l,m-u),S=0!==S?1/S:0}return uE(s,a,e,l,u,S),a}(n,r);for(let u=0;u<l.length;u+=3)s.push(l.slice(u,u+3));return s}}function IY(i){const t=i.length;t>2&&i[t-1].equals(i[0])&&i.pop()}function LY(i,t){for(let e=0;e<t.length;e++)i.push(t[e].x),i.push(t[e].y)}class Hp extends Ir{constructor(t=new Bp([new Oi(.5,.5),new Oi(-.5,.5),new Oi(-.5,-.5),new Oi(.5,-.5)]),e={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},t=Array.isArray(t)?t:[t];const n=this,r=[],s=[];for(let l=0,u=t.length;l<u;l++)a(t[l]);function a(l){const u=[],h=void 0!==e.curveSegments?e.curveSegments:12,m=void 0!==e.steps?e.steps:1;let _=void 0!==e.depth?e.depth:1,v=void 0===e.bevelEnabled||e.bevelEnabled,S=void 0!==e.bevelThickness?e.bevelThickness:.2,T=void 0!==e.bevelSize?e.bevelSize:S-.1,I=void 0!==e.bevelOffset?e.bevelOffset:0,j=void 0!==e.bevelSegments?e.bevelSegments:3;const P=e.extrudePath,E=void 0!==e.UVGenerator?e.UVGenerator:bSe;void 0!==e.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),_=e.amount);let ie,ce,ye,Ce,Ge,ee=!1;P&&(ie=P.getSpacedPoints(m),ee=!0,v=!1,ce=P.computeFrenetFrames(m,!1),ye=new He,Ce=new He,Ge=new He),v||(j=0,S=0,T=0,I=0);const Qe=l.extractPoints(h);let nt=Qe.shape;const ge=Qe.holes;if(!Np.isClockWise(nt)){nt=nt.reverse();for(let Ri=0,fn=ge.length;Ri<fn;Ri++){const sn=ge[Ri];Np.isClockWise(sn)&&(ge[Ri]=sn.reverse())}}const mt=Np.triangulateShape(nt,ge),pt=nt;for(let Ri=0,fn=ge.length;Ri<fn;Ri++)nt=nt.concat(ge[Ri]);function Pt(Ri,fn,sn){return fn||console.error("THREE.ExtrudeGeometry: vec does not exist"),fn.clone().multiplyScalar(sn).add(Ri)}const et=nt.length,vt=mt.length;function kt(Ri,fn,sn){let Gn,kn,is;const ls=Ri.x-fn.x,co=Ri.y-fn.y,sa=sn.x-Ri.x,Zo=sn.y-Ri.y,ot=ls*ls+co*co;if(Math.abs(ls*Zo-co*sa)>Number.EPSILON){const Ti=Math.sqrt(ot),un=Math.sqrt(sa*sa+Zo*Zo),pr=fn.x-co/Ti,Ci=fn.y+ls/Ti,Dn=((sn.x-Zo/un-pr)*Zo-(sn.y+sa/un-Ci)*sa)/(ls*Zo-co*sa);Gn=pr+ls*Dn-Ri.x,kn=Ci+co*Dn-Ri.y;const An=Gn*Gn+kn*kn;if(An<=2)return new Oi(Gn,kn);is=Math.sqrt(An/2)}else{let Ti=!1;ls>Number.EPSILON?sa>Number.EPSILON&&(Ti=!0):ls<-Number.EPSILON?sa<-Number.EPSILON&&(Ti=!0):Math.sign(co)===Math.sign(Zo)&&(Ti=!0),Ti?(Gn=-co,kn=ls,is=Math.sqrt(ot)):(Gn=ls,kn=co,is=Math.sqrt(ot/2))}return new Oi(Gn/is,kn/is)}const pi=[];for(let Ri=0,fn=pt.length,sn=fn-1,Gn=Ri+1;Ri<fn;Ri++,sn++,Gn++)sn===fn&&(sn=0),Gn===fn&&(Gn=0),pi[Ri]=kt(pt[Ri],pt[sn],pt[Gn]);const Ht=[];let ct,mi=pi.concat();for(let Ri=0,fn=ge.length;Ri<fn;Ri++){const sn=ge[Ri];ct=[];for(let Gn=0,kn=sn.length,is=kn-1,ls=Gn+1;Gn<kn;Gn++,is++,ls++)is===kn&&(is=0),ls===kn&&(ls=0),ct[Gn]=kt(sn[Gn],sn[is],sn[ls]);Ht.push(ct),mi=mi.concat(ct)}for(let Ri=0;Ri<j;Ri++){const fn=Ri/j,sn=S*Math.cos(fn*Math.PI/2),Gn=T*Math.sin(fn*Math.PI/2)+I;for(let kn=0,is=pt.length;kn<is;kn++){const ls=Pt(pt[kn],pi[kn],Gn);nn(ls.x,ls.y,-sn)}for(let kn=0,is=ge.length;kn<is;kn++){const ls=ge[kn];ct=Ht[kn];for(let co=0,sa=ls.length;co<sa;co++){const Zo=Pt(ls[co],ct[co],Gn);nn(Zo.x,Zo.y,-sn)}}}const Zi=T+I;for(let Ri=0;Ri<et;Ri++){const fn=v?Pt(nt[Ri],mi[Ri],Zi):nt[Ri];ee?(Ce.copy(ce.normals[0]).multiplyScalar(fn.x),ye.copy(ce.binormals[0]).multiplyScalar(fn.y),Ge.copy(ie[0]).add(Ce).add(ye),nn(Ge.x,Ge.y,Ge.z)):nn(fn.x,fn.y,0)}for(let Ri=1;Ri<=m;Ri++)for(let fn=0;fn<et;fn++){const sn=v?Pt(nt[fn],mi[fn],Zi):nt[fn];ee?(Ce.copy(ce.normals[Ri]).multiplyScalar(sn.x),ye.copy(ce.binormals[Ri]).multiplyScalar(sn.y),Ge.copy(ie[Ri]).add(Ce).add(ye),nn(Ge.x,Ge.y,Ge.z)):nn(sn.x,sn.y,_/m*Ri)}for(let Ri=j-1;Ri>=0;Ri--){const fn=Ri/j,sn=S*Math.cos(fn*Math.PI/2),Gn=T*Math.sin(fn*Math.PI/2)+I;for(let kn=0,is=pt.length;kn<is;kn++){const ls=Pt(pt[kn],pi[kn],Gn);nn(ls.x,ls.y,_+sn)}for(let kn=0,is=ge.length;kn<is;kn++){const ls=ge[kn];ct=Ht[kn];for(let co=0,sa=ls.length;co<sa;co++){const Zo=Pt(ls[co],ct[co],Gn);ee?nn(Zo.x,Zo.y+ie[m-1].y,ie[m-1].x+sn):nn(Zo.x,Zo.y,_+sn)}}}function tr(Ri,fn){let sn=Ri.length;for(;--sn>=0;){const Gn=sn;let kn=sn-1;kn<0&&(kn=Ri.length-1);for(let is=0,ls=m+2*j;is<ls;is++){const co=et*is,sa=et*(is+1);Cn(fn+Gn+co,fn+kn+co,fn+kn+sa,fn+Gn+sa)}}}function nn(Ri,fn,sn){u.push(Ri),u.push(fn),u.push(sn)}function Un(Ri,fn,sn){ts(Ri),ts(fn),ts(sn);const Gn=r.length/3,kn=E.generateTopUV(n,r,Gn-3,Gn-2,Gn-1);Hr(kn[0]),Hr(kn[1]),Hr(kn[2])}function Cn(Ri,fn,sn,Gn){ts(Ri),ts(fn),ts(Gn),ts(fn),ts(sn),ts(Gn);const kn=r.length/3,is=E.generateSideWallUV(n,r,kn-6,kn-3,kn-2,kn-1);Hr(is[0]),Hr(is[1]),Hr(is[3]),Hr(is[1]),Hr(is[2]),Hr(is[3])}function ts(Ri){r.push(u[3*Ri+0]),r.push(u[3*Ri+1]),r.push(u[3*Ri+2])}function Hr(Ri){s.push(Ri.x),s.push(Ri.y)}(function zi(){const Ri=r.length/3;if(v){let fn=0,sn=et*fn;for(let Gn=0;Gn<vt;Gn++){const kn=mt[Gn];Un(kn[2]+sn,kn[1]+sn,kn[0]+sn)}fn=m+2*j,sn=et*fn;for(let Gn=0;Gn<vt;Gn++){const kn=mt[Gn];Un(kn[0]+sn,kn[1]+sn,kn[2]+sn)}}else{for(let fn=0;fn<vt;fn++){const sn=mt[fn];Un(sn[2],sn[1],sn[0])}for(let fn=0;fn<vt;fn++){const sn=mt[fn];Un(sn[0]+et*m,sn[1]+et*m,sn[2]+et*m)}}n.addGroup(Ri,r.length/3-Ri,0)})(),function Zt(){const Ri=r.length/3;let fn=0;tr(pt,fn),fn+=pt.length;for(let sn=0,Gn=ge.length;sn<Gn;sn++){const kn=ge[sn];tr(kn,fn),fn+=kn.length}n.addGroup(Ri,r.length/3-Ri,1)}()}this.setAttribute("position",new Jn(r,3)),this.setAttribute("uv",new Jn(s,2)),this.computeVertexNormals()}toJSON(){const t=super.toJSON();return function xSe(i,t,e){if(e.shapes=[],Array.isArray(i))for(let n=0,r=i.length;n<r;n++)e.shapes.push(i[n].uuid);else e.shapes.push(i.uuid);return void 0!==t.extrudePath&&(e.options.extrudePath=t.extrudePath.toJSON()),e}(this.parameters.shapes,this.parameters.options,t)}static fromJSON(t,e){const n=[];for(let s=0,a=t.shapes.length;s<a;s++)n.push(e[t.shapes[s]]);const r=t.options.extrudePath;return void 0!==r&&(t.options.extrudePath=(new z5[r.type]).fromJSON(r)),new Hp(n,t.options)}}const bSe={generateTopUV:function(i,t,e,n,r){const l=t[3*n],u=t[3*n+1],h=t[3*r],m=t[3*r+1];return[new Oi(t[3*e],t[3*e+1]),new Oi(l,u),new Oi(h,m)]},generateSideWallUV:function(i,t,e,n,r,s){const a=t[3*e],l=t[3*e+1],u=t[3*e+2],h=t[3*n],m=t[3*n+1],_=t[3*n+2],v=t[3*r],S=t[3*r+1],T=t[3*r+2],I=t[3*s],j=t[3*s+1],P=t[3*s+2];return Math.abs(l-m)<Math.abs(a-h)?[new Oi(a,1-u),new Oi(h,1-_),new Oi(v,1-T),new Oi(I,1-P)]:[new Oi(l,1-u),new Oi(m,1-_),new Oi(S,1-T),new Oi(j,1-P)]}};class JS extends Fp{constructor(t=1,e=0){const n=(1+Math.sqrt(5))/2;super([-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new JS(t.radius,t.detail)}}class $S extends Ir{constructor(t=[new Oi(0,.5),new Oi(.5,0),new Oi(0,-.5)],e=12,n=0,r=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:r},e=Math.floor(e),r=$c(r,0,2*Math.PI);const s=[],a=[],l=[],u=[],h=[],m=1/e,_=new He,v=new Oi,S=new He,T=new He,I=new He;let j=0,P=0;for(let E=0;E<=t.length-1;E++)switch(E){case 0:j=t[E+1].x-t[E].x,P=t[E+1].y-t[E].y,S.x=1*P,S.y=-j,S.z=0*P,I.copy(S),S.normalize(),u.push(S.x,S.y,S.z);break;case t.length-1:u.push(I.x,I.y,I.z);break;default:j=t[E+1].x-t[E].x,P=t[E+1].y-t[E].y,S.x=1*P,S.y=-j,S.z=0*P,T.copy(S),S.x+=I.x,S.y+=I.y,S.z+=I.z,S.normalize(),u.push(S.x,S.y,S.z),I.copy(T)}for(let E=0;E<=e;E++){const ie=n+E*m*r,ee=Math.sin(ie),ce=Math.cos(ie);for(let ye=0;ye<=t.length-1;ye++)_.x=t[ye].x*ee,_.y=t[ye].y,_.z=t[ye].x*ce,a.push(_.x,_.y,_.z),v.x=E/e,v.y=ye/(t.length-1),l.push(v.x,v.y),h.push(u[3*ye+0]*ee,u[3*ye+1],u[3*ye+0]*ce)}for(let E=0;E<e;E++)for(let ie=0;ie<t.length-1;ie++){const ee=ie+E*t.length,ye=ee+t.length,Ce=ee+t.length+1,Ge=ee+1;s.push(ee,ye,Ge),s.push(Ce,Ge,ye)}this.setIndex(s),this.setAttribute("position",new Jn(a,3)),this.setAttribute("uv",new Jn(l,2)),this.setAttribute("normal",new Jn(h,3))}static fromJSON(t){return new $S(t.points,t.segments,t.phiStart,t.phiLength)}}class P0 extends Fp{constructor(t=1,e=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,e),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new P0(t.radius,t.detail)}}class eC extends Ir{constructor(t=.5,e=1,n=8,r=1,s=0,a=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:r,thetaStart:s,thetaLength:a},n=Math.max(3,n);const l=[],u=[],h=[],m=[];let _=t;const v=(e-t)/(r=Math.max(1,r)),S=new He,T=new Oi;for(let I=0;I<=r;I++){for(let j=0;j<=n;j++){const P=s+j/n*a;S.x=_*Math.cos(P),S.y=_*Math.sin(P),u.push(S.x,S.y,S.z),h.push(0,0,1),T.x=(S.x/e+1)/2,T.y=(S.y/e+1)/2,m.push(T.x,T.y)}_+=v}for(let I=0;I<r;I++){const j=I*(n+1);for(let P=0;P<n;P++){const E=P+j,ee=E+n+1,ce=E+n+2,ye=E+1;l.push(E,ee,ye),l.push(ee,ce,ye)}}this.setIndex(l),this.setAttribute("position",new Jn(u,3)),this.setAttribute("normal",new Jn(h,3)),this.setAttribute("uv",new Jn(m,2))}static fromJSON(t){return new eC(t.innerRadius,t.outerRadius,t.thetaSegments,t.phiSegments,t.thetaStart,t.thetaLength)}}class I0 extends Ir{constructor(t=new Bp([new Oi(0,.5),new Oi(-.5,-.5),new Oi(.5,-.5)]),e=12){super(),this.type="ShapeGeometry",this.parameters={shapes:t,curveSegments:e};const n=[],r=[],s=[],a=[];let l=0,u=0;if(!1===Array.isArray(t))h(t);else for(let m=0;m<t.length;m++)h(t[m]),this.addGroup(l,u,m),l+=u,u=0;function h(m){const _=r.length/3,v=m.extractPoints(e);let S=v.shape;const T=v.holes;!1===Np.isClockWise(S)&&(S=S.reverse());for(let j=0,P=T.length;j<P;j++){const E=T[j];!0===Np.isClockWise(E)&&(T[j]=E.reverse())}const I=Np.triangulateShape(S,T);for(let j=0,P=T.length;j<P;j++)S=S.concat(T[j]);for(let j=0,P=S.length;j<P;j++){const E=S[j];r.push(E.x,E.y,0),s.push(0,0,1),a.push(E.x,E.y)}for(let j=0,P=I.length;j<P;j++){const E=I[j];n.push(E[0]+_,E[1]+_,E[2]+_),u+=3}}this.setIndex(n),this.setAttribute("position",new Jn(r,3)),this.setAttribute("normal",new Jn(s,3)),this.setAttribute("uv",new Jn(a,2))}toJSON(){const t=super.toJSON();return function wSe(i,t){if(t.shapes=[],Array.isArray(i))for(let e=0,n=i.length;e<n;e++)t.shapes.push(i[e].uuid);else t.shapes.push(i.uuid);return t}(this.parameters.shapes,t)}static fromJSON(t,e){const n=[];for(let r=0,s=t.shapes.length;r<s;r++)n.push(e[t.shapes[r]]);return new I0(n,t.curveSegments)}}class L0 extends Ir{constructor(t=1,e=32,n=16,r=0,s=2*Math.PI,a=0,l=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:r,phiLength:s,thetaStart:a,thetaLength:l},e=Math.max(3,Math.floor(e)),n=Math.max(2,Math.floor(n));const u=Math.min(a+l,Math.PI);let h=0;const m=[],_=new He,v=new He,S=[],T=[],I=[],j=[];for(let P=0;P<=n;P++){const E=[],ie=P/n;let ee=0;0==P&&0==a?ee=.5/e:P==n&&u==Math.PI&&(ee=-.5/e);for(let ce=0;ce<=e;ce++){const ye=ce/e;_.x=-t*Math.cos(r+ye*s)*Math.sin(a+ie*l),_.y=t*Math.cos(a+ie*l),_.z=t*Math.sin(r+ye*s)*Math.sin(a+ie*l),T.push(_.x,_.y,_.z),v.copy(_).normalize(),I.push(v.x,v.y,v.z),j.push(ye+ee,1-ie),E.push(h++)}m.push(E)}for(let P=0;P<n;P++)for(let E=0;E<e;E++){const ie=m[P][E+1],ee=m[P][E],ce=m[P+1][E],ye=m[P+1][E+1];(0!==P||a>0)&&S.push(ie,ee,ye),(P!==n-1||u<Math.PI)&&S.push(ee,ce,ye)}this.setIndex(S),this.setAttribute("position",new Jn(T,3)),this.setAttribute("normal",new Jn(I,3)),this.setAttribute("uv",new Jn(j,2))}static fromJSON(t){return new L0(t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength)}}class tC extends Fp{constructor(t=1,e=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,e),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new tC(t.radius,t.detail)}}class iC extends Ir{constructor(t=1,e=.4,n=8,r=6,s=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:r,arc:s},n=Math.floor(n),r=Math.floor(r);const a=[],l=[],u=[],h=[],m=new He,_=new He,v=new He;for(let S=0;S<=n;S++)for(let T=0;T<=r;T++){const I=T/r*s,j=S/n*Math.PI*2;_.x=(t+e*Math.cos(j))*Math.cos(I),_.y=(t+e*Math.cos(j))*Math.sin(I),_.z=e*Math.sin(j),l.push(_.x,_.y,_.z),m.x=t*Math.cos(I),m.y=t*Math.sin(I),v.subVectors(_,m).normalize(),u.push(v.x,v.y,v.z),h.push(T/r),h.push(S/n)}for(let S=1;S<=n;S++)for(let T=1;T<=r;T++){const j=(r+1)*(S-1)+T-1,P=(r+1)*(S-1)+T,E=(r+1)*S+T;a.push((r+1)*S+T-1,j,E),a.push(j,P,E)}this.setIndex(a),this.setAttribute("position",new Jn(l,3)),this.setAttribute("normal",new Jn(u,3)),this.setAttribute("uv",new Jn(h,2))}static fromJSON(t){return new iC(t.radius,t.tube,t.radialSegments,t.tubularSegments,t.arc)}}class nC extends Ir{constructor(t=1,e=.4,n=64,r=8,s=2,a=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:r,p:s,q:a},n=Math.floor(n),r=Math.floor(r);const l=[],u=[],h=[],m=[],_=new He,v=new He,S=new He,T=new He,I=new He,j=new He,P=new He;for(let ie=0;ie<=n;++ie){const ee=ie/n*s*Math.PI*2;E(ee,s,a,t,S),E(ee+.01,s,a,t,T),j.subVectors(T,S),P.addVectors(T,S),I.crossVectors(j,P),P.crossVectors(I,j),I.normalize(),P.normalize();for(let ce=0;ce<=r;++ce){const ye=ce/r*Math.PI*2,Ce=-e*Math.cos(ye),Ge=e*Math.sin(ye);_.x=S.x+(Ce*P.x+Ge*I.x),_.y=S.y+(Ce*P.y+Ge*I.y),_.z=S.z+(Ce*P.z+Ge*I.z),u.push(_.x,_.y,_.z),v.subVectors(_,S).normalize(),h.push(v.x,v.y,v.z),m.push(ie/n),m.push(ce/r)}}for(let ie=1;ie<=n;ie++)for(let ee=1;ee<=r;ee++){const ye=(r+1)*ie+(ee-1),Ce=(r+1)*ie+ee,Ge=(r+1)*(ie-1)+ee;l.push((r+1)*(ie-1)+(ee-1),ye,Ge),l.push(ye,Ce,Ge)}function E(ie,ee,ce,ye,Ce){const Ge=Math.cos(ie),Qe=Math.sin(ie),nt=ce/ee*ie,ge=Math.cos(nt);Ce.x=ye*(2+ge)*.5*Ge,Ce.y=ye*(2+ge)*Qe*.5,Ce.z=ye*Math.sin(nt)*.5}this.setIndex(l),this.setAttribute("position",new Jn(u,3)),this.setAttribute("normal",new Jn(h,3)),this.setAttribute("uv",new Jn(m,2))}static fromJSON(t){return new nC(t.radius,t.tube,t.tubularSegments,t.radialSegments,t.p,t.q)}}class rC extends Ir{constructor(t=new K2(new He(-1,-1,0),new He(-1,1,0),new He(1,1,0)),e=64,n=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:r,closed:s};const a=t.computeFrenetFrames(e,s);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;const l=new He,u=new He,h=new Oi;let m=new He;const _=[],v=[],S=[],T=[];function j(ie){m=t.getPointAt(ie/e,m);const ee=a.normals[ie],ce=a.binormals[ie];for(let ye=0;ye<=r;ye++){const Ce=ye/r*Math.PI*2,Ge=Math.sin(Ce),Qe=-Math.cos(Ce);u.x=Qe*ee.x+Ge*ce.x,u.y=Qe*ee.y+Ge*ce.y,u.z=Qe*ee.z+Ge*ce.z,u.normalize(),v.push(u.x,u.y,u.z),l.x=m.x+n*u.x,l.y=m.y+n*u.y,l.z=m.z+n*u.z,_.push(l.x,l.y,l.z)}}(function I(){for(let ie=0;ie<e;ie++)j(ie);j(!1===s?e:0),function E(){for(let ie=0;ie<=e;ie++)for(let ee=0;ee<=r;ee++)h.x=ie/e,h.y=ee/r,S.push(h.x,h.y)}(),function P(){for(let ie=1;ie<=e;ie++)for(let ee=1;ee<=r;ee++){const ye=(r+1)*ie+(ee-1),Ce=(r+1)*ie+ee,Ge=(r+1)*(ie-1)+ee;T.push((r+1)*(ie-1)+(ee-1),ye,Ge),T.push(ye,Ce,Ge)}}()})(),this.setIndex(T),this.setAttribute("position",new Jn(_,3)),this.setAttribute("normal",new Jn(v,3)),this.setAttribute("uv",new Jn(S,2))}toJSON(){const t=super.toJSON();return t.path=this.parameters.path.toJSON(),t}static fromJSON(t){return new rC((new z5[t.path.type]).fromJSON(t.path),t.tubularSegments,t.radius,t.radialSegments,t.closed)}}class W5 extends Ir{constructor(t=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:t},null!==t){const e=[],n=new Set,r=new He,s=new He;if(null!==t.index){const a=t.attributes.position,l=t.index;let u=t.groups;0===u.length&&(u=[{start:0,count:l.count,materialIndex:0}]);for(let h=0,m=u.length;h<m;++h){const _=u[h],v=_.start;for(let T=v,I=v+_.count;T<I;T+=3)for(let j=0;j<3;j++){const P=l.getX(T+j),E=l.getX(T+(j+1)%3);r.fromBufferAttribute(a,P),s.fromBufferAttribute(a,E),!0===OY(r,s,n)&&(e.push(r.x,r.y,r.z),e.push(s.x,s.y,s.z))}}}else{const a=t.attributes.position;for(let l=0,u=a.count/3;l<u;l++)for(let h=0;h<3;h++){const _=3*l+(h+1)%3;r.fromBufferAttribute(a,3*l+h),s.fromBufferAttribute(a,_),!0===OY(r,s,n)&&(e.push(r.x,r.y,r.z),e.push(s.x,s.y,s.z))}}this.setAttribute("position",new Jn(e,3))}}}function OY(i,t,e){const n=`${i.x},${i.y},${i.z}-${t.x},${t.y},${t.z}`,r=`${t.x},${t.y},${t.z}-${i.x},${i.y},${i.z}`;return!0!==e.has(n)&&!0!==e.has(r)&&(e.add(n,r),!0)}var FY=Object.freeze({__proto__:null,BoxGeometry:Cg,BoxBufferGeometry:Cg,CircleGeometry:ZS,CircleBufferGeometry:ZS,ConeGeometry:YS,ConeBufferGeometry:YS,CylinderGeometry:Gy,CylinderBufferGeometry:Gy,DodecahedronGeometry:KS,DodecahedronBufferGeometry:KS,EdgesGeometry:I5,ExtrudeGeometry:Hp,ExtrudeBufferGeometry:Hp,IcosahedronGeometry:JS,IcosahedronBufferGeometry:JS,LatheGeometry:$S,LatheBufferGeometry:$S,OctahedronGeometry:P0,OctahedronBufferGeometry:P0,PlaneGeometry:M0,PlaneBufferGeometry:M0,PolyhedronGeometry:Fp,PolyhedronBufferGeometry:Fp,RingGeometry:eC,RingBufferGeometry:eC,ShapeGeometry:I0,ShapeBufferGeometry:I0,SphereGeometry:L0,SphereBufferGeometry:L0,TetrahedronGeometry:tC,TetrahedronBufferGeometry:tC,TorusGeometry:iC,TorusBufferGeometry:iC,TorusKnotGeometry:nC,TorusKnotBufferGeometry:nC,TubeGeometry:rC,TubeBufferGeometry:rC,WireframeGeometry:W5});class j5 extends kc{constructor(t){super(),this.type="ShadowMaterial",this.color=new En(0),this.transparent=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this}}j5.prototype.isShadowMaterial=!0;class tI extends kc{constructor(t){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new En(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new En(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=v0,this.normalScale=new Oi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this}}tI.prototype.isMeshStandardMaterial=!0;class q5 extends tI{constructor(t){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Oi(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return $c(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(e){this.ior=(1+.4*e)/(1-.4*e)}}),this.sheenColor=new En(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new En(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new En(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._transmission=0,this.setValues(t)}get sheen(){return this._sheen}set sheen(t){this._sheen>0!=t>0&&this.version++,this._sheen=t}get clearcoat(){return this._clearcoat}set clearcoat(t){this._clearcoat>0!=t>0&&this.version++,this._clearcoat=t}get transmission(){return this._transmission}set transmission(t){this._transmission>0!=t>0&&this.version++,this._transmission=t}copy(t){return super.copy(t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.ior=t.ior,this.sheen=t.sheen,this.sheenColor.copy(t.sheenColor),this.sheenColorMap=t.sheenColorMap,this.sheenRoughness=t.sheenRoughness,this.sheenRoughnessMap=t.sheenRoughnessMap,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this.thickness=t.thickness,this.thicknessMap=t.thicknessMap,this.attenuationDistance=t.attenuationDistance,this.attenuationColor.copy(t.attenuationColor),this.specularIntensity=t.specularIntensity,this.specularIntensityMap=t.specularIntensityMap,this.specularColor.copy(t.specularColor),this.specularColorMap=t.specularColorMap,this}}q5.prototype.isMeshPhysicalMaterial=!0;class X5 extends kc{constructor(t){super(),this.type="MeshPhongMaterial",this.color=new En(16777215),this.specular=new En(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new En(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=v0,this.normalScale=new Oi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=RT,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this}}X5.prototype.isMeshPhongMaterial=!0;class Z5 extends kc{constructor(t){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new En(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new En(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=v0,this.normalScale=new Oi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this}}Z5.prototype.isMeshToonMaterial=!0;class fE extends kc{constructor(t){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=v0,this.normalScale=new Oi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.flatShading=t.flatShading,this}}fE.prototype.isMeshNormalMaterial=!0;class Y5 extends kc{constructor(t){super(),this.type="MeshLambertMaterial",this.color=new En(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new En(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=RT,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this}}Y5.prototype.isMeshLambertMaterial=!0;class K5 extends kc{constructor(t){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new En(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=v0,this.normalScale=new Oi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.flatShading=t.flatShading,this}}K5.prototype.isMeshMatcapMaterial=!0;class Q5 extends Ic{constructor(t){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}copy(t){return super.copy(t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this}}Q5.prototype.isLineDashedMaterial=!0;var SSe=Object.freeze({__proto__:null,ShadowMaterial:j5,SpriteMaterial:k2,RawShaderMaterial:HS,ShaderMaterial:Mg,PointsMaterial:k0,MeshPhysicalMaterial:q5,MeshStandardMaterial:tI,MeshPhongMaterial:X5,MeshToonMaterial:Z5,MeshNormalMaterial:fE,MeshLambertMaterial:Y5,MeshDepthMaterial:A2,MeshDistanceMaterial:D2,MeshBasicMaterial:Sg,MeshMatcapMaterial:K5,LineDashedMaterial:Q5,LineBasicMaterial:Ic,Material:kc});const xa={arraySlice:function(i,t,e){return xa.isTypedArray(i)?new i.constructor(i.subarray(t,void 0!==e?e:i.length)):i.slice(t,e)},convertArray:function(i,t,e){return!i||!e&&i.constructor===t?i:"number"==typeof t.BYTES_PER_ELEMENT?new t(i):Array.prototype.slice.call(i)},isTypedArray:function(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)},getKeyframeOrder:function(i){const e=i.length,n=new Array(e);for(let r=0;r!==e;++r)n[r]=r;return n.sort(function t(r,s){return i[r]-i[s]}),n},sortedArray:function(i,t,e){const n=i.length,r=new i.constructor(n);for(let s=0,a=0;a!==n;++s){const l=e[s]*t;for(let u=0;u!==t;++u)r[a++]=i[l+u]}return r},flattenJSON:function(i,t,e,n){let r=1,s=i[0];for(;void 0!==s&&void 0===s[n];)s=i[r++];if(void 0===s)return;let a=s[n];if(void 0!==a)if(Array.isArray(a))do{a=s[n],void 0!==a&&(t.push(s.time),e.push.apply(e,a)),s=i[r++]}while(void 0!==s);else if(void 0!==a.toArray)do{a=s[n],void 0!==a&&(t.push(s.time),a.toArray(e,e.length)),s=i[r++]}while(void 0!==s);else do{a=s[n],void 0!==a&&(t.push(s.time),e.push(a)),s=i[r++]}while(void 0!==s)},subclip:function(i,t,e,n,r=30){const s=i.clone();s.name=t;const a=[];for(let u=0;u<s.tracks.length;++u){const h=s.tracks[u],m=h.getValueSize(),_=[],v=[];for(let S=0;S<h.times.length;++S){const T=h.times[S]*r;if(!(T<e||T>=n)){_.push(h.times[S]);for(let I=0;I<m;++I)v.push(h.values[S*m+I])}}0!==_.length&&(h.times=xa.convertArray(_,h.times.constructor),h.values=xa.convertArray(v,h.values.constructor),a.push(h))}s.tracks=a;let l=1/0;for(let u=0;u<s.tracks.length;++u)l>s.tracks[u].times[0]&&(l=s.tracks[u].times[0]);for(let u=0;u<s.tracks.length;++u)s.tracks[u].shift(-1*l);return s.resetDuration(),s},makeClipAdditive:function(i,t=0,e=i,n=30){n<=0&&(n=30);const r=e.tracks.length,s=t/n;for(let a=0;a<r;++a){const l=e.tracks[a],u=l.ValueTypeName;if("bool"===u||"string"===u)continue;const h=i.tracks.find(function(P){return P.name===l.name&&P.ValueTypeName===u});if(void 0===h)continue;let m=0;const _=l.getValueSize();l.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(m=_/3);let v=0;const S=h.getValueSize();h.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(v=S/3);const T=l.times.length-1;let I;if(s<=l.times[0])I=xa.arraySlice(l.values,m,_-m);else if(s>=l.times[T]){const P=T*_+m;I=xa.arraySlice(l.values,P,P+_-m)}else{const P=l.createInterpolant(),E=m,ie=_-m;P.evaluate(s),I=xa.arraySlice(P.resultBuffer,E,ie)}"quaternion"===u&&(new eu).fromArray(I).normalize().conjugate().toArray(I);const j=h.times.length;for(let P=0;P<j;++P){const E=P*S+v;if("quaternion"===u)eu.multiplyQuaternionsFlat(h.values,E,I,0,h.values,E);else{const ie=S-2*v;for(let ee=0;ee<ie;++ee)h.values[E+ee]-=I[ee]}}}return i.blendMode=jV,i}};class Eg{constructor(t,e,n,r){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new e.constructor(n),this.sampleValues=e,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(t){const e=this.parameterPositions;let n=this._cachedIndex,r=e[n],s=e[n-1];e:{t:{let a;i:{n:if(!(t<r)){for(let l=n+2;;){if(void 0===r){if(t<s)break n;return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,t,s)}if(n===l)break;if(s=r,r=e[++n],t<r)break t}a=e.length;break i}if(t>=s)break e;{const l=e[1];t<l&&(n=2,s=l);for(let u=n-2;;){if(void 0===s)return this._cachedIndex=0,this.beforeStart_(0,t,r);if(n===u)break;if(r=s,s=e[--n-1],t>=s)break t}a=n,n=0}}for(;n<a;){const l=n+a>>>1;t<e[l]?a=l:n=l+1}if(r=e[n],s=e[n-1],void 0===s)return this._cachedIndex=0,this.beforeStart_(0,t,r);if(void 0===r)return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,s,t)}this._cachedIndex=n,this.intervalChanged_(n,s,r)}return this.interpolate_(n,s,t,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(t){const e=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=t*r;for(let a=0;a!==r;++a)e[a]=n[s+a];return e}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}Eg.prototype.beforeStart_=Eg.prototype.copySampleValue_,Eg.prototype.afterEnd_=Eg.prototype.copySampleValue_;class BY extends Eg{constructor(t,e,n,r){super(t,e,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:_0,endingEnd:_0}}intervalChanged_(t,e,n){const r=this.parameterPositions;let s=t-2,a=t+1,l=r[s],u=r[a];if(void 0===l)switch(this.getSettings_().endingStart){case y0:s=t,l=2*e-n;break;case HT:s=r.length-2,l=e+r[s]-r[s+1];break;default:s=t,l=n}if(void 0===u)switch(this.getSettings_().endingEnd){case y0:a=t,u=2*n-e;break;case HT:a=1,u=n+r[1]-r[0];break;default:a=t-1,u=e}const h=.5*(n-e),m=this.valueSize;this._weightPrev=h/(e-l),this._weightNext=h/(u-n),this._offsetPrev=s*m,this._offsetNext=a*m}interpolate_(t,e,n,r){const s=this.resultBuffer,a=this.sampleValues,l=this.valueSize,u=t*l,h=u-l,m=this._offsetPrev,_=this._offsetNext,v=this._weightPrev,S=this._weightNext,T=(n-e)/(r-e),I=T*T,j=I*T,P=-v*j+2*v*I-v*T,E=(1+v)*j+(-1.5-2*v)*I+(-.5+v)*T+1,ie=(-1-S)*j+(1.5+S)*I+.5*T,ee=S*j-S*I;for(let ce=0;ce!==l;++ce)s[ce]=P*a[m+ce]+E*a[h+ce]+ie*a[u+ce]+ee*a[_+ce];return s}}class J5 extends Eg{constructor(t,e,n,r){super(t,e,n,r)}interpolate_(t,e,n,r){const s=this.resultBuffer,a=this.sampleValues,l=this.valueSize,u=t*l,h=u-l,m=(n-e)/(r-e),_=1-m;for(let v=0;v!==l;++v)s[v]=a[h+v]*_+a[u+v]*m;return s}}class NY extends Eg{constructor(t,e,n,r){super(t,e,n,r)}interpolate_(t){return this.copySampleValue_(t-1)}}class Yf{constructor(t,e,n,r){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=xa.convertArray(e,this.TimeBufferType),this.values=xa.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(t){const e=t.constructor;let n;if(e.toJSON!==this.toJSON)n=e.toJSON(t);else{n={name:t.name,times:xa.convertArray(t.times,Array),values:xa.convertArray(t.values,Array)};const r=t.getInterpolation();r!==t.DefaultInterpolation&&(n.interpolation=r)}return n.type=t.ValueTypeName,n}InterpolantFactoryMethodDiscrete(t){return new NY(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodLinear(t){return new J5(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodSmooth(t){return new BY(this.times,this.values,this.getValueSize(),t)}setInterpolation(t){let e;switch(t){case BT:e=this.InterpolantFactoryMethodDiscrete;break;case NT:e=this.InterpolantFactoryMethodLinear;break;case ZP:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=e,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return BT;case this.InterpolantFactoryMethodLinear:return NT;case this.InterpolantFactoryMethodSmooth:return ZP}}getValueSize(){return this.values.length/this.times.length}shift(t){if(0!==t){const e=this.times;for(let n=0,r=e.length;n!==r;++n)e[n]+=t}return this}scale(t){if(1!==t){const e=this.times;for(let n=0,r=e.length;n!==r;++n)e[n]*=t}return this}trim(t,e){const n=this.times,r=n.length;let s=0,a=r-1;for(;s!==r&&n[s]<t;)++s;for(;-1!==a&&n[a]>e;)--a;if(++a,0!==s||a!==r){s>=a&&(a=Math.max(a,1),s=a-1);const l=this.getValueSize();this.times=xa.arraySlice(n,s,a),this.values=xa.arraySlice(this.values,s*l,a*l)}return this}validate(){let t=!0;const e=this.getValueSize();e-Math.floor(e)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);const n=this.times,r=this.values,s=n.length;0===s&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);let a=null;for(let l=0;l!==s;l++){const u=n[l];if("number"==typeof u&&isNaN(u)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,l,u),t=!1;break}if(null!==a&&a>u){console.error("THREE.KeyframeTrack: Out of order keys.",this,l,u,a),t=!1;break}a=u}if(void 0!==r&&xa.isTypedArray(r))for(let l=0,u=r.length;l!==u;++l){const h=r[l];if(isNaN(h)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,l,h),t=!1;break}}return t}optimize(){const t=xa.arraySlice(this.times),e=xa.arraySlice(this.values),n=this.getValueSize(),r=this.getInterpolation()===ZP,s=t.length-1;let a=1;for(let l=1;l<s;++l){let u=!1;const h=t[l];if(h!==t[l+1]&&(1!==l||h!==t[0]))if(r)u=!0;else{const _=l*n,v=_-n,S=_+n;for(let T=0;T!==n;++T){const I=e[_+T];if(I!==e[v+T]||I!==e[S+T]){u=!0;break}}}if(u){if(l!==a){t[a]=t[l];const _=l*n,v=a*n;for(let S=0;S!==n;++S)e[v+S]=e[_+S]}++a}}if(s>0){t[a]=t[s];for(let l=s*n,u=a*n,h=0;h!==n;++h)e[u+h]=e[l+h];++a}return a!==t.length?(this.times=xa.arraySlice(t,0,a),this.values=xa.arraySlice(e,0,a*n)):(this.times=t,this.values=e),this}clone(){const t=xa.arraySlice(this.times,0),e=xa.arraySlice(this.values,0),r=new(0,this.constructor)(this.name,t,e);return r.createInterpolant=this.createInterpolant,r}}Yf.prototype.TimeBufferType=Float32Array,Yf.prototype.ValueBufferType=Float32Array,Yf.prototype.DefaultInterpolation=NT;class O0 extends Yf{}O0.prototype.ValueTypeName="bool",O0.prototype.ValueBufferType=Array,O0.prototype.DefaultInterpolation=BT,O0.prototype.InterpolantFactoryMethodLinear=void 0,O0.prototype.InterpolantFactoryMethodSmooth=void 0;class $5 extends Yf{}$5.prototype.ValueTypeName="color";class pE extends Yf{}pE.prototype.ValueTypeName="number";class HY extends Eg{constructor(t,e,n,r){super(t,e,n,r)}interpolate_(t,e,n,r){const s=this.resultBuffer,a=this.sampleValues,l=this.valueSize,u=(n-e)/(r-e);let h=t*l;for(let m=h+l;h!==m;h+=4)eu.slerpFlat(s,0,a,h-l,a,h,u);return s}}class sC extends Yf{InterpolantFactoryMethodLinear(t){return new HY(this.times,this.values,this.getValueSize(),t)}}sC.prototype.ValueTypeName="quaternion",sC.prototype.DefaultInterpolation=NT,sC.prototype.InterpolantFactoryMethodSmooth=void 0;class F0 extends Yf{}F0.prototype.ValueTypeName="string",F0.prototype.ValueBufferType=Array,F0.prototype.DefaultInterpolation=BT,F0.prototype.InterpolantFactoryMethodLinear=void 0,F0.prototype.InterpolantFactoryMethodSmooth=void 0;class mE extends Yf{}mE.prototype.ValueTypeName="vector";class gE{constructor(t,e=-1,n,r=YP){this.name=t,this.tracks=n,this.duration=e,this.blendMode=r,this.uuid=Nh(),this.duration<0&&this.resetDuration()}static parse(t){const e=[],n=t.tracks,r=1/(t.fps||1);for(let a=0,l=n.length;a!==l;++a)e.push(MSe(n[a]).scale(r));const s=new this(t.name,t.duration,e,t.blendMode);return s.uuid=t.uuid,s}static toJSON(t){const e=[],n=t.tracks,r={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid,blendMode:t.blendMode};for(let s=0,a=n.length;s!==a;++s)e.push(Yf.toJSON(n[s]));return r}static CreateFromMorphTargetSequence(t,e,n,r){const s=e.length,a=[];for(let l=0;l<s;l++){let u=[],h=[];u.push((l+s-1)%s,l,(l+1)%s),h.push(0,1,0);const m=xa.getKeyframeOrder(u);u=xa.sortedArray(u,1,m),h=xa.sortedArray(h,1,m),!r&&0===u[0]&&(u.push(s),h.push(h[0])),a.push(new pE(".morphTargetInfluences["+e[l].name+"]",u,h).scale(1/n))}return new this(t,-1,a)}static findByName(t,e){let n=t;if(!Array.isArray(t)){const r=t;n=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<n.length;r++)if(n[r].name===e)return n[r];return null}static CreateClipsFromMorphTargetSequences(t,e,n){const r={},s=/^([\w-]*?)([\d]+)$/;for(let l=0,u=t.length;l<u;l++){const h=t[l],m=h.name.match(s);if(m&&m.length>1){const _=m[1];let v=r[_];v||(r[_]=v=[]),v.push(h)}}const a=[];for(const l in r)a.push(this.CreateFromMorphTargetSequence(l,r[l],e,n));return a}static parseAnimation(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(_,v,S,T,I){if(0!==S.length){const j=[],P=[];xa.flattenJSON(S,j,P,T),0!==j.length&&I.push(new _(v,j,P))}},r=[],s=t.name||"default",a=t.fps||30,l=t.blendMode;let u=t.length||-1;const h=t.hierarchy||[];for(let _=0;_<h.length;_++){const v=h[_].keys;if(v&&0!==v.length)if(v[0].morphTargets){const S={};let T;for(T=0;T<v.length;T++)if(v[T].morphTargets)for(let I=0;I<v[T].morphTargets.length;I++)S[v[T].morphTargets[I]]=-1;for(const I in S){const j=[],P=[];for(let E=0;E!==v[T].morphTargets.length;++E){const ie=v[T];j.push(ie.time),P.push(ie.morphTarget===I?1:0)}r.push(new pE(".morphTargetInfluence["+I+"]",j,P))}u=S.length*(a||1)}else{const S=".bones["+e[_].name+"]";n(mE,S+".position",v,"pos",r),n(sC,S+".quaternion",v,"rot",r),n(mE,S+".scale",v,"scl",r)}}return 0===r.length?null:new this(s,u,r,l)}resetDuration(){let e=0;for(let n=0,r=this.tracks.length;n!==r;++n){const s=this.tracks[n];e=Math.max(e,s.times[s.times.length-1])}return this.duration=e,this}trim(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this}validate(){let t=!0;for(let e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t}optimize(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}clone(){const t=[];for(let e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new this.constructor(this.name,this.duration,t,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function MSe(i){if(void 0===i.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const t=function CSe(i){switch(i.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return pE;case"vector":case"vector2":case"vector3":case"vector4":return mE;case"color":return $5;case"quaternion":return sC;case"bool":case"boolean":return O0;case"string":return F0}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+i)}(i.type);if(void 0===i.times){const e=[],n=[];xa.flattenJSON(i.keys,e,n,"value"),i.times=e,i.values=n}return void 0!==t.parse?t.parse(i):new t(i.name,i.times,i.values,i.interpolation)}const B0={enabled:!1,files:{},add:function(i,t){!1!==this.enabled&&(this.files[i]=t)},get:function(i){if(!1!==this.enabled)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}};class iI{constructor(t,e,n){const r=this;let u,s=!1,a=0,l=0;const h=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(m){l++,!1===s&&void 0!==r.onStart&&r.onStart(m,a,l),s=!0},this.itemEnd=function(m){a++,void 0!==r.onProgress&&r.onProgress(m,a,l),a===l&&(s=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(m){void 0!==r.onError&&r.onError(m)},this.resolveURL=function(m){return u?u(m):m},this.setURLModifier=function(m){return u=m,this},this.addHandler=function(m,_){return h.push(m,_),this},this.removeHandler=function(m){const _=h.indexOf(m);return-1!==_&&h.splice(_,2),this},this.getHandler=function(m){for(let _=0,v=h.length;_<v;_+=2){const S=h[_],T=h[_+1];if(S.global&&(S.lastIndex=0),S.test(m))return T}return null}}}const VY=new iI;class Fu{constructor(t){this.manager=void 0!==t?t:VY,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,e){const n=this;return new Promise(function(r,s){n.load(t,r,e,s)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}const Ag={};class Vp extends Fu{constructor(t){super(t)}load(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const s=B0.get(t);if(void 0!==s)return this.manager.itemStart(t),setTimeout(()=>{e&&e(s),this.manager.itemEnd(t)},0),s;if(void 0!==Ag[t])return void Ag[t].push({onLoad:e,onProgress:n,onError:r});Ag[t]=[],Ag[t].push({onLoad:e,onProgress:n,onError:r});const a=new Request(t,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),l=this.mimeType,u=this.responseType;fetch(a).then(h=>{if(200===h.status||0===h.status){if(0===h.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"==typeof ReadableStream||void 0===h.body.getReader)return h;const m=Ag[t],_=h.body.getReader(),v=h.headers.get("Content-Length"),S=v?parseInt(v):0,T=0!==S;let I=0;const j=new ReadableStream({start(P){!function E(){_.read().then(({done:ie,value:ee})=>{if(ie)P.close();else{I+=ee.byteLength;const ce=new ProgressEvent("progress",{lengthComputable:T,loaded:I,total:S});for(let ye=0,Ce=m.length;ye<Ce;ye++){const Ge=m[ye];Ge.onProgress&&Ge.onProgress(ce)}P.enqueue(ee),E()}})}()}});return new Response(j)}throw Error(`fetch for "${h.url}" responded with ${h.status}: ${h.statusText}`)}).then(h=>{switch(u){case"arraybuffer":return h.arrayBuffer();case"blob":return h.blob();case"document":return h.text().then(m=>(new DOMParser).parseFromString(m,l));case"json":return h.json();default:if(void 0===l)return h.text();{const _=/charset="?([^;"\s]*)"?/i.exec(l),v=_&&_[1]?_[1].toLowerCase():void 0,S=new TextDecoder(v);return h.arrayBuffer().then(T=>S.decode(T))}}}).then(h=>{B0.add(t,h);const m=Ag[t];delete Ag[t];for(let _=0,v=m.length;_<v;_++){const S=m[_];S.onLoad&&S.onLoad(h)}}).catch(h=>{const m=Ag[t];if(void 0===m)throw this.manager.itemError(t),h;delete Ag[t];for(let _=0,v=m.length;_<v;_++){const S=m[_];S.onError&&S.onError(h)}this.manager.itemError(t)}).finally(()=>{this.manager.itemEnd(t)}),this.manager.itemStart(t)}setResponseType(t){return this.responseType=t,this}setMimeType(t){return this.mimeType=t,this}}class TSe extends Fu{constructor(t){super(t)}load(t,e,n,r){const s=this,a=new Vp(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(t,function(l){try{e(s.parse(JSON.parse(l)))}catch(u){r?r(u):console.error(u),s.manager.itemError(t)}},n,r)}parse(t){const e=[];for(let n=0;n<t.length;n++){const r=gE.parse(t[n]);e.push(r)}return e}}class ESe extends Fu{constructor(t){super(t)}load(t,e,n,r){const s=this,a=[],l=new k5,u=new Vp(this.manager);u.setPath(this.path),u.setResponseType("arraybuffer"),u.setRequestHeader(this.requestHeader),u.setWithCredentials(s.withCredentials);let h=0;function m(_){u.load(t[_],function(v){const S=s.parse(v,!0);a[_]={width:S.width,height:S.height,format:S.format,mipmaps:S.mipmaps},h+=1,6===h&&(1===S.mipmapCount&&(l.minFilter=Ka),l.image=a,l.format=S.format,l.needsUpdate=!0,e&&e(l))},n,r)}if(Array.isArray(t))for(let _=0,v=t.length;_<v;++_)m(_);else u.load(t,function(_){const v=s.parse(_,!0);if(v.isCubemap){const S=v.mipmaps.length/v.mipmapCount;for(let T=0;T<S;T++){a[T]={mipmaps:[]};for(let I=0;I<v.mipmapCount;I++)a[T].mipmaps.push(v.mipmaps[T*v.mipmapCount+I]),a[T].format=v.format,a[T].width=v.width,a[T].height=v.height}l.image=a}else l.image.width=v.width,l.image.height=v.height,l.mipmaps=v.mipmaps;1===v.mipmapCount&&(l.minFilter=Ka),l.format=v.format,l.needsUpdate=!0,e&&e(l)},n,r);return l}}class _E extends Fu{constructor(t){super(t)}load(t,e,n,r){void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const s=this,a=B0.get(t);if(void 0!==a)return s.manager.itemStart(t),setTimeout(function(){e&&e(a),s.manager.itemEnd(t)},0),a;const l=UT("img");function u(){m(),B0.add(t,this),e&&e(this),s.manager.itemEnd(t)}function h(_){m(),r&&r(_),s.manager.itemError(t),s.manager.itemEnd(t)}function m(){l.removeEventListener("load",u,!1),l.removeEventListener("error",h,!1)}return l.addEventListener("load",u,!1),l.addEventListener("error",h,!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(l.crossOrigin=this.crossOrigin),s.manager.itemStart(t),l.src=t,l}}class zY extends Fu{constructor(t){super(t)}load(t,e,n,r){const s=new BS,a=new _E(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);let l=0;function u(h){a.load(t[h],function(m){s.images[h]=m,l++,6===l&&(s.needsUpdate=!0,e&&e(s))},void 0,r)}for(let h=0;h<t.length;++h)u(h);return s}}class UY extends Fu{constructor(t){super(t)}load(t,e,n,r){const s=this,a=new D0,l=new Vp(this.manager);return l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setPath(this.path),l.setWithCredentials(s.withCredentials),l.load(t,function(u){const h=s.parse(u);!h||(void 0!==h.image?a.image=h.image:void 0!==h.data&&(a.image.width=h.width,a.image.height=h.height,a.image.data=h.data),a.wrapS=void 0!==h.wrapS?h.wrapS:Kc,a.wrapT=void 0!==h.wrapT?h.wrapT:Kc,a.magFilter=void 0!==h.magFilter?h.magFilter:Ka,a.minFilter=void 0!==h.minFilter?h.minFilter:Ka,a.anisotropy=void 0!==h.anisotropy?h.anisotropy:1,void 0!==h.encoding&&(a.encoding=h.encoding),void 0!==h.flipY&&(a.flipY=h.flipY),void 0!==h.format&&(a.format=h.format),void 0!==h.type&&(a.type=h.type),void 0!==h.mipmaps&&(a.mipmaps=h.mipmaps,a.minFilter=f0),1===h.mipmapCount&&(a.minFilter=Ka),void 0!==h.generateMipmaps&&(a.generateMipmaps=h.generateMipmaps),a.needsUpdate=!0,e&&e(a,h))},n,r),a}}class GY extends Fu{constructor(t){super(t)}load(t,e,n,r){const s=new Jl,a=new _E(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(t,function(l){s.image=l,s.needsUpdate=!0,void 0!==e&&e(s)},n,r),s}}class Kf extends Zs{constructor(t,e=1){super(),this.type="Light",this.color=new En(t),this.intensity=e}dispose(){}copy(t){return super.copy(t),this.color.copy(t.color),this.intensity=t.intensity,this}toJSON(t){const e=super.toJSON(t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}Kf.prototype.isLight=!0;class e4 extends Kf{constructor(t,e,n){super(t,n),this.type="HemisphereLight",this.position.copy(Zs.DefaultUp),this.updateMatrix(),this.groundColor=new En(e)}copy(t){return Kf.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}e4.prototype.isHemisphereLight=!0;const WY=new nr,jY=new He,qY=new He;class t4{constructor(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Oi(512,512),this.map=null,this.mapPass=null,this.matrix=new nr,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new XT,this._frameExtents=new Oi(1,1),this._viewportCount=1,this._viewports=[new Bo(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(t){const e=this.camera,n=this.matrix;jY.setFromMatrixPosition(t.matrixWorld),e.position.copy(jY),qY.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(qY),e.updateMatrixWorld(),WY.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(WY),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(e.projectionMatrix),n.multiply(e.matrixWorldInverse)}getViewport(t){return this._viewports[t]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const t={};return 0!==this.bias&&(t.bias=this.bias),0!==this.normalBias&&(t.normalBias=this.normalBias),1!==this.radius&&(t.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}class XY extends t4{constructor(){super(new mc(50,1,.5,500)),this.focus=1}updateMatrices(t){const e=this.camera,n=2*VT*t.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=t.distance||e.far;(n!==e.fov||r!==e.aspect||s!==e.far)&&(e.fov=n,e.aspect=r,e.far=s,e.updateProjectionMatrix()),super.updateMatrices(t)}copy(t){return super.copy(t),this.focus=t.focus,this}}XY.prototype.isSpotLightShadow=!0;class n4 extends Kf{constructor(t,e,n=0,r=Math.PI/3,s=0,a=1){super(t,e),this.type="SpotLight",this.position.copy(Zs.DefaultUp),this.updateMatrix(),this.target=new Zs,this.distance=n,this.angle=r,this.penumbra=s,this.decay=a,this.shadow=new XY}get power(){return this.intensity*Math.PI}set power(t){this.intensity=t/Math.PI}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}n4.prototype.isSpotLight=!0;const ZY=new nr,yE=new He,r4=new He;class YY extends t4{constructor(){super(new mc(90,1,.5,500)),this._frameExtents=new Oi(4,2),this._viewportCount=6,this._viewports=[new Bo(2,1,1,1),new Bo(0,1,1,1),new Bo(3,1,1,1),new Bo(1,1,1,1),new Bo(3,0,1,1),new Bo(1,0,1,1)],this._cubeDirections=[new He(1,0,0),new He(-1,0,0),new He(0,0,1),new He(0,0,-1),new He(0,1,0),new He(0,-1,0)],this._cubeUps=[new He(0,1,0),new He(0,1,0),new He(0,1,0),new He(0,1,0),new He(0,0,1),new He(0,0,-1)]}updateMatrices(t,e=0){const n=this.camera,r=this.matrix,s=t.distance||n.far;s!==n.far&&(n.far=s,n.updateProjectionMatrix()),yE.setFromMatrixPosition(t.matrixWorld),n.position.copy(yE),r4.copy(n.position),r4.add(this._cubeDirections[e]),n.up.copy(this._cubeUps[e]),n.lookAt(r4),n.updateMatrixWorld(),r.makeTranslation(-yE.x,-yE.y,-yE.z),ZY.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(ZY)}}YY.prototype.isPointLightShadow=!0;class s4 extends Kf{constructor(t,e,n=0,r=1){super(t,e),this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new YY}get power(){return 4*this.intensity*Math.PI}set power(t){this.intensity=t/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}s4.prototype.isPointLight=!0;class KY extends t4{constructor(){super(new ZT(-5,5,5,-5,.5,500))}}KY.prototype.isDirectionalLightShadow=!0;class o4 extends Kf{constructor(t,e){super(t,e),this.type="DirectionalLight",this.position.copy(Zs.DefaultUp),this.updateMatrix(),this.target=new Zs,this.shadow=new KY}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}o4.prototype.isDirectionalLight=!0;class a4 extends Kf{constructor(t,e){super(t,e),this.type="AmbientLight"}}a4.prototype.isAmbientLight=!0;class l4 extends Kf{constructor(t,e,n=10,r=10){super(t,e),this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(t){this.intensity=t/(this.width*this.height*Math.PI)}copy(t){return super.copy(t),this.width=t.width,this.height=t.height,this}toJSON(t){const e=super.toJSON(t);return e.object.width=this.width,e.object.height=this.height,e}}l4.prototype.isRectAreaLight=!0;class c4{constructor(){this.coefficients=[];for(let t=0;t<9;t++)this.coefficients.push(new He)}set(t){for(let e=0;e<9;e++)this.coefficients[e].copy(t[e]);return this}zero(){for(let t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this}getAt(t,e){const n=t.x,r=t.y,s=t.z,a=this.coefficients;return e.copy(a[0]).multiplyScalar(.282095),e.addScaledVector(a[1],.488603*r),e.addScaledVector(a[2],.488603*s),e.addScaledVector(a[3],.488603*n),e.addScaledVector(a[4],n*r*1.092548),e.addScaledVector(a[5],r*s*1.092548),e.addScaledVector(a[6],.315392*(3*s*s-1)),e.addScaledVector(a[7],n*s*1.092548),e.addScaledVector(a[8],.546274*(n*n-r*r)),e}getIrradianceAt(t,e){const n=t.x,r=t.y,s=t.z,a=this.coefficients;return e.copy(a[0]).multiplyScalar(.886227),e.addScaledVector(a[1],1.023328*r),e.addScaledVector(a[2],1.023328*s),e.addScaledVector(a[3],1.023328*n),e.addScaledVector(a[4],.858086*n*r),e.addScaledVector(a[5],.858086*r*s),e.addScaledVector(a[6],.743125*s*s-.247708),e.addScaledVector(a[7],.858086*n*s),e.addScaledVector(a[8],.429043*(n*n-r*r)),e}add(t){for(let e=0;e<9;e++)this.coefficients[e].add(t.coefficients[e]);return this}addScaledSH(t,e){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(t.coefficients[n],e);return this}scale(t){for(let e=0;e<9;e++)this.coefficients[e].multiplyScalar(t);return this}lerp(t,e){for(let n=0;n<9;n++)this.coefficients[n].lerp(t.coefficients[n],e);return this}equals(t){for(let e=0;e<9;e++)if(!this.coefficients[e].equals(t.coefficients[e]))return!1;return!0}copy(t){return this.set(t.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(t,e=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(t,e+3*r);return this}toArray(t=[],e=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(t,e+3*r);return t}static getBasisAt(t,e){const n=t.x,r=t.y,s=t.z;e[0]=.282095,e[1]=.488603*r,e[2]=.488603*s,e[3]=.488603*n,e[4]=1.092548*n*r,e[5]=1.092548*r*s,e[6]=.315392*(3*s*s-1),e[7]=1.092548*n*s,e[8]=.546274*(n*n-r*r)}}c4.prototype.isSphericalHarmonics3=!0;class vE extends Kf{constructor(t=new c4,e=1){super(void 0,e),this.sh=t}copy(t){return super.copy(t),this.sh.copy(t.sh),this}fromJSON(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this}toJSON(t){const e=super.toJSON(t);return e.object.sh=this.sh.toArray(),e}}vE.prototype.isLightProbe=!0;class QY extends Fu{constructor(t){super(t),this.textures={}}load(t,e,n,r){const s=this,a=new Vp(s.manager);a.setPath(s.path),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(t,function(l){try{e(s.parse(JSON.parse(l)))}catch(u){r?r(u):console.error(u),s.manager.itemError(t)}},n,r)}parse(t){const e=this.textures;function n(s){return void 0===e[s]&&console.warn("THREE.MaterialLoader: Undefined texture",s),e[s]}const r=new SSe[t.type];if(void 0!==t.uuid&&(r.uuid=t.uuid),void 0!==t.name&&(r.name=t.name),void 0!==t.color&&void 0!==r.color&&r.color.setHex(t.color),void 0!==t.roughness&&(r.roughness=t.roughness),void 0!==t.metalness&&(r.metalness=t.metalness),void 0!==t.sheen&&(r.sheen=t.sheen),void 0!==t.sheenColor&&(r.sheenColor=(new En).setHex(t.sheenColor)),void 0!==t.sheenRoughness&&(r.sheenRoughness=t.sheenRoughness),void 0!==t.emissive&&void 0!==r.emissive&&r.emissive.setHex(t.emissive),void 0!==t.specular&&void 0!==r.specular&&r.specular.setHex(t.specular),void 0!==t.specularIntensity&&(r.specularIntensity=t.specularIntensity),void 0!==t.specularColor&&void 0!==r.specularColor&&r.specularColor.setHex(t.specularColor),void 0!==t.shininess&&(r.shininess=t.shininess),void 0!==t.clearcoat&&(r.clearcoat=t.clearcoat),void 0!==t.clearcoatRoughness&&(r.clearcoatRoughness=t.clearcoatRoughness),void 0!==t.transmission&&(r.transmission=t.transmission),void 0!==t.thickness&&(r.thickness=t.thickness),void 0!==t.attenuationDistance&&(r.attenuationDistance=t.attenuationDistance),void 0!==t.attenuationColor&&void 0!==r.attenuationColor&&r.attenuationColor.setHex(t.attenuationColor),void 0!==t.fog&&(r.fog=t.fog),void 0!==t.flatShading&&(r.flatShading=t.flatShading),void 0!==t.blending&&(r.blending=t.blending),void 0!==t.combine&&(r.combine=t.combine),void 0!==t.side&&(r.side=t.side),void 0!==t.shadowSide&&(r.shadowSide=t.shadowSide),void 0!==t.opacity&&(r.opacity=t.opacity),void 0!==t.transparent&&(r.transparent=t.transparent),void 0!==t.alphaTest&&(r.alphaTest=t.alphaTest),void 0!==t.depthTest&&(r.depthTest=t.depthTest),void 0!==t.depthWrite&&(r.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(r.colorWrite=t.colorWrite),void 0!==t.alphaWrite&&(r.alphaWrite=t.alphaWrite),void 0!==t.stencilWrite&&(r.stencilWrite=t.stencilWrite),void 0!==t.stencilWriteMask&&(r.stencilWriteMask=t.stencilWriteMask),void 0!==t.stencilFunc&&(r.stencilFunc=t.stencilFunc),void 0!==t.stencilRef&&(r.stencilRef=t.stencilRef),void 0!==t.stencilFuncMask&&(r.stencilFuncMask=t.stencilFuncMask),void 0!==t.stencilFail&&(r.stencilFail=t.stencilFail),void 0!==t.stencilZFail&&(r.stencilZFail=t.stencilZFail),void 0!==t.stencilZPass&&(r.stencilZPass=t.stencilZPass),void 0!==t.wireframe&&(r.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(r.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(r.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(r.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(r.rotation=t.rotation),1!==t.linewidth&&(r.linewidth=t.linewidth),void 0!==t.dashSize&&(r.dashSize=t.dashSize),void 0!==t.gapSize&&(r.gapSize=t.gapSize),void 0!==t.scale&&(r.scale=t.scale),void 0!==t.polygonOffset&&(r.polygonOffset=t.polygonOffset),void 0!==t.polygonOffsetFactor&&(r.polygonOffsetFactor=t.polygonOffsetFactor),void 0!==t.polygonOffsetUnits&&(r.polygonOffsetUnits=t.polygonOffsetUnits),void 0!==t.dithering&&(r.dithering=t.dithering),void 0!==t.alphaToCoverage&&(r.alphaToCoverage=t.alphaToCoverage),void 0!==t.premultipliedAlpha&&(r.premultipliedAlpha=t.premultipliedAlpha),void 0!==t.visible&&(r.visible=t.visible),void 0!==t.toneMapped&&(r.toneMapped=t.toneMapped),void 0!==t.userData&&(r.userData=t.userData),void 0!==t.vertexColors&&(r.vertexColors="number"==typeof t.vertexColors?t.vertexColors>0:t.vertexColors),void 0!==t.uniforms)for(const s in t.uniforms){const a=t.uniforms[s];switch(r.uniforms[s]={},a.type){case"t":r.uniforms[s].value=n(a.value);break;case"c":r.uniforms[s].value=(new En).setHex(a.value);break;case"v2":r.uniforms[s].value=(new Oi).fromArray(a.value);break;case"v3":r.uniforms[s].value=(new He).fromArray(a.value);break;case"v4":r.uniforms[s].value=(new Bo).fromArray(a.value);break;case"m3":r.uniforms[s].value=(new pc).fromArray(a.value);break;case"m4":r.uniforms[s].value=(new nr).fromArray(a.value);break;default:r.uniforms[s].value=a.value}}if(void 0!==t.defines&&(r.defines=t.defines),void 0!==t.vertexShader&&(r.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(r.fragmentShader=t.fragmentShader),void 0!==t.extensions)for(const s in t.extensions)r.extensions[s]=t.extensions[s];if(void 0!==t.shading&&(r.flatShading=1===t.shading),void 0!==t.size&&(r.size=t.size),void 0!==t.sizeAttenuation&&(r.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(r.map=n(t.map)),void 0!==t.matcap&&(r.matcap=n(t.matcap)),void 0!==t.alphaMap&&(r.alphaMap=n(t.alphaMap)),void 0!==t.bumpMap&&(r.bumpMap=n(t.bumpMap)),void 0!==t.bumpScale&&(r.bumpScale=t.bumpScale),void 0!==t.normalMap&&(r.normalMap=n(t.normalMap)),void 0!==t.normalMapType&&(r.normalMapType=t.normalMapType),void 0!==t.normalScale){let s=t.normalScale;!1===Array.isArray(s)&&(s=[s,s]),r.normalScale=(new Oi).fromArray(s)}return void 0!==t.displacementMap&&(r.displacementMap=n(t.displacementMap)),void 0!==t.displacementScale&&(r.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(r.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(r.roughnessMap=n(t.roughnessMap)),void 0!==t.metalnessMap&&(r.metalnessMap=n(t.metalnessMap)),void 0!==t.emissiveMap&&(r.emissiveMap=n(t.emissiveMap)),void 0!==t.emissiveIntensity&&(r.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(r.specularMap=n(t.specularMap)),void 0!==t.specularIntensityMap&&(r.specularIntensityMap=n(t.specularIntensityMap)),void 0!==t.specularColorMap&&(r.specularColorMap=n(t.specularColorMap)),void 0!==t.envMap&&(r.envMap=n(t.envMap)),void 0!==t.envMapIntensity&&(r.envMapIntensity=t.envMapIntensity),void 0!==t.reflectivity&&(r.reflectivity=t.reflectivity),void 0!==t.refractionRatio&&(r.refractionRatio=t.refractionRatio),void 0!==t.lightMap&&(r.lightMap=n(t.lightMap)),void 0!==t.lightMapIntensity&&(r.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(r.aoMap=n(t.aoMap)),void 0!==t.aoMapIntensity&&(r.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(r.gradientMap=n(t.gradientMap)),void 0!==t.clearcoatMap&&(r.clearcoatMap=n(t.clearcoatMap)),void 0!==t.clearcoatRoughnessMap&&(r.clearcoatRoughnessMap=n(t.clearcoatRoughnessMap)),void 0!==t.clearcoatNormalMap&&(r.clearcoatNormalMap=n(t.clearcoatNormalMap)),void 0!==t.clearcoatNormalScale&&(r.clearcoatNormalScale=(new Oi).fromArray(t.clearcoatNormalScale)),void 0!==t.transmissionMap&&(r.transmissionMap=n(t.transmissionMap)),void 0!==t.thicknessMap&&(r.thicknessMap=n(t.thicknessMap)),void 0!==t.sheenColorMap&&(r.sheenColorMap=n(t.sheenColorMap)),void 0!==t.sheenRoughnessMap&&(r.sheenRoughnessMap=n(t.sheenRoughnessMap)),r}setTextures(t){return this.textures=t,this}}class nI{static decodeText(t){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(t);let e="";for(let n=0,r=t.length;n<r;n++)e+=String.fromCharCode(t[n]);try{return decodeURIComponent(escape(e))}catch(n){return e}}static extractUrlBase(t){const e=t.lastIndexOf("/");return-1===e?"./":t.substr(0,e+1)}static resolveURL(t,e){return"string"!=typeof t||""===t?"":(/^https?:\/\//i.test(e)&&/^\//.test(t)&&(e=e.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(t)||/^data:.*,.*$/i.test(t)||/^blob:.*$/i.test(t)?t:e+t)}}class u4 extends Ir{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(t){return super.copy(t),this.instanceCount=t.instanceCount,this}clone(){return(new this.constructor).copy(this)}toJSON(){const t=super.toJSON(this);return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}}u4.prototype.isInstancedBufferGeometry=!0;class JY extends Fu{constructor(t){super(t)}load(t,e,n,r){const s=this,a=new Vp(s.manager);a.setPath(s.path),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(t,function(l){try{e(s.parse(JSON.parse(l)))}catch(u){r?r(u):console.error(u),s.manager.itemError(t)}},n,r)}parse(t){const e={},n={};function r(S,T){if(void 0!==e[T])return e[T];const j=S.interleavedBuffers[T],P=function s(S,T){if(void 0!==n[T])return n[T];const P=new Uint32Array(S.arrayBuffers[T]).buffer;return n[T]=P,P}(S,j.buffer),E=wS(j.type,P),ie=new A0(E,j.stride);return ie.uuid=j.uuid,e[T]=ie,ie}const a=t.isInstancedBufferGeometry?new u4:new Ir,l=t.data.index;if(void 0!==l){const S=wS(l.type,l.array);a.setIndex(new lo(S,1))}const u=t.data.attributes;for(const S in u){const T=u[S];let I;if(T.isInterleavedBufferAttribute){const j=r(t.data,T.data);I=new Uy(j,T.itemSize,T.offset,T.normalized)}else{const j=wS(T.type,T.array);I=new(T.isInstancedBufferAttribute?R0:lo)(j,T.itemSize,T.normalized)}void 0!==T.name&&(I.name=T.name),void 0!==T.usage&&I.setUsage(T.usage),void 0!==T.updateRange&&(I.updateRange.offset=T.updateRange.offset,I.updateRange.count=T.updateRange.count),a.setAttribute(S,I)}const h=t.data.morphAttributes;if(h)for(const S in h){const T=h[S],I=[];for(let j=0,P=T.length;j<P;j++){const E=T[j];let ie;if(E.isInterleavedBufferAttribute){const ee=r(t.data,E.data);ie=new Uy(ee,E.itemSize,E.offset,E.normalized)}else{const ee=wS(E.type,E.array);ie=new lo(ee,E.itemSize,E.normalized)}void 0!==E.name&&(ie.name=E.name),I.push(ie)}a.morphAttributes[S]=I}t.data.morphTargetsRelative&&(a.morphTargetsRelative=!0);const _=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==_)for(let S=0,T=_.length;S!==T;++S){const I=_[S];a.addGroup(I.start,I.count,I.materialIndex)}const v=t.data.boundingSphere;if(void 0!==v){const S=new He;void 0!==v.center&&S.fromArray(v.center),a.boundingSphere=new Iy(S,v.radius)}return t.name&&(a.name=t.name),t.userData&&(a.userData=t.userData),a}}class ASe extends Fu{constructor(t){super(t)}load(t,e,n,r){const s=this,a=""===this.path?nI.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||a;const l=new Vp(this.manager);l.setPath(this.path),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(t,function(u){let h=null;try{h=JSON.parse(u)}catch(_){return void 0!==r&&r(_),void console.error("THREE:ObjectLoader: Can't parse "+t+".",_.message)}const m=h.metadata;void 0!==m&&void 0!==m.type&&"geometry"!==m.type.toLowerCase()?s.parse(h,e):console.error("THREE.ObjectLoader: Can't load "+t)},n,r)}loadAsync(t,e){var n=this;return DT(function*(){const r=n,s=""===n.path?nI.extractUrlBase(t):n.path;n.resourcePath=n.resourcePath||s;const a=new Vp(n.manager);a.setPath(n.path),a.setRequestHeader(n.requestHeader),a.setWithCredentials(n.withCredentials);const l=yield a.loadAsync(t,e),u=JSON.parse(l),h=u.metadata;if(void 0===h||void 0===h.type||"geometry"===h.type.toLowerCase())throw new Error("THREE.ObjectLoader: Can't load "+t);return yield r.parseAsync(u)})()}parse(t,e){const n=this.parseAnimations(t.animations),r=this.parseShapes(t.shapes),s=this.parseGeometries(t.geometries,r),a=this.parseImages(t.images,function(){void 0!==e&&e(h)}),l=this.parseTextures(t.textures,a),u=this.parseMaterials(t.materials,l),h=this.parseObject(t.object,s,u,l,n),m=this.parseSkeletons(t.skeletons,h);if(this.bindSkeletons(h,m),void 0!==e){let _=!1;for(const v in a)if(a[v]instanceof HTMLImageElement){_=!0;break}!1===_&&e(h)}return h}parseAsync(t){var e=this;return DT(function*(){const n=e.parseAnimations(t.animations),r=e.parseShapes(t.shapes),s=e.parseGeometries(t.geometries,r),a=yield e.parseImagesAsync(t.images),l=e.parseTextures(t.textures,a),u=e.parseMaterials(t.materials,l),h=e.parseObject(t.object,s,u,l,n),m=e.parseSkeletons(t.skeletons,h);return e.bindSkeletons(h,m),h})()}parseShapes(t){const e={};if(void 0!==t)for(let n=0,r=t.length;n<r;n++){const s=(new Bp).fromJSON(t[n]);e[s.uuid]=s}return e}parseSkeletons(t,e){const n={},r={};if(e.traverse(function(s){s.isBone&&(r[s.uuid]=s)}),void 0!==t)for(let s=0,a=t.length;s<a;s++){const l=(new H2).fromJSON(t[s],r);n[l.uuid]=l}return n}parseGeometries(t,e){const n={};if(void 0!==t){const r=new JY;for(let s=0,a=t.length;s<a;s++){let l;const u=t[s];switch(u.type){case"BufferGeometry":case"InstancedBufferGeometry":l=r.parse(u);break;case"Geometry":console.error("THREE.ObjectLoader: The legacy Geometry type is no longer supported.");break;default:u.type in FY?l=FY[u.type].fromJSON(u,e):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${u.type}"`)}l.uuid=u.uuid,void 0!==u.name&&(l.name=u.name),!0===l.isBufferGeometry&&void 0!==u.userData&&(l.userData=u.userData),n[u.uuid]=l}}return n}parseMaterials(t,e){const n={},r={};if(void 0!==t){const s=new QY;s.setTextures(e);for(let a=0,l=t.length;a<l;a++){const u=t[a];if("MultiMaterial"===u.type){const h=[];for(let m=0;m<u.materials.length;m++){const _=u.materials[m];void 0===n[_.uuid]&&(n[_.uuid]=s.parse(_)),h.push(n[_.uuid])}r[u.uuid]=h}else void 0===n[u.uuid]&&(n[u.uuid]=s.parse(u)),r[u.uuid]=n[u.uuid]}}return r}parseAnimations(t){const e={};if(void 0!==t)for(let n=0;n<t.length;n++){const s=gE.parse(t[n]);e[s.uuid]=s}return e}parseImages(t,e){const n=this,r={};let s;function l(u){if("string"==typeof u){const h=u;return function a(u){return n.manager.itemStart(u),s.load(u,function(){n.manager.itemEnd(u)},void 0,function(){n.manager.itemError(u),n.manager.itemEnd(u)})}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(h)?h:n.resourcePath+h)}return u.data?{data:wS(u.type,u.data),width:u.width,height:u.height}:null}if(void 0!==t&&t.length>0){const u=new iI(e);s=new _E(u),s.setCrossOrigin(this.crossOrigin);for(let h=0,m=t.length;h<m;h++){const _=t[h],v=_.url;if(Array.isArray(v)){r[_.uuid]=[];for(let S=0,T=v.length;S<T;S++){const j=l(v[S]);null!==j&&(j instanceof HTMLImageElement?r[_.uuid].push(j):r[_.uuid].push(new D0(j.data,j.width,j.height)))}}else{const S=l(_.url);null!==S&&(r[_.uuid]=S)}}}return r}parseImagesAsync(t){var e=this;return DT(function*(){const n=e,r={};let s;function a(u){return l.apply(this,arguments)}function l(){return(l=DT(function*(u){if("string"==typeof u){const h=u,m=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(h)?h:n.resourcePath+h;return yield s.loadAsync(m)}return u.data?{data:wS(u.type,u.data),width:u.width,height:u.height}:null})).apply(this,arguments)}if(void 0!==t&&t.length>0){s=new _E(e.manager),s.setCrossOrigin(e.crossOrigin);for(let u=0,h=t.length;u<h;u++){const m=t[u],_=m.url;if(Array.isArray(_)){r[m.uuid]=[];for(let v=0,S=_.length;v<S;v++){const T=_[v],I=yield a(T);null!==I&&(I instanceof HTMLImageElement?r[m.uuid].push(I):r[m.uuid].push(new D0(I.data,I.width,I.height)))}}else{const v=yield a(m.url);null!==v&&(r[m.uuid]=v)}}}return r})()}parseTextures(t,e){function n(s,a){return"number"==typeof s?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),a[s])}const r={};if(void 0!==t)for(let s=0,a=t.length;s<a;s++){const l=t[s];let u;void 0===l.image&&console.warn('THREE.ObjectLoader: No "image" specified for',l.uuid),void 0===e[l.image]&&console.warn("THREE.ObjectLoader: Undefined image",l.image);const h=e[l.image];Array.isArray(h)?(u=new BS(h),6===h.length&&(u.needsUpdate=!0)):(u=h&&h.data?new D0(h.data,h.width,h.height):new Jl(h),h&&(u.needsUpdate=!0)),u.uuid=l.uuid,void 0!==l.name&&(u.name=l.name),void 0!==l.mapping&&(u.mapping=n(l.mapping,DSe)),void 0!==l.offset&&u.offset.fromArray(l.offset),void 0!==l.repeat&&u.repeat.fromArray(l.repeat),void 0!==l.center&&u.center.fromArray(l.center),void 0!==l.rotation&&(u.rotation=l.rotation),void 0!==l.wrap&&(u.wrapS=n(l.wrap[0],$Y),u.wrapT=n(l.wrap[1],$Y)),void 0!==l.format&&(u.format=l.format),void 0!==l.type&&(u.type=l.type),void 0!==l.encoding&&(u.encoding=l.encoding),void 0!==l.minFilter&&(u.minFilter=n(l.minFilter,eK)),void 0!==l.magFilter&&(u.magFilter=n(l.magFilter,eK)),void 0!==l.anisotropy&&(u.anisotropy=l.anisotropy),void 0!==l.flipY&&(u.flipY=l.flipY),void 0!==l.premultiplyAlpha&&(u.premultiplyAlpha=l.premultiplyAlpha),void 0!==l.unpackAlignment&&(u.unpackAlignment=l.unpackAlignment),void 0!==l.userData&&(u.userData=l.userData),r[l.uuid]=u}return r}parseObject(t,e,n,r,s){let a,m,_;function l(v){return void 0===e[v]&&console.warn("THREE.ObjectLoader: Undefined geometry",v),e[v]}function u(v){if(void 0!==v){if(Array.isArray(v)){const S=[];for(let T=0,I=v.length;T<I;T++){const j=v[T];void 0===n[j]&&console.warn("THREE.ObjectLoader: Undefined material",j),S.push(n[j])}return S}return void 0===n[v]&&console.warn("THREE.ObjectLoader: Undefined material",v),n[v]}}function h(v){return void 0===r[v]&&console.warn("THREE.ObjectLoader: Undefined texture",v),r[v]}switch(t.type){case"Scene":a=new $T,void 0!==t.background&&(a.background=Number.isInteger(t.background)?new En(t.background):h(t.background)),void 0!==t.environment&&(a.environment=h(t.environment)),void 0!==t.fog&&("Fog"===t.fog.type?a.fog=new JT(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(a.fog=new QT(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":a=new mc(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(a.focus=t.focus),void 0!==t.zoom&&(a.zoom=t.zoom),void 0!==t.filmGauge&&(a.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(a.filmOffset=t.filmOffset),void 0!==t.view&&(a.view=Object.assign({},t.view));break;case"OrthographicCamera":a=new ZT(t.left,t.right,t.top,t.bottom,t.near,t.far),void 0!==t.zoom&&(a.zoom=t.zoom),void 0!==t.view&&(a.view=Object.assign({},t.view));break;case"AmbientLight":a=new a4(t.color,t.intensity);break;case"DirectionalLight":a=new o4(t.color,t.intensity);break;case"PointLight":a=new s4(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":a=new l4(t.color,t.intensity,t.width,t.height);break;case"SpotLight":a=new n4(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":a=new e4(t.color,t.groundColor,t.intensity);break;case"LightProbe":a=(new vE).fromJSON(t);break;case"SkinnedMesh":m=l(t.geometry),_=u(t.material),a=new B2(m,_),void 0!==t.bindMode&&(a.bindMode=t.bindMode),void 0!==t.bindMatrix&&a.bindMatrix.fromArray(t.bindMatrix),void 0!==t.skeleton&&(a.skeleton=t.skeleton);break;case"Mesh":m=l(t.geometry),_=u(t.material),a=new Qa(m,_);break;case"InstancedMesh":m=l(t.geometry),_=u(t.material);const S=t.instanceMatrix,T=t.instanceColor;a=new E5(m,_,t.count),a.instanceMatrix=new R0(new Float32Array(S.array),16),void 0!==T&&(a.instanceColor=new R0(new Float32Array(T.array),T.itemSize));break;case"LOD":a=new lY;break;case"Line":a=new Tg(l(t.geometry),u(t.material));break;case"LineLoop":a=new D5(l(t.geometry),u(t.material));break;case"LineSegments":a=new ph(l(t.geometry),u(t.material));break;case"PointCloud":case"Points":a=new rE(l(t.geometry),u(t.material));break;case"Sprite":a=new L2(u(t.material));break;case"Group":a=new E0;break;case"Bone":a=new N2;break;default:a=new Zs}if(a.uuid=t.uuid,void 0!==t.name&&(a.name=t.name),void 0!==t.matrix?(a.matrix.fromArray(t.matrix),void 0!==t.matrixAutoUpdate&&(a.matrixAutoUpdate=t.matrixAutoUpdate),a.matrixAutoUpdate&&a.matrix.decompose(a.position,a.quaternion,a.scale)):(void 0!==t.position&&a.position.fromArray(t.position),void 0!==t.rotation&&a.rotation.fromArray(t.rotation),void 0!==t.quaternion&&a.quaternion.fromArray(t.quaternion),void 0!==t.scale&&a.scale.fromArray(t.scale)),void 0!==t.castShadow&&(a.castShadow=t.castShadow),void 0!==t.receiveShadow&&(a.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(a.shadow.bias=t.shadow.bias),void 0!==t.shadow.normalBias&&(a.shadow.normalBias=t.shadow.normalBias),void 0!==t.shadow.radius&&(a.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&a.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(a.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(a.visible=t.visible),void 0!==t.frustumCulled&&(a.frustumCulled=t.frustumCulled),void 0!==t.renderOrder&&(a.renderOrder=t.renderOrder),void 0!==t.userData&&(a.userData=t.userData),void 0!==t.layers&&(a.layers.mask=t.layers),void 0!==t.children){const v=t.children;for(let S=0;S<v.length;S++)a.add(this.parseObject(v[S],e,n,r,s))}if(void 0!==t.animations){const v=t.animations;for(let S=0;S<v.length;S++)a.animations.push(s[v[S]])}if("LOD"===t.type){void 0!==t.autoUpdate&&(a.autoUpdate=t.autoUpdate);const v=t.levels;for(let S=0;S<v.length;S++){const T=v[S],I=a.getObjectByProperty("uuid",T.object);void 0!==I&&a.addLevel(I,T.distance)}}return a}bindSkeletons(t,e){0!==Object.keys(e).length&&t.traverse(function(n){if(!0===n.isSkinnedMesh&&void 0!==n.skeleton){const r=e[n.skeleton];void 0===r?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(r,n.bindMatrix)}})}setTexturePath(t){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(t)}}const DSe={UVMapping:zP,CubeReflectionMapping:h0,CubeRefractionMapping:d0,EquirectangularReflectionMapping:kT,EquirectangularRefractionMapping:PT,CubeUVReflectionMapping:yS,CubeUVRefractionMapping:IT},$Y={RepeatWrapping:LT,ClampToEdgeWrapping:Kc,MirroredRepeatWrapping:OT},eK={NearestFilter:Dl,NearestMipmapNearestFilter:UP,NearestMipmapLinearFilter:GP,LinearFilter:Ka,LinearMipmapNearestFilter:SV,LinearMipmapLinearFilter:f0};class tK extends Fu{constructor(t){super(t),"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(t){return this.options=t,this}load(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const s=this,a=B0.get(t);if(void 0!==a)return s.manager.itemStart(t),setTimeout(function(){e&&e(a),s.manager.itemEnd(t)},0),a;const l={};l.credentials="anonymous"===this.crossOrigin?"same-origin":"include",l.headers=this.requestHeader,fetch(t,l).then(function(u){return u.blob()}).then(function(u){return createImageBitmap(u,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(u){B0.add(t,u),e&&e(u),s.manager.itemEnd(t)}).catch(function(u){r&&r(u),s.manager.itemError(t),s.manager.itemEnd(t)}),s.manager.itemStart(t)}}let rI;tK.prototype.isImageBitmapLoader=!0;const h4={getContext:function(){return void 0===rI&&(rI=new(window.AudioContext||window.webkitAudioContext)),rI},setContext:function(i){rI=i}};class iK extends Fu{constructor(t){super(t)}load(t,e,n,r){const s=this,a=new Vp(this.manager);a.setResponseType("arraybuffer"),a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(t,function(l){try{const u=l.slice(0);h4.getContext().decodeAudioData(u,function(m){e(m)})}catch(u){r?r(u):console.error(u),s.manager.itemError(t)}},n,r)}}class nK extends vE{constructor(t,e,n=1){super(void 0,n);const r=(new En).set(t),s=(new En).set(e),a=new He(r.r,r.g,r.b),l=new He(s.r,s.g,s.b),u=Math.sqrt(Math.PI),h=u*Math.sqrt(.75);this.sh.coefficients[0].copy(a).add(l).multiplyScalar(u),this.sh.coefficients[1].copy(a).sub(l).multiplyScalar(h)}}nK.prototype.isHemisphereLightProbe=!0;class rK extends vE{constructor(t,e=1){super(void 0,e);const n=(new En).set(t);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}}rK.prototype.isAmbientLightProbe=!0;const sK=new nr,oK=new nr,N0=new nr;class RSe{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new mc,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new mc,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(t){const e=this._cache;if(e.focus!==t.focus||e.fov!==t.fov||e.aspect!==t.aspect*this.aspect||e.near!==t.near||e.far!==t.far||e.zoom!==t.zoom||e.eyeSep!==this.eyeSep){e.focus=t.focus,e.fov=t.fov,e.aspect=t.aspect*this.aspect,e.near=t.near,e.far=t.far,e.zoom=t.zoom,e.eyeSep=this.eyeSep,N0.copy(t.projectionMatrix);const r=e.eyeSep/2,s=r*e.near/e.focus,a=e.near*Math.tan(b0*e.fov*.5)/e.zoom;let l,u;oK.elements[12]=-r,sK.elements[12]=r,l=-a*e.aspect+s,u=a*e.aspect+s,N0.elements[0]=2*e.near/(u-l),N0.elements[8]=(u+l)/(u-l),this.cameraL.projectionMatrix.copy(N0),l=-a*e.aspect-s,u=a*e.aspect-s,N0.elements[0]=2*e.near/(u-l),N0.elements[8]=(u+l)/(u-l),this.cameraR.projectionMatrix.copy(N0)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(oK),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(sK)}}class aK{constructor(t=!0){this.autoStart=t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=lK(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const e=lK();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}}function lK(){return("undefined"==typeof performance?Date:performance).now()}const H0=new He,cK=new eu,kSe=new He,V0=new He;class PSe extends Zs{constructor(){super(),this.type="AudioListener",this.context=h4.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new aK}getInput(){return this.gain}removeFilter(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(t){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}updateMatrixWorld(t){super.updateMatrixWorld(t);const e=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(H0,cK,kSe),V0.set(0,0,-1).applyQuaternion(cK),e.positionX){const r=this.context.currentTime+this.timeDelta;e.positionX.linearRampToValueAtTime(H0.x,r),e.positionY.linearRampToValueAtTime(H0.y,r),e.positionZ.linearRampToValueAtTime(H0.z,r),e.forwardX.linearRampToValueAtTime(V0.x,r),e.forwardY.linearRampToValueAtTime(V0.y,r),e.forwardZ.linearRampToValueAtTime(V0.z,r),e.upX.linearRampToValueAtTime(n.x,r),e.upY.linearRampToValueAtTime(n.y,r),e.upZ.linearRampToValueAtTime(n.z,r)}else e.setPosition(H0.x,H0.y,H0.z),e.setOrientation(V0.x,V0.y,V0.z,n.x,n.y,n.z)}}class d4 extends Zs{constructor(t){super(),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this}setMediaElementSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this}setMediaStreamSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this}setBuffer(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this}play(t=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+t;const e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.onended=this.onEnded.bind(this),e.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(t){return t||(t=[]),!0===this._connected?(this.disconnect(),this.filters=t.slice(),this.connect()):this.filters=t.slice(),this}setDetune(t){if(this.detune=t,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(t){return this.setFilters(t?[t]:[])}setPlaybackRate(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(t){return this.loopStart=t,this}setLoopEnd(t){return this.loopEnd=t,this}getVolume(){return this.gain.gain.value}setVolume(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}}const z0=new He,uK=new eu,ISe=new He,U0=new He;class LSe extends d4{constructor(t){super(t),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(t){return this.panner.refDistance=t,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(t){return this.panner.rolloffFactor=t,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(t){return this.panner.distanceModel=t,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(t){return this.panner.maxDistance=t,this}setDirectionalCone(t,e,n){return this.panner.coneInnerAngle=t,this.panner.coneOuterAngle=e,this.panner.coneOuterGain=n,this}updateMatrixWorld(t){if(super.updateMatrixWorld(t),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(z0,uK,ISe),U0.set(0,0,1).applyQuaternion(uK);const e=this.panner;if(e.positionX){const n=this.context.currentTime+this.listener.timeDelta;e.positionX.linearRampToValueAtTime(z0.x,n),e.positionY.linearRampToValueAtTime(z0.y,n),e.positionZ.linearRampToValueAtTime(z0.z,n),e.orientationX.linearRampToValueAtTime(U0.x,n),e.orientationY.linearRampToValueAtTime(U0.y,n),e.orientationZ.linearRampToValueAtTime(U0.z,n)}else e.setPosition(z0.x,z0.y,z0.z),e.setOrientation(U0.x,U0.y,U0.z)}}class hK{constructor(t,e=2048){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=e,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let t=0;const e=this.getFrequencyData();for(let n=0;n<e.length;n++)t+=e[n];return t/e.length}}class dK{constructor(t,e,n){let r,s,a;switch(this.binding=t,this.valueSize=n,e){case"quaternion":r=this._slerp,s=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:r=this._lerp,s=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(t,e){const n=this.buffer,r=this.valueSize,s=t*r+r;let a=this.cumulativeWeight;if(0===a){for(let l=0;l!==r;++l)n[s+l]=n[l];a=e}else a+=e,this._mixBufferRegion(n,s,0,e/a,r);this.cumulativeWeight=a}accumulateAdditive(t){const e=this.buffer,n=this.valueSize,r=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(e,r,0,t,n),this.cumulativeWeightAdditive+=t}apply(t){const e=this.valueSize,n=this.buffer,r=t*e+e,s=this.cumulativeWeight,a=this.cumulativeWeightAdditive,l=this.binding;this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1&&this._mixBufferRegion(n,r,e*this._origIndex,1-s,e),a>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*e,1,e);for(let u=e,h=e+e;u!==h;++u)if(n[u]!==n[u+e]){l.setValue(n,r);break}}saveOriginalState(){const e=this.buffer,n=this.valueSize,r=n*this._origIndex;this.binding.getValue(e,r);for(let s=n,a=r;s!==a;++s)e[s]=e[r+s%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){this.binding.setValue(this.buffer,3*this.valueSize)}_setAdditiveIdentityNumeric(){const t=this._addIndex*this.valueSize,e=t+this.valueSize;for(let n=t;n<e;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const t=this._origIndex*this.valueSize,e=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[e+n]=this.buffer[t+n]}_select(t,e,n,r,s){if(r>=.5)for(let a=0;a!==s;++a)t[e+a]=t[n+a]}_slerp(t,e,n,r){eu.slerpFlat(t,e,t,e,t,n,r)}_slerpAdditive(t,e,n,r,s){const a=this._workIndex*s;eu.multiplyQuaternionsFlat(t,a,t,e,t,n),eu.slerpFlat(t,e,t,e,t,a,r)}_lerp(t,e,n,r,s){const a=1-r;for(let l=0;l!==s;++l){const u=e+l;t[u]=t[u]*a+t[n+l]*r}}_lerpAdditive(t,e,n,r,s){for(let a=0;a!==s;++a){const l=e+a;t[l]=t[l]+t[n+a]*r}}}const f4="\\[\\]\\.:\\/",OSe=new RegExp("["+f4+"]","g"),p4="[^"+f4+"]",FSe="[^"+f4.replace("\\.","")+"]",BSe=/((?:WC+[\/:])*)/.source.replace("WC",p4),NSe=/(WCOD+)?/.source.replace("WCOD",FSe),HSe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",p4),VSe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",p4),zSe=new RegExp("^"+BSe+NSe+HSe+VSe+"$"),USe=["material","materials","bones"];class GSe{constructor(t,e,n){const r=n||ra.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,r)}getValue(t,e){this.bind();const r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(t,e)}setValue(t,e){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=n.length;r!==s;++r)n[r].setValue(t,e)}bind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()}unbind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}}let ra=(()=>{class i{constructor(e,n,r){this.path=n,this.parsedPath=r||i.parseTrackName(n),this.node=i.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,n,r){return e&&e.isAnimationObjectGroup?new i.Composite(e,n,r):new i(e,n,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(OSe,"")}static parseTrackName(e){const n=zSe.exec(e);if(!n)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const r={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},s=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==s&&-1!==s){const a=r.nodeName.substring(s+1);-1!==USe.indexOf(a)&&(r.nodeName=r.nodeName.substring(0,s),r.objectName=a)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,n){if(!n||""===n||"."===n||-1===n||n===e.name||n===e.uuid)return e;if(e.skeleton){const r=e.skeleton.getBoneByName(n);if(void 0!==r)return r}if(e.children){const r=function(a){for(let l=0;l<a.length;l++){const u=a[l];if(u.name===n||u.uuid===n)return u;const h=r(u.children);if(h)return h}return null},s=r(e.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,n){e[n]=this.targetObject[this.propertyName]}_getValue_array(e,n){const r=this.resolvedProperty;for(let s=0,a=r.length;s!==a;++s)e[n++]=r[s]}_getValue_arrayElement(e,n){e[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,n){this.resolvedProperty.toArray(e,n)}_setValue_direct(e,n){this.targetObject[this.propertyName]=e[n]}_setValue_direct_setNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,n){const r=this.resolvedProperty;for(let s=0,a=r.length;s!==a;++s)r[s]=e[n++]}_setValue_array_setNeedsUpdate(e,n){const r=this.resolvedProperty;for(let s=0,a=r.length;s!==a;++s)r[s]=e[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,n){const r=this.resolvedProperty;for(let s=0,a=r.length;s!==a;++s)r[s]=e[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,n){this.resolvedProperty[this.propertyIndex]=e[n]}_setValue_arrayElement_setNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,n){this.resolvedProperty.fromArray(e,n)}_setValue_fromArray_setNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,n){this.bind(),this.getValue(e,n)}_setValue_unbound(e,n){this.bind(),this.setValue(e,n)}bind(){let e=this.node;const n=this.parsedPath,r=n.objectName,s=n.propertyName;let a=n.propertyIndex;if(e||(e=i.findNode(this.rootNode,n.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(r){let m=n.objectIndex;switch(r){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let _=0;_<e.length;_++)if(e[_].name===m){m=_;break}break;default:if(void 0===e[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[r]}if(void 0!==m){if(void 0===e[m])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[m]}}const l=e[s];if(void 0===l)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n.nodeName+"."+s+" but it wasn't found.",e);let u=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?u=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(u=this.Versioning.MatrixWorldNeedsUpdate);let h=this.BindingType.Direct;if(void 0!==a){if("morphTargetInfluences"===s){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[a]&&(a=e.morphTargetDictionary[a])}h=this.BindingType.ArrayElement,this.resolvedProperty=l,this.propertyIndex=a}else void 0!==l.fromArray&&void 0!==l.toArray?(h=this.BindingType.HasFromToArray,this.resolvedProperty=l):Array.isArray(l)?(h=this.BindingType.EntireArray,this.resolvedProperty=l):this.propertyName=s;this.getValue=this.GetterByBindingType[h],this.setValue=this.SetterByBindingTypeAndVersioning[h][u]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return i.Composite=GSe,i})();ra.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},ra.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},ra.prototype.GetterByBindingType=[ra.prototype._getValue_direct,ra.prototype._getValue_array,ra.prototype._getValue_arrayElement,ra.prototype._getValue_toArray],ra.prototype.SetterByBindingTypeAndVersioning=[[ra.prototype._setValue_direct,ra.prototype._setValue_direct_setNeedsUpdate,ra.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[ra.prototype._setValue_array,ra.prototype._setValue_array_setNeedsUpdate,ra.prototype._setValue_array_setMatrixWorldNeedsUpdate],[ra.prototype._setValue_arrayElement,ra.prototype._setValue_arrayElement_setNeedsUpdate,ra.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[ra.prototype._setValue_fromArray,ra.prototype._setValue_fromArray_setNeedsUpdate,ra.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class fK{constructor(){this.uuid=Nh(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const t={};this._indicesByUUID=t;for(let n=0,r=arguments.length;n!==r;++n)t[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const e=this;this.stats={objects:{get total(){return e._objects.length},get inUse(){return this.total-e.nCachedObjects_}},get bindingsPerObject(){return e._bindings.length}}}add(){const t=this._objects,e=this._indicesByUUID,n=this._paths,r=this._parsedPaths,s=this._bindings,a=s.length;let l,u=t.length,h=this.nCachedObjects_;for(let m=0,_=arguments.length;m!==_;++m){const v=arguments[m],S=v.uuid;let T=e[S];if(void 0===T){T=u++,e[S]=T,t.push(v);for(let I=0,j=a;I!==j;++I)s[I].push(new ra(v,n[I],r[I]))}else if(T<h){l=t[T];const I=--h,j=t[I];e[j.uuid]=T,t[T]=j,e[S]=I,t[I]=v;for(let P=0,E=a;P!==E;++P){const ie=s[P];let ce=ie[T];ie[T]=ie[I],void 0===ce&&(ce=new ra(v,n[P],r[P])),ie[I]=ce}}else t[T]!==l&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=h}remove(){const t=this._objects,e=this._indicesByUUID,n=this._bindings,r=n.length;let s=this.nCachedObjects_;for(let a=0,l=arguments.length;a!==l;++a){const u=arguments[a],h=u.uuid,m=e[h];if(void 0!==m&&m>=s){const _=s++,v=t[_];e[v.uuid]=m,t[m]=v,e[h]=_,t[_]=u;for(let S=0,T=r;S!==T;++S){const I=n[S],P=I[m];I[m]=I[_],I[_]=P}}}this.nCachedObjects_=s}uncache(){const t=this._objects,e=this._indicesByUUID,n=this._bindings,r=n.length;let s=this.nCachedObjects_,a=t.length;for(let l=0,u=arguments.length;l!==u;++l){const m=arguments[l].uuid,_=e[m];if(void 0!==_)if(delete e[m],_<s){const v=--s,S=t[v],T=--a,I=t[T];e[S.uuid]=_,t[_]=S,e[I.uuid]=v,t[v]=I,t.pop();for(let j=0,P=r;j!==P;++j){const E=n[j],ee=E[T];E[_]=E[v],E[v]=ee,E.pop()}}else{const v=--a,S=t[v];v>0&&(e[S.uuid]=_),t[_]=S,t.pop();for(let T=0,I=r;T!==I;++T){const j=n[T];j[_]=j[v],j.pop()}}}this.nCachedObjects_=s}subscribe_(t,e){const n=this._bindingsIndicesByPath;let r=n[t];const s=this._bindings;if(void 0!==r)return s[r];const a=this._paths,l=this._parsedPaths,u=this._objects,m=this.nCachedObjects_,_=new Array(u.length);r=s.length,n[t]=r,a.push(t),l.push(e),s.push(_);for(let v=m,S=u.length;v!==S;++v)_[v]=new ra(u[v],t,e);return _}unsubscribe_(t){const e=this._bindingsIndicesByPath,n=e[t];if(void 0!==n){const r=this._paths,s=this._parsedPaths,a=this._bindings,l=a.length-1,u=a[l];e[t[l]]=n,a[n]=u,a.pop(),s[n]=s[l],s.pop(),r[n]=r[l],r.pop()}}}fK.prototype.isAnimationObjectGroup=!0;class WSe{constructor(t,e,n=null,r=e.blendMode){this._mixer=t,this._clip=e,this._localRoot=n,this.blendMode=r;const s=e.tracks,a=s.length,l=new Array(a),u={endingStart:_0,endingEnd:_0};for(let h=0;h!==a;++h){const m=s[h].createInterpolant(null);l[h]=m,m.settings=u}this._interpolantSettings=u,this._interpolants=l,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=jX,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(t){return this._startTime=t,this}setLoop(t,e){return this.loop=t,this.repetitions=e,this}setEffectiveWeight(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(t){return this._scheduleFading(t,0,1)}fadeOut(t){return this._scheduleFading(t,1,0)}crossFadeFrom(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){const r=this._clip.duration,s=t._clip.duration,l=r/s;t.warp(1,s/r,e),this.warp(l,1,e)}return this}crossFadeTo(t,e,n){return t.crossFadeFrom(this,e,n)}stopFading(){const t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}setEffectiveTimeScale(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(t){return this.timeScale=this._clip.duration/t,this.stopWarping()}syncWith(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()}halt(t){return this.warp(this._effectiveTimeScale,0,t)}warp(t,e,n){const r=this._mixer,s=r.time,a=this.timeScale;let l=this._timeScaleInterpolant;null===l&&(l=r._lendControlInterpolant(),this._timeScaleInterpolant=l);const u=l.parameterPositions,h=l.sampleValues;return u[0]=s,u[1]=s+n,h[0]=t/a,h[1]=e/a,this}stopWarping(){const t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(t,e,n,r){if(!this.enabled)return void this._updateWeight(t);const s=this._startTime;if(null!==s){const u=(t-s)*n;if(u<0||0===n)return;this._startTime=null,e=n*u}e*=this._updateTimeScale(t);const a=this._updateTime(e),l=this._updateWeight(t);if(l>0){const u=this._interpolants,h=this._propertyBindings;if(this.blendMode===jV)for(let m=0,_=u.length;m!==_;++m)u[m].evaluate(a),h[m].accumulateAdditive(l);else for(let m=0,_=u.length;m!==_;++m)u[m].evaluate(a),h[m].accumulate(r,l)}}_updateWeight(t){let e=0;if(this.enabled){e=this.weight;const n=this._weightInterpolant;if(null!==n){const r=n.evaluate(t)[0];e*=r,t>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=e,e}_updateTimeScale(t){let e=0;if(!this.paused){e=this.timeScale;const n=this._timeScaleInterpolant;null!==n&&(e*=n.evaluate(t)[0],t>n.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e))}return this._effectiveTimeScale=e,e}_updateTime(t){const e=this._clip.duration,n=this.loop;let r=this.time+t,s=this._loopCount;const a=n===qX;if(0===t)return-1===s?r:a&&1==(1&s)?e-r:r;if(n===WX){-1===s&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=e)r=e;else{if(!(r<0)){this.time=r;break e}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(-1===s&&(t>=0?(s=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),r>=e||r<0){const l=Math.floor(r/e);r-=e*l,s+=Math.abs(l);const u=this.repetitions-s;if(u<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=t>0?e:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===u){const h=t<0;this._setEndings(h,!h,a)}else this._setEndings(!1,!1,a);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:l})}}else this.time=r;if(a&&1==(1&s))return e-r}return r}_setEndings(t,e,n){const r=this._interpolantSettings;n?(r.endingStart=y0,r.endingEnd=y0):(r.endingStart=t?this.zeroSlopeAtStart?y0:_0:HT,r.endingEnd=e?this.zeroSlopeAtEnd?y0:_0:HT)}_scheduleFading(t,e,n){const r=this._mixer,s=r.time;let a=this._weightInterpolant;null===a&&(a=r._lendControlInterpolant(),this._weightInterpolant=a);const l=a.parameterPositions,u=a.sampleValues;return l[0]=s,u[0]=e,l[1]=s+t,u[1]=n,this}}class pK extends Dy{constructor(t){super(),this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(t,e){const n=t._localRoot||this._root,r=t._clip.tracks,s=r.length,a=t._propertyBindings,l=t._interpolants,u=n.uuid,h=this._bindingsByRootAndName;let m=h[u];void 0===m&&(m={},h[u]=m);for(let _=0;_!==s;++_){const v=r[_],S=v.name;let T=m[S];if(void 0!==T)++T.referenceCount,a[_]=T;else{if(T=a[_],void 0!==T){null===T._cacheIndex&&(++T.referenceCount,this._addInactiveBinding(T,u,S));continue}T=new dK(ra.create(n,S,e&&e._propertyBindings[_].binding.parsedPath),v.ValueTypeName,v.getValueSize()),++T.referenceCount,this._addInactiveBinding(T,u,S),a[_]=T}l[_].resultBuffer=T.buffer}}_activateAction(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){const n=(t._localRoot||this._root).uuid,r=t._clip.uuid,s=this._actionsByClip[r];this._bindAction(t,s&&s.knownActions[0]),this._addInactiveAction(t,r,n)}const e=t._propertyBindings;for(let n=0,r=e.length;n!==r;++n){const s=e[n];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(t)}}_deactivateAction(t){if(this._isActiveAction(t)){const e=t._propertyBindings;for(let n=0,r=e.length;n!==r;++n){const s=e[n];0==--s.useCount&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(t)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}}_isActiveAction(t){const e=t._cacheIndex;return null!==e&&e<this._nActiveActions}_addInactiveAction(t,e,n){const r=this._actions,s=this._actionsByClip;let a=s[e];if(void 0===a)a={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,s[e]=a;else{const l=a.knownActions;t._byClipCacheIndex=l.length,l.push(t)}t._cacheIndex=r.length,r.push(t),a.actionByRoot[n]=t}_removeInactiveAction(t){const e=this._actions,n=e[e.length-1],r=t._cacheIndex;n._cacheIndex=r,e[r]=n,e.pop(),t._cacheIndex=null;const s=t._clip.uuid,a=this._actionsByClip,l=a[s],u=l.knownActions,h=u[u.length-1],m=t._byClipCacheIndex;h._byClipCacheIndex=m,u[m]=h,u.pop(),t._byClipCacheIndex=null,delete l.actionByRoot[(t._localRoot||this._root).uuid],0===u.length&&delete a[s],this._removeInactiveBindingsForAction(t)}_removeInactiveBindingsForAction(t){const e=t._propertyBindings;for(let n=0,r=e.length;n!==r;++n){const s=e[n];0==--s.referenceCount&&this._removeInactiveBinding(s)}}_lendAction(t){const e=this._actions,n=t._cacheIndex,r=this._nActiveActions++,s=e[r];t._cacheIndex=r,e[r]=t,s._cacheIndex=n,e[n]=s}_takeBackAction(t){const e=this._actions,n=t._cacheIndex,r=--this._nActiveActions,s=e[r];t._cacheIndex=r,e[r]=t,s._cacheIndex=n,e[n]=s}_addInactiveBinding(t,e,n){const r=this._bindingsByRootAndName,s=this._bindings;let a=r[e];void 0===a&&(a={},r[e]=a),a[n]=t,t._cacheIndex=s.length,s.push(t)}_removeInactiveBinding(t){const e=this._bindings,n=t.binding,r=n.rootNode.uuid,s=n.path,a=this._bindingsByRootAndName,l=a[r],u=e[e.length-1],h=t._cacheIndex;u._cacheIndex=h,e[h]=u,e.pop(),delete l[s],0===Object.keys(l).length&&delete a[r]}_lendBinding(t){const e=this._bindings,n=t._cacheIndex,r=this._nActiveBindings++,s=e[r];t._cacheIndex=r,e[r]=t,s._cacheIndex=n,e[n]=s}_takeBackBinding(t){const e=this._bindings,n=t._cacheIndex,r=--this._nActiveBindings,s=e[r];t._cacheIndex=r,e[r]=t,s._cacheIndex=n,e[n]=s}_lendControlInterpolant(){const t=this._controlInterpolants,e=this._nActiveControlInterpolants++;let n=t[e];return void 0===n&&(n=new J5(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),n.__cacheIndex=e,t[e]=n),n}_takeBackControlInterpolant(t){const e=this._controlInterpolants,n=t.__cacheIndex,r=--this._nActiveControlInterpolants,s=e[r];t.__cacheIndex=r,e[r]=t,s.__cacheIndex=n,e[n]=s}clipAction(t,e,n){const r=e||this._root,s=r.uuid;let a="string"==typeof t?gE.findByName(r,t):t;const l=null!==a?a.uuid:t,u=this._actionsByClip[l];let h=null;if(void 0===n&&(n=null!==a?a.blendMode:YP),void 0!==u){const _=u.actionByRoot[s];if(void 0!==_&&_.blendMode===n)return _;h=u.knownActions[0],null===a&&(a=h._clip)}if(null===a)return null;const m=new WSe(this,a,e,n);return this._bindAction(m,h),this._addInactiveAction(m,l,s),m}existingAction(t,e){const n=e||this._root,r=n.uuid,s="string"==typeof t?gE.findByName(n,t):t,l=this._actionsByClip[s?s.uuid:t];return void 0!==l&&l.actionByRoot[r]||null}stopAllAction(){const t=this._actions;for(let n=this._nActiveActions-1;n>=0;--n)t[n].stop();return this}update(t){const e=this._actions,n=this._nActiveActions,r=this.time+=t*=this.timeScale,s=Math.sign(t),a=this._accuIndex^=1;for(let h=0;h!==n;++h)e[h]._update(r,t,s,a);const l=this._bindings,u=this._nActiveBindings;for(let h=0;h!==u;++h)l[h].apply(a);return this}setTime(t){this.time=0;for(let e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(t)}getRoot(){return this._root}uncacheClip(t){const e=this._actions,n=t.uuid,r=this._actionsByClip,s=r[n];if(void 0!==s){const a=s.knownActions;for(let l=0,u=a.length;l!==u;++l){const h=a[l];this._deactivateAction(h);const m=h._cacheIndex,_=e[e.length-1];h._cacheIndex=null,h._byClipCacheIndex=null,_._cacheIndex=m,e[m]=_,e.pop(),this._removeInactiveBindingsForAction(h)}delete r[n]}}uncacheRoot(t){const e=t.uuid,n=this._actionsByClip;for(const a in n){const u=n[a].actionByRoot[e];void 0!==u&&(this._deactivateAction(u),this._removeInactiveAction(u))}const s=this._bindingsByRootAndName[e];if(void 0!==s)for(const a in s){const l=s[a];l.restoreOriginalState(),this._removeInactiveBinding(l)}}uncacheAction(t,e){const n=this.existingAction(t,e);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}pK.prototype._controlInterpolantsResultBuffer=new Float32Array(1);class sI{constructor(t){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}clone(){return new sI(void 0===this.value.clone?this.value:this.value.clone())}}class mK extends A0{constructor(t,e,n=1){super(t,e),this.meshPerAttribute=n}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}clone(t){const e=super.clone(t);return e.meshPerAttribute=this.meshPerAttribute,e}toJSON(t){const e=super.toJSON(t);return e.isInstancedInterleavedBuffer=!0,e.meshPerAttribute=this.meshPerAttribute,e}}mK.prototype.isInstancedInterleavedBuffer=!0;class gK{constructor(t,e,n,r,s){this.buffer=t,this.type=e,this.itemSize=n,this.elementSize=r,this.count=s,this.version=0}set needsUpdate(t){!0===t&&this.version++}setBuffer(t){return this.buffer=t,this}setType(t,e){return this.type=t,this.elementSize=e,this}setItemSize(t){return this.itemSize=t,this}setCount(t){return this.count=t,this}}gK.prototype.isGLBufferAttribute=!0;class jSe{constructor(t,e,n=0,r=1/0){this.ray=new Oy(t,e),this.near=n,this.far=r,this.camera=null,this.layers=new l2,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(t,e){this.ray.set(t,e)}setFromCamera(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e&&e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):console.error("THREE.Raycaster: Unsupported camera type: "+e.type)}intersectObject(t,e=!0,n=[]){return m4(t,this,n,e),n.sort(_K),n}intersectObjects(t,e=!0,n=[]){for(let r=0,s=t.length;r<s;r++)m4(t[r],this,n,e);return n.sort(_K),n}}function _K(i,t){return i.distance-t.distance}function m4(i,t,e,n){if(i.layers.test(t.layers)&&i.raycast(t,e),!0===n){const r=i.children;for(let s=0,a=r.length;s<a;s++)m4(r[s],t,e,!0)}}class qSe{constructor(t=1,e=0,n=0){return this.radius=t,this.phi=e,this.theta=n,this}set(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,e,n){return this.radius=Math.sqrt(t*t+e*e+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,n),this.phi=Math.acos($c(e/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}class XSe{constructor(t=1,e=0,n=0){return this.radius=t,this.theta=e,this.y=n,this}set(t,e,n){return this.radius=t,this.theta=e,this.y=n,this}copy(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,e,n){return this.radius=Math.sqrt(t*t+n*n),this.theta=Math.atan2(t,n),this.y=e,this}clone(){return(new this.constructor).copy(this)}}const yK=new Oi;class oC{constructor(t=new Oi(1/0,1/0),e=new Oi(-1/0,-1/0)){this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=yK.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(t){return this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return yK.copy(t).clamp(this.min,this.max).sub(t).length()}intersect(t){return this.min.max(t.min),this.max.min(t.max),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}oC.prototype.isBox2=!0;const vK=new He,oI=new He;class bK{constructor(t=new He,e=new He){this.start=t,this.end=e}set(t,e){return this.start.copy(t),this.end.copy(e),this}copy(t){return this.start.copy(t.start),this.end.copy(t.end),this}getCenter(t){return t.addVectors(this.start,this.end).multiplyScalar(.5)}delta(t){return t.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(t,e){return this.delta(e).multiplyScalar(t).add(this.start)}closestPointToPointParameter(t,e){vK.subVectors(t,this.start),oI.subVectors(this.end,this.start);const n=oI.dot(oI);let s=oI.dot(vK)/n;return e&&(s=$c(s,0,1)),s}closestPointToPoint(t,e,n){const r=this.closestPointToPointParameter(t,e);return this.delta(n).multiplyScalar(r).add(this.start)}applyMatrix4(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this}equals(t){return t.start.equals(this.start)&&t.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}}const xK=new He;class ZSe extends Zs{constructor(t,e){super(),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e;const n=new Ir,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let a=0,l=1,u=32;a<u;a++,l++){const h=a/u*Math.PI*2,m=l/u*Math.PI*2;r.push(Math.cos(h),Math.sin(h),1,Math.cos(m),Math.sin(m),1)}n.setAttribute("position",new Jn(r,3));const s=new Ic({fog:!1,toneMapped:!1});this.cone=new ph(n,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateMatrixWorld();const t=this.light.distance?this.light.distance:1e3,e=t*Math.tan(this.light.angle);this.cone.scale.set(e,e,t),xK.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(xK),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const jy=new He,aI=new nr,g4=new nr;class wK extends ph{constructor(t){const e=SK(t),n=new Ir,r=[],s=[],a=new En(0,0,1),l=new En(0,1,0);for(let h=0;h<e.length;h++){const m=e[h];m.parent&&m.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),s.push(a.r,a.g,a.b),s.push(l.r,l.g,l.b))}n.setAttribute("position",new Jn(r,3)),n.setAttribute("color",new Jn(s,3)),super(n,new Ic({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(t){const e=this.bones,n=this.geometry,r=n.getAttribute("position");g4.copy(this.root.matrixWorld).invert();for(let s=0,a=0;s<e.length;s++){const l=e[s];l.parent&&l.parent.isBone&&(aI.multiplyMatrices(g4,l.matrixWorld),jy.setFromMatrixPosition(aI),r.setXYZ(a,jy.x,jy.y,jy.z),aI.multiplyMatrices(g4,l.parent.matrixWorld),jy.setFromMatrixPosition(aI),r.setXYZ(a+1,jy.x,jy.y,jy.z),a+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(t)}}function SK(i){const t=[];i&&i.isBone&&t.push(i);for(let e=0;e<i.children.length;e++)t.push.apply(t,SK(i.children[e]));return t}class YSe extends Qa{constructor(t,e,n){super(new L0(e,4,2),new Sg({wireframe:!0,fog:!1,toneMapped:!1})),this.light=t,this.light.updateMatrixWorld(),this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const KSe=new He,CK=new En,MK=new En;class QSe extends Zs{constructor(t,e,n){super(),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;const r=new P0(e);r.rotateY(.5*Math.PI),this.material=new Sg({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const s=r.getAttribute("position"),a=new Float32Array(3*s.count);r.setAttribute("color",new lo(a,3)),this.add(new Qa(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const t=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const e=t.geometry.getAttribute("color");CK.copy(this.light.color),MK.copy(this.light.groundColor);for(let n=0,r=e.count;n<r;n++){const s=n<r/2?CK:MK;e.setXYZ(n,s.r,s.g,s.b)}e.needsUpdate=!0}t.lookAt(KSe.setFromMatrixPosition(this.light.matrixWorld).negate())}}class TK extends ph{constructor(t=10,e=10,n=4473924,r=8947848){n=new En(n),r=new En(r);const s=e/2,a=t/e,l=t/2,u=[],h=[];for(let v=0,S=0,T=-l;v<=e;v++,T+=a){u.push(-l,0,T,l,0,T),u.push(T,0,-l,T,0,l);const I=v===s?n:r;I.toArray(h,S),S+=3,I.toArray(h,S),S+=3,I.toArray(h,S),S+=3,I.toArray(h,S),S+=3}const m=new Ir;m.setAttribute("position",new Jn(u,3)),m.setAttribute("color",new Jn(h,3)),super(m,new Ic({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}class JSe extends ph{constructor(t=10,e=16,n=8,r=64,s=4473924,a=8947848){s=new En(s),a=new En(a);const l=[],u=[];for(let _=0;_<=e;_++){const v=_/e*(2*Math.PI),S=Math.sin(v)*t,T=Math.cos(v)*t;l.push(0,0,0),l.push(S,0,T);const I=1&_?s:a;u.push(I.r,I.g,I.b),u.push(I.r,I.g,I.b)}for(let _=0;_<=n;_++){const v=1&_?s:a,S=t-t/n*_;for(let T=0;T<r;T++){let I=T/r*(2*Math.PI),j=Math.sin(I)*S,P=Math.cos(I)*S;l.push(j,0,P),u.push(v.r,v.g,v.b),I=(T+1)/r*(2*Math.PI),j=Math.sin(I)*S,P=Math.cos(I)*S,l.push(j,0,P),u.push(v.r,v.g,v.b)}}const h=new Ir;h.setAttribute("position",new Jn(l,3)),h.setAttribute("color",new Jn(u,3)),super(h,new Ic({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}}const EK=new He,lI=new He,AK=new He;class $Se extends Zs{constructor(t,e,n){super(),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===e&&(e=1);let r=new Ir;r.setAttribute("position",new Jn([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));const s=new Ic({fog:!1,toneMapped:!1});this.lightPlane=new Tg(r,s),this.add(this.lightPlane),r=new Ir,r.setAttribute("position",new Jn([0,0,0,0,0,1],3)),this.targetLine=new Tg(r,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){EK.setFromMatrixPosition(this.light.matrixWorld),lI.setFromMatrixPosition(this.light.target.matrixWorld),AK.subVectors(lI,EK),this.lightPlane.lookAt(lI),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(lI),this.targetLine.scale.z=AK.length()}}const cI=new He,cl=new qT;class eCe extends ph{constructor(t){const e=new Ir,n=new Ic({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],s=[],a={},l=new En(16755200),u=new En(16711680),h=new En(43775),m=new En(16777215),_=new En(3355443);function v(T,I,j){S(T,j),S(I,j)}function S(T,I){r.push(0,0,0),s.push(I.r,I.g,I.b),void 0===a[T]&&(a[T]=[]),a[T].push(r.length/3-1)}v("n1","n2",l),v("n2","n4",l),v("n4","n3",l),v("n3","n1",l),v("f1","f2",l),v("f2","f4",l),v("f4","f3",l),v("f3","f1",l),v("n1","f1",l),v("n2","f2",l),v("n3","f3",l),v("n4","f4",l),v("p","n1",u),v("p","n2",u),v("p","n3",u),v("p","n4",u),v("u1","u2",h),v("u2","u3",h),v("u3","u1",h),v("c","t",m),v("p","c",_),v("cn1","cn2",_),v("cn3","cn4",_),v("cf1","cf2",_),v("cf3","cf4",_),e.setAttribute("position",new Jn(r,3)),e.setAttribute("color",new Jn(s,3)),super(e,n),this.type="CameraHelper",this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update()}update(){const t=this.geometry,e=this.pointMap;cl.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Pl("c",e,t,cl,0,0,-1),Pl("t",e,t,cl,0,0,1),Pl("n1",e,t,cl,-1,-1,-1),Pl("n2",e,t,cl,1,-1,-1),Pl("n3",e,t,cl,-1,1,-1),Pl("n4",e,t,cl,1,1,-1),Pl("f1",e,t,cl,-1,-1,1),Pl("f2",e,t,cl,1,-1,1),Pl("f3",e,t,cl,-1,1,1),Pl("f4",e,t,cl,1,1,1),Pl("u1",e,t,cl,.7,1.1,-1),Pl("u2",e,t,cl,-.7,1.1,-1),Pl("u3",e,t,cl,0,2,-1),Pl("cf1",e,t,cl,-1,0,1),Pl("cf2",e,t,cl,1,0,1),Pl("cf3",e,t,cl,0,-1,1),Pl("cf4",e,t,cl,0,1,1),Pl("cn1",e,t,cl,-1,0,-1),Pl("cn2",e,t,cl,1,0,-1),Pl("cn3",e,t,cl,0,-1,-1),Pl("cn4",e,t,cl,0,1,-1),t.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Pl(i,t,e,n,r,s,a){cI.set(r,s,a).unproject(n);const l=t[i];if(void 0!==l){const u=e.getAttribute("position");for(let h=0,m=l.length;h<m;h++)u.setXYZ(l[h],cI.x,cI.y,cI.z)}}const uI=new Vh;class DK extends ph{constructor(t,e=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),s=new Ir;s.setIndex(new lo(n,1)),s.setAttribute("position",new lo(r,3)),super(s,new Ic({color:e,toneMapped:!1})),this.object=t,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(t){if(void 0!==t&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&uI.setFromObject(this.object),uI.isEmpty())return;const e=uI.min,n=uI.max,r=this.geometry.attributes.position,s=r.array;s[0]=n.x,s[1]=n.y,s[2]=n.z,s[3]=e.x,s[4]=n.y,s[5]=n.z,s[6]=e.x,s[7]=e.y,s[8]=n.z,s[9]=n.x,s[10]=e.y,s[11]=n.z,s[12]=n.x,s[13]=n.y,s[14]=e.z,s[15]=e.x,s[16]=n.y,s[17]=e.z,s[18]=e.x,s[19]=e.y,s[20]=e.z,s[21]=n.x,s[22]=e.y,s[23]=e.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(t){return this.object=t,this.update(),this}copy(t){return ph.prototype.copy.call(this,t),this.object=t.object,this}}class tCe extends ph{constructor(t,e=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=new Ir;s.setIndex(new lo(n,1)),s.setAttribute("position",new Jn([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(s,new Ic({color:e,toneMapped:!1})),this.box=t,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(t){const e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(t))}}class iCe extends Tg{constructor(t,e=1,n=16776960){const r=n,a=new Ir;a.setAttribute("position",new Jn([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),a.computeBoundingSphere(),super(a,new Ic({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=t,this.size=e;const u=new Ir;u.setAttribute("position",new Jn([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),u.computeBoundingSphere(),this.add(new Qa(u,new Sg({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(t){let e=-this.plane.constant;Math.abs(e)<1e-8&&(e=1e-8),this.scale.set(.5*this.size,.5*this.size,e),this.children[0].material.side=e<0?Al:l0,this.lookAt(this.plane.normal),super.updateMatrixWorld(t)}}const RK=new He;let hI,_4;class nCe extends Zs{constructor(t=new He(0,0,1),e=new He(0,0,0),n=1,r=16776960,s=.2*n,a=.2*s){super(),this.type="ArrowHelper",void 0===hI&&(hI=new Ir,hI.setAttribute("position",new Jn([0,0,0,0,1,0],3)),_4=new Gy(0,.5,1,5,1),_4.translate(0,-.5,0)),this.position.copy(e),this.line=new Tg(hI,new Ic({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Qa(_4,new Sg({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(n,s,a)}setDirection(t){if(t.y>.99999)this.quaternion.set(0,0,0,1);else if(t.y<-.99999)this.quaternion.set(1,0,0,0);else{RK.set(t.z,0,-t.x).normalize();const e=Math.acos(t.y);this.quaternion.setFromAxisAngle(RK,e)}}setLength(t,e=.2*t,n=.2*e){this.line.scale.set(1,Math.max(1e-4,t-e),1),this.line.updateMatrix(),this.cone.scale.set(n,e,n),this.cone.position.y=t,this.cone.updateMatrix()}setColor(t){this.line.material.color.set(t),this.cone.material.color.set(t)}copy(t){return super.copy(t,!1),this.line.copy(t.line),this.cone.copy(t.cone),this}}class kK extends ph{constructor(t=1){const e=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t],r=new Ir;r.setAttribute("position",new Jn(e,3)),r.setAttribute("color",new Jn([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),super(r,new Ic({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(t,e,n){const r=new En,s=this.geometry.attributes.color.array;return r.set(t),r.toArray(s,0),r.toArray(s,3),r.set(e),r.toArray(s,6),r.toArray(s,9),r.set(n),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class rCe{constructor(){this.type="ShapePath",this.color=new En,this.subPaths=[],this.currentPath=null}moveTo(t,e){return this.currentPath=new cE,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e),this}lineTo(t,e){return this.currentPath.lineTo(t,e),this}quadraticCurveTo(t,e,n,r){return this.currentPath.quadraticCurveTo(t,e,n,r),this}bezierCurveTo(t,e,n,r,s,a){return this.currentPath.bezierCurveTo(t,e,n,r,s,a),this}splineThru(t){return this.currentPath.splineThru(t),this}toShapes(t,e){function n(E){const ie=[];for(let ee=0,ce=E.length;ee<ce;ee++){const ye=E[ee],Ce=new Bp;Ce.curves=ye.curves,ie.push(Ce)}return ie}function r(E,ie){const ee=ie.length;let ce=!1;for(let ye=ee-1,Ce=0;Ce<ee;ye=Ce++){let Ge=ie[ye],Qe=ie[Ce],nt=Qe.x-Ge.x,ge=Qe.y-Ge.y;if(Math.abs(ge)>Number.EPSILON){if(ge<0&&(Ge=ie[Ce],nt=-nt,Qe=ie[ye],ge=-ge),E.y<Ge.y||E.y>Qe.y)continue;if(E.y===Ge.y){if(E.x===Ge.x)return!0}else{const Je=ge*(E.x-Ge.x)-nt*(E.y-Ge.y);if(0===Je)return!0;if(Je<0)continue;ce=!ce}}else{if(E.y!==Ge.y)continue;if(Qe.x<=E.x&&E.x<=Ge.x||Ge.x<=E.x&&E.x<=Qe.x)return!0}}return ce}const s=Np.isClockWise,a=this.subPaths;if(0===a.length)return[];if(!0===e)return n(a);let l,u,h;const m=[];if(1===a.length)return u=a[0],h=new Bp,h.curves=u.curves,m.push(h),m;let _=!s(a[0].getPoints());_=t?!_:_;const v=[],S=[];let j,P,T=[],I=0;S[I]=void 0,T[I]=[];for(let E=0,ie=a.length;E<ie;E++)u=a[E],j=u.getPoints(),l=s(j),l=t?!l:l,l?(!_&&S[I]&&I++,S[I]={s:new Bp,p:j},S[I].s.curves=u.curves,_&&I++,T[I]=[]):T[I].push({h:u,p:j[0]});if(!S[0])return n(a);if(S.length>1){let E=!1;const ie=[];for(let ee=0,ce=S.length;ee<ce;ee++)v[ee]=[];for(let ee=0,ce=S.length;ee<ce;ee++){const ye=T[ee];for(let Ce=0;Ce<ye.length;Ce++){const Ge=ye[Ce];let Qe=!0;for(let nt=0;nt<S.length;nt++)r(Ge.p,S[nt].p)&&(ee!==nt&&ie.push({froms:ee,tos:nt,hole:Ce}),Qe?(Qe=!1,v[nt].push(Ge)):E=!0);Qe&&v[ee].push(Ge)}}ie.length>0&&(E||(T=v))}for(let E=0,ie=S.length;E<ie;E++){h=S[E].s,m.push(h),P=T[E];for(let ee=0,ce=P.length;ee<ce;ee++)h.holes.push(P[ee].h)}return m}}const PK=new Float32Array(1),sCe=new Int32Array(PK.buffer);class oCe{static toHalfFloat(t){t>65504&&(console.warn("THREE.DataUtils.toHalfFloat(): value exceeds 65504."),t=65504),PK[0]=t;const e=sCe[0];let n=e>>16&32768,r=e>>12&2047;const s=e>>23&255;return s<103?n:s>142?(n|=31744,n|=(255==s?0:1)&&8388607&e,n):s<113?(r|=2048,n|=(r>>114-s)+(r>>113-s&1),n):(n|=s-112<<10|r>>1,n+=1&r,n)}}const aCe=0,lCe=1,cCe=0,uCe=1,hCe=2;function dCe(i){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),i}function fCe(i=[]){return console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),i.isMultiMaterial=!0,i.materials=i,i.clone=function(){return i.slice()},i}function pCe(i,t){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new rE(i,t)}function mCe(i){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new L2(i)}function gCe(i,t){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new rE(i,t)}function _Ce(i){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new k0(i)}function yCe(i){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new k0(i)}function vCe(i){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new k0(i)}function bCe(i,t,e){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new He(i,t,e)}function xCe(i,t){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new lo(i,t).setUsage(xS)}function wCe(i,t){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new pZ(i,t)}function SCe(i,t){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new mZ(i,t)}function CCe(i,t){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new gZ(i,t)}function MCe(i,t){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new _Z(i,t)}function TCe(i,t){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new h2(i,t)}function ECe(i,t){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new yZ(i,t)}function ACe(i,t){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new d2(i,t)}function DCe(i,t){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new Jn(i,t)}function RCe(i,t){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new bZ(i,t)}function kCe(i){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new kK(i)}function PCe(i,t){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new DK(i,t)}function ICe(i,t){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new ph(new I5(i.geometry),new Ic({color:void 0!==t?t:16777215}))}function LCe(i,t){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new ph(new W5(i.geometry),new Ic({color:void 0!==t?t:16777215}))}function OCe(i){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Vp(i)}function FCe(i){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new UY(i)}function BCe(i,t,e){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new w2(i,e)}function NCe(){console.error("THREE.CanvasRenderer has been removed")}function HCe(){console.error("THREE.JSONLoader has been removed.")}Gh.create=function(i,t){return console.log("THREE.Curve.create() has been deprecated"),i.prototype=Object.create(Gh.prototype),i.prototype.constructor=i,i.prototype.getPoint=t,i},cE.prototype.fromPoints=function(i){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(i)},TK.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},wK.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Fu.prototype.extractUrlBase=function(i){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),nI.extractUrlBase(i)},Fu.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},oC.prototype.center=function(i){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(i)},oC.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},oC.prototype.isIntersectionBox=function(i){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(i)},oC.prototype.size=function(i){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(i)},Vh.prototype.center=function(i){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(i)},Vh.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Vh.prototype.isIntersectionBox=function(i){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(i)},Vh.prototype.isIntersectionSphere=function(i){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(i)},Vh.prototype.size=function(i){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(i)},Iy.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},XT.prototype.setFromMatrix=function(i){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(i)},bK.prototype.center=function(i){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(i)},pc.prototype.flattenToArrayOffset=function(i,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(i,t)},pc.prototype.multiplyVector3=function(i){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),i.applyMatrix3(this)},pc.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},pc.prototype.applyToBufferAttribute=function(i){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),i.applyMatrix3(this)},pc.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},pc.prototype.getInverse=function(i){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(i).invert()},nr.prototype.extractPosition=function(i){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(i)},nr.prototype.flattenToArrayOffset=function(i,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(i,t)},nr.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new He).setFromMatrixColumn(this,3)},nr.prototype.setRotationFromQuaternion=function(i){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(i)},nr.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},nr.prototype.multiplyVector3=function(i){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),i.applyMatrix4(this)},nr.prototype.multiplyVector4=function(i){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),i.applyMatrix4(this)},nr.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},nr.prototype.rotateAxis=function(i){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),i.transformDirection(this)},nr.prototype.crossVector=function(i){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),i.applyMatrix4(this)},nr.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},nr.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},nr.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},nr.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},nr.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},nr.prototype.applyToBufferAttribute=function(i){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),i.applyMatrix4(this)},nr.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},nr.prototype.makeFrustum=function(i,t,e,n,r,s){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(i,t,n,e,r,s)},nr.prototype.getInverse=function(i){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(i).invert()},Lp.prototype.isIntersectionLine=function(i){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(i)},eu.prototype.multiplyVector3=function(i){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),i.applyQuaternion(this)},eu.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},Oy.prototype.isIntersectionBox=function(i){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(i)},Oy.prototype.isIntersectionPlane=function(i){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(i)},Oy.prototype.isIntersectionSphere=function(i){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(i)},Rl.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},Rl.prototype.barycoordFromPoint=function(i,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(i,t)},Rl.prototype.midpoint=function(i){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(i)},Rl.prototypenormal=function(i){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(i)},Rl.prototype.plane=function(i){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(i)},Rl.barycoordFromPoint=function(i,t,e,n,r){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Rl.getBarycoord(i,t,e,n,r)},Rl.normal=function(i,t,e,n){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Rl.getNormal(i,t,e,n)},Bp.prototype.extractAllPoints=function(i){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(i)},Bp.prototype.extrude=function(i){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Hp(this,i)},Bp.prototype.makeGeometry=function(i){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new I0(this,i)},Oi.prototype.fromAttribute=function(i,t,e){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(i,t,e)},Oi.prototype.distanceToManhattan=function(i){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(i)},Oi.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},He.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},He.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},He.prototype.getPositionFromMatrix=function(i){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(i)},He.prototype.getScaleFromMatrix=function(i){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(i)},He.prototype.getColumnFromMatrix=function(i,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,i)},He.prototype.applyProjection=function(i){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(i)},He.prototype.fromAttribute=function(i,t,e){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(i,t,e)},He.prototype.distanceToManhattan=function(i){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(i)},He.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Bo.prototype.fromAttribute=function(i,t,e){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(i,t,e)},Bo.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Zs.prototype.getChildByName=function(i){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(i)},Zs.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},Zs.prototype.translate=function(i,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,i)},Zs.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},Zs.prototype.applyMatrix=function(i){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(i)},Object.defineProperties(Zs.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(i){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=i}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Qa.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(Qa.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),XX},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),B2.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},mc.prototype.setLens=function(i,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(i)},Object.defineProperties(Kf.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(i){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=i}},shadowCameraLeft:{set:function(i){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=i}},shadowCameraRight:{set:function(i){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=i}},shadowCameraTop:{set:function(i){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=i}},shadowCameraBottom:{set:function(i){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=i}},shadowCameraNear:{set:function(i){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=i}},shadowCameraFar:{set:function(i){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=i}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(i){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=i}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(i){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=i}},shadowMapHeight:{set:function(i){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=i}}}),Object.defineProperties(lo.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===xS},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(xS)}}}),lo.prototype.setDynamic=function(i){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===i?xS:bS),this},lo.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},lo.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Ir.prototype.addIndex=function(i){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(i)},Ir.prototype.addAttribute=function(i,t){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===i?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):this.setAttribute(i,t):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(i,new lo(arguments[1],arguments[2])))},Ir.prototype.addDrawCall=function(i,t,e){void 0!==e&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(i,t)},Ir.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},Ir.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},Ir.prototype.removeAttribute=function(i){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(i)},Ir.prototype.applyMatrix=function(i){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(i)},Object.defineProperties(Ir.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),A0.prototype.setDynamic=function(i){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===i?xS:bS),this},A0.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Hp.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},Hp.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},Hp.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},$T.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},sI.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(kc.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new En}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(i){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=i===mV}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(i){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=i}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}}),Object.defineProperties(Mg.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(i){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=i}}}),Io.prototype.clearTarget=function(i,t,e,n){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(i),this.clear(t,e,n)},Io.prototype.animate=function(i){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(i)},Io.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},Io.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},Io.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},Io.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},Io.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},Io.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},Io.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},Io.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},Io.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},Io.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},Io.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},Io.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},Io.prototype.enableScissorTest=function(i){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(i)},Io.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},Io.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},Io.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},Io.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},Io.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},Io.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},Io.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},Io.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},Io.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},Io.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(Io.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(i){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=i}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(i){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=i}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(i){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===i?ba:_g}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}},gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}}),Object.defineProperties(tY.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Hh.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(i){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=i}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(i){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=i}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(i){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=i}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(i){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=i}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(i){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=i}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(i){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=i}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(i){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=i}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(i){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=i}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(i){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=i}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(i){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=i}}}),d4.prototype.load=function(i){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const t=this;return(new iK).load(i,function(n){t.setBuffer(n)}),this},hK.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},x2.prototype.updateCubeMap=function(i,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(i,t)},x2.prototype.clear=function(i,t,e,n){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(i,t,e,n)},Ry.crossOrigin=void 0,Ry.loadTexture=function(i,t,e,n){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const r=new GY;r.setCrossOrigin(this.crossOrigin);const s=r.load(i,e,void 0,n);return t&&(s.mapping=t),s},Ry.loadTextureCube=function(i,t,e,n){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const r=new zY;r.setCrossOrigin(this.crossOrigin);const s=r.load(i,e,void 0,n);return t&&(s.mapping=t),s},Ry.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Ry.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};const VCe={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};function zCe(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")}function UCe(){return console.error("THREE.ParametricGeometry has been moved to /examples/jsm/geometries/ParametricGeometry.js"),new Ir}function GCe(){return console.error("THREE.TextGeometry has been moved to /examples/jsm/geometries/TextGeometry.js"),new Ir}function WCe(){console.error("THREE.FontLoader has been moved to /examples/jsm/loaders/FontLoader.js")}function jCe(){console.error("THREE.Font has been moved to /examples/jsm/loaders/FontLoader.js")}function qCe(){console.error("THREE.ImmediateRenderObject has been removed.")}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:HP}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=HP);const wa=window.THREE||D(712),dI=function(i,t){void 0===t&&console.warn('THREE.TrackballControls: The second parameter "domElement" is now mandatory.'),t===document&&console.error('THREE.TrackballControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.');const e=this;this.object=i,this.domElement=t,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=[65,83,68],this.mouseButtons={LEFT:wa.MOUSE.ROTATE,MIDDLE:wa.MOUSE.ZOOM,RIGHT:wa.MOUSE.PAN},this.target=new wa.Vector3;const s=new wa.Vector3;let a=-1,l=-1,u=new wa.Vector3,h=new wa.Vector2,m=new wa.Vector2,_=new wa.Vector3,v=0,S=new wa.Vector2,T=new wa.Vector2,I=0,j=0,P=new wa.Vector2,E=new wa.Vector2;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this.zoom0=this.object.zoom;var ie={type:"change"},ee={type:"start"},ce={type:"end"};this.handleResize=function(){const ct=e.domElement.getBoundingClientRect(),mi=e.domElement.ownerDocument.documentElement;e.screen.left=ct.left+window.pageXOffset-mi.clientLeft,e.screen.top=ct.top+window.pageYOffset-mi.clientTop,e.screen.width=ct.width,e.screen.height=ct.height};const ye=function(){const ct=new wa.Vector2;return function(Zi,zi){return ct.set((Zi-e.screen.left)/e.screen.width,(zi-e.screen.top)/e.screen.height),ct}}(),Ce=function(){const ct=new wa.Vector2;return function(Zi,zi){return ct.set((Zi-.5*e.screen.width-e.screen.left)/(.5*e.screen.width),(e.screen.height+2*(e.screen.top-zi))/e.screen.width),ct}}();function Ge(ct){if(!1!==e.enabled)switch(ct.pointerType){case"mouse":case"pen":!function mt(ct){if(ct.preventDefault(),ct.stopPropagation(),-1===a)switch(ct.button){case e.mouseButtons.LEFT:a=0;break;case e.mouseButtons.MIDDLE:a=1;break;case e.mouseButtons.RIGHT:a=2;break;default:a=-1}const mi=-1!==l?l:a;0!==mi||e.noRotate?1!==mi||e.noZoom?2===mi&&!e.noPan&&(P.copy(ye(ct.pageX,ct.pageY)),E.copy(P)):(S.copy(ye(ct.pageX,ct.pageY)),T.copy(S)):(m.copy(Ce(ct.pageX,ct.pageY)),h.copy(m)),e.domElement.ownerDocument.addEventListener("pointermove",Qe,!1),e.domElement.ownerDocument.addEventListener("pointerup",nt,!1),e.dispatchEvent(ee)}(ct)}}function Qe(ct){if(!1!==e.enabled)switch(ct.pointerType){case"mouse":case"pen":!function pt(ct){if(!1===e.enabled)return;ct.preventDefault(),ct.stopPropagation();const mi=-1!==l?l:a;0!==mi||e.noRotate?1!==mi||e.noZoom?2===mi&&!e.noPan&&E.copy(ye(ct.pageX,ct.pageY)):T.copy(ye(ct.pageX,ct.pageY)):(h.copy(m),m.copy(Ce(ct.pageX,ct.pageY)))}(ct)}}function nt(ct){if(!1!==e.enabled)switch(ct.pointerType){case"mouse":case"pen":!function Pt(ct){!1!==e.enabled&&(ct.preventDefault(),ct.stopPropagation(),a=-1,e.domElement.ownerDocument.removeEventListener("pointermove",Qe),e.domElement.ownerDocument.removeEventListener("pointerup",nt),e.dispatchEvent(ce))}(ct)}}function ge(ct){!1!==e.enabled&&(window.removeEventListener("keydown",ge),-1===l&&(ct.keyCode!==e.keys[0]||e.noRotate?ct.keyCode!==e.keys[1]||e.noZoom?ct.keyCode===e.keys[2]&&!e.noPan&&(l=2):l=1:l=0))}function Je(){!1!==e.enabled&&(l=-1,window.addEventListener("keydown",ge,!1))}function et(ct){if(!1!==e.enabled&&!0!==e.noZoom){switch(ct.preventDefault(),ct.stopPropagation(),ct.deltaMode){case 2:S.y-=.025*ct.deltaY;break;case 1:S.y-=.01*ct.deltaY;break;default:S.y-=25e-5*ct.deltaY}e.dispatchEvent(ee),e.dispatchEvent(ce)}}function vt(ct){if(!1!==e.enabled){if(1===(ct.preventDefault(),ct.touches.length))a=3,m.copy(Ce(ct.touches[0].pageX,ct.touches[0].pageY)),h.copy(m);else{a=4;var mi=ct.touches[0].pageX-ct.touches[1].pageX,Zi=ct.touches[0].pageY-ct.touches[1].pageY;j=I=Math.sqrt(mi*mi+Zi*Zi),P.copy(ye((ct.touches[0].pageX+ct.touches[1].pageX)/2,(ct.touches[0].pageY+ct.touches[1].pageY)/2)),E.copy(P)}e.dispatchEvent(ee)}}function kt(ct){if(!1!==e.enabled)if(1===(ct.preventDefault(),ct.stopPropagation(),ct.touches.length))h.copy(m),m.copy(Ce(ct.touches[0].pageX,ct.touches[0].pageY));else{var mi=ct.touches[0].pageX-ct.touches[1].pageX,Zi=ct.touches[0].pageY-ct.touches[1].pageY;j=Math.sqrt(mi*mi+Zi*Zi),E.copy(ye((ct.touches[0].pageX+ct.touches[1].pageX)/2,(ct.touches[0].pageY+ct.touches[1].pageY)/2))}}function pi(ct){if(!1!==e.enabled){switch(ct.touches.length){case 0:a=-1;break;case 1:a=3,m.copy(Ce(ct.touches[0].pageX,ct.touches[0].pageY)),h.copy(m)}e.dispatchEvent(ce)}}function Ht(ct){!1!==e.enabled&&ct.preventDefault()}this.rotateCamera=function(){let nn,ct=new wa.Vector3,mi=new wa.Quaternion,Zi=new wa.Vector3,zi=new wa.Vector3,Zt=new wa.Vector3,tr=new wa.Vector3;return function(){tr.set(m.x-h.x,m.y-h.y,0),nn=tr.length(),nn?(u.copy(e.object.position).sub(e.target),Zi.copy(u).normalize(),zi.copy(e.object.up).normalize(),Zt.crossVectors(zi,Zi).normalize(),zi.setLength(m.y-h.y),Zt.setLength(m.x-h.x),tr.copy(zi.add(Zt)),ct.crossVectors(tr,u).normalize(),nn*=e.rotateSpeed,mi.setFromAxisAngle(ct,nn),u.applyQuaternion(mi),e.object.up.applyQuaternion(mi),_.copy(ct),v=nn):!e.staticMoving&&v&&(v*=Math.sqrt(1-e.dynamicDampingFactor),u.copy(e.object.position).sub(e.target),mi.setFromAxisAngle(_,v),u.applyQuaternion(mi),e.object.up.applyQuaternion(mi)),h.copy(m)}}(),this.zoomCamera=function(){let ct;4===a?(ct=I/j,I=j,u.multiplyScalar(ct)):(ct=1+(T.y-S.y)*e.zoomSpeed,1!==ct&&ct>0&&u.multiplyScalar(ct),e.staticMoving?S.copy(T):S.y+=(T.y-S.y)*this.dynamicDampingFactor)},this.panCamera=function(){let ct=new wa.Vector2,mi=new wa.Vector3,Zi=new wa.Vector3;return function(){ct.copy(E).sub(P),ct.lengthSq()&&(ct.multiplyScalar(u.length()*e.panSpeed),Zi.copy(u).cross(e.object.up).setLength(ct.x),Zi.add(mi.copy(e.object.up).setLength(ct.y)),e.object.position.add(Zi),e.target.add(Zi),e.staticMoving?P.copy(E):P.add(ct.subVectors(E,P).multiplyScalar(e.dynamicDampingFactor)))}}(),this.checkDistances=function(){(!e.noZoom||!e.noPan)&&(u.lengthSq()>e.maxDistance*e.maxDistance&&(e.object.position.addVectors(e.target,u.setLength(e.maxDistance)),S.copy(T)),u.lengthSq()<e.minDistance*e.minDistance&&(e.object.position.addVectors(e.target,u.setLength(e.minDistance)),S.copy(T)))},this.update=function(){u.subVectors(e.object.position,e.target),e.noRotate||e.rotateCamera(),e.noZoom||e.zoomCamera(),e.noPan||e.panCamera(),e.object.position.addVectors(e.target,u),e.checkDistances(),e.object.lookAt(e.target),s.distanceToSquared(e.object.position)>1e-6&&(e.dispatchEvent(ie),s.copy(e.object.position))},this.reset=function(){a=-1,l=-1,e.target.copy(e.target0),e.object.position.copy(e.position0),e.object.up.copy(e.up0),u.subVectors(e.object.position,e.target),e.object.lookAt(e.target),e.dispatchEvent(ie),s.copy(e.object.position)},this.dispose=function(){e.domElement.removeEventListener("contextmenu",Ht,!1),e.domElement.removeEventListener("pointerdown",Ge,!1),e.domElement.removeEventListener("wheel",et,!1),e.domElement.removeEventListener("touchstart",vt,!1),e.domElement.removeEventListener("touchend",pi,!1),e.domElement.removeEventListener("touchmove",kt,!1),e.domElement.ownerDocument.removeEventListener("pointermove",Qe,!1),e.domElement.ownerDocument.removeEventListener("pointerup",nt,!1),window.removeEventListener("keydown",ge,!1),window.removeEventListener("keyup",Je,!1)},this.domElement.addEventListener("contextmenu",Ht,!1),this.domElement.addEventListener("pointerdown",Ge,!1),this.domElement.addEventListener("wheel",et,!1),this.domElement.addEventListener("touchstart",vt,!1),this.domElement.addEventListener("touchend",pi,!1),this.domElement.addEventListener("touchmove",kt,!1),this.domElement.ownerDocument.addEventListener("pointermove",Qe,!1),this.domElement.ownerDocument.addEventListener("pointerup",nt,!1),window.addEventListener("keydown",ge,!1),window.addEventListener("keyup",Je,!1),this.handleResize(),this.update()};(dI.prototype=Object.create(wa.EventDispatcher.prototype)).constructor=dI;const XCe=dI;var ZCe=D(8227),YCe=D(757);const y4=F;ZCe(y4);const KCe=y4.OBJLoader,QCe=YCe(y4);var IK=Ir;class Dg{static loadOBJFile(t,e,n){this.loadOBJFromPath(window.URL.createObjectURL(t),e,n)}static loadOBJFromPath(t,e,n){new KCe(n).load(t,s=>{if(s){const a=new Ir;s.traverse(l=>{l instanceof Qa&&(l.updateMatrix(),l.geometry instanceof IK)&&a.merge(l.geometry,0)}),e(new Qa(a,new fE))}})}static loadSTLFromFile(t,e,n){Dg.loadSTLFromPath(window.URL.createObjectURL(t),e,n)}static loadSTLFromPath(t,e,n){new QCe(n).load(t,s=>{s instanceof IK&&e(new Qa(s,new fE))})}static loadFromFile(t,e,n){const r=t.name.toLowerCase();r.endsWith(".obj")?Dg.loadOBJFile(t,e,n):r.endsWith(".stl")?Dg.loadSTLFromFile(t,e,n):console.log("File '"+r+"' has an unsupported format.")}static loadFromPath(t,e,n){const r=t.toLowerCase();r.endsWith(".obj")?Dg.loadOBJFromPath(t,e,n):r.endsWith(".stl")?Dg.loadSTLFromPath(t,e,n):console.log("File '"+t+"' has an unsupported format.")}}var JCe=Io,$Ce=mc;const eMe=["visualize"];let fI=(()=>{class i{constructor(){this.width=400,this.height=400,this.interaction=!1,this.src=null,this.rotate=!1}ngOnInit(){this.scene=new $T,this.manager=new iI,this.manager.onProgress=(e,n,r)=>{console.log(e,n,r)},this.initCamera(),this.initRenderer(),this.interaction&&this.initControls(),this.container.nativeElement.appendChild(this.renderer.domElement),null!=this.src&&this.loadMeshFromPath(this.src),this.render(),this.animate()}ngOnDestroy(){this.mesh&&this.scene.remove(this.mesh),this.mesh=null,this.scene=null,this.camera=null,this.renderer.dispose(),this.renderer=null,this.interaction&&(this.controls.removeEventListener("change",null),this.controls=null)}loadMeshFromFile(e){Dg.loadFromFile(e,n=>this.setMesh(n),this.manager)}loadMeshFromPath(e){Dg.loadFromPath(e,n=>this.setMesh(n),this.manager)}getMesh(){return this.mesh}setMesh(e){this.mesh&&this.scene.remove(this.mesh),this.reset(),this.mesh=e,this.scene.add(this.mesh),this.mesh.geometry.center(),this.fitObjectToCamera(),this.render()}reset(){this.rotate=!1,this.camera.position.set(0,1,1),this.camera.lookAt(this.scene.position),this.mesh&&(this.mesh.geometry.center(),this.fitObjectToCamera()),this.render()}toggleRotate(){this.rotate=!this.rotate}render(){this.renderer&&this.renderer.render(this.scene,this.camera)}fitObjectToCamera(){if(this.mesh){this.mesh.geometry.computeBoundingSphere();const e=this.mesh.geometry.boundingSphere.radius;this.mesh.scale.set(1/e,1/e,1/e);const n=Math.sqrt(2);this.camera.position.set(n,n,n),this.camera.lookAt(this.mesh.position)}}initCamera(){this.camera=new $Ce(75,this.width/this.height,.01,100),this.camera.position.set(0,1,1),this.camera.lookAt(this.scene.position)}initRenderer(){this.renderer=new JCe({antialias:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.width,this.height)}initControls(){this.controls=new H(this.camera,this.container.nativeElement),this.controls.rotateSpeed=3,this.controls.zoomSpeed=3,this.controls.panSpeed=1,this.controls.noZoom=!1,this.controls.noPan=!1,this.controls.staticMoving=!1,this.controls.dynamicDampingFactor=.3,this.controls.keys=[65,83,68],this.controls.addEventListener("change",()=>this.render())}animate(){this.controls&&(this.controls.update(),requestAnimationFrame(()=>this.animate())),this.rotate&&this.mesh&&(this.mesh.rotation.y+=.05,this.render())}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=ei({type:i,selectors:[["app-m3d-loader"]],viewQuery:function(e,n){if(1&e&&ji(eMe,5),2&e){let r;jt(r=qt())&&(n.container=r.first)}},inputs:{width:"width",height:"height",interaction:"interaction",src:"src"},decls:2,vars:0,consts:[["visualize",""]],template:function(e,n){1&e&&yt(0,"div",null,0)},encapsulation:2}),i})();const tMe=["m3dloader"],iMe=["fileloader"];let nMe=(()=>{class i{constructor(e){this.dialogRef=e}onFileAvailable(e){this.loader.loadMeshFromFile(e.target.files[0]),this.fileloader.nativeElement.value=null}onLoadFilePressed(){this.fileloader.nativeElement.click()}onSavePressed(){this.loader.getMesh()?this.dialogRef.close(this.loader.getMesh()):this.dialogRef.close()}}return i.\u0275fac=function(e){return new(e||i)(B(Ip))},i.\u0275cmp=ei({type:i,selectors:[["app-m3dloader-dialog"]],viewQuery:function(e,n){if(1&e&&(ji(tMe,5),ji(iMe,5)),2&e){let r;jt(r=qt())&&(n.loader=r.first),jt(r=qt())&&(n.fileloader=r.first)}},decls:15,vars:3,consts:[["color","primary"],["mat-icon-button",""],[1,"spacer-flex"],["mat-icon-button","",3,"click"],[3,"height","interaction","width"],["m3dloader",""],["hidden","","type","file",3,"change"],["fileloader",""]],template:function(e,n){1&e&&(Z(0,"mat-toolbar",0)(1,"button",1)(2,"mat-icon"),ue(3,"rotate_left"),J()(),yt(4,"span",2),Z(5,"button",3),je("click",function(){return n.onLoadFilePressed()}),Z(6,"mat-icon"),ue(7,"file_upload"),J()(),Z(8,"button",3),je("click",function(){return n.onSavePressed()}),Z(9,"mat-icon"),ue(10,"save"),J()()(),yt(11,"app-m3d-loader",4,5),Z(13,"input",6,7),je("change",function(s){return n.onFileAvailable(s)}),J()),2&e&&(se(11),fe("height",300)("interaction",!0)("width",300))},directives:[My,Mo,vo,fI],encapsulation:2}),i})();const rMe=["imageloader"],sMe=["sketch"];let oMe=(()=>{class i{constructor(e,n){this._dialogRef=e,this._data=n,this.color="#FFFFFF",this.linesize=i.DEFAULT_LINESIZE}ngAfterViewInit(){this._data&&"string"==typeof this._data?(this._sketchpad.setImageBase64(this._data),this._data=null):(this._sketchpad.setActiveColor("#000000"),this._sketchpad.fillCanvas(),this._sketchpad.setActiveColor("#FFFFFF")),this._sketchpad.setLineSize(this.linesize)}close(){this._dialogRef.close(this._sketchpad.getImageBase64())}onColorChange(e){this.color=e,this._sketchpad.setActiveColor(this.color)}onLineSizeChange(){this._sketchpad.setLineSize(this.linesize)}onClearCanvasClicked(){this._sketchpad.setActiveColor("#000000"),this._sketchpad.fillCanvas(),this._sketchpad.setActiveColor("#FFFFFF")}onFillCanvasClicked(){this._sketchpad.fillCanvas()}}return i.DEFAULT_LINESIZE=10,i.\u0275fac=function(e){return new(e||i)(B(Ip),B(Cy))},i.\u0275cmp=ei({type:i,selectors:[["app-binary-sketchpad"]],viewQuery:function(e,n){if(1&e&&(ji(rMe,5),ji(sMe,5)),2&e){let r;jt(r=qt())&&(n.imageloader=r.first),jt(r=qt())&&(n._sketchpad=r.first)}},decls:20,vars:25,consts:[["color","primary"],[3,"click"],[1,"spacer-tiny"],["max","100","min","1","step","1","tickInterval","auto",3,"ngModel","change","ngModelChange"],[1,"spacer-flex"],["mat-icon-button","","matTooltip","Clear canvas",3,"click"],["mat-icon-button","","matTooltip","Save sketch",3,"click"],[3,"height","width"],["sketch",""],["hidden","","type","file"],["imageloader",""]],template:function(e,n){1&e&&(Z(0,"mat-toolbar",0)(1,"span",1),je("click",function(){return n.onColorChange("#FFFFFF")}),J(),yt(2,"span",2),Z(3,"span",1),je("click",function(){return n.onColorChange("#000000")}),J(),yt(4,"span",2),Z(5,"mat-icon"),ue(6,"border_color"),J(),yt(7,"span",2),Z(8,"mat-slider",3),je("change",function(){return n.onLineSizeChange()})("ngModelChange",function(s){return n.linesize=s}),J(),yt(9,"span",4),Z(10,"button",5),je("click",function(){return n.onClearCanvasClicked()}),Z(11,"mat-icon"),ue(12,"clear"),J()(),Z(13,"button",6),je("click",function(){return n.close()}),Z(14,"mat-icon"),ue(15,"save"),J()()(),yt(16,"app-sketch-canvas",7,8)(18,"input",9,10)),2&e&&(se(1),A("background-color","#FFFFFF")("border-color","red")("border-style","#FFFFFF"===n.color?"solid":"none")("height","15px")("width","15px"),se(2),A("background-color","#000000")("border-color","red")("border-style","#000000"===n.color?"solid":"none")("height","15px")("width","15px"),se(5),A("min-width","100px"),fe("ngModel",n.linesize),se(8),fe("height",300)("width",300))},directives:[My,vo,Ey,ah,lh,Mo,Fo,cV],encapsulation:2}),i})();const aMe=["thumbContainer"],lMe=["toggleBar"],cMe=["input"],uMe=function(i){return{enterDuration:i}},hMe=["*"],dMe=new gi("mat-slide-toggle-default-options",{providedIn:"root",factory:()=>({disableToggleValue:!1})});let fMe=0;const pMe={provide:Ac,useExisting:rs(()=>v4),multi:!0};class mMe{constructor(t,e){this.source=t,this.checked=e}}const gMe=Ww(Vf(uh(Hf(class{constructor(i){this._elementRef=i}}))));let v4=(()=>{class i extends gMe{constructor(e,n,r,s,a,l){super(e),this._focusMonitor=n,this._changeDetectorRef=r,this.defaults=a,this._onChange=u=>{},this._onTouched=()=>{},this._uniqueId="mat-slide-toggle-"+ ++fMe,this._required=!1,this._checked=!1,this.name=null,this.id=this._uniqueId,this.labelPosition="after",this.ariaLabel=null,this.ariaLabelledby=null,this.change=new Si,this.toggleChange=new Si,this.tabIndex=parseInt(s)||0,this.color=this.defaultColor=a.color||"accent",this._noopAnimations="NoopAnimations"===l}get required(){return this._required}set required(e){this._required=tn(e)}get checked(){return this._checked}set checked(e){this._checked=tn(e),this._changeDetectorRef.markForCheck()}get inputId(){return`${this.id||this._uniqueId}-input`}ngAfterContentInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(e=>{e||Promise.resolve().then(()=>this._onTouched())})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}_onChangeEvent(e){e.stopPropagation(),this.toggleChange.emit(),this.defaults.disableToggleValue?this._inputElement.nativeElement.checked=this.checked:(this.checked=this._inputElement.nativeElement.checked,this._emitChangeEvent())}_onInputClick(e){e.stopPropagation()}writeValue(e){this.checked=!!e}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this.disabled=e,this._changeDetectorRef.markForCheck()}focus(e,n){n?this._focusMonitor.focusVia(this._inputElement,n,e):this._inputElement.nativeElement.focus(e)}toggle(){this.checked=!this.checked,this._onChange(this.checked)}_emitChangeEvent(){this._onChange(this.checked),this.change.emit(new mMe(this,this.checked))}_onLabelTextChange(){this._changeDetectorRef.detectChanges()}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(ch),B(Pn),zc("tabindex"),B(dMe),B(ga,8))},i.\u0275cmp=ei({type:i,selectors:[["mat-slide-toggle"]],viewQuery:function(e,n){if(1&e&&(ji(aMe,5),ji(lMe,5),ji(cMe,5)),2&e){let r;jt(r=qt())&&(n._thumbEl=r.first),jt(r=qt())&&(n._thumbBarEl=r.first),jt(r=qt())&&(n._inputElement=r.first)}},hostAttrs:[1,"mat-slide-toggle"],hostVars:13,hostBindings:function(e,n){2&e&&(dn("id",n.id),Vi("tabindex",null)("aria-label",null)("aria-labelledby",null)("name",null),N("mat-checked",n.checked)("mat-disabled",n.disabled)("mat-slide-toggle-label-before","before"==n.labelPosition)("_mat-animation-noopable",n._noopAnimations))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color",tabIndex:"tabIndex",name:"name",id:"id",labelPosition:"labelPosition",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],ariaDescribedby:["aria-describedby","ariaDescribedby"],required:"required",checked:"checked"},outputs:{change:"change",toggleChange:"toggleChange"},exportAs:["matSlideToggle"],features:[Sn([pMe]),It],ngContentSelectors:hMe,decls:16,vars:20,consts:[[1,"mat-slide-toggle-label"],["label",""],[1,"mat-slide-toggle-bar"],["toggleBar",""],["type","checkbox","role","switch",1,"mat-slide-toggle-input","cdk-visually-hidden",3,"id","required","tabIndex","checked","disabled","change","click"],["input",""],[1,"mat-slide-toggle-thumb-container"],["thumbContainer",""],[1,"mat-slide-toggle-thumb"],["mat-ripple","",1,"mat-slide-toggle-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered","matRippleRadius","matRippleAnimation"],[1,"mat-ripple-element","mat-slide-toggle-persistent-ripple"],[1,"mat-slide-toggle-content",3,"cdkObserveContent"],["labelContent",""],[2,"display","none"]],template:function(e,n){if(1&e&&(As(),Z(0,"label",0,1)(2,"span",2,3)(4,"input",4,5),je("change",function(s){return n._onChangeEvent(s)})("click",function(s){return n._onInputClick(s)}),J(),Z(6,"span",6,7),yt(8,"span",8),Z(9,"span",9),yt(10,"span",10),J()()(),Z(11,"span",11,12),je("cdkObserveContent",function(){return n._onLabelTextChange()}),Z(13,"span",13),ue(14,"\xa0"),J(),hr(15),J()()),2&e){const r=Yo(1),s=Yo(12);Vi("for",n.inputId),se(2),N("mat-slide-toggle-bar-no-side-margin",!s.textContent||!s.textContent.trim()),se(2),fe("id",n.inputId)("required",n.required)("tabIndex",n.tabIndex)("checked",n.checked)("disabled",n.disabled),Vi("name",n.name)("aria-checked",n.checked)("aria-label",n.ariaLabel)("aria-labelledby",n.ariaLabelledby)("aria-describedby",n.ariaDescribedby),se(5),fe("matRippleTrigger",r)("matRippleDisabled",n.disableRipple||n.disabled)("matRippleCentered",!0)("matRippleRadius",20)("matRippleAnimation",yb(18,uMe,n._noopAnimations?0:150))}},directives:[hh,wk],styles:[".mat-slide-toggle{display:inline-block;height:24px;max-width:100%;line-height:24px;white-space:nowrap;outline:none;-webkit-tap-highlight-color:transparent}.mat-slide-toggle.mat-checked .mat-slide-toggle-thumb-container{transform:translate3d(16px, 0, 0)}[dir=rtl] .mat-slide-toggle.mat-checked .mat-slide-toggle-thumb-container{transform:translate3d(-16px, 0, 0)}.mat-slide-toggle.mat-disabled{opacity:.38}.mat-slide-toggle.mat-disabled .mat-slide-toggle-label,.mat-slide-toggle.mat-disabled .mat-slide-toggle-thumb-container{cursor:default}.mat-slide-toggle-label{-webkit-user-select:none;user-select:none;display:flex;flex:1;flex-direction:row;align-items:center;height:inherit;cursor:pointer}.mat-slide-toggle-content{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-slide-toggle-label-before .mat-slide-toggle-label{order:1}.mat-slide-toggle-label-before .mat-slide-toggle-bar{order:2}[dir=rtl] .mat-slide-toggle-label-before .mat-slide-toggle-bar,.mat-slide-toggle-bar{margin-right:8px;margin-left:0}[dir=rtl] .mat-slide-toggle-bar,.mat-slide-toggle-label-before .mat-slide-toggle-bar{margin-left:8px;margin-right:0}.mat-slide-toggle-bar-no-side-margin{margin-left:0;margin-right:0}.mat-slide-toggle-thumb-container{position:absolute;z-index:1;width:20px;height:20px;top:-3px;left:0;transform:translate3d(0, 0, 0);transition:all 80ms linear;transition-property:transform}._mat-animation-noopable .mat-slide-toggle-thumb-container{transition:none}[dir=rtl] .mat-slide-toggle-thumb-container{left:auto;right:0}.mat-slide-toggle-thumb{height:20px;width:20px;border-radius:50%;display:block}.mat-slide-toggle-bar{position:relative;width:36px;height:14px;flex-shrink:0;border-radius:8px}.mat-slide-toggle-input{bottom:0;left:10px}[dir=rtl] .mat-slide-toggle-input{left:auto;right:10px}.mat-slide-toggle-bar,.mat-slide-toggle-thumb{transition:all 80ms linear;transition-property:background-color;transition-delay:50ms}._mat-animation-noopable .mat-slide-toggle-bar,._mat-animation-noopable .mat-slide-toggle-thumb{transition:none}.mat-slide-toggle .mat-slide-toggle-ripple{position:absolute;top:calc(50% - 20px);left:calc(50% - 20px);height:40px;width:40px;z-index:1;pointer-events:none}.mat-slide-toggle .mat-slide-toggle-ripple .mat-ripple-element:not(.mat-slide-toggle-persistent-ripple){opacity:.12}.mat-slide-toggle-persistent-ripple{width:100%;height:100%;transform:none}.mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{opacity:.04}.mat-slide-toggle:not(.mat-disabled).cdk-keyboard-focused .mat-slide-toggle-persistent-ripple{opacity:.12}.mat-slide-toggle-persistent-ripple,.mat-slide-toggle.mat-disabled .mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{opacity:0}@media(hover: none){.mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{display:none}}.cdk-high-contrast-active .mat-slide-toggle-thumb,.cdk-high-contrast-active .mat-slide-toggle-bar{border:1px solid}.cdk-high-contrast-active .mat-slide-toggle.cdk-keyboard-focused .mat-slide-toggle-bar{outline:2px dotted;outline-offset:5px}\n"],encapsulation:2,changeDetection:0}),i})(),LK=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({}),i})(),OK=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[LK,zf,jn,H1],LK,jn]}),i})();const vMe=["previewmodel"],bMe=["previewimg"];function xMe(i,t){if(1&i){const e=Wi();Z(0,"app-m3d-loader",5,6),je("click",function(){return gt(e),Re().onModelViewerClicked()})("dragenter",function(r){return gt(e),Re().onModelViewerDragEnter(r)})("dragleave",function(r){return gt(e),Re().onModelViewerDragExit(r)})("dragover",function(r){return gt(e),Re().onModelViewerDragOver(r)})("drop",function(){return gt(e),Re().onModelViewerDropped()}),J()}2&i&&fe("height",150)("interaction",!1)("width",150)}function wMe(i,t){if(1&i){const e=Wi();Z(0,"img",7,8),je("click",function(){return gt(e),Re().onImageViewerClicked()}),J()}}function SMe(i,t){if(1&i){const e=Wi();Z(0,"div",2)(1,"mat-icon",9),ue(2,"looks_1"),J(),yt(3,"div",10),Z(4,"mat-slider",11),je("change",function(){return gt(e),Re().onSliderChanged()})("ngModelChange",function(r){return gt(e),Re().sliderSetting=r}),J(),yt(5,"div",10),Z(6,"mat-icon",12),ue(7,"looks_3"),J()()}if(2&i){const e=Re();se(4),fe("ngModel",e.sliderSetting)}}let CMe=(()=>{class i{constructor(e,n){this.dialog=e,this._snackBar=n,this.sketch=!1}ngOnInit(){this.m3dTerm.data&&(this.sliderSetting=this.m3dTerm.sliderSetting,this._snackBar.open("Transferring 3D-Sketches or meshes between stages is currently not supported","",{duration:5e3}),this.onSliderChanged())}onModeToggled(e){this.sketch=!this.sketch,this.m3dTerm.setCategories(["lightfield"])}onSliderChanged(){switch(this.m3dTerm.sliderSetting=this.sliderSetting,this.sliderSetting){case 0:this.m3dTerm.setCategories(["sphericalharmonicslow"]);break;case 1:this.m3dTerm.setCategories(["sphericalharmonicsdefault"]);break;case 2:this.m3dTerm.setCategories(["sphericalharmonicshigh","lightfield"])}}onModelViewerClicked(){this.openM3DDialog(this.preview.getMesh())}onModelViewerDragEnter(e){e.preventDefault(),e.stopPropagation()}onModelViewerDragOver(e){e.preventDefault(),e.stopPropagation()}onModelViewerDragExit(e){e.preventDefault(),e.stopPropagation()}onModelViewerDropped(e){e.preventDefault(),e.stopPropagation(),e.dataTransfer.files.length>0&&Dg.loadFromFile(e.dataTransfer.files.item(0),n=>{this.preview.setMesh(n),this.m3dTerm.data="data:application/3d-json;base64,"+btoa(JSON.stringify(n.geometry.toJSON().data))})}onImageViewerClicked(){this.openSketchDialog(this.previewimg.nativeElement.src)}openM3DDialog(e){this.dialog.open(nMe,{data:e}).beforeClosed().pipe(Xl()).subscribe(r=>{r&&(this.preview.setMesh(r),this.preview.render(),this.m3dTerm.data="data:application/3d-json;base64,"+btoa(JSON.stringify(r.geometry.toJSON().data)))})}openSketchDialog(e){this.dialog.open(oMe,{data:e}).afterClosed().pipe(Xl()).subscribe(r=>{r&&(this.previewimg.nativeElement.src=r,this.m3dTerm.data=r)})}}return i.\u0275fac=function(e){return new(e||i)(B(Lu),B(Ru))},i.\u0275cmp=ei({type:i,selectors:[["app-qt-m3d"]],viewQuery:function(e,n){if(1&e&&(ji(vMe,5),ji(bMe,5)),2&e){let r;jt(r=qt())&&(n.preview=r.first),jt(r=qt())&&(n.previewimg=r.first)}},inputs:{m3dTerm:"m3dTerm"},decls:6,vars:3,consts:[["matTooltip","Click to change 3D model...",3,"height","interaction","width","click","dragenter","dragleave","dragover","drop",4,"ngIf"],["class","previewimg","matTooltip","Click to open sketch pad...","width","150",3,"click",4,"ngIf"],[2,"display","flex","align-items","center","justify-content","center"],[3,"change"],["style","display:flex; align-items: center; justify-content: center;",4,"ngIf"],["matTooltip","Click to change 3D model...",3,"height","interaction","width","click","dragenter","dragleave","dragover","drop"],["previewmodel",""],["matTooltip","Click to open sketch pad...","width","150",1,"previewimg",3,"click"],["previewimg",""],["matTooltip","Low resolution",1,"muted"],[1,"toolbar-spacer-small"],["max","2","min","0","step","1","value","1",3,"ngModel","change","ngModelChange"],["matTooltip","High resolution",1,"muted"]],template:function(e,n){1&e&&(Ue(0,xMe,2,3,"app-m3d-loader",0),Ue(1,wMe,2,0,"img",1),Z(2,"div",2)(3,"mat-slide-toggle",3),je("change",function(s){return n.onModeToggled(s)}),ue(4,"2D Sketch"),J()(),Ue(5,SMe,8,1,"div",4)),2&e&&(fe("ngIf",!n.sketch),se(1),fe("ngIf",n.sketch),se(4),fe("ngIf",!n.sketch))},directives:[ms,fI,Fo,v4,vo,Ey,ah,lh],styles:["img.previewimg[_ngcontent-%COMP%]{width:150px;height:150px;border:solid .5px;display:inline-block}"]}),i})();const MMe=["input"],TMe=function(i){return{enterDuration:i}},EMe=["*"],AMe=new gi("mat-checkbox-default-options",{providedIn:"root",factory:FK});function FK(){return{color:"accent",clickAction:"check-indeterminate"}}let DMe=0;const BK=FK(),RMe={provide:Ac,useExisting:rs(()=>b4),multi:!0};class kMe{}const PMe=Ww(Vf(uh(Hf(class{constructor(i){this._elementRef=i}}))));let b4=(()=>{class i extends PMe{constructor(e,n,r,s,a,l,u){super(e),this._changeDetectorRef=n,this._focusMonitor=r,this._ngZone=s,this._animationMode=l,this._options=u,this.ariaLabel="",this.ariaLabelledby=null,this._uniqueId="mat-checkbox-"+ ++DMe,this.id=this._uniqueId,this.labelPosition="after",this.name=null,this.change=new Si,this.indeterminateChange=new Si,this._onTouched=()=>{},this._currentAnimationClass="",this._currentCheckState=0,this._controlValueAccessorChangeFn=()=>{},this._checked=!1,this._disabled=!1,this._indeterminate=!1,this._options=this._options||BK,this.color=this.defaultColor=this._options.color||BK.color,this.tabIndex=parseInt(a)||0}get inputId(){return`${this.id||this._uniqueId}-input`}get required(){return this._required}set required(e){this._required=tn(e)}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(e=>{e||Promise.resolve().then(()=>{this._onTouched(),this._changeDetectorRef.markForCheck()})}),this._syncIndeterminate(this._indeterminate)}ngAfterViewChecked(){}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}get checked(){return this._checked}set checked(e){e!=this.checked&&(this._checked=e,this._changeDetectorRef.markForCheck())}get disabled(){return this._disabled}set disabled(e){const n=tn(e);n!==this.disabled&&(this._disabled=n,this._changeDetectorRef.markForCheck())}get indeterminate(){return this._indeterminate}set indeterminate(e){const n=e!=this._indeterminate;this._indeterminate=tn(e),n&&(this._transitionCheckState(this._indeterminate?3:this.checked?1:2),this.indeterminateChange.emit(this._indeterminate)),this._syncIndeterminate(this._indeterminate)}_isRippleDisabled(){return this.disableRipple||this.disabled}_onLabelTextChange(){this._changeDetectorRef.detectChanges()}writeValue(e){this.checked=!!e}registerOnChange(e){this._controlValueAccessorChangeFn=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this.disabled=e}_getAriaChecked(){return this.checked?"true":this.indeterminate?"mixed":"false"}_transitionCheckState(e){let n=this._currentCheckState,r=this._elementRef.nativeElement;if(n!==e&&(this._currentAnimationClass.length>0&&r.classList.remove(this._currentAnimationClass),this._currentAnimationClass=this._getAnimationClassForCheckStateTransition(n,e),this._currentCheckState=e,this._currentAnimationClass.length>0)){r.classList.add(this._currentAnimationClass);const s=this._currentAnimationClass;this._ngZone.runOutsideAngular(()=>{setTimeout(()=>{r.classList.remove(s)},1e3)})}}_emitChangeEvent(){const e=new kMe;e.source=this,e.checked=this.checked,this._controlValueAccessorChangeFn(this.checked),this.change.emit(e),this._inputElement&&(this._inputElement.nativeElement.checked=this.checked)}toggle(){this.checked=!this.checked,this._controlValueAccessorChangeFn(this.checked)}_onInputClick(e){var n;const r=null===(n=this._options)||void 0===n?void 0:n.clickAction;e.stopPropagation(),this.disabled||"noop"===r?!this.disabled&&"noop"===r&&(this._inputElement.nativeElement.checked=this.checked,this._inputElement.nativeElement.indeterminate=this.indeterminate):(this.indeterminate&&"check"!==r&&Promise.resolve().then(()=>{this._indeterminate=!1,this.indeterminateChange.emit(this._indeterminate)}),this._checked=!this._checked,this._transitionCheckState(this._checked?1:2),this._emitChangeEvent())}focus(e,n){e?this._focusMonitor.focusVia(this._inputElement,e,n):this._inputElement.nativeElement.focus(n)}_onInteractionEvent(e){e.stopPropagation()}_getAnimationClassForCheckStateTransition(e,n){if("NoopAnimations"===this._animationMode)return"";let r="";switch(e){case 0:if(1===n)r="unchecked-checked";else{if(3!=n)return"";r="unchecked-indeterminate"}break;case 2:r=1===n?"unchecked-checked":"unchecked-indeterminate";break;case 1:r=2===n?"checked-unchecked":"checked-indeterminate";break;case 3:r=1===n?"indeterminate-checked":"indeterminate-unchecked"}return`mat-checkbox-anim-${r}`}_syncIndeterminate(e){const n=this._inputElement;n&&(n.nativeElement.indeterminate=e)}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(Pn),B(ch),B(Rn),zc("tabindex"),B(ga,8),B(AMe,8))},i.\u0275cmp=ei({type:i,selectors:[["mat-checkbox"]],viewQuery:function(e,n){if(1&e&&(ji(MMe,5),ji(hh,5)),2&e){let r;jt(r=qt())&&(n._inputElement=r.first),jt(r=qt())&&(n.ripple=r.first)}},hostAttrs:[1,"mat-checkbox"],hostVars:14,hostBindings:function(e,n){2&e&&(dn("id",n.id),Vi("tabindex",null)("aria-label",null)("aria-labelledby",null),N("mat-checkbox-indeterminate",n.indeterminate)("mat-checkbox-checked",n.checked)("mat-checkbox-disabled",n.disabled)("mat-checkbox-label-before","before"==n.labelPosition)("_mat-animation-noopable","NoopAnimations"===n._animationMode))},inputs:{disableRipple:"disableRipple",color:"color",tabIndex:"tabIndex",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],ariaDescribedby:["aria-describedby","ariaDescribedby"],id:"id",required:"required",labelPosition:"labelPosition",name:"name",value:"value",checked:"checked",disabled:"disabled",indeterminate:"indeterminate"},outputs:{change:"change",indeterminateChange:"indeterminateChange"},exportAs:["matCheckbox"],features:[Sn([RMe]),It],ngContentSelectors:EMe,decls:17,vars:21,consts:[[1,"mat-checkbox-layout"],["label",""],[1,"mat-checkbox-inner-container"],["type","checkbox",1,"mat-checkbox-input","cdk-visually-hidden",3,"id","required","checked","disabled","tabIndex","change","click"],["input",""],["matRipple","",1,"mat-checkbox-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleRadius","matRippleCentered","matRippleAnimation"],[1,"mat-ripple-element","mat-checkbox-persistent-ripple"],[1,"mat-checkbox-frame"],[1,"mat-checkbox-background"],["version","1.1","focusable","false","viewBox","0 0 24 24","aria-hidden","true",1,"mat-checkbox-checkmark"],["fill","none","stroke","white","d","M4.1,12.7 9,17.6 20.3,6.3",1,"mat-checkbox-checkmark-path"],[1,"mat-checkbox-mixedmark"],[1,"mat-checkbox-label",3,"cdkObserveContent"],["checkboxLabel",""],[2,"display","none"]],template:function(e,n){if(1&e&&(As(),Z(0,"label",0,1)(2,"span",2)(3,"input",3,4),je("change",function(s){return n._onInteractionEvent(s)})("click",function(s){return n._onInputClick(s)}),J(),Z(5,"span",5),yt(6,"span",6),J(),yt(7,"span",7),Z(8,"span",8),Zu(),Z(9,"svg",9),yt(10,"path",10),J(),xd(),yt(11,"span",11),J()(),Z(12,"span",12,13),je("cdkObserveContent",function(){return n._onLabelTextChange()}),Z(14,"span",14),ue(15,"\xa0"),J(),hr(16),J()()),2&e){const r=Yo(1),s=Yo(13);Vi("for",n.inputId),se(2),N("mat-checkbox-inner-container-no-side-margin",!s.textContent||!s.textContent.trim()),se(1),fe("id",n.inputId)("required",n.required)("checked",n.checked)("disabled",n.disabled)("tabIndex",n.tabIndex),Vi("value",n.value)("name",n.name)("aria-label",n.ariaLabel||null)("aria-labelledby",n.ariaLabelledby)("aria-checked",n._getAriaChecked())("aria-describedby",n.ariaDescribedby),se(2),fe("matRippleTrigger",r)("matRippleDisabled",n._isRippleDisabled())("matRippleRadius",20)("matRippleCentered",!0)("matRippleAnimation",yb(19,TMe,"NoopAnimations"===n._animationMode?0:150))}},directives:[hh,wk],styles:["@keyframes mat-checkbox-fade-in-background{0%{opacity:0}50%{opacity:1}}@keyframes mat-checkbox-fade-out-background{0%,50%{opacity:1}100%{opacity:0}}@keyframes mat-checkbox-unchecked-checked-checkmark-path{0%,50%{stroke-dashoffset:22.910259}50%{animation-timing-function:cubic-bezier(0, 0, 0.2, 0.1)}100%{stroke-dashoffset:0}}@keyframes mat-checkbox-unchecked-indeterminate-mixedmark{0%,68.2%{transform:scaleX(0)}68.2%{animation-timing-function:cubic-bezier(0, 0, 0, 1)}100%{transform:scaleX(1)}}@keyframes mat-checkbox-checked-unchecked-checkmark-path{from{animation-timing-function:cubic-bezier(0.4, 0, 1, 1);stroke-dashoffset:0}to{stroke-dashoffset:-22.910259}}@keyframes mat-checkbox-checked-indeterminate-checkmark{from{animation-timing-function:cubic-bezier(0, 0, 0.2, 0.1);opacity:1;transform:rotate(0deg)}to{opacity:0;transform:rotate(45deg)}}@keyframes mat-checkbox-indeterminate-checked-checkmark{from{animation-timing-function:cubic-bezier(0.14, 0, 0, 1);opacity:0;transform:rotate(45deg)}to{opacity:1;transform:rotate(360deg)}}@keyframes mat-checkbox-checked-indeterminate-mixedmark{from{animation-timing-function:cubic-bezier(0, 0, 0.2, 0.1);opacity:0;transform:rotate(-45deg)}to{opacity:1;transform:rotate(0deg)}}@keyframes mat-checkbox-indeterminate-checked-mixedmark{from{animation-timing-function:cubic-bezier(0.14, 0, 0, 1);opacity:1;transform:rotate(0deg)}to{opacity:0;transform:rotate(315deg)}}@keyframes mat-checkbox-indeterminate-unchecked-mixedmark{0%{animation-timing-function:linear;opacity:1;transform:scaleX(1)}32.8%,100%{opacity:0;transform:scaleX(0)}}.mat-checkbox-background,.mat-checkbox-frame{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:2px;box-sizing:border-box;pointer-events:none}.mat-checkbox{display:inline-block;transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);cursor:pointer;-webkit-tap-highlight-color:transparent}._mat-animation-noopable.mat-checkbox{transition:none;animation:none}.mat-checkbox .mat-ripple-element:not(.mat-checkbox-persistent-ripple){opacity:.16}.mat-checkbox .mat-checkbox-ripple{position:absolute;left:calc(50% - 20px);top:calc(50% - 20px);height:40px;width:40px;z-index:1;pointer-events:none}.cdk-high-contrast-active .mat-checkbox.cdk-keyboard-focused .mat-checkbox-ripple{outline:solid 3px}.mat-checkbox-layout{-webkit-user-select:none;user-select:none;cursor:inherit;align-items:baseline;vertical-align:middle;display:inline-flex;white-space:nowrap}.mat-checkbox-label{-webkit-user-select:auto;user-select:auto}.mat-checkbox-inner-container{display:inline-block;height:16px;line-height:0;margin:auto;margin-right:8px;order:0;position:relative;vertical-align:middle;white-space:nowrap;width:16px;flex-shrink:0}[dir=rtl] .mat-checkbox-inner-container{margin-left:8px;margin-right:auto}.mat-checkbox-inner-container-no-side-margin{margin-left:0;margin-right:0}.mat-checkbox-frame{background-color:transparent;transition:border-color 90ms cubic-bezier(0, 0, 0.2, 0.1);border-width:2px;border-style:solid}._mat-animation-noopable .mat-checkbox-frame{transition:none}.mat-checkbox-background{align-items:center;display:inline-flex;justify-content:center;transition:background-color 90ms cubic-bezier(0, 0, 0.2, 0.1),opacity 90ms cubic-bezier(0, 0, 0.2, 0.1);-webkit-print-color-adjust:exact;color-adjust:exact}._mat-animation-noopable .mat-checkbox-background{transition:none}.cdk-high-contrast-active .mat-checkbox .mat-checkbox-background{background:none}.mat-checkbox-persistent-ripple{display:block;width:100%;height:100%;transform:none}.mat-checkbox-inner-container:hover .mat-checkbox-persistent-ripple{opacity:.04}.mat-checkbox.cdk-keyboard-focused .mat-checkbox-persistent-ripple{opacity:.12}.mat-checkbox-persistent-ripple,.mat-checkbox.mat-checkbox-disabled .mat-checkbox-inner-container:hover .mat-checkbox-persistent-ripple{opacity:0}@media(hover: none){.mat-checkbox-inner-container:hover .mat-checkbox-persistent-ripple{display:none}}.mat-checkbox-checkmark{top:0;left:0;right:0;bottom:0;position:absolute;width:100%}.mat-checkbox-checkmark-path{stroke-dashoffset:22.910259;stroke-dasharray:22.910259;stroke-width:2.1333333333px}.cdk-high-contrast-black-on-white .mat-checkbox-checkmark-path{stroke:#000 !important}.mat-checkbox-mixedmark{width:calc(100% - 6px);height:2px;opacity:0;transform:scaleX(0) rotate(0deg);border-radius:2px}.cdk-high-contrast-active .mat-checkbox-mixedmark{height:0;border-top:solid 2px;margin-top:2px}.mat-checkbox-label-before .mat-checkbox-inner-container{order:1;margin-left:8px;margin-right:auto}[dir=rtl] .mat-checkbox-label-before .mat-checkbox-inner-container{margin-left:auto;margin-right:8px}.mat-checkbox-checked .mat-checkbox-checkmark{opacity:1}.mat-checkbox-checked .mat-checkbox-checkmark-path{stroke-dashoffset:0}.mat-checkbox-checked .mat-checkbox-mixedmark{transform:scaleX(1) rotate(-45deg)}.mat-checkbox-indeterminate .mat-checkbox-checkmark{opacity:0;transform:rotate(45deg)}.mat-checkbox-indeterminate .mat-checkbox-checkmark-path{stroke-dashoffset:0}.mat-checkbox-indeterminate .mat-checkbox-mixedmark{opacity:1;transform:scaleX(1) rotate(0deg)}.mat-checkbox-unchecked .mat-checkbox-background{background-color:transparent}.mat-checkbox-disabled{cursor:default}.cdk-high-contrast-active .mat-checkbox-disabled{opacity:.5}.mat-checkbox-anim-unchecked-checked .mat-checkbox-background{animation:180ms linear 0ms mat-checkbox-fade-in-background}.mat-checkbox-anim-unchecked-checked .mat-checkbox-checkmark-path{animation:180ms linear 0ms mat-checkbox-unchecked-checked-checkmark-path}.mat-checkbox-anim-unchecked-indeterminate .mat-checkbox-background{animation:180ms linear 0ms mat-checkbox-fade-in-background}.mat-checkbox-anim-unchecked-indeterminate .mat-checkbox-mixedmark{animation:90ms linear 0ms mat-checkbox-unchecked-indeterminate-mixedmark}.mat-checkbox-anim-checked-unchecked .mat-checkbox-background{animation:180ms linear 0ms mat-checkbox-fade-out-background}.mat-checkbox-anim-checked-unchecked .mat-checkbox-checkmark-path{animation:90ms linear 0ms mat-checkbox-checked-unchecked-checkmark-path}.mat-checkbox-anim-checked-indeterminate .mat-checkbox-checkmark{animation:90ms linear 0ms mat-checkbox-checked-indeterminate-checkmark}.mat-checkbox-anim-checked-indeterminate .mat-checkbox-mixedmark{animation:90ms linear 0ms mat-checkbox-checked-indeterminate-mixedmark}.mat-checkbox-anim-indeterminate-checked .mat-checkbox-checkmark{animation:500ms linear 0ms mat-checkbox-indeterminate-checked-checkmark}.mat-checkbox-anim-indeterminate-checked .mat-checkbox-mixedmark{animation:500ms linear 0ms mat-checkbox-indeterminate-checked-mixedmark}.mat-checkbox-anim-indeterminate-unchecked .mat-checkbox-background{animation:180ms linear 0ms mat-checkbox-fade-out-background}.mat-checkbox-anim-indeterminate-unchecked .mat-checkbox-mixedmark{animation:300ms linear 0ms mat-checkbox-indeterminate-unchecked-mixedmark}.mat-checkbox-input{bottom:0;left:50%}\n"],encapsulation:2,changeDetection:0}),i})(),NK=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({}),i})(),HK=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[zf,jn,H1,NK],jn,NK]}),i})();function OMe(i,t){if(1&i){const e=Wi();Z(0,"mat-checkbox",4),je("change",function(r){return gt(e),Re().onCheckboxChange(r)}),ue(1),J()}if(2&i){const e=t.$implicit,n=Re();fe("value",e[0])("checked",n.isChecked(e)),se(1),Xt(e[1])}}let FMe=(()=>{class i{constructor(e){this.categories=[],e.configAsObservable.subscribe(n=>{this.categories.length=0,n.get("query.text.categories").forEach(r=>{this.categories.push(r)})})}get inputValue(){return this.textTerm.data}set inputValue(e){this.textTerm.data=e}onCheckboxChange(e){e.checked?this.textTerm.pushCategory(e.source.value):this.textTerm.removeCategory(e.source.value)}isChecked(e){return this.textTerm.categories.indexOf(e[0])>-1}}return i.\u0275fac=function(e){return new(e||i)(B(dr))},i.\u0275cmp=ei({type:i,selectors:[["app-qt-text"]],inputs:{textTerm:"textTerm"},decls:8,vars:10,consts:[[1,"options"],[3,"value","checked","change",4,"ngFor","ngForOf"],[1,"textinput"],["matInput","","type","text","placeholder","Search text",3,"ngModel","ngModelChange"],[3,"value","checked","change"]],template:function(e,n){1&e&&(Z(0,"div")(1,"h5"),ue(2,"Categories:"),J(),Z(3,"section",0),Ue(4,OMe,2,3,"mat-checkbox",1),J(),yt(5,"br"),Z(6,"mat-form-field",2)(7,"input",3),je("ngModelChange",function(s){return n.inputValue=s}),J()()()),2&e&&(A("padding-left","10px")("text-align","left"),se(1),A("margin-bottom","1em")("margin-top","0"),se(3),fe("ngForOf",n.categories),se(3),fe("ngModel",n.inputValue))},directives:[mo,b4,og,Ty,Bf,ah,lh],styles:[".options[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap}.options[_ngcontent-%COMP%]   mat-checkbox[_ngcontent-%COMP%]{margin-right:10px}.textinput[_ngcontent-%COMP%]{width:90%}"]}),i})();const BMe=["panel"];function NMe(i,t){if(1&i&&(Z(0,"div",0,1),hr(2),J()),2&i){const e=t.id,n=Re();fe("id",n.id)("ngClass",n._classList),Vi("aria-label",n.ariaLabel||null)("aria-labelledby",n._getPanelAriaLabelledby(e))}}const HMe=["*"];let VMe=0;class zMe{constructor(t,e){this.source=t,this.option=e}}const UMe=uh(class{}),VK=new gi("mat-autocomplete-default-options",{providedIn:"root",factory:function GMe(){return{autoActiveFirstOption:!1}}});let WMe=(()=>{class i extends UMe{constructor(e,n,r,s){super(),this._changeDetectorRef=e,this._elementRef=n,this._activeOptionChanges=Q.EMPTY,this.showPanel=!1,this._isOpen=!1,this.displayWith=null,this.optionSelected=new Si,this.opened=new Si,this.closed=new Si,this.optionActivated=new Si,this._classList={},this.id="mat-autocomplete-"+VMe++,this.inertGroups=(null==s?void 0:s.SAFARI)||!1,this._autoActiveFirstOption=!!r.autoActiveFirstOption}get isOpen(){return this._isOpen&&this.showPanel}get autoActiveFirstOption(){return this._autoActiveFirstOption}set autoActiveFirstOption(e){this._autoActiveFirstOption=tn(e)}set classList(e){this._classList=e&&e.length?function ple(i,t=/\s+/){const e=[];if(null!=i){const n=Array.isArray(i)?i:`${i}`.split(t);for(const r of n){const s=`${r}`.trim();s&&e.push(s)}}return e}(e).reduce((n,r)=>(n[r]=!0,n),{}):{},this._setVisibilityClasses(this._classList),this._elementRef.nativeElement.className=""}ngAfterContentInit(){this._keyManager=new a7(this.options).withWrap(),this._activeOptionChanges=this._keyManager.change.subscribe(e=>{this.isOpen&&this.optionActivated.emit({source:this,option:this.options.toArray()[e]||null})}),this._setVisibility()}ngOnDestroy(){this._activeOptionChanges.unsubscribe()}_setScrollTop(e){this.panel&&(this.panel.nativeElement.scrollTop=e)}_getScrollTop(){return this.panel?this.panel.nativeElement.scrollTop:0}_setVisibility(){this.showPanel=!!this.options.length,this._setVisibilityClasses(this._classList),this._changeDetectorRef.markForCheck()}_emitSelectEvent(e){const n=new zMe(this,e);this.optionSelected.emit(n)}_getPanelAriaLabelledby(e){return this.ariaLabel?null:this.ariaLabelledby?(e?e+" ":"")+this.ariaLabelledby:e}_setVisibilityClasses(e){e[this._visibleClass]=this.showPanel,e[this._hiddenClass]=!this.showPanel}}return i.\u0275fac=function(e){return new(e||i)(B(Pn),B(ai),B(VK),B(ta))},i.\u0275dir=Be({type:i,viewQuery:function(e,n){if(1&e&&(ji(Xo,7),ji(BMe,5)),2&e){let r;jt(r=qt())&&(n.template=r.first),jt(r=qt())&&(n.panel=r.first)}},inputs:{ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],displayWith:"displayWith",autoActiveFirstOption:"autoActiveFirstOption",panelWidth:"panelWidth",classList:["class","classList"]},outputs:{optionSelected:"optionSelected",opened:"opened",closed:"closed",optionActivated:"optionActivated"},features:[It]}),i})(),zK=(()=>{class i extends WMe{constructor(){super(...arguments),this._visibleClass="mat-autocomplete-visible",this._hiddenClass="mat-autocomplete-hidden"}}return i.\u0275fac=function(){let t;return function(n){return(t||(t=Ki(i)))(n||i)}}(),i.\u0275cmp=ei({type:i,selectors:[["mat-autocomplete"]],contentQueries:function(e,n,r){if(1&e&&(Er(r,lN,5),Er(r,Vb,5)),2&e){let s;jt(s=qt())&&(n.optionGroups=s),jt(s=qt())&&(n.options=s)}},hostAttrs:[1,"mat-autocomplete"],inputs:{disableRipple:"disableRipple"},exportAs:["matAutocomplete"],features:[Sn([{provide:aN,useExisting:i}]),It],ngContentSelectors:HMe,decls:1,vars:0,consts:[["role","listbox",1,"mat-autocomplete-panel",3,"id","ngClass"],["panel",""]],template:function(e,n){1&e&&(As(),Ue(0,NMe,3,4,"ng-template"))},directives:[Cp],styles:[".mat-autocomplete-panel{min-width:112px;max-width:280px;overflow:auto;-webkit-overflow-scrolling:touch;visibility:hidden;max-width:none;max-height:256px;position:relative;width:100%;border-bottom-left-radius:4px;border-bottom-right-radius:4px}.mat-autocomplete-panel.mat-autocomplete-visible{visibility:visible}.mat-autocomplete-panel.mat-autocomplete-hidden{visibility:hidden}.mat-autocomplete-panel-above .mat-autocomplete-panel{border-radius:0;border-top-left-radius:4px;border-top-right-radius:4px}.mat-autocomplete-panel .mat-divider-horizontal{margin-top:-1px}.cdk-high-contrast-active .mat-autocomplete-panel{outline:solid 1px}mat-autocomplete{display:none}\n"],encapsulation:2,changeDetection:0}),i})();const UK=new gi("mat-autocomplete-scroll-strategy"),qMe={provide:UK,deps:[Du],useFactory:function jMe(i){return()=>i.scrollStrategies.reposition()}},XMe={provide:Ac,useExisting:rs(()=>x4),multi:!0};let ZMe=(()=>{class i{constructor(e,n,r,s,a,l,u,h,m,_,v){this._element=e,this._overlay=n,this._viewContainerRef=r,this._zone=s,this._changeDetectorRef=a,this._dir=u,this._formField=h,this._document=m,this._viewportRuler=_,this._defaults=v,this._componentDestroyed=!1,this._autocompleteDisabled=!1,this._manuallyFloatingLabel=!1,this._viewportSubscription=Q.EMPTY,this._canOpenOnNextFocus=!0,this._closeKeyEventStream=new ii,this._windowBlurHandler=()=>{this._canOpenOnNextFocus=this._document.activeElement!==this._element.nativeElement||this.panelOpen},this._onChange=()=>{},this._onTouched=()=>{},this.position="auto",this.autocompleteAttribute="off",this._overlayAttached=!1,this.optionSelections=hT(()=>{const S=this.autocomplete?this.autocomplete.options:null;return S?S.changes.pipe(Tl(S),dh(()=>uo(...S.map(T=>T.onSelectionChange)))):this._zone.onStable.pipe(Qr(1),dh(()=>this.optionSelections))}),this._scrollStrategy=l}get autocompleteDisabled(){return this._autocompleteDisabled}set autocompleteDisabled(e){this._autocompleteDisabled=tn(e)}ngAfterViewInit(){const e=this._getWindow();void 0!==e&&this._zone.runOutsideAngular(()=>e.addEventListener("blur",this._windowBlurHandler))}ngOnChanges(e){e.position&&this._positionStrategy&&(this._setStrategyPositions(this._positionStrategy),this.panelOpen&&this._overlayRef.updatePosition())}ngOnDestroy(){const e=this._getWindow();void 0!==e&&e.removeEventListener("blur",this._windowBlurHandler),this._viewportSubscription.unsubscribe(),this._componentDestroyed=!0,this._destroyPanel(),this._closeKeyEventStream.complete()}get panelOpen(){return this._overlayAttached&&this.autocomplete.showPanel}openPanel(){this._attachOverlay(),this._floatLabel()}closePanel(){this._resetLabel(),this._overlayAttached&&(this.panelOpen&&this.autocomplete.closed.emit(),this.autocomplete._isOpen=this._overlayAttached=!1,this._overlayRef&&this._overlayRef.hasAttached()&&(this._overlayRef.detach(),this._closingActionsSubscription.unsubscribe()),this._componentDestroyed||this._changeDetectorRef.detectChanges())}updatePosition(){this._overlayAttached&&this._overlayRef.updatePosition()}get panelClosingActions(){return uo(this.optionSelections,this.autocomplete._keyManager.tabOut.pipe(vr(()=>this._overlayAttached)),this._closeKeyEventStream,this._getOutsideClickStream(),this._overlayRef?this._overlayRef.detachments().pipe(vr(()=>this._overlayAttached)):Qn()).pipe(Ui(e=>e instanceof C7?e:null))}get activeOption(){return this.autocomplete&&this.autocomplete._keyManager?this.autocomplete._keyManager.activeItem:null}_getOutsideClickStream(){return uo(os(this._document,"click"),os(this._document,"auxclick"),os(this._document,"touchend")).pipe(vr(e=>{const n=cy(e),r=this._formField?this._formField._elementRef.nativeElement:null,s=this.connectedTo?this.connectedTo.elementRef.nativeElement:null;return this._overlayAttached&&n!==this._element.nativeElement&&this._document.activeElement!==this._element.nativeElement&&(!r||!r.contains(n))&&(!s||!s.contains(n))&&!!this._overlayRef&&!this._overlayRef.overlayElement.contains(n)}))}writeValue(e){Promise.resolve().then(()=>this._setTriggerValue(e))}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this._element.nativeElement.disabled=e}_handleKeydown(e){const n=e.keyCode,r=dc(e);if(27===n&&!r&&e.preventDefault(),this.activeOption&&13===n&&this.panelOpen&&!r)this.activeOption._selectViaInteraction(),this._resetActiveItem(),e.preventDefault();else if(this.autocomplete){const s=this.autocomplete._keyManager.activeItem,a=38===n||40===n;9===n||a&&!r&&this.panelOpen?this.autocomplete._keyManager.onKeydown(e):a&&this._canOpen()&&this.openPanel(),(a||this.autocomplete._keyManager.activeItem!==s)&&this._scrollToOption(this.autocomplete._keyManager.activeItemIndex||0)}}_handleInput(e){let n=e.target,r=n.value;"number"===n.type&&(r=""==r?null:parseFloat(r)),this._previousValue!==r&&(this._previousValue=r,this._onChange(r),this._canOpen()&&this._document.activeElement===e.target&&this.openPanel())}_handleFocus(){this._canOpenOnNextFocus?this._canOpen()&&(this._previousValue=this._element.nativeElement.value,this._attachOverlay(),this._floatLabel(!0)):this._canOpenOnNextFocus=!0}_handleClick(){this._canOpen()&&!this.panelOpen&&this.openPanel()}_floatLabel(e=!1){this._formField&&"auto"===this._formField.floatLabel&&(e?this._formField._animateAndLockLabel():this._formField.floatLabel="always",this._manuallyFloatingLabel=!0)}_resetLabel(){this._manuallyFloatingLabel&&(this._formField.floatLabel="auto",this._manuallyFloatingLabel=!1)}_subscribeToClosingActions(){return uo(this._zone.onStable.pipe(Qr(1)),this.autocomplete.options.changes.pipe(Po(()=>this._positionStrategy.reapplyLastPosition()),XH(0))).pipe(dh(()=>(this._zone.run(()=>{const r=this.panelOpen;this._resetActiveItem(),this.autocomplete._setVisibility(),this._changeDetectorRef.detectChanges(),this.panelOpen&&(this._overlayRef.updatePosition(),r!==this.panelOpen&&this.autocomplete.opened.emit())}),this.panelClosingActions)),Qr(1)).subscribe(r=>this._setValueAndClose(r))}_destroyPanel(){this._overlayRef&&(this.closePanel(),this._overlayRef.dispose(),this._overlayRef=null)}_setTriggerValue(e){const n=this.autocomplete&&this.autocomplete.displayWith?this.autocomplete.displayWith(e):e,r=null!=n?n:"";this._formField?this._formField._control.value=r:this._element.nativeElement.value=r,this._previousValue=r}_setValueAndClose(e){const n=e&&e.source;n&&(this._clearPreviousSelectedOption(n),this._setTriggerValue(n.value),this._onChange(n.value),this.autocomplete._emitSelectEvent(n),this._element.nativeElement.focus()),this.closePanel()}_clearPreviousSelectedOption(e){this.autocomplete.options.forEach(n=>{n!==e&&n.selected&&n.deselect()})}_attachOverlay(){var e;let n=this._overlayRef;n?(this._positionStrategy.setOrigin(this._getConnectedElement()),n.updateSize({width:this._getPanelWidth()})):(this._portal=new Ep(this.autocomplete.template,this._viewContainerRef,{id:null===(e=this._formField)||void 0===e?void 0:e.getLabelId()}),n=this._overlay.create(this._getOverlayConfig()),this._overlayRef=n,n.keydownEvents().subscribe(s=>{(27===s.keyCode&&!dc(s)||38===s.keyCode&&dc(s,"altKey"))&&(this._closeKeyEventStream.next(),this._resetActiveItem(),s.stopPropagation(),s.preventDefault())}),this._viewportSubscription=this._viewportRuler.change().subscribe(()=>{this.panelOpen&&n&&n.updateSize({width:this._getPanelWidth()})})),n&&!n.hasAttached()&&(n.attach(this._portal),this._closingActionsSubscription=this._subscribeToClosingActions());const r=this.panelOpen;this.autocomplete._setVisibility(),this.autocomplete._isOpen=this._overlayAttached=!0,this.panelOpen&&r!==this.panelOpen&&this.autocomplete.opened.emit()}_getOverlayConfig(){var e;return new Fb({positionStrategy:this._getOverlayPosition(),scrollStrategy:this._scrollStrategy(),width:this._getPanelWidth(),direction:this._dir,panelClass:null===(e=this._defaults)||void 0===e?void 0:e.overlayPanelClass})}_getOverlayPosition(){const e=this._overlay.position().flexibleConnectedTo(this._getConnectedElement()).withFlexibleDimensions(!1).withPush(!1);return this._setStrategyPositions(e),this._positionStrategy=e,e}_setStrategyPositions(e){const n=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],r=this._aboveClass,s=[{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom",panelClass:r},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom",panelClass:r}];let a;a="above"===this.position?s:"below"===this.position?n:[...n,...s],e.withPositions(a)}_getConnectedElement(){return this.connectedTo?this.connectedTo.elementRef:this._formField?this._formField.getConnectedOverlayOrigin():this._element}_getPanelWidth(){return this.autocomplete.panelWidth||this._getHostWidth()}_getHostWidth(){return this._getConnectedElement().nativeElement.getBoundingClientRect().width}_resetActiveItem(){const e=this.autocomplete;e.autoActiveFirstOption?e._keyManager.setFirstItemActive():e._keyManager.setActiveItem(-1)}_canOpen(){const e=this._element.nativeElement;return!e.readOnly&&!e.disabled&&!this._autocompleteDisabled}_getWindow(){var e;return(null===(e=this._document)||void 0===e?void 0:e.defaultView)||window}_scrollToOption(e){const n=this.autocomplete,r=cN(e,n.options,n.optionGroups);if(0===e&&1===r)n._setScrollTop(0);else if(n.panel){const s=n.options.toArray()[e];if(s){const a=s._getHostElement(),l=M7(a.offsetTop,a.offsetHeight,n._getScrollTop(),n.panel.nativeElement.offsetHeight);n._setScrollTop(l)}}}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(Du),B(Ko),B(Rn),B(Pn),B(UK),B(Ia,8),B(AP,9),B(ar,8),B(Tp),B(VK,8))},i.\u0275dir=Be({type:i,inputs:{autocomplete:["matAutocomplete","autocomplete"],position:["matAutocompletePosition","position"],connectedTo:["matAutocompleteConnectedTo","connectedTo"],autocompleteAttribute:["autocomplete","autocompleteAttribute"],autocompleteDisabled:["matAutocompleteDisabled","autocompleteDisabled"]},features:[Ls]}),i})(),x4=(()=>{class i extends ZMe{constructor(){super(...arguments),this._aboveClass="mat-autocomplete-panel-above"}}return i.\u0275fac=function(){let t;return function(n){return(t||(t=Ki(i)))(n||i)}}(),i.\u0275dir=Be({type:i,selectors:[["input","matAutocomplete",""],["textarea","matAutocomplete",""]],hostAttrs:[1,"mat-autocomplete-trigger"],hostVars:7,hostBindings:function(e,n){1&e&&je("focusin",function(){return n._handleFocus()})("blur",function(){return n._onTouched()})("input",function(s){return n._handleInput(s)})("keydown",function(s){return n._handleKeydown(s)})("click",function(){return n._handleClick()}),2&e&&Vi("autocomplete",n.autocompleteAttribute)("role",n.autocompleteDisabled?null:"combobox")("aria-autocomplete",n.autocompleteDisabled?null:"list")("aria-activedescendant",n.panelOpen&&n.activeOption?n.activeOption.id:null)("aria-expanded",n.autocompleteDisabled?null:n.panelOpen.toString())("aria-owns",n.autocompleteDisabled||!n.panelOpen||null==n.autocomplete?null:n.autocomplete.id)("aria-haspopup",n.autocompleteDisabled?null:"listbox")},exportAs:["matAutocompleteTrigger"],features:[Sn([XMe]),It]}),i})(),GK=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({providers:[qMe],imports:[[Nb,Dk,jn,ka],uy,Dk,jn]}),i})();const YMe=["*"],WK=new gi("MatChipRemove"),jK=new gi("MatChipAvatar"),qK=new gi("MatChipTrailingIcon");class KMe{constructor(t){this._elementRef=t}}const QMe=Ww(Vf(uh(KMe),"primary"),-1);let pI=(()=>{class i extends QMe{constructor(e,n,r,s,a,l,u,h){super(e),this._ngZone=n,this._changeDetectorRef=a,this._hasFocus=!1,this.chipListSelectable=!0,this._chipListMultiple=!1,this._chipListDisabled=!1,this._selected=!1,this._selectable=!0,this._disabled=!1,this._removable=!0,this._onFocus=new ii,this._onBlur=new ii,this.selectionChange=new Si,this.destroyed=new Si,this.removed=new Si,this._addHostClassName(),this._chipRippleTarget=l.createElement("div"),this._chipRippleTarget.classList.add("mat-chip-ripple"),this._elementRef.nativeElement.appendChild(this._chipRippleTarget),this._chipRipple=new x7(this,n,this._chipRippleTarget,r),this._chipRipple.setupTriggerEvents(e),this.rippleConfig=s||{},this._animationsDisabled="NoopAnimations"===u,this.tabIndex=null!=h&&parseInt(h)||-1}get rippleDisabled(){return this.disabled||this.disableRipple||this._animationsDisabled||!!this.rippleConfig.disabled}get selected(){return this._selected}set selected(e){const n=tn(e);n!==this._selected&&(this._selected=n,this._dispatchSelectionChange())}get value(){return void 0!==this._value?this._value:this._elementRef.nativeElement.textContent}set value(e){this._value=e}get selectable(){return this._selectable&&this.chipListSelectable}set selectable(e){this._selectable=tn(e)}get disabled(){return this._chipListDisabled||this._disabled}set disabled(e){this._disabled=tn(e)}get removable(){return this._removable}set removable(e){this._removable=tn(e)}get ariaSelected(){return this.selectable&&(this._chipListMultiple||this.selected)?this.selected.toString():null}_addHostClassName(){const e="mat-basic-chip",n=this._elementRef.nativeElement;n.hasAttribute(e)||n.tagName.toLowerCase()===e?n.classList.add(e):n.classList.add("mat-standard-chip")}ngOnDestroy(){this.destroyed.emit({chip:this}),this._chipRipple._removeTriggerEvents()}select(){this._selected||(this._selected=!0,this._dispatchSelectionChange(),this._changeDetectorRef.markForCheck())}deselect(){this._selected&&(this._selected=!1,this._dispatchSelectionChange(),this._changeDetectorRef.markForCheck())}selectViaInteraction(){this._selected||(this._selected=!0,this._dispatchSelectionChange(!0),this._changeDetectorRef.markForCheck())}toggleSelected(e=!1){return this._selected=!this.selected,this._dispatchSelectionChange(e),this._changeDetectorRef.markForCheck(),this.selected}focus(){this._hasFocus||(this._elementRef.nativeElement.focus(),this._onFocus.next({chip:this})),this._hasFocus=!0}remove(){this.removable&&this.removed.emit({chip:this})}_handleClick(e){this.disabled&&e.preventDefault()}_handleKeydown(e){if(!this.disabled)switch(e.keyCode){case 46:case 8:this.remove(),e.preventDefault();break;case 32:this.selectable&&this.toggleSelected(!0),e.preventDefault()}}_blur(){this._ngZone.onStable.pipe(Qr(1)).subscribe(()=>{this._ngZone.run(()=>{this._hasFocus=!1,this._onBlur.next({chip:this})})})}_dispatchSelectionChange(e=!1){this.selectionChange.emit({source:this,isUserInput:e,selected:this._selected})}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(Rn),B(ta),B(w7,8),B(Pn),B(ar),B(ga,8),zc("tabindex"))},i.\u0275dir=Be({type:i,selectors:[["mat-basic-chip"],["","mat-basic-chip",""],["mat-chip"],["","mat-chip",""]],contentQueries:function(e,n,r){if(1&e&&(Er(r,jK,5),Er(r,qK,5),Er(r,WK,5)),2&e){let s;jt(s=qt())&&(n.avatar=s.first),jt(s=qt())&&(n.trailingIcon=s.first),jt(s=qt())&&(n.removeIcon=s.first)}},hostAttrs:["role","option",1,"mat-chip","mat-focus-indicator"],hostVars:14,hostBindings:function(e,n){1&e&&je("click",function(s){return n._handleClick(s)})("keydown",function(s){return n._handleKeydown(s)})("focus",function(){return n.focus()})("blur",function(){return n._blur()}),2&e&&(Vi("tabindex",n.disabled?null:n.tabIndex)("disabled",n.disabled||null)("aria-disabled",n.disabled.toString())("aria-selected",n.ariaSelected),N("mat-chip-selected",n.selected)("mat-chip-with-avatar",n.avatar)("mat-chip-with-trailing-icon",n.trailingIcon||n.removeIcon)("mat-chip-disabled",n.disabled)("_mat-animation-noopable",n._animationsDisabled))},inputs:{color:"color",disableRipple:"disableRipple",tabIndex:"tabIndex",selected:"selected",value:"value",selectable:"selectable",disabled:"disabled",removable:"removable"},outputs:{selectionChange:"selectionChange",destroyed:"destroyed",removed:"removed"},exportAs:["matChip"],features:[It]}),i})(),XK=(()=>{class i{constructor(e,n){this._parentChip=e,"BUTTON"===n.nativeElement.nodeName&&n.nativeElement.setAttribute("type","button")}_handleClick(e){const n=this._parentChip;n.removable&&!n.disabled&&n.remove(),e.stopPropagation()}}return i.\u0275fac=function(e){return new(e||i)(B(pI),B(ai))},i.\u0275dir=Be({type:i,selectors:[["","matChipRemove",""]],hostAttrs:[1,"mat-chip-remove","mat-chip-trailing-icon"],hostBindings:function(e,n){1&e&&je("click",function(s){return n._handleClick(s)})},features:[Sn([{provide:WK,useExisting:i}])]}),i})();const ZK=new gi("mat-chips-default-options"),i1e=rN(class{constructor(i,t,e,n){this._defaultErrorStateMatcher=i,this._parentForm=t,this._parentFormGroup=e,this.ngControl=n}});let n1e=0;class r1e{constructor(t,e){this.source=t,this.value=e}}let YK=(()=>{class i extends i1e{constructor(e,n,r,s,a,l,u){super(l,s,a,u),this._elementRef=e,this._changeDetectorRef=n,this._dir=r,this.controlType="mat-chip-list",this._lastDestroyedChipIndex=null,this._destroyed=new ii,this._uid="mat-chip-list-"+n1e++,this._tabIndex=0,this._userTabIndex=null,this._onTouched=()=>{},this._onChange=()=>{},this._multiple=!1,this._compareWith=(h,m)=>h===m,this._disabled=!1,this.ariaOrientation="horizontal",this._selectable=!0,this.change=new Si,this.valueChange=new Si,this.ngControl&&(this.ngControl.valueAccessor=this)}get selected(){var e,n;return this.multiple?(null===(e=this._selectionModel)||void 0===e?void 0:e.selected)||[]:null===(n=this._selectionModel)||void 0===n?void 0:n.selected[0]}get role(){return this.empty?null:"listbox"}get multiple(){return this._multiple}set multiple(e){this._multiple=tn(e),this._syncChipsState()}get compareWith(){return this._compareWith}set compareWith(e){this._compareWith=e,this._selectionModel&&this._initializeSelection()}get value(){return this._value}set value(e){this.writeValue(e),this._value=e}get id(){return this._chipInput?this._chipInput.id:this._uid}get required(){var e,n,r,s;return null!==(s=null!==(e=this._required)&&void 0!==e?e:null===(r=null===(n=this.ngControl)||void 0===n?void 0:n.control)||void 0===r?void 0:r.hasValidator(j3.required))&&void 0!==s&&s}set required(e){this._required=tn(e),this.stateChanges.next()}get placeholder(){return this._chipInput?this._chipInput.placeholder:this._placeholder}set placeholder(e){this._placeholder=e,this.stateChanges.next()}get focused(){return this._chipInput&&this._chipInput.focused||this._hasFocusedChip()}get empty(){return(!this._chipInput||this._chipInput.empty)&&(!this.chips||0===this.chips.length)}get shouldLabelFloat(){return!this.empty||this.focused}get disabled(){return this.ngControl?!!this.ngControl.disabled:this._disabled}set disabled(e){this._disabled=tn(e),this._syncChipsState()}get selectable(){return this._selectable}set selectable(e){this._selectable=tn(e),this.chips&&this.chips.forEach(n=>n.chipListSelectable=this._selectable)}set tabIndex(e){this._userTabIndex=e,this._tabIndex=e}get chipSelectionChanges(){return uo(...this.chips.map(e=>e.selectionChange))}get chipFocusChanges(){return uo(...this.chips.map(e=>e._onFocus))}get chipBlurChanges(){return uo(...this.chips.map(e=>e._onBlur))}get chipRemoveChanges(){return uo(...this.chips.map(e=>e.destroyed))}ngAfterContentInit(){this._keyManager=new Mk(this.chips).withWrap().withVerticalOrientation().withHomeAndEnd().withHorizontalOrientation(this._dir?this._dir.value:"ltr"),this._dir&&this._dir.change.pipe($n(this._destroyed)).subscribe(e=>this._keyManager.withHorizontalOrientation(e)),this._keyManager.tabOut.pipe($n(this._destroyed)).subscribe(()=>{this._allowFocusEscape()}),this.chips.changes.pipe(Tl(null),$n(this._destroyed)).subscribe(()=>{this.disabled&&Promise.resolve().then(()=>{this._syncChipsState()}),this._resetChips(),this._initializeSelection(),this._updateTabIndex(),this._updateFocusForDestroyedChips(),this.stateChanges.next()})}ngOnInit(){this._selectionModel=new cT(this.multiple,void 0,!1),this.stateChanges.next()}ngDoCheck(){this.ngControl&&(this.updateErrorState(),this.ngControl.disabled!==this._disabled&&(this.disabled=!!this.ngControl.disabled))}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete(),this.stateChanges.complete(),this._dropSubscriptions()}registerInput(e){this._chipInput=e,this._elementRef.nativeElement.setAttribute("data-mat-chip-input",e.id)}setDescribedByIds(e){this._ariaDescribedby=e.join(" ")}writeValue(e){this.chips&&this._setSelectionByValue(e,!1)}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this.disabled=e,this.stateChanges.next()}onContainerClick(e){this._originatesFromChip(e)||this.focus()}focus(e){this.disabled||this._chipInput&&this._chipInput.focused||(this.chips.length>0?(this._keyManager.setFirstItemActive(),this.stateChanges.next()):(this._focusInput(e),this.stateChanges.next()))}_focusInput(e){this._chipInput&&this._chipInput.focus(e)}_keydown(e){const n=e.target;n&&n.classList.contains("mat-chip")&&(this._keyManager.onKeydown(e),this.stateChanges.next())}_updateTabIndex(){this._tabIndex=this._userTabIndex||(0===this.chips.length?-1:0)}_updateFocusForDestroyedChips(){if(null!=this._lastDestroyedChipIndex)if(this.chips.length){const e=Math.min(this._lastDestroyedChipIndex,this.chips.length-1);this._keyManager.setActiveItem(e)}else this.focus();this._lastDestroyedChipIndex=null}_isValidIndex(e){return e>=0&&e<this.chips.length}_setSelectionByValue(e,n=!0){if(this._clearSelection(),this.chips.forEach(r=>r.deselect()),Array.isArray(e))e.forEach(r=>this._selectValue(r,n)),this._sortValues();else{const r=this._selectValue(e,n);r&&n&&this._keyManager.setActiveItem(r)}}_selectValue(e,n=!0){const r=this.chips.find(s=>null!=s.value&&this._compareWith(s.value,e));return r&&(n?r.selectViaInteraction():r.select(),this._selectionModel.select(r)),r}_initializeSelection(){Promise.resolve().then(()=>{(this.ngControl||this._value)&&(this._setSelectionByValue(this.ngControl?this.ngControl.value:this._value,!1),this.stateChanges.next())})}_clearSelection(e){this._selectionModel.clear(),this.chips.forEach(n=>{n!==e&&n.deselect()}),this.stateChanges.next()}_sortValues(){this._multiple&&(this._selectionModel.clear(),this.chips.forEach(e=>{e.selected&&this._selectionModel.select(e)}),this.stateChanges.next())}_propagateChanges(e){let n=null;n=Array.isArray(this.selected)?this.selected.map(r=>r.value):this.selected?this.selected.value:e,this._value=n,this.change.emit(new r1e(this,n)),this.valueChange.emit(n),this._onChange(n),this._changeDetectorRef.markForCheck()}_blur(){this._hasFocusedChip()||this._keyManager.setActiveItem(-1),this.disabled||(this._chipInput?setTimeout(()=>{this.focused||this._markAsTouched()}):this._markAsTouched())}_markAsTouched(){this._onTouched(),this._changeDetectorRef.markForCheck(),this.stateChanges.next()}_allowFocusEscape(){-1!==this._tabIndex&&(this._tabIndex=-1,setTimeout(()=>{this._tabIndex=this._userTabIndex||0,this._changeDetectorRef.markForCheck()}))}_resetChips(){this._dropSubscriptions(),this._listenToChipsFocus(),this._listenToChipsSelection(),this._listenToChipsRemoved()}_dropSubscriptions(){this._chipFocusSubscription&&(this._chipFocusSubscription.unsubscribe(),this._chipFocusSubscription=null),this._chipBlurSubscription&&(this._chipBlurSubscription.unsubscribe(),this._chipBlurSubscription=null),this._chipSelectionSubscription&&(this._chipSelectionSubscription.unsubscribe(),this._chipSelectionSubscription=null),this._chipRemoveSubscription&&(this._chipRemoveSubscription.unsubscribe(),this._chipRemoveSubscription=null)}_listenToChipsSelection(){this._chipSelectionSubscription=this.chipSelectionChanges.subscribe(e=>{e.source.selected?this._selectionModel.select(e.source):this._selectionModel.deselect(e.source),this.multiple||this.chips.forEach(n=>{!this._selectionModel.isSelected(n)&&n.selected&&n.deselect()}),e.isUserInput&&this._propagateChanges()})}_listenToChipsFocus(){this._chipFocusSubscription=this.chipFocusChanges.subscribe(e=>{let n=this.chips.toArray().indexOf(e.chip);this._isValidIndex(n)&&this._keyManager.updateActiveItem(n),this.stateChanges.next()}),this._chipBlurSubscription=this.chipBlurChanges.subscribe(()=>{this._blur(),this.stateChanges.next()})}_listenToChipsRemoved(){this._chipRemoveSubscription=this.chipRemoveChanges.subscribe(e=>{const n=e.chip,r=this.chips.toArray().indexOf(e.chip);this._isValidIndex(r)&&n._hasFocus&&(this._lastDestroyedChipIndex=r)})}_originatesFromChip(e){let n=e.target;for(;n&&n!==this._elementRef.nativeElement;){if(n.classList.contains("mat-chip"))return!0;n=n.parentElement}return!1}_hasFocusedChip(){return this.chips&&this.chips.some(e=>e._hasFocus)}_syncChipsState(){this.chips&&this.chips.forEach(e=>{e._chipListDisabled=this._disabled,e._chipListMultiple=this.multiple})}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(Pn),B(Ia,8),B(Cb,8),B(Ow,8),B(z1),B(Nf,10))},i.\u0275cmp=ei({type:i,selectors:[["mat-chip-list"]],contentQueries:function(e,n,r){if(1&e&&Er(r,pI,5),2&e){let s;jt(s=qt())&&(n.chips=s)}},hostAttrs:[1,"mat-chip-list"],hostVars:15,hostBindings:function(e,n){1&e&&je("focus",function(){return n.focus()})("blur",function(){return n._blur()})("keydown",function(s){return n._keydown(s)}),2&e&&(dn("id",n._uid),Vi("tabindex",n.disabled?null:n._tabIndex)("aria-describedby",n._ariaDescribedby||null)("aria-required",n.role?n.required:null)("aria-disabled",n.disabled.toString())("aria-invalid",n.errorState)("aria-multiselectable",n.multiple)("role",n.role)("aria-orientation",n.ariaOrientation),N("mat-chip-list-disabled",n.disabled)("mat-chip-list-invalid",n.errorState)("mat-chip-list-required",n.required))},inputs:{errorStateMatcher:"errorStateMatcher",multiple:"multiple",compareWith:"compareWith",value:"value",required:"required",placeholder:"placeholder",disabled:"disabled",ariaOrientation:["aria-orientation","ariaOrientation"],selectable:"selectable",tabIndex:"tabIndex"},outputs:{change:"change",valueChange:"valueChange"},exportAs:["matChipList"],features:[Sn([{provide:ST,useExisting:i}]),It],ngContentSelectors:YMe,decls:2,vars:0,consts:[[1,"mat-chip-list-wrapper"]],template:function(e,n){1&e&&(As(),Z(0,"div",0),hr(1),J())},styles:['.mat-chip{position:relative;box-sizing:border-box;-webkit-tap-highlight-color:transparent;border:none;-webkit-appearance:none;-moz-appearance:none}.mat-standard-chip{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);display:inline-flex;padding:7px 12px;border-radius:16px;align-items:center;cursor:default;min-height:32px;height:1px}._mat-animation-noopable.mat-standard-chip{transition:none;animation:none}.mat-standard-chip .mat-chip-remove{border:none;-webkit-appearance:none;-moz-appearance:none;padding:0;background:none}.mat-standard-chip .mat-chip-remove.mat-icon,.mat-standard-chip .mat-chip-remove .mat-icon{width:18px;height:18px;font-size:18px}.mat-standard-chip::after{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:inherit;opacity:0;content:"";pointer-events:none;transition:opacity 200ms cubic-bezier(0.35, 0, 0.25, 1)}.mat-standard-chip:hover::after{opacity:.12}.mat-standard-chip:focus{outline:none}.mat-standard-chip:focus::after{opacity:.16}.cdk-high-contrast-active .mat-standard-chip{outline:solid 1px}.cdk-high-contrast-active .mat-standard-chip:focus{outline:dotted 2px}.cdk-high-contrast-active .mat-standard-chip.mat-chip-selected{outline-width:3px}.mat-standard-chip.mat-chip-disabled::after{opacity:0}.mat-standard-chip.mat-chip-disabled .mat-chip-remove,.mat-standard-chip.mat-chip-disabled .mat-chip-trailing-icon{cursor:default}.mat-standard-chip.mat-chip-with-trailing-icon.mat-chip-with-avatar,.mat-standard-chip.mat-chip-with-avatar{padding-top:0;padding-bottom:0}.mat-standard-chip.mat-chip-with-trailing-icon.mat-chip-with-avatar{padding-right:8px;padding-left:0}[dir=rtl] .mat-standard-chip.mat-chip-with-trailing-icon.mat-chip-with-avatar{padding-left:8px;padding-right:0}.mat-standard-chip.mat-chip-with-trailing-icon{padding-top:7px;padding-bottom:7px;padding-right:8px;padding-left:12px}[dir=rtl] .mat-standard-chip.mat-chip-with-trailing-icon{padding-left:8px;padding-right:12px}.mat-standard-chip.mat-chip-with-avatar{padding-left:0;padding-right:12px}[dir=rtl] .mat-standard-chip.mat-chip-with-avatar{padding-right:0;padding-left:12px}.mat-standard-chip .mat-chip-avatar{width:24px;height:24px;margin-right:8px;margin-left:4px}[dir=rtl] .mat-standard-chip .mat-chip-avatar{margin-left:8px;margin-right:4px}.mat-standard-chip .mat-chip-remove,.mat-standard-chip .mat-chip-trailing-icon{width:18px;height:18px;cursor:pointer}.mat-standard-chip .mat-chip-remove,.mat-standard-chip .mat-chip-trailing-icon{margin-left:8px;margin-right:0}[dir=rtl] .mat-standard-chip .mat-chip-remove,[dir=rtl] .mat-standard-chip .mat-chip-trailing-icon{margin-right:8px;margin-left:0}.mat-chip-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit;overflow:hidden;transform:translateZ(0)}.mat-chip-list-wrapper{display:flex;flex-direction:row;flex-wrap:wrap;align-items:center;margin:-4px}.mat-chip-list-wrapper input.mat-input-element,.mat-chip-list-wrapper .mat-standard-chip{margin:4px}.mat-chip-list-stacked .mat-chip-list-wrapper{flex-direction:column;align-items:flex-start}.mat-chip-list-stacked .mat-chip-list-wrapper .mat-standard-chip{width:100%}.mat-chip-avatar{border-radius:50%;justify-content:center;align-items:center;display:flex;overflow:hidden;object-fit:cover}input.mat-chip-input{width:150px;margin:4px;flex:1 0 150px}\n'],encapsulation:2,changeDetection:0}),i})(),KK=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({providers:[z1,{provide:ZK,useValue:{separatorKeyCodes:[13]}}],imports:[[jn]]}),i})();const s1e=["button"],o1e=["*"],QK=new gi("MAT_BUTTON_TOGGLE_DEFAULT_OPTIONS"),JK=new gi("MatButtonToggleGroup"),a1e={provide:Ac,useExisting:rs(()=>mI),multi:!0};let $K=0;class eQ{constructor(t,e){this.source=t,this.value=e}}let mI=(()=>{class i{constructor(e,n){this._changeDetector=e,this._vertical=!1,this._multiple=!1,this._disabled=!1,this._controlValueAccessorChangeFn=()=>{},this._onTouched=()=>{},this._name="mat-button-toggle-group-"+$K++,this.valueChange=new Si,this.change=new Si,this.appearance=n&&n.appearance?n.appearance:"standard"}get name(){return this._name}set name(e){this._name=e,this._buttonToggles&&this._buttonToggles.forEach(n=>{n.name=this._name,n._markForCheck()})}get vertical(){return this._vertical}set vertical(e){this._vertical=tn(e)}get value(){const e=this._selectionModel?this._selectionModel.selected:[];return this.multiple?e.map(n=>n.value):e[0]?e[0].value:void 0}set value(e){this._setSelectionByValue(e),this.valueChange.emit(this.value)}get selected(){const e=this._selectionModel?this._selectionModel.selected:[];return this.multiple?e:e[0]||null}get multiple(){return this._multiple}set multiple(e){this._multiple=tn(e)}get disabled(){return this._disabled}set disabled(e){this._disabled=tn(e),this._buttonToggles&&this._buttonToggles.forEach(n=>n._markForCheck())}ngOnInit(){this._selectionModel=new cT(this.multiple,void 0,!1)}ngAfterContentInit(){this._selectionModel.select(...this._buttonToggles.filter(e=>e.checked))}writeValue(e){this.value=e,this._changeDetector.markForCheck()}registerOnChange(e){this._controlValueAccessorChangeFn=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this.disabled=e}_emitChangeEvent(){const e=this.selected,n=Array.isArray(e)?e[e.length-1]:e,r=new eQ(n,this.value);this._controlValueAccessorChangeFn(r.value),this.change.emit(r)}_syncButtonToggle(e,n,r=!1,s=!1){!this.multiple&&this.selected&&!e.checked&&(this.selected.checked=!1),this._selectionModel?n?this._selectionModel.select(e):this._selectionModel.deselect(e):s=!0,s?Promise.resolve().then(()=>this._updateModelValue(r)):this._updateModelValue(r)}_isSelected(e){return this._selectionModel&&this._selectionModel.isSelected(e)}_isPrechecked(e){return void 0!==this._rawValue&&(this.multiple&&Array.isArray(this._rawValue)?this._rawValue.some(n=>null!=e.value&&n===e.value):e.value===this._rawValue)}_setSelectionByValue(e){this._rawValue=e,this._buttonToggles&&(this.multiple&&e?(Array.isArray(e),this._clearSelection(),e.forEach(n=>this._selectValue(n))):(this._clearSelection(),this._selectValue(e)))}_clearSelection(){this._selectionModel.clear(),this._buttonToggles.forEach(e=>e.checked=!1)}_selectValue(e){const n=this._buttonToggles.find(r=>null!=r.value&&r.value===e);n&&(n.checked=!0,this._selectionModel.select(n))}_updateModelValue(e){e&&this._emitChangeEvent(),this.valueChange.emit(this.value)}}return i.\u0275fac=function(e){return new(e||i)(B(Pn),B(QK,8))},i.\u0275dir=Be({type:i,selectors:[["mat-button-toggle-group"]],contentQueries:function(e,n,r){if(1&e&&Er(r,gI,5),2&e){let s;jt(s=qt())&&(n._buttonToggles=s)}},hostAttrs:["role","group",1,"mat-button-toggle-group"],hostVars:5,hostBindings:function(e,n){2&e&&(Vi("aria-disabled",n.disabled),N("mat-button-toggle-vertical",n.vertical)("mat-button-toggle-group-appearance-standard","standard"===n.appearance))},inputs:{appearance:"appearance",name:"name",vertical:"vertical",value:"value",multiple:"multiple",disabled:"disabled"},outputs:{valueChange:"valueChange",change:"change"},exportAs:["matButtonToggleGroup"],features:[Sn([a1e,{provide:JK,useExisting:i}])]}),i})();const l1e=uh(class{});let gI=(()=>{class i extends l1e{constructor(e,n,r,s,a,l){super(),this._changeDetectorRef=n,this._elementRef=r,this._focusMonitor=s,this._isSingleSelector=!1,this._checked=!1,this.ariaLabelledby=null,this._disabled=!1,this.change=new Si;const u=Number(a);this.tabIndex=u||0===u?u:null,this.buttonToggleGroup=e,this.appearance=l&&l.appearance?l.appearance:"standard"}get buttonId(){return`${this.id}-button`}get appearance(){return this.buttonToggleGroup?this.buttonToggleGroup.appearance:this._appearance}set appearance(e){this._appearance=e}get checked(){return this.buttonToggleGroup?this.buttonToggleGroup._isSelected(this):this._checked}set checked(e){const n=tn(e);n!==this._checked&&(this._checked=n,this.buttonToggleGroup&&this.buttonToggleGroup._syncButtonToggle(this,this._checked),this._changeDetectorRef.markForCheck())}get disabled(){return this._disabled||this.buttonToggleGroup&&this.buttonToggleGroup.disabled}set disabled(e){this._disabled=tn(e)}ngOnInit(){const e=this.buttonToggleGroup;this._isSingleSelector=e&&!e.multiple,this.id=this.id||"mat-button-toggle-"+$K++,this._isSingleSelector&&(this.name=e.name),e&&(e._isPrechecked(this)?this.checked=!0:e._isSelected(this)!==this._checked&&e._syncButtonToggle(this,this._checked))}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){const e=this.buttonToggleGroup;this._focusMonitor.stopMonitoring(this._elementRef),e&&e._isSelected(this)&&e._syncButtonToggle(this,!1,!1,!0)}focus(e){this._buttonElement.nativeElement.focus(e)}_onButtonClick(){const e=!!this._isSingleSelector||!this._checked;e!==this._checked&&(this._checked=e,this.buttonToggleGroup&&(this.buttonToggleGroup._syncButtonToggle(this,this._checked,!0),this.buttonToggleGroup._onTouched())),this.change.emit(new eQ(this,this.value))}_markForCheck(){this._changeDetectorRef.markForCheck()}}return i.\u0275fac=function(e){return new(e||i)(B(JK,8),B(Pn),B(ai),B(ch),zc("tabindex"),B(QK,8))},i.\u0275cmp=ei({type:i,selectors:[["mat-button-toggle"]],viewQuery:function(e,n){if(1&e&&ji(s1e,5),2&e){let r;jt(r=qt())&&(n._buttonElement=r.first)}},hostAttrs:["role","presentation",1,"mat-button-toggle"],hostVars:12,hostBindings:function(e,n){1&e&&je("focus",function(){return n.focus()}),2&e&&(Vi("aria-label",null)("aria-labelledby",null)("id",n.id)("name",null),N("mat-button-toggle-standalone",!n.buttonToggleGroup)("mat-button-toggle-checked",n.checked)("mat-button-toggle-disabled",n.disabled)("mat-button-toggle-appearance-standard","standard"===n.appearance))},inputs:{disableRipple:"disableRipple",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],id:"id",name:"name",value:"value",tabIndex:"tabIndex",appearance:"appearance",checked:"checked",disabled:"disabled"},outputs:{change:"change"},exportAs:["matButtonToggle"],features:[It],ngContentSelectors:o1e,decls:6,vars:9,consts:[["type","button",1,"mat-button-toggle-button","mat-focus-indicator",3,"id","disabled","click"],["button",""],[1,"mat-button-toggle-label-content"],[1,"mat-button-toggle-focus-overlay"],["matRipple","",1,"mat-button-toggle-ripple",3,"matRippleTrigger","matRippleDisabled"]],template:function(e,n){if(1&e&&(As(),Z(0,"button",0,1),je("click",function(){return n._onButtonClick()}),Z(2,"span",2),hr(3),J()(),yt(4,"span",3)(5,"span",4)),2&e){const r=Yo(1);fe("id",n.buttonId)("disabled",n.disabled||null),Vi("tabindex",n.disabled?-1:n.tabIndex)("aria-pressed",n.checked)("name",n.name||null)("aria-label",n.ariaLabel)("aria-labelledby",n.ariaLabelledby),se(5),fe("matRippleTrigger",r)("matRippleDisabled",n.disableRipple||n.disabled)}},directives:[hh],styles:[".mat-button-toggle-standalone,.mat-button-toggle-group{position:relative;display:inline-flex;flex-direction:row;white-space:nowrap;overflow:hidden;border-radius:2px;-webkit-tap-highlight-color:transparent;transform:translateZ(0)}.cdk-high-contrast-active .mat-button-toggle-standalone,.cdk-high-contrast-active .mat-button-toggle-group{outline:solid 1px}.mat-button-toggle-standalone.mat-button-toggle-appearance-standard,.mat-button-toggle-group-appearance-standard{border-radius:4px}.cdk-high-contrast-active .mat-button-toggle-standalone.mat-button-toggle-appearance-standard,.cdk-high-contrast-active .mat-button-toggle-group-appearance-standard{outline:0}.mat-button-toggle-vertical{flex-direction:column}.mat-button-toggle-vertical .mat-button-toggle-label-content{display:block}.mat-button-toggle{white-space:nowrap;position:relative}.mat-button-toggle .mat-icon svg{vertical-align:top}.mat-button-toggle.cdk-keyboard-focused .mat-button-toggle-focus-overlay{opacity:1}.cdk-high-contrast-active .mat-button-toggle.cdk-keyboard-focused .mat-button-toggle-focus-overlay{opacity:.5}.mat-button-toggle-appearance-standard:not(.mat-button-toggle-disabled):hover .mat-button-toggle-focus-overlay{opacity:.04}.mat-button-toggle-appearance-standard.cdk-keyboard-focused:not(.mat-button-toggle-disabled) .mat-button-toggle-focus-overlay{opacity:.12}.cdk-high-contrast-active .mat-button-toggle-appearance-standard.cdk-keyboard-focused:not(.mat-button-toggle-disabled) .mat-button-toggle-focus-overlay{opacity:.5}@media(hover: none){.mat-button-toggle-appearance-standard:not(.mat-button-toggle-disabled):hover .mat-button-toggle-focus-overlay{display:none}}.mat-button-toggle-label-content{-webkit-user-select:none;user-select:none;display:inline-block;line-height:36px;padding:0 16px;position:relative}.mat-button-toggle-appearance-standard .mat-button-toggle-label-content{padding:0 12px}.mat-button-toggle-label-content>*{vertical-align:middle}.mat-button-toggle-focus-overlay{border-radius:inherit;pointer-events:none;opacity:0;top:0;left:0;right:0;bottom:0;position:absolute}.mat-button-toggle-checked .cdk-high-contrast-active .mat-button-toggle-focus-overlay{border-bottom:solid 36px;opacity:.5;height:0}.cdk-high-contrast-active .mat-button-toggle-checked.mat-button-toggle-appearance-standard .mat-button-toggle-focus-overlay{border-bottom:solid 500px}.mat-button-toggle .mat-button-toggle-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-button-toggle-button{border:0;background:none;color:inherit;padding:0;margin:0;font:inherit;outline:none;width:100%;cursor:pointer}.mat-button-toggle-disabled .mat-button-toggle-button{cursor:default}.mat-button-toggle-button::-moz-focus-inner{border:0}\n"],encapsulation:2,changeDetection:0}),i})(),bE=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[jn,zf],jn]}),i})();var c1e=oP.PriorityEnum;function u1e(i,t){if(1&i&&(Z(0,"mat-option",6)(1,"small"),ue(2),J()()),2&i){const e=t.$implicit;fe("value",e),se(2),hi("",e.name,": ",e.description,"")}}function h1e(i,t){1&i&&(Z(0,"mat-icon"),ue(1,"menu"),J())}function d1e(i,t){1&i&&(Z(0,"mat-icon",20),ue(1,"warning_amber"),J())}function f1e(i,t){1&i&&(Z(0,"mat-icon",21),ue(1,"check_circle_outline"),J())}function p1e(i,t){1&i&&(Z(0,"mat-icon",22),ue(1,"not_interested"),J())}function m1e(i,t){if(1&i){const e=Wi();Z(0,"span")(1,"button",10),Ue(2,h1e,2,0,"mat-icon",9),Ue(3,d1e,2,0,"mat-icon",11),Ue(4,f1e,2,0,"mat-icon",12),Ue(5,p1e,2,0,"mat-icon",13),J(),Z(6,"mat-menu",14,15)(8,"mat-button-toggle-group",16)(9,"mat-button-toggle",17),je("change",function(){gt(e);const r=Re().$implicit;return Re().onPriorityChange("REQUIRE",r)}),Z(10,"mat-icon"),ue(11,"warning_amber"),J()(),Z(12,"mat-button-toggle",18),je("change",function(){gt(e);const r=Re().$implicit;return Re().onPriorityChange("REQUEST",r)}),Z(13,"mat-icon"),ue(14,"check_circle_outline"),J()(),Z(15,"mat-button-toggle",19),je("change",function(){gt(e);const r=Re().$implicit;return Re().onPriorityChange("EXCLUDE",r)}),Z(16,"mat-icon"),ue(17,"not_interested"),J()()()()()}if(2&i){const e=Yo(7),n=Re().$implicit;se(1),fe("matMenuTriggerFor",e),se(1),fe("ngIf",null==n.priority),se(1),fe("ngIf","REQUIRE"===n.priority),se(1),fe("ngIf","REQUEST"===n.priority),se(1),fe("ngIf","EXCLUDE"===n.priority),se(1),fe("overlapTrigger",!1)}}function g1e(i,t){if(1&i){const e=Wi();Z(0,"mat-chip",7),je("removed",function(){const s=gt(e).$implicit;return Re().removeTag(s)}),ue(1),Z(2,"small"),ue(3),J(),Z(4,"mat-icon",8),ue(5,"cancel"),J(),Ue(6,m1e,18,6,"span",9),J()}if(2&i){const e=t.$implicit,n=Re();_o("id",e.id),fe("removable",!0)("selectable",!0),se(1),ui(" ",e.name,"\xa0"),se(2),ui("(",e.id,")"),se(3),fe("ngIf",n.config.config.get("query.enableTagPrioritisation"))}}let _1e=(()=>{class i{constructor(e,n,r){this._matsnackbar=n,this.config=r,this._tags=[],this._field=new y1e(e)}ngOnInit(){this.tagTerm.data&&(this._tags=this.tagTerm.tags)}onTagSelected(e){let n=!1;for(const r of this._tags)r.id===e.option.value.id&&(n=!0);n?(this._field.formControl.setValue(""),this._matsnackbar.open(`Tag ${e.option.value.name} (${e.option.value.id}) already added`,null,{duration:2e3})):this.addTag(e.option.value)}addTag(e){e.priority||(e.priority=c1e.Request),this._tags.push(e),this._field.formControl.setValue(""),this.tagTerm.tags=this._tags,this.tagTerm.data="data:application/json;base64,"+btoa(JSON.stringify(this._tags.map(n=>n)))}addTags(e){e.forEach(n=>{this.addTag(n)})}removeTag(e){const n=this._tags.indexOf(e);n>-1&&this._tags.splice(n,1),this.tagTerm.tags=this._tags,this.tagTerm.data="data:application/json;base64,"+btoa(JSON.stringify(this._tags.map(r=>r)))}onPriorityChange(e,n){n.priority=e,this.tagTerm.data="data:application/json;base64,"+btoa(JSON.stringify(this._tags.map(r=>r))),this.sortTagsByPreference()}sortTagsByPreference(){this._tags.sort(function(n,r){return n.priority>r.priority?-1:n.priority<r.priority?1:0})}}return i.\u0275fac=function(e){return new(e||i)(B(sP),B(Ru),B(dr))},i.\u0275cmp=ei({type:i,selectors:[["app-qt-tag"]],viewQuery:function(e,n){if(1&e&&ji(RP,7),2&e){let r;jt(r=qt())&&(n.menu=r.first)}},inputs:{tagTerm:"tagTerm"},decls:9,vars:11,consts:[[1,"textinput"],["aria-label","Enter a tag","matInput","","placeholder","Enter a tag",3,"formControl","matAutocomplete"],[3,"panelWidth","optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["class","dropdown",3,"removable","selectable","id","removed",4,"ngFor","ngForOf"],[3,"value"],[1,"dropdown",3,"removable","selectable","id","removed"],["matChipRemove","","matTooltip","Remove tag from list"],[4,"ngIf"],["mat-icon-button","",3,"matMenuTriggerFor"],["class","require-icon",4,"ngIf"],["class","request-icon",4,"ngIf"],["class","exclude-icon",4,"ngIf"],[3,"overlapTrigger"],["menu","matMenu"],["mat-menu-item",""],["value","REQUIRE",1,"require-icon",3,"change"],["value","REQUEST",1,"request-icon",3,"change"],["value","EXCLUDE",1,"exclude-icon",3,"change"],[1,"require-icon"],[1,"request-icon"],[1,"exclude-icon"]],template:function(e,n){if(1&e&&(Z(0,"div")(1,"mat-form-field",0),yt(2,"input",1),Z(3,"mat-autocomplete",2,3),je("optionSelected",function(s){return n.onTagSelected(s)}),Ue(5,u1e,3,3,"mat-option",4),ti(6,"async"),J()(),Z(7,"mat-chip-list"),Ue(8,g1e,7,6,"mat-chip",5),J()()),2&e){const r=Yo(4);A("padding-left","10px")("text-align","left"),se(2),fe("formControl",n._field.formControl)("matAutocomplete",r),se(1),fe("panelWidth",450),se(2),fe("ngForOf",Qi(6,9,n._field.filteredTags)),se(3),fe("ngForOf",n._tags)}},directives:[og,Ty,Bf,x4,ah,jR,zK,mo,Vb,YK,pI,vo,XK,Fo,ms,Mo,YH,RP,mI,fS,gI],pipes:[Xc],styles:[".textinput[_ngcontent-%COMP%]{width:90%}.container[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:flex-start}.require-icon[_ngcontent-%COMP%]{color:#1e90ff}.request-icon[_ngcontent-%COMP%]{color:#32cd32}.exclude-icon[_ngcontent-%COMP%]{color:red}"]}),i})();class y1e{constructor(t){this._tags=t,this.formControl=new GR,this.currentlyDisplayedTags=new Array,this.filteredTags=this.formControl.valueChanges.pipe(jm(250),Tl(""),Ui(e=>e.length>=3?this._tags.findTagsBy("matchingname",e).pipe(Xl(),Ui(n=>n.tags)):aa),lf()),this.filteredTags.subscribe(e=>{this.currentlyDisplayedTags=new Array,e.forEach(n=>this.currentlyDisplayedTags.push(n))})}get selection(){return this._selection}set selection(t){this._selection=t}}class Jt{constructor(t,e){this.name=t,e||(e=Rb.randomColorHex()),this.color=e}}Jt.LIST=[new Jt("Airplane"),new Jt("Animal"),new Jt("Apparel"),new Jt("Armchair"),new Jt("Ashcan"),new Jt("Awning"),new Jt("Bag"),new Jt("Ball"),new Jt("Bannister"),new Jt("Bar"),new Jt("Barrel"),new Jt("Base"),new Jt("Basket"),new Jt("Bathtub"),new Jt("Bed"),new Jt("Bench"),new Jt("Bicycle"),new Jt("Blanket"),new Jt("Blind"),new Jt("Boat"),new Jt("Book"),new Jt("Bookcase"),new Jt("Booth"),new Jt("Bottle"),new Jt("Box"),new Jt("Bridge"),new Jt("Buffet"),new Jt("Building"),new Jt("Bus"),new Jt("Cabinet"),new Jt("Canopy"),new Jt("Car"),new Jt("Case"),new Jt("Ceiling"),new Jt("Chair"),new Jt("Chandelier"),new Jt("Clock"),new Jt("Column"),new Jt("Computer"),new Jt("Counter"),new Jt("Countertop"),new Jt("Cradle"),new Jt("Curtain"),new Jt("Cushion"),new Jt("Desk"),new Jt("Dishwasher"),new Jt("Door"),new Jt("Earth"),new Jt("Escalator"),new Jt("Fan"),new Jt("Fence"),new Jt("Field"),new Jt("Fireplace"),new Jt("Flag"),new Jt("Floor"),new Jt("Flower"),new Jt("Food"),new Jt("Fountain"),new Jt("Glass"),new Jt("Grandstand"),new Jt("Grass"),new Jt("Hill"),new Jt("Hood"),new Jt("House"),new Jt("Hovel"),new Jt("Kitchen"),new Jt("Lake"),new Jt("Lamp"),new Jt("Land"),new Jt("Light"),new Jt("Microwave"),new Jt("Minibike"),new Jt("Mirror"),new Jt("Monitor"),new Jt("Mountain"),new Jt("Ottoman"),new Jt("Oven"),new Jt("Painting"),new Jt("Palm"),new Jt("Path"),new Jt("Person"),new Jt("Pier"),new Jt("Pillow"),new Jt("Plant"),new Jt("Plate"),new Jt("Plaything"),new Jt("Pole"),new Jt("Poster"),new Jt("Pot"),new Jt("Radiator"),new Jt("Refrigerator"),new Jt("River"),new Jt("Road"),new Jt("Rock"),new Jt("Rug"),new Jt("Runway"),new Jt("Sand"),new Jt("Sconce"),new Jt("Screen"),new Jt("Sculpture"),new Jt("Sea"),new Jt("Seat"),new Jt("Shelf"),new Jt("Ship"),new Jt("Shower"),new Jt("Sidewalk"),new Jt("Signboard"),new Jt("Sink"),new Jt("Sky"),new Jt("Skyscraper"),new Jt("Sofa"),new Jt("Stage"),new Jt("Stairs"),new Jt("Stairway"),new Jt("Step"),new Jt("Stool"),new Jt("Stove"),new Jt("Streetlight"),new Jt("Table"),new Jt("Tank"),new Jt("Television"),new Jt("Tent"),new Jt("Toilet"),new Jt("Towel"),new Jt("Tower"),new Jt("Tray"),new Jt("Tree"),new Jt("Truck"),new Jt("TV"),new Jt("Van"),new Jt("Vase"),new Jt("Wall"),new Jt("Wardrobe"),new Jt("Washer"),new Jt("Water"),new Jt("Waterfall"),new Jt("Windowpane")];class w4{constructor(t,e){this.image=t,this.map=e}}const v1e=["imageloader"],b1e=["sketch"];function x1e(i,t){if(1&i&&(Z(0,"mat-option",17)(1,"span")(2,"strong"),ue(3),J()()()),2&i){const e=t.$implicit;fe("value",e.name),se(1),A("color",e.color),se(2),Xt(e.name)}}function w1e(i,t){if(1&i){const e=Wi();Z(0,"li",18),je("click",function(){const s=gt(e).$implicit;return Re().onItemSelected(s)}),ue(1),J()}if(2&i){const e=t.$implicit,n=Re();A("background-color",n._usedSet.has(e)?e.color:"#000000")("color",n._usedSet.has(e)?"#000000":"#FFFFFF"),N("item",!0)("selected",e==n.selected),_o("matTooltip",e.name),se(1),ui(" ",e.name," ")}}let S1e=(()=>{class i{constructor(e,n){this._dialogRef=e,this._data=n,this.formCtrl=new GR,this.linesize=i.DEFAULT_LINESIZE,this._used=new gs([]),this._categories=Jt.LIST,this._selected=this._categories[0],this._usedSet=new Set,e.disableClose=!0;const r=this.formCtrl.valueChanges.pipe(Tl(""),Ui(s=>s.toLowerCase()),Ui(s=>s?this._categories.filter(a=>0===a.name.toLowerCase().indexOf(s)):this._categories));this._filteredCategories=zb([r,this._used]).pipe(Ui(s=>s[0].sort((a,l)=>{const u=s[1].indexOf(a),h=s[1].indexOf(l);return-1===u&&-1!==h?1:-1!==u&&-1===h||a.name<l.name?-1:a.name>l.name?1:0}))),this._used.subscribe(s=>{const a=new Set;s.forEach(l=>this._usedSet.add(l)),this._usedSet=a})}get selected(){return this._selected}ngOnInit(){this._data&&(this._sketchpad.setImageBase64(this._data.image),this._used.next(this._data.map),this._data=null)}ngAfterViewInit(){this._sketchpad.setLineSize(this.linesize)}inUse(e){return this._used.pipe(Ui(n=>n.indexOf(e)>-1))}onItemSelected(e){this._selected=e,this._sketchpad.setActiveColor(e.color);const n=this._used.getValue().concat().slice();-1===n.indexOf(e)&&(n.push(e),this._used.next(n))}onLineSizeChange(){this._sketchpad.setLineSize(this.linesize)}onClearCanvasClicked(){this._sketchpad.clearCanvas(),this._used.next([])}onFillCanvasClicked(){this._sketchpad.fillCanvas()}onOptionSelected(e){for(const n of this._categories)if(n.name===e){this.onItemSelected(n);break}}close(){this._dialogRef.close(new w4(this._sketchpad.getImageBase64(),this._used.getValue()))}}return i.DEFAULT_LINESIZE=10,i.\u0275fac=function(e){return new(e||i)(B(Ip),B(Cy,8))},i.\u0275cmp=ei({type:i,selectors:[["app-semantic-sketchpad"]],viewQuery:function(e,n){if(1&e&&(ji(v1e,5),ji(b1e,5)),2&e){let r;jt(r=qt())&&(n.imageloader=r.first),jt(r=qt())&&(n._sketchpad=r.first)}},decls:31,vars:17,consts:[["color","primary"],["matTooltip","Pencil size"],[1,"spacer-tiny"],["max","100","min","1","step","1","tickInterval","auto",3,"ngModel","change","ngModelChange"],[1,"spacer-flex"],["mat-icon-button","","matTooltip","Fill canvas with concept.",3,"click"],["mat-icon-button","","matTooltip","Clear canvas.",3,"click"],["mat-icon-button","","matTooltip","Close window and save.",3,"click"],[2,"display","flex","margin-top","5px"],[3,"height","width"],["sketch",""],["aria-label","Select a concept","matInput","","placeholder","Select a concept",3,"formControl","matAutocomplete"],[3,"optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[1,"picker"],[3,"item","selected","background-color","color","matTooltip","click",4,"ngFor","ngForOf"],[3,"value"],[3,"matTooltip","click"]],template:function(e,n){if(1&e&&(Z(0,"mat-dialog-content")(1,"mat-toolbar",0)(2,"mat-icon",1),ue(3,"border_color"),J(),yt(4,"span",2),Z(5,"mat-slider",3),je("change",function(){return n.onLineSizeChange()})("ngModelChange",function(s){return n.linesize=s}),J(),yt(6,"span",4),Z(7,"button",5),je("click",function(){return n.onFillCanvasClicked()}),Z(8,"mat-icon"),ue(9,"format_color_fill"),J()(),Z(10,"button",6),je("click",function(){return n.onClearCanvasClicked()}),Z(11,"mat-icon"),ue(12,"delete"),J()(),yt(13,"span",4)(14,"span",4),Z(15,"button",7),je("click",function(){return n.close()}),Z(16,"mat-icon"),ue(17,"close"),J()()(),Z(18,"div",8),yt(19,"app-sketch-canvas",9,10),Z(21,"div")(22,"mat-form-field"),yt(23,"input",11),Z(24,"mat-autocomplete",12,13),je("optionSelected",function(s){return n.onOptionSelected(s.option.value)}),Ue(26,x1e,4,4,"mat-option",14),ti(27,"async"),J()(),Z(28,"ul",15),Ue(29,w1e,2,10,"li",16),ti(30,"async"),J()()()()),2&e){const r=Yo(25);se(5),A("min-width","100px"),fe("ngModel",n.linesize),se(14),fe("height",300)("width",300),se(2),A("margin-left","10px")("width","300px"),se(2),fe("formControl",n.formCtrl)("matAutocomplete",r),se(3),fe("ngForOf",Qi(27,13,n._filteredCategories)),se(3),fe("ngForOf",Qi(30,15,n._filteredCategories))}},directives:[cS,My,vo,Fo,Ey,ah,lh,Mo,cV,og,Ty,Bf,x4,jR,zK,mo,Vb],pipes:[Xc],styles:["mat-slider[_ngcontent-%COMP%]{width:200px}.picker[_ngcontent-%COMP%]{width:300px;height:250px;overflow:scroll;list-style-type:none;margin:0;padding:0}.picker[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{height:20px;margin:5px;font-weight:700;text-align:center;vertical-align:center}.picker[_ngcontent-%COMP%]   .item.selected[_ngcontent-%COMP%]{border:1px solid}"]}),i})();const C1e=["previewimg"];let M1e=(()=>{class i{constructor(e,n,r){this._dialog=e,this._resolver=n,this._http=r}ngOnInit(){this.semanticTerm.image&&(this.previewimg.nativeElement.src=this.semanticTerm.image)}onViewerClicked(){this.semanticTerm.data&&this.semanticTerm.map.length>0?this.openSketchDialog(new w4(this.semanticTerm.image,this.semanticTerm.map)):this.openSketchDialog()}openSketchDialog(e){const n=new CP;n.height="450px",n.data=e,this._dialog.open(S1e,n).afterClosed().pipe(Xl()).subscribe(s=>{s instanceof w4&&(this.semanticTerm.image=s.image,this.semanticTerm.map=s.map,this.previewimg.nativeElement.src=s.image)})}}return i.\u0275fac=function(e){return new(e||i)(B(Lu),B(Ts),B(ma))},i.\u0275cmp=ei({type:i,selectors:[["app-qt-semantic"]],viewQuery:function(e,n){if(1&e&&ji(C1e,7),2&e){let r;jt(r=qt())&&(n.previewimg=r.first)}},inputs:{semanticTerm:"semanticTerm"},decls:2,vars:0,consts:[["matTooltip","Click to drawn a semantic sketch.","width","150",1,"previewimg",2,"background-image","url('assets/images/transparent.png')",3,"click"],["previewimg",""]],template:function(e,n){1&e&&(Z(0,"img",0,1),je("click",function(){return n.onViewerClicked()}),J())},directives:[Fo],styles:["img.previewimg[_ngcontent-%COMP%]{width:150px;height:150px;border:rgb(235,235,235) solid .5px;display:inline-block}"]}),i})();class T1e{constructor(t,e,n){this.attribute=t,this.operator=e,this.values=n}}class S4{constructor(t,e,n,r,s,a,l,u,h){this.display=t,this.input=e,this.table=n,this.col=r,this.range=s,this.options=a,this.shorthand=l,this.type=u,this.operators=h}static getInputTypeValue(t){let e=-1;return e="string"==typeof t?Number(_a[t]):t.valueOf(),e}}const E1e=["trigger"],A1e=["panel"];function D1e(i,t){if(1&i&&(Z(0,"span",8),ue(1),J()),2&i){const e=Re();se(1),Xt(e.placeholder)}}function R1e(i,t){if(1&i&&(Z(0,"span",12),ue(1),J()),2&i){const e=Re(2);se(1),Xt(e.triggerValue)}}function k1e(i,t){1&i&&hr(0,0,["*ngSwitchCase","true"])}function P1e(i,t){1&i&&(Z(0,"span",9),Ue(1,R1e,2,1,"span",10),Ue(2,k1e,1,0,"ng-content",11),J()),2&i&&(fe("ngSwitch",!!Re().customTrigger),se(2),fe("ngSwitchCase",!0))}function I1e(i,t){if(1&i){const e=Wi();Z(0,"div",13)(1,"div",14,15),je("@transformPanel.done",function(r){return gt(e),Re()._panelDoneAnimatingStream.next(r.toState)})("keydown",function(r){return gt(e),Re()._handleKeydown(r)}),hr(3,1),J()()}if(2&i){const e=Re();fe("@transformPanelWrap",void 0),se(1),Nr("mat-select-panel ",e._getPanelTheme(),""),A("transform-origin",e._transformOrigin)("font-size",e._triggerFontSize,"px"),fe("ngClass",e.panelClass)("@transformPanel",e.multiple?"showing-multiple":"showing"),Vi("id",e.id+"-panel")("aria-multiselectable",e.multiple)("aria-label",e.ariaLabel||null)("aria-labelledby",e._getPanelAriaLabelledby())}}const L1e=[[["mat-select-trigger"]],"*"],O1e=["mat-select-trigger","*"],tQ={transformPanelWrap:Xd("transformPanelWrap",[Ml("* => void",w1("@transformPanel",[x1()],{optional:!0}))]),transformPanel:Xd("transformPanel",[Cl("void",Xs({transform:"scaleY(0.8)",minWidth:"100%",opacity:0})),Cl("showing",Xs({opacity:1,minWidth:"calc(100% + 32px)",transform:"scaleY(1)"})),Cl("showing-multiple",Xs({opacity:1,minWidth:"calc(100% + 64px)",transform:"scaleY(1)"})),Ml("void => *",ql("120ms cubic-bezier(0, 0, 0.2, 1)")),Ml("* => void",ql("100ms 25ms linear",Xs({opacity:0})))])};let iQ=0;const rQ=new gi("mat-select-scroll-strategy"),H1e=new gi("MAT_SELECT_CONFIG"),V1e={provide:rQ,deps:[Du],useFactory:function N1e(i){return()=>i.scrollStrategies.reposition()}};class z1e{constructor(t,e){this.source=t,this.value=e}}const U1e=uh(Ww(Hf(rN(class{constructor(i,t,e,n,r){this._elementRef=i,this._defaultErrorStateMatcher=t,this._parentForm=e,this._parentFormGroup=n,this.ngControl=r}})))),G1e=new gi("MatSelectTrigger");let W1e=(()=>{class i extends U1e{constructor(e,n,r,s,a,l,u,h,m,_,v,S,T,I){var j,P,E;super(a,s,u,h,_),this._viewportRuler=e,this._changeDetectorRef=n,this._ngZone=r,this._dir=l,this._parentFormField=m,this._liveAnnouncer=T,this._defaultOptions=I,this._panelOpen=!1,this._compareWith=(ie,ee)=>ie===ee,this._uid="mat-select-"+iQ++,this._triggerAriaLabelledBy=null,this._destroy=new ii,this._onChange=()=>{},this._onTouched=()=>{},this._valueId="mat-select-value-"+iQ++,this._panelDoneAnimatingStream=new ii,this._overlayPanelClass=(null===(j=this._defaultOptions)||void 0===j?void 0:j.overlayPanelClass)||"",this._focused=!1,this.controlType="mat-select",this._multiple=!1,this._disableOptionCentering=null!==(E=null===(P=this._defaultOptions)||void 0===P?void 0:P.disableOptionCentering)&&void 0!==E&&E,this.ariaLabel="",this.optionSelectionChanges=hT(()=>{const ie=this.options;return ie?ie.changes.pipe(Tl(ie),dh(()=>uo(...ie.map(ee=>ee.onSelectionChange)))):this._ngZone.onStable.pipe(Qr(1),dh(()=>this.optionSelectionChanges))}),this.openedChange=new Si,this._openedStream=this.openedChange.pipe(vr(ie=>ie),Ui(()=>{})),this._closedStream=this.openedChange.pipe(vr(ie=>!ie),Ui(()=>{})),this.selectionChange=new Si,this.valueChange=new Si,this.ngControl&&(this.ngControl.valueAccessor=this),null!=(null==I?void 0:I.typeaheadDebounceInterval)&&(this._typeaheadDebounceInterval=I.typeaheadDebounceInterval),this._scrollStrategyFactory=S,this._scrollStrategy=this._scrollStrategyFactory(),this.tabIndex=parseInt(v)||0,this.id=this.id}get focused(){return this._focused||this._panelOpen}get placeholder(){return this._placeholder}set placeholder(e){this._placeholder=e,this.stateChanges.next()}get required(){var e,n,r,s;return null!==(s=null!==(e=this._required)&&void 0!==e?e:null===(r=null===(n=this.ngControl)||void 0===n?void 0:n.control)||void 0===r?void 0:r.hasValidator(j3.required))&&void 0!==s&&s}set required(e){this._required=tn(e),this.stateChanges.next()}get multiple(){return this._multiple}set multiple(e){this._multiple=tn(e)}get disableOptionCentering(){return this._disableOptionCentering}set disableOptionCentering(e){this._disableOptionCentering=tn(e)}get compareWith(){return this._compareWith}set compareWith(e){this._compareWith=e,this._selectionModel&&this._initializeSelection()}get value(){return this._value}set value(e){this._assignValue(e)&&this._onChange(e)}get typeaheadDebounceInterval(){return this._typeaheadDebounceInterval}set typeaheadDebounceInterval(e){this._typeaheadDebounceInterval=Qo(e)}get id(){return this._id}set id(e){this._id=e||this._uid,this.stateChanges.next()}ngOnInit(){this._selectionModel=new cT(this.multiple),this.stateChanges.next(),this._panelDoneAnimatingStream.pipe(xk(),$n(this._destroy)).subscribe(()=>this._panelDoneAnimating(this.panelOpen))}ngAfterContentInit(){this._initKeyManager(),this._selectionModel.changed.pipe($n(this._destroy)).subscribe(e=>{e.added.forEach(n=>n.select()),e.removed.forEach(n=>n.deselect())}),this.options.changes.pipe(Tl(null),$n(this._destroy)).subscribe(()=>{this._resetOptions(),this._initializeSelection()})}ngDoCheck(){const e=this._getTriggerAriaLabelledby(),n=this.ngControl;if(e!==this._triggerAriaLabelledBy){const r=this._elementRef.nativeElement;this._triggerAriaLabelledBy=e,e?r.setAttribute("aria-labelledby",e):r.removeAttribute("aria-labelledby")}n&&(this._previousControl!==n.control&&(void 0!==this._previousControl&&null!==n.disabled&&n.disabled!==this.disabled&&(this.disabled=n.disabled),this._previousControl=n.control),this.updateErrorState())}ngOnChanges(e){e.disabled&&this.stateChanges.next(),e.typeaheadDebounceInterval&&this._keyManager&&this._keyManager.withTypeAhead(this._typeaheadDebounceInterval)}ngOnDestroy(){this._destroy.next(),this._destroy.complete(),this.stateChanges.complete()}toggle(){this.panelOpen?this.close():this.open()}open(){this._canOpen()&&(this._panelOpen=!0,this._keyManager.withHorizontalOrientation(null),this._highlightCorrectOption(),this._changeDetectorRef.markForCheck())}close(){this._panelOpen&&(this._panelOpen=!1,this._keyManager.withHorizontalOrientation(this._isRtl()?"rtl":"ltr"),this._changeDetectorRef.markForCheck(),this._onTouched())}writeValue(e){this._assignValue(e)}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this.disabled=e,this._changeDetectorRef.markForCheck(),this.stateChanges.next()}get panelOpen(){return this._panelOpen}get selected(){var e,n;return this.multiple?(null===(e=this._selectionModel)||void 0===e?void 0:e.selected)||[]:null===(n=this._selectionModel)||void 0===n?void 0:n.selected[0]}get triggerValue(){if(this.empty)return"";if(this._multiple){const e=this._selectionModel.selected.map(n=>n.viewValue);return this._isRtl()&&e.reverse(),e.join(", ")}return this._selectionModel.selected[0].viewValue}_isRtl(){return!!this._dir&&"rtl"===this._dir.value}_handleKeydown(e){this.disabled||(this.panelOpen?this._handleOpenKeydown(e):this._handleClosedKeydown(e))}_handleClosedKeydown(e){const n=e.keyCode,r=40===n||38===n||37===n||39===n,s=13===n||32===n,a=this._keyManager;if(!a.isTyping()&&s&&!dc(e)||(this.multiple||e.altKey)&&r)e.preventDefault(),this.open();else if(!this.multiple){const l=this.selected;a.onKeydown(e);const u=this.selected;u&&l!==u&&this._liveAnnouncer.announce(u.viewValue,1e4)}}_handleOpenKeydown(e){const n=this._keyManager,r=e.keyCode,s=40===r||38===r,a=n.isTyping();if(s&&e.altKey)e.preventDefault(),this.close();else if(a||13!==r&&32!==r||!n.activeItem||dc(e))if(!a&&this._multiple&&65===r&&e.ctrlKey){e.preventDefault();const l=this.options.some(u=>!u.disabled&&!u.selected);this.options.forEach(u=>{u.disabled||(l?u.select():u.deselect())})}else{const l=n.activeItemIndex;n.onKeydown(e),this._multiple&&s&&e.shiftKey&&n.activeItem&&n.activeItemIndex!==l&&n.activeItem._selectViaInteraction()}else e.preventDefault(),n.activeItem._selectViaInteraction()}_onFocus(){this.disabled||(this._focused=!0,this.stateChanges.next())}_onBlur(){this._focused=!1,!this.disabled&&!this.panelOpen&&(this._onTouched(),this._changeDetectorRef.markForCheck(),this.stateChanges.next())}_onAttached(){this._overlayDir.positionChange.pipe(Qr(1)).subscribe(()=>{this._changeDetectorRef.detectChanges(),this._positioningSettled()})}_getPanelTheme(){return this._parentFormField?`mat-${this._parentFormField.color}`:""}get empty(){return!this._selectionModel||this._selectionModel.isEmpty()}_initializeSelection(){Promise.resolve().then(()=>{this.ngControl&&(this._value=this.ngControl.value),this._setSelectionByValue(this._value),this.stateChanges.next()})}_setSelectionByValue(e){if(this._selectionModel.selected.forEach(n=>n.setInactiveStyles()),this._selectionModel.clear(),this.multiple&&e)Array.isArray(e),e.forEach(n=>this._selectOptionByValue(n)),this._sortValues();else{const n=this._selectOptionByValue(e);n?this._keyManager.updateActiveItem(n):this.panelOpen||this._keyManager.updateActiveItem(-1)}this._changeDetectorRef.markForCheck()}_selectOptionByValue(e){const n=this.options.find(r=>{if(this._selectionModel.isSelected(r))return!1;try{return null!=r.value&&this._compareWith(r.value,e)}catch(s){return!1}});return n&&this._selectionModel.select(n),n}_assignValue(e){return!!(e!==this._value||this._multiple&&Array.isArray(e))&&(this.options&&this._setSelectionByValue(e),this._value=e,!0)}_initKeyManager(){this._keyManager=new a7(this.options).withTypeAhead(this._typeaheadDebounceInterval).withVerticalOrientation().withHorizontalOrientation(this._isRtl()?"rtl":"ltr").withHomeAndEnd().withAllowedModifierKeys(["shiftKey"]),this._keyManager.tabOut.pipe($n(this._destroy)).subscribe(()=>{this.panelOpen&&(!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction(),this.focus(),this.close())}),this._keyManager.change.pipe($n(this._destroy)).subscribe(()=>{this._panelOpen&&this.panel?this._scrollOptionIntoView(this._keyManager.activeItemIndex||0):!this._panelOpen&&!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction()})}_resetOptions(){const e=uo(this.options.changes,this._destroy);this.optionSelectionChanges.pipe($n(e)).subscribe(n=>{this._onSelect(n.source,n.isUserInput),n.isUserInput&&!this.multiple&&this._panelOpen&&(this.close(),this.focus())}),uo(...this.options.map(n=>n._stateChanges)).pipe($n(e)).subscribe(()=>{this._changeDetectorRef.markForCheck(),this.stateChanges.next()})}_onSelect(e,n){const r=this._selectionModel.isSelected(e);null!=e.value||this._multiple?(r!==e.selected&&(e.selected?this._selectionModel.select(e):this._selectionModel.deselect(e)),n&&this._keyManager.setActiveItem(e),this.multiple&&(this._sortValues(),n&&this.focus())):(e.deselect(),this._selectionModel.clear(),null!=this.value&&this._propagateChanges(e.value)),r!==this._selectionModel.isSelected(e)&&this._propagateChanges(),this.stateChanges.next()}_sortValues(){if(this.multiple){const e=this.options.toArray();this._selectionModel.sort((n,r)=>this.sortComparator?this.sortComparator(n,r,e):e.indexOf(n)-e.indexOf(r)),this.stateChanges.next()}}_propagateChanges(e){let n=null;n=this.multiple?this.selected.map(r=>r.value):this.selected?this.selected.value:e,this._value=n,this.valueChange.emit(n),this._onChange(n),this.selectionChange.emit(this._getChangeEvent(n)),this._changeDetectorRef.markForCheck()}_highlightCorrectOption(){this._keyManager&&(this.empty?this._keyManager.setFirstItemActive():this._keyManager.setActiveItem(this._selectionModel.selected[0]))}_canOpen(){var e;return!this._panelOpen&&!this.disabled&&(null===(e=this.options)||void 0===e?void 0:e.length)>0}focus(e){this._elementRef.nativeElement.focus(e)}_getPanelAriaLabelledby(){var e;if(this.ariaLabel)return null;const n=null===(e=this._parentFormField)||void 0===e?void 0:e.getLabelId();return this.ariaLabelledby?(n?n+" ":"")+this.ariaLabelledby:n}_getAriaActiveDescendant(){return this.panelOpen&&this._keyManager&&this._keyManager.activeItem?this._keyManager.activeItem.id:null}_getTriggerAriaLabelledby(){var e;if(this.ariaLabel)return null;const n=null===(e=this._parentFormField)||void 0===e?void 0:e.getLabelId();let r=(n?n+" ":"")+this._valueId;return this.ariaLabelledby&&(r+=" "+this.ariaLabelledby),r}_panelDoneAnimating(e){this.openedChange.emit(e)}setDescribedByIds(e){this._ariaDescribedby=e.join(" ")}onContainerClick(){this.focus(),this.open()}get shouldLabelFloat(){return this._panelOpen||!this.empty||this._focused&&!!this._placeholder}}return i.\u0275fac=function(e){return new(e||i)(B(Tp),B(Pn),B(Rn),B(z1),B(ai),B(Ia,8),B(Cb,8),B(Ow,8),B(AP,8),B(Nf,10),zc("tabindex"),B(rQ),B(tN),B(H1e,8))},i.\u0275dir=Be({type:i,viewQuery:function(e,n){if(1&e&&(ji(E1e,5),ji(A1e,5),ji(QW,5)),2&e){let r;jt(r=qt())&&(n.trigger=r.first),jt(r=qt())&&(n.panel=r.first),jt(r=qt())&&(n._overlayDir=r.first)}},inputs:{panelClass:"panelClass",placeholder:"placeholder",required:"required",multiple:"multiple",disableOptionCentering:"disableOptionCentering",compareWith:"compareWith",value:"value",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],errorStateMatcher:"errorStateMatcher",typeaheadDebounceInterval:"typeaheadDebounceInterval",sortComparator:"sortComparator",id:"id"},outputs:{openedChange:"openedChange",_openedStream:"opened",_closedStream:"closed",selectionChange:"selectionChange",valueChange:"valueChange"},features:[It,Ls]}),i})(),C4=(()=>{class i extends W1e{constructor(){super(...arguments),this._scrollTop=0,this._triggerFontSize=0,this._transformOrigin="top",this._offsetY=0,this._positions=[{originX:"start",originY:"top",overlayX:"start",overlayY:"top"},{originX:"start",originY:"bottom",overlayX:"start",overlayY:"bottom"}]}_calculateOverlayScroll(e,n,r){const s=this._getItemHeight();return Math.min(Math.max(0,s*e-n+s/2),r)}ngOnInit(){super.ngOnInit(),this._viewportRuler.change().pipe($n(this._destroy)).subscribe(()=>{this.panelOpen&&(this._triggerRect=this.trigger.nativeElement.getBoundingClientRect(),this._changeDetectorRef.markForCheck())})}open(){super._canOpen()&&(super.open(),this._triggerRect=this.trigger.nativeElement.getBoundingClientRect(),this._triggerFontSize=parseInt(getComputedStyle(this.trigger.nativeElement).fontSize||"0"),this._calculateOverlayPosition(),this._ngZone.onStable.pipe(Qr(1)).subscribe(()=>{this._triggerFontSize&&this._overlayDir.overlayRef&&this._overlayDir.overlayRef.overlayElement&&(this._overlayDir.overlayRef.overlayElement.style.fontSize=`${this._triggerFontSize}px`)}))}_scrollOptionIntoView(e){const n=cN(e,this.options,this.optionGroups),r=this._getItemHeight();this.panel.nativeElement.scrollTop=0===e&&1===n?0:M7((e+n)*r,r,this.panel.nativeElement.scrollTop,256)}_positioningSettled(){this._calculateOverlayOffsetX(),this.panel.nativeElement.scrollTop=this._scrollTop}_panelDoneAnimating(e){this.panelOpen?this._scrollTop=0:(this._overlayDir.offsetX=0,this._changeDetectorRef.markForCheck()),super._panelDoneAnimating(e)}_getChangeEvent(e){return new z1e(this,e)}_calculateOverlayOffsetX(){const e=this._overlayDir.overlayRef.overlayElement.getBoundingClientRect(),n=this._viewportRuler.getViewportSize(),r=this._isRtl(),s=this.multiple?56:32;let a;if(this.multiple)a=40;else if(this.disableOptionCentering)a=16;else{let h=this._selectionModel.selected[0]||this.options.first;a=h&&h.group?32:16}r||(a*=-1);const l=0-(e.left+a-(r?s:0)),u=e.right+a-n.width+(r?0:s);l>0?a+=l+8:u>0&&(a-=u+8),this._overlayDir.offsetX=Math.round(a),this._overlayDir.overlayRef.updatePosition()}_calculateOverlayOffsetY(e,n,r){const s=this._getItemHeight(),a=(s-this._triggerRect.height)/2,l=Math.floor(256/s);let u;return this.disableOptionCentering?0:(u=0===this._scrollTop?e*s:this._scrollTop===r?(e-(this._getItemCount()-l))*s+(s-(this._getItemCount()*s-256)%s):n-s/2,Math.round(-1*u-a))}_checkOverlayWithinViewport(e){const n=this._getItemHeight(),r=this._viewportRuler.getViewportSize(),s=this._triggerRect.top-8,a=r.height-this._triggerRect.bottom-8,l=Math.abs(this._offsetY),h=Math.min(this._getItemCount()*n,256)-l-this._triggerRect.height;h>a?this._adjustPanelUp(h,a):l>s?this._adjustPanelDown(l,s,e):this._transformOrigin=this._getOriginBasedOnOption()}_adjustPanelUp(e,n){const r=Math.round(e-n);this._scrollTop-=r,this._offsetY-=r,this._transformOrigin=this._getOriginBasedOnOption(),this._scrollTop<=0&&(this._scrollTop=0,this._offsetY=0,this._transformOrigin="50% bottom 0px")}_adjustPanelDown(e,n,r){const s=Math.round(e-n);if(this._scrollTop+=s,this._offsetY+=s,this._transformOrigin=this._getOriginBasedOnOption(),this._scrollTop>=r)return this._scrollTop=r,this._offsetY=0,void(this._transformOrigin="50% top 0px")}_calculateOverlayPosition(){const e=this._getItemHeight(),n=this._getItemCount(),r=Math.min(n*e,256),a=n*e-r;let l;l=this.empty?0:Math.max(this.options.toArray().indexOf(this._selectionModel.selected[0]),0),l+=cN(l,this.options,this.optionGroups);const u=r/2;this._scrollTop=this._calculateOverlayScroll(l,u,a),this._offsetY=this._calculateOverlayOffsetY(l,u,a),this._checkOverlayWithinViewport(a)}_getOriginBasedOnOption(){const e=this._getItemHeight(),n=(e-this._triggerRect.height)/2;return`50% ${Math.abs(this._offsetY)-n+e/2}px 0px`}_getItemHeight(){return 3*this._triggerFontSize}_getItemCount(){return this.options.length+this.optionGroups.length}}return i.\u0275fac=function(){let t;return function(n){return(t||(t=Ki(i)))(n||i)}}(),i.\u0275cmp=ei({type:i,selectors:[["mat-select"]],contentQueries:function(e,n,r){if(1&e&&(Er(r,G1e,5),Er(r,Vb,5),Er(r,lN,5)),2&e){let s;jt(s=qt())&&(n.customTrigger=s.first),jt(s=qt())&&(n.options=s),jt(s=qt())&&(n.optionGroups=s)}},hostAttrs:["role","combobox","aria-autocomplete","none","aria-haspopup","true",1,"mat-select"],hostVars:20,hostBindings:function(e,n){1&e&&je("keydown",function(s){return n._handleKeydown(s)})("focus",function(){return n._onFocus()})("blur",function(){return n._onBlur()}),2&e&&(Vi("id",n.id)("tabindex",n.tabIndex)("aria-controls",n.panelOpen?n.id+"-panel":null)("aria-expanded",n.panelOpen)("aria-label",n.ariaLabel||null)("aria-required",n.required.toString())("aria-disabled",n.disabled.toString())("aria-invalid",n.errorState)("aria-describedby",n._ariaDescribedby||null)("aria-activedescendant",n._getAriaActiveDescendant()),N("mat-select-disabled",n.disabled)("mat-select-invalid",n.errorState)("mat-select-required",n.required)("mat-select-empty",n.empty)("mat-select-multiple",n.multiple))},inputs:{disabled:"disabled",disableRipple:"disableRipple",tabIndex:"tabIndex"},exportAs:["matSelect"],features:[Sn([{provide:ST,useExisting:i},{provide:aN,useExisting:i}]),It],ngContentSelectors:O1e,decls:9,vars:12,consts:[["cdk-overlay-origin","",1,"mat-select-trigger",3,"click"],["origin","cdkOverlayOrigin","trigger",""],[1,"mat-select-value",3,"ngSwitch"],["class","mat-select-placeholder mat-select-min-line",4,"ngSwitchCase"],["class","mat-select-value-text",3,"ngSwitch",4,"ngSwitchCase"],[1,"mat-select-arrow-wrapper"],[1,"mat-select-arrow"],["cdk-connected-overlay","","cdkConnectedOverlayLockPosition","","cdkConnectedOverlayHasBackdrop","","cdkConnectedOverlayBackdropClass","cdk-overlay-transparent-backdrop",3,"cdkConnectedOverlayPanelClass","cdkConnectedOverlayScrollStrategy","cdkConnectedOverlayOrigin","cdkConnectedOverlayOpen","cdkConnectedOverlayPositions","cdkConnectedOverlayMinWidth","cdkConnectedOverlayOffsetY","backdropClick","attach","detach"],[1,"mat-select-placeholder","mat-select-min-line"],[1,"mat-select-value-text",3,"ngSwitch"],["class","mat-select-min-line",4,"ngSwitchDefault"],[4,"ngSwitchCase"],[1,"mat-select-min-line"],[1,"mat-select-panel-wrap"],["role","listbox","tabindex","-1",3,"ngClass","keydown"],["panel",""]],template:function(e,n){if(1&e&&(As(L1e),Z(0,"div",0,1),je("click",function(){return n.toggle()}),Z(3,"div",2),Ue(4,D1e,2,1,"span",3),Ue(5,P1e,3,2,"span",4),J(),Z(6,"div",5),yt(7,"div",6),J()(),Ue(8,I1e,4,14,"ng-template",7),je("backdropClick",function(){return n.close()})("attach",function(){return n._onAttached()})("detach",function(){return n.close()})),2&e){const r=Yo(1);Vi("aria-owns",n.panelOpen?n.id+"-panel":null),se(3),fe("ngSwitch",n.empty),Vi("id",n._valueId),se(1),fe("ngSwitchCase",!0),se(1),fe("ngSwitchCase",!1),se(3),fe("cdkConnectedOverlayPanelClass",n._overlayPanelClass)("cdkConnectedOverlayScrollStrategy",n._scrollStrategy)("cdkConnectedOverlayOrigin",r)("cdkConnectedOverlayOpen",n.panelOpen)("cdkConnectedOverlayPositions",n._positions)("cdkConnectedOverlayMinWidth",null==n._triggerRect?null:n._triggerRect.width)("cdkConnectedOverlayOffsetY",n._offsetY)}},directives:[KW,Dw,AR,t6,QW,Cp],styles:['.mat-select{display:inline-block;width:100%;outline:none}.mat-select-trigger{display:inline-flex;align-items:center;cursor:pointer;position:relative;box-sizing:border-box;width:100%}.mat-select-disabled .mat-select-trigger{-webkit-user-select:none;user-select:none;cursor:default}.mat-select-value{width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.mat-select-value-text{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-select-arrow-wrapper{height:16px;flex-shrink:0;display:inline-flex;align-items:center}.mat-form-field-appearance-fill .mat-select-arrow-wrapper{transform:translateY(-50%)}.mat-form-field-appearance-outline .mat-select-arrow-wrapper{transform:translateY(-25%)}.mat-form-field-appearance-standard.mat-form-field-has-label .mat-select:not(.mat-select-empty) .mat-select-arrow-wrapper{transform:translateY(-50%)}.mat-form-field-appearance-standard .mat-select.mat-select-empty .mat-select-arrow-wrapper{transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}._mat-animation-noopable.mat-form-field-appearance-standard .mat-select.mat-select-empty .mat-select-arrow-wrapper{transition:none}.mat-select-arrow{width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:5px solid;margin:0 4px}.mat-form-field.mat-focused .mat-select-arrow{transform:translateX(0)}.mat-select-panel-wrap{flex-basis:100%}.mat-select-panel{min-width:112px;max-width:280px;overflow:auto;-webkit-overflow-scrolling:touch;padding-top:0;padding-bottom:0;max-height:256px;min-width:100%;border-radius:4px;outline:0}.cdk-high-contrast-active .mat-select-panel{outline:solid 1px}.mat-select-panel .mat-optgroup-label,.mat-select-panel .mat-option{font-size:inherit;line-height:3em;height:3em}.mat-form-field-type-mat-select:not(.mat-form-field-disabled) .mat-form-field-flex{cursor:pointer}.mat-form-field-type-mat-select .mat-form-field-label{width:calc(100% - 18px)}.mat-select-placeholder{transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}._mat-animation-noopable .mat-select-placeholder{transition:none}.mat-form-field-hide-placeholder .mat-select-placeholder{color:transparent;-webkit-text-fill-color:transparent;transition:none;display:block}.mat-select-min-line:empty::before{content:" ";white-space:pre;width:1px;display:inline-block;opacity:0}\n'],encapsulation:2,data:{animation:[tQ.transformPanelWrap,tQ.transformPanel]},changeDetection:0}),i})(),M4=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({providers:[V1e],imports:[[ka,Nb,Dk,jn],uy,WH,Dk,jn]}),i})();function yI(i){return"function"==typeof i}let T4=!1;const Qf={Promise:void 0,set useDeprecatedSynchronousErrorHandling(i){if(i){const t=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+t.stack)}else T4&&console.log("RxJS: Back to a better error behavior. Thank you. <3");T4=i},get useDeprecatedSynchronousErrorHandling(){return T4}};function wE(i){setTimeout(()=>{throw i},0)}const vI={closed:!0,next(i){},error(i){if(Qf.useDeprecatedSynchronousErrorHandling)throw i;wE(i)},complete(){}},j1e=Array.isArray||(i=>i&&"number"==typeof i.length),bI=(()=>{function i(t){return Error.call(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((e,n)=>`${n+1}) ${e.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t,this}return i.prototype=Object.create(Error.prototype),i})();class Bu{constructor(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._ctorUnsubscribe=!0,this._unsubscribe=t)}unsubscribe(){let t;if(this.closed)return;let{_parentOrParents:e,_ctorUnsubscribe:n,_unsubscribe:r,_subscriptions:s}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,e instanceof Bu)e.remove(this);else if(null!==e)for(let a=0;a<e.length;++a)e[a].remove(this);if(yI(r)){n&&(this._unsubscribe=void 0);try{r.call(this)}catch(a){t=a instanceof bI?sQ(a.errors):[a]}}if(j1e(s)){let a=-1,l=s.length;for(;++a<l;){const u=s[a];if(null!==(i=u)&&"object"==typeof i)try{u.unsubscribe()}catch(h){t=t||[],h instanceof bI?t=t.concat(sQ(h.errors)):t.push(h)}}}var i;if(t)throw new bI(t)}add(t){let e=t;if(!t)return Bu.EMPTY;switch(typeof t){case"function":e=new Bu(t);case"object":if(e===this||e.closed||"function"!=typeof e.unsubscribe)return e;if(this.closed)return e.unsubscribe(),e;if(!(e instanceof Bu)){const s=e;e=new Bu,e._subscriptions=[s]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}let{_parentOrParents:n}=e;if(null===n)e._parentOrParents=this;else if(n instanceof Bu){if(n===this)return e;e._parentOrParents=[n,this]}else{if(-1!==n.indexOf(this))return e;n.push(this)}const r=this._subscriptions;return null===r?this._subscriptions=[e]:r.push(e),e}remove(t){const e=this._subscriptions;if(e){const n=e.indexOf(t);-1!==n&&e.splice(n,1)}}}var i;function sQ(i){return i.reduce((t,e)=>t.concat(e instanceof bI?e.errors:e),[])}Bu.EMPTY=((i=new Bu).closed=!0,i);const xI="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random();class Wh extends Bu{constructor(t,e,n){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=vI;break;case 1:if(!t){this.destination=vI;break}if("object"==typeof t){t instanceof Wh?(this.syncErrorThrowable=t.syncErrorThrowable,this.destination=t,t.add(this)):(this.syncErrorThrowable=!0,this.destination=new oQ(this,t));break}default:this.syncErrorThrowable=!0,this.destination=new oQ(this,t,e,n)}}[xI](){return this}static create(t,e,n){const r=new Wh(t,e,n);return r.syncErrorThrowable=!1,r}next(t){this.isStopped||this._next(t)}error(t){this.isStopped||(this.isStopped=!0,this._error(t))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(t){this.destination.next(t)}_error(t){this.destination.error(t),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:t}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this}}class oQ extends Wh{constructor(t,e,n,r){super(),this._parentSubscriber=t;let s,a=this;yI(e)?s=e:e&&(s=e.next,n=e.error,r=e.complete,e!==vI&&(a=Object.create(e),yI(a.unsubscribe)&&this.add(a.unsubscribe.bind(a)),a.unsubscribe=this.unsubscribe.bind(this))),this._context=a,this._next=s,this._error=n,this._complete=r}next(t){if(!this.isStopped&&this._next){const{_parentSubscriber:e}=this;Qf.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}}error(t){if(!this.isStopped){const{_parentSubscriber:e}=this,{useDeprecatedSynchronousErrorHandling:n}=Qf;if(this._error)n&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)n?(e.syncErrorValue=t,e.syncErrorThrown=!0):wE(t),this.unsubscribe();else{if(this.unsubscribe(),n)throw t;wE(t)}}}complete(){if(!this.isStopped){const{_parentSubscriber:t}=this;if(this._complete){const e=()=>this._complete.call(this._context);Qf.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,e),this.unsubscribe()):(this.__tryOrUnsub(e),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(t,e){try{t.call(this._context,e)}catch(n){if(this.unsubscribe(),Qf.useDeprecatedSynchronousErrorHandling)throw n;wE(n)}}__tryOrSetError(t,e,n){if(!Qf.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,n)}catch(r){return Qf.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=r,t.syncErrorThrown=!0,!0):(wE(r),!0)}return!1}_unsubscribe(){const{_parentSubscriber:t}=this;this._context=null,this._parentSubscriber=null,t.unsubscribe()}}const Y1e="function"==typeof Symbol&&Symbol.observable||"@@observable";function K1e(i){return i}let lQ=(()=>{class i{constructor(e){this._isScalar=!1,e&&(this._subscribe=e)}lift(e){const n=new i;return n.source=this,n.operator=e,n}subscribe(e,n,r){const{operator:s}=this,a=function Z1e(i,t,e){if(i){if(i instanceof Wh)return i;if(i[xI])return i[xI]()}return i||t||e?new Wh(i,t,e):new Wh(vI)}(e,n,r);if(a.add(s?s.call(a,this.source):this.source||Qf.useDeprecatedSynchronousErrorHandling&&!a.syncErrorThrowable?this._subscribe(a):this._trySubscribe(a)),Qf.useDeprecatedSynchronousErrorHandling&&a.syncErrorThrowable&&(a.syncErrorThrowable=!1,a.syncErrorThrown))throw a.syncErrorValue;return a}_trySubscribe(e){try{return this._subscribe(e)}catch(n){Qf.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=n),function X1e(i){for(;i;){const{closed:t,destination:e,isStopped:n}=i;if(t||n)return!1;i=e&&e instanceof Wh?e:null}return!0}(e)?e.error(n):console.warn(n)}}forEach(e,n){return new(n=cQ(n))((r,s)=>{let a;a=this.subscribe(l=>{try{e(l)}catch(u){s(u),a&&a.unsubscribe()}},s,r)})}_subscribe(e){const{source:n}=this;return n&&n.subscribe(e)}[Y1e](){return this}pipe(...e){return 0===e.length?this:function aQ(i){return 0===i.length?K1e:1===i.length?i[0]:function(e){return i.reduce((n,r)=>r(n),e)}}(e)(this)}toPromise(e){return new(e=cQ(e))((n,r)=>{let s;this.subscribe(a=>s=a,a=>r(a),()=>n(s))})}}return i.create=t=>new i(t),i})();function cQ(i){if(i||(i=Qf.Promise||Promise),!i)throw new Error("no Promise impl found");return i}const SE=(()=>{function i(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return i.prototype=Object.create(Error.prototype),i})();class Q1e extends Bu{constructor(t,e){super(),this.subject=t,this.subscriber=e,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const t=this.subject,e=t.observers;if(this.subject=null,!e||0===e.length||t.isStopped||t.closed)return;const n=e.indexOf(this.subscriber);-1!==n&&e.splice(n,1)}}class J1e extends Wh{constructor(t){super(t),this.destination=t}}let CE=(()=>{class i extends lQ{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[xI](){return new J1e(this)}lift(e){const n=new uQ(this,this);return n.operator=e,n}next(e){if(this.closed)throw new SE;if(!this.isStopped){const{observers:n}=this,r=n.length,s=n.slice();for(let a=0;a<r;a++)s[a].next(e)}}error(e){if(this.closed)throw new SE;this.hasError=!0,this.thrownError=e,this.isStopped=!0;const{observers:n}=this,r=n.length,s=n.slice();for(let a=0;a<r;a++)s[a].error(e);this.observers.length=0}complete(){if(this.closed)throw new SE;this.isStopped=!0;const{observers:e}=this,n=e.length,r=e.slice();for(let s=0;s<n;s++)r[s].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(e){if(this.closed)throw new SE;return super._trySubscribe(e)}_subscribe(e){if(this.closed)throw new SE;return this.hasError?(e.error(this.thrownError),Bu.EMPTY):this.isStopped?(e.complete(),Bu.EMPTY):(this.observers.push(e),new Q1e(this,e))}asObservable(){const e=new lQ;return e.source=this,e}}return i.create=(t,e)=>new uQ(t,e),i})();class uQ extends CE{constructor(t,e){super(),this.destination=t,this.source=e}next(t){const{destination:e}=this;e&&e.next&&e.next(t)}error(t){const{destination:e}=this;e&&e.error&&this.destination.error(t)}complete(){const{destination:t}=this;t&&t.complete&&this.destination.complete()}_subscribe(t){const{source:e}=this;return e?this.source.subscribe(t):Bu.EMPTY}}class $1e extends Bu{constructor(t,e){super()}schedule(t,e=0){return this}}let hQ=(()=>{class i{constructor(e,n=i.now){this.SchedulerAction=e,this.now=n}schedule(e,n=0,r){return new this.SchedulerAction(this,e).schedule(r,n)}}return i.now=()=>Date.now(),i})();class qy extends hQ{constructor(t,e=hQ.now){super(t,()=>qy.delegate&&qy.delegate!==this?qy.delegate.now():e()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(t,e=0,n){return qy.delegate&&qy.delegate!==this?qy.delegate.schedule(t,e,n):super.schedule(t,e,n)}flush(t){const{actions:e}=this;if(this.active)return void e.push(t);let n;this.active=!0;do{if(n=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,n){for(;t=e.shift();)t.unsubscribe();throw n}}}const tTe=new qy(class eTe extends $1e{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){if(this.closed)return this;this.state=t;const n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(r,this.id,e),this}requestAsyncId(t,e,n=0){return setInterval(t.flush.bind(t,this),n)}recycleAsyncId(t,e,n=0){if(null!==n&&this.delay===n&&!1===this.pending)return e;clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(t,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let r,n=!1;try{this.work(t)}catch(s){n=!0,r=!!s&&s||new Error(s)}if(n)return this.unsubscribe(),r}_unsubscribe(){const t=this.id,e=this.scheduler,n=e.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null}}),dQ={leading:!0,trailing:!1};function fQ(i,t=tTe,e=dQ){return n=>n.lift(new rTe(i,t,e.leading,e.trailing))}class rTe{constructor(t,e,n,r){this.duration=t,this.scheduler=e,this.leading=n,this.trailing=r}call(t,e){return e.subscribe(new sTe(t,this.duration,this.scheduler,this.leading,this.trailing))}}class sTe extends Wh{constructor(t,e,n,r,s){super(t),this.duration=e,this.scheduler=n,this.leading=r,this.trailing=s,this._hasTrailingValue=!1,this._trailingValue=null}_next(t){this.throttled?this.trailing&&(this._trailingValue=t,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(oTe,this.duration,{subscriber:this})),this.leading?this.destination.next(t):this.trailing&&(this._trailingValue=t,this._hasTrailingValue=!0))}_complete(){this._hasTrailingValue?(this.destination.next(this._trailingValue),this.destination.complete()):this.destination.complete()}clearThrottle(){const t=this.throttled;t&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),t.unsubscribe(),this.remove(t),this.throttled=null)}}function oTe(i){const{subscriber:t}=i;t.clearThrottle()}function Xy(){}function pQ(i,t,e){return function(r){return r.lift(new aTe(i,t,e))}}class aTe{constructor(t,e,n){this.nextOrObserver=t,this.error=e,this.complete=n}call(t,e){return e.subscribe(new lTe(t,this.nextOrObserver,this.error,this.complete))}}class lTe extends Wh{constructor(t,e,n,r){super(t),this._tapNext=Xy,this._tapError=Xy,this._tapComplete=Xy,this._tapError=n||Xy,this._tapComplete=r||Xy,yI(e)?(this._context=this,this._tapNext=e):e&&(this._context=e,this._tapNext=e.next||Xy,this._tapError=e.error||Xy,this._tapComplete=e.complete||Xy)}_next(t){try{this._tapNext.call(this._context,t)}catch(e){return void this.destination.error(e)}this.destination.next(t)}_error(t){try{this._tapError.call(this._context,t)}catch(e){return void this.destination.error(e)}this.destination.error(t)}_complete(){try{this._tapComplete.call(this._context)}catch(t){return void this.destination.error(t)}return this.destination.complete()}}function mQ(i,t){return e=>e.lift(new cTe(i,t))}class cTe{constructor(t,e){this.compare=t,this.keySelector=e}call(t,e){return e.subscribe(new uTe(t,this.compare,this.keySelector))}}class uTe extends Wh{constructor(t,e,n){super(t),this.keySelector=n,this.hasKey=!1,"function"==typeof e&&(this.compare=e)}compare(t,e){return t===e}_next(t){let e;try{const{keySelector:r}=this;e=r?r(t):t}catch(r){return this.destination.error(r)}let n=!1;if(this.hasKey)try{const{compare:r}=this;n=r(this.key,e)}catch(r){return this.destination.error(r)}else this.hasKey=!0;n||(this.key=e,this.destination.next(t))}}class dTe{constructor(t,e){this.predicate=t,this.thisArg=e}call(t,e){return e.subscribe(new fTe(t,this.predicate,this.thisArg))}}class fTe extends Wh{constructor(t,e,n){super(t),this.predicate=e,this.thisArg=n,this.count=0}_next(t){let e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(n){return void this.destination.error(n)}e&&this.destination.next(t)}}var jh="undefined"!=typeof window?window:{screen:{},navigator:{}},lC=(jh.matchMedia||function(){return{matches:!1}}).bind(jh),gQ=!1,_Q=function(){};jh.addEventListener&&jh.addEventListener("p",_Q,{get passive(){return gQ=!0}}),jh.removeEventListener&&jh.removeEventListener("p",_Q,!1);var yQ=gQ,E4="ontouchstart"in jh,bQ=(E4||"TouchEvent"in jh&&lC("(any-pointer: coarse)"),jh.navigator.userAgent||"");lC("(pointer: coarse)").matches&&/iPad|Macintosh/.test(bQ)&&Math.min(jh.screen.width||0,jh.screen.height||0);(lC("(pointer: coarse)").matches||!lC("(pointer: fine)").matches&&E4)&&/Windows.*Firefox/.test(bQ),lC("(any-pointer: fine)").matches||lC("(any-hover: hover)");const vTe=["tooltipTemplate"],bTe=["leftOuterSelectionBar"],xTe=["rightOuterSelectionBar"],wTe=["fullBar"],STe=["selectionBar"],CTe=["minHandle"],MTe=["maxHandle"],TTe=["floorLabel"],ETe=["ceilLabel"],ATe=["minHandleLabel"],DTe=["maxHandleLabel"],RTe=["combinedLabel"],kTe=["ticksElement"];function PTe(i,t){if(1&i&&yt(0,"ngx-slider-tooltip-wrapper",31),2&i){const e=Re().$implicit;fe("template",Re().tooltipTemplate)("tooltip",e.valueTooltip)("placement",e.valueTooltipPlacement)("content",e.value)}}function ITe(i,t){1&i&&yt(0,"span",32),2&i&&fe("innerHTML",Re().$implicit.legend,Lv)}const LTe=function(i){return{"ngx-slider-selected":i}};function OTe(i,t){if(1&i&&(Z(0,"span",27),yt(1,"ngx-slider-tooltip-wrapper",28),Ue(2,PTe,1,4,"ngx-slider-tooltip-wrapper",29),Ue(3,ITe,1,1,"span",30),J()),2&i){const e=t.$implicit,n=Re();fe("ngClass",yb(7,LTe,e.selected))("ngStyle",e.style),se(1),fe("template",n.tooltipTemplate)("tooltip",e.tooltip)("placement",e.tooltipPlacement),se(1),fe("ngIf",null!=e.value),se(1),fe("ngIf",null!=e.legend)}}function FTe(i,t){}function BTe(i,t){1&i&&Ue(0,FTe,0,0,"ng-template")}const NTe=function(i,t,e){return{tooltip:i,placement:t,content:e}};function HTe(i,t){if(1&i&&(Wo(0),Ue(1,BTe,1,0,null,1),jo()),2&i){const e=Re();se(1),fe("ngTemplateOutlet",e.template)("ngTemplateOutletContext",function BU(i,t,e,n,r,s){return VU(Di(),Vl(),i,t,e,n,r,s)}(2,NTe,e.tooltip,e.placement,e.content))}}function VTe(i,t){if(1&i&&(Wo(0),Z(1,"div",2),ue(2),J(),jo()),2&i){const e=Re();se(1),Vi("title",e.tooltip)("data-tooltip-placement",e.placement),se(1),ui(" ",e.content," ")}}const gc={Low:0,High:1,Floor:2,Ceil:3,TickValue:4};gc[gc.Low]="Low",gc[gc.High]="High",gc[gc.Floor]="Floor",gc[gc.Ceil]="Ceil",gc[gc.TickValue]="TickValue";class wI{constructor(){this.floor=0,this.ceil=null,this.step=1,this.minRange=null,this.maxRange=null,this.pushRange=!1,this.minLimit=null,this.maxLimit=null,this.translate=null,this.combineLabels=null,this.getLegend=null,this.getStepLegend=null,this.stepsArray=null,this.bindIndexForStepsArray=!1,this.draggableRange=!1,this.draggableRangeOnly=!1,this.showSelectionBar=!1,this.showSelectionBarEnd=!1,this.showSelectionBarFromValue=null,this.showOuterSelectionBars=!1,this.hidePointerLabels=!1,this.hideLimitLabels=!1,this.autoHideLimitLabels=!0,this.readOnly=!1,this.disabled=!1,this.showTicks=!1,this.showTicksValues=!1,this.tickStep=null,this.tickValueStep=null,this.ticksArray=null,this.ticksTooltip=null,this.ticksValuesTooltip=null,this.vertical=!1,this.getSelectionBarColor=null,this.getTickColor=null,this.getPointerColor=null,this.keyboardSupport=!0,this.scale=1,this.rotate=0,this.enforceStep=!0,this.enforceRange=!0,this.enforceStepsArray=!0,this.noSwitching=!1,this.onlyBindHandles=!1,this.rightToLeft=!1,this.reversedControls=!1,this.boundPointerLabels=!0,this.logScale=!1,this.customValueToPosition=null,this.customPositionToValue=null,this.precisionLimit=12,this.selectionBarGradient=null,this.ariaLabel="ngx-slider",this.ariaLabelledBy=null,this.ariaLabelHigh="ngx-slider-max",this.ariaLabelledByHigh=null,this.handleDimension=null,this.barDimension=null,this.animate=!0,this.animateOnMove=!1}}const In={Min:0,Max:1};In[In.Min]="Min",In[In.Max]="Max";class zTe{}class Pi{static isNullOrUndefined(t){return null==t}static areArraysEqual(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}static linearValueToPosition(t,e,n){return(t-e)/(n-e)}static logValueToPosition(t,e,n){return((t=Math.log(t))-(e=Math.log(e)))/((n=Math.log(n))-e)}static linearPositionToValue(t,e,n){return t*(n-e)+e}static logPositionToValue(t,e,n){return e=Math.log(e),n=Math.log(n),Math.exp(t*(n-e)+e)}static findStepIndex(t,e){const n=e.map(s=>Math.abs(t-s.value));let r=0;for(let s=0;s<e.length;s++)n[s]!==n[r]&&n[s]<n[r]&&(r=s);return r}}class Zy{static isTouchEvent(t){return void 0!==window.TouchEvent?t instanceof TouchEvent:void 0!==t.touches}static isResizeObserverAvailable(){return void 0!==window.ResizeObserver}}class Il{static roundToPrecisionLimit(t,e){return+t.toPrecision(e)}static isModuloWithinPrecisionLimit(t,e,n){const r=Math.pow(10,-n);return Math.abs(t%e)<=r||Math.abs(Math.abs(t%e)-e)<=r}static clampToRange(t,e,n){return Math.min(Math.max(t,e),n)}}class SQ{constructor(){this.eventName=null,this.events=null,this.eventsSubscription=null,this.teardownCallback=null}}class CQ{constructor(t){this.renderer=t}attachPassiveEventListener(t,e,n,r){if(!0!==yQ)return this.attachEventListener(t,e,n,r);const s=new SQ;s.eventName=e,s.events=new CE;const a=l=>{s.events.next(l)};return t.addEventListener(e,a,{passive:!0,capture:!1}),s.teardownCallback=()=>{t.removeEventListener(e,a,{passive:!0,capture:!1})},s.eventsSubscription=s.events.pipe(Pi.isNullOrUndefined(r)?pQ(()=>{}):fQ(r,void 0,{leading:!0,trailing:!0})).subscribe(l=>{n(l)}),s}detachEventListener(t){Pi.isNullOrUndefined(t.eventsSubscription)||(t.eventsSubscription.unsubscribe(),t.eventsSubscription=null),Pi.isNullOrUndefined(t.events)||(t.events.complete(),t.events=null),Pi.isNullOrUndefined(t.teardownCallback)||(t.teardownCallback(),t.teardownCallback=null)}attachEventListener(t,e,n,r){const s=new SQ;return s.eventName=e,s.events=new CE,s.teardownCallback=this.renderer.listen(t,e,l=>{s.events.next(l)}),s.eventsSubscription=s.events.pipe(Pi.isNullOrUndefined(r)?pQ(()=>{}):fQ(r,void 0,{leading:!0,trailing:!0})).subscribe(l=>{n(l)}),s}}let Yy=(()=>{class i{constructor(e,n,r){this.elemRef=e,this.renderer=n,this.changeDetectionRef=r,this._position=0,this._dimension=0,this._alwaysHide=!1,this._vertical=!1,this._scale=1,this._rotate=0,this.opacity=1,this.visibility="visible",this.left="",this.bottom="",this.height="",this.width="",this.transform="",this.eventListeners=[],this.eventListenerHelper=new CQ(this.renderer)}get position(){return this._position}get dimension(){return this._dimension}get alwaysHide(){return this._alwaysHide}get vertical(){return this._vertical}get scale(){return this._scale}get rotate(){return this._rotate}setAlwaysHide(e){this._alwaysHide=e,this.visibility=e?"hidden":"visible"}hide(){this.opacity=0}show(){this.alwaysHide||(this.opacity=1)}isVisible(){return!this.alwaysHide&&0!==this.opacity}setVertical(e){this._vertical=e,this._vertical?(this.left="",this.width=""):(this.bottom="",this.height="")}setScale(e){this._scale=e}setRotate(e){this._rotate=e,this.transform="rotate("+e+"deg)"}getRotate(){return this._rotate}setPosition(e){this._position!==e&&!this.isRefDestroyed()&&this.changeDetectionRef.markForCheck(),this._position=e,this._vertical?this.bottom=Math.round(e)+"px":this.left=Math.round(e)+"px"}calculateDimension(){const e=this.getBoundingClientRect();this._dimension=this.vertical?(e.bottom-e.top)*this.scale:(e.right-e.left)*this.scale}setDimension(e){this._dimension!==e&&!this.isRefDestroyed()&&this.changeDetectionRef.markForCheck(),this._dimension=e,this._vertical?this.height=Math.round(e)+"px":this.width=Math.round(e)+"px"}getBoundingClientRect(){return this.elemRef.nativeElement.getBoundingClientRect()}on(e,n,r){const s=this.eventListenerHelper.attachEventListener(this.elemRef.nativeElement,e,n,r);this.eventListeners.push(s)}onPassive(e,n,r){const s=this.eventListenerHelper.attachPassiveEventListener(this.elemRef.nativeElement,e,n,r);this.eventListeners.push(s)}off(e){let n,r;Pi.isNullOrUndefined(e)?(n=[],r=this.eventListeners):(n=this.eventListeners.filter(s=>s.eventName!==e),r=this.eventListeners.filter(s=>s.eventName===e));for(const s of r)this.eventListenerHelper.detachEventListener(s);this.eventListeners=n}isRefDestroyed(){return Pi.isNullOrUndefined(this.changeDetectionRef)||this.changeDetectionRef.destroyed}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(nu),B(Pn))},i.\u0275dir=Be({type:i,selectors:[["","ngxSliderElement",""]],hostVars:14,hostBindings:function(e,n){2&e&&A("opacity",n.opacity)("visibility",n.visibility)("left",n.left)("bottom",n.bottom)("height",n.height)("width",n.width)("transform",n.transform)}}),i})(),A4=(()=>{class i extends Yy{constructor(e,n,r){super(e,n,r),this.active=!1,this.role="",this.tabindex="",this.ariaOrientation="",this.ariaLabel="",this.ariaLabelledBy="",this.ariaValueNow="",this.ariaValueText="",this.ariaValueMin="",this.ariaValueMax=""}focus(){this.elemRef.nativeElement.focus()}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(nu),B(Pn))},i.\u0275dir=Be({type:i,selectors:[["","ngxSliderHandle",""]],hostVars:11,hostBindings:function(e,n){2&e&&(Vi("role",n.role)("tabindex",n.tabindex)("aria-orientation",n.ariaOrientation)("aria-label",n.ariaLabel)("aria-labelledby",n.ariaLabelledBy)("aria-valuenow",n.ariaValueNow)("aria-valuetext",n.ariaValueText)("aria-valuemin",n.ariaValueMin)("aria-valuemax",n.ariaValueMax),N("ngx-slider-active",n.active))},features:[It]}),i})(),cC=(()=>{class i extends Yy{constructor(e,n,r){super(e,n,r),this._value=null}get value(){return this._value}setValue(e){let n=!1;!this.alwaysHide&&(Pi.isNullOrUndefined(this.value)||this.value.length!==e.length||this.value.length>0&&0===this.dimension)&&(n=!0),this._value=e,this.elemRef.nativeElement.innerHTML=e,n&&this.calculateDimension()}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(nu),B(Pn))},i.\u0275dir=Be({type:i,selectors:[["","ngxSliderLabel",""]],features:[It]}),i})();class UTe{constructor(){this.selected=!1,this.style={},this.tooltip=null,this.tooltipPlacement=null,this.value=null,this.valueTooltip=null,this.valueTooltipPlacement=null,this.legend=null}}class MQ{constructor(){this.active=!1,this.value=0,this.difference=0,this.position=0,this.lowLimit=0,this.highLimit=0}}class SI{static compare(t,e){return!(Pi.isNullOrUndefined(t)&&Pi.isNullOrUndefined(e)||Pi.isNullOrUndefined(t)!==Pi.isNullOrUndefined(e))&&t.value===e.value&&t.highValue===e.highValue}}class TQ extends SI{static compare(t,e){return!(Pi.isNullOrUndefined(t)&&Pi.isNullOrUndefined(e)||Pi.isNullOrUndefined(t)!==Pi.isNullOrUndefined(e))&&t.value===e.value&&t.highValue===e.highValue&&t.forceChange===e.forceChange}}const GTe={provide:Ac,useExisting:rs(()=>EQ),multi:!0};let EQ=(()=>{class i{constructor(e,n,r,s){this.renderer=e,this.elementRef=n,this.changeDetectionRef=r,this.zone=s,this.value=null,this.valueChange=new Si,this.highValue=null,this.highValueChange=new Si,this.options=new wI,this.userChangeStart=new Si,this.userChange=new Si,this.userChangeEnd=new Si,this.initHasRun=!1,this.inputModelChangeSubject=new CE,this.inputModelChangeSubscription=null,this.outputModelChangeSubject=new CE,this.outputModelChangeSubscription=null,this.viewLowValue=null,this.viewHighValue=null,this.viewOptions=new wI,this.handleHalfDimension=0,this.maxHandlePosition=0,this.currentTrackingPointer=null,this.currentFocusPointer=null,this.firstKeyDown=!1,this.touchId=null,this.dragging=new MQ,this.sliderElementVerticalClass=!1,this.sliderElementAnimateClass=!1,this.sliderElementWithLegendClass=!1,this.sliderElementDisabledAttr=null,this.sliderElementAriaLabel="ngx-slider",this.barStyle={},this.minPointerStyle={},this.maxPointerStyle={},this.fullBarTransparentClass=!1,this.selectionBarDraggableClass=!1,this.ticksUnderValuesClass=!1,this.intermediateTicks=!1,this.ticks=[],this.eventListenerHelper=null,this.onMoveEventListener=null,this.onEndEventListener=null,this.moving=!1,this.resizeObserver=null,this.onTouchedCallback=null,this.onChangeCallback=null,this.eventListenerHelper=new CQ(this.renderer)}set manualRefresh(e){this.unsubscribeManualRefresh(),this.manualRefreshSubscription=e.subscribe(()=>{setTimeout(()=>this.calculateViewDimensionsAndDetectChanges())})}set triggerFocus(e){this.unsubscribeTriggerFocus(),this.triggerFocusSubscription=e.subscribe(n=>{this.focusPointer(n)})}get range(){return!Pi.isNullOrUndefined(this.value)&&!Pi.isNullOrUndefined(this.highValue)}get showTicks(){return this.viewOptions.showTicks}ngOnInit(){this.viewOptions=new wI,Object.assign(this.viewOptions,this.options),this.updateDisabledState(),this.updateVerticalState(),this.updateAriaLabel()}ngAfterViewInit(){this.applyOptions(),this.subscribeInputModelChangeSubject(),this.subscribeOutputModelChangeSubject(),this.renormaliseModelValues(),this.viewLowValue=this.modelValueToViewValue(this.value),this.viewHighValue=this.range?this.modelValueToViewValue(this.highValue):null,this.updateVerticalState(),this.manageElementsStyle(),this.updateDisabledState(),this.calculateViewDimensions(),this.addAccessibility(),this.updateCeilLabel(),this.updateFloorLabel(),this.initHandles(),this.manageEventsBindings(),this.updateAriaLabel(),this.subscribeResizeObserver(),this.initHasRun=!0,this.isRefDestroyed()||this.changeDetectionRef.detectChanges()}ngOnChanges(e){!Pi.isNullOrUndefined(e.options)&&JSON.stringify(e.options.previousValue)!==JSON.stringify(e.options.currentValue)&&this.onChangeOptions(),(!Pi.isNullOrUndefined(e.value)||!Pi.isNullOrUndefined(e.highValue))&&this.inputModelChangeSubject.next({value:this.value,highValue:this.highValue,forceChange:!1,internalChange:!1})}ngOnDestroy(){this.unbindEvents(),this.unsubscribeResizeObserver(),this.unsubscribeInputModelChangeSubject(),this.unsubscribeOutputModelChangeSubject(),this.unsubscribeManualRefresh(),this.unsubscribeTriggerFocus()}writeValue(e){e instanceof Array?(this.value=e[0],this.highValue=e[1]):this.value=e,this.inputModelChangeSubject.next({value:this.value,highValue:this.highValue,forceChange:!1,internalChange:!1})}registerOnChange(e){this.onChangeCallback=e}registerOnTouched(e){this.onTouchedCallback=e}setDisabledState(e){this.viewOptions.disabled=e,this.updateDisabledState()}setAriaLabel(e){this.viewOptions.ariaLabel=e,this.updateAriaLabel()}onResize(e){this.calculateViewDimensionsAndDetectChanges()}subscribeInputModelChangeSubject(){this.inputModelChangeSubscription=this.inputModelChangeSubject.pipe(mQ(TQ.compare),function hTe(i,t){return function(n){return n.lift(new dTe(i,t))}}(e=>!e.forceChange&&!e.internalChange)).subscribe(e=>this.applyInputModelChange(e))}subscribeOutputModelChangeSubject(){this.outputModelChangeSubscription=this.outputModelChangeSubject.pipe(mQ(TQ.compare)).subscribe(e=>this.publishOutputModelChange(e))}subscribeResizeObserver(){Zy.isResizeObserverAvailable()&&(this.resizeObserver=new ResizeObserver(()=>this.calculateViewDimensionsAndDetectChanges()),this.resizeObserver.observe(this.elementRef.nativeElement))}unsubscribeResizeObserver(){Zy.isResizeObserverAvailable()&&null!==this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null)}unsubscribeOnMove(){Pi.isNullOrUndefined(this.onMoveEventListener)||(this.eventListenerHelper.detachEventListener(this.onMoveEventListener),this.onMoveEventListener=null)}unsubscribeOnEnd(){Pi.isNullOrUndefined(this.onEndEventListener)||(this.eventListenerHelper.detachEventListener(this.onEndEventListener),this.onEndEventListener=null)}unsubscribeInputModelChangeSubject(){Pi.isNullOrUndefined(this.inputModelChangeSubscription)||(this.inputModelChangeSubscription.unsubscribe(),this.inputModelChangeSubscription=null)}unsubscribeOutputModelChangeSubject(){Pi.isNullOrUndefined(this.outputModelChangeSubscription)||(this.outputModelChangeSubscription.unsubscribe(),this.outputModelChangeSubscription=null)}unsubscribeManualRefresh(){Pi.isNullOrUndefined(this.manualRefreshSubscription)||(this.manualRefreshSubscription.unsubscribe(),this.manualRefreshSubscription=null)}unsubscribeTriggerFocus(){Pi.isNullOrUndefined(this.triggerFocusSubscription)||(this.triggerFocusSubscription.unsubscribe(),this.triggerFocusSubscription=null)}getPointerElement(e){return e===In.Min?this.minHandleElement:e===In.Max?this.maxHandleElement:null}getCurrentTrackingValue(){return this.currentTrackingPointer===In.Min?this.viewLowValue:this.currentTrackingPointer===In.Max?this.viewHighValue:null}modelValueToViewValue(e){return Pi.isNullOrUndefined(e)?NaN:Pi.isNullOrUndefined(this.viewOptions.stepsArray)||this.viewOptions.bindIndexForStepsArray?+e:Pi.findStepIndex(+e,this.viewOptions.stepsArray)}viewValueToModelValue(e){return Pi.isNullOrUndefined(this.viewOptions.stepsArray)||this.viewOptions.bindIndexForStepsArray?e:this.getStepValue(e)}getStepValue(e){const n=this.viewOptions.stepsArray[e];return Pi.isNullOrUndefined(n)?NaN:n.value}applyViewChange(){this.value=this.viewValueToModelValue(this.viewLowValue),this.range&&(this.highValue=this.viewValueToModelValue(this.viewHighValue)),this.outputModelChangeSubject.next({value:this.value,highValue:this.highValue,userEventInitiated:!0,forceChange:!1}),this.inputModelChangeSubject.next({value:this.value,highValue:this.highValue,forceChange:!1,internalChange:!0})}applyInputModelChange(e){const n=this.normaliseModelValues(e),r=!SI.compare(e,n);r&&(this.value=n.value,this.highValue=n.highValue),this.viewLowValue=this.modelValueToViewValue(n.value),this.viewHighValue=this.range?this.modelValueToViewValue(n.highValue):null,this.updateLowHandle(this.valueToPosition(this.viewLowValue)),this.range&&this.updateHighHandle(this.valueToPosition(this.viewHighValue)),this.updateSelectionBar(),this.updateTicksScale(),this.updateAriaAttributes(),this.range&&this.updateCombinedLabel(),this.outputModelChangeSubject.next({value:n.value,highValue:n.highValue,forceChange:r,userEventInitiated:!1})}publishOutputModelChange(e){const n=()=>{this.valueChange.emit(e.value),this.range&&this.highValueChange.emit(e.highValue),Pi.isNullOrUndefined(this.onChangeCallback)||this.onChangeCallback(this.range?[e.value,e.highValue]:e.value),Pi.isNullOrUndefined(this.onTouchedCallback)||this.onTouchedCallback(this.range?[e.value,e.highValue]:e.value)};e.userEventInitiated?(n(),this.userChange.emit(this.getChangeContext())):setTimeout(()=>{n()})}normaliseModelValues(e){const n=new SI;if(n.value=e.value,n.highValue=e.highValue,!Pi.isNullOrUndefined(this.viewOptions.stepsArray)){if(this.viewOptions.enforceStepsArray){const r=Pi.findStepIndex(n.value,this.viewOptions.stepsArray);if(n.value=this.viewOptions.stepsArray[r].value,this.range){const s=Pi.findStepIndex(n.highValue,this.viewOptions.stepsArray);n.highValue=this.viewOptions.stepsArray[s].value}}return n}if(this.viewOptions.enforceStep&&(n.value=this.roundStep(n.value),this.range&&(n.highValue=this.roundStep(n.highValue))),this.viewOptions.enforceRange&&(n.value=Il.clampToRange(n.value,this.viewOptions.floor,this.viewOptions.ceil),this.range&&(n.highValue=Il.clampToRange(n.highValue,this.viewOptions.floor,this.viewOptions.ceil)),this.range&&e.value>e.highValue))if(this.viewOptions.noSwitching)n.value=n.highValue;else{const r=e.value;n.value=e.highValue,n.highValue=r}return n}renormaliseModelValues(){const e={value:this.value,highValue:this.highValue},n=this.normaliseModelValues(e);SI.compare(n,e)||(this.value=n.value,this.highValue=n.highValue,this.outputModelChangeSubject.next({value:this.value,highValue:this.highValue,forceChange:!0,userEventInitiated:!1}))}onChangeOptions(){if(!this.initHasRun)return;const e=this.getOptionsInfluencingEventBindings(this.viewOptions);this.applyOptions();const n=this.getOptionsInfluencingEventBindings(this.viewOptions),r=!Pi.areArraysEqual(e,n);this.renormaliseModelValues(),this.viewLowValue=this.modelValueToViewValue(this.value),this.viewHighValue=this.range?this.modelValueToViewValue(this.highValue):null,this.resetSlider(r)}applyOptions(){if(this.viewOptions=new wI,Object.assign(this.viewOptions,this.options),this.viewOptions.draggableRange=this.range&&this.viewOptions.draggableRange,this.viewOptions.draggableRangeOnly=this.range&&this.viewOptions.draggableRangeOnly,this.viewOptions.draggableRangeOnly&&(this.viewOptions.draggableRange=!0),this.viewOptions.showTicks=this.viewOptions.showTicks||this.viewOptions.showTicksValues||!Pi.isNullOrUndefined(this.viewOptions.ticksArray),this.viewOptions.showTicks&&(!Pi.isNullOrUndefined(this.viewOptions.tickStep)||!Pi.isNullOrUndefined(this.viewOptions.ticksArray))&&(this.intermediateTicks=!0),this.viewOptions.showSelectionBar=this.viewOptions.showSelectionBar||this.viewOptions.showSelectionBarEnd||!Pi.isNullOrUndefined(this.viewOptions.showSelectionBarFromValue),Pi.isNullOrUndefined(this.viewOptions.stepsArray)?this.applyFloorCeilOptions():this.applyStepsArrayOptions(),Pi.isNullOrUndefined(this.viewOptions.combineLabels)&&(this.viewOptions.combineLabels=(e,n)=>e+" - "+n),this.viewOptions.logScale&&0===this.viewOptions.floor)throw Error("Can't use floor=0 with logarithmic scale")}applyStepsArrayOptions(){this.viewOptions.floor=0,this.viewOptions.ceil=this.viewOptions.stepsArray.length-1,this.viewOptions.step=1,Pi.isNullOrUndefined(this.viewOptions.translate)&&(this.viewOptions.translate=e=>String(this.viewOptions.bindIndexForStepsArray?this.getStepValue(e):e))}applyFloorCeilOptions(){if(Pi.isNullOrUndefined(this.viewOptions.step)?this.viewOptions.step=1:(this.viewOptions.step=+this.viewOptions.step,this.viewOptions.step<=0&&(this.viewOptions.step=1)),Pi.isNullOrUndefined(this.viewOptions.ceil)||Pi.isNullOrUndefined(this.viewOptions.floor))throw Error("floor and ceil options must be supplied");this.viewOptions.ceil=+this.viewOptions.ceil,this.viewOptions.floor=+this.viewOptions.floor,Pi.isNullOrUndefined(this.viewOptions.translate)&&(this.viewOptions.translate=e=>String(e))}resetSlider(e=!0){this.manageElementsStyle(),this.addAccessibility(),this.updateCeilLabel(),this.updateFloorLabel(),e&&(this.unbindEvents(),this.manageEventsBindings()),this.updateDisabledState(),this.updateAriaLabel(),this.calculateViewDimensions(),this.refocusPointerIfNeeded()}focusPointer(e){e!==In.Min&&e!==In.Max&&(e=In.Min),e===In.Min?this.minHandleElement.focus():this.range&&e===In.Max&&this.maxHandleElement.focus()}refocusPointerIfNeeded(){Pi.isNullOrUndefined(this.currentFocusPointer)||(this.onPointerFocus(this.currentFocusPointer),this.getPointerElement(this.currentFocusPointer).focus())}manageElementsStyle(){this.updateScale(),this.floorLabelElement.setAlwaysHide(this.viewOptions.showTicksValues||this.viewOptions.hideLimitLabels),this.ceilLabelElement.setAlwaysHide(this.viewOptions.showTicksValues||this.viewOptions.hideLimitLabels);const e=this.viewOptions.showTicksValues&&!this.intermediateTicks;this.minHandleLabelElement.setAlwaysHide(e||this.viewOptions.hidePointerLabels),this.maxHandleLabelElement.setAlwaysHide(e||!this.range||this.viewOptions.hidePointerLabels),this.combinedLabelElement.setAlwaysHide(e||!this.range||this.viewOptions.hidePointerLabels),this.selectionBarElement.setAlwaysHide(!this.range&&!this.viewOptions.showSelectionBar),this.leftOuterSelectionBarElement.setAlwaysHide(!this.range||!this.viewOptions.showOuterSelectionBars),this.rightOuterSelectionBarElement.setAlwaysHide(!this.range||!this.viewOptions.showOuterSelectionBars),this.fullBarTransparentClass=this.range&&this.viewOptions.showOuterSelectionBars,this.selectionBarDraggableClass=this.viewOptions.draggableRange&&!this.viewOptions.onlyBindHandles,this.ticksUnderValuesClass=this.intermediateTicks&&this.options.showTicksValues,this.sliderElementVerticalClass!==this.viewOptions.vertical&&(this.updateVerticalState(),setTimeout(()=>{this.resetSlider()})),this.sliderElementAnimateClass!==this.viewOptions.animate&&setTimeout(()=>{this.sliderElementAnimateClass=this.viewOptions.animate}),this.updateRotate()}manageEventsBindings(){this.viewOptions.disabled||this.viewOptions.readOnly?this.unbindEvents():this.bindEvents()}updateDisabledState(){this.sliderElementDisabledAttr=this.viewOptions.disabled?"disabled":null}updateAriaLabel(){this.sliderElementAriaLabel=this.viewOptions.ariaLabel||"nxg-slider"}updateVerticalState(){this.sliderElementVerticalClass=this.viewOptions.vertical;for(const e of this.getAllSliderElements())Pi.isNullOrUndefined(e)||e.setVertical(this.viewOptions.vertical)}updateScale(){for(const e of this.getAllSliderElements())e.setScale(this.viewOptions.scale)}updateRotate(){for(const e of this.getAllSliderElements())e.setRotate(this.viewOptions.rotate)}getAllSliderElements(){return[this.leftOuterSelectionBarElement,this.rightOuterSelectionBarElement,this.fullBarElement,this.selectionBarElement,this.minHandleElement,this.maxHandleElement,this.floorLabelElement,this.ceilLabelElement,this.minHandleLabelElement,this.maxHandleLabelElement,this.combinedLabelElement,this.ticksElement]}initHandles(){this.updateLowHandle(this.valueToPosition(this.viewLowValue)),this.range&&this.updateHighHandle(this.valueToPosition(this.viewHighValue)),this.updateSelectionBar(),this.range&&this.updateCombinedLabel(),this.updateTicksScale()}addAccessibility(){this.updateAriaAttributes(),this.minHandleElement.role="slider",this.minHandleElement.tabindex=!this.viewOptions.keyboardSupport||this.viewOptions.readOnly||this.viewOptions.disabled?"":"0",this.minHandleElement.ariaOrientation=this.viewOptions.vertical||0!==this.viewOptions.rotate?"vertical":"horizontal",Pi.isNullOrUndefined(this.viewOptions.ariaLabel)?Pi.isNullOrUndefined(this.viewOptions.ariaLabelledBy)||(this.minHandleElement.ariaLabelledBy=this.viewOptions.ariaLabelledBy):this.minHandleElement.ariaLabel=this.viewOptions.ariaLabel,this.range&&(this.maxHandleElement.role="slider",this.maxHandleElement.tabindex=!this.viewOptions.keyboardSupport||this.viewOptions.readOnly||this.viewOptions.disabled?"":"0",this.maxHandleElement.ariaOrientation=this.viewOptions.vertical||0!==this.viewOptions.rotate?"vertical":"horizontal",Pi.isNullOrUndefined(this.viewOptions.ariaLabelHigh)?Pi.isNullOrUndefined(this.viewOptions.ariaLabelledByHigh)||(this.maxHandleElement.ariaLabelledBy=this.viewOptions.ariaLabelledByHigh):this.maxHandleElement.ariaLabel=this.viewOptions.ariaLabelHigh)}updateAriaAttributes(){this.minHandleElement.ariaValueNow=(+this.value).toString(),this.minHandleElement.ariaValueText=this.viewOptions.translate(+this.value,gc.Low),this.minHandleElement.ariaValueMin=this.viewOptions.floor.toString(),this.minHandleElement.ariaValueMax=this.viewOptions.ceil.toString(),this.range&&(this.maxHandleElement.ariaValueNow=(+this.highValue).toString(),this.maxHandleElement.ariaValueText=this.viewOptions.translate(+this.highValue,gc.High),this.maxHandleElement.ariaValueMin=this.viewOptions.floor.toString(),this.maxHandleElement.ariaValueMax=this.viewOptions.ceil.toString())}calculateViewDimensions(){Pi.isNullOrUndefined(this.viewOptions.handleDimension)?this.minHandleElement.calculateDimension():this.minHandleElement.setDimension(this.viewOptions.handleDimension);const e=this.minHandleElement.dimension;this.handleHalfDimension=e/2,Pi.isNullOrUndefined(this.viewOptions.barDimension)?this.fullBarElement.calculateDimension():this.fullBarElement.setDimension(this.viewOptions.barDimension),this.maxHandlePosition=this.fullBarElement.dimension-e,this.initHasRun&&(this.updateFloorLabel(),this.updateCeilLabel(),this.initHandles())}calculateViewDimensionsAndDetectChanges(){this.calculateViewDimensions(),this.isRefDestroyed()||this.changeDetectionRef.detectChanges()}isRefDestroyed(){return this.changeDetectionRef.destroyed}updateTicksScale(){if(!this.viewOptions.showTicks)return void setTimeout(()=>{this.sliderElementWithLegendClass=!1});const e=Pi.isNullOrUndefined(this.viewOptions.ticksArray)?this.getTicksArray():this.viewOptions.ticksArray,n=this.viewOptions.vertical?"translateY":"translateX";this.viewOptions.rightToLeft&&e.reverse();const r=Pi.isNullOrUndefined(this.viewOptions.tickValueStep)?Pi.isNullOrUndefined(this.viewOptions.tickStep)?this.viewOptions.step:this.viewOptions.tickStep:this.viewOptions.tickValueStep;let s=!1;const a=e.map(l=>{let u=this.valueToPosition(l);this.viewOptions.vertical&&(u=this.maxHandlePosition-u);const h=n+"("+Math.round(u)+"px)",m=new UTe;m.selected=this.isTickSelected(l),m.style={"-webkit-transform":h,"-moz-transform":h,"-o-transform":h,"-ms-transform":h,transform:h},m.selected&&!Pi.isNullOrUndefined(this.viewOptions.getSelectionBarColor)&&(m.style["background-color"]=this.getSelectionBarColor()),!m.selected&&!Pi.isNullOrUndefined(this.viewOptions.getTickColor)&&(m.style["background-color"]=this.getTickColor(l)),Pi.isNullOrUndefined(this.viewOptions.ticksTooltip)||(m.tooltip=this.viewOptions.ticksTooltip(l),m.tooltipPlacement=this.viewOptions.vertical?"right":"top"),this.viewOptions.showTicksValues&&!Pi.isNullOrUndefined(r)&&Il.isModuloWithinPrecisionLimit(l,r,this.viewOptions.precisionLimit)&&(m.value=this.getDisplayValue(l,gc.TickValue),Pi.isNullOrUndefined(this.viewOptions.ticksValuesTooltip)||(m.valueTooltip=this.viewOptions.ticksValuesTooltip(l),m.valueTooltipPlacement=this.viewOptions.vertical?"right":"top"));let _=null;if(Pi.isNullOrUndefined(this.viewOptions.stepsArray))Pi.isNullOrUndefined(this.viewOptions.getLegend)||(_=this.viewOptions.getLegend(l));else{const v=this.viewOptions.stepsArray[l];Pi.isNullOrUndefined(this.viewOptions.getStepLegend)?Pi.isNullOrUndefined(v)||(_=v.legend):_=this.viewOptions.getStepLegend(v)}return Pi.isNullOrUndefined(_)||(m.legend=_,s=!0),m});if(setTimeout(()=>{this.sliderElementWithLegendClass=s}),Pi.isNullOrUndefined(this.ticks)||this.ticks.length!==a.length)this.ticks=a;else for(let l=0;l<a.length;++l)Object.assign(this.ticks[l],a[l]);this.isRefDestroyed()||this.changeDetectionRef.detectChanges()}getTicksArray(){const e=Pi.isNullOrUndefined(this.viewOptions.tickStep)?this.viewOptions.step:this.viewOptions.tickStep,n=[],r=1+Math.floor(Il.roundToPrecisionLimit(Math.abs(this.viewOptions.ceil-this.viewOptions.floor)/e,this.viewOptions.precisionLimit));for(let s=0;s<r;++s)n.push(Il.roundToPrecisionLimit(this.viewOptions.floor+e*s,this.viewOptions.precisionLimit));return n}isTickSelected(e){if(!this.range)if(Pi.isNullOrUndefined(this.viewOptions.showSelectionBarFromValue)){if(this.viewOptions.showSelectionBarEnd){if(e>=this.viewLowValue)return!0}else if(this.viewOptions.showSelectionBar&&e<=this.viewLowValue)return!0}else{const n=this.viewOptions.showSelectionBarFromValue;if(this.viewLowValue>n&&e>=n&&e<=this.viewLowValue)return!0;if(this.viewLowValue<n&&e<=n&&e>=this.viewLowValue)return!0}return!!(this.range&&e>=this.viewLowValue&&e<=this.viewHighValue)}updateFloorLabel(){this.floorLabelElement.alwaysHide||(this.floorLabelElement.setValue(this.getDisplayValue(this.viewOptions.floor,gc.Floor)),this.floorLabelElement.calculateDimension(),this.floorLabelElement.setPosition(this.viewOptions.rightToLeft?this.fullBarElement.dimension-this.floorLabelElement.dimension:0))}updateCeilLabel(){this.ceilLabelElement.alwaysHide||(this.ceilLabelElement.setValue(this.getDisplayValue(this.viewOptions.ceil,gc.Ceil)),this.ceilLabelElement.calculateDimension(),this.ceilLabelElement.setPosition(this.viewOptions.rightToLeft?0:this.fullBarElement.dimension-this.ceilLabelElement.dimension))}updateHandles(e,n){e===In.Min?this.updateLowHandle(n):e===In.Max&&this.updateHighHandle(n),this.updateSelectionBar(),this.updateTicksScale(),this.range&&this.updateCombinedLabel()}getHandleLabelPos(e,n){const r=e===In.Min?this.minHandleLabelElement.dimension:this.maxHandleLabelElement.dimension,s=n-r/2+this.handleHalfDimension,a=this.fullBarElement.dimension-r;return this.viewOptions.boundPointerLabels?this.viewOptions.rightToLeft&&e===In.Min||!this.viewOptions.rightToLeft&&e===In.Max?Math.min(s,a):Math.min(Math.max(s,0),a):s}updateLowHandle(e){this.minHandleElement.setPosition(e),this.minHandleLabelElement.setValue(this.getDisplayValue(this.viewLowValue,gc.Low)),this.minHandleLabelElement.setPosition(this.getHandleLabelPos(In.Min,e)),Pi.isNullOrUndefined(this.viewOptions.getPointerColor)||(this.minPointerStyle={backgroundColor:this.getPointerColor(In.Min)}),this.viewOptions.autoHideLimitLabels&&this.updateFloorAndCeilLabelsVisibility()}updateHighHandle(e){this.maxHandleElement.setPosition(e),this.maxHandleLabelElement.setValue(this.getDisplayValue(this.viewHighValue,gc.High)),this.maxHandleLabelElement.setPosition(this.getHandleLabelPos(In.Max,e)),Pi.isNullOrUndefined(this.viewOptions.getPointerColor)||(this.maxPointerStyle={backgroundColor:this.getPointerColor(In.Max)}),this.viewOptions.autoHideLimitLabels&&this.updateFloorAndCeilLabelsVisibility()}updateFloorAndCeilLabelsVisibility(){if(this.viewOptions.hidePointerLabels)return;let e=!1,n=!1;const r=this.isLabelBelowFloorLabel(this.minHandleLabelElement),s=this.isLabelAboveCeilLabel(this.minHandleLabelElement),a=this.isLabelAboveCeilLabel(this.maxHandleLabelElement),l=this.isLabelBelowFloorLabel(this.combinedLabelElement),u=this.isLabelAboveCeilLabel(this.combinedLabelElement);if(r?(e=!0,this.floorLabelElement.hide()):(e=!1,this.floorLabelElement.show()),s?(n=!0,this.ceilLabelElement.hide()):(n=!1,this.ceilLabelElement.show()),this.range){const h=this.combinedLabelElement.isVisible()?u:a,m=this.combinedLabelElement.isVisible()?l:r;h?this.ceilLabelElement.hide():n||this.ceilLabelElement.show(),m?this.floorLabelElement.hide():e||this.floorLabelElement.show()}}isLabelBelowFloorLabel(e){const n=e.position,s=this.floorLabelElement.position;return this.viewOptions.rightToLeft?n+e.dimension>=s-2:n<=s+this.floorLabelElement.dimension+2}isLabelAboveCeilLabel(e){const n=e.position,s=this.ceilLabelElement.position;return this.viewOptions.rightToLeft?n<=s+this.ceilLabelElement.dimension+2:n+e.dimension>=s-2}updateSelectionBar(){let e=0,n=0;const r=this.viewOptions.rightToLeft?!this.viewOptions.showSelectionBarEnd:this.viewOptions.showSelectionBarEnd,s=this.viewOptions.rightToLeft?this.maxHandleElement.position+this.handleHalfDimension:this.minHandleElement.position+this.handleHalfDimension;if(this.range)n=Math.abs(this.maxHandleElement.position-this.minHandleElement.position),e=s;else if(Pi.isNullOrUndefined(this.viewOptions.showSelectionBarFromValue))r?(n=Math.ceil(Math.abs(this.maxHandlePosition-this.minHandleElement.position)+this.handleHalfDimension),e=Math.floor(this.minHandleElement.position+this.handleHalfDimension)):(n=this.minHandleElement.position+this.handleHalfDimension,e=0);else{const a=this.viewOptions.showSelectionBarFromValue,l=this.valueToPosition(a);(this.viewOptions.rightToLeft?this.viewLowValue<=a:this.viewLowValue>a)?(n=this.minHandleElement.position-l,e=l+this.handleHalfDimension):(n=l-this.minHandleElement.position,e=this.minHandleElement.position+this.handleHalfDimension)}if(this.selectionBarElement.setDimension(n),this.selectionBarElement.setPosition(e),this.range&&this.viewOptions.showOuterSelectionBars&&(this.viewOptions.rightToLeft?(this.rightOuterSelectionBarElement.setDimension(e),this.rightOuterSelectionBarElement.setPosition(0),this.fullBarElement.calculateDimension(),this.leftOuterSelectionBarElement.setDimension(this.fullBarElement.dimension-(e+n)),this.leftOuterSelectionBarElement.setPosition(e+n)):(this.leftOuterSelectionBarElement.setDimension(e),this.leftOuterSelectionBarElement.setPosition(0),this.fullBarElement.calculateDimension(),this.rightOuterSelectionBarElement.setDimension(this.fullBarElement.dimension-(e+n)),this.rightOuterSelectionBarElement.setPosition(e+n))),Pi.isNullOrUndefined(this.viewOptions.getSelectionBarColor)){if(!Pi.isNullOrUndefined(this.viewOptions.selectionBarGradient)){const a=Pi.isNullOrUndefined(this.viewOptions.showSelectionBarFromValue)?0:this.valueToPosition(this.viewOptions.showSelectionBarFromValue),l=a-e>0&&!r||a-e<=0&&r;this.barStyle={backgroundImage:"linear-gradient(to "+(this.viewOptions.vertical?l?"bottom":"top":l?"left":"right")+", "+this.viewOptions.selectionBarGradient.from+" 0%,"+this.viewOptions.selectionBarGradient.to+" 100%)"},this.viewOptions.vertical?(this.barStyle.backgroundPosition="center "+(a+n+e+(l?-this.handleHalfDimension:0))+"px",this.barStyle.backgroundSize="100% "+(this.fullBarElement.dimension-this.handleHalfDimension)+"px"):(this.barStyle.backgroundPosition=a-e+(l?this.handleHalfDimension:0)+"px center",this.barStyle.backgroundSize=this.fullBarElement.dimension-this.handleHalfDimension+"px 100%")}}else{const a=this.getSelectionBarColor();this.barStyle={backgroundColor:a}}}getSelectionBarColor(){return this.range?this.viewOptions.getSelectionBarColor(this.value,this.highValue):this.viewOptions.getSelectionBarColor(this.value)}getPointerColor(e){return this.viewOptions.getPointerColor(e===In.Max?this.highValue:this.value,e)}getTickColor(e){return this.viewOptions.getTickColor(e)}updateCombinedLabel(){let e=null;if(e=this.viewOptions.rightToLeft?this.minHandleLabelElement.position-this.minHandleLabelElement.dimension-10<=this.maxHandleLabelElement.position:this.minHandleLabelElement.position+this.minHandleLabelElement.dimension+10>=this.maxHandleLabelElement.position,e){const n=this.getDisplayValue(this.viewLowValue,gc.Low),r=this.getDisplayValue(this.viewHighValue,gc.High),s=this.viewOptions.rightToLeft?this.viewOptions.combineLabels(r,n):this.viewOptions.combineLabels(n,r);this.combinedLabelElement.setValue(s);const a=this.viewOptions.boundPointerLabels?Math.min(Math.max(this.selectionBarElement.position+this.selectionBarElement.dimension/2-this.combinedLabelElement.dimension/2,0),this.fullBarElement.dimension-this.combinedLabelElement.dimension):this.selectionBarElement.position+this.selectionBarElement.dimension/2-this.combinedLabelElement.dimension/2;this.combinedLabelElement.setPosition(a),this.minHandleLabelElement.hide(),this.maxHandleLabelElement.hide(),this.combinedLabelElement.show()}else this.updateHighHandle(this.valueToPosition(this.viewHighValue)),this.updateLowHandle(this.valueToPosition(this.viewLowValue)),this.maxHandleLabelElement.show(),this.minHandleLabelElement.show(),this.combinedLabelElement.hide();this.viewOptions.autoHideLimitLabels&&this.updateFloorAndCeilLabelsVisibility()}getDisplayValue(e,n){return!Pi.isNullOrUndefined(this.viewOptions.stepsArray)&&!this.viewOptions.bindIndexForStepsArray&&(e=this.getStepValue(e)),this.viewOptions.translate(e,n)}roundStep(e,n){const r=Pi.isNullOrUndefined(n)?this.viewOptions.step:n;let s=Il.roundToPrecisionLimit((e-this.viewOptions.floor)/r,this.viewOptions.precisionLimit);return s=Math.round(s)*r,Il.roundToPrecisionLimit(this.viewOptions.floor+s,this.viewOptions.precisionLimit)}valueToPosition(e){let n=Pi.linearValueToPosition;Pi.isNullOrUndefined(this.viewOptions.customValueToPosition)?this.viewOptions.logScale&&(n=Pi.logValueToPosition):n=this.viewOptions.customValueToPosition;let r=n(e=Il.clampToRange(e,this.viewOptions.floor,this.viewOptions.ceil),this.viewOptions.floor,this.viewOptions.ceil);return Pi.isNullOrUndefined(r)&&(r=0),this.viewOptions.rightToLeft&&(r=1-r),r*this.maxHandlePosition}positionToValue(e){let n=e/this.maxHandlePosition;this.viewOptions.rightToLeft&&(n=1-n);let r=Pi.linearPositionToValue;Pi.isNullOrUndefined(this.viewOptions.customPositionToValue)?this.viewOptions.logScale&&(r=Pi.logPositionToValue):r=this.viewOptions.customPositionToValue;const s=r(n,this.viewOptions.floor,this.viewOptions.ceil);return Pi.isNullOrUndefined(s)?0:s}getEventXY(e,n){if(e instanceof MouseEvent)return this.viewOptions.vertical||0!==this.viewOptions.rotate?e.clientY:e.clientX;let r=0;const s=e.touches;if(!Pi.isNullOrUndefined(n))for(let a=0;a<s.length;a++)if(s[a].identifier===n){r=a;break}return this.viewOptions.vertical||0!==this.viewOptions.rotate?s[r].clientY:s[r].clientX}getEventPosition(e,n){const r=this.elementRef.nativeElement.getBoundingClientRect(),s=this.viewOptions.vertical||0!==this.viewOptions.rotate?r.bottom:r.left;let a=0;return a=this.viewOptions.vertical||0!==this.viewOptions.rotate?-this.getEventXY(e,n)+s:this.getEventXY(e,n)-s,a*this.viewOptions.scale-this.handleHalfDimension}getNearestHandle(e){if(!this.range)return In.Min;const n=this.getEventPosition(e),r=Math.abs(n-this.minHandleElement.position),s=Math.abs(n-this.maxHandleElement.position);return r<s?In.Min:r>s?In.Max:this.viewOptions.rightToLeft?n>this.minHandleElement.position?In.Min:In.Max:n<this.minHandleElement.position?In.Min:In.Max}bindEvents(){const e=this.viewOptions.draggableRange;this.viewOptions.onlyBindHandles||this.selectionBarElement.on("mousedown",n=>this.onBarStart(null,e,n,!0,!0,!0)),this.viewOptions.draggableRangeOnly?(this.minHandleElement.on("mousedown",n=>this.onBarStart(In.Min,e,n,!0,!0)),this.maxHandleElement.on("mousedown",n=>this.onBarStart(In.Max,e,n,!0,!0))):(this.minHandleElement.on("mousedown",n=>this.onStart(In.Min,n,!0,!0)),this.range&&this.maxHandleElement.on("mousedown",n=>this.onStart(In.Max,n,!0,!0)),this.viewOptions.onlyBindHandles||(this.fullBarElement.on("mousedown",n=>this.onStart(null,n,!0,!0,!0)),this.ticksElement.on("mousedown",n=>this.onStart(null,n,!0,!0,!0,!0)))),this.viewOptions.onlyBindHandles||this.selectionBarElement.onPassive("touchstart",n=>this.onBarStart(null,e,n,!0,!0,!0)),this.viewOptions.draggableRangeOnly?(this.minHandleElement.onPassive("touchstart",n=>this.onBarStart(In.Min,e,n,!0,!0)),this.maxHandleElement.onPassive("touchstart",n=>this.onBarStart(In.Max,e,n,!0,!0))):(this.minHandleElement.onPassive("touchstart",n=>this.onStart(In.Min,n,!0,!0)),this.range&&this.maxHandleElement.onPassive("touchstart",n=>this.onStart(In.Max,n,!0,!0)),this.viewOptions.onlyBindHandles||(this.fullBarElement.onPassive("touchstart",n=>this.onStart(null,n,!0,!0,!0)),this.ticksElement.onPassive("touchstart",n=>this.onStart(null,n,!1,!1,!0,!0)))),this.viewOptions.keyboardSupport&&(this.minHandleElement.on("focus",()=>this.onPointerFocus(In.Min)),this.range&&this.maxHandleElement.on("focus",()=>this.onPointerFocus(In.Max)))}getOptionsInfluencingEventBindings(e){return[e.disabled,e.readOnly,e.draggableRange,e.draggableRangeOnly,e.onlyBindHandles,e.keyboardSupport]}unbindEvents(){this.unsubscribeOnMove(),this.unsubscribeOnEnd();for(const e of this.getAllSliderElements())Pi.isNullOrUndefined(e)||e.off()}onBarStart(e,n,r,s,a,l,u){n?this.onDragStart(e,r,s,a):this.onStart(e,r,s,a,l,u)}onStart(e,n,r,s,a,l){n.stopPropagation(),!Zy.isTouchEvent(n)&&!yQ&&n.preventDefault(),this.moving=!1,this.calculateViewDimensions(),Pi.isNullOrUndefined(e)&&(e=this.getNearestHandle(n)),this.currentTrackingPointer=e;const u=this.getPointerElement(e);if(u.active=!0,this.viewOptions.keyboardSupport&&u.focus(),r){this.unsubscribeOnMove();const h=m=>this.dragging.active?this.onDragMove(m):this.onMove(m);this.onMoveEventListener=Zy.isTouchEvent(n)?this.eventListenerHelper.attachPassiveEventListener(document,"touchmove",h):this.eventListenerHelper.attachEventListener(document,"mousemove",h)}if(s){this.unsubscribeOnEnd();const h=m=>this.onEnd(m);this.onEndEventListener=Zy.isTouchEvent(n)?this.eventListenerHelper.attachPassiveEventListener(document,"touchend",h):this.eventListenerHelper.attachEventListener(document,"mouseup",h)}this.userChangeStart.emit(this.getChangeContext()),Zy.isTouchEvent(n)&&!Pi.isNullOrUndefined(n.changedTouches)&&Pi.isNullOrUndefined(this.touchId)&&(this.touchId=n.changedTouches[0].identifier),a&&this.onMove(n,!0),l&&this.onEnd(n)}onMove(e,n){let r=null;if(Zy.isTouchEvent(e)){const h=e.changedTouches;for(let m=0;m<h.length;m++)if(h[m].identifier===this.touchId){r=h[m];break}if(Pi.isNullOrUndefined(r))return}this.viewOptions.animate&&!this.viewOptions.animateOnMove&&this.moving&&(this.sliderElementAnimateClass=!1),this.moving=!0;const s=Pi.isNullOrUndefined(r)?this.getEventPosition(e):this.getEventPosition(e,r.identifier);let a;s<=0?a=this.viewOptions.rightToLeft?this.viewOptions.ceil:this.viewOptions.floor:s>=this.maxHandlePosition?a=this.viewOptions.rightToLeft?this.viewOptions.floor:this.viewOptions.ceil:(a=this.positionToValue(s),a=n&&!Pi.isNullOrUndefined(this.viewOptions.tickStep)?this.roundStep(a,this.viewOptions.tickStep):this.roundStep(a)),this.positionTrackingHandle(a)}onEnd(e){Zy.isTouchEvent(e)&&e.changedTouches[0].identifier!==this.touchId||(this.moving=!1,this.viewOptions.animate&&(this.sliderElementAnimateClass=!0),this.touchId=null,this.viewOptions.keyboardSupport||(this.minHandleElement.active=!1,this.maxHandleElement.active=!1,this.currentTrackingPointer=null),this.dragging.active=!1,this.unsubscribeOnMove(),this.unsubscribeOnEnd(),this.userChangeEnd.emit(this.getChangeContext()))}onPointerFocus(e){const n=this.getPointerElement(e);n.on("blur",()=>this.onPointerBlur(n)),n.on("keydown",r=>this.onKeyboardEvent(r)),n.on("keyup",()=>this.onKeyUp()),n.active=!0,this.currentTrackingPointer=e,this.currentFocusPointer=e,this.firstKeyDown=!0}onKeyUp(){this.firstKeyDown=!0,this.userChangeEnd.emit(this.getChangeContext())}onPointerBlur(e){e.off("blur"),e.off("keydown"),e.off("keyup"),e.active=!1,Pi.isNullOrUndefined(this.touchId)&&(this.currentTrackingPointer=null,this.currentFocusPointer=null)}getKeyActions(e){const n=this.viewOptions.ceil-this.viewOptions.floor;let r=e+this.viewOptions.step,s=e-this.viewOptions.step,a=e+n/10,l=e-n/10;this.viewOptions.reversedControls&&(r=e-this.viewOptions.step,s=e+this.viewOptions.step,a=e-n/10,l=e+n/10);const u={UP:r,DOWN:s,LEFT:s,RIGHT:r,PAGEUP:a,PAGEDOWN:l,HOME:this.viewOptions.reversedControls?this.viewOptions.ceil:this.viewOptions.floor,END:this.viewOptions.reversedControls?this.viewOptions.floor:this.viewOptions.ceil};return this.viewOptions.rightToLeft&&(u.LEFT=r,u.RIGHT=s,(this.viewOptions.vertical||0!==this.viewOptions.rotate)&&(u.UP=s,u.DOWN=r)),u}onKeyboardEvent(e){const n=this.getCurrentTrackingValue(),r=Pi.isNullOrUndefined(e.keyCode)?e.which:e.keyCode,u=this.getKeyActions(n)[{38:"UP",40:"DOWN",37:"LEFT",39:"RIGHT",33:"PAGEUP",34:"PAGEDOWN",36:"HOME",35:"END"}[r]];if(Pi.isNullOrUndefined(u)||Pi.isNullOrUndefined(this.currentTrackingPointer))return;e.preventDefault(),this.firstKeyDown&&(this.firstKeyDown=!1,this.userChangeStart.emit(this.getChangeContext()));const h=Il.clampToRange(u,this.viewOptions.floor,this.viewOptions.ceil),m=this.roundStep(h);if(this.viewOptions.draggableRangeOnly){const _=this.viewHighValue-this.viewLowValue;let v,S;this.currentTrackingPointer===In.Min?(v=m,S=m+_,S>this.viewOptions.ceil&&(S=this.viewOptions.ceil,v=S-_)):this.currentTrackingPointer===In.Max&&(S=m,v=m-_,v<this.viewOptions.floor&&(v=this.viewOptions.floor,S=v+_)),this.positionTrackingBar(v,S)}else this.positionTrackingHandle(m)}onDragStart(e,n,r,s){const a=this.getEventPosition(n);this.dragging=new MQ,this.dragging.active=!0,this.dragging.value=this.positionToValue(a),this.dragging.difference=this.viewHighValue-this.viewLowValue,this.dragging.lowLimit=this.viewOptions.rightToLeft?this.minHandleElement.position-a:a-this.minHandleElement.position,this.dragging.highLimit=this.viewOptions.rightToLeft?a-this.maxHandleElement.position:this.maxHandleElement.position-a,this.onStart(e,n,r,s)}getMinValue(e,n,r){const s=this.viewOptions.rightToLeft;let a=null;return a=n?r?s?this.viewOptions.floor:this.viewOptions.ceil-this.dragging.difference:s?this.viewOptions.ceil-this.dragging.difference:this.viewOptions.floor:this.positionToValue(s?e+this.dragging.lowLimit:e-this.dragging.lowLimit),this.roundStep(a)}getMaxValue(e,n,r){const s=this.viewOptions.rightToLeft;let a=null;return a=n?r?s?this.viewOptions.floor+this.dragging.difference:this.viewOptions.ceil:s?this.viewOptions.ceil:this.viewOptions.floor+this.dragging.difference:s?this.positionToValue(e+this.dragging.lowLimit)+this.dragging.difference:this.positionToValue(e-this.dragging.lowLimit)+this.dragging.difference,this.roundStep(a)}onDragMove(e){const n=this.getEventPosition(e);let r,s,a,l;this.viewOptions.animate&&!this.viewOptions.animateOnMove&&this.moving&&(this.sliderElementAnimateClass=!1),this.moving=!0,this.viewOptions.rightToLeft?(r=this.dragging.lowLimit,s=this.dragging.highLimit,a=this.maxHandleElement,l=this.minHandleElement):(r=this.dragging.highLimit,s=this.dragging.lowLimit,a=this.minHandleElement,l=this.maxHandleElement);const h=n>=this.maxHandlePosition-r;let m,_;if(n<=s){if(0===a.position)return;m=this.getMinValue(n,!0,!1),_=this.getMaxValue(n,!0,!1)}else if(h){if(l.position===this.maxHandlePosition)return;_=this.getMaxValue(n,!0,!0),m=this.getMinValue(n,!0,!0)}else m=this.getMinValue(n,!1,!1),_=this.getMaxValue(n,!1,!1);this.positionTrackingBar(m,_)}positionTrackingBar(e,n){!Pi.isNullOrUndefined(this.viewOptions.minLimit)&&e<this.viewOptions.minLimit&&(n=Il.roundToPrecisionLimit((e=this.viewOptions.minLimit)+this.dragging.difference,this.viewOptions.precisionLimit)),!Pi.isNullOrUndefined(this.viewOptions.maxLimit)&&n>this.viewOptions.maxLimit&&(e=Il.roundToPrecisionLimit((n=this.viewOptions.maxLimit)-this.dragging.difference,this.viewOptions.precisionLimit)),this.viewLowValue=e,this.viewHighValue=n,this.applyViewChange(),this.updateHandles(In.Min,this.valueToPosition(e)),this.updateHandles(In.Max,this.valueToPosition(n))}positionTrackingHandle(e){e=this.applyMinMaxLimit(e),this.range&&(this.viewOptions.pushRange?e=this.applyPushRange(e):(this.viewOptions.noSwitching&&(this.currentTrackingPointer===In.Min&&e>this.viewHighValue?e=this.applyMinMaxRange(this.viewHighValue):this.currentTrackingPointer===In.Max&&e<this.viewLowValue&&(e=this.applyMinMaxRange(this.viewLowValue))),e=this.applyMinMaxRange(e),this.currentTrackingPointer===In.Min&&e>this.viewHighValue?(this.viewLowValue=this.viewHighValue,this.applyViewChange(),this.updateHandles(In.Min,this.maxHandleElement.position),this.updateAriaAttributes(),this.currentTrackingPointer=In.Max,this.minHandleElement.active=!1,this.maxHandleElement.active=!0,this.viewOptions.keyboardSupport&&this.maxHandleElement.focus()):this.currentTrackingPointer===In.Max&&e<this.viewLowValue&&(this.viewHighValue=this.viewLowValue,this.applyViewChange(),this.updateHandles(In.Max,this.minHandleElement.position),this.updateAriaAttributes(),this.currentTrackingPointer=In.Min,this.maxHandleElement.active=!1,this.minHandleElement.active=!0,this.viewOptions.keyboardSupport&&this.minHandleElement.focus()))),this.getCurrentTrackingValue()!==e&&(this.currentTrackingPointer===In.Min?(this.viewLowValue=e,this.applyViewChange()):this.currentTrackingPointer===In.Max&&(this.viewHighValue=e,this.applyViewChange()),this.updateHandles(this.currentTrackingPointer,this.valueToPosition(e)),this.updateAriaAttributes())}applyMinMaxLimit(e){return!Pi.isNullOrUndefined(this.viewOptions.minLimit)&&e<this.viewOptions.minLimit?this.viewOptions.minLimit:!Pi.isNullOrUndefined(this.viewOptions.maxLimit)&&e>this.viewOptions.maxLimit?this.viewOptions.maxLimit:e}applyMinMaxRange(e){const r=Math.abs(e-(this.currentTrackingPointer===In.Min?this.viewHighValue:this.viewLowValue));if(!Pi.isNullOrUndefined(this.viewOptions.minRange)&&r<this.viewOptions.minRange){if(this.currentTrackingPointer===In.Min)return Il.roundToPrecisionLimit(this.viewHighValue-this.viewOptions.minRange,this.viewOptions.precisionLimit);if(this.currentTrackingPointer===In.Max)return Il.roundToPrecisionLimit(this.viewLowValue+this.viewOptions.minRange,this.viewOptions.precisionLimit)}if(!Pi.isNullOrUndefined(this.viewOptions.maxRange)&&r>this.viewOptions.maxRange){if(this.currentTrackingPointer===In.Min)return Il.roundToPrecisionLimit(this.viewHighValue-this.viewOptions.maxRange,this.viewOptions.precisionLimit);if(this.currentTrackingPointer===In.Max)return Il.roundToPrecisionLimit(this.viewLowValue+this.viewOptions.maxRange,this.viewOptions.precisionLimit)}return e}applyPushRange(e){const n=this.currentTrackingPointer===In.Min?this.viewHighValue-e:e-this.viewLowValue,r=Pi.isNullOrUndefined(this.viewOptions.minRange)?this.viewOptions.step:this.viewOptions.minRange,s=this.viewOptions.maxRange;return n<r?(this.currentTrackingPointer===In.Min?(this.viewHighValue=Il.roundToPrecisionLimit(Math.min(e+r,this.viewOptions.ceil),this.viewOptions.precisionLimit),e=Il.roundToPrecisionLimit(this.viewHighValue-r,this.viewOptions.precisionLimit),this.applyViewChange(),this.updateHandles(In.Max,this.valueToPosition(this.viewHighValue))):this.currentTrackingPointer===In.Max&&(this.viewLowValue=Il.roundToPrecisionLimit(Math.max(e-r,this.viewOptions.floor),this.viewOptions.precisionLimit),e=Il.roundToPrecisionLimit(this.viewLowValue+r,this.viewOptions.precisionLimit),this.applyViewChange(),this.updateHandles(In.Min,this.valueToPosition(this.viewLowValue))),this.updateAriaAttributes()):!Pi.isNullOrUndefined(s)&&n>s&&(this.currentTrackingPointer===In.Min?(this.viewHighValue=Il.roundToPrecisionLimit(e+s,this.viewOptions.precisionLimit),this.applyViewChange(),this.updateHandles(In.Max,this.valueToPosition(this.viewHighValue))):this.currentTrackingPointer===In.Max&&(this.viewLowValue=Il.roundToPrecisionLimit(e-s,this.viewOptions.precisionLimit),this.applyViewChange(),this.updateHandles(In.Min,this.valueToPosition(this.viewLowValue))),this.updateAriaAttributes()),e}getChangeContext(){const e=new zTe;return e.pointerType=this.currentTrackingPointer,e.value=+this.value,this.range&&(e.highValue=+this.highValue),e}}return i.\u0275fac=function(e){return new(e||i)(B(nu),B(ai),B(Pn),B(Rn))},i.\u0275cmp=ei({type:i,selectors:[["ngx-slider"]],contentQueries:function(e,n,r){if(1&e&&Er(r,vTe,5),2&e){let s;jt(s=qt())&&(n.tooltipTemplate=s.first)}},viewQuery:function(e,n){if(1&e&&(ji(bTe,5,Yy),ji(xTe,5,Yy),ji(wTe,5,Yy),ji(STe,5,Yy),ji(CTe,5,A4),ji(MTe,5,A4),ji(TTe,5,cC),ji(ETe,5,cC),ji(ATe,5,cC),ji(DTe,5,cC),ji(RTe,5,cC),ji(kTe,5,Yy)),2&e){let r;jt(r=qt())&&(n.leftOuterSelectionBarElement=r.first),jt(r=qt())&&(n.rightOuterSelectionBarElement=r.first),jt(r=qt())&&(n.fullBarElement=r.first),jt(r=qt())&&(n.selectionBarElement=r.first),jt(r=qt())&&(n.minHandleElement=r.first),jt(r=qt())&&(n.maxHandleElement=r.first),jt(r=qt())&&(n.floorLabelElement=r.first),jt(r=qt())&&(n.ceilLabelElement=r.first),jt(r=qt())&&(n.minHandleLabelElement=r.first),jt(r=qt())&&(n.maxHandleLabelElement=r.first),jt(r=qt())&&(n.combinedLabelElement=r.first),jt(r=qt())&&(n.ticksElement=r.first)}},hostAttrs:[1,"ngx-slider"],hostVars:8,hostBindings:function(e,n){1&e&&je("resize",function(s){return n.onResize(s)},!1,Ex),2&e&&(Vi("disabled",n.sliderElementDisabledAttr)("aria-label",n.sliderElementAriaLabel),N("vertical",n.sliderElementVerticalClass)("animate",n.sliderElementAnimateClass)("with-legend",n.sliderElementWithLegendClass))},inputs:{value:"value",highValue:"highValue",options:"options",manualRefresh:"manualRefresh",triggerFocus:"triggerFocus"},outputs:{valueChange:"valueChange",highValueChange:"highValueChange",userChangeStart:"userChangeStart",userChange:"userChange",userChangeEnd:"userChangeEnd"},features:[Sn([GTe]),Ls],decls:29,vars:13,consts:[["ngxSliderElement","",1,"ngx-slider-span","ngx-slider-bar-wrapper","ngx-slider-left-out-selection"],["leftOuterSelectionBar",""],[1,"ngx-slider-span","ngx-slider-bar"],["ngxSliderElement","",1,"ngx-slider-span","ngx-slider-bar-wrapper","ngx-slider-right-out-selection"],["rightOuterSelectionBar",""],["ngxSliderElement","",1,"ngx-slider-span","ngx-slider-bar-wrapper","ngx-slider-full-bar"],["fullBar",""],["ngxSliderElement","",1,"ngx-slider-span","ngx-slider-bar-wrapper","ngx-slider-selection-bar"],["selectionBar",""],[1,"ngx-slider-span","ngx-slider-bar","ngx-slider-selection",3,"ngStyle"],["ngxSliderHandle","",1,"ngx-slider-span","ngx-slider-pointer","ngx-slider-pointer-min",3,"ngStyle"],["minHandle",""],["ngxSliderHandle","",1,"ngx-slider-span","ngx-slider-pointer","ngx-slider-pointer-max",3,"ngStyle"],["maxHandle",""],["ngxSliderLabel","",1,"ngx-slider-span","ngx-slider-bubble","ngx-slider-limit","ngx-slider-floor"],["floorLabel",""],["ngxSliderLabel","",1,"ngx-slider-span","ngx-slider-bubble","ngx-slider-limit","ngx-slider-ceil"],["ceilLabel",""],["ngxSliderLabel","",1,"ngx-slider-span","ngx-slider-bubble","ngx-slider-model-value"],["minHandleLabel",""],["ngxSliderLabel","",1,"ngx-slider-span","ngx-slider-bubble","ngx-slider-model-high"],["maxHandleLabel",""],["ngxSliderLabel","",1,"ngx-slider-span","ngx-slider-bubble","ngx-slider-combined"],["combinedLabel",""],["ngxSliderElement","",1,"ngx-slider-ticks",3,"hidden"],["ticksElement",""],["class","ngx-slider-tick",3,"ngClass","ngStyle",4,"ngFor","ngForOf"],[1,"ngx-slider-tick",3,"ngClass","ngStyle"],[3,"template","tooltip","placement"],["class","ngx-slider-span ngx-slider-tick-value",3,"template","tooltip","placement","content",4,"ngIf"],["class","ngx-slider-span ngx-slider-tick-legend",3,"innerHTML",4,"ngIf"],[1,"ngx-slider-span","ngx-slider-tick-value",3,"template","tooltip","placement","content"],[1,"ngx-slider-span","ngx-slider-tick-legend",3,"innerHTML"]],template:function(e,n){1&e&&(Z(0,"span",0,1),yt(2,"span",2),J(),Z(3,"span",3,4),yt(5,"span",2),J(),Z(6,"span",5,6),yt(8,"span",2),J(),Z(9,"span",7,8),yt(11,"span",9),J(),yt(12,"span",10,11)(14,"span",12,13)(16,"span",14,15)(18,"span",16,17)(20,"span",18,19)(22,"span",20,21)(24,"span",22,23),Z(26,"span",24,25),Ue(28,OTe,4,9,"span",26),J()),2&e&&(se(6),N("ngx-slider-transparent",n.fullBarTransparentClass),se(3),N("ngx-slider-draggable",n.selectionBarDraggableClass),se(2),fe("ngStyle",n.barStyle),se(1),fe("ngStyle",n.minPointerStyle),se(2),A("display",n.range?"inherit":"none"),fe("ngStyle",n.maxPointerStyle),se(12),N("ngx-slider-ticks-values-under",n.ticksUnderValuesClass),fe("hidden",!n.showTicks),se(2),fe("ngForOf",n.ticks))},directives:function(){return[Yy,Rw,A4,cC,mo,Cp,WTe,ms]},styles:[".ngx-slider{display:inline-block;position:relative;height:4px;width:100%;margin:35px 0 15px;vertical-align:middle;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;touch-action:pan-y}  .ngx-slider.with-legend{margin-bottom:40px}  .ngx-slider[disabled]{cursor:not-allowed}  .ngx-slider[disabled] .ngx-slider-pointer{cursor:not-allowed;background-color:#d8e0f3}  .ngx-slider[disabled] .ngx-slider-draggable{cursor:not-allowed}  .ngx-slider[disabled] .ngx-slider-selection{background:#8b91a2}  .ngx-slider[disabled] .ngx-slider-tick{cursor:not-allowed}  .ngx-slider[disabled] .ngx-slider-tick.ngx-slider-selected{background:#8b91a2}  .ngx-slider .ngx-slider-span{white-space:nowrap;position:absolute;display:inline-block}  .ngx-slider .ngx-slider-base{width:100%;height:100%;padding:0}  .ngx-slider .ngx-slider-bar-wrapper{left:0;box-sizing:border-box;margin-top:-16px;padding-top:16px;width:100%;height:32px;z-index:1}  .ngx-slider .ngx-slider-draggable{cursor:move}  .ngx-slider .ngx-slider-bar{left:0;width:100%;height:4px;z-index:1;background:#d8e0f3;border-radius:2px}  .ngx-slider .ngx-slider-bar-wrapper.ngx-slider-transparent .ngx-slider-bar{background:0 0}  .ngx-slider .ngx-slider-bar-wrapper.ngx-slider-left-out-selection .ngx-slider-bar{background:#df002d}  .ngx-slider .ngx-slider-bar-wrapper.ngx-slider-right-out-selection .ngx-slider-bar{background:#03a688}  .ngx-slider .ngx-slider-selection{z-index:2;background:#0db9f0;border-radius:2px}  .ngx-slider .ngx-slider-pointer{cursor:pointer;width:32px;height:32px;top:-14px;background-color:#0db9f0;z-index:3;border-radius:16px}  .ngx-slider .ngx-slider-pointer:after{content:'';width:8px;height:8px;position:absolute;top:12px;left:12px;border-radius:4px;background:#fff}  .ngx-slider .ngx-slider-pointer:hover:after{background-color:#fff}  .ngx-slider .ngx-slider-pointer.ngx-slider-active{z-index:4}  .ngx-slider .ngx-slider-pointer.ngx-slider-active:after{background-color:#451aff}  .ngx-slider .ngx-slider-bubble{cursor:default;bottom:16px;padding:1px 3px;color:#55637d;font-size:16px}  .ngx-slider .ngx-slider-bubble.ngx-slider-limit{color:#55637d}  .ngx-slider .ngx-slider-ticks{box-sizing:border-box;width:100%;height:0;position:absolute;left:0;top:-3px;margin:0;z-index:1;list-style:none}  .ngx-slider .ngx-slider-ticks-values-under .ngx-slider-tick-value{top:auto;bottom:-36px}  .ngx-slider .ngx-slider-tick{text-align:center;cursor:pointer;width:10px;height:10px;background:#d8e0f3;border-radius:50%;position:absolute;top:0;left:0;margin-left:11px}  .ngx-slider .ngx-slider-tick.ngx-slider-selected{background:#0db9f0}  .ngx-slider .ngx-slider-tick-value{position:absolute;top:-34px;-webkit-transform:translate(-50%,0);transform:translate(-50%,0)}  .ngx-slider .ngx-slider-tick-legend{position:absolute;top:24px;-webkit-transform:translate(-50%,0);transform:translate(-50%,0);max-width:50px;white-space:normal}  .ngx-slider.vertical{position:relative;width:4px;height:100%;margin:0 20px;padding:0;vertical-align:baseline;touch-action:pan-x}  .ngx-slider.vertical .ngx-slider-base{width:100%;height:100%;padding:0}  .ngx-slider.vertical .ngx-slider-bar-wrapper{top:auto;left:0;margin:0 0 0 -16px;padding:0 0 0 16px;height:100%;width:32px}  .ngx-slider.vertical .ngx-slider-bar{bottom:0;left:auto;width:4px;height:100%}  .ngx-slider.vertical .ngx-slider-pointer{left:-14px!important;top:auto;bottom:0}  .ngx-slider.vertical .ngx-slider-bubble{left:16px!important;bottom:0}  .ngx-slider.vertical .ngx-slider-ticks{height:100%;width:0;left:-3px;top:0;z-index:1}  .ngx-slider.vertical .ngx-slider-tick{vertical-align:middle;margin-left:auto;margin-top:11px}  .ngx-slider.vertical .ngx-slider-tick-value{left:24px;top:auto;-webkit-transform:translate(0,-28%);transform:translate(0,-28%)}  .ngx-slider.vertical .ngx-slider-tick-legend{top:auto;right:24px;-webkit-transform:translate(0,-28%);transform:translate(0,-28%);max-width:none;white-space:nowrap}  .ngx-slider.vertical .ngx-slider-ticks-values-under .ngx-slider-tick-value{bottom:auto;left:auto;right:24px}  .ngx-slider *{transition:none}  .ngx-slider.animate .ngx-slider-bar-wrapper{transition:.3s linear}  .ngx-slider.animate .ngx-slider-selection{transition:background-color .3s linear}  .ngx-slider.animate .ngx-slider-pointer{transition:.3s linear}  .ngx-slider.animate .ngx-slider-pointer:after{transition:.3s linear}  .ngx-slider.animate .ngx-slider-bubble{transition:.3s linear}  .ngx-slider.animate .ngx-slider-bubble.ngx-slider-limit{transition:opacity .3s linear}  .ngx-slider.animate .ngx-slider-bubble.ngx-slider-combined{transition:opacity .3s linear}  .ngx-slider.animate .ngx-slider-tick{transition:background-color .3s linear}"]}),i})(),WTe=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=ei({type:i,selectors:[["ngx-slider-tooltip-wrapper"]],inputs:{template:"template",tooltip:"tooltip",placement:"placement",content:"content"},decls:2,vars:2,consts:[[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"ngx-slider-inner-tooltip"]],template:function(e,n){1&e&&(Ue(0,HTe,2,6,"ng-container",0),Ue(1,VTe,3,3,"ng-container",0)),2&e&&(fe("ngIf",n.template),se(1),fe("ngIf",!n.template))},directives:[ms,n6],styles:[".ngx-slider-inner-tooltip[_ngcontent-%COMP%]{height:100%}"]}),i})(),AQ=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[ka]]}),i})();function jTe(i,t){if(1&i&&(Z(0,"mat-option",7),ue(1),J()),2&i){const e=t.$implicit;fe("value",e),se(1),Xt(e.displayName)}}function qTe(i,t){if(1&i&&(Z(0,"mat-option",12),ue(1),J()),2&i){const e=t.$implicit;fe("value",e),se(1),ui(" ",e.toString()," ")}}function XTe(i,t){if(1&i){const e=Wi();Z(0,"mat-form-field",0)(1,"input",13),je("ngModelChange",function(r){return gt(e),Re(2)._value.next(r)}),ti(2,"async"),J()()}if(2&i){const e=Re(2);se(1),fe("ngModel",Qi(2,1,e._value))}}function ZTe(i,t){if(1&i&&(Z(0,"mat-option",7),ue(1),J()),2&i){const e=t.$implicit;fe("value",e),se(1),ui(" ",e," ")}}function YTe(i,t){if(1&i){const e=Wi();Z(0,"mat-select",1),je("ngModelChange",function(r){return gt(e),Re(2)._value.next(r)}),ti(1,"async"),Ue(2,ZTe,2,2,"mat-option",2),J()}if(2&i){const e=Re().ngIf;fe("ngModel",Qi(1,2,Re()._value)),se(2),fe("ngForOf",e.options)}}function KTe(i,t){if(1&i){const e=Wi();Z(0,"mat-form-field",14)(1,"input",15),je("ngModelChange",function(r){return gt(e),Re(2)._value.next(r)}),ti(2,"async"),J()()}if(2&i){const e=Re(2);se(1),fe("ngModel",Qi(2,1,e._value))}}function QTe(i,t){if(1&i){const e=Wi();Z(0,"div",0)(1,"ngx-slider",16),je("highValueChange",function(r){return gt(e),Re(2)._max.next(r)})("valueChange",function(r){return gt(e),Re(2)._min.next(r)}),ti(2,"async"),ti(3,"async"),J()()}if(2&i){const e=Re().ngIf,n=Re();se(1),fe("highValue",Qi(2,3,n._max))("value",Qi(3,5,n._min))("options",e.sliderOptions)}}function JTe(i,t){if(1&i&&(Z(0,"mat-button-toggle",7),ue(1),J()),2&i){const e=t.$implicit,n=t.index,r=Re(2).ngIf;fe("value",e),se(1),Xt(r.shorthand[n])}}function $Te(i,t){if(1&i){const e=Wi();Z(0,"div",17),je("keydown.enter",function(r){return r.preventDefault()})("keydown.control.enter",function(r){return r.preventDefault()}),Z(1,"mat-button-toggle-group",18),je("ngModelChange",function(r){return gt(e),Re(2)._value.next(r)})("keydown.enter",function(r){return r.preventDefault()}),ti(2,"async"),Ue(3,JTe,2,2,"mat-button-toggle",2),J()()}if(2&i){const e=Re().ngIf,n=Re();se(1),fe("ngModel",Qi(2,2,n._value)),se(2),fe("ngForOf",e.options)}}function eEe(i,t){if(1&i){const e=Wi();Wo(0,0),Z(1,"mat-select",1),je("ngModelChange",function(r){return gt(e),Re()._operator.next(r)}),ti(2,"async"),Ue(3,qTe,2,2,"mat-option",8),J(),Ue(4,XTe,3,3,"mat-form-field",5),Ue(5,YTe,3,4,"mat-select",9),Ue(6,KTe,3,3,"mat-form-field",10),Ue(7,QTe,4,7,"div",5),Ue(8,$Te,4,4,"div",11),jo()}if(2&i){const e=t.ngIf,n=Re();se(1),fe("ngModel",Qi(2,7,n._operator)),se(2),fe("ngForOf",e.operators),se(1),fe("ngIf",2===e.inputType.valueOf()||3===e.inputType.valueOf()),se(1),fe("ngIf",0===e.inputType.valueOf()||5===e.inputType.valueOf()),se(1),fe("ngIf",1===e.inputType.valueOf()),se(1),fe("ngIf",4===e.inputType.valueOf()),se(1),fe("ngIf",6===e.inputType.valueOf())}}let tEe=(()=>{class i{constructor(e){this.cdr=e,this._attribute=new gs(null),this._value=new gs(""),this._operator=new gs(Ns.EQ),this._min=new gs(0),this._max=new gs(1)}updateRangeValue(){this._value.next([this._min.getValue(),this._max.getValue()])}onRemoveButtonClicked(){this.boolTerm.removeTerm(this.term)}updateTerm(){!this._attribute.getValue()||(this.term.attribute=this._attribute.getValue().featureName,this.term.operator=oy.getOperatorName(this._operator.getValue()),this.term.values=Array.isArray(this._value.getValue())?this._value.getValue():[this._value.getValue()],this.boolTerm.update())}ngOnInit(){if(this._value.subscribe(()=>this.updateTerm()),this._operator.subscribe(()=>this.updateTerm()),this._max.subscribe(()=>{this.updateRangeValue(),this.updateTerm()}),this._min.subscribe(()=>{this.updateRangeValue(),this.updateTerm()}),this._attribute.subscribe(e=>{!e||(this._operator.next(e.operators[0]),this._value.next(""),this.updateTerm())}),this.term.attribute){const e=this.possibleAttributes.getValue().find(n=>n.featureName===this.term.attribute);e?this._attribute.next(e):console.error(`no matching attribute found for term ${this.term} in attribute list ${this.possibleAttributes.getValue()}`)}else this._attribute.next(this.possibleAttributes.getValue()[0]);switch(this._operator.next(this.term.operator?Ns[this.term.operator]:oy.getDefaultOperatorsByValueType(this._attribute.getValue().inputType)[0]),this._attribute.getValue().inputType){case _a.MULTIOPTIONS:this.term.values&&this._value.next(this.term.values);break;case _a.OPTIONS:case _a.DYNAMICOPTIONS:case _a.DATE:case _a.NUMERIC:case _a.TEXT:this._value.next(this.term.values&&this.term.values!==[]?this.term.values[0]:"");break;case _a.RANGE:if(this.term.values&&this.term.values!==[]&&""!=this.term.values[0]){const n=this.term.values[1];this._min.next(this.term.values[0]),this._max.next(n)}else this._min.next(this._attribute.getValue().minValue),this._max.next(this._attribute.getValue().maxValue)}this._attribute.getValue().inputType===_a.RANGE&&this.updateRangeValue(),this.updateTerm()}onChange(){this.updateTerm()}}return i.\u0275fac=function(e){return new(e||i)(B(Pn))},i.\u0275cmp=ei({type:i,selectors:[["app-qt-bool-component"]],inputs:{boolTerm:"boolTerm",possibleAttributes:"possibleAttributes",term:"term"},decls:13,vars:17,consts:[[1,"options"],["required","",1,"options",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[2,"width","10%"],["matTooltip","Remove query term",1,"icon-button",3,"click"],["class","options",4,"ngIf"],[2,"padding-bottom","10px"],[3,"value"],["class","options","style","width:100%",3,"value",4,"ngFor","ngForOf"],["class","options","required","",3,"ngModel","ngModelChange",4,"ngIf"],["class","options textinput",4,"ngIf"],["class","options",3,"keydown.enter","keydown.control.enter",4,"ngIf"],[1,"options",2,"width","100%",3,"value"],["matInput","","placeholder","Search text",3,"ngModel","ngModelChange"],[1,"options","textinput"],["matInput","","placeholder","This will be a date selector later",3,"ngModel","ngModelChange"],[3,"highValue","value","options","highValueChange","valueChange"],[1,"options",3,"keydown.enter","keydown.control.enter"],["name","ingredients","aria-label","Ingredients","multiple","",3,"ngModel","ngModelChange","keydown.enter"]],template:function(e,n){1&e&&(Z(0,"div",0)(1,"mat-select",1),je("ngModelChange",function(s){return n._attribute.next(s)}),ti(2,"async"),Ue(3,jTe,2,2,"mat-option",2),ti(4,"async"),J(),Z(5,"div",3)(6,"button",4),je("click",function(){return n.onRemoveButtonClicked()}),Z(7,"mat-icon"),ue(8,"remove"),J()()(),Ue(9,eEe,9,9,"ng-container",5),ti(10,"async"),J(),yt(11,"mat-divider")(12,"div",6)),2&e&&(A("display","flex")("padding-left","10px")("text-align","left")("width","100%"),se(1),fe("ngModel",Qi(2,11,n._attribute)),se(2),fe("ngForOf",Qi(4,13,n.possibleAttributes)),se(6),fe("ngIf",Qi(10,15,n._attribute)))},directives:[C4,qR,ah,lh,mo,Vb,Fo,vo,ms,og,Ty,Bf,EQ,mI,gI,ig],pipes:[Xc],styles:[".options[_ngcontent-%COMP%]{flex-direction:row;flex-wrap:wrap;width:90%;padding-bottom:10px}"],changeDetection:0}),i})();function iEe(i,t){if(1&i&&yt(0,"app-qt-bool-component",2),2&i){const e=t.$implicit,n=Re();fe("boolTerm",n.boolTerm)("term",e)("possibleAttributes",n.possibleAttributes)}}let nEe=(()=>{class i{constructor(e,n,r){this.possibleAttributes=new gs(null),e.configAsObservable.subscribe(s=>{const a=[];s._config.query.boolean.forEach(l=>{const u=l;if(S4.getInputTypeValue(u.input)==_a.DYNAMICOPTIONS)return n.findDistinctElementsByColumn(),void r.getDistinct(u.table,u.col).pipe(Xl(),Ui(h=>h.sort())).forEach(h=>{a.push(new oy(u.display,u.table+"."+u.col,S4.getInputTypeValue(u.input),u.operators,h,u.shorthand,u.range,u.type)),this.possibleAttributes.next(a)});a.push(new oy(u.display,u.table+"."+u.col,S4.getInputTypeValue(u.input),u.operators,u.options,u.shorthand,u.range,u.type))}),this.possibleAttributes.next(a)})}ngOnInit(){0===this.boolTerm.terms.length&&this.addBoolTermComponent()}addBoolTermComponent(){this.boolTerm.terms.push(new T1e(this.possibleAttributes.getValue()[0].featureName,this.possibleAttributes.getValue()[0].operators[0],null))}}return i.\u0275fac=function(e){return new(e||i)(B(dr),B(nP),B(dH))},i.\u0275cmp=ei({type:i,selectors:[["app-qt-bool"]],inputs:{boolTerm:"boolTerm"},decls:4,vars:1,consts:[[3,"boolTerm","term","possibleAttributes",4,"ngFor","ngForOf"],["mat-icon-button","","matTooltip","Add boolean query term",3,"click"],[3,"boolTerm","term","possibleAttributes"]],template:function(e,n){1&e&&(Ue(0,iEe,1,3,"app-qt-bool-component",0),Z(1,"button",1),je("click",function(){return n.addBoolTermComponent()}),Z(2,"mat-icon"),ue(3,"add"),J()()),2&e&&fe("ngForOf",n.boolTerm.terms)},directives:[mo,tEe,Mo,Fo,vo],styles:[".options[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:nowrap}.textinput[_ngcontent-%COMP%]{width:90%}"]}),i})();var Fa=D(8407);function Ky(){return(Ky=Object.assign||function(i){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=e[n])}return i}).apply(this,arguments)}function ef(i,t){i.prototype=Object.create(t.prototype),i.prototype.constructor=i,i.__proto__=t}function DQ(i,t){return(DQ=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(i,t)}function rEe(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(i){return!1}}function RQ(i,t,e){return(RQ=rEe()?Reflect.construct:function(n,r,s){var a=[null];a.push.apply(a,r);var l=new(Function.bind.apply(n,a));return s&&DQ(l,s.prototype),l}).apply(null,arguments)}function zp(i,t,e,n){void 0===t&&(t=""),void 0===n&&(n={});var r=document.createElement(i);return t&&(r.className=t),Object.keys(n).forEach(function(s){if("function"==typeof n[s]){var a=0===s.indexOf("on")?s.substr(2).toLowerCase():s;r.addEventListener(a,n[s])}else"html"===s?r.innerHTML=n[s]:"text"===s?r.innerText=n[s]:r.setAttribute(s,n[s])}),e&&e.appendChild(r),r}function ME(i){i.preventDefault(),i.stopPropagation()}var CI=function(){for(var i=arguments.length,t=new Array(i),e=0;e<i;e++)t[e]=arguments[e];return t.filter(Boolean).join(" ").trim()};function G0(i,t){i&&i.classList&&(Array.isArray(t)?t:[t]).forEach(function(e){i.classList.contains(e)||i.classList.add(e)})}function Up(i,t){i&&i.classList&&(Array.isArray(t)?t:[t]).forEach(function(e){i.classList.contains(e)&&i.classList.remove(e)})}var uC,MI=13,D4=40,kQ=38,sEe=[MI,27,D4,kQ,37,39],oEe=function(){function i(e){var n=this,r=e.handleSubmit,s=e.searchLabel,a=e.classNames,l=void 0===a?{}:a;this.hasError=!1,this.container=zp("div",CI("geosearch",l.container)),this.form=zp("form",["",l.form].join(" "),this.container,{autocomplete:"none",onClick:ME,onDblClick:ME,touchStart:ME,touchEnd:ME}),this.input=zp("input",["glass",l.input].join(" "),this.form,{type:"text",placeholder:s||"search",onInput:this.onInput,onKeyUp:function(u){return n.onKeyUp(u)},onKeyPress:function(u){return n.onKeyPress(u)},onFocus:this.onFocus,onBlur:this.onBlur,onClick:function(){n.input.focus(),n.input.dispatchEvent(new Event("focus"))}}),this.handleSubmit=r}var t=i.prototype;return t.onFocus=function(){G0(this.form,"active")},t.onBlur=function(){Up(this.form,"active")},t.onSubmit=function(e){try{var n=this;return ME(e),Up(r=n.container,"error"),G0(r,"pending"),Promise.resolve(n.handleSubmit({query:n.input.value})).then(function(){Up(n.container,"pending")})}catch(s){return Promise.reject(s)}var r},t.onInput=function(){this.hasError&&(Up(this.container,"error"),this.hasError=!1)},t.onKeyUp=function(e){27===e.keyCode&&(Up(this.container,["pending","active"]),this.input.value="",document.body.focus(),document.body.blur())},t.onKeyPress=function(e){e.keyCode===MI&&this.onSubmit(e)},t.setQuery=function(e){this.input.value=e},i}(),aEe=function(){function i(e){var n=this,r=e.handleClick,s=e.classNames,a=void 0===s?{}:s,l=e.notFoundMessage;this.selected=-1,this.results=[],this.onClick=function(u){if("function"==typeof n.handleClick){var h=u.target;if(h&&n.container.contains(h)&&h.hasAttribute("data-key")){var m=Number(h.getAttribute("data-key"));n.clear(),n.handleClick({result:n.results[m]})}}},this.handleClick=r,this.notFoundMessage=l?zp("div",CI(a.notfound),void 0,{html:l}):void 0,this.container=zp("div",CI("results",a.resultlist)),this.container.addEventListener("click",this.onClick,!0),this.resultItem=zp("div",CI(a.item))}var t=i.prototype;return t.render=function(e,n){var r=this;void 0===e&&(e=[]),this.clear(),e.forEach(function(s,a){var l=r.resultItem.cloneNode(!0);l.setAttribute("data-key",""+a),l.innerHTML=n({result:s}),r.container.appendChild(l)}),e.length>0?(G0(this.container.parentElement,"open"),G0(this.container,"active")):this.notFoundMessage&&(this.container.appendChild(this.notFoundMessage),G0(this.container.parentElement,"open")),this.results=e},t.select=function(e){return Array.from(this.container.children).forEach(function(n,r){return r===e?G0(n,"active"):Up(n,"active")}),this.selected=e,this.results[e]},t.count=function(){return this.results?this.results.length:0},t.clear=function(){for(this.selected=-1;this.container.lastChild;)this.container.removeChild(this.container.lastChild);Up(this.container.parentElement,"open"),Up(this.container,"active")},i}(),PQ={position:"topleft",style:"button",showMarker:!0,showPopup:!1,popupFormat:function(i){return""+i.result.label},resultFormat:function(i){return""+i.result.label},marker:{icon:Fa&&Fa.Icon?new Fa.Icon.Default:void 0,draggable:!1},maxMarkers:1,maxSuggestions:5,retainZoomLevel:!1,animateZoom:!0,searchLabel:"Enter address",notFoundMessage:"",messageHideDelay:3e3,zoomLevel:18,classNames:{container:"leaflet-bar leaflet-control leaflet-control-geosearch",button:"leaflet-bar-part leaflet-bar-part-single",resetButton:"reset",msgbox:"leaflet-bar message",form:"",input:"",resultlist:"",item:"",notfound:"leaflet-bar-notfound"},autoComplete:!0,autoCompleteDelay:250,autoClose:!1,keepResult:!1,updateMap:!0},IQ="Leaflet must be loaded before instantiating the GeoSearch control",lEe={options:Ky({},PQ),classNames:Ky({},PQ.classNames),initialize:function(i){var t,e,n,r,s=this;if(!Fa)throw new Error(IQ);if(!i.provider)throw new Error("Provider is missing from options");this.options=Ky({},this.options,{},i),this.classNames=Ky({},this.classNames,{},i.classNames),this.markers=new Fa.FeatureGroup,this.classNames.container+=" leaflet-geosearch-"+this.options.style,this.searchElement=new oEe({searchLabel:this.options.searchLabel,classNames:{container:this.classNames.container,form:this.classNames.form,input:this.classNames.input},handleSubmit:function(a){return s.onSubmit(a)}}),this.button=zp("a",this.classNames.button,this.searchElement.container,{title:this.options.searchLabel,href:"#",onClick:function(a){return s.onClick(a)}}),Fa.DomEvent.disableClickPropagation(this.button),this.resetButton=zp("a",this.classNames.resetButton,this.searchElement.form,{text:"\xd7",href:"#",onClick:function(){return s.clearResults(null,!0)}}),Fa.DomEvent.disableClickPropagation(this.resetButton),this.options.autoComplete&&(this.resultList=new aEe({handleClick:function(a){var l=a.result;s.searchElement.input.value=l.label,s.onSubmit({query:l.label,data:l})},classNames:{resultlist:this.classNames.resultlist,item:this.classNames.item,notfound:this.classNames.notfound},notFoundMessage:this.options.notFoundMessage}),this.searchElement.form.appendChild(this.resultList.container),this.searchElement.input.addEventListener("keyup",(t=function(a){return s.autoSearch(a)},void 0===(e=this.options.autoCompleteDelay)&&(e=250),void 0===n&&(n=!1),function(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];r&&clearTimeout(r),r=setTimeout(function(){r=null,n||t.apply(void 0,l)},e),n&&!r&&t.apply(void 0,l)}),!0),this.searchElement.input.addEventListener("keydown",function(a){return s.selectResult(a)},!0),this.searchElement.input.addEventListener("keydown",function(a){return s.clearResults(a,!0)},!0)),this.searchElement.form.addEventListener("click",function(a){a.preventDefault()},!1)},onAdd:function(i){var t=this.options,e=t.showMarker,n=t.style;if(this.map=i,e&&this.markers.addTo(i),"bar"===n){var r=i.getContainer().querySelector(".leaflet-control-container");this.container=zp("div","leaflet-control-geosearch leaflet-geosearch-bar"),this.container.appendChild(this.searchElement.form),r.appendChild(this.container)}return Fa.DomEvent.disableClickPropagation(this.searchElement.form),this.searchElement.container},onRemove:function(){var i;return null==(i=this.container)||i.remove(),this},onClick:function(i){i.preventDefault(),i.stopPropagation();var t=this.searchElement,e=t.container,n=t.input;e.classList.contains("active")?(Up(e,"active"),this.clearResults()):(G0(e,"active"),n.focus())},selectResult:function(i){if(-1!==[MI,D4,kQ].indexOf(i.keyCode))if(i.preventDefault(),i.keyCode!==MI){var t=this.resultList.count()-1;if(!(t<0)){var e=this.resultList.selected,n=i.keyCode===D4?e+1:e-1,r=this.resultList.select(n<0?t:n>t?0:n);this.searchElement.input.value=r.label}}else{var s=this.resultList.select(this.resultList.selected);this.onSubmit({query:this.searchElement.input.value,data:s})}},clearResults:function(i,t){if(void 0===t&&(t=!1),!i||27===i.keyCode){var e=this.options,n=e.autoComplete;!t&&e.keepResult||(this.searchElement.input.value="",this.markers.clearLayers()),n&&this.resultList.clear()}},autoSearch:function(i){try{var t=this;if(sEe.indexOf(i.keyCode)>-1)return Promise.resolve();var e=i.target.value,n=t.options.provider,r=function(){if(e.length)return Promise.resolve(n.search({query:e})).then(function(s){s=s.slice(0,t.options.maxSuggestions),t.resultList.render(s,t.options.resultFormat)});t.resultList.clear()}();return Promise.resolve(r&&r.then?r.then(function(){}):void 0)}catch(s){return Promise.reject(s)}},onSubmit:function(i){try{var t=this;return Promise.resolve(t.options.provider.search(i)).then(function(e){e&&e.length>0&&t.showResult(e[0],i)})}catch(e){return Promise.reject(e)}},showResult:function(i,t){var e=this.options,n=e.autoClose,r=e.updateMap,s=this.markers.getLayers();s.length>=this.options.maxMarkers&&this.markers.removeLayer(s[0]);var a=this.addMarker(i,t);r&&this.centerMap(i),this.map.fireEvent("geosearch/showlocation",{location:i,marker:a}),n&&this.closeResults()},closeResults:function(){var i=this.searchElement.container;i.classList.contains("active")&&Up(i,"active"),this.clearResults()},addMarker:function(i,t){var e=this,n=this.options,r=n.marker,s=n.showPopup,a=n.popupFormat,l=new Fa.Marker([i.y,i.x],r),u=i.label;return"function"==typeof a&&(u=a({query:t,result:i})),l.bindPopup(u),this.markers.addLayer(l),s&&l.openPopup(),r.draggable&&l.on("dragend",function(h){e.map.fireEvent("geosearch/marker/dragend",{location:l.getLatLng(),event:h})}),l},centerMap:function(i){var t=this.options,e=t.retainZoomLevel,n=t.animateZoom,r=i.bounds?new Fa.LatLngBounds(i.bounds):new Fa.LatLng(i.y,i.x).toBounds(10),s=r.isValid()?r:this.markers.getBounds();!e&&r.isValid()&&!i.bounds||e||!r.isValid()?this.map.setView(s.getCenter(),this.getZoom(),{animate:n}):this.map.fitBounds(s,{animate:n})},getZoom:function(){var i=this.options,t=i.zoomLevel;return i.retainZoomLevel?this.map.getZoom():t}};function cEe(){if(!Fa)throw new Error(IQ);for(var i=Fa.Control.extend(lEe),t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return RQ(i,e)}!function(i){i[i.SEARCH=0]="SEARCH",i[i.REVERSE=1]="REVERSE"}(uC||(uC={}));var Gp=function(){function i(e){void 0===e&&(e={}),this.options=e}var t=i.prototype;return t.getParamString=function(e){void 0===e&&(e={});var n=Ky({},this.options.params,{},e);return Object.keys(n).map(function(r){return encodeURIComponent(r)+"="+encodeURIComponent(n[r])}).join("&")},t.getUrl=function(e,n){return e+"?"+this.getParamString(n)},t.search=function(e){try{var n=this,r=n.endpoint({query:e.query,type:uC.SEARCH});return Promise.resolve(fetch(r)).then(function(s){return Promise.resolve(s.json()).then(function(a){return n.parse({data:a})})})}catch(s){return Promise.reject(s)}},i}(),uEe=(function(i){function t(){return i.apply(this,arguments)||this}ef(t,i);var e=t.prototype;e.endpoint=function(){return"https://places-dsn.algolia.net/1/places/query"},e.findBestMatchLevelIndex=function(n){var r=n.find(function(s){return"full"===s.matchLevel})||n.find(function(s){return"partial"===s.matchLevel});return r?n.indexOf(r):0},e.getLabel=function(n){var r,s,a,l;return[null==(r=n.locale_names)?void 0:r.default[this.findBestMatchLevelIndex(n._highlightResult.locale_names.default)],null==(s=n.city)?void 0:s.default[this.findBestMatchLevelIndex(n._highlightResult.city.default)],n.administrative[this.findBestMatchLevelIndex(n._highlightResult.administrative)],null==(a=n.postcode)?void 0:a[this.findBestMatchLevelIndex(n._highlightResult.postcode)],null==(l=n.country)?void 0:l.default].filter(Boolean).join(", ")},e.parse=function(n){var r=this;return n.data.hits.map(function(s){return{x:s._geoloc.lng,y:s._geoloc.lat,label:r.getLabel(s),bounds:null,raw:s}})},e.search=function(n){var r=n.query;try{var s=this,a="string"==typeof r?{query:r}:r;return Promise.resolve(fetch(s.endpoint(),{method:"POST",body:JSON.stringify(Ky({},s.options.params,{},a))})).then(function(l){return Promise.resolve(l.json()).then(function(u){return s.parse({data:u})})})}catch(l){return Promise.reject(l)}}}(Gp),function(i){function t(){var n;return(n=i.apply(this,arguments)||this).searchUrl="https://dev.virtualearth.net/REST/v1/Locations",n}ef(t,i);var e=t.prototype;e.endpoint=function(n){var r=n.query,s="string"==typeof r?{q:r}:r;return s.jsonp=n.jsonp,this.getUrl(this.searchUrl,s)},e.parse=function(n){return 0===n.data.resourceSets.length?[]:n.data.resourceSets[0].resources.map(function(r){return{x:r.point.coordinates[1],y:r.point.coordinates[0],label:r.address.formattedAddress,bounds:[[r.bbox[0],r.bbox[1]],[r.bbox[2],r.bbox[3]]],raw:r}})},e.search=function(n){var r,s,a,l=n.query;try{var u=this,h="BING_JSONP_CB_"+Date.now();return Promise.resolve((r=u.endpoint({query:l,jsonp:h}),s=h,a=zp("script",null,document.body),a.setAttribute("type","text/javascript"),new Promise(function(m){window[s]=function(_){a.remove(),delete window[s],m(_)},a.setAttribute("src",r)}))).then(function(m){return u.parse({data:m})})}catch(m){return Promise.reject(m)}}}(Gp),function(i){function t(){var n;return(n=i.apply(this,arguments)||this).searchUrl="https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer/find",n}ef(t,i);var e=t.prototype;e.endpoint=function(n){var r=n.query,s="string"==typeof r?{text:r}:r;return s.f="json",this.getUrl(this.searchUrl,s)},e.parse=function(n){return n.data.locations.map(function(r){return{x:r.feature.geometry.x,y:r.feature.geometry.y,label:r.name,bounds:[[r.extent.ymin,r.extent.xmin],[r.extent.ymax,r.extent.xmax]],raw:r}})}}(Gp),function(i){function t(n){var r;return void 0===n&&(n={}),(r=i.call(this,n)||this).host=n.host||"http://localhost:4000",r}ef(t,i);var e=t.prototype;return e.endpoint=function(n){var r=n.query;return n.type===uC.REVERSE?this.getUrl(this.host+"/v1/reverse","string"==typeof r?{}:r):this.getUrl(this.host+"/v1/autocomplete","string"==typeof r?{text:r}:r)},e.parse=function(n){return n.data.features.map(function(r){var s={x:r.geometry.coordinates[0],y:r.geometry.coordinates[1],label:r.properties.label,bounds:null,raw:r};return Array.isArray(r.bbox)&&4===r.bbox.length&&(s.bounds=[[r.bbox[1],r.bbox[0]],[r.bbox[3],r.bbox[2]]]),s})},t}(Gp)),LQ=(function(i){ef(function t(e){return void 0===e&&(e={}),e.host="https://api.geocode.earth",i.call(this,e)||this},i)}(uEe),function(i){function t(){var n;return(n=i.apply(this,arguments)||this).searchUrl="https://maps.googleapis.com/maps/api/geocode/json",n}ef(t,i);var e=t.prototype;e.endpoint=function(n){var r=n.query;return this.getUrl(this.searchUrl,"string"==typeof r?{address:r}:r)},e.parse=function(n){return n.data.results.map(function(r){return{x:r.geometry.location.lng,y:r.geometry.location.lat,label:r.formatted_address,bounds:[[r.geometry.viewport.southwest.lat,r.geometry.viewport.southwest.lng],[r.geometry.viewport.northeast.lat,r.geometry.viewport.northeast.lng]],raw:r}})}}(Gp),function(i){function t(){var n;return(n=i.apply(this,arguments)||this).searchUrl="https://geocode.search.hereapi.com/v1/geocode",n}ef(t,i);var e=t.prototype;e.endpoint=function(n){var r=n.query;return this.getUrl(this.searchUrl,"string"==typeof r?{q:r}:r)},e.parse=function(n){return n.data.items.map(function(r){return{x:r.position.lng,y:r.position.lat,label:r.address.label,bounds:null,raw:r}})}}(Gp),function(i){function t(n){var r;void 0===n&&(n={});var s="https://nominatim.openstreetmap.org";return(r=i.call(this,n)||this).searchUrl=n.searchUrl||s+"/search",r.reverseUrl=n.reverseUrl||s+"/reverse",r}ef(t,i);var e=t.prototype;return e.endpoint=function(n){var r=n.query,s=n.type,a="string"==typeof r?{q:r}:r;return a.format="json",this.getUrl(s===uC.REVERSE?this.reverseUrl:this.searchUrl,a)},e.parse=function(n){return(Array.isArray(n.data)?n.data:[n.data]).map(function(r){return{x:Number(r.lon),y:Number(r.lat),label:r.display_name,bounds:[[parseFloat(r.boundingbox[0]),parseFloat(r.boundingbox[2])],[parseFloat(r.boundingbox[1]),parseFloat(r.boundingbox[3])]],raw:r}})},t}(Gp));(function(i){ef(function t(e){return i.call(this,Ky({},e,{searchUrl:"https://locationiq.org/v1/search.php",reverseUrl:"https://locationiq.org/v1/reverse.php"}))||this},i)})(LQ),function(i){function t(){var n;return(n=i.apply(this,arguments)||this).searchUrl="https://api.opencagedata.com/geocode/v1/json",n}ef(t,i);var e=t.prototype;e.endpoint=function(n){var r=n.query,s="string"==typeof r?{q:r}:r;return s.format="json",this.getUrl(this.searchUrl,s)},e.parse=function(n){return n.data.results.map(function(r){return{x:r.geometry.lng,y:r.geometry.lat,label:r.formatted,bounds:[[r.bounds.southwest.lat,r.bounds.southwest.lng],[r.bounds.northeast.lat,r.bounds.northeast.lng]],raw:r}})},e.search=function(n){try{return Promise.resolve(n.query.length<2?[]:i.prototype.search.call(this,n))}catch(r){return Promise.reject(r)}}}(Gp),function(i){function t(n){var r;return void 0===n&&(n={}),(r=i.call(this,n)||this).searchUrl=n.searchUrl||"https://a.tiles.mapbox.com/v4/geocode/mapbox.places/",r}ef(t,i);var e=t.prototype;e.endpoint=function(n){return this.getUrl(""+this.searchUrl+n.query+".json")},e.parse=function(n){return(Array.isArray(n.data.features)?n.data.features:[]).map(function(r){var s=null;return r.bbox&&(s=[[parseFloat(r.bbox[1]),parseFloat(r.bbox[0])],[parseFloat(r.bbox[3]),parseFloat(r.bbox[2])]]),{x:Number(r.center[0]),y:Number(r.center[1]),label:r.place_name?r.place_name:r.text,bounds:s,raw:r}})}}(Gp),function(i){function t(n){var r;void 0===n&&(n={});var s="https://api-adresse.data.gouv.fr";return(r=i.call(this,n)||this).searchUrl=n.searchUrl||s+"/search",r.reverseUrl=n.reverseUrl||s+"/reverse",r}ef(t,i);var e=t.prototype;e.endpoint=function(n){var r=n.query;return this.getUrl(n.type===uC.REVERSE?this.reverseUrl:this.searchUrl,"string"==typeof r?{q:r}:r)},e.parse=function(n){return n.data.features.map(function(r){return{x:r.geometry.coordinates[0],y:r.geometry.coordinates[1],label:r.properties.label,bounds:null,raw:r}})}}(Gp);let hEe=(()=>{class i{constructor(e,n){this._dialogRef=e,this._data=n,this.defaultLocation={latitude:0,longitude:0},this.location=n||this.defaultLocation}ngAfterViewInit(){this.initMap()}close(){this.map.eachLayer(e=>{if(e instanceof Fa.Marker){const n=e;this.location={latitude:n.getLatLng().lat,longitude:n.getLatLng().lng}}}),this.map.off(),this.map.remove(),this._dialogRef.close(this.location)}initMap(){console.log(`MapDialog: ${JSON.stringify(this.location)}`),this.map=new Fa.Map("mainmap",{center:[this.location.latitude,this.location.longitude],zoom:2}),this.clickMarkerGroup=new Fa.FeatureGroup;const e=new Fa.TileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:18,minZoom:0,attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'});this.clickMarkerGroup.addTo(this.map),e.addTo(this.map),this.map.on("click",s=>{this.map.eachLayer(l=>{l instanceof Fa.Marker&&this.map.removeLayer(l)}),new Fa.Marker(s.latlng).addTo(this.clickMarkerGroup)});const r=new cEe({provider:new LQ,style:"bar"});r.markers.on("layeradd",s=>{this.clickMarkerGroup.clearLayers()}),this.map.addControl(r)}}return i.\u0275fac=function(e){return new(e||i)(B(Ip),B(Cy))},i.\u0275cmp=ei({type:i,selectors:[["app-map-dialog"]],decls:11,vars:0,consts:[[2,"height","100%"],["color","primary"],[1,"spacer-flex"],["mat-icon-button","",3,"click"],["matTooltip","Close window and save."],[1,"map-container"],[1,"map-frame"],["id","mainmap"]],template:function(e,n){1&e&&(Z(0,"mat-dialog-content",0)(1,"mat-toolbar",1)(2,"h3"),ue(3,"Spatial Query Term"),J(),yt(4,"span",2),Z(5,"button",3),je("click",function(){return n.close()}),Z(6,"mat-icon",4),ue(7,"close"),J()()(),Z(8,"div",5)(9,"div",6),yt(10,"div",7),J()()())},directives:[cS,My,Mo,vo,Fo],styles:[".map-container[_ngcontent-%COMP%]{margin:auto;height:600px;width:800px;padding:20px}.map-frame[_ngcontent-%COMP%], #mainmap[_ngcontent-%COMP%]{height:100%}"]}),i})();const dEe=["mapdiv"];let fEe=(()=>{class i{constructor(e){this.dialog=e,this.defaultLocation={latitude:0,longitude:0}}ngAfterViewInit(){console.log("On AfterInit"),this.initMiniMap()}openMapDialog(){this.dialog.open(hEe,{width:"900px",height:"800px"}).afterClosed().pipe(Xl()).subscribe(n=>{n&&(console.log(`RESULT: ${JSON.stringify(n)}`),this.locationTerm.location=n,this.locationTerm.write(),console.log(`TERM: ${JSON.stringify(this.locationTerm)}`)),this.reInitMap()})}ngOnInit(){console.log("On Init"),this.locationTerm&&this.locationTerm.read()}ngOnDestroy(){this.minimap&&(console.log("Destroy"),this.minimap.off(),this.minimap.remove())}initMiniMap(e=2){console.log(`LocationTerm: ${JSON.stringify(this.locationTerm)}`),this.minimap?this.reInitMap():(console.log("initMap"),this.minimap=new Fa.Map(this.map.nativeElement,{center:this.locationTerm&&this.locationTerm.location?[this.locationTerm.location.latitude,this.locationTerm.location.longitude]:[this.defaultLocation.latitude,this.defaultLocation.longitude],zoom:e,zoomControl:!1,attributionControl:!1,dragging:!1}),new Fa.TileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:18,minZoom:0,attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(this.minimap),this.minimap.invalidateSize(!1),this.locationTerm&&this.locationTerm.location&&this.setMarkerIfNeeded(),console.log("fin"))}reInitMap(){const e=this.locationTerm&&this.locationTerm.location?this.locationTerm.location:this.defaultLocation;this.minimap.setView(new Fa.LatLng(e.latitude,e.longitude),2),this.setMarkerIfNeeded()}setMarkerIfNeeded(){new Fa.Marker(new Fa.LatLng(this.locationTerm.location.latitude,this.locationTerm.location.longitude)).addTo(this.minimap)}}return i.\u0275fac=function(e){return new(e||i)(B(Lu))},i.\u0275cmp=ei({type:i,selectors:[["app-map-query-term"]],viewQuery:function(e,n){if(1&e&&ji(dEe,7),2&e){let r;jt(r=qt())&&(n.map=r.first)}},inputs:{locationTerm:"locationTerm"},decls:5,vars:0,consts:[[1,"map-container"],[1,"map-frame",3,"click"],["id","map"],["mapdiv",""]],template:function(e,n){1&e&&(Z(0,"div")(1,"div",0)(2,"div",1),je("click",function(){return n.openMapDialog()}),yt(3,"div",2,3),J()()())},styles:[".map-container[_ngcontent-%COMP%]{margin:30px;height:180px;width:180px}.map-frame[_ngcontent-%COMP%]{border:2px solid black;height:100%}#map[_ngcontent-%COMP%]{height:100%}"]}),i})();var ul,OQ=Object.defineProperty,FQ=(i,t)=>{for(var e in t)OQ(i,e,{get:t[e],enumerable:!0})},Ie=(i,t,e)=>(((i,t,e)=>{t in i?OQ(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e})(i,"symbol"!=typeof t?t+"":t,e),e),Ji={move:"M",line:"L",curve:"C",arc:"A",close:"Z"},BQ={};FQ(BQ,{HALF_PI:()=>_c,NumArray:()=>Wp,TWO_PI:()=>cu,decomposeMatrix:()=>TE,getComputedMatrix:()=>W0,getPoT:()=>VQ,lerp:()=>qh,mod:()=>Xh,setMatrix:()=>HQ,toFixed:()=>hl}),"undefined"!=typeof window?ul=window:"undefined"!=typeof global?ul=global:"undefined"!=typeof self&&(ul=self);var NQ,cu=2*Math.PI,_c=.5*Math.PI;function TE(i,t,e,n,r,s){let a;return arguments.length<=1?(a=i.a,t=i.b,e=i.c,n=i.d,r=i.e,s=i.f):a=i,{translateX:r,translateY:s,scaleX:Math.sqrt(a*a+t*t),scaleY:Math.sqrt(e*e+n*n),rotation:180*Math.atan2(t,a)/Math.PI}}function HQ(i){NQ=i}function W0(i,t){t=t&&t.identity()||new NQ;let e=i;const n=[];for(;e&&e._matrix;)n.push(e._matrix),e=e.parent;n.reverse();for(let r=0;r<n.length;r++){const a=n[r].elements;t.multiply(a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9])}return t}function qh(i,t,e){return e*(t-i)+i}var R4=[2,4,8,16,32,64,128,256,512,1024,2048,4096];function VQ(i){let t=0;for(;R4[t]&&R4[t]<i;)t++;return R4[t]}function Xh(i,t){for(;i<0;)i+=t;return i%t}var Wp=ul.Float32Array||Array,mEe=Math.floor;function hl(i){return mEe(1e6*i)/1e6}var zQ={};FQ(zQ,{Curve:()=>hC,getAnchorsFromArcData:()=>_Ee,getComponentOnCubicBezier:()=>EE,getControlPoints:()=>ZQ,getCurveBoundingBox:()=>jQ,getCurveFromPoints:()=>XQ,getCurveLength:()=>WQ,getReflection:()=>P4,integrate:()=>qQ,subdivide:()=>k4});var Mi=class{constructor(){Ie(this,"_events",{}),Ie(this,"_bound",!1)}addEventListener(i,t){return(this._events[i]||(this._events[i]=[])).push(t),this._bound=!0,this}on(){return this.addEventListener.apply(this,arguments)}bind(){return this.addEventListener.apply(this,arguments)}removeEventListener(i,t){if(!this._events)return this;if(!i&&!t)return this._events={},this._bound=!1,this;const e=i?[i]:Object.keys(this._events);for(let n=0,r=e.length;n<r;n++){let s=this._events[i=e[n]];if(s){let a=[];if(t)for(let l=0,u=s.length;l<u;l++){let h=s[l];h=h.handler?h.handler:h,t!==h&&a.push(h)}this._events[i]=a}}return this}off(){return this.removeEventListener.apply(this,arguments)}unbind(){return this.removeEventListener.apply(this,arguments)}dispatchEvent(i){if(!this._events)return this;const t=Array.prototype.slice.call(arguments,1),e=this._events[i];if(e)for(let n=0;n<e.length;n++)e[n].call(this,...t);return this}trigger(){return this.dispatchEvent.apply(this,arguments)}listen(i,t,e){const n=this;function r(){e.apply(n,arguments)}return i&&(r.obj=i,r.name=t,r.handler=e,i.on(t,r)),n}ignore(i,t,e){return i.off(t,e),this}};Ie(Mi,"Types",{play:"play",pause:"pause",update:"update",render:"render",resize:"resize",change:"change",remove:"remove",insert:"insert",order:"order",load:"load"}),Ie(Mi,"Methods",["addEventListener","on","removeEventListener","off","unbind","dispatchEvent","trigger","listen","ignore"]);var UQ={x:{enumerable:!0,get:function(){return this._x},set:function(i){this._x!==i&&(this._x=i,this._bound&&this.dispatchEvent(Mi.Types.change))}},y:{enumerable:!0,get:function(){return this._y},set:function(i){this._y!==i&&(this._y=i,this._bound&&this.dispatchEvent(Mi.Types.change))}}},j0=class extends Mi{constructor(i=0,t=0){super(),Ie(this,"_x",0),Ie(this,"_y",0);for(let e in UQ)Object.defineProperty(this,e,UQ[e]);this.x=i,this.y=t}static add(i,t){return new j0(i.x+t.x,i.y+t.y)}static sub(i,t){return new j0(i.x-t.x,i.y-t.y)}static subtract(i,t){return j0.sub(i,t)}static ratioBetween(i,t){return(i.x*t.x+i.y*t.y)/(i.length()*t.length())}static angleBetween(i,t){return arguments.length>=4?Math.atan2(arguments[1]-arguments[3],arguments[0]-arguments[2]):Math.atan2(i.y-t.y,i.x-t.x)}static distanceBetween(i,t){return Math.sqrt(j0.distanceBetweenSquared(i,t))}static distanceBetweenSquared(i,t){const e=i.x-t.x,n=i.y-t.y;return e*e+n*n}set(i,t){return this.x=i,this.y=t,this}copy(i){return this.x=i.x,this.y=i.y,this}clear(){return this.x=0,this.y=0,this}clone(){return new j0(this.x,this.y)}add(i,t){return arguments.length<=0||(arguments.length<=1?"number"==typeof i?(this.x+=i,this.y+=i):i&&"number"==typeof i.x&&"number"==typeof i.y&&(this.x+=i.x,this.y+=i.y):(this.x+=i,this.y+=t)),this}addSelf(i){return this.add.apply(this,arguments)}sub(i,t){return arguments.length<=0||(arguments.length<=1?"number"==typeof i?(this.x-=i,this.y-=i):i&&"number"==typeof i.x&&"number"==typeof i.y&&(this.x-=i.x,this.y-=i.y):(this.x-=i,this.y-=t)),this}subtract(){return this.sub.apply(this,arguments)}subSelf(i){return this.sub.apply(this,arguments)}subtractSelf(i){return this.sub.apply(this,arguments)}multiply(i,t){return arguments.length<=0||(arguments.length<=1?"number"==typeof i?(this.x*=i,this.y*=i):i&&"number"==typeof i.x&&"number"==typeof i.y&&(this.x*=i.x,this.y*=i.y):(this.x*=i,this.y*=t)),this}multiplySelf(i){return this.multiply.apply(this,arguments)}multiplyScalar(i){return this.multiply(i)}divide(i,t){return arguments.length<=0||(arguments.length<=1?"number"==typeof i?(this.x/=i,this.y/=i):i&&"number"==typeof i.x&&"number"==typeof i.y&&(this.x/=i.x,this.y/=i.y):(this.x/=i,this.y/=t),isNaN(this.x)&&(this.x=0),isNaN(this.y)&&(this.y=0)),this}divideSelf(i){return this.divide.apply(this,arguments)}divideScalar(i){return this.divide(i)}negate(){return this.multiply(-1)}dot(i){return this.x*i.x+this.y*i.y}length(){return Math.sqrt(this.lengthSquared())}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){return this.divideScalar(this.length())}distanceTo(i){return Math.sqrt(this.distanceToSquared(i))}distanceToSquared(i){const t=this.x-i.x,e=this.y-i.y;return t*t+e*e}setLength(i){return this.normalize().multiplyScalar(i)}equals(i,t){return t=void 0===t?1e-4:t,this.distanceTo(i)<t}lerp(i,t){return this.set((i.x-this.x)*t+this.x,(i.y-this.y)*t+this.y)}isZero(i){return i=void 0===i?1e-4:i,this.length()<i}toString(){return this.x+", "+this.y}toObject(){return{x:this.x,y:this.y}}rotate(i){const t=this.x,e=this.y,n=Math.cos(i),r=Math.sin(i);return this.x=t*n-e*r,this.y=t*r+e*n,this}},gn=j0;Ie(gn,"zero",new j0);var Ds=class extends gn{constructor(i=0,t=0,e=0,n=0,r=0,s=0,a=Ji.move){super(i,t),Ie(this,"controls",{left:new gn,right:new gn}),Ie(this,"_command",Ji.move),Ie(this,"_relative",!0),Ie(this,"_rx",0),Ie(this,"_ry",0),Ie(this,"_xAxisRotation",0),Ie(this,"_largeArcFlag",0),Ie(this,"_sweepFlag",1);for(let u in GQ)Object.defineProperty(this,u,GQ[u]);this.command=a,this.relative=!0;const l=Ds.makeBroadcast(this);this.controls.left.set(e,n).addEventListener(Mi.Types.change,l),this.controls.right.set(r,s).addEventListener(Mi.Types.change,l)}static makeBroadcast(i){return function t(){i._bound&&i.dispatchEvent(Mi.Types.change)}}copy(i){return this.x=i.x,this.y=i.y,"string"==typeof i.command&&(this.command=i.command),i.controls&&(i.controls.left&&this.controls.left.copy(i.controls.left),i.controls.right&&this.controls.right.copy(i.controls.right)),"boolean"==typeof i.relative&&(this.relative=i.relative),"number"==typeof i.rx&&(this.rx=i.rx),"number"==typeof i.ry&&(this.ry=i.ry),"number"==typeof i.xAxisRotation&&(this.xAxisRotation=i.xAxisRotation),"number"==typeof i.largeArcFlag&&(this.largeArcFlag=i.largeArcFlag),"number"==typeof i.sweepFlag&&(this.sweepFlag=i.sweepFlag),this}clone(){return(new Ds).copy(this)}toObject(){return{x:this.x,y:this.y,command:this.command,relative:this.relative,controls:{left:this.controls.left.toObject(),right:this.controls.right.toObject()},rx:this.rx,ry:this.ry,xAxisRotation:this.xAxisRotation,largeArcFlag:this.largeArcFlag,sweepFlag:this.sweepFlag}}toString(){return JSON.stringify(this.toObject())}},GQ={command:{enumerable:!0,get:function(){return this._command},set:function(i){this._command!==i&&(this._command=i,this._bound&&this.dispatchEvent(Mi.Types.change))}},relative:{enumerable:!0,get:function(){return this._relative},set:function(i){this._relative!==!!i&&(this._relative=!!i,this._bound&&this.dispatchEvent(Mi.Types.change))}},rx:{enumerable:!0,get:function(){return this._rx},set:function(i){this._rx!==i&&(this._rx=i,this._bound&&this.dispatchEvent(Mi.Types.change))}},ry:{enumerable:!0,get:function(){return this._ry},set:function(i){this._ry!==i&&(this._ry=i,this._bound&&this.dispatchEvent(Mi.Types.change))}},xAxisRotation:{enumerable:!0,get:function(){return this._xAxisRotation},set:function(i){this._xAxisRotation!==i&&(this._xAxisRotation=i,this._bound&&this.dispatchEvent(Mi.Types.change))}},largeArcFlag:{enumerable:!0,get:function(){return this._largeArcFlag},set:function(i){this._largeArcFlag!==i&&(this._largeArcFlag=i,this._bound&&this.dispatchEvent(Mi.Types.change))}},sweepFlag:{get:function(){return this._sweepFlag},set:function(i){this._sweepFlag!==i&&(this._sweepFlag=i,this._bound&&this.dispatchEvent(Mi.Types.change))}}},gEe=0,$l_uniqueId=function(){return gEe++},hC={CollinearityEpsilon:Math.pow(10,-30),RecursionLimit:16,CuspLimit:0,Tolerance:{distance:.25,angle:0,epsilon:Number.EPSILON},abscissas:[[.5773502691896257],[0,.7745966692414834],[.33998104358485626,.8611363115940526],[0,.5384693101056831,.906179845938664],[.2386191860831969,.6612093864662645,.932469514203152],[0,.4058451513773972,.7415311855993945,.9491079123427585],[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499]],weights:[[1],[.8888888888888888,.5555555555555556],[.6521451548625461,.34785484513745385],[.5688888888888889,.47862867049936647,.23692688505618908],[.46791393457269104,.3607615730481386,.17132449237917036],[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096]]};function EE(i,t,e,n,r){const s=1-i;return s*s*s*t+3*s*s*i*e+3*s*i*i*n+i*i*i*r}function k4(i,t,e,n,r,s,a,l,u){const h=(u=u||hC.RecursionLimit)+1;if(Math.abs(i-a)<.001&&Math.abs(t-l)<.001)return[new Ds(a,l)];const m=[];for(let _=0;_<h;_++){const v=_/h,S=EE(v,i,e,r,a),T=EE(v,t,n,s,l);m.push(new Ds(S,T))}return m}function WQ(i,t,e,n,r,s,a,l,u){if(i===e&&t===n&&r===a&&s===l){const j=a-i,P=l-t;return Math.sqrt(j*j+P*P)}const h=9*(e-r)+3*(a-i),m=6*(i+r)-12*e,_=3*(e-i),v=9*(n-s)+3*(l-t),S=6*(t+s)-12*n,T=3*(n-t);return qQ(function I(j){const P=(h*j+m)*j+_,E=(v*j+S)*j+T;return Math.sqrt(P*P+E*E)},0,1,u||hC.RecursionLimit)}function jQ(i,t,e,n,r,s,a,l){const u=[],h=[[],[]];let m,_,v,S,T,I,j,P;for(let ce=0;ce<2;++ce)if(0==ce?(_=6*i-12*e+6*r,m=-3*i+9*e-9*r+3*a,v=3*e-3*i):(_=6*t-12*n+6*s,m=-3*t+9*n-9*s+3*l,v=3*n-3*t),Math.abs(m)<1e-12){if(Math.abs(_)<1e-12)continue;S=-v/_,0<S&&S<1&&u.push(S)}else j=_*_-4*v*m,P=Math.sqrt(j),!(j<0)&&(T=(-_+P)/(2*m),0<T&&T<1&&u.push(T),I=(-_-P)/(2*m),0<I&&I<1&&u.push(I));let ee,E=u.length,ie=E;for(;E--;)S=u[E],ee=1-S,h[0][E]=ee*ee*ee*i+3*ee*ee*S*e+3*ee*S*S*r+S*S*S*a,h[1][E]=ee*ee*ee*t+3*ee*ee*S*n+3*ee*S*S*s+S*S*S*l;return h[0][ie]=i,h[1][ie]=t,h[0][ie+1]=a,h[1][ie+1]=l,h[0].length=h[1].length=ie+2,{min:{x:Math.min.apply(0,h[0]),y:Math.min.apply(0,h[1])},max:{x:Math.max.apply(0,h[0]),y:Math.max.apply(0,h[1])}}}function qQ(i,t,e,n){let r=hC.abscissas[n-2],s=hC.weights[n-2],a=.5*(e-t),l=a+t,u=0,h=n+1>>1,m=1&n?s[u++]*i(l):0;for(;u<h;){const _=a*r[u];m+=s[u++]*(i(l+_)+i(l-_))}return a*m}function XQ(i,t){const e=i.length,n=e-1;for(let r=0;r<e;r++){const s=i[r],a=t?Xh(r-1,e):Math.max(r-1,0),l=t?Xh(r+1,e):Math.min(r+1,n),h=s;ZQ(i[a],h,i[l]),h.command=0===r?Ji.move:Ji.curve}}function ZQ(i,t,e){const n=gn.angleBetween(i,t),r=gn.angleBetween(e,t);let s=gn.distanceBetween(i,t),a=gn.distanceBetween(e,t),l=(n+r)/2;return s<1e-4||a<1e-4?("boolean"==typeof t.relative&&!t.relative&&(t.controls.left.copy(t),t.controls.right.copy(t)),t):(s*=.33,a*=.33,r<n?l+=_c:l-=_c,t.controls.left.x=Math.cos(l)*s,t.controls.left.y=Math.sin(l)*s,l-=Math.PI,t.controls.right.x=Math.cos(l)*a,t.controls.right.y=Math.sin(l)*a,"boolean"==typeof t.relative&&!t.relative&&(t.controls.left.x+=t.x,t.controls.left.y+=t.y,t.controls.right.x+=t.x,t.controls.right.y+=t.y),t)}function P4(i,t,e){return new gn(2*i.x-(t.x+i.x)-(e?i.x:0),2*i.y-(t.y+i.y)-(e?i.y:0))}function _Ee(i,t,e,n,r,s,a){const u=[];for(let h=0;h<12;h++){let m=(h+1)/12;a&&(m=1-m);const _=m*s+r,v=e*Math.cos(_),S=n*Math.sin(_),T=new Ds(v,S);T.command=Ji.line,u.push(T)}}var yEe=ul.devicePixelRatio||1;function I4(i){return yEe/function vEe(i){return i.webkitBackingStorePixelRatio||i.mozBackingStorePixelRatio||i.msBackingStorePixelRatio||i.oBackingStorePixelRatio||i.backingStorePixelRatio||1}(i)}var YQ=Array.prototype.slice,er={isNaN:function(i){return"number"==typeof i&&i!==+i},isElement:function(i){return!(!i||1!==i.nodeType)},isObject:function(i){const t=typeof i;return"function"===t||"object"===t&&!!i},extend:function(i){const t=YQ.call(arguments,1);for(let e=0;e<t.length;e++){const n=t[e];for(let r in n)i[r]=n[r]}return i},defaults:function(i){const t=YQ.call(arguments,1);for(let e=0;e<t.length;e++){const n=t[e];for(let r in n)void 0===i[r]&&(i[r]=n[r])}return i},each:function(i,t,e){const n=e||this,r=!function bEe(i){if(null==i)return!1;const t=i.length;return"number"==typeof t&&t>=0&&t<4294967296}(i)&&Object.keys(i),s=(r||i).length;for(let a=0;a<s;a++){const l=r?r[a]:a;t.call(n,i[l],l,i)}return i},performance:ul.performance&&ul.performance.now?ul.performance:Date},TI=class extends Mi{constructor(){super(),Ie(this,"_flagId",!1),Ie(this,"_flagClassName",!1),Ie(this,"_renderer",{}),Ie(this,"_id",""),Ie(this,"_className",""),Ie(this,"classList",[]);for(let i in KQ)Object.defineProperty(this,i,KQ[i])}flagReset(){this._flagId=this._flagClassName=!1}},KQ={renderer:{enumerable:!1,get:function(){return this._renderer}},id:{enumerable:!0,get:function(){return this._id},set:function(i){const t=this._id;i!==this._id&&(this._id=i,this._flagId=!0,this.parent&&(delete this.parent.children.ids[t],this.parent.children.ids[this._id]=this))}},className:{enumerable:!0,get:function(){return this._className},set:function(i){this._className!==i&&(this._flagClassName=!0,this.classList=i.split(/\s+?/),this._className=i)}}},xEe=Math.cos,wEe=Math.sin,QQ=Math.tan,L4=[],tf=class extends Mi{constructor(i,t,e,n,r,s){super(),Ie(this,"elements",new Wp(9)),Ie(this,"manual",!1);let a=i;Array.isArray(a)||(a=Array.prototype.slice.call(arguments)),this.identity(),a.length>0&&this.set(a)}static Multiply(i,t,e){if(t.length<=3){let ye,Ce,Ge;const Qe=t[0]||0,nt=t[1]||0,ge=t[2]||0;return ye=i[0]*Qe+i[1]*nt+i[2]*ge,Ce=i[3]*Qe+i[4]*nt+i[5]*ge,Ge=i[6]*Qe+i[7]*nt+i[8]*ge,{x:ye,y:Ce,z:Ge}}const n=i[0],r=i[1],s=i[2],a=i[3],l=i[4],u=i[5],h=i[6],m=i[7],_=i[8],v=t[0],S=t[1],T=t[2],I=t[3],j=t[4],P=t[5],E=t[6],ie=t[7],ee=t[8];return(e=e||new Wp(9))[0]=n*v+r*I+s*E,e[1]=n*S+r*j+s*ie,e[2]=n*T+r*P+s*ee,e[3]=a*v+l*I+u*E,e[4]=a*S+l*j+u*ie,e[5]=a*T+l*P+u*ee,e[6]=h*v+m*I+_*E,e[7]=h*S+m*j+_*ie,e[8]=h*T+m*P+_*ee,e}set(i,t,e,n,r,s,a,l,u){if(void 0===t){const h=i;i=h[0],t=h[1],e=h[2],n=h[3],r=h[4],s=h[5],a=h[6],l=h[7],u=h[8]}return this.elements[0]=i,this.elements[1]=t,this.elements[2]=e,this.elements[3]=n,this.elements[4]=r,this.elements[5]=s,this.elements[6]=a,this.elements[7]=l,this.elements[8]=u,this.trigger(Mi.Types.change)}copy(i){return this.elements[0]=i.elements[0],this.elements[1]=i.elements[1],this.elements[2]=i.elements[2],this.elements[3]=i.elements[3],this.elements[4]=i.elements[4],this.elements[5]=i.elements[5],this.elements[6]=i.elements[6],this.elements[7]=i.elements[7],this.elements[8]=i.elements[8],this.manual=i.manual,this.trigger(Mi.Types.change)}identity(){return this.elements[0]=tf.Identity[0],this.elements[1]=tf.Identity[1],this.elements[2]=tf.Identity[2],this.elements[3]=tf.Identity[3],this.elements[4]=tf.Identity[4],this.elements[5]=tf.Identity[5],this.elements[6]=tf.Identity[6],this.elements[7]=tf.Identity[7],this.elements[8]=tf.Identity[8],this.trigger(Mi.Types.change)}multiply(i,t,e,n,r,s,a,l,u){if(void 0===t)return this.elements[0]*=i,this.elements[1]*=i,this.elements[2]*=i,this.elements[3]*=i,this.elements[4]*=i,this.elements[5]*=i,this.elements[6]*=i,this.elements[7]*=i,this.elements[8]*=i,this.trigger(Mi.Types.change);if(void 0===n)return{x:(r=this.elements)[0]*(i=i||0)+r[1]*(t=t||0)+r[2]*(e=e||0),y:r[3]*i+r[4]*t+r[5]*e,z:r[6]*i+r[7]*t+r[8]*e};const h=this.elements,m=[i,t,e,n,r,s,a,l,u],_=h[0],v=h[1],S=h[2],T=h[3],I=h[4],j=h[5],P=h[6],E=h[7],ie=h[8],ee=m[0],ce=m[1],ye=m[2],Ce=m[3],Ge=m[4],Qe=m[5],nt=m[6],ge=m[7],Je=m[8];return this.elements[0]=_*ee+v*Ce+S*nt,this.elements[1]=_*ce+v*Ge+S*ge,this.elements[2]=_*ye+v*Qe+S*Je,this.elements[3]=T*ee+I*Ce+j*nt,this.elements[4]=T*ce+I*Ge+j*ge,this.elements[5]=T*ye+I*Qe+j*Je,this.elements[6]=P*ee+E*Ce+ie*nt,this.elements[7]=P*ce+E*Ge+ie*ge,this.elements[8]=P*ye+E*Qe+ie*Je,this.trigger(Mi.Types.change)}inverse(i){const t=this.elements;i=i||new tf;const e=t[0],n=t[1],r=t[2],s=t[3],a=t[4],l=t[5],u=t[6],h=t[7],m=t[8],_=m*a-l*h,v=-m*s+l*u,S=h*s-a*u;let T=e*_+n*v+r*S;return T?(T=1/T,i.elements[0]=_*T,i.elements[1]=(-m*n+r*h)*T,i.elements[2]=(l*n-r*a)*T,i.elements[3]=v*T,i.elements[4]=(m*e-r*u)*T,i.elements[5]=(-l*e+r*s)*T,i.elements[6]=S*T,i.elements[7]=(-h*e+n*u)*T,i.elements[8]=(a*e-n*s)*T,i):null}scale(i,t){return arguments.length<=1&&(t=i),this.multiply(i,0,0,0,t,0,0,0,1)}rotate(i){const t=xEe(i),e=wEe(i);return this.multiply(t,-e,0,e,t,0,0,0,1)}translate(i,t){return this.multiply(1,0,i,0,1,t,0,0,1)}skewX(i){const t=QQ(i);return this.multiply(1,t,0,0,1,0,0,0,1)}skewY(i){const t=QQ(i);return this.multiply(1,0,0,t,1,0,0,0,1)}toString(i){return L4.length=0,this.toTransformArray(i,L4),L4.map(hl).join(" ")}toTransformArray(i,t){const e=this.elements,n=!!t,r=e[0],s=e[1],a=e[2],l=e[3],u=e[4],h=e[5];if(i){const m=e[6],_=e[7],v=e[8];return n?(t[0]=r,t[1]=l,t[2]=m,t[3]=s,t[4]=u,t[5]=_,t[6]=a,t[7]=h,void(t[8]=v)):[r,l,m,s,u,_,a,h,v]}return n?(t[0]=r,t[1]=l,t[2]=s,t[3]=u,t[4]=a,void(t[5]=h)):[r,l,s,u,a,h]}toArray(i,t){const e=this.elements,n=!!t,r=e[0],s=e[1],a=e[2],l=e[3],u=e[4],h=e[5];if(i){const m=e[6],_=e[7],v=e[8];return n?(t[0]=r,t[1]=s,t[2]=a,t[3]=l,t[4]=u,t[5]=h,t[6]=m,t[7]=_,void(t[8]=v)):[r,s,a,l,u,h,m,_,v]}return n?(t[0]=r,t[1]=s,t[2]=a,t[3]=l,t[4]=u,void(t[5]=h)):[r,s,a,l,u,h]}toObject(){return{elements:this.toArray(!0),manual:!!this.manual}}clone(){return(new tf).copy(this)}},Rg=tf;Ie(Rg,"Identity",[1,0,0,0,1,0,0,0,1]),HQ(Rg);var Qy=class extends TI{constructor(){super(),Ie(this,"_flagMatrix",!0),Ie(this,"_flagScale",!1),Ie(this,"_matrix",null),Ie(this,"_worldMatrix",null),Ie(this,"_position",null),Ie(this,"_rotation",0),Ie(this,"_scale",1),Ie(this,"_skewX",0),Ie(this,"_skewY",0);for(let i in EI)Object.defineProperty(this,i,EI[i]);this._renderer.flagMatrix=JQ.bind(this),this.isShape=!0,this.id="two-"+$l_uniqueId(),this.matrix=new Rg,this.worldMatrix=new Rg,this.position=new gn,this.rotation=0,this.scale=1,this.skewX=0,this.skewY=0}get renderer(){return this._renderer}set renderer(i){this._renderer=i}get translation(){return EI.position.get.apply(this,arguments)}set translation(i){EI.position.set.apply(this,arguments)}addTo(i){return i.add(this),this}remove(){return this.parent?(this.parent.remove(this),this):this}clone(i){const t=new Qy;return t.position.copy(this.position),t.rotation=this.rotation,t.scale=this.scale,t.skewX=this.skewX,t.skewY=this.skewY,this.matrix.manual&&t.matrix.copy(this.matrix),i&&i.add(t),t._update()}_update(i){return!this._matrix.manual&&this._flagMatrix&&(this._matrix.identity().translate(this.position.x,this.position.y),this._scale instanceof gn?this._matrix.scale(this._scale.x,this._scale.y):this._matrix.scale(this._scale),this._matrix.rotate(this.rotation),this._matrix.skewX(this.skewX),this._matrix.skewY(this.skewY)),i&&this.parent&&this.parent._update&&this.parent._update(),this}flagReset(){return this._flagMatrix=this._flagScale=!1,super.flagReset.call(this),this}},EI={position:{enumerable:!0,get:function(){return this._position},set:function(i){this._position&&this._position.unbind(Mi.Types.change,this._renderer.flagMatrix),this._position=i,this._position.bind(Mi.Types.change,this._renderer.flagMatrix),JQ.call(this)}},rotation:{enumerable:!0,get:function(){return this._rotation},set:function(i){this._rotation=i,this._flagMatrix=!0}},scale:{enumerable:!0,get:function(){return this._scale},set:function(i){this._scale instanceof gn&&this._scale.unbind(Mi.Types.change,this._renderer.flagMatrix),this._scale=i,this._scale instanceof gn&&this._scale.bind(Mi.Types.change,this._renderer.flagMatrix),this._flagMatrix=!0,this._flagScale=!0}},skewX:{enumerable:!0,get:function(){return this._skewX},set:function(i){this._skewX=i,this._flagMatrix=!0}},skewY:{enumerable:!0,get:function(){return this._skewY},set:function(i){this._skewY=i,this._flagMatrix=!0}},matrix:{enumerable:!0,get:function(){return this._matrix},set:function(i){this._matrix=i,this._flagMatrix=!0}},worldMatrix:{enumerable:!0,get:function(){return W0(this,this._worldMatrix),this._worldMatrix},set:function(i){this._worldMatrix=i}}};function JQ(){this._flagMatrix=!0}var Jy=class extends Array{constructor(){super(),Ie(this,"_events",new Mi),arguments[0]&&Array.isArray(arguments[0])?arguments[0].length>0&&this.push.apply(this,arguments[0]):arguments.length>0&&this.push.apply(this,arguments)}get _bound(){return this._events._bound}set _bound(i){this._events._bound=i}addEventListener(){return this._events.addEventListener.apply(this,arguments)}on(){return this._events.on.apply(this,arguments)}bind(){return this._events.bind.apply(this,arguments)}removeEventListener(){return this._events.removeEventListener.apply(this,arguments)}off(){return this._events.off.apply(this,arguments)}unbind(){return this._events.unbind.apply(this,arguments)}dispatchEvent(){return this._events.dispatchEvent.apply(this,arguments)}trigger(){return this._events.trigger.apply(this,arguments)}listen(){return this._events.listen.apply(this,arguments)}ignore(){return this._events.ignore.apply(this,arguments)}pop(){const i=super.pop.apply(this,arguments);return this.trigger(Mi.Types.remove,[i]),i}shift(){const i=super.shift.apply(this,arguments);return this.trigger(Mi.Types.remove,[i]),i}push(){const i=super.push.apply(this,arguments);return this.trigger(Mi.Types.insert,arguments),i}unshift(){const i=super.unshift.apply(this,arguments);return this.trigger(Mi.Types.insert,arguments),i}splice(){const i=super.splice.apply(this,arguments);if(this.trigger(Mi.Types.remove,i),arguments.length>2){const t=this.slice(arguments[0],arguments[0]+arguments.length-2);this.trigger(Mi.Types.insert,t),this.trigger(Mi.Types.order)}return i}sort(){return super.sort.apply(this,arguments),this.trigger(Mi.Types.order),this}reverse(){return super.reverse.apply(this,arguments),this.trigger(Mi.Types.order),this}indexOf(){return super.indexOf.apply(this,arguments)}},$Q=class extends Jy{constructor(i){super(i=Array.isArray(i)?i:Array.prototype.slice.call(arguments)),Ie(this,"ids",{}),this.attach(i),this.on(Mi.Types.insert,this.attach),this.on(Mi.Types.remove,this.detach)}attach(i){for(let t=0;t<i.length;t++){const e=i[t];e&&e.id&&(this.ids[e.id]=e)}return this}detach(i){for(let t=0;t<i.length;t++)delete this.ids[i[t].id];return this}},AI=Math.min,DI=Math.max,eJ=class extends Qy{constructor(i){super(),Ie(this,"_flagAdditions",!1),Ie(this,"_flagSubtractions",!1),Ie(this,"_flagOrder",!1),Ie(this,"_flagOpacity",!0),Ie(this,"_flagBeginning",!1),Ie(this,"_flagEnding",!1),Ie(this,"_flagLength",!1),Ie(this,"_flagMask",!1),Ie(this,"_fill","#fff"),Ie(this,"_stroke","#000"),Ie(this,"_linewidth",1),Ie(this,"_opacity",1),Ie(this,"_visible",!0),Ie(this,"_cap","round"),Ie(this,"_join","round"),Ie(this,"_miter",4),Ie(this,"_closed",!0),Ie(this,"_curved",!1),Ie(this,"_automatic",!0),Ie(this,"_beginning",0),Ie(this,"_ending",1),Ie(this,"_length",0),Ie(this,"_mask",null);for(let t in tJ)Object.defineProperty(this,t,tJ[t]);this._renderer.type="group",this.additions=[],this.subtractions=[],this.children=Array.isArray(i)?i:Array.prototype.slice.call(arguments)}static InsertChildren(i){for(let t=0;t<i.length;t++)iJ.call(this,i[t],this)}static RemoveChildren(i){for(let t=0;t<i.length;t++)iJ.call(this,i[t])}static OrderChildren(i){this._flagOrder=!0}clone(i){const t=new eJ,e=this.children.map(function(n){return n.clone()});return t.add(e),t.opacity=this.opacity,this.mask&&(t.mask=this.mask),t.translation.copy(this.translation),t.rotation=this.rotation,t.scale=this.scale,t.className=this.className,this.matrix.manual&&t.matrix.copy(this.matrix),i&&i.add(t),t._update()}toObject(){const i={children:[],translation:this.translation.toObject(),rotation:this.rotation,scale:this.scale instanceof gn?this.scale.toObject():this.scale,opacity:this.opacity,className:this.className,mask:this.mask?this.mask.toObject():null};return this.matrix.manual&&(i.matrix=this.matrix.toObject()),er.each(this.children,function(t,e){i.children[e]=t.toObject()},this),i}corner(){const i=this.getBoundingClientRect(!0);for(let t=0;t<this.children.length;t++){const e=this.children[t];e.translation.x-=i.left,e.translation.y-=i.top}return this.mask&&(this.mask.translation.x-=i.left,this.mask.translation.y-=i.top),this}center(){const i=this.getBoundingClientRect(!0),t=i.left+i.width/2-this.translation.x,e=i.top+i.height/2-this.translation.y;for(let n=0;n<this.children.length;n++){const r=this.children[n];r.isShape&&(r.translation.x-=t,r.translation.y-=e)}return this.mask&&(this.mask.translation.x-=t,this.mask.translation.y-=e),this}getById(i){let t=null;return function e(n){if(n.id===i)return n;if(n.children)for(let r=0;r<n.children.length;r++)if(t=e(n.children[r]),t)return t;return null}(this)}getByClassName(i){const t=[];return function e(n){if(Array.prototype.indexOf.call(n.classList,i)>=0&&t.push(n),n.children)for(let r=0;r<n.children.length;r++)e(n.children[r]);return t}(this)}getByType(i){const t=[];return function e(n){if(n instanceof i&&t.push(n),n.children)for(let r=0;r<n.children.length;r++)e(n.children[r]);return t}(this)}add(i){i=i instanceof Array?i.slice():Array.prototype.slice.call(arguments);for(let t=0;t<i.length;t++){const e=i[t];if(!e||!e.id)continue;const n=Array.prototype.indexOf.call(this.children,e);n>=0&&this.children.splice(n,1),this.children.push(e)}return this}remove(i){const e=this.parent;if(arguments.length<=0&&e)return e.remove(this),this;i=i instanceof Array?i.slice():Array.prototype.slice.call(arguments);for(let n=0;n<i.length;n++){const r=i[n];if(!r||!this.children.ids[r.id])continue;const s=this.children.indexOf(r);s>=0&&this.children.splice(s,1)}return this}getBoundingClientRect(i){let t,e,n,r,s,a,l,u,h,m;this._update(!0);let _=1/0,v=-1/0,S=1/0,T=-1/0;const I=/texture|gradient/i;e=i?this._matrix:W0(this);for(let j=0;j<this.children.length;j++){const P=this.children[j];!P.visible||I.test(P._renderer.type)||(t=P.getBoundingClientRect(i),l="number"!=typeof t.top||er.isNaN(t.top)||!isFinite(t.top),u="number"!=typeof t.left||er.isNaN(t.left)||!isFinite(t.left),h="number"!=typeof t.right||er.isNaN(t.right)||!isFinite(t.right),m="number"!=typeof t.bottom||er.isNaN(t.bottom)||!isFinite(t.bottom),!(l||u||h||m)&&(S=AI(t.top,S),_=AI(t.left,_),v=DI(t.right,v),T=DI(t.bottom,T)))}return i&&(n=e.multiply(_,S,1),r=e.multiply(_,T,1),s=e.multiply(v,S,1),a=e.multiply(v,T,1),S=AI(n.y,r.y,s.y,a.y),_=AI(n.x,r.x,s.x,a.x),v=DI(n.x,r.x,s.x,a.x),T=DI(n.y,r.y,s.y,a.y)),{top:S,left:_,right:v,bottom:T,width:v-_,height:T-S}}noFill(){return this.children.forEach(function(i){i.noFill()}),this}noStroke(){return this.children.forEach(function(i){i.noStroke()}),this}subdivide(){const i=arguments;return this.children.forEach(function(t){t.subdivide.apply(t,i)}),this}_update(){let i,t,e;if(this._flagBeginning||this._flagEnding){const n=Math.min(this._beginning,this._ending),r=Math.max(this._beginning,this._ending),s=this.length;let a=0;const l=n*s,u=r*s;for(i=0;i<this.children.length;i++)e=this.children[i],t=e.length,l>a+t?(e.beginning=1,e.ending=1):u<a?(e.beginning=0,e.ending=0):l>a&&l<a+t?(e.beginning=(l-a)/t,e.ending=1):u>a&&u<a+t?(e.beginning=0,e.ending=(u-a)/t):(e.beginning=0,e.ending=1),a+=t}return super._update.apply(this,arguments)}flagReset(){return this._flagAdditions&&(this.additions.length=0,this._flagAdditions=!1),this._flagSubtractions&&(this.subtractions.length=0,this._flagSubtractions=!1),this._flagOrder=this._flagMask=this._flagOpacity=this._flagBeginning=this._flagEnding=!1,super.flagReset.call(this),this}},ec=eJ;Ie(ec,"Children",$Q),Ie(ec,"Properties",["fill","stroke","linewidth","cap","join","miter","closed","curved","automatic"]);var tJ={visible:{enumerable:!0,get:function(){return this._visible},set:function(i){this._flagVisible=this._visible!==i||this._flagVisible,this._visible=i}},opacity:{enumerable:!0,get:function(){return this._opacity},set:function(i){this._flagOpacity=this._opacity!==i||this._flagOpacity,this._opacity=i}},beginning:{enumerable:!0,get:function(){return this._beginning},set:function(i){this._flagBeginning=this._beginning!==i||this._flagBeginning,this._beginning=i}},ending:{enumerable:!0,get:function(){return this._ending},set:function(i){this._flagEnding=this._ending!==i||this._flagEnding,this._ending=i}},length:{enumerable:!0,get:function(){if(this._flagLength||this._length<=0){if(this._length=0,!this.children)return this._length;for(let i=0;i<this.children.length;i++)this._length+=this.children[i].length}return this._length}},fill:{enumerable:!0,get:function(){return this._fill},set:function(i){this._fill=i;for(let t=0;t<this.children.length;t++)this.children[t].fill=i}},stroke:{enumerable:!0,get:function(){return this._stroke},set:function(i){this._stroke=i;for(let t=0;t<this.children.length;t++)this.children[t].stroke=i}},linewidth:{enumerable:!0,get:function(){return this._linewidth},set:function(i){this._linewidth=i;for(let t=0;t<this.children.length;t++)this.children[t].linewidth=i}},join:{enumerable:!0,get:function(){return this._join},set:function(i){this._join=i;for(let t=0;t<this.children.length;t++)this.children[t].join=i}},miter:{enumerable:!0,get:function(){return this._miter},set:function(i){this._miter=i;for(let t=0;t<this.children.length;t++)this.children[t].miter=i}},cap:{enumerable:!0,get:function(){return this._cap},set:function(i){this._cap=i;for(let t=0;t<this.children.length;t++)this.children[t].cap=i}},closed:{enumerable:!0,get:function(){return this._closed},set:function(i){this._closed=i;for(let t=0;t<this.children.length;t++)this.children[t].closed=i}},curved:{enumerable:!0,get:function(){return this._curved},set:function(i){this._curved=i;for(let t=0;t<this.children.length;t++)this.children[t].curved=i}},automatic:{enumerable:!0,get:function(){return this._automatic},set:function(i){this._automatic=i;for(let t=0;t<this.children.length;t++)this.children[t].automatic=i}},children:{enumerable:!0,get:function(){return this._children},set:function(i){const t=ec.InsertChildren.bind(this),e=ec.RemoveChildren.bind(this),n=ec.OrderChildren.bind(this);this._children&&(this._children.unbind(),this._children.length>0&&e(this._children)),this._children=new $Q(i),this._children.bind(Mi.Types.insert,t),this._children.bind(Mi.Types.remove,e),this._children.bind(Mi.Types.order,n),i.length>0&&t(i)}},mask:{enumerable:!0,get:function(){return this._mask},set:function(i){this._mask=i,this._flagMask=!0,er.isObject(i)&&!i.clip&&(i.clip=!0)}}};function iJ(i,t){const e=i.parent;let n;function r(){t.subtractions.length>0&&(n=Array.prototype.indexOf.call(t.subtractions,i),n>=0&&t.subtractions.splice(n,1)),t.additions.length>0&&(n=Array.prototype.indexOf.call(t.additions,i),n>=0&&t.additions.splice(n,1)),i.parent=t,t.additions.push(i),t._flagAdditions=!0}function s(){n=Array.prototype.indexOf.call(e.additions,i),n>=0&&e.additions.splice(n,1),n=Array.prototype.indexOf.call(e.subtractions,i),n<0&&(e.subtractions.push(i),e._flagSubtractions=!0)}e!==t?(e&&e.children.ids[i.id]&&(n=Array.prototype.indexOf.call(e.children,i),e.children.splice(n,1),s()),t?r():(s(),e._flagAdditions&&0===e.additions.length&&(e._flagAdditions=!1),e._flagSubtractions&&0===e.subtractions.length&&(e._flagSubtractions=!1),delete i.parent)):r()}var nJ=new Rg,O4=[],F4=Math.max,SEe=Math.min,rJ=Math.abs,RI=Math.sin,kI=Math.cos,CEe=Math.acos,PI=Math.sqrt,Ll={isHidden:/(undefined|none|transparent)/i,alignments:{left:"start",middle:"center",right:"end"},shim:function(i,t){return i.tagName=i.nodeName=t||"canvas",i.nodeType=1,i.getAttribute=function(e){return this[e]},i.setAttribute=function(e,n){return this[e]=n,this},i},group:{renderChild:function(i){Ll[i._renderer.type].render.call(i,this.ctx,!0,this.clip)},render:function(i){if(!this._visible)return this;this._update();const t=this._matrix.elements,e=this.parent;this._renderer.opacity=this._opacity*(e&&e._renderer?e._renderer.opacity:1);const n=this._mask,r=II(t),s=!r||!!n;if(this._renderer.context||(this._renderer.context={}),this._renderer.context.ctx=i,s&&(i.save(),r||i.transform(t[0],t[3],t[1],t[4],t[2],t[5])),n&&Ll[n._renderer.type].render.call(n,i,!0),this._opacity>0&&0!==this._scale)for(let a=0;a<this.children.length;a++){const l=this.children[a];Ll[l._renderer.type].render.call(l,i)}return s&&i.restore(),this.flagReset()}},path:{render:function(i,t,e){let n,r,s,a,l,u,h,m,_,v,S,T,I,j,P,E,ie,ee,ce,ye,Ce,Ge,Qe,nt,ge,Je,mt,pt,Pt,et,vt,kt,pi,Ht,ct,mi,Zi,zi,Zt,tr,nn;if(Ht=this.parent&&this.parent._renderer?this.parent._renderer.opacity:1,Pt=this._mask,et=this._clip,l=this._opacity*(Ht||1),u=this._visible,!t&&(!u||et||0===l))return this;this._update(),n=this._matrix.elements,r=this._stroke,s=this._linewidth,a=this._fill,h=this._cap,m=this._join,_=this._miter,v=this._closed,S=this._renderer.vertices,T=S.length,I=T-1,vt=II(n),pi=this.dashes,vt||(i.save(),i.transform(n[0],n[3],n[1],n[4],n[2],n[5])),Pt&&Ll[Pt._renderer.type].render.call(Pt,i,!0),a&&("string"==typeof a?i.fillStyle=a:(Ll[a._renderer.type].render.call(a,i,this),i.fillStyle=a._renderer.effect)),r&&("string"==typeof r?i.strokeStyle=r:(Ll[r._renderer.type].render.call(r,i,this),i.strokeStyle=r._renderer.effect),s&&(i.lineWidth=s),_&&(i.miterLimit=_),m&&(i.lineJoin=m),!v&&h&&(i.lineCap=h)),"number"==typeof l&&(i.globalAlpha=l),pi&&pi.length>0&&(i.lineDashOffset=pi.offset||0,i.setLineDash(pi)),i.beginPath();for(let Un=0;Un<T;Un++)switch(E=S[Un],mt=E.x,pt=E.y,E.command){case Ji.close:i.closePath();break;case Ji.arc:ct=E.rx,mi=E.ry,Zi=E.xAxisRotation,zi=E.largeArcFlag,Zt=E.sweepFlag,j=v?Xh(Un-1,T):F4(Un-1,0),P=S[j],tr=P.x,nn=P.y,Ll.renderSvgArcCommand(i,tr,nn,ct,mi,zi,Zt,Zi,mt,pt);break;case Ji.curve:j=v?Xh(Un-1,T):Math.max(Un-1,0),P=S[j],Qe=P.controls&&P.controls.right||gn.zero,nt=E.controls&&E.controls.left||gn.zero,P._relative?(Ce=Qe.x+P.x,Ge=Qe.y+P.y):(Ce=Qe.x,Ge=Qe.y),E._relative?(ce=nt.x+E.x,ye=nt.y+E.y):(ce=nt.x,ye=nt.y),i.bezierCurveTo(Ce,Ge,ce,ye,mt,pt),Un>=I&&v&&(ie=ee,ge=E.controls&&E.controls.right||gn.zero,Je=ie.controls&&ie.controls.left||gn.zero,E._relative?(Ce=ge.x+E.x,Ge=ge.y+E.y):(Ce=ge.x,Ge=ge.y),ie._relative?(ce=Je.x+ie.x,ye=Je.y+ie.y):(ce=Je.x,ye=Je.y),mt=ie.x,pt=ie.y,i.bezierCurveTo(Ce,Ge,ce,ye,mt,pt));break;case Ji.line:i.lineTo(mt,pt);break;case Ji.move:ee=E,i.moveTo(mt,pt)}return v&&i.closePath(),!et&&!e&&(Ll.isHidden.test(a)||(kt=a._renderer&&a._renderer.offset,kt&&(i.save(),i.translate(-a._renderer.offset.x,-a._renderer.offset.y),i.scale(a._renderer.scale.x,a._renderer.scale.y)),i.fill(),kt&&i.restore()),Ll.isHidden.test(r)||(kt=r._renderer&&r._renderer.offset,kt&&(i.save(),i.translate(-r._renderer.offset.x,-r._renderer.offset.y),i.scale(r._renderer.scale.x,r._renderer.scale.y),i.lineWidth=s/r._renderer.scale.x),i.stroke(),kt&&i.restore())),vt||i.restore(),et&&!e&&i.clip(),pi&&pi.length>0&&i.setLineDash(O4),this.flagReset()}},points:{render:function(i,t,e){let n,r,s,a,l,u,h,m,_,v,S,T,I,j,P,E;if(E=this.parent&&this.parent._renderer?this.parent._renderer.opacity:1,l=this._opacity*(E||1),u=this._visible,!(t||u&&0!==l))return this;this._update(),n=this._matrix.elements,r=this._stroke,s=this._linewidth,a=this._fill,m=this._renderer.collection,_=m.length,I=II(n),P=this.dashes,h=this._size,I||(i.save(),i.transform(n[0],n[3],n[1],n[4],n[2],n[5])),a&&("string"==typeof a?i.fillStyle=a:(Ll[a._renderer.type].render.call(a,i,this),i.fillStyle=a._renderer.effect)),r&&("string"==typeof r?i.strokeStyle=r:(Ll[r._renderer.type].render.call(r,i,this),i.strokeStyle=r._renderer.effect),s&&(i.lineWidth=s)),"number"==typeof l&&(i.globalAlpha=l),P&&P.length>0&&(i.lineDashOffset=P.offset||0,i.setLineDash(P)),i.beginPath();let ee,ie=.5*h;this._sizeAttenuation||(W0(this,nJ),ee=nJ.elements,ee=TE(ee[0],ee[3],ee[1],ee[4],ee[2],ee[5]),ie/=Math.max(ee.scaleX,ee.scaleY));for(let ce=0;ce<_;ce++)v=m[ce],S=v.x,T=v.y,i.moveTo(S+ie,T),i.arc(S,T,ie,0,cu);return e||(Ll.isHidden.test(a)||(j=a._renderer&&a._renderer.offset,j&&(i.save(),i.translate(-a._renderer.offset.x,-a._renderer.offset.y),i.scale(a._renderer.scale.x,a._renderer.scale.y)),i.fill(),j&&i.restore()),Ll.isHidden.test(r)||(j=r._renderer&&r._renderer.offset,j&&(i.save(),i.translate(-r._renderer.offset.x,-r._renderer.offset.y),i.scale(r._renderer.scale.x,r._renderer.scale.y),i.lineWidth=s/r._renderer.scale.x),i.stroke(),j&&i.restore())),I||i.restore(),P&&P.length>0&&i.setLineDash(O4),this.flagReset()}},text:{render:function(i,t,e){const r=this._opacity*(this.parent&&this.parent._renderer?this.parent._renderer.opacity:1),a=this._mask,l=this._clip;if(!t&&(!this._visible||l||0===r))return this;this._update();const u=this._matrix.elements,h=this._stroke,m=this._linewidth,_=this._fill,v=this._decoration,S=II(u),T=_._renderer&&_._renderer.offset&&h._renderer&&h._renderer.offset,I=this.dashes,j=Ll.alignments[this._alignment]||this._alignment,P=this._baseline;let E,ie,ee,ce,ye,Ce,Ge,Qe,nt,ge,Je;if(S||(i.save(),i.transform(u[0],u[3],u[1],u[4],u[2],u[5])),a&&Ll[a._renderer.type].render.call(a,i,!0),T||(i.font=[this._style,this._weight,this._size+"px/"+this._leading+"px",this._family].join(" ")),i.textAlign=j,i.textBaseline=P,_&&("string"==typeof _?i.fillStyle=_:(Ll[_._renderer.type].render.call(_,i,this),i.fillStyle=_._renderer.effect)),h&&("string"==typeof h?i.strokeStyle=h:(Ll[h._renderer.type].render.call(h,i,this),i.strokeStyle=h._renderer.effect),m&&(i.lineWidth=m)),"number"==typeof r&&(i.globalAlpha=r),I&&I.length>0&&(i.lineDashOffset=I.offset||0,i.setLineDash(I)),!l&&!e&&(Ll.isHidden.test(_)||(_._renderer&&_._renderer.offset?(Ce=_._renderer.scale.x,Ge=_._renderer.scale.y,i.save(),i.translate(-_._renderer.offset.x,-_._renderer.offset.y),i.scale(Ce,Ge),E=this._size/_._renderer.scale.y,ie=this._leading/_._renderer.scale.y,i.font=[this._style,this._weight,E+"px/",ie+"px",this._family].join(" "),ee=_._renderer.offset.x/_._renderer.scale.x,ce=_._renderer.offset.y/_._renderer.scale.y,i.fillText(this.value,ee,ce),i.restore()):i.fillText(this.value,0,0)),Ll.isHidden.test(h)||(h._renderer&&h._renderer.offset?(Ce=h._renderer.scale.x,Ge=h._renderer.scale.y,i.save(),i.translate(-h._renderer.offset.x,-h._renderer.offset.y),i.scale(Ce,Ge),E=this._size/h._renderer.scale.y,ie=this._leading/h._renderer.scale.y,i.font=[this._style,this._weight,E+"px/",ie+"px",this._family].join(" "),ee=h._renderer.offset.x/h._renderer.scale.x,ce=h._renderer.offset.y/h._renderer.scale.y,ye=m/h._renderer.scale.x,i.lineWidth=ye,i.strokeText(this.value,ee,ce),i.restore()):i.strokeText(this.value,0,0))),/(underline|strikethrough)/i.test(v)){const mt=i.measureText(this.value);let pt=1;switch(v){case"underline":nt=mt.actualBoundingBoxAscent,Je=mt.actualBoundingBoxAscent;break;case"strikethrough":nt=0,Je=0,pt=.5}switch(P){case"top":nt+=this._size*pt,Je+=this._size*pt;break;case"baseline":case"bottom":nt-=this._size*pt,Je-=this._size*pt}switch(j){case"left":case"start":Qe=0,ge=mt.width;break;case"right":case"end":Qe=-mt.width,ge=0;break;default:Qe=-mt.width/2,ge=mt.width/2}i.lineWidth=Math.max(Math.floor(this._size/15),1),i.strokeStyle=i.fillStyle,i.beginPath(),i.moveTo(Qe,nt),i.lineTo(ge,Je),i.stroke()}return S||i.restore(),l&&!e&&i.clip(),I&&I.length>0&&i.setLineDash(O4),this.flagReset()}},"linear-gradient":{render:function(i,t){if(t){if(this._update(),!this._renderer.effect||this._flagEndPoints||this._flagStops||this._flagUnits){let e,n=this.left._x,r=this.left._y,s=this.right._x,a=this.right._y;/objectBoundingBox/i.test(this._units)&&(e=t.getBoundingClientRect(!0),n=(n-.5)*e.width,r=(r-.5)*e.height,s=(s-.5)*e.width,a=(a-.5)*e.height),this._renderer.effect=i.createLinearGradient(n,r,s,a);for(let l=0;l<this.stops.length;l++){const u=this.stops[l];this._renderer.effect.addColorStop(u._offset,u._color)}}return this.flagReset()}}},"radial-gradient":{render:function(i,t){if(t){if(this._update(),!this._renderer.effect||this._flagCenter||this._flagFocal||this._flagRadius||this._flagStops||this._flagUnits){let e,n=this.center._x,r=this.center._y,s=this.focal._x,a=this.focal._y,l=this._radius;/objectBoundingBox/i.test(this._units)&&(e=t.getBoundingClientRect(!0),n=n*e.width*.5,r=r*e.height*.5,s=s*e.width*.5,a=a*e.height*.5,l*=.5*Math.min(e.width,e.height)),this._renderer.effect=i.createRadialGradient(n,r,0,s,a,l);for(let u=0;u<this.stops.length;u++){const h=this.stops[u];this._renderer.effect.addColorStop(h._offset,h._color)}}return this.flagReset()}}},texture:{render:function(i){this._update();const t=this.image;return(!this._renderer.effect||(this._flagLoaded||this._flagImage||this._flagVideo||this._flagRepeat)&&this.loaded)&&(this._renderer.effect=i.createPattern(this.image,this._repeat)),(this._flagOffset||this._flagLoaded||this._flagScale)&&(this._renderer.offset instanceof gn||(this._renderer.offset=new gn),this._renderer.offset.x=-this._offset.x,this._renderer.offset.y=-this._offset.y,t&&(this._renderer.offset.x+=t.width/2,this._renderer.offset.y+=t.height/2,this._scale instanceof gn?(this._renderer.offset.x*=this._scale.x,this._renderer.offset.y*=this._scale.y):(this._renderer.offset.x*=this._scale,this._renderer.offset.y*=this._scale))),(this._flagScale||this._flagLoaded)&&(this._renderer.scale instanceof gn||(this._renderer.scale=new gn),this._scale instanceof gn?this._renderer.scale.copy(this._scale):this._renderer.scale.set(this._scale,this._scale)),this.flagReset()}},renderSvgArcCommand:function(i,t,e,n,r,s,a,l,u,h){l=l*Math.PI/180,n=rJ(n),r=rJ(r);const m=(t-u)/2,_=(e-h)/2,v=kI(l)*m+RI(l)*_,S=-RI(l)*m+kI(l)*_,T=v*v,I=S*S;let j=n*n,P=r*r;const E=T/j+I/P;if(E>1){const pt=PI(E);j=(n*=pt)*n,P=(r*=pt)*r}const ie=j*I+P*T;let ce=PI(F4(0,(j*P-ie)/ie));s===a&&(ce=-ce);const ye=ce*n*S/r,Ce=-ce*r*v/n,Ge=kI(l)*ye-RI(l)*Ce+(t+u)/2,Qe=RI(l)*ye+kI(l)*Ce+(e+h)/2,nt=sJ(1,0,(v-ye)/n,(S-Ce)/r);!function MEe(i,t,e,n,r,s,a,l,u){const h=a-s,m=hC.Tolerance.epsilon,_=Math.abs(h)<m;let v=Xh(h,cu);v<m&&(v=_?0:cu),!0===l&&!_&&(v===cu?v=-cu:v-=cu);for(let S=0;S<12;S++){const I=s+S/11*v;let j=t+n*Math.cos(I),P=e+r*Math.sin(I);if(0!==u){const E=Math.cos(u),ie=Math.sin(u),ee=j-t,ce=P-e;j=ee*E-ce*ie+t,P=ee*ie+ce*E+e}i.lineTo(j,P)}}(i,Ge,Qe,n,r,nt,nt+sJ((v-ye)/n,(S-Ce)/r,(-v-ye)/n,(-S-Ce)/r)%cu,0===a,l)}},AE=class extends Mi{constructor(i){super();const t=!1!==i.smoothing;this.domElement=i.domElement||document.createElement("canvas"),this.ctx=this.domElement.getContext("2d"),this.overdraw=i.overdraw||!1,void 0!==this.ctx.imageSmoothingEnabled&&(this.ctx.imageSmoothingEnabled=t),this.scene=new ec,this.scene.parent=this}setSize(i,t,e){return this.width=i,this.height=t,this.ratio=void 0===e?I4(this.ctx):e,this.domElement.width=i*this.ratio,this.domElement.height=t*this.ratio,this.domElement.style&&er.extend(this.domElement.style,{width:i+"px",height:t+"px"}),this.trigger(Mi.Types.resize,i,t,e)}render(){const i=1===this.ratio;return i||(this.ctx.save(),this.ctx.scale(this.ratio,this.ratio)),this.overdraw||this.ctx.clearRect(0,0,this.width,this.height),Ll.group.render.call(this.scene,this.ctx),i||this.ctx.restore(),this}};function sJ(i,t,e,n){const r=i*e+t*n,s=PI(i*i+t*t)*PI(e*e+n*n);let a=CEe(F4(-1,SEe(1,r/s)));return i*n-t*e<0&&(a=-a),a}function II(i){return 1==i[0]&&0==i[3]&&0==i[1]&&1==i[4]&&0==i[2]&&0==i[5]}Ie(AE,"Utils",Ll);var Zh={Image:null,isHeadless:!1,shim:function(i,t){return AE.Utils.shim(i),void 0!==t&&(Zh.Image=t),Zh.isHeadless=!0,i}},Yh={hasEventListeners:"function"==typeof ul.addEventListener,bind:function(i,t,e,n){return this.hasEventListeners?i.addEventListener(t,e,!!n):i.attachEvent("on"+t,e),Yh},unbind:function(i,t,e,n){return Yh.hasEventListeners?i.removeEventListeners(t,e,!!n):i.detachEvent("on"+t,e),Yh},getRequestAnimationFrame:function(){const i=["ms","moz","webkit","o"];let t=0,e=ul.requestAnimationFrame;if(!e){for(let r=0;r<i.length;r++)e=ul[i[r]+"RequestAnimationFrame"]||e;e=e||function n(r,s){const a=(new Date).getTime(),l=Math.max(0,16-(a-t)),u=ul.setTimeout(function h(){r(a+l)},l);return t=a+l,u}}return e}},dC=ul.document?ul.document.createElement("div"):{};dC.id="help-two-load",Object.defineProperty(Yh,"temp",{enumerable:!0,get:function(){return er.isElement(dC)&&!ul.document.head.contains(dC)&&(dC.style.display="none",ul.document.head.appendChild(dC)),dC}});var Kh=class extends Error{constructor(i){super(),Ie(this,"name","Two.js"),Ie(this,"message"),this.message=i}},LI=class{constructor(){Ie(this,"map",{})}add(i,t){return this.map[i]=t,this}remove(i){return delete this.map[i],this}get(i){return this.map[i]}contains(i){return i in this.map}};function oJ(i,t){if(0===t||1===t)return!0;const n=i._length*t;let r=0;for(let s=0;s<i._lengths.length;s++){if(r>=n)return n-r>=0;r+=i._lengths[s]}return!1}function OI(i,t){if(t<=0)return 0;if(t>=i._length)return i._lengths.length-1;for(let n=0,r=0;n<i._lengths.length;n++){if(r+i._lengths[n]>=t)return t-=r,Math.max(n-1,0)+t/i._lengths[n];r+=i._lengths[n]}return-1}function B4(i,t,e){let n,r,s,a,l,u,h,m;const _=t.controls&&t.controls.right,v=i.controls&&i.controls.left;return n=t.x,l=t.y,r=(_||t).x,u=(_||t).y,s=(v||i).x,h=(v||i).y,a=i.x,m=i.y,_&&t._relative&&(r+=t.x,u+=t.y),v&&i._relative&&(s+=i.x,h+=i.y),WQ(n,l,r,u,s,h,a,m,e)}function aJ(i,t,e){let n,r,s,a,l,u,h,m;const _=t.controls&&t.controls.right,v=i.controls&&i.controls.left;return n=t.x,l=t.y,r=(_||t).x,u=(_||t).y,s=(v||i).x,h=(v||i).y,a=i.x,m=i.y,_&&t._relative&&(r+=t.x,u+=t.y),v&&i._relative&&(s+=i.x,h+=i.y),k4(n,l,r,u,s,h,a,m,e)}var $y=class extends TI{constructor(i,t,e){super(),Ie(this,"_flagOffset",!0),Ie(this,"_flagOpacity",!0),Ie(this,"_flagColor",!0),Ie(this,"_offset",0),Ie(this,"_opacity",1),Ie(this,"_color","#fff");for(let n in lJ)Object.defineProperty(this,n,lJ[n]);this._renderer.type="stop",this.offset="number"==typeof i?i:$y.Index<=0?0:1,this.opacity="number"==typeof e?e:1,this.color="string"==typeof t?t:$y.Index<=0?"#fff":"#000",$y.Index=($y.Index+1)%2}clone(){const i=new $y;return er.each($y.Properties,function(t){i[t]=this[t]},this),i}toObject(){const i={};return er.each($y.Properties,function(t){i[t]=this[t]},this),i}flagReset(){return this._flagOffset=this._flagColor=this._flagOpacity=!1,super.flagReset.call(this),this}},ev=$y;Ie(ev,"Index",0),Ie(ev,"Properties",["offset","opacity","color"]);var lJ={offset:{enumerable:!0,get:function(){return this._offset},set:function(i){this._offset=i,this._flagOffset=!0,this.parent&&(this.parent._flagStops=!0)}},opacity:{enumerable:!0,get:function(){return this._opacity},set:function(i){this._opacity=i,this._flagOpacity=!0,this.parent&&(this.parent._flagStops=!0)}},color:{enumerable:!0,get:function(){return this._color},set:function(i){this._color=i,this._flagColor=!0,this.parent&&(this.parent._flagStops=!0)}}},FI=class extends TI{constructor(i){super(),Ie(this,"_flagStops",!1),Ie(this,"_flagSpread",!1),Ie(this,"_flagUnits",!1),Ie(this,"_spread",""),Ie(this,"_units","");for(let t in cJ)Object.defineProperty(this,t,cJ[t]);this._renderer.type="gradient",this.id="two-"+$l_uniqueId(),this.classList=[],this._renderer.flagStops=TEe.bind(this),this._renderer.bindStops=EEe.bind(this),this._renderer.unbindStops=AEe.bind(this),this.spread="pad",this.units="objectBoundingBox",i&&(this.stops=i)}clone(i){const t=this.stops.map(function(n){return n.clone()}),e=new FI(t);return er.each(FI.Properties,function(n){e[n]=this[n]},this),i&&i.add(e),e}toObject(){const i={stops:this.stops.map(function(t){return t.toObject()})};return er.each(FI.Properties,function(t){i[t]=this[t]},this),i}_update(){return(this._flagSpread||this._flagStops)&&this.trigger(Mi.Types.change),this}flagReset(){return this._flagSpread=this._flagUnits=this._flagStops=!1,super.flagReset.call(this),this}},tc=FI;Ie(tc,"Stop",ev),Ie(tc,"Properties",["spread","stops","renderer","units"]);var cJ={spread:{enumerable:!0,get:function(){return this._spread},set:function(i){this._spread=i,this._flagSpread=!0}},units:{enumerable:!0,get:function(){return this._units},set:function(i){this._units=i,this._flagUnits=!0}},stops:{enumerable:!0,get:function(){return this._stops},set:function(i){const t=this._renderer.bindStops,e=this._renderer.unbindStops;this._stops&&this._stops.unbind(Mi.Types.insert,t).unbind(Mi.Types.remove,e),this._stops=new Jy((i||[]).slice(0)),this._stops.bind(Mi.Types.insert,t).bind(Mi.Types.remove,e),t(this._stops)}}};function TEe(){this._flagStops=!0}function EEe(i){let t=i.length;for(;t--;)i[t].bind(Mi.Types.change,this._renderer.flagStops),i[t].parent=this;this._renderer.flagStops()}function AEe(i){let t=i.length;for(;t--;)i[t].unbind(Mi.Types.change,this._renderer.flagStops),delete i[t].parent;this._renderer.flagStops()}var uJ=class extends tc{constructor(i,t,e,n,r){super(r),Ie(this,"_flagEndPoints",!1),Ie(this,"_left",null),Ie(this,"_right",null);for(let s in hJ)Object.defineProperty(this,s,hJ[s]);this._renderer.type="linear-gradient",this._renderer.flagEndPoints=DEe.bind(this),this.left=new gn,this.right=new gn,"number"==typeof i&&(this.left.x=i),"number"==typeof t&&(this.left.y=t),"number"==typeof e&&(this.right.x=e),"number"==typeof n&&(this.right.y=n)}clone(i){const t=this.stops.map(function(n){return n.clone()}),e=new uJ(this.left._x,this.left._y,this.right._x,this.right._y,t);return er.each(tc.Properties,function(n){e[n]=this[n]},this),i&&i.add(e),e}toObject(){const i=super.toObject.call(this);return i.left=this.left.toObject(),i.right=this.right.toObject(),i}_update(){return(this._flagEndPoints||this._flagSpread||this._flagStops)&&this.trigger(Mi.Types.change),this}flagReset(){return this._flagEndPoints=!1,super.flagReset.call(this),this}},Ba=uJ;Ie(Ba,"Properties",["left","right"]),Ie(Ba,"Stop",ev);var hJ={left:{enumerable:!0,get:function(){return this._left},set:function(i){this._left instanceof gn&&this._left.unbind(Mi.Types.change,this._renderer.flagEndPoints),this._left=i,this._left.bind(Mi.Types.change,this._renderer.flagEndPoints),this._flagEndPoints=!0}},right:{enumerable:!0,get:function(){return this._right},set:function(i){this._right instanceof gn&&this._right.unbind(Mi.Types.change,this._renderer.flagEndPoints),this._right=i,this._right.bind(Mi.Types.change,this._renderer.flagEndPoints),this._flagEndPoints=!0}}};function DEe(){this._flagEndPoints=!0}var BI=class extends tc{constructor(i,t,e,n,r,s){super(n),Ie(this,"_flagRadius",!1),Ie(this,"_flagCenter",!1),Ie(this,"_flagFocal",!1),Ie(this,"_radius",0),Ie(this,"_center",null),Ie(this,"_focal",null);for(let a in dJ)Object.defineProperty(this,a,dJ[a]);this._renderer.type="radial-gradient",this._renderer.flagCenter=REe.bind(this),this._renderer.flagFocal=kEe.bind(this),this.center=new gn,this.radius="number"==typeof e?e:1,this.focal=new gn,"number"==typeof i&&(this.center.x=i),"number"==typeof t&&(this.center.y=t),this.focal.copy(this.center),"number"==typeof r&&(this.focal.x=r),"number"==typeof s&&(this.focal.y=s)}clone(i){const t=this.stops.map(function(n){return n.clone()}),e=new BI(this.center._x,this.center._y,this._radius,t,this.focal._x,this.focal._y);return er.each(tc.Properties.concat(BI.Properties),function(n){e[n]=this[n]},this),i&&i.add(e),e}toObject(){const i=super.toObject.call(this);return er.each(BI.Properties,function(t){i[t]=this[t]},this),i.center=this.center.toObject(),i.focal=this.focal.toObject(),i}_update(){return(this._flagRadius||this._flatCenter||this._flagFocal||this._flagSpread||this._flagStops)&&this.trigger(Mi.Types.change),this}flagReset(){return this._flagRadius=this._flagCenter=this._flagFocal=!1,super.flagReset.call(this),this}},Na=BI;Ie(Na,"Stop",ev),Ie(Na,"Properties",["center","radius","focal"]);var dJ={radius:{enumerable:!0,get:function(){return this._radius},set:function(i){this._radius=i,this._flagRadius=!0}},center:{enumerable:!0,get:function(){return this._center},set:function(i){this._center&&this._center.unbind(Mi.Types.change,this._renderer.flagCenter),this._center=i,this._center.bind(Mi.Types.change,this._renderer.flagCenter),this._flagCenter=!0}},focal:{enumerable:!0,get:function(){return this._focal},set:function(i){this._focal&&this._focal.unbind(Mi.Types.change,this._renderer.flagFocal),this._focal=i,this._focal.bind(Mi.Types.change,this._renderer.flagFocal),this._flagFocal=!0}}};function REe(){this._flagCenter=!0}function kEe(){this._flagFocal=!0}var NI,fJ={video:/\.(mp4|webm|ogg)$/i,image:/\.(jpe?g|png|gif|tiff|webp)$/i,effect:/texture|gradient/i};ul.document&&(NI=document.createElement("a"));var Lc=class extends TI{constructor(i,t){super(),Ie(this,"_flagSrc",!1),Ie(this,"_flagImage",!1),Ie(this,"_flagVideo",!1),Ie(this,"_flagLoaded",!1),Ie(this,"_flagRepeat",!1),Ie(this,"_flagOffset",!1),Ie(this,"_flagScale",!1),Ie(this,"_src",""),Ie(this,"_image",null),Ie(this,"_loaded",!1),Ie(this,"_repeat","no-repeat"),Ie(this,"_scale",1),Ie(this,"_offset",null),this._renderer={};for(let e in pJ)Object.defineProperty(this,e,pJ[e]);if(this._renderer.type="texture",this._renderer.flagOffset=PEe.bind(this),this._renderer.flagScale=IEe.bind(this),this.id="two-"+$l_uniqueId(),this.classList=[],this.loaded=!1,this.repeat="no-repeat",this.offset=new gn,"function"==typeof t){const e=function(){this.unbind(Mi.Types.load,e),"function"==typeof t&&t()}.bind(this);this.bind(Mi.Types.load,e)}if("string"==typeof i)this.src=i;else if("object"==typeof i){const e=Object.prototype.toString.call(i);("[object HTMLImageElement]"===e||"[object HTMLCanvasElement]"===e||"[object HTMLVideoElement]"===e||"[object Image]"===e)&&(this.image=i)}this._update()}static getAbsoluteURL(i){return NI?(NI.href=i,NI.href):i}static loadHeadlessBuffer(i,t){i.image.onload=t,i.image.src=i.src}static getTag(i){return i&&i.nodeName&&i.nodeName.toLowerCase()||"img"}static getImage(i){const t=Lc.getAbsoluteURL(i);if(Lc.ImageRegistry.contains(t))return Lc.ImageRegistry.get(t);let e;return Zh.Image?(e=new Zh.Image,AE.Utils.shim(e,"img")):ul.document?e=fJ.video.test(t)?document.createElement("video"):document.createElement("img"):console.warn("Two.js: no prototypical image defined for Two.Texture"),e.crossOrigin="anonymous",e}static load(i,t){let e=i.image,n=Lc.getTag(e);i._flagImage&&(/canvas/i.test(n)?Lc.Register.canvas(i,t):(i._src=!Zh.isHeadless&&e.getAttribute("two-src")||e.src,Lc.Register[n](i,t))),i._flagSrc&&(e||(e=Lc.getImage(i.src),i.image=e),n=Lc.getTag(e),Lc.Register[n](i,t))}clone(){const i=new Lc(this.src);return i.repeat=this.repeat,i.offset.copy(this.origin),i.scale=this.scale,i}toObject(){return{src:this.src,repeat:this.repeat,origin:this.origin.toObject(),scale:"number"==typeof this.scale?this.scale:this.scale.toObject()}}_update(){return(this._flagSrc||this._flagImage)&&(this.trigger(Mi.Types.change),(this._flagSrc||this._flagImage)&&(this.loaded=!1,Lc.load(this,function(){this.loaded=!0,this.trigger(Mi.Types.change).trigger(Mi.Types.load)}.bind(this)))),this._image&&this._image.readyState>=4&&(this._flagVideo=!0),this}flagReset(){return this._flagSrc=this._flagImage=this._flagLoaded=this._flagRepeat=this._flagVideo=this._flagScale=this._flagOffset=!1,super.flagReset.call(this),this}},xo=Lc;Ie(xo,"Properties",["src","loaded","repeat","scale","offset","image"]),Ie(xo,"RegularExpressions",fJ),Ie(xo,"ImageRegistry",new LI),Ie(xo,"Register",{canvas:function(i,t){i._src="#"+i.id,Lc.ImageRegistry.add(i.src,i.image),"function"==typeof t&&t()},img:function(i,t){const e=i.image,n=function(s){!Zh.isHeadless&&e.removeEventListener&&"function"==typeof e.removeEventListener&&(e.removeEventListener("load",n,!1),e.removeEventListener("error",r,!1)),"function"==typeof t&&t()},r=function(s){throw!Zh.isHeadless&&"function"==typeof e.removeEventListener&&(e.removeEventListener("load",n,!1),e.removeEventListener("error",r,!1)),new Kh("unable to load "+i.src)};"number"==typeof e.width&&e.width>0&&"number"==typeof e.height&&e.height>0?n():!Zh.isHeadless&&"function"==typeof e.addEventListener&&(e.addEventListener("load",n,!1),e.addEventListener("error",r,!1)),i._src=Lc.getAbsoluteURL(i._src),(Zh.isHeadless||!e||!e.getAttribute("two-src"))&&(Zh.isHeadless||e.setAttribute("two-src",i.src),Lc.ImageRegistry.add(i.src,e),Zh.isHeadless?Lc.loadHeadlessBuffer(i,n):i.image.src=i.src)},video:function(i,t){if(Zh.isHeadless)throw new Kh("video textures are not implemented in headless environments.");const e=function(r){i.image.removeEventListener("canplaythrough",e,!1),i.image.removeEventListener("error",n,!1),i.image.width=i.image.videoWidth,i.image.height=i.image.videoHeight,"function"==typeof t&&t()},n=function(r){throw i.image.removeEventListener("canplaythrough",e,!1),i.image.removeEventListener("error",n,!1),new Kh("unable to load "+i.src)};i._src=Lc.getAbsoluteURL(i._src),i.image.getAttribute("two-src")||(i.image.setAttribute("two-src",i.src),Lc.ImageRegistry.add(i.src,i.image)),i.image.readyState>=4?e():(i.image.addEventListener("canplaythrough",e,!1),i.image.addEventListener("error",n,!1),i.image.src=i.src,i.image.load())}});var pJ={src:{enumerable:!0,get:function(){return this._src},set:function(i){this._src=i,this._flagSrc=!0}},loaded:{enumerable:!0,get:function(){return this._loaded},set:function(i){this._loaded=i,this._flagLoaded=!0}},repeat:{enumerable:!0,get:function(){return this._repeat},set:function(i){this._repeat=i,this._flagRepeat=!0}},image:{enumerable:!0,get:function(){return this._image},set:function(i){let e;e="canvas"===xo.getTag(i)?"#"+i.id:i.src,this._image=xo.ImageRegistry.contains(e)?xo.ImageRegistry.get(i.src):i,this._flagImage=!0}},offset:{enumerable:!0,get:function(){return this._offset},set:function(i){this._offset&&this._offset.unbind(Mi.Types.change,this._renderer.flagOffset),this._offset=i,this._offset.bind(Mi.Types.change,this._renderer.flagOffset),this._flagOffset=!0}},scale:{enumerable:!0,get:function(){return this._scale},set:function(i){this._scale instanceof gn&&this._scale.unbind(Mi.Types.change,this._renderer.flagScale),this._scale=i,this._scale instanceof gn&&this._scale.bind(Mi.Types.change,this._renderer.flagScale),this._flagScale=!0}}};function PEe(){this._flagOffset=!0}function IEe(){this._flagScale=!0}var tv=Math.min,iv=Math.max,LEe=Math.ceil,OEe=Math.floor,FEe=new gn,DE=class extends Qy{constructor(i,t,e,n){super(),Ie(this,"_flagVertices",!0),Ie(this,"_flagLength",!0),Ie(this,"_flagFill",!0),Ie(this,"_flagStroke",!0),Ie(this,"_flagLinewidth",!0),Ie(this,"_flagOpacity",!0),Ie(this,"_flagVisible",!0),Ie(this,"_flagCap",!0),Ie(this,"_flagJoin",!0),Ie(this,"_flagMiter",!0),Ie(this,"_flagMask",!1),Ie(this,"_flagClip",!1),Ie(this,"_length",0),Ie(this,"_fill","#fff"),Ie(this,"_stroke","#000"),Ie(this,"_linewidth",1),Ie(this,"_opacity",1),Ie(this,"_visible",!0),Ie(this,"_cap","round"),Ie(this,"_join","round"),Ie(this,"_miter",4),Ie(this,"_closed",!0),Ie(this,"_curved",!1),Ie(this,"_automatic",!0),Ie(this,"_beginning",0),Ie(this,"_ending",1),Ie(this,"_mask",null),Ie(this,"_clip",!1),Ie(this,"_dashes",null);for(let r in mJ)Object.defineProperty(this,r,mJ[r]);this._renderer.type="path",this._renderer.flagVertices=gJ.bind(this),this._renderer.bindVertices=_J.bind(this),this._renderer.unbindVertices=yJ.bind(this),this._renderer.flagFill=vJ.bind(this),this._renderer.flagStroke=bJ.bind(this),this._renderer.vertices=[],this._renderer.collection=[],this._closed=!!t,this._curved=!!e,this.beginning=0,this.ending=1,this.fill="#fff",this.stroke="#000",this.linewidth=1,this.opacity=1,this.className="",this.visible=!0,this.cap="butt",this.join="miter",this.miter=4,this.vertices=i,this.automatic=!n,this.dashes=[],this.dashes.offset=0}clone(i){const t=new DE;for(let e=0;e<this.vertices.length;e++)t.vertices.push(this.vertices[e].clone());for(let e=0;e<DE.Properties.length;e++){const n=DE.Properties[e];t[n]=this[n]}return t.className=this.className,t.translation.copy(this.translation),t.rotation=this.rotation,t.scale=this.scale,t.skewX=this.skewX,t.skewY=this.skewY,this.matrix.manual&&t.matrix.copy(this.matrix),i&&i.add(t),t._update()}toObject(){const i={vertices:this.vertices.map(function(t){return t.toObject()})};return er.each(DE.Properties,function(t){void 0!==this[t]&&(i[t]=this[t].toObject?this[t].toObject():this[t])},this),i.className=this.className,i.translation=this.translation.toObject(),i.rotation=this.rotation,i.scale=this.scale instanceof gn?this.scale.toObject():this.scale,i.skewX=this.skewX,i.skewY=this.skewY,this.matrix.manual&&(i.matrix=this.matrix.toObject()),i}noFill(){return this.fill="transparent",this}noStroke(){return this.stroke=void 0,this}corner(){const i=this.getBoundingClientRect(!0),t=i.width/2,e=i.height/2,n=i.left+i.width/2,r=i.top+i.height/2;for(let s=0;s<this.vertices.length;s++){const a=this.vertices[s];a.x-=n,a.y-=r,a.x+=t,a.y+=e}return this.mask&&(this.mask.translation.x-=n,this.mask.translation.x+=t,this.mask.translation.y-=r,this.mask.translation.y+=e),this}center(){const i=this.getBoundingClientRect(!0),t=i.left+i.width/2-this.translation.x,e=i.top+i.height/2-this.translation.y;for(let n=0;n<this.vertices.length;n++){const r=this.vertices[n];r.x-=t,r.y-=e}return this.mask&&(this.mask.translation.x-=t,this.mask.translation.y-=e),this}getBoundingClientRect(i){let t,e,n,r,s,a,l,u,h,m,_,v,S,T,I=1/0,j=-1/0,P=1/0,E=-1/0;if(this._update(!0),t=i?this._matrix:W0(this),e=(this.linewidth||0)/2,n=this._renderer.vertices.length,n<=0)return{width:0,height:0};for(r=0;r<n;r++)if(a=this._renderer.vertices[r],s=this._renderer.vertices[(r+n-1)%n],s.controls&&a.controls){l=s.controls.right.x,u=s.controls.right.y,s.relative&&(l+=s.x,u+=s.y),h=a.controls.left.x,m=a.controls.left.y,a.relative&&(h+=a.x,m+=a.y);const ie=jQ(s.x,s.y,l,u,h,m,a.x,a.y);P=tv(ie.min.y-e,P),I=tv(ie.min.x-e,I),j=iv(ie.max.x+e,j),E=iv(ie.max.y+e,E)}else r<=1&&(P=tv(s.y-e,P),I=tv(s.x-e,I),j=iv(s.x+e,j),E=iv(s.y+e,E)),P=tv(a.y-e,P),I=tv(a.x-e,I),j=iv(a.x+e,j),E=iv(a.y+e,E);return _=t.multiply(I,P,1),v=t.multiply(I,E,1),S=t.multiply(j,P,1),T=t.multiply(j,E,1),P=tv(_.y,v.y,S.y,T.y),I=tv(_.x,v.x,S.x,T.x),j=iv(_.x,v.x,S.x,T.x),E=iv(_.y,v.y,S.y,T.y),{top:P,left:I,right:j,bottom:E,width:j-I,height:E-P}}getPointAt(i,t){let e,n,r,s,a,l,u,h,m,_,v,S,T,I,j,P=this.length*Math.min(Math.max(i,0),1);const E=this.vertices.length,ie=E-1;let ee=null,ce=null;for(let et=0,vt=this._lengths.length,kt=0;et<vt;et++){if(kt+this._lengths[et]>=P){this._closed?(e=Xh(et,E),n=Xh(et-1,E),0===et&&(e=n,n=et)):(e=et,n=Math.min(Math.max(et-1,0),ie)),ee=this.vertices[e],ce=this.vertices[n],P-=kt,i=0!==this._lengths[et]?P/this._lengths[et]:0;break}kt+=this._lengths[et]}if(null===ee||null===ce)return null;if(!ee)return ce;if(!ce)return ee;j=ce.controls&&ce.controls.right,I=ee.controls&&ee.controls.left,a=ce.x,_=ce.y,l=(j||ce).x,v=(j||ce).y,u=(I||ee).x,S=(I||ee).y,h=ee.x,T=ee.y,j&&ce.relative&&(l+=ce.x,v+=ce.y),I&&ee.relative&&(u+=ee.x,S+=ee.y),s=EE(i,a,l,u,h),m=EE(i,_,v,S,T);const ye=qh(a,l,i),Ce=qh(_,v,i),Ge=qh(l,u,i),Qe=qh(v,S,i),nt=qh(u,h,i),ge=qh(S,T,i),Je=qh(ye,Ge,i),mt=qh(Ce,Qe,i),pt=qh(Ge,nt,i),Pt=qh(Qe,ge,i);return er.isObject(t)?(t.x=s,t.y=m,t instanceof Ds&&(t.controls.left.x=Je,t.controls.left.y=mt,t.controls.right.x=pt,t.controls.right.y=Pt,("boolean"!=typeof t.relative||t.relative)&&(t.controls.left.x-=s,t.controls.left.y-=m,t.controls.right.x-=s,t.controls.right.y-=m)),t.t=i,t):(r=new Ds(s,m,Je-s,mt-m,pt-s,Pt-m,this._curved?Ji.curve:Ji.line),r.t=i,r)}plot(){if(this.curved)return XQ(this._collection,this.closed),this;for(let i=0;i<this._collection.length;i++)this._collection[i].command=0===i?Ji.move:Ji.line;return this}subdivide(i){this._update();const t=this.vertices.length-1,e=this._closed||this.vertices[t]._command===Ji.close;let s,n=this.vertices[t],r=[];return er.each(this.vertices,function(a,l){if(!(l<=0)||e)return a.command===Ji.move?(r.push(new Ds(n.x,n.y)),l>0&&(r[r.length-1].command=Ji.line),void(n=a)):(s=aJ(a,n,i),r=r.concat(s),er.each(s,function(u,h){u.command=h<=0&&n.command===Ji.move?Ji.move:Ji.line}),l>=t&&(this._closed&&this._automatic?(n=a,s=aJ(a,n,i),r=r.concat(s),er.each(s,function(u,h){u.command=h<=0&&n.command===Ji.move?Ji.move:Ji.line})):e&&r.push(new Ds(a.x,a.y)),r[r.length-1].command=e?Ji.close:Ji.line),void(n=a));n=a},this),this._automatic=!1,this._curved=!1,this.vertices=r,this}_updateLength(i,t){t||this._update();let s=this.vertices[this.vertices.length-1],a=0;return void 0===this._lengths&&(this._lengths=[]),er.each(this.vertices,function(l,u){if(u<=0||l.command===Ji.move)return s=l,void(this._lengths[u]=0);this._lengths[u]=B4(l,s,i),a+=this._lengths[u],s=l},this),this._length=a,this._flagLength=!1,this}_update(){if(this._flagVertices){this._automatic&&this.plot(),this._flagLength&&this._updateLength(void 0,!0);const i=this._collection.length,t=this._closed,e=Math.min(this._beginning,this._ending),n=Math.max(this._beginning,this._ending),r=OI(this,e*this._length),s=OI(this,n*this._length),a=LEe(r),l=OEe(s);let u,h,m,_,v,S;for(this._renderer.vertices.length=0,S=0;S<i;S++)this._renderer.collection.length<=S&&this._renderer.collection.push(new Ds),S>l&&!h?(v=this._renderer.collection[S].copy(this._collection[S]),this.getPointAt(n,v),v.command=this._renderer.collection[S].command,this._renderer.vertices.push(v),h=v,m=this._collection[S-1],m&&m.controls&&(v.controls.relative?v.controls.right.clear():v.controls.right.copy(v),this._renderer.collection[S-1].controls.right.copy(m).lerp(m.controls.right,v.t))):S>=a&&S<=l&&(v=this._renderer.collection[S].copy(this._collection[S]),this._renderer.vertices.push(v),S===l&&oJ(this,n)?(h=v,!t&&h.controls&&(h.relative?h.controls.right.clear():h.controls.right.copy(h))):S===a&&oJ(this,e)&&(u=v,u.command=Ji.move,!t&&u.controls&&(u.relative?u.controls.left.clear():u.controls.left.copy(u))));a>0&&!u&&(S=a-1,v=this._renderer.collection[S].copy(this._collection[S]),this.getPointAt(e,v),v.command=Ji.move,this._renderer.vertices.unshift(v),_=this._collection[S+1],_&&_.controls&&(v.controls.left.clear(),_.relative?this._renderer.collection[S+1].controls.left.copy(_.controls.left).lerp(gn.zero,v.t):(FEe.copy(_),this._renderer.collection[S+1].controls.left.copy(_.controls.left).lerp(_,v.t))))}return Qy.prototype._update.apply(this,arguments),this}flagReset(){return this._flagVertices=this._flagLength=this._flagFill=this._flagStroke=this._flagLinewidth=this._flagOpacity=this._flagVisible=this._flagCap=this._flagJoin=this._flagMiter=this._flagClip=!1,Qy.prototype.flagReset.call(this),this}},$s=DE;Ie($s,"Properties",["fill","stroke","linewidth","opacity","visible","cap","join","miter","closed","curved","automatic","beginning","ending"]),Ie($s,"Utils",{getCurveLength:B4});var mJ={linewidth:{enumerable:!0,get:function(){return this._linewidth},set:function(i){this._linewidth=i,this._flagLinewidth=!0}},opacity:{enumerable:!0,get:function(){return this._opacity},set:function(i){this._opacity=i,this._flagOpacity=!0}},visible:{enumerable:!0,get:function(){return this._visible},set:function(i){this._visible=i,this._flagVisible=!0}},cap:{enumerable:!0,get:function(){return this._cap},set:function(i){this._cap=i,this._flagCap=!0}},join:{enumerable:!0,get:function(){return this._join},set:function(i){this._join=i,this._flagJoin=!0}},miter:{enumerable:!0,get:function(){return this._miter},set:function(i){this._miter=i,this._flagMiter=!0}},fill:{enumerable:!0,get:function(){return this._fill},set:function(i){(this._fill instanceof tc||this._fill instanceof Ba||this._fill instanceof Na||this._fill instanceof xo)&&this._fill.unbind(Mi.Types.change,this._renderer.flagFill),this._fill=i,this._flagFill=!0,(this._fill instanceof tc||this._fill instanceof Ba||this._fill instanceof Na||this._fill instanceof xo)&&this._fill.bind(Mi.Types.change,this._renderer.flagFill)}},stroke:{enumerable:!0,get:function(){return this._stroke},set:function(i){(this._stroke instanceof tc||this._stroke instanceof Ba||this._stroke instanceof Na||this._stroke instanceof xo)&&this._stroke.unbind(Mi.Types.change,this._renderer.flagStroke),this._stroke=i,this._flagStroke=!0,(this._stroke instanceof tc||this._stroke instanceof Ba||this._stroke instanceof Na||this._stroke instanceof xo)&&this._stroke.bind(Mi.Types.change,this._renderer.flagStroke)}},length:{get:function(){return this._flagLength&&this._updateLength(),this._length}},closed:{enumerable:!0,get:function(){return this._closed},set:function(i){this._closed=!!i,this._flagVertices=!0}},curved:{enumerable:!0,get:function(){return this._curved},set:function(i){this._curved=!!i,this._flagVertices=!0}},automatic:{enumerable:!0,get:function(){return this._automatic},set:function(i){if(i===this._automatic)return;this._automatic=!!i;const t=this._automatic?"ignore":"listen";er.each(this.vertices,function(e){e[t]()})}},beginning:{enumerable:!0,get:function(){return this._beginning},set:function(i){this._beginning=i,this._flagVertices=!0}},ending:{enumerable:!0,get:function(){return this._ending},set:function(i){this._ending=i,this._flagVertices=!0}},vertices:{enumerable:!0,get:function(){return this._collection},set:function(i){const t=this._renderer.bindVertices,e=this._renderer.unbindVertices;this._collection&&this._collection.unbind(Mi.Types.insert,t).unbind(Mi.Types.remove,e),this._collection=i instanceof Jy?i:new Jy(i||[]),this._collection.bind(Mi.Types.insert,t).bind(Mi.Types.remove,e),t(this._collection)}},mask:{enumerable:!0,get:function(){return this._mask},set:function(i){this._mask=i,this._flagMask=!0,er.isObject(i)&&!i.clip&&(i.clip=!0)}},clip:{enumerable:!0,get:function(){return this._clip},set:function(i){this._clip=i,this._flagClip=!0}},dashes:{enumerable:!0,get:function(){return this._dashes},set:function(i){"number"!=typeof i.offset&&(i.offset=this.dashes&&this._dashes.offset||0),this._dashes=i}}};function gJ(){this._flagVertices=!0,this._flagLength=!0,this.parent&&(this.parent._flagLength=!0)}function _J(i){let t=i.length;for(;t--;)i[t].bind(Mi.Types.change,this._renderer.flagVertices);this._renderer.flagVertices()}function yJ(i){let t=i.length;for(;t--;)i[t].unbind(Mi.Types.change,this._renderer.flagVertices);this._renderer.flagVertices()}function vJ(){this._flagFill=!0}function bJ(){this._flagStroke=!0}var xJ=class extends $s{constructor(i,t,e,n){super([new Ds,new Ds,new Ds,new Ds],!0,!1,!0),Ie(this,"_flagWidth",0),Ie(this,"_flagHeight",0),Ie(this,"_width",0),Ie(this,"_height",0),Ie(this,"_origin",null);for(let s in wJ)Object.defineProperty(this,s,wJ[s]);this.width=e,this.height=n,this.origin=new gn,this.translation.set(i,t),this._update()}_update(){if(this._flagVertices||this._flagWidth||this._flagHeight){const i=this._width/2,t=this._height/2;!this._closed&&4===this.vertices.length&&this.vertices.push(new Ds),this.vertices[0].set(-i,-t).sub(this._origin).command=Ji.move,this.vertices[1].set(i,-t).sub(this._origin).command=Ji.line,this.vertices[2].set(i,t).sub(this._origin).command=Ji.line,this.vertices[3].set(-i,t).sub(this._origin).command=Ji.line,this.vertices[4]&&(this.vertices[4].set(-i,-t).sub(this._origin).command=Ji.line)}return super._update.call(this),this}flagReset(){return this._flagWidth=this._flagHeight=!1,super.flagReset.call(this),this}clone(i){const t=new xJ(0,0,this.width,this.height);t.translation.copy(this.translation),t.rotation=this.rotation,t.scale=this.scale,t.skewX=this.skewX,t.skewY=this.skewY,this.matrix.manual&&t.matrix.copy(this.matrix);for(let e=0;e<$s.Properties.length;e++){const n=$s.Properties[e];t[n]=this[n]}return i&&i.add(t),t}toObject(){const i=super.toObject.call(this);return i.width=this.width,i.height=this.height,i.origin=this.origin.toObject(),i}},q0=xJ;Ie(q0,"Properties",["width","height"]);var wJ={width:{enumerable:!0,get:function(){return this._width},set:function(i){this._width=i,this._flagWidth=!0}},height:{enumerable:!0,get:function(){return this._height},set:function(i){this._height=i,this._flagHeight=!0}},origin:{enumerable:!0,get:function(){return this._origin},set:function(i){this._origin&&this._origin.unbind(Mi.Types.change,this._renderer.flagVertices),this._origin=i,this._origin.bind(Mi.Types.change,this._renderer.flagVertices),this._renderer.flagVertices()}}},SJ=class extends q0{constructor(i,t,e,n,r,s){super(t,e,0,0),Ie(this,"_flagTexture",!1),Ie(this,"_flagColumns",!1),Ie(this,"_flagRows",!1),Ie(this,"_flagFrameRate",!1),Ie(this,"_flagIndex",!1),Ie(this,"_amount",1),Ie(this,"_duration",0),Ie(this,"_startTime",0),Ie(this,"_playing",!1),Ie(this,"_firstFrame",0),Ie(this,"_lastFrame",0),Ie(this,"_loop",!0),Ie(this,"_texture",null),Ie(this,"_columns",1),Ie(this,"_rows",1),Ie(this,"_frameRate",0),Ie(this,"_index",0),Ie(this,"_origin",null);for(let a in CJ)Object.defineProperty(this,a,CJ[a]);this.noStroke(),this.noFill(),i instanceof xo?this.texture=i:"string"==typeof i&&(this.texture=new xo(i)),this.origin=new gn,this._update(),"number"==typeof n&&(this.columns=n),"number"==typeof r&&(this.rows=r),"number"==typeof s&&(this.frameRate=s),this.index=0}play(i,t,e){return this._playing=!0,this._firstFrame=0,this._lastFrame=this.amount-1,this._startTime=er.performance.now(),"number"==typeof i&&(this._firstFrame=i),"number"==typeof t&&(this._lastFrame=t),"function"==typeof e?this._onLastFrame=e:delete this._onLastFrame,this._index!==this._firstFrame&&(this._startTime-=1e3*Math.abs(this._index-this._firstFrame)/this._frameRate),this}pause(){return this._playing=!1,this}stop(){return this._playing=!1,this._index=0,this}clone(i){const t=new SJ(this.texture,this.translation.x,this.translation.y,this.columns,this.rows,this.frameRate);return this.playing&&(t.play(this._firstFrame,this._lastFrame),t._loop=this._loop),i&&i.add(t),t}toObject(){const i=super.toObject.call(this);return i.texture=this.texture.toObject(),i.columns=this.columns,i.rows=this.rows,i.frameRate=this.frameRate,i.index=this.index,i._firstFrame=this._firstFrame,i._lastFrame=this._lastFrame,i._loop=this._loop,i}_update(){const i=this._texture,t=this._columns,e=this._rows;let n,r,s,a,l,u,h,m,_;if(i&&((this._flagColumns||this._flagRows)&&(this._amount=this._columns*this._rows),this._flagFrameRate&&(this._duration=1e3*this._amount/this._frameRate),this._flagTexture&&(this.fill=i),i.loaded)){h=i.image.width,m=i.image.height,n=h/t,r=m/e,a=this._amount,this.width!==n&&(this.width=n),this.height!==r&&(this.height=r),this._playing&&this._frameRate>0&&(er.isNaN(this._lastFrame)&&(this._lastFrame=a-1),s=er.performance.now()-this._startTime,_=this._lastFrame+1,l=1e3*(_-this._firstFrame)/this._frameRate,this._loop?s%=l:s=Math.min(s,l),u=qh(this._firstFrame,_,s/l),u=Math.floor(u),u!==this._index&&(this._index=u,u>=this._lastFrame-1&&this._onLastFrame&&this._onLastFrame()));const T=this._index%t*-n+(h-n)/2,I=-r*Math.floor(this._index/t)+(m-r)/2;T!==i.offset.x&&(i.offset.x=T),I!==i.offset.y&&(i.offset.y=I)}return super._update.call(this),this}flagReset(){return this._flagTexture=this._flagColumns=this._flagRows=this._flagFrameRate=!1,super.flagReset.call(this),this}},HI=SJ;Ie(HI,"Properties",["texture","columns","rows","frameRate","index"]);var CJ={texture:{enumerable:!0,get:function(){return this._texture},set:function(i){this._texture=i,this._flagTexture=!0}},columns:{enumerable:!0,get:function(){return this._columns},set:function(i){this._columns=i,this._flagColumns=!0}},rows:{enumerable:!0,get:function(){return this._rows},set:function(i){this._rows=i,this._flagRows=!0}},frameRate:{enumerable:!0,get:function(){return this._frameRate},set:function(i){this._frameRate=i,this._flagFrameRate=!0}},index:{enumerable:!0,get:function(){return this._index},set:function(i){this._index=i,this._flagIndex=!0}}},N4=Math.cos,H4=Math.sin,VI=class extends $s{constructor(i,t,e,n){const r=n?Math.max(n,2):4,s=[];for(let a=0;a<r;a++)s.push(new Ds(0,0,0,0,0,0));super(s,!0,!0,!0),Ie(this,"_flagRadius",!1),Ie(this,"_radius",0);for(let a in MJ)Object.defineProperty(this,a,MJ[a]);"number"==typeof e&&(this.radius=e),this._update(),"number"==typeof i&&(this.translation.x=i),"number"==typeof t&&(this.translation.y=t)}_update(){if(this._flagVertices||this._flagRadius){let i=this.vertices.length;!this._closed&&i>2&&(i-=1);const t=4/3*Math.tan(Math.PI/(2*i)),e=this._radius,n=e*t;for(let r=0;r<this.vertices.length;r++){const a=r/i*cu,l=e*N4(a),u=e*H4(a),h=n*N4(a-_c),m=n*H4(a-_c),_=n*N4(a+_c),v=n*H4(a+_c),S=this.vertices[r];S.command=0===r?Ji.move:Ji.curve,S.set(l,u),S.controls.left.set(h,m),S.controls.right.set(_,v)}}return super._update.call(this),this}flagReset(){return this._flagRadius=!1,super.flagReset.call(this),this}clone(i){const t=new VI(0,0,this.radius,this.vertices.length);t.translation.copy(this.translation),t.rotation=this.rotation,t.scale=this.scale,t.skewX=this.skewX,t.skewY=this.skewY,this.matrix.manual&&t.matrix.copy(this.matrix);for(let e=0;e<$s.Properties.length;e++){const n=$s.Properties[e];t[n]=this[n]}return i&&i.add(t),t}toObject(){const i=super.toObject.call(this);for(let t=0;t<VI.Properties.length;t++){const e=VI.Properties[t];i[e]=this[e]}return i}},zI=VI;Ie(zI,"Properties",["radius"]);var MJ={radius:{enumerable:!0,get:function(){return this._radius},set:function(i){this._radius=i,this._flagRadius=!0}}},V4=Math.cos,z4=Math.sin,UI=class extends $s{constructor(i,t,e,n,r){"number"!=typeof n&&"number"==typeof e&&(n=e);const s=r?Math.max(r,2):4,a=[];for(let l=0;l<s;l++)a.push(new Ds);super(a,!0,!0,!0),Ie(this,"_flagWidth",!1),Ie(this,"_flagHeight",!1),Ie(this,"_width",0),Ie(this,"_height",0);for(let l in TJ)Object.defineProperty(this,l,TJ[l]);"number"==typeof e&&(this.width=2*e),"number"==typeof n&&(this.height=2*n),this._update(),this.translation.set(i,t)}_update(){if(this._flagVertices||this._flagWidth||this._flagHeight){let i=this.vertices.length;!this._closed&&i>2&&(i-=1);const t=4/3*Math.tan(Math.PI/(2*this.vertices.length)),e=this._width/2,n=this._height/2;for(let r=0;r<this.vertices.length;r++){const a=r/i*cu,l=e*V4(a),u=n*z4(a),h=e*t*V4(a-_c),m=n*t*z4(a-_c),_=e*t*V4(a+_c),v=n*t*z4(a+_c),S=this.vertices[r];S.command=0===r?Ji.move:Ji.curve,S.set(l,u),S.controls.left.set(h,m),S.controls.right.set(_,v)}}return super._update.call(this),this}flagReset(){return this._flagWidth=this._flagHeight=!1,super.flagReset.call(this),this}clone(i){const r=new UI(0,0,this.width/2,this.height/2,this.vertices.length);r.translation.copy(this.translation),r.rotation=this.rotation,r.scale=this.scale,r.skewX=this.skewX,r.skewY=this.skewY,this.matrix.manual&&r.matrix.copy(this.matrix);for(let s=0;s<$s.Properties.length;s++){const a=$s.Properties[s];r[a]=this[a]}return i&&i.add(r),r}toObject(){const i=super.toObject.call(this);for(let t=0;t<UI.Properties.length;t++){const e=UI.Properties[t];i[e]=this[e]}return i}},GI=UI;Ie(GI,"Properties",["width","height"]);var TJ={width:{enumerable:!0,get:function(){return this._width},set:function(i){this._width=i,this._flagWidth=!0}},height:{enumerable:!0,get:function(){return this._height},set:function(i){this._height=i,this._flagHeight=!0}}},U4=class extends $s{constructor(i,t,e,n){super([new Ds(i,t),new Ds(e,n)]);for(let s in EJ)Object.defineProperty(this,s,EJ[s]);this.vertices[0].command=Ji.move,this.vertices[1].command=Ji.line,this.automatic=!1}},EJ={left:{enumerable:!0,get:function(){return this.vertices[0]},set:function(i){if(er.isObject(i))this.vertices.splice(0,1,i);else{const t=new Kh("Two.Line.x argument is not an object.");console.warn(t.name,t.message)}}},right:{enumerable:!0,get:function(){return this.vertices[0]},set:function(i){if(er.isObject(i))this.vertices.splice(1,1,i);else{const t=new Kh("Two.Line.y argument is not an object.");console.warn(t.name,t.message)}}}},WI=class extends $s{constructor(i,t,e,n,r){void 0===r&&"number"==typeof e&&"number"==typeof n&&(r=Math.floor(Math.min(e,n)/12));const s=[];for(let a=0;a<10;a++)s.push(new Ds(0,0,0,0,0,0,0===a?Ji.move:Ji.curve));super(s),Ie(this,"_flagWidth",!1),Ie(this,"_flagHeight",!1),Ie(this,"_flagRadius",!1),Ie(this,"_width",0),Ie(this,"_height",0),Ie(this,"_radius",12);for(let a in AJ)Object.defineProperty(this,a,AJ[a]);this.closed=!0,this.automatic=!1,this._renderer.flagRadius=BEe.bind(this),"number"==typeof e&&(this.width=e),"number"==typeof n&&(this.height=n),"number"==typeof r&&(this.radius=r),this._update(),this.translation.set(i,t)}_update(){if(this._flagVertices||this._flagWidth||this._flagHeight||this._flagRadius){let e,n;this._radius instanceof gn?(e=this._radius.x,n=this._radius.y):(e=this._radius,n=this._radius);let r,s=this._width/2,a=this._height/2;r=this.vertices[0],r.x=-(s-e),r.y=-a,r=this.vertices[1],r.x=s-e,r.y=-a,r.controls.left.clear(),r.controls.right.x=e,r.controls.right.y=0,r=this.vertices[2],r.x=s,r.y=-(a-n),r.controls.right.clear(),r.controls.left.clear(),r=this.vertices[3],r.x=s,r.y=a-n,r.controls.left.clear(),r.controls.right.x=0,r.controls.right.y=n,r=this.vertices[4],r.x=s-e,r.y=a,r.controls.right.clear(),r.controls.left.clear(),r=this.vertices[5],r.x=-(s-e),r.y=a,r.controls.left.clear(),r.controls.right.x=-e,r.controls.right.y=0,r=this.vertices[6],r.x=-s,r.y=a-n,r.controls.left.clear(),r.controls.right.clear(),r=this.vertices[7],r.x=-s,r.y=-(a-n),r.controls.left.clear(),r.controls.right.x=0,r.controls.right.y=-n,r=this.vertices[8],r.x=-(s-e),r.y=-a,r.controls.left.clear(),r.controls.right.clear(),r=this.vertices[9],r.copy(this.vertices[8])}return super._update.call(this),this}flagReset(){return this._flagWidth=this._flagHeight=this._flagRadius=!1,super.flagReset.call(this),this}clone(i){const r=new WI(0,0,this.width,this.height,this.radius);r.translation.copy(this.translation),r.rotation=this.rotation,r.scale=this.scale,r.skewX=this.skewX,r.skewY=this.skewY,this.matrix.manual&&r.matrix.copy(this.matrix);for(let s=0;s<$s.Properties.length;s++){const a=$s.Properties[s];r[a]=this[a]}return i&&i.add(r),r}toObject(){const i=super.toObject.call(this);for(let t=0;t<WI.Properties.length;t++){const e=WI.Properties[t];i[e]=this[e]}return i.radius="number"==typeof this.radius?this.radius:this.radius.toObject(),i}},jI=WI;Ie(jI,"Properties",["width","height","radius"]);var AJ={width:{enumerable:!0,get:function(){return this._width},set:function(i){this._width=i,this._flagWidth=!0}},height:{enumerable:!0,get:function(){return this._height},set:function(i){this._height=i,this._flagHeight=!0}},radius:{enumerable:!0,get:function(){return this._radius},set:function(i){this._radius instanceof gn&&this._radius.unbind(Mi.Types.change,this._renderer.flagRadius),this._radius=i,this._radius instanceof gn&&this._radius.bind(Mi.Types.change,this._renderer.flagRadius),this._flagRadius=!0}}};function BEe(){this._flagRadius=!0}var DJ=Math.min,RJ=Math.max,kg=class extends Qy{constructor(i,t,e,n){super(),Ie(this,"_flagValue",!0),Ie(this,"_flagFamily",!0),Ie(this,"_flagSize",!0),Ie(this,"_flagLeading",!0),Ie(this,"_flagAlignment",!0),Ie(this,"_flagBaseline",!0),Ie(this,"_flagStyle",!0),Ie(this,"_flagWeight",!0),Ie(this,"_flagDecoration",!0),Ie(this,"_flagFill",!0),Ie(this,"_flagStroke",!0),Ie(this,"_flagLinewidth",!0),Ie(this,"_flagOpacity",!0),Ie(this,"_flagVisible",!0),Ie(this,"_flagMask",!1),Ie(this,"_flagClip",!1),Ie(this,"_value",""),Ie(this,"_family","sans-serif"),Ie(this,"_size",13),Ie(this,"_leading",17),Ie(this,"_alignment","center"),Ie(this,"_baseline","middle"),Ie(this,"_style","normal"),Ie(this,"_weight",500),Ie(this,"_decoration","none"),Ie(this,"_fill","#000"),Ie(this,"_stroke","transparent"),Ie(this,"_linewidth",1),Ie(this,"_opacity",1),Ie(this,"_visible",!0),Ie(this,"_mask",null),Ie(this,"_clip",!1),Ie(this,"_dashes",null);for(let r in kJ)Object.defineProperty(this,r,kJ[r]);if(this._renderer.type="text",this._renderer.flagFill=NEe.bind(this),this._renderer.flagStroke=HEe.bind(this),this.value=i,"number"==typeof t&&(this.translation.x=t),"number"==typeof e&&(this.translation.y=e),this.dashes=[],this.dashes.offset=0,!er.isObject(n))return this;for(let r=0;r<kg.Properties.length;r++){const s=kg.Properties[r];s in n&&(this[s]=n[s])}}clone(i){const t=new kg(this.value);t.translation.copy(this.translation),t.rotation=this.rotation,t.scale=this.scale;for(let e=0;e<kg.Properties.length;e++){const n=kg.Properties[e];t[n]=this[n]}return this.matrix.manual&&t.matrix.copy(this.matrix),i&&i.add(t),t._update()}toObject(){const i={translation:this.translation.toObject(),rotation:this.rotation,scale:this.scale};this.matrix.manual&&(i.matrix=this.matrix.toObject());for(let t=0;t<kg.Properties.length;t++){const e=kg.Properties[t];i[e]=this[e]}return i}noFill(){return this.fill="transparent",this}noStroke(){return this.stroke=void 0,this.linewidth=void 0,this}getBoundingClientRect(i){let t,e,n,r,s,a,l,u,h;this._update(!0),t=i?this._matrix:W0(this);const m=this.leading,_=this.value.length*this.size*kg.Ratio,v=(this._linewidth||0)/2;switch(this.alignment){case"left":a=-v,l=_+v;break;case"right":a=-(_+v),l=v;break;default:a=-(_/2+v),l=_/2+v}switch(this.baseline){case"top":u=-v,h=m+v;break;case"bottom":u=-(m+v),h=v;break;default:u=-(m/2+v),h=m/2+v}return e=t.multiply(a,u,1),n=t.multiply(a,h,1),r=t.multiply(l,u,1),s=t.multiply(l,h,1),u=DJ(e.y,n.y,r.y,s.y),a=DJ(e.x,n.x,r.x,s.x),l=RJ(e.x,n.x,r.x,s.x),h=RJ(e.y,n.y,r.y,s.y),{top:u,left:a,right:l,bottom:h,width:l-a,height:h-u}}flagReset(){return super.flagReset.call(this),this._flagValue=this._flagFamily=this._flagSize=this._flagLeading=this._flagAlignment=this._flagFill=this._flagStroke=this._flagLinewidth=this._flagOpacity=this._flagVisible=this._flagClip=this._flagDecoration=this._flagClassName=this._flagBaseline=this._flagWeight=this._flagStyle=!1,this}},Jf=kg;Ie(Jf,"Ratio",.6),Ie(Jf,"Properties",["value","family","size","leading","alignment","linewidth","style","weight","decoration","baseline","opacity","visible","fill","stroke"]);var kJ={value:{enumerable:!0,get:function(){return this._value},set:function(i){this._value=i,this._flagValue=!0}},family:{enumerable:!0,get:function(){return this._family},set:function(i){this._family=i,this._flagFamily=!0}},size:{enumerable:!0,get:function(){return this._size},set:function(i){this._size=i,this._flagSize=!0}},leading:{enumerable:!0,get:function(){return this._leading},set:function(i){this._leading=i,this._flagLeading=!0}},alignment:{enumerable:!0,get:function(){return this._alignment},set:function(i){this._alignment=i,this._flagAlignment=!0}},linewidth:{enumerable:!0,get:function(){return this._linewidth},set:function(i){this._linewidth=i,this._flagLinewidth=!0}},style:{enumerable:!0,get:function(){return this._style},set:function(i){this._style=i,this._flagStyle=!0}},weight:{enumerable:!0,get:function(){return this._weight},set:function(i){this._weight=i,this._flagWeight=!0}},decoration:{enumerable:!0,get:function(){return this._decoration},set:function(i){this._decoration=i,this._flagDecoration=!0}},baseline:{enumerable:!0,get:function(){return this._baseline},set:function(i){this._baseline=i,this._flagBaseline=!0}},opacity:{enumerable:!0,get:function(){return this._opacity},set:function(i){this._opacity=i,this._flagOpacity=!0}},visible:{enumerable:!0,get:function(){return this._visible},set:function(i){this._visible=i,this._flagVisible=!0}},fill:{enumerable:!0,get:function(){return this._fill},set:function(i){(this._fill instanceof tc||this._fill instanceof Ba||this._fill instanceof Na||this._fill instanceof xo)&&this._fill.unbind(Mi.Types.change,this._renderer.flagFill),this._fill=i,this._flagFill=!0,(this._fill instanceof tc||this._fill instanceof Ba||this._fill instanceof Na||this._fill instanceof xo)&&this._fill.bind(Mi.Types.change,this._renderer.flagFill)}},stroke:{enumerable:!0,get:function(){return this._stroke},set:function(i){(this._stroke instanceof tc||this._stroke instanceof Ba||this._stroke instanceof Na||this._stroke instanceof xo)&&this._stroke.unbind(Mi.Types.change,this._renderer.flagStroke),this._stroke=i,this._flagStroke=!0,(this._stroke instanceof tc||this._stroke instanceof Ba||this._stroke instanceof Na||this._stroke instanceof xo)&&this._stroke.bind(Mi.Types.change,this._renderer.flagStroke)}},mask:{enumerable:!0,get:function(){return this._mask},set:function(i){this._mask=i,this._flagMask=!0,er.isObject(i)&&!i.clip&&(i.clip=!0)}},clip:{enumerable:!0,get:function(){return this._clip},set:function(i){this._clip=i,this._flagClip=!0}},dashes:{enumerable:!0,get:function(){return this._dashes},set:function(i){"number"!=typeof i.offset&&(i.offset=this.dashes&&this._dashes.offset||0),this._dashes=i}}};function NEe(){this._flagFill=!0}function HEe(){this._flagStroke=!0}var jp={path:/[+-]?(?:\d*\.\d+|\d+)(?:[eE][+-]\d+)?/g,cssBackgroundImage:/url\(['"]?#([\w\d-_]*)['"]?\)/i,unitSuffix:/[a-zA-Z%]*/i},VEe={start:"left",middle:"center",end:"right"},PJ=["id","class","transform","xmlns","viewBox"],zEe=["x","y","width","height","href","xlink:href"];function RE(i){return i.replace(/svg:/gi,"").toLowerCase()}function IJ(i,t){if(t.x+=i.translateX,t.y+=i.translateY,t.x*=i.scaleX,t.y*=i.scaleY,0!==i.rotation){const e=t.length();t.x=e*Math.cos(i.rotation),t.y=e*Math.sin(i.rotation)}}function WEe(i,t){t||(t={});const e=i.split(";");for(let n=0;n<e.length;n++){const r=e[n].split(":"),s=r[0],a=r[1];void 0===s||void 0===a||(t[s]=a.replace(/\s/,""))}return t}function jEe(i){const t={},e=function qEe(i){const t=i.getAttributeNames();for(let e=0;e<PJ.length;e++){const r=Array.prototype.indexOf.call(t,PJ[e]);r>=0&&t.splice(r,1)}return t}(i),n=Math.max(e.length,i.style.length);for(let r=0;r<n;r++){const s=i.style[r],a=e[r];s&&(t[s]=i.style[s]),a&&(t[a]=i.getAttribute(a))}return t}function nf(i,t,e){const n={},r={},s={};let a,l,u,h,m,_,v,S,T,I,j,P,E,ie,ee,ce,ye;if(ul.getComputedStyle){const Ce=ul.getComputedStyle(i);for(a=Ce.length;a--;)u=Ce[a],h=Ce[u],void 0!==h&&(n[u]=h)}for(a=0;a<i.attributes.length;a++)_=i.attributes[a],/style/i.test(_.nodeName)?WEe(_.value,s):r[_.nodeName]=_.value;for(u in void 0!==n.opacity&&(n["stroke-opacity"]=n.opacity,n["fill-opacity"]=n.opacity,delete n.opacity),e&&er.defaults(n,e),er.extend(n,s,r),n.visible=!(void 0===n.display&&/none/i.test(n.display))||void 0===n.visibility&&/hidden/i.test(n.visibility),n)switch(h=n[u],u){case"gradientTransform":if(/none/i.test(h)||(l=i.gradientTransform&&i.gradientTransform.baseVal&&i.gradientTransform.baseVal.length>0?i.gradientTransform.baseVal[0].matrix:i.getCTM?i.getCTM():null,null===l))break;switch(v=TE(l),t._renderer.type){case"linear-gradient":IJ(v,t.left),IJ(v,t.right);break;case"radial-gradient":t.center.x+=v.translateX,t.center.y+=v.translateY,t.focal.x+=v.translateX,t.focal.y+=v.translateY,t.radius*=Math.max(v.scaleX,v.scaleY)}break;case"transform":if(/none/i.test(h)||(l=i.transform&&i.transform.baseVal&&i.transform.baseVal.length>0?i.transform.baseVal[0].matrix:i.getCTM?i.getCTM():null,null===l))break;v=TE(l),t.translation.set(v.translateX,v.translateY),t.rotation=Math.PI*(v.rotation/180),t.scale=new gn(v.scaleX,v.scaleY),S=parseFloat((n.x+"").replace("px")),T=parseFloat((n.y+"").replace("px")),S&&(t.translation.x=S),T&&(t.translation.y=T);break;case"visible":if(t instanceof ec){t._visible=h;break}t.visible=h;break;case"stroke-linecap":if(t instanceof ec){t._cap=h;break}t.cap=h;break;case"stroke-linejoin":if(t instanceof ec){t._join=h;break}t.join=h;break;case"stroke-miterlimit":if(t instanceof ec){t._miter=h;break}t.miter=h;break;case"stroke-width":if(t instanceof ec){t._linewidth=parseFloat(h);break}t.linewidth=parseFloat(h);break;case"opacity":case"stroke-opacity":case"fill-opacity":if(t instanceof ec){t._opacity=parseFloat(h);break}t.opacity=parseFloat(h);break;case"clip-path":if(jp.cssBackgroundImage.test(h)&&(I=h.replace(jp.cssBackgroundImage,"$1"),Ha.defs.current&&Ha.defs.current.contains(I)&&(P=Ha.defs.current.get(I),P&&P.childNodes.length>0)))switch(P=P.childNodes[0],E=RE(P.nodeName),t.mask=Ha[E].call(this,P,{}),t._renderer.type){case"text":case"path":t.position.add(t.mask.position),t.mask.position.clear()}break;case"fill":case"stroke":m=(t instanceof ec?"_":"")+u,jp.cssBackgroundImage.test(h)?(I=h.replace(jp.cssBackgroundImage,"$1"),Ha.defs.current&&Ha.defs.current.contains(I)?(P=Ha.defs.current.get(I),P.object||(E=RE(P.nodeName),P.object=Ha[E].call(this,P,{})),P=P.object):(j=YEe(this),P=j.getById(I)),t[m]=P):t[m]=/none/i.test(h)?"transparent":h;break;case"id":t.id=h;break;case"class":case"className":t.classList=h.split(" "),t._flagClassName=!0;break;case"x":case"y":if(ie=t instanceof tc,ee=t instanceof Ba,ce=t instanceof Na,ie||ee||ce)break;h.match("[a-z%]$")&&!h.endsWith("px")&&(ye=new Kh("only pixel values are supported with the "+u+" attribute."),console.warn(ye.name,ye.message)),t.translation[u]=parseFloat(h);break;case"font-family":t instanceof Jf&&(t.family=h);break;case"font-size":t instanceof Jf&&(t.size=h);break;case"font-weight":t instanceof Jf&&(t.weight=h);break;case"font-style":t instanceof Jf&&(t.style=h);break;case"text-decoration":t instanceof Jf&&(t.decoration=h);break;case"line-height":t instanceof Jf&&(t.leading=h)}return Object.keys(i.dataset).length&&(t.dataset=i.dataset),n}function ZEe(i,t){for(let e=0,n=i.childNodes.length;e<n;e++){const r=i.childNodes[e];!r.id||"#text"===RE(i.nodeName)||t.add(r.id,r)}}function YEe(i){for(;i.parent;)i=i.parent;return i.scene}var Ha={svg:function(i){const t=Ha.defs.current=new LI,e=i.getElementsByTagName("defs");for(let T=0;T<e.length;T++)ZEe(e[T],t);const n=Ha.g.call(this,i),r=i.getAttribute("viewBox"),s=i.getAttribute("x"),a=i.getAttribute("y"),l=i.getAttribute("width"),u=i.getAttribute("height");n.defs=t;const h=null!==r,_=null!==a,v=null!==l,S=null!==u;return null!==s&&(n.x=parseFloat(s.replace(jp.unitSuffix,""))),_&&(n.y=parseFloat(a.replace(jp.unitSuffix,""))),v&&(n.width=parseFloat(l.replace(jp.unitSuffix,""))),S&&(n.height=parseFloat(u.replace(jp.unitSuffix,""))),h&&function XEe(i,t){const e=t.split(/[\s,]/),n=-parseFloat(e[0]),r=-parseFloat(e[1]),s=parseFloat(e[2]),a=parseFloat(e[3]);if(n&&r)for(let _=0;_<i.children.length;_++){const v=i.children[_];"translation"in v?v.translation.add(n,r):"x"in v?v.x=n:"y"in v&&(v.y=r)}const u="number"==typeof i.y,h="number"==typeof i.width,m="number"==typeof i.height;"number"==typeof i.x&&(i.translation.x+=i.x),u&&(i.translation.y+=i.y),(h||m)&&(i.scale=new gn(1,1)),h&&(i.scale.x=i.width/s),m&&(i.scale.y=i.height/a),i.mask=new q0(0,0,s,a),i.mask.origin.set(-s/2,-a/2)}(n,r),delete Ha.defs.current,n},defs:function(i){return null},use:function(i,t){let e;const n=i.getAttribute("href")||i.getAttribute("xlink:href");if(!n)return e=new Kh("encountered <use /> with no href."),console.warn(e.name,e.message),null;const r=n.slice(1);if(!Ha.defs.current.contains(r))return e=new Kh("unable to find element for reference "+n+"."),console.warn(e.name,e.message),null;const a=Ha.defs.current.get(r).cloneNode(!0);for(let u=0;u<i.attributes.length;u++){const h=i.attributes[u],m=zEe.includes(h.nodeName),_=!a.hasAttribute(h.nodeName);(m||_)&&a.setAttribute(h.nodeName,h.value)}const l=RE(a.nodeName);return Ha[l].call(this,a,t)},g:function(i,t){const e=new ec;nf.call(this,i,e,t),this.add(e);const n=jEe.call(this,i);for(let r=0,s=i.childNodes.length;r<s;r++){const a=i.childNodes[r],l=a.nodeName;if(!l)return;const u=RE(l);if(u in Ha){const h=Ha[u].call(e,a,n);h&&!h.parent&&e.add(h)}}return e},polygon:function(i,t){let e;e="string"==typeof i?i:i.getAttribute("points");const n=[];e.replace(/(-?[\d.eE-]+)[,|\s](-?[\d.eE-]+)/g,function(s,a,l){n.push(new Ds(parseFloat(a),parseFloat(l)))});const r=new $s(n,!0).noStroke();return r.fill="black",nf.call(this,i,r,t),r},polyline:function(i,t){const e=Ha.polygon.call(this,i,t);return e.closed=!1,e},path:function(i,t){let e;e="string"==typeof i?i:i.getAttribute("d");let n=[],r=!1,s=!1;if(e){let u,h,l=new Ds,m=e.match(/[a-df-z][^a-df-z]*/gi);const _=m.length-1;er.each(m.slice(0),function(v,S){const T=v.slice(1).trim().match(jp.path),I=v[0],j=I.toLowerCase();let P,E,ie,ee,ce;const ye=[];switch(0===S&&(m=[]),j){case"h":case"v":T.length>1&&(P=1);break;case"m":case"l":case"t":T.length>2&&(P=2);break;case"s":case"q":T.length>4&&(P=4);break;case"c":T.length>6&&(P=6);break;case"a":T.length>7&&(P=7)}if(P){for(E=0,ie=T.length,ce=0;E<ie;E+=P){if(ee=I,ce>0)switch(I){case"m":ee="l";break;case"M":ee="L"}ye.push(ee+T.slice(E,E+P).join(" ")),ce++}m=Array.prototype.concat.apply(m,ye)}else m.push(v)}),er.each(m,function(v,S){let T,I,j;const P=v[0],E=P.toLowerCase();let ie,ee,ce,ye,Ce,Ge,Qe,nt,ge,Je,mt,pt,Pt,et,vt,kt,pi;switch(h=v.slice(1).trim().match(jp.path),s=P===E,E){case"z":if(S>=_)r=!0;else{I=l.x,j=l.y,T=new Ds(I,j,void 0,void 0,void 0,void 0,Ji.close);for(let Ht=n.length-1;Ht>=0;Ht--){const ct=n[Ht];if(/m/i.test(ct.command)){l=ct;break}}}break;case"m":case"l":u=void 0,I=parseFloat(h[0]),j=parseFloat(h[1]),T=new Ds(I,j,void 0,void 0,void 0,void 0,/m/i.test(E)?Ji.move:Ji.line),s&&T.addSelf(l),l=T;break;case"h":case"v":Je=/h/i.test(E)?"x":"y",mt=/x/i.test(Je)?"y":"x",T=new Ds(void 0,void 0,void 0,void 0,void 0,void 0,Ji.line),T[Je]=parseFloat(h[0]),T[mt]=l[mt],s&&(T[Je]+=l[Je]),l=T;break;case"c":case"s":ie=l.x,ee=l.y,u||(u=new gn),/c/i.test(E)?(ce=parseFloat(h[0]),ye=parseFloat(h[1]),Ce=parseFloat(h[2]),Ge=parseFloat(h[3]),Qe=parseFloat(h[4]),nt=parseFloat(h[5])):(ge=P4(l,u,s),ce=ge.x,ye=ge.y,Ce=parseFloat(h[0]),Ge=parseFloat(h[1]),Qe=parseFloat(h[2]),nt=parseFloat(h[3])),s&&(ce+=ie,ye+=ee,Ce+=ie,Ge+=ee,Qe+=ie,nt+=ee),l.controls.right.set(ce-l.x,ye-l.y),T=new Ds(Qe,nt,Ce-Qe,Ge-nt,void 0,void 0,Ji.curve),l=T,u=T.controls.left;break;case"t":case"q":ie=l.x,ee=l.y,u||(u=new gn),/q/i.test(E)?(ce=parseFloat(h[0]),ye=parseFloat(h[1]),Ce=parseFloat(h[0]),Ge=parseFloat(h[1]),Qe=parseFloat(h[2]),nt=parseFloat(h[3])):(ge=P4(l,u,s),ce=ge.x,ye=ge.y,Ce=ge.x,Ge=ge.y,Qe=parseFloat(h[0]),nt=parseFloat(h[1])),s&&(ce+=ie,ye+=ee,Ce+=ie,Ge+=ee,Qe+=ie,nt+=ee),l.controls.right.set(.33*(ce-l.x),.33*(ye-l.y)),T=new Ds(Qe,nt,Ce-Qe,Ge-nt,void 0,void 0,Ji.curve),l=T,u=T.controls.left;break;case"a":ie=l.x,ee=l.y,Pt=parseFloat(h[0]),et=parseFloat(h[1]),vt=parseFloat(h[2]),kt=parseFloat(h[3]),pi=parseFloat(h[4]),Qe=parseFloat(h[5]),nt=parseFloat(h[6]),s&&(Qe+=ie,nt+=ee),pt=new Ds(Qe,nt),pt.command=Ji.arc,pt.rx=Pt,pt.ry=et,pt.xAxisRotation=vt,pt.largeArcFlag=kt,pt.sweepFlag=pi,T=pt,l=pt,u=void 0}T&&(Array.isArray(T)?n=n.concat(T):n.push(T))})}e=new $s(n,r,void 0,!0).noStroke(),e.fill="black";const a=e.getBoundingClientRect(!0);return a.centroid={x:a.left+a.width/2,y:a.top+a.height/2},er.each(e.vertices,function(l){l.subSelf(a.centroid)}),nf.call(this,i,e,t),e.translation.addSelf(a.centroid),e},circle:function(i,t){const e=parseFloat(i.getAttribute("cx")),n=parseFloat(i.getAttribute("cy")),r=parseFloat(i.getAttribute("r")),s=new zI(0,0,r).noStroke();return s.fill="black",nf.call(this,i,s,t),s.translation.x=e,s.translation.y=n,s},ellipse:function(i,t){const e=parseFloat(i.getAttribute("cx")),n=parseFloat(i.getAttribute("cy")),r=parseFloat(i.getAttribute("rx")),s=parseFloat(i.getAttribute("ry")),a=new GI(0,0,r,s).noStroke();return a.fill="black",nf.call(this,i,a,t),a.translation.x=e,a.translation.y=n,a},rect:function(i,t){const e=parseFloat(i.getAttribute("rx")),n=parseFloat(i.getAttribute("ry"));if(!er.isNaN(e)||!er.isNaN(n))return Ha["rounded-rect"](i);const r=parseFloat(i.getAttribute("width")),s=parseFloat(i.getAttribute("height")),a=r/2,l=s/2,u=new q0(0,0,r,s).noStroke();return u.fill="black",nf.call(this,i,u,t),u.translation.x+=a,u.translation.y+=l,u},"rounded-rect":function(i,t){const e=parseFloat(i.getAttribute("rx"))||0,n=parseFloat(i.getAttribute("ry"))||0,r=parseFloat(i.getAttribute("width")),s=parseFloat(i.getAttribute("height")),a=r/2,l=s/2,u=new gn(e,n),h=new jI(0,0,r,s,u).noStroke();return h.fill="black",nf.call(this,i,h,t),h.translation.x+=a,h.translation.y+=l,h},line:function(i,t){const e=parseFloat(i.getAttribute("x1")),n=parseFloat(i.getAttribute("y1")),r=parseFloat(i.getAttribute("x2")),s=parseFloat(i.getAttribute("y2")),a=new U4(e,n,r,s).noFill();return nf.call(this,i,a,t),a},lineargradient:function(i,t){let e=i.getAttribute("gradientUnits"),n=i.getAttribute("spreadMethod");e||(e="objectBoundingBox"),n||(n="pad");let r=parseFloat(i.getAttribute("x1")||0),s=parseFloat(i.getAttribute("y1")||0),a=parseFloat(i.getAttribute("x2")||0),l=parseFloat(i.getAttribute("y2")||0);const u=(a+r)/2,h=(l+s)/2;/userSpaceOnUse/i.test(e)&&(r-=u,s-=h,a-=u,l-=h);const m=[];for(let v=0;v<i.children.length;v++){const S=i.children[v];let T=S.getAttribute("offset");/%/gi.test(T)&&(T=parseFloat(T.replace(/%/gi,""))/100),T=parseFloat(T);let E,I=S.getAttribute("stop-color"),j=S.getAttribute("stop-opacity"),P=S.getAttribute("style");null===I&&(E=!!P&&P.match(/stop-color:\s?([#a-fA-F0-9]*)/),I=E&&E.length>1?E[1]:void 0),null===j?(E=!!P&&P.match(/stop-opacity:\s?([0-9.-]*)/),j=E&&E.length>1?parseFloat(E[1]):1):j=parseFloat(j),m.push(new ev(T,I,j))}const _=new Ba(r,s,a,l,m);return _.spread=n,_.units=e,nf.call(this,i,_,t),_},radialgradient:function(i,t){let e=i.getAttribute("gradientUnits"),n=i.getAttribute("spreadMethod");e||(e="objectBoundingBox"),n||(n="pad");let r=parseFloat(i.getAttribute("cx"))||0,s=parseFloat(i.getAttribute("cy"))||0,a=parseFloat(i.getAttribute("r")),l=parseFloat(i.getAttribute("fx")),u=parseFloat(i.getAttribute("fy"));er.isNaN(l)&&(l=r),er.isNaN(u)&&(u=s);const h=Math.abs(r+l)/2,m=Math.abs(s+u)/2;/userSpaceOnUse/i.test(e)&&(r-=h,s-=m,l-=h,u-=m);const _=[];for(let S=0;S<i.children.length;S++){const T=i.children[S];let I=T.getAttribute("offset");/%/gi.test(I)&&(I=parseFloat(I.replace(/%/gi,""))/100),I=parseFloat(I);let ie,j=T.getAttribute("stop-color"),P=T.getAttribute("stop-opacity"),E=T.getAttribute("style");null===j&&(ie=!!E&&E.match(/stop-color:\s?([#a-fA-F0-9]*)/),j=ie&&ie.length>1?ie[1]:void 0),null===P?(ie=!!E&&E.match(/stop-opacity:\s?([0-9.-]*)/),P=ie&&ie.length>1?parseFloat(ie[1]):1):P=parseFloat(P),_.push(new ev(I,j,P))}const v=new Na(r,s,a,_,l,u);return v.spread=n,v.units=e,nf.call(this,i,v,t),v},text:function(i,t){const e=function UEe(i){return VEe[i]}(i.getAttribute("text-anchor"))||"left",n=function GEe(i){const t=i.getAttribute("dominant-baseline"),e=i.getAttribute("alignment-baseline");return t||e}(i)||"baseline",s=new Jf(i.textContent);return nf.call(this,i,s,t),s.alignment=e,s.baseline=n,s},clippath:function(i,t){return Ha.defs.current&&!Ha.defs.current.contains(i.id)&&Ha.defs.current.add(i.id,i),null},image:function(i,t){let e;const n=i.getAttribute("href")||i.getAttribute("xlink:href");if(!n)return e=new Kh("encountered <image /> with no href."),console.warn(e.name,e.message),null;const r=parseFloat(i.getAttribute("x"))||0,s=parseFloat(i.getAttribute("y"))||0,a=parseFloat(i.getAttribute("width")),l=parseFloat(i.getAttribute("height")),u=new HI(n,r,s);return er.isNaN(a)||(u.width=a),er.isNaN(l)||(u.height=l),nf.call(this,i,u,t),u}};function LJ(i,t){const e=new XMLHttpRequest;return e.open("GET",i),e.onreadystatechange=function(){4===e.readyState&&200===e.status&&t(e.responseText)},e.send(),e}var G4=class extends q0{constructor(i,t,e,n){super(t,e,0,0),Ie(this,"_flagTextures",!1),Ie(this,"_flagFrameRate",!1),Ie(this,"_flagIndex",!1),Ie(this,"_amount",1),Ie(this,"_duration",0),Ie(this,"_index",0),Ie(this,"_startTime",0),Ie(this,"_playing",!1),Ie(this,"_firstFrame",0),Ie(this,"_lastFrame",0),Ie(this,"_loop",!0),Ie(this,"_textures",null),Ie(this,"_frameRate",0),Ie(this,"_origin",null);for(let r in OJ)Object.defineProperty(this,r,OJ[r]);this._renderer.flagTextures=KEe.bind(this),this._renderer.bindTextures=QEe.bind(this),this._renderer.unbindTextures=JEe.bind(this),this.noStroke(),this.noFill(),this.textures=Array.isArray(i)?i.map(FJ.bind(this)):[FJ(i)],this.origin=new gn,this._update(),this.frameRate="number"==typeof n?n:G4.DefaultFrameRate,this.index=0}play(i,t,e){return this._playing=!0,this._firstFrame=0,this._lastFrame=this.amount-1,this._startTime=er.performance.now(),"number"==typeof i&&(this._firstFrame=i),"number"==typeof t&&(this._lastFrame=t),"function"==typeof e?this._onLastFrame=e:delete this._onLastFrame,this._index!==this._firstFrame&&(this._startTime-=1e3*Math.abs(this._index-this._firstFrame)/this._frameRate),this}pause(){return this._playing=!1,this}stop(){return this._playing=!1,this._index=this._firstFrame,this}clone(i){const t=new G4(this.textures,this.translation.x,this.translation.y,this.frameRate);return t._loop=this._loop,this._playing&&t.play(),i&&i.add(t),t}toObject(){const i=super.toObject.call(this);return i.textures=this.textures.map(function(t){return t.toObject()}),i.frameRate=this.frameRate,i.index=this.index,i._firstFrame=this._firstFrame,i._lastFrame=this._lastFrame,i._loop=this._loop,i}_update(){const i=this._textures;let t,e,n,r,s,a,l,u;return i&&(this._flagTextures&&(this._amount=i.length),this._flagFrameRate&&(this._duration=1e3*this._amount/this._frameRate),this._playing&&this._frameRate>0?(r=this._amount,er.isNaN(this._lastFrame)&&(this._lastFrame=r-1),n=er.performance.now()-this._startTime,u=this._lastFrame+1,s=1e3*(u-this._firstFrame)/this._frameRate,this._loop?n%=s:n=Math.min(n,s),l=qh(this._firstFrame,u,n/s),l=Math.floor(l),l!==this._index&&(this._index=l,a=i[this._index],a.loaded&&(t=a.image.width,e=a.image.height,this.width!==t&&(this.width=t),this.height!==e&&(this.height=e),this.fill=a,l>=this._lastFrame-1&&this._onLastFrame&&this._onLastFrame()))):(this._flagIndex||!(this.fill instanceof xo))&&(a=i[this._index],a.loaded&&(t=a.image.width,e=a.image.height,this.width!==t&&(this.width=t),this.height!==e&&(this.height=e)),this.fill=a)),super._update.call(this),this}flagReset(){return this._flagTextures=this._flagFrameRate=!1,super.flagReset.call(this),this}},qI=G4;Ie(qI,"Properties",["textures","frameRate","index"]),Ie(qI,"DefaultFrameRate",30);var OJ={frameRate:{enumerable:!0,get:function(){return this._frameRate},set:function(i){this._frameRate=i,this._flagFrameRate=!0}},index:{enumerable:!0,get:function(){return this._index},set:function(i){this._index=i,this._flagIndex=!0}},textures:{enumerable:!0,get:function(){return this._textures},set:function(i){const t=this._renderer.bindTextures,e=this._renderer.unbindTextures;this._textures&&this._textures.unbind(Mi.Types.insert,t).unbind(Mi.Types.remove,e),this._textures=new Jy((i||[]).slice(0)),this._textures.bind(Mi.Types.insert,t).bind(Mi.Types.remove,e),t(this._textures)}}};function KEe(){this._flagTextures=!0}function QEe(i){let t=i.length;for(;t--;)i[t].bind(Mi.Types.change,this._renderer.flagTextures);this._renderer.flagTextures()}function JEe(i){let t=i.length;for(;t--;)i[t].unbind(Mi.Types.change,this._renderer.flagTextures);this._renderer.flagTextures()}function FJ(i){return i instanceof xo?i:"string"==typeof i?new xo(i):void 0}var XI=class extends $s{constructor(i,t,e,n,r,s,a){const l=a||36,u=[];for(let h=0;h<l;h++)u.push(new Ds);super(u,!0,!1,!0),Ie(this,"_flagStartAngle",!1),Ie(this,"_flagEndAngle",!1),Ie(this,"_flagInnerRadius",!1),Ie(this,"_flagOuterRadius",!1),Ie(this,"_startAngle",0),Ie(this,"_endAngle",cu),Ie(this,"_innerRadius",0),Ie(this,"_outerRadius",0);for(let h in BJ)Object.defineProperty(this,h,BJ[h]);"number"==typeof e&&(this.innerRadius=e),"number"==typeof n&&(this.outerRadius=n),"number"==typeof r&&(this.startAngle=r),"number"==typeof s&&(this.endAngle=s),this._update(),"number"==typeof i&&(this.translation.x=i),"number"==typeof t&&(this.translation.y=t)}_update(){if(this._flagVertices||this._flagStartAngle||this._flagEndAngle||this._flagInnerRadius||this._flagOuterRadius){const i=this._startAngle,t=this._endAngle,e=this._innerRadius,n=this._outerRadius,r=Xh(i,cu)===Xh(t,cu),s=e>0,a=this.vertices;let u,m,_,v,S,T,I,j,P,E,l=s?a.length/2:a.length,h=0;for(r?l--:s||(l-=2),m=0,_=l-1;m<l;m++)u=0===(v=m/_,S=a[h],T=v*(t-i)+i,I=(t-i)/l,j=n*Math.cos(T),P=n*Math.sin(T),m)?Ji.move:Ji.curve,S.command=u,S.x=j,S.y=P,S.controls.left.clear(),S.controls.right.clear(),S.command===Ji.curve&&(E=n*I/Math.PI,S.controls.left.x=E*Math.cos(T-_c),S.controls.left.y=E*Math.sin(T-_c),S.controls.right.x=E*Math.cos(T+_c),S.controls.right.y=E*Math.sin(T+_c),1===m&&S.controls.left.multiplyScalar(2),m===_&&S.controls.right.multiplyScalar(2)),h++;if(s){for(r?(a[h].command=Ji.close,h++):(l--,_=l-1),m=0;m<l;m++)v=m/_,S=a[h],T=(1-v)*(t-i)+i,I=(t-i)/l,j=e*Math.cos(T),P=e*Math.sin(T),u=Ji.curve,m<=0&&(u=r?Ji.move:Ji.line),S.command=u,S.x=j,S.y=P,S.controls.left.clear(),S.controls.right.clear(),S.command===Ji.curve&&(E=e*I/Math.PI,S.controls.left.x=E*Math.cos(T+_c),S.controls.left.y=E*Math.sin(T+_c),S.controls.right.x=E*Math.cos(T-_c),S.controls.right.y=E*Math.sin(T-_c),1===m&&S.controls.left.multiplyScalar(2),m===_&&S.controls.right.multiplyScalar(2)),h++;a[h].copy(a[0]),a[h].command=Ji.line}else r||(a[h].command=Ji.line,a[h].x=0,a[h].y=0,h++,a[h].copy(a[0]),a[h].command=Ji.line)}return super._update.call(this),this}flagReset(){return super.flagReset.call(this),this._flagStartAngle=this._flagEndAngle=this._flagInnerRadius=this._flagOuterRadius=!1,this}clone(i){const a=new XI(0,0,this.innerRadius,this.outerRadius,this.startAngle,this.endAngle,this.vertices.length);a.translation.copy(this.translation),a.rotation=this.rotation,a.scale=this.scale,a.skewX=this.skewX,a.skewY=this.skewY,this.matrix.manual&&a.matrix.copy(this.matrix);for(let l=0;l<$s.Properties.length;l++){const u=$s.Properties[l];a[u]=this[u]}return i&&i.add(a),a}toObject(){const i=super.toObject.call(this);for(let t=0;t<XI.Properties.length;t++){const e=XI.Properties[t];i[e]=this[e]}return i}},W4=XI;Ie(W4,"Properties",["startAngle","endAngle","innerRadius","outerRadius"]);var BJ={startAngle:{enumerable:!0,get:function(){return this._startAngle},set:function(i){this._startAngle=i,this._flagStartAngle=!0}},endAngle:{enumerable:!0,get:function(){return this._endAngle},set:function(i){this._endAngle=i,this._flagEndAngle=!0}},innerRadius:{enumerable:!0,get:function(){return this._innerRadius},set:function(i){this._innerRadius=i,this._flagInnerRadius=!0}},outerRadius:{enumerable:!0,get:function(){return this._outerRadius},set:function(i){this._outerRadius=i,this._flagOuterRadius=!0}}},$Ee=Math.ceil,eAe=Math.floor,kE=class extends Qy{constructor(i){super(),Ie(this,"_flagVertices",!0),Ie(this,"_flagLength",!0),Ie(this,"_flagFill",!0),Ie(this,"_flagStroke",!0),Ie(this,"_flagLinewidth",!0),Ie(this,"_flagOpacity",!0),Ie(this,"_flagVisible",!0),Ie(this,"_flagSize",!0),Ie(this,"_flagSizeAttenuation",!0),Ie(this,"_length",0),Ie(this,"_fill","#fff"),Ie(this,"_stroke","#000"),Ie(this,"_linewidth",1),Ie(this,"_opacity",1),Ie(this,"_visible",!0),Ie(this,"_size",1),Ie(this,"_sizeAttenuation",!1),Ie(this,"_beginning",0),Ie(this,"_ending",1),Ie(this,"_dashes",null),Ie(this,"noFill",$s.prototype.noFill),Ie(this,"noStroke",$s.prototype.noStroke),Ie(this,"corner",$s.prototype.corner),Ie(this,"center",$s.prototype.center),Ie(this,"getBoundingClientRect",$s.prototype.getBoundingClientRect),Ie(this,"_updateLength",$s.prototype._updateLength);for(let t in NJ)Object.defineProperty(this,t,NJ[t]);this._renderer.type="points",this._renderer.flagVertices=gJ.bind(this),this._renderer.bindVertices=_J.bind(this),this._renderer.unbindVertices=yJ.bind(this),this._renderer.flagFill=vJ.bind(this),this._renderer.flagStroke=bJ.bind(this),this._renderer.vertices=null,this._renderer.collection=null,this.sizeAttenuation=!1,this.beginning=0,this.ending=1,this.fill="#fff",this.stroke="#000",this.className="",this.visible=!0,this.vertices=i,this.dashes=[],this.dashes.offset=0}clone(i){const t=new kE;for(let e=0;e<this.vertices.length;e++)t.vertices.push(this.vertices[e].clone());for(let e=0;e<kE.Properties.length;e++){const n=kE.Properties[e];t[n]=this[n]}return t.className=this.className,t.translation.copy(this.translation),t.rotation=this.rotation,t.scale=this.scale,t.skewX=this.skewX,t.skewY=this.skewY,this.matrix.manual&&t.matrix.copy(this.matrix),i&&i.add(t),t._update()}toObject(){const i={vertices:this.vertices.map(function(t){return t.toObject()})};return er.each(kE.Properties,function(t){i[t]=this[t]},this),i.className=this.className,i.translation=this.translation.toObject(),i.rotation=this.rotation,i.scale=this.scale instanceof gn?this.scale.toObject():this.scale,i.skewX=this.skewX,i.skewY=this.skewY,this.matrix.manual&&(i.matrix=this.matrix.toObject()),i}subdivide(i){this._update();let t=[];for(let e=0;e<this.vertices.length;e++){const n=this.vertices[e],r=this.vertices[e-1];if(!r)continue;const s=n.x,a=n.y,l=r.x,u=r.y,h=k4(s,a,s,a,l,u,l,u,i);t=t.concat(h)}return this.vertices=t,this}_update(){if(this._flagVertices){this._flagLength&&this._updateLength(void 0,!0);const i=Math.min(this._beginning,this._ending),t=Math.max(this._beginning,this._ending),e=OI(this,i*this._length),n=OI(this,t*this._length),r=$Ee(e),s=eAe(n);let l,a=0;this._renderer.vertices=[],this._renderer.collection=[];for(let u=0;u<this._collection.length;u++)u>=r&&u<=s&&(l=this._collection[u],this._renderer.collection.push(l),this._renderer.vertices[2*a+0]=l.x,this._renderer.vertices[2*a+1]=l.y,a++)}return super._update.apply(this,arguments),this}flagReset(){return this._flagVertices=this._flagLength=this._flagFill=this._flagStroke=this._flagLinewidth=this._flagOpacity=this._flagVisible=this._flagSize=this._flagSizeAttenuation=!1,super.flagReset.call(this),this}},j4=kE;Ie(j4,"Properties",["fill","stroke","linewidth","opacity","visible","size","sizeAttenuation","beginning","ending"]);var NJ={linewidth:{enumerable:!0,get:function(){return this._linewidth},set:function(i){this._linewidth=i,this._flagLinewidth=!0}},opacity:{enumerable:!0,get:function(){return this._opacity},set:function(i){this._opacity=i,this._flagOpacity=!0}},visible:{enumerable:!0,get:function(){return this._visible},set:function(i){this._visible=i,this._flagVisible=!0}},size:{enumerable:!0,get:function(){return this._size},set:function(i){this._size=i,this._flagSize=!0}},sizeAttenuation:{enumerable:!0,get:function(){return this._sizeAttenuation},set:function(i){this._sizeAttenuation=i,this._flagSizeAttenuation=!0}},fill:{enumerable:!0,get:function(){return this._fill},set:function(i){(this._fill instanceof tc||this._fill instanceof Ba||this._fill instanceof Na||this._fill instanceof xo)&&this._fill.unbind(Mi.Types.change,this._renderer.flagFill),this._fill=i,this._flagFill=!0,(this._fill instanceof tc||this._fill instanceof Ba||this._fill instanceof Na||this._fill instanceof xo)&&this._fill.bind(Mi.Types.change,this._renderer.flagFill)}},stroke:{enumerable:!0,get:function(){return this._stroke},set:function(i){(this._stroke instanceof tc||this._stroke instanceof Ba||this._stroke instanceof Na||this._stroke instanceof xo)&&this._stroke.unbind(Mi.Types.change,this._renderer.flagStroke),this._stroke=i,this._flagStroke=!0,(this._stroke instanceof tc||this._stroke instanceof Ba||this._stroke instanceof Na||this._stroke instanceof xo)&&this._stroke.bind(Mi.Types.change,this._renderer.flagStroke)}},length:{get:function(){return this._flagLength&&this._updateLength(),this._length}},beginning:{enumerable:!0,get:function(){return this._beginning},set:function(i){this._beginning=i,this._flagVertices=!0}},ending:{enumerable:!0,get:function(){return this._ending},set:function(i){this._ending=i,this._flagVertices=!0}},vertices:{enumerable:!0,get:function(){return this._collection},set:function(i){const t=this._renderer.bindVertices,e=this._renderer.unbindVertices;this._collection&&this._collection.unbind(Mi.Types.insert,t).unbind(Mi.Types.remove,e),this._collection=i instanceof Jy?i:new Jy(i||[]),this._collection.bind(Mi.Types.insert,t).bind(Mi.Types.remove,e),t(this._collection)}},dashes:{enumerable:!0,get:function(){return this._dashes},set:function(i){"number"!=typeof i.offset&&(i.offset=this.dashes&&this._dashes.offset||0),this._dashes=i}}},tAe=Math.cos,iAe=Math.sin,ZI=class extends $s{constructor(i,t,e,n){n=Math.max(n||0,3),super(),Ie(this,"_flagWidth",!1),Ie(this,"_flagHeight",!1),Ie(this,"_flagSides",!1),Ie(this,"_width",0),Ie(this,"_height",0),Ie(this,"_sides",0);for(let r in HJ)Object.defineProperty(this,r,HJ[r]);this.closed=!0,this.automatic=!1,"number"==typeof e&&(this.width=2*e),"number"==typeof e&&(this.height=2*e),"number"==typeof n&&(this.sides=n),this._update(),"number"==typeof i&&(this.translation.x=i),"number"==typeof t&&(this.translation.y=t)}_update(){if(this._flagVertices||this._flagWidth||this._flagHeight||this._flagSides){const i=this._sides,t=i+1;let e=this.vertices.length;e>i&&(this.vertices.splice(i-1,e-i),e=i);for(let n=0;n<t;n++){const s=cu*((n+.5)/i)+Math.PI/2,a=this._width*tAe(s)/2,l=this._height*iAe(s)/2;n>=e?this.vertices.push(new Ds(a,l)):this.vertices[n].set(a,l),this.vertices[n].command=0===n?Ji.move:Ji.line}}return super._update.call(this),this}flagReset(){return this._flagWidth=this._flagHeight=this._flagSides=!1,super.flagReset.call(this),this}clone(i){const t=new ZI(0,0,this.radius,this.sides);t.translation.copy(this.translation),t.rotation=this.rotation,t.scale=this.scale,t.skewX=this.skewX,t.skewY=this.skewY,this.matrix.manual&&t.matrix.copy(this.matrix);for(let e=0;e<$s.Properties.length;e++){const n=$s.Properties[e];t[n]=this[n]}return i&&i.add(t),t}toObject(){const i=super.toObject.call(this);for(let t=0;t<ZI.Properties.length;t++){const e=ZI.Properties[t];i[e]=this[e]}return i}},q4=ZI;Ie(q4,"Properties",["width","height","sides"]);var HJ={width:{enumerable:!0,get:function(){return this._width},set:function(i){this._width=i,this._flagWidth=!0}},height:{enumerable:!0,get:function(){return this._height},set:function(i){this._height=i,this._flagHeight=!0}},sides:{enumerable:!0,get:function(){return this._sides},set:function(i){this._sides=i,this._flagSides=!0}}},nAe=Math.cos,rAe=Math.sin,YI=class extends $s{constructor(i,t,e,n,r){arguments.length<=3&&(e=(n=e)/2),("number"!=typeof r||r<=0)&&(r=5),super(),Ie(this,"_flagInnerRadius",!1),Ie(this,"_flagOuterRadius",!1),Ie(this,"_flagSides",!1),Ie(this,"_innerRadius",0),Ie(this,"_outerRadius",0),Ie(this,"_sides",0);for(let s in VJ)Object.defineProperty(this,s,VJ[s]);this.closed=!0,this.automatic=!1,"number"==typeof e&&(this.innerRadius=e),"number"==typeof n&&(this.outerRadius=n),"number"==typeof r&&(this.sides=r),this._update(),"number"==typeof i&&(this.translation.x=i),"number"==typeof t&&(this.translation.y=t)}_update(){if(this._flagVertices||this._flagInnerRadius||this._flagOuterRadius||this._flagSides){const i=2*this._sides,t=i+1;let e=this.vertices.length;e>i&&(this.vertices.splice(i-1,e-i),e=i);for(let n=0;n<t;n++){const s=cu*((n+.5)/i),a=(n%2?this._outerRadius:this._innerRadius)/2,l=a*nAe(s),u=a*rAe(s);n>=e?this.vertices.push(new Ds(l,u)):this.vertices[n].set(l,u),this.vertices[n].command=0===n?Ji.move:Ji.line}}return super._update.call(this),this}flagReset(){return this._flagInnerRadius=this._flagOuterRadius=this._flagSides=!1,super.flagReset.call(this),this}clone(i){const r=new YI(0,0,this.innerRadius,this.outerRadius,this.sides);r.translation.copy(this.translation),r.rotation=this.rotation,r.scale=this.scale,r.skewX=this.skewX,r.skewY=this.skewY,this.matrix.manual&&r.matrix.copy(this.matrix);for(let s=0;s<$s.Properties.length;s++){const a=$s.Properties[s];r[a]=this[a]}return i&&i.add(r),r}toObject(){const i=super.toObject.call(this);for(let t=0;t<YI.Properties.length;t++){const e=YI.Properties[t];i[e]=this[e]}return i}},X4=YI;Ie(X4,"Properties",["innerRadius","outerRadius","sides"]);var VJ={innerRadius:{enumerable:!0,get:function(){return this._innerRadius},set:function(i){this._innerRadius=i,this._flagInnerRadius=!0}},outerRadius:{enumerable:!0,get:function(){return this._ourterRadius},set:function(i){this._ourterRadius=i,this._flagOuterRadius=!0}},sides:{enumerable:!0,get:function(){return this._sides},set:function(i){this._sides=i,this._flagSides=!0}}},zJ=new Rg,Kr={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",alignments:{left:"start",center:"middle",right:"end"},createElement:function(i,t){const e=i,n=document.createElementNS(Kr.ns,e);return"svg"===e&&(t=er.defaults(t||{},{version:Kr.version})),t&&Object.keys(t).length>0&&Kr.setAttributes(n,t),n},setAttributes:function(i,t){const e=Object.keys(t);for(let n=0;n<e.length;n++)/href/.test(e[n])?i.setAttributeNS(Kr.xlink,e[n],t[e[n]]):i.setAttribute(e[n],t[e[n]]);return this},removeAttributes:function(i,t){for(let e in t)i.removeAttribute(e);return this},toString:function(i,t){let r,e=i.length,n=e-1,s="";for(let a=0;a<e;a++){const l=i[a],h=i[t?Xh(a-1,e):Math.max(a-1,0)];let m,_,v,S,T,I,j,P,E,ie,ee,ce,ye,Ce,Ge,Qe=hl(l.x),nt=hl(l.y);switch(l.command){case Ji.close:m=Ji.close;break;case Ji.arc:ee=l.rx,ce=l.ry,ye=l.xAxisRotation,Ce=l.largeArcFlag,Ge=l.sweepFlag,m=Ji.arc+" "+ee+" "+ce+" "+ye+" "+Ce+" "+Ge+" "+Qe+" "+nt;break;case Ji.curve:j=h.controls&&h.controls.right||gn.zero,P=l.controls&&l.controls.left||gn.zero,h.relative?(v=hl(j.x+h.x),S=hl(j.y+h.y)):(v=hl(j.x),S=hl(j.y)),l.relative?(T=hl(P.x+l.x),I=hl(P.y+l.y)):(T=hl(P.x),I=hl(P.y)),m=(0===a?Ji.move:Ji.curve)+" "+v+" "+S+" "+T+" "+I+" "+Qe+" "+nt;break;case Ji.move:r=l,m=Ji.move+" "+Qe+" "+nt;break;default:m=l.command+" "+Qe+" "+nt}a>=n&&t&&(l.command===Ji.curve&&(_=r,E=l.controls&&l.controls.right||l,ie=_.controls&&_.controls.left||_,l.relative?(v=hl(E.x+l.x),S=hl(E.y+l.y)):(v=hl(E.x),S=hl(E.y)),_.relative?(T=hl(ie.x+_.x),I=hl(ie.y+_.y)):(T=hl(ie.x),I=hl(ie.y)),Qe=hl(_.x),nt=hl(_.y),m+=" C "+v+" "+S+" "+T+" "+I+" "+Qe+" "+nt),l.command!==Ji.close&&(m+=" Z")),s+=m+" "}return s},pointsToString:function(i,t){let e="";const n=.5*t;for(let r=0;r<i.length;r++)e+=Ji.move+" "+i[r].x+" "+(i[r].y-n)+" ",e+="a "+n+" "+n+" 0 1 0 0.001 0 Z";return e},getClip:function(i,t){let e=i._renderer.clip;return e||(e=i._renderer.clip=Kr.createElement("clipPath",{"clip-rule":"nonzero"}),t.defs.appendChild(e)),e},group:{appendChild:function(i){const t=i._renderer.elem;if(!t)return;const e=t.nodeName;!e||/(radial|linear)gradient/i.test(e)||i._clip||this.elem.appendChild(t)},removeChild:function(i){const t=i._renderer.elem;!t||t.parentNode!=this.elem||!t.nodeName||i._clip||this.elem.removeChild(t)},orderChild:function(i){this.elem.appendChild(i._renderer.elem)},renderChild:function(i){Kr[i._renderer.type].render.call(i,this)},render:function(i){if(!this._visible&&!this._flagVisible||0===this._opacity&&!this._flagOpacity)return this;this._update(),this._renderer.elem||(this._renderer.elem=Kr.createElement("g",{id:this.id}),i.appendChild(this._renderer.elem));const e={domElement:i,elem:this._renderer.elem};(this._matrix.manual||this._flagMatrix)&&this._renderer.elem.setAttribute("transform","matrix("+this._matrix.toString()+")");for(let n=0;n<this.children.length;n++){const r=this.children[n];Kr[r._renderer.type].render.call(r,i)}return this._flagId&&this._renderer.elem.setAttribute("id",this._id),this._flagOpacity&&this._renderer.elem.setAttribute("opacity",this._opacity),this._flagVisible&&this._renderer.elem.setAttribute("display",this._visible?"inline":"none"),this._flagClassName&&this._renderer.elem.setAttribute("class",this.classList.join(" ")),this._flagAdditions&&this.additions.forEach(Kr.group.appendChild,e),this._flagSubtractions&&this.subtractions.forEach(Kr.group.removeChild,e),this._flagOrder&&this.children.forEach(Kr.group.orderChild,e),this._flagMask&&(this._mask?(Kr[this._mask._renderer.type].render.call(this._mask,i),this._renderer.elem.setAttribute("clip-path","url(#"+this._mask.id+")")):this._renderer.elem.removeAttribute("clip-path")),this.dataset&&Object.assign(this._renderer.elem.dataset,this.dataset),this.flagReset()}},path:{render:function(i){if(0===this._opacity&&!this._flagOpacity)return this;this._update();const t={};if((this._matrix.manual||this._flagMatrix)&&(t.transform="matrix("+this._matrix.toString()+")"),this._flagId&&(t.id=this._id),this._flagVertices){const n=Kr.toString(this._renderer.vertices,this._closed);t.d=n}if(this._fill&&this._fill._renderer&&(this._fill._update(),Kr[this._fill._renderer.type].render.call(this._fill,i,!0)),this._flagFill&&(t.fill=this._fill&&this._fill.id?"url(#"+this._fill.id+")":this._fill),this._stroke&&this._stroke._renderer&&(this._stroke._update(),Kr[this._stroke._renderer.type].render.call(this._stroke,i,!0)),this._flagStroke&&(t.stroke=this._stroke&&this._stroke.id?"url(#"+this._stroke.id+")":this._stroke),this._flagLinewidth&&(t["stroke-width"]=this._linewidth),this._flagOpacity&&(t["stroke-opacity"]=this._opacity,t["fill-opacity"]=this._opacity),this._flagClassName&&(t.class=this.classList.join(" ")),this._flagVisible&&(t.visibility=this._visible?"visible":"hidden"),this._flagCap&&(t["stroke-linecap"]=this._cap),this._flagJoin&&(t["stroke-linejoin"]=this._join),this._flagMiter&&(t["stroke-miterlimit"]=this._miter),this.dashes&&this.dashes.length>0&&(t["stroke-dasharray"]=this.dashes.join(" "),t["stroke-dashoffset"]=this.dashes.offset||0),this._renderer.elem?Kr.setAttributes(this._renderer.elem,t):(t.id=this._id,this._renderer.elem=Kr.createElement("path",t),i.appendChild(this._renderer.elem)),this._flagClip){const n=Kr.getClip(this,i),r=this._renderer.elem;this._clip?(r.removeAttribute("id"),n.setAttribute("id",this.id),n.appendChild(r)):(n.removeAttribute("id"),r.setAttribute("id",this.id),this.parent._renderer.elem.appendChild(r))}return this._flagMask&&(this._mask?(Kr[this._mask._renderer.type].render.call(this._mask,i),this._renderer.elem.setAttribute("clip-path","url(#"+this._mask.id+")")):this._renderer.elem.removeAttribute("clip-path")),this.flagReset()}},points:{render:function(i){if(0===this._opacity&&!this._flagOpacity)return this;this._update();const t={};if((this._matrix.manual||this._flagMatrix)&&(t.transform="matrix("+this._matrix.toString()+")"),this._flagId&&(t.id=this._id),this._flagVertices||this._flagSize||this._flagSizeAttenuation){let n=this._size;if(!this._sizeAttenuation){W0(this,zJ);const s=zJ.elements,a=TE(s[0],s[3],s[1],s[4],s[2],s[5]);n/=Math.max(a.scaleX,a.scaleY)}const r=Kr.pointsToString(this._renderer.collection,n);t.d=r}return this._fill&&this._fill._renderer&&(this._fill._update(),Kr[this._fill._renderer.type].render.call(this._fill,i,!0)),this._flagFill&&(t.fill=this._fill&&this._fill.id?"url(#"+this._fill.id+")":this._fill),this._stroke&&this._stroke._renderer&&(this._stroke._update(),Kr[this._stroke._renderer.type].render.call(this._stroke,i,!0)),this._flagStroke&&(t.stroke=this._stroke&&this._stroke.id?"url(#"+this._stroke.id+")":this._stroke),this._flagLinewidth&&(t["stroke-width"]=this._linewidth),this._flagOpacity&&(t["stroke-opacity"]=this._opacity,t["fill-opacity"]=this._opacity),this._flagClassName&&(t.class=this.classList.join(" ")),this._flagVisible&&(t.visibility=this._visible?"visible":"hidden"),this.dashes&&this.dashes.length>0&&(t["stroke-dasharray"]=this.dashes.join(" "),t["stroke-dashoffset"]=this.dashes.offset||0),this._renderer.elem?Kr.setAttributes(this._renderer.elem,t):(t.id=this._id,this._renderer.elem=Kr.createElement("path",t),i.appendChild(this._renderer.elem)),this.flagReset()}},text:{render:function(i){this._update();const t={};if((this._matrix.manual||this._flagMatrix)&&(t.transform="matrix("+this._matrix.toString()+")"),this._flagId&&(t.id=this._id),this._flagFamily&&(t["font-family"]=this._family),this._flagSize&&(t["font-size"]=this._size),this._flagLeading&&(t["line-height"]=this._leading),this._flagAlignment&&(t["text-anchor"]=Kr.alignments[this._alignment]||this._alignment),this._flagBaseline&&(t["alignment-baseline"]=t["dominant-baseline"]=this._baseline),this._flagStyle&&(t["font-style"]=this._style),this._flagWeight&&(t["font-weight"]=this._weight),this._flagDecoration&&(t["text-decoration"]=this._decoration),this._fill&&this._fill._renderer&&(this._fill._update(),Kr[this._fill._renderer.type].render.call(this._fill,i,!0)),this._flagFill&&(t.fill=this._fill&&this._fill.id?"url(#"+this._fill.id+")":this._fill),this._stroke&&this._stroke._renderer&&(this._stroke._update(),Kr[this._stroke._renderer.type].render.call(this._stroke,i,!0)),this._flagStroke&&(t.stroke=this._stroke&&this._stroke.id?"url(#"+this._stroke.id+")":this._stroke),this._flagLinewidth&&(t["stroke-width"]=this._linewidth),this._flagOpacity&&(t.opacity=this._opacity),this._flagClassName&&(t.class=this.classList.join(" ")),this._flagVisible&&(t.visibility=this._visible?"visible":"hidden"),this.dashes&&this.dashes.length>0&&(t["stroke-dasharray"]=this.dashes.join(" "),t["stroke-dashoffset"]=this.dashes.offset||0),this._renderer.elem?Kr.setAttributes(this._renderer.elem,t):(t.id=this._id,this._renderer.elem=Kr.createElement("text",t),i.defs.appendChild(this._renderer.elem)),this._flagClip){const n=Kr.getClip(this,i),r=this._renderer.elem;this._clip?(r.removeAttribute("id"),n.setAttribute("id",this.id),n.appendChild(r)):(n.removeAttribute("id"),r.setAttribute("id",this.id),this.parent._renderer.elem.appendChild(r))}return this._flagMask&&(this._mask?(Kr[this._mask._renderer.type].render.call(this._mask,i),this._renderer.elem.setAttribute("clip-path","url(#"+this._mask.id+")")):this._renderer.elem.removeAttribute("clip-path")),this._flagValue&&(this._renderer.elem.textContent=this._value),this.flagReset()}},"linear-gradient":{render:function(i,t){t||this._update();const e={};if(this._flagId&&(e.id=this._id),this._flagEndPoints&&(e.x1=this.left._x,e.y1=this.left._y,e.x2=this.right._x,e.y2=this.right._y),this._flagSpread&&(e.spreadMethod=this._spread),this._flagUnits&&(e.gradientUnits=this._units),this._renderer.elem?Kr.setAttributes(this._renderer.elem,e):(e.id=this._id,this._renderer.elem=Kr.createElement("linearGradient",e),i.defs.appendChild(this._renderer.elem)),this._flagStops){const n=this._renderer.elem.childNodes.length!==this.stops.length;if(n)for(;this._renderer.elem.lastChild;)this._renderer.elem.removeChild(this._renderer.elem.lastChild);for(let r=0;r<this.stops.length;r++){const s=this.stops[r],a={};s._flagOffset&&(a.offset=100*s._offset+"%"),s._flagColor&&(a["stop-color"]=s._color),s._flagOpacity&&(a["stop-opacity"]=s._opacity),s._renderer.elem?Kr.setAttributes(s._renderer.elem,a):s._renderer.elem=Kr.createElement("stop",a),n&&this._renderer.elem.appendChild(s._renderer.elem),s.flagReset()}}return this.flagReset()}},"radial-gradient":{render:function(i,t){t||this._update();const e={};if(this._flagId&&(e.id=this._id),this._flagCenter&&(e.cx=this.center._x,e.cy=this.center._y),this._flagFocal&&(e.fx=this.focal._x,e.fy=this.focal._y),this._flagRadius&&(e.r=this._radius),this._flagSpread&&(e.spreadMethod=this._spread),this._flagUnits&&(e.gradientUnits=this._units),this._renderer.elem?Kr.setAttributes(this._renderer.elem,e):(e.id=this._id,this._renderer.elem=Kr.createElement("radialGradient",e),i.defs.appendChild(this._renderer.elem)),this._flagStops){const n=this._renderer.elem.childNodes.length!==this.stops.length;if(n)for(;this._renderer.elem.lastChild;)this._renderer.elem.removeChild(this._renderer.elem.lastChild);for(let r=0;r<this.stops.length;r++){const s=this.stops[r],a={};s._flagOffset&&(a.offset=100*s._offset+"%"),s._flagColor&&(a["stop-color"]=s._color),s._flagOpacity&&(a["stop-opacity"]=s._opacity),s._renderer.elem?Kr.setAttributes(s._renderer.elem,a):s._renderer.elem=Kr.createElement("stop",a),n&&this._renderer.elem.appendChild(s._renderer.elem),s.flagReset()}}return this.flagReset()}},texture:{render:function(i,t){t||this._update();const e={},n={x:0,y:0},r=this.image;if(this._flagId&&(e.id=this._id),this._flagLoaded&&this.loaded)switch(r.nodeName.toLowerCase()){case"canvas":n.href=n["xlink:href"]=r.toDataURL("image/png");break;case"img":case"image":n.href=n["xlink:href"]=this.src}return(this._flagOffset||this._flagLoaded||this._flagScale)&&(e.x=this._offset.x,e.y=this._offset.y,r&&(e.x-=r.width/2,e.y-=r.height/2,this._scale instanceof gn?(e.x*=this._scale.x,e.y*=this._scale.y):(e.x*=this._scale,e.y*=this._scale)),e.x>0&&(e.x*=-1),e.y>0&&(e.y*=-1)),(this._flagScale||this._flagLoaded||this._flagRepeat)&&(e.width=0,e.height=0,r)&&("no-repeat"===(n.width=e.width=r.width,n.height=e.height=r.height,this._repeat)&&(e.width+=1,e.height+=1),this._scale instanceof gn?(e.width*=this._scale.x,e.height*=this._scale.y):(e.width*=this._scale,e.height*=this._scale)),(this._flagScale||this._flagLoaded)&&(this._renderer.image?Kr.setAttributes(this._renderer.image,n):this._renderer.image=Kr.createElement("image",n)),this._renderer.elem?0!==Object.keys(e).length&&Kr.setAttributes(this._renderer.elem,e):(e.id=this._id,e.patternUnits="userSpaceOnUse",this._renderer.elem=Kr.createElement("pattern",e),i.defs.appendChild(this._renderer.elem)),this._renderer.elem&&this._renderer.image&&!this._renderer.appended&&(this._renderer.elem.appendChild(this._renderer.image),this._renderer.appended=!0),this.flagReset()}}},UJ=class extends Mi{constructor(i){super(),this.domElement=i.domElement||Kr.createElement("svg"),this.scene=new ec,this.scene.parent=this,this.defs=Kr.createElement("defs"),this.domElement.appendChild(this.defs),this.domElement.defs=this.defs,this.domElement.style.overflow="hidden"}setSize(i,t){return this.width=i,this.height=t,Kr.setAttributes(this.domElement,{width:i,height:t}),this.trigger(Mi.Types.resize,i,t)}render(){return Kr.group.render.call(this.scene,this.domElement),this}};Ie(UJ,"Utils",Kr);var rf_create=function(i,t,e){const n=i.createShader(i[e]);if(i.shaderSource(n,t),i.compileShader(n),!i.getShaderParameter(n,i.COMPILE_STATUS)){const s=i.getShaderInfoLog(n);throw i.deleteShader(n),new Kh("unable to compile shader "+n+": "+s)}return n},rf_types={vertex:"VERTEX_SHADER",fragment:"FRAGMENT_SHADER"},rf_path={vertex:"\n      precision mediump float;\n      attribute vec2 a_position;\n\n      uniform mat3 u_matrix;\n      uniform vec2 u_resolution;\n      uniform vec4 u_rect;\n\n      varying vec2 v_textureCoords;\n\n      void main() {\n        vec2 rectCoords = (a_position * (u_rect.zw - u_rect.xy)) + u_rect.xy;\n        vec2 projected = (u_matrix * vec3(rectCoords, 1.0)).xy;\n        vec2 normal = projected / u_resolution;\n        vec2 clipspace = (normal * 2.0) - 1.0;\n\n        gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);\n        v_textureCoords = a_position;\n      }\n    ",fragment:"\n      precision mediump float;\n\n      uniform sampler2D u_image;\n      varying vec2 v_textureCoords;\n\n      void main() {\n        vec4 texel = texture2D(u_image, v_textureCoords);\n        if (texel.a == 0.0) {\n          discard;\n        }\n        gl_FragColor = texel;\n      }\n    "},rf_points={vertex:"\n      precision mediump float;\n      attribute vec2 a_position;\n\n      uniform float u_size;\n      uniform mat3 u_matrix;\n      uniform vec2 u_resolution;\n\n      varying vec2 v_textureCoords;\n\n      void main() {\n        vec2 projected = (u_matrix * vec3(a_position, 1.0)).xy;\n        vec2 normal = projected / u_resolution;\n        vec2 clipspace = (normal * 2.0) - 1.0;\n\n        gl_PointSize = u_size;\n        gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);\n        v_textureCoords = a_position;\n      }\n    ",fragment:"\n      precision mediump float;\n\n      uniform sampler2D u_image;\n\n      void main() {\n        vec4 texel = texture2D(u_image, gl_PointCoord);\n        if (texel.a == 0.0) {\n          discard;\n        }\n        gl_FragColor = texel;\n      }\n    "},KI=Rg.Multiply,sAe=[1,0,0,0,1,0,0,0,1],nv=new Wp(9),oAe=AE.Utils,Z4=new Wp([0,0,1,0,0,1,0,1,1,0,1,1]),as={precision:.9,isHidden:/(undefined|none|transparent)/i,canvas:ul.document?ul.document.createElement("canvas"):{getContext:function(){}},alignments:{left:"start",middle:"center",right:"end"},matrix:new Rg,group:{removeChild:function(i,t){if(i.children)for(let e=0;e<i.children.length;e++)as.group.removeChild(i.children[e],t);i._renderer.texture&&(t.deleteTexture(i._renderer.texture),delete i._renderer.texture),i._renderer.positionBuffer&&(t.deleteBuffer(i._renderer.positionBuffer),delete i._renderer.positionBuffer)},render:function(i,t){if(!this._visible)return;this._update();const e=this.parent,n=e._matrix&&e._matrix.manual||e._flagMatrix;let s;if((n||this._matrix.manual||this._flagMatrix)&&(this._renderer.matrix||(this._renderer.matrix=new Wp(9)),this._matrix.toTransformArray(!0,nv),KI(nv,e._renderer.matrix,this._renderer.matrix),this._renderer.scale instanceof gn||(this._renderer.scale=new gn),this._scale instanceof gn?(this._renderer.scale.x=this._scale.x,this._renderer.scale.y=this._scale.y):(this._renderer.scale.x=this._scale,this._renderer.scale.y=this._scale),/renderer/i.test(e._renderer.type)||(this._renderer.scale.x*=e._renderer.scale.x,this._renderer.scale.y*=e._renderer.scale.y),n&&(this._flagMatrix=!0)),this._mask&&(i.clear(i.STENCIL_BUFFER_BIT),i.enable(i.STENCIL_TEST),i.stencilFunc(i.ALWAYS,1,0),i.stencilOp(i.KEEP,i.KEEP,i.REPLACE),i.colorMask(!1,!1,!1,!1),as[this._mask._renderer.type].render.call(this._mask,i,t,this),i.stencilFunc(i.EQUAL,1,255),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),i.colorMask(!0,!0,!0,!0)),this._flagOpacity=e._flagOpacity||this._flagOpacity,this._renderer.opacity=this._opacity*(e&&e._renderer?e._renderer.opacity:1),this._flagSubtractions)for(s=0;s<this.subtractions.length;s++)as.group.removeChild(this.subtractions[s],i);for(s=0;s<this.children.length;s++){const a=this.children[s];as[a._renderer.type].render.call(a,i,t)}return this._mask&&i.disable(i.STENCIL_TEST),this.flagReset()}},path:{updateCanvas:function(i){let t,e,n,r,s,a,l,u,h,m,_,v,S,T;const I=i._renderer.vertices,j=this.canvas,P=this.ctx,E=i._renderer.scale,ie=i._stroke,ee=i._linewidth,ce=i._fill,ye=i._renderer.opacity||i._opacity,Ce=i._cap,Ge=i._join,Qe=i._miter,nt=i._closed,ge=i.dashes,Je=I.length,mt=Je-1;j.width=Math.max(Math.ceil(i._renderer.rect.width*E.x),1),j.height=Math.max(Math.ceil(i._renderer.rect.height*E.y),1);const pt=i._renderer.rect.centroid,Pt=pt.x,et=pt.y;let vt,kt,pi,Ht,ct,mi,Zi,zi;P.clearRect(0,0,j.width,j.height),ce&&("string"==typeof ce?P.fillStyle=ce:(as[ce._renderer.type].render.call(ce,P,i),P.fillStyle=ce._renderer.effect)),ie&&("string"==typeof ie?P.strokeStyle=ie:(as[ie._renderer.type].render.call(ie,P,i),P.strokeStyle=ie._renderer.effect),ee&&(P.lineWidth=ee),Qe&&(P.miterLimit=Qe),Ge&&(P.lineJoin=Ge),!nt&&Ce&&(P.lineCap=Ce)),"number"==typeof ye&&(P.globalAlpha=ye),ge&&ge.length>0&&(P.lineDashOffset=ge.offset||0,P.setLineDash(ge)),P.save(),P.scale(E.x,E.y),P.translate(Pt,et),P.beginPath();for(let Zt=0;Zt<I.length;Zt++){const tr=I[Zt];switch(v=tr.x,S=tr.y,tr.command){case Ji.close:P.closePath();break;case Ji.arc:kt=tr.rx,pi=tr.ry,Ht=tr.xAxisRotation,ct=tr.largeArcFlag,mi=tr.sweepFlag,t=nt?Xh(Zt-1,Je):Math.max(Zt-1,0),e=I[t],Zi=e.x,zi=e.y,oAe.renderSvgArcCommand(P,Zi,zi,kt,pi,ct,mi,Ht,v,S);break;case Ji.curve:t=nt?Xh(Zt-1,Je):Math.max(Zt-1,0),e=I[t],u=e.controls&&e.controls.right||gn.zero,h=tr.controls&&tr.controls.left||gn.zero,e._relative?(a=u.x+e.x,l=u.y+e.y):(a=u.x,l=u.y),tr._relative?(r=h.x+tr.x,s=h.y+tr.y):(r=h.x,s=h.y),P.bezierCurveTo(a,l,r,s,v,S),Zt>=mt&&nt&&(n=vt,m=tr.controls&&tr.controls.right||gn.zero,_=n.controls&&n.controls.left||gn.zero,tr._relative?(a=m.x+tr.x,l=m.y+tr.y):(a=m.x,l=m.y),n._relative?(r=_.x+n.x,s=_.y+n.y):(r=_.x,s=_.y),v=n.x,S=n.y,P.bezierCurveTo(a,l,r,s,v,S));break;case Ji.line:P.lineTo(v,S);break;case Ji.move:vt=tr,P.moveTo(v,S)}}nt&&P.closePath(),as.isHidden.test(ce)||(T=ce._renderer&&ce._renderer.offset,T&&(P.save(),P.translate(-ce._renderer.offset.x,-ce._renderer.offset.y),P.scale(ce._renderer.scale.x,ce._renderer.scale.y)),P.fill(),T&&P.restore()),as.isHidden.test(ie)||(T=ie._renderer&&ie._renderer.offset,T&&(P.save(),P.translate(-ie._renderer.offset.x,-ie._renderer.offset.y),P.scale(ie._renderer.scale.x,ie._renderer.scale.y),P.lineWidth=ee/ie._renderer.scale.x),P.stroke(),T&&P.restore()),P.restore()},getBoundingClientRect:function(i,t,e){let l,u,n=1/0,r=-1/0,s=1/0,a=-1/0;i.forEach(function(h){const m=h.x,_=h.y,v=h.controls;let S,T,I,j,P,E;s=Math.min(_,s),n=Math.min(m,n),r=Math.max(m,r),a=Math.max(_,a),h.controls&&(P=v.left,E=v.right,P&&E&&(S=h._relative?P.x+m:P.x,T=h._relative?P.y+_:P.y,I=h._relative?E.x+m:E.x,j=h._relative?E.y+_:E.y,S&&T&&I&&j&&(s=Math.min(T,j,s),n=Math.min(S,I,n),r=Math.max(S,I,r),a=Math.max(T,j,a))))}),"number"==typeof t&&(s-=t,n-=t,r+=t,a+=t),l=r-n,u=a-s,e.top=s,e.left=n,e.right=r,e.bottom=a,e.width=l,e.height=u,e.centroid||(e.centroid={}),e.centroid.x=-n,e.centroid.y=-s},render:function(i,t,e){if(!this._visible||!this._opacity)return this;this._update();const n=e||this.parent,r=t[this._renderer.type],l=this._renderer.parent!==n,u=this._flagVertices||this._flagFill||this._fill instanceof Ba&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagEndPoints)||this._fill instanceof Na&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagRadius||this._fill._flagCenter||this._fill._flagFocal)||this._fill instanceof xo&&(this._fill._flagLoaded&&this._fill.loaded||this._fill._flagImage||this._fill._flagVideo||this._fill._flagRepeat||this._fill._flagOffset||this._fill._flagScale)||this._stroke instanceof Ba&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagEndPoints)||this._stroke instanceof Na&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagRadius||this._stroke._flagCenter||this._stroke._flagFocal)||this._stroke instanceof xo&&(this._stroke._flagLoaded&&this._stroke.loaded||this._stroke._flagImage||this._stroke._flagVideo||this._stroke._flagRepeat||this._stroke._flagOffset||this._fill._flagScale)||this._flagStroke||this._flagLinewidth||this._flagOpacity||n._flagOpacity||this._flagVisible||this._flagCap||this._flagJoin||this._flagMiter||this._flagScale||this.dashes&&this.dashes.length>0||!this._renderer.texture;if((n._matrix.manual||n._flagMatrix||this._matrix.manual||this._flagMatrix||l)&&(this._renderer.matrix||(this._renderer.matrix=new Wp(9)),this._matrix.toTransformArray(!0,nv),KI(nv,n._renderer.matrix,this._renderer.matrix),this._renderer.scale instanceof gn||(this._renderer.scale=new gn),this._scale instanceof gn?(this._renderer.scale.x=this._scale.x*n._renderer.scale.x,this._renderer.scale.y=this._scale.y*n._renderer.scale.y):(this._renderer.scale.x=this._scale*n._renderer.scale.x,this._renderer.scale.y=this._scale*n._renderer.scale.y),l&&(this._renderer.parent=n)),this._mask&&(i.clear(i.STENCIL_BUFFER_BIT),i.enable(i.STENCIL_TEST),i.stencilFunc(i.ALWAYS,1,0),i.stencilOp(i.KEEP,i.KEEP,i.REPLACE),i.colorMask(!1,!1,!1,!1),as[this._mask._renderer.type].render.call(this._mask,i,t,this),i.stencilFunc(i.EQUAL,1,255),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),i.colorMask(!0,!0,!0,!0)),u?(this._renderer.rect||(this._renderer.rect={}),this._renderer.opacity=this._opacity*n._renderer.opacity,as.path.getBoundingClientRect(this._renderer.vertices,this._linewidth,this._renderer.rect),as.updateTexture.call(as,i,this)):(this._fill&&this._fill._update&&this._fill._update(),this._stroke&&this._stroke._update&&this._stroke._update()),this._clip&&!e||!this._renderer.texture)return this;t.current!==r&&(i.useProgram(r),i.bindBuffer(i.ARRAY_BUFFER,t.buffers.position),i.vertexAttribPointer(r.position,2,i.FLOAT,!1,0,0),i.enableVertexAttribArray(r.position),i.bufferData(i.ARRAY_BUFFER,Z4,i.STATIC_DRAW),t.resolution.flagged||i.uniform2f(i.getUniformLocation(r,"u_resolution"),t.resolution.width,t.resolution.height),t.current=r),t.resolution.flagged&&i.uniform2f(i.getUniformLocation(r,"u_resolution"),t.resolution.width,t.resolution.height),i.bindTexture(i.TEXTURE_2D,this._renderer.texture);const h=this._renderer.rect;return i.uniformMatrix3fv(r.matrix,!1,this._renderer.matrix),i.uniform4f(r.rect,h.left,h.top,h.right,h.bottom),i.drawArrays(i.TRIANGLES,0,6),this._mask&&i.disable(i.STENCIL_TEST),this.flagReset()}},points:{updateCanvas:function(i){let t;const e=this.canvas,n=this.ctx,r=i._stroke,s=i._linewidth,a=i._fill,l=i._renderer.opacity||i._opacity,u=i.dashes,h=i._size;let m=h;as.isHidden.test(r)||(m+=s),e.width=VQ(m),e.height=e.width;const _=m/e.width,v=e.width/2,S=e.height/2;n.clearRect(0,0,e.width,e.height),a&&("string"==typeof a?n.fillStyle=a:(as[a._renderer.type].render.call(a,n,i),n.fillStyle=a._renderer.effect)),r&&("string"==typeof r?n.strokeStyle=r:(as[r._renderer.type].render.call(r,n,i),n.strokeStyle=r._renderer.effect),s&&(n.lineWidth=s/_)),"number"==typeof l&&(n.globalAlpha=l),u&&u.length>0&&(n.lineDashOffset=u.offset||0,n.setLineDash(u)),n.save(),n.translate(v,S),n.scale(as.precision,as.precision),n.beginPath(),n.arc(0,0,h/_*.5,0,cu),n.restore(),closed&&n.closePath(),as.isHidden.test(a)||(t=a._renderer&&a._renderer.offset,t&&(n.save(),n.translate(-a._renderer.offset.x,-a._renderer.offset.y),n.scale(a._renderer.scale.x,a._renderer.scale.y)),n.fill(),t&&n.restore()),as.isHidden.test(r)||(t=r._renderer&&r._renderer.offset,t&&(n.save(),n.translate(-r._renderer.offset.x,-r._renderer.offset.y),n.scale(r._renderer.scale.x,r._renderer.scale.y),n.lineWidth=s/r._renderer.scale.x),n.stroke(),t&&n.restore())},render:function(i,t,e){if(!this._visible||!this._opacity)return this;this._update();let n=this._size;const r=e||this.parent,s=t[this._renderer.type],a=this._sizeAttenuation,l=this._stroke,u=this._linewidth,_=this._renderer.parent!==r,v=this._renderer.vertices,S=this._renderer.collection.length,T=this._flagVertices,I=this._flagFill||this._fill instanceof Ba&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagEndPoints)||this._fill instanceof Na&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagRadius||this._fill._flagCenter||this._fill._flagFocal)||this._fill instanceof xo&&(this._fill._flagLoaded&&this._fill.loaded||this._fill._flagImage||this._fill._flagVideo||this._fill._flagRepeat||this._fill._flagOffset||this._fill._flagScale)||this._stroke instanceof Ba&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagEndPoints)||this._stroke instanceof Na&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagRadius||this._stroke._flagCenter||this._stroke._flagFocal)||this._stroke instanceof xo&&(this._stroke._flagLoaded&&this._stroke.loaded||this._stroke._flagImage||this._stroke._flagVideo||this._stroke._flagRepeat||this._stroke._flagOffset||this._fill._flagScale)||this._flagStroke||this._flagLinewidth||this._flagOpacity||r._flagOpacity||this._flagVisible||this._flagScale||this.dashes&&this.dashes.length>0||!this._renderer.texture;if((r._matrix.manual||r._flagMatrix||this._matrix.manual||this._flagMatrix||_)&&(this._renderer.matrix||(this._renderer.matrix=new Wp(9)),this._matrix.toTransformArray(!0,nv),KI(nv,r._renderer.matrix,this._renderer.matrix),this._renderer.scale instanceof gn||(this._renderer.scale=new gn),this._scale instanceof gn?(this._renderer.scale.x=this._scale.x*r._renderer.scale.x,this._renderer.scale.y=this._scale.y*r._renderer.scale.y):(this._renderer.scale.x=this._scale*r._renderer.scale.x,this._renderer.scale.y=this._scale*r._renderer.scale.y),_&&(this._renderer.parent=r)),T){const j=this._renderer.positionBuffer;j&&i.deleteBuffer(j),this._renderer.positionBuffer=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,this._renderer.positionBuffer),i.vertexAttribPointer(s.position,2,i.FLOAT,!1,0,0),i.enableVertexAttribArray(s.position),i.bufferData(i.ARRAY_BUFFER,v,i.STATIC_DRAW)}return I?(this._renderer.opacity=this._opacity*r._renderer.opacity,as.updateTexture.call(as,i,this)):(this._fill&&this._fill._update&&this._fill._update(),this._stroke&&this._stroke._update&&this._stroke._update()),this._clip&&!e||!this._renderer.texture?this:(as.isHidden.test(l)||(n+=u),n/=as.precision,a&&(n*=Math.max(this._renderer.scale.x,this._renderer.scale.y)),t.current!==s&&(i.useProgram(s),t.resolution.flagged||i.uniform2f(i.getUniformLocation(s,"u_resolution"),t.resolution.width,t.resolution.height),t.current=s),t.resolution.flagged&&i.uniform2f(i.getUniformLocation(s,"u_resolution"),t.resolution.width,t.resolution.height),i.bindTexture(i.TEXTURE_2D,this._renderer.texture),i.uniformMatrix3fv(s.matrix,!1,this._renderer.matrix),i.uniform1f(s.size,n*t.resolution.ratio),i.drawArrays(i.POINTS,0,S),this.flagReset())}},text:{updateCanvas:function(i){const t=this.canvas,e=this.ctx,n=i._renderer.scale,r=i._stroke,s=i._linewidth*n,a=i._fill,l=i._renderer.opacity||i._opacity,u=i.dashes,h=i._decoration;t.width=Math.max(Math.ceil(i._renderer.rect.width*n.x),1),t.height=Math.max(Math.ceil(i._renderer.rect.height*n.y),1);const m=i._renderer.rect.centroid,_=m.x,v=m.y;let S,T,I,j,P,E,ie,ee,ce,ye,Ce;const Ge=a._renderer&&a._renderer.offset&&r._renderer&&r._renderer.offset;if(e.clearRect(0,0,t.width,t.height),Ge||(e.font=[i._style,i._weight,i._size+"px/"+i._leading+"px",i._family].join(" ")),e.textAlign="center",e.textBaseline="middle",a&&("string"==typeof a?e.fillStyle=a:(as[a._renderer.type].render.call(a,e,i),e.fillStyle=a._renderer.effect)),r&&("string"==typeof r?e.strokeStyle=r:(as[r._renderer.type].render.call(r,e,i),e.strokeStyle=r._renderer.effect),s&&(e.lineWidth=s)),"number"==typeof l&&(e.globalAlpha=l),u&&u.length>0&&(e.lineDashOffset=u.offset||0,e.setLineDash(u)),e.save(),e.scale(n.x,n.y),e.translate(_,v),as.isHidden.test(a)||(a._renderer&&a._renderer.offset?(E=a._renderer.scale.x,ie=a._renderer.scale.y,e.save(),e.translate(-a._renderer.offset.x,-a._renderer.offset.y),e.scale(E,ie),S=i._size/a._renderer.scale.y,T=i._leading/a._renderer.scale.y,e.font=[i._style,i._weight,S+"px/",T+"px",i._family].join(" "),I=a._renderer.offset.x/a._renderer.scale.x,j=a._renderer.offset.y/a._renderer.scale.y,e.fillText(i.value,I,j),e.restore()):e.fillText(i.value,0,0)),as.isHidden.test(r)||(r._renderer&&r._renderer.offset?(E=r._renderer.scale.x,ie=r._renderer.scale.y,e.save(),e.translate(-r._renderer.offset.x,-r._renderer.offset.y),e.scale(E,ie),S=i._size/r._renderer.scale.y,T=i._leading/r._renderer.scale.y,e.font=[i._style,i._weight,S+"px/",T+"px",i._family].join(" "),I=r._renderer.offset.x/r._renderer.scale.x,j=r._renderer.offset.y/r._renderer.scale.y,P=s/r._renderer.scale.x,e.lineWidth=P,e.strokeText(i.value,I,j),e.restore()):e.strokeText(i.value,0,0)),/(underline|strikethrough)/i.test(h)){const Qe=e.measureText(i.value);switch(h){case"underline":ce=Qe.actualBoundingBoxAscent,Ce=Qe.actualBoundingBoxAscent;break;case"strikethrough":ce=0,Ce=0}ee=-Qe.width/2,ye=Qe.width/2,e.lineWidth=Math.max(Math.floor(i._size/15),1),e.strokeStyle=e.fillStyle,e.beginPath(),e.moveTo(ee,ce),e.lineTo(ye,Ce),e.stroke()}e.restore()},getBoundingClientRect:function(i,t){const e=as.ctx;e.font=[i._style,i._weight,i._size+"px/"+i._leading+"px",i._family].join(" "),e.textAlign="center",e.textBaseline=i._baseline;let n=1.25*e.measureText(i._value).width,r=1.25*Math.max(i._size,i._leading);this._linewidth&&!as.isHidden.test(this._stroke)&&(n+=2*this._linewidth,r+=2*this._linewidth);const s=n/2,a=r/2;switch(as.alignments[i._alignment]||i._alignment){case as.alignments.left:t.left=0,t.right=n;break;case as.alignments.right:t.left=-n,t.right=0;break;default:t.left=-s,t.right=s}switch(i._baseline){case"bottom":t.top=-r,t.bottom=0;break;case"top":t.top=0,t.bottom=r;break;default:t.top=-a,t.bottom=a}t.width=n,t.height=r,t.centroid||(t.centroid={}),t.centroid.x=s,t.centroid.y=a},render:function(i,t,e){if(!this._visible||!this._opacity)return this;this._update();const n=e||this.parent,r=t[this._renderer.type],l=this._renderer.parent!==n,u=this._flagVertices||this._flagFill||this._fill instanceof Ba&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagEndPoints)||this._fill instanceof Na&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagRadius||this._fill._flagCenter||this._fill._flagFocal)||this._fill instanceof xo&&(this._fill._flagLoaded&&this._fill.loaded||this._fill._flagImage||this._fill._flagVideo||this._fill._flagRepeat||this._fill._flagOffset||this._fill._flagScale)||this._stroke instanceof Ba&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagEndPoints)||this._stroke instanceof Na&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagRadius||this._stroke._flagCenter||this._stroke._flagFocal)||this._stroke instanceof xo&&(this._stroke._flagLoaded&&this._stroke.loaded||this._stroke._flagImage||this._stroke._flagVideo||this._stroke._flagRepeat||this._stroke._flagOffset||this._fill._flagScale)||this._flagStroke||this._flagLinewidth||this._flagOpacity||n._flagOpacity||this._flagVisible||this._flagScale||this._flagValue||this._flagFamily||this._flagSize||this._flagLeading||this._flagAlignment||this._flagBaseline||this._flagStyle||this._flagWeight||this._flagDecoration||this.dashes&&this.dashes.length>0||!this._renderer.texture;if((n._matrix.manual||n._flagMatrix||this._matrix.manual||this._flagMatrix||l)&&(this._renderer.matrix||(this._renderer.matrix=new Wp(9)),this._matrix.toTransformArray(!0,nv),KI(nv,n._renderer.matrix,this._renderer.matrix),this._renderer.scale instanceof gn||(this._renderer.scale=new gn),this._scale instanceof gn?(this._renderer.scale.x=this._scale.x*n._renderer.scale.x,this._renderer.scale.y=this._scale.y*n._renderer.scale.y):(this._renderer.scale.x=this._scale*n._renderer.scale.x,this._renderer.scale.y=this._scale*n._renderer.scale.y),l&&(this._renderer.parent=n)),this._mask&&(i.clear(i.STENCIL_BUFFER_BIT),i.enable(i.STENCIL_TEST),i.stencilFunc(i.ALWAYS,1,0),i.stencilOp(i.KEEP,i.KEEP,i.REPLACE),i.colorMask(!1,!1,!1,!1),as[this._mask._renderer.type].render.call(this._mask,i,t,this),i.stencilFunc(i.EQUAL,1,255),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),i.colorMask(!0,!0,!0,!0)),u?(this._renderer.rect||(this._renderer.rect={}),this._renderer.opacity=this._opacity*n._renderer.opacity,as.text.getBoundingClientRect(this,this._renderer.rect),as.updateTexture.call(as,i,this)):(this._fill&&this._fill._update&&this._fill._update(),this._stroke&&this._stroke._update&&this._stroke._update()),this._clip&&!e||!this._renderer.texture)return this;t.current!==r&&(i.useProgram(r),i.bindBuffer(i.ARRAY_BUFFER,t.buffers.position),i.vertexAttribPointer(r.position,2,i.FLOAT,!1,0,0),i.enableVertexAttribArray(r.position),i.bufferData(i.ARRAY_BUFFER,Z4,i.STATIC_DRAW),t.resolution.flagged||i.uniform2f(i.getUniformLocation(r,"u_resolution"),t.resolution.width,t.resolution.height),t.current=r),t.resolution.flagged&&i.uniform2f(i.getUniformLocation(r,"u_resolution"),t.resolution.width,t.resolution.height),i.bindTexture(i.TEXTURE_2D,this._renderer.texture);const h=this._renderer.rect;return i.uniformMatrix3fv(r.matrix,!1,this._renderer.matrix),i.uniform4f(r.rect,h.left,h.top,h.right,h.bottom),i.drawArrays(i.TRIANGLES,0,6),this._mask&&i.disable(i.STENCIL_TEST),this.flagReset()}},"linear-gradient":{render:function(i,t){if(i.canvas.getContext("2d")&&t){if(this._update(),!this._renderer.effect||this._flagEndPoints||this._flagStops||this._flagUnits){let e,n=this.left._x,r=this.left._y,s=this.right._x,a=this.right._y;/objectBoundingBox/i.test(this._units)&&(e=t.getBoundingClientRect(!0),n=(n-.5)*e.width,r=(r-.5)*e.height,s=(s-.5)*e.width,a=(a-.5)*e.height),this._renderer.effect=i.createLinearGradient(n,r,s,a);for(let l=0;l<this.stops.length;l++){const u=this.stops[l];this._renderer.effect.addColorStop(u._offset,u._color)}}return this.flagReset()}}},"radial-gradient":{render:function(i,t){if(i.canvas.getContext("2d")&&t){if(this._update(),!this._renderer.effect||this._flagCenter||this._flagFocal||this._flagRadius||this._flagStops||this._flagUnits){let e,n=this.center._x,r=this.center._y,s=this.focal._x,a=this.focal._y,l=this._radius;/objectBoundingBox/i.test(this._units)&&(e=t.getBoundingClientRect(!0),n=n*e.width*.5,r=r*e.height*.5,s=s*e.width*.5,a=a*e.height*.5,l*=.5*Math.min(e.width,e.height)),this._renderer.effect=i.createRadialGradient(n,r,0,s,a,l);for(let u=0;u<this.stops.length;u++){const h=this.stops[u];this._renderer.effect.addColorStop(h._offset,h._color)}}return this.flagReset()}}},texture:{render:function(i,t){if(!i.canvas.getContext("2d"))return;this._update();const e=this.image;if((this._flagLoaded||this._flagImage||this._flagVideo||this._flagRepeat)&&this.loaded)this._renderer.effect=i.createPattern(e,this._repeat);else if(!this._renderer.effect)return this.flagReset();return(this._flagOffset||this._flagLoaded||this._flagScale)&&(this._renderer.offset instanceof gn||(this._renderer.offset=new gn),this._renderer.offset.x=-this._offset.x,this._renderer.offset.y=-this._offset.y,e&&(this._renderer.offset.x+=e.width/2,this._renderer.offset.y+=e.height/2,this._scale instanceof gn?(this._renderer.offset.x*=this._scale.x,this._renderer.offset.y*=this._scale.y):(this._renderer.offset.x*=this._scale,this._renderer.offset.y*=this._scale))),(this._flagScale||this._flagLoaded)&&(this._renderer.scale instanceof gn||(this._renderer.scale=new gn),this._scale instanceof gn?this._renderer.scale.copy(this._scale):this._renderer.scale.set(this._scale,this._scale)),this.flagReset()}},updateTexture:function(i,t){if(this[t._renderer.type].updateCanvas.call(as,t),this.canvas.width<=0||this.canvas.height<=0)return t._renderer.texture&&i.deleteTexture(t._renderer.texture),void delete t._renderer.texture;t._renderer.texture||(t._renderer.texture=i.createTexture()),i.bindTexture(i.TEXTURE_2D,t._renderer.texture),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,this.canvas)},program:{create:function(i,t){let e,n,r;if(e=i.createProgram(),er.each(t,function(s){i.attachShader(e,s)}),i.linkProgram(e),n=i.getProgramParameter(e,i.LINK_STATUS),!n)throw r=i.getProgramInfoLog(e),i.deleteProgram(e),new Kh("unable to link program: "+r);return e}},TextureRegistry:new LI};as.ctx=as.canvas.getContext("2d");var GJ=class extends Mi{constructor(i){let t,e,n,r;if(super(),this.domElement=i.domElement||document.createElement("canvas"),void 0!==i.offscreenElement&&(as.canvas=i.offscreenElement,as.ctx=as.canvas.getContext("2d")),this.scene=new ec,this.scene.parent=this,this._renderer={type:"renderer",matrix:new Wp(sAe),scale:1,opacity:1},this._flagMatrix=!0,i=er.defaults(i||{},{antialias:!1,alpha:!0,premultipliedAlpha:!0,stencil:!0,preserveDrawingBuffer:!0,overdraw:!1}),this.overdraw=i.overdraw,t=this.ctx=this.domElement.getContext("webgl",i)||this.domElement.getContext("experimental-webgl",i),!this.ctx)throw new Kh("unable to create a webgl context. Try using another renderer.");n=rf_create(t,rf_path.vertex,rf_types.vertex),r=rf_create(t,rf_path.fragment,rf_types.fragment),this.programs={current:null,buffers:{position:t.createBuffer()},resolution:{width:0,height:0,ratio:1,flagged:!1}},e=this.programs.path=as.program.create(t,[n,r]),this.programs.text=this.programs.path,e.position=t.getAttribLocation(e,"a_position"),e.matrix=t.getUniformLocation(e,"u_matrix"),e.rect=t.getUniformLocation(e,"u_rect");const s=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,s),t.vertexAttribPointer(e.position,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(e.position),t.bufferData(t.ARRAY_BUFFER,Z4,t.STATIC_DRAW),n=rf_create(t,rf_points.vertex,rf_types.vertex),r=rf_create(t,rf_points.fragment,rf_types.fragment),e=this.programs.points=as.program.create(t,[n,r]),e.position=t.getAttribLocation(e,"a_position"),e.matrix=t.getUniformLocation(e,"u_matrix"),e.size=t.getUniformLocation(e,"u_size"),t.enable(t.BLEND),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA)}setSize(i,t,e){let n,r;const s=this.ctx;return this.width=i,this.height=t,this.ratio=void 0===e?I4(s):e,this.domElement.width=i*this.ratio,this.domElement.height=t*this.ratio,er.isObject(this.domElement.style)&&er.extend(this.domElement.style,{width:i+"px",height:t+"px"}),this._renderer.matrix[0]=this._renderer.matrix[4]=this._renderer.scale=this.ratio,this._flagMatrix=!0,n=i*this.ratio,r=t*this.ratio,s.viewport(0,0,n,r),this.programs.resolution.width=n,this.programs.resolution.height=r,this.programs.resolution.ratio=this.ratio,this.programs.resolution.flagged=!0,this.trigger(Mi.Types.resize,i,t,e)}render(){const i=this.ctx;return this.overdraw||i.clear(i.COLOR_BUFFER_BIT),as.group.render.call(this.scene,i,this.programs),this._flagMatrix=!1,this.programs.resolution.flagged=!0,this}};Ie(GJ,"Utils",as);var aAe=er.extend({Error:Kh,getRatio:I4,read:Ha,xhr:LJ},er,Zh,zQ,BQ),PE=class{constructor(i){Ie(this,"_events",new Mi),Ie(this,"type",""),Ie(this,"renderer",null),Ie(this,"scene",null),Ie(this,"width",0),Ie(this,"height",0),Ie(this,"frameCount",0),Ie(this,"timeDelta",0),Ie(this,"playing",!1);const t=er.defaults(i||{},{fullscreen:!1,fitted:!1,width:640,height:480,type:PE.Types.svg,autostart:!1});if(er.each(t,function(e,n){/fullscreen/i.test(n)||/autostart/i.test(n)||(this[n]=e)},this),er.isElement(t.domElement)){const e=t.domElement.tagName.toLowerCase();/^(CanvasRenderer-canvas|WebGLRenderer-canvas|SVGRenderer-svg)$/.test(this.type+"-"+e)||(this.type=PE.Types[e])}this.renderer=new PE[this.type](this),this.setPlaying(t.autostart),this.frameCount=0,t.fullscreen?(this.fit=lAe.bind(this),this.fit.domElement=window,this.fit.attached=!0,er.extend(document.body.style,{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,position:"fixed"}),er.extend(this.renderer.domElement.style,{display:"block",top:0,left:0,right:0,bottom:0,position:"fixed"}),Yh.bind(this.fit.domElement,"resize",this.fit),this.fit()):t.fitted?(this.fit=cAe.bind(this),er.extend(this.renderer.domElement.style,{display:"block"})):er.isElement(t.domElement)||(this.renderer.setSize(t.width,t.height,this.ratio),this.width=t.width,this.height=t.height),this.renderer.bind(Mi.Types.resize,uAe.bind(this)),this.scene=this.renderer.scene,PE.Instances.push(this),t.autostart&&IE.init()}get _bound(){return this._events._bound}set _bound(i){this._events._bound=i}addEventListener(){return this._events.addEventListener.apply(this,arguments)}on(){return this._events.addEventListener.apply(this,arguments)}bind(){return this._events.addEventListener.apply(this,arguments)}removeEventListener(){return this._events.removeEventListener.apply(this,arguments)}off(){return this._events.removeEventListener.apply(this,arguments)}unbind(){return this._events.removeEventListener.apply(this,arguments)}dispatchEvent(){return this._events.dispatchEvent.apply(this,arguments)}trigger(){return this._events.dispatchEvent.apply(this,arguments)}listen(){return this._events.listen.apply(this,arguments)}ignore(){return this._events.ignore.apply(this,arguments)}appendTo(i){return i.appendChild(this.renderer.domElement),this.fit&&(this.fit.domElement!==window&&(this.fit.domElement=i,this.fit.attached=!1),this.update()),this}play(){return this.playing=!0,IE.init(),this.trigger(Mi.Types.play)}pause(){return this.playing=!1,this.trigger(Mi.Types.pause)}setPlaying(i){this.playing=i}release(i){let t,e,n;if(!er.isObject(i))return this.release(this.scene);if("function"==typeof i.unbind&&i.unbind(),i.vertices)for("function"==typeof i.vertices.unbind&&i.vertices.unbind(),t=0;t<i.vertices.length;t++)e=i.vertices[t],"function"==typeof e.unbind&&e.unbind(),e.controls&&(e.controls.left&&"function"==typeof e.controls.left.unbind&&e.controls.left.unbind(),e.controls.right&&"function"==typeof e.controls.right.unbind&&e.controls.right.unbind());if(i.children){for(t=0;t<i.children.length;t++)n=i.children[t],this.release(n);"function"==typeof i.children.unbind&&i.children.unbind()}return i}update(){const i=!!this._lastFrame,t=er.performance.now();i&&(this.timeDelta=parseFloat((t-this._lastFrame).toFixed(3))),this._lastFrame=t,this.fit&&this.fit.domElement&&!this.fit.attached&&(Yh.bind(this.fit.domElement,"resize",this.fit),this.fit.attached=!0,this.fit());const e=this.width,n=this.height,r=this.renderer;return(e!==r.width||n!==r.height)&&r.setSize(e,n,this.ratio),this.trigger(Mi.Types.update,this.frameCount,this.timeDelta),this.render()}render(){return this.renderer.render(),this.trigger(Mi.Types.render,this.frameCount++)}add(i){let t=i;return t instanceof Array||(t=Array.prototype.slice.call(arguments)),this.scene.add(t),this}remove(i){let t=i;return t instanceof Array||(t=Array.prototype.slice.call(arguments)),this.scene.remove(t),this}clear(){return this.scene.remove(this.scene.children),this}makeLine(i,t,e,n){const r=new U4(i,t,e,n);return this.scene.add(r),r}makeArrow(i,t,e,n,r){const s="number"==typeof r?r:10,a=Math.atan2(n-t,e-i),l=[new Ds(i,t,void 0,void 0,void 0,void 0,Ji.move),new Ds(e,n,void 0,void 0,void 0,void 0,Ji.line),new Ds(e-s*Math.cos(a-Math.PI/4),n-s*Math.sin(a-Math.PI/4),void 0,void 0,void 0,void 0,Ji.line),new Ds(e,n,void 0,void 0,void 0,void 0,Ji.move),new Ds(e-s*Math.cos(a+Math.PI/4),n-s*Math.sin(a+Math.PI/4),void 0,void 0,void 0,void 0,Ji.line)],u=new $s(l,!1,!1,!0);return u.noFill(),u.cap="round",u.join="round",this.scene.add(u),u}makeRectangle(i,t,e,n){const r=new q0(i,t,e,n);return this.scene.add(r),r}makeRoundedRectangle(i,t,e,n,r){const s=new jI(i,t,e,n,r);return this.scene.add(s),s}makeCircle(i,t,e,n){const r=new zI(i,t,e,n);return this.scene.add(r),r}makeEllipse(i,t,e,n,r){const s=new GI(i,t,e,n,r);return this.scene.add(s),s}makeStar(i,t,e,n,r){const s=new X4(i,t,e,n,r);return this.scene.add(s),s}makeCurve(i){const t=arguments.length;let e=i;if(!Array.isArray(i)){e=[];for(let a=0;a<t;a+=2){const l=arguments[a];if("number"!=typeof l)break;e.push(new Ds(l,arguments[a+1]))}}const n=arguments[t-1],r=new $s(e,!("boolean"==typeof n?n:void 0),!0),s=r.getBoundingClientRect();return r.center().translation.set(s.left+s.width/2,s.top+s.height/2),this.scene.add(r),r}makePolygon(i,t,e,n){const r=new q4(i,t,e,n);return this.scene.add(r),r}makeArcSegment(i,t,e,n,r,s,a){const l=new W4(i,t,e,n,r,s,a);return this.scene.add(l),l}makePoints(i){const t=arguments.length;let e=i;if(!Array.isArray(i)){e=[];for(let r=0;r<t;r+=2){const s=arguments[r];if("number"!=typeof s)break;e.push(new gn(s,arguments[r+1]))}}const n=new j4(e);return this.scene.add(n),n}makePath(i){const t=arguments.length;let e=i;if(!Array.isArray(i)){e=[];for(let a=0;a<t;a+=2){const l=arguments[a];if("number"!=typeof l)break;e.push(new Ds(l,arguments[a+1]))}}const n=arguments[t-1],r=new $s(e,!("boolean"==typeof n?n:void 0)),s=r.getBoundingClientRect();return"number"==typeof s.top&&"number"==typeof s.left&&"number"==typeof s.right&&"number"==typeof s.bottom&&r.center().translation.set(s.left+s.width/2,s.top+s.height/2),this.scene.add(r),r}makeText(i,t,e,n){const r=new Jf(i,t,e,n);return this.add(r),r}makeLinearGradient(i,t,e,n){const r=Array.prototype.slice.call(arguments,4),s=new Ba(i,t,e,n,r);return this.add(s),s}makeRadialGradient(i,t,e){const n=Array.prototype.slice.call(arguments,3),r=new Na(i,t,e,n);return this.add(r),r}makeSprite(i,t,e,n,r,s,a){const l=new HI(i,t,e,n,r,s);return a&&l.play(),this.add(l),l}makeImageSequence(i,t,e,n,r){const s=new qI(i,t,e,n);return r&&s.play(),this.add(s),s}makeTexture(i,t){return new xo(i,t)}makeGroup(i){let t=i;t instanceof Array||(t=Array.prototype.slice.call(arguments));const e=new ec;return this.scene.add(e),e.add(t),e}interpret(i,t,e){const n=i.tagName.toLowerCase();if(e=void 0===e||e,!(n in Ha))return null;const r=Ha[n].call(this,i);return e?this.add(t&&r instanceof ec?r.children:r):r.parent&&r.remove(),r}load(i,t){const e=new ec;let n,r,s;const a=function(l){for(Yh.temp.innerHTML=l,r=0;r<Yh.temp.children.length;r++)n=Yh.temp.children[r],s=this.interpret(n,!1,!1),null!==s&&e.add(s);"function"==typeof t&&t(e,Yh.temp.children.length<=1?Yh.temp.children[0]:Yh.temp.children)}.bind(this);return/\.svg$/i.test(i)?(LJ(i,a),e):(a(i),e)}},Mr=PE;function lAe(){const i=document.body.getBoundingClientRect(),t=this.width=i.width,e=this.height=i.height;this.renderer.setSize(t,e,this.ratio)}function cAe(){const i=this.renderer.domElement.parentElement;if(!i)return void console.warn("Two.js: Attempting to fit to parent, but no parent found.");const t=i.getBoundingClientRect(),e=this.width=t.width,n=this.height=t.height;this.renderer.setSize(e,n,this.ratio)}function uAe(i,t){this.width=i,this.height=t,this.trigger(Mi.Types.resize,i,t)}Ie(Mr,"nextFrameID",null),Ie(Mr,"Types",{webgl:"WebGLRenderer",svg:"SVGRenderer",canvas:"CanvasRenderer"}),Ie(Mr,"Version","v0.8.3"),Ie(Mr,"PublishDate","2022-01-29T18:46:24.333Z"),Ie(Mr,"Identifier","two-"),Ie(Mr,"Resolution",12),Ie(Mr,"AutoCalculateImportedMatrices",true),Ie(Mr,"Instances",[]),Ie(Mr,"uniqueId",$l_uniqueId),Ie(Mr,"Anchor",Ds),Ie(Mr,"Collection",Jy),Ie(Mr,"Events",Mi),Ie(Mr,"Group",ec),Ie(Mr,"Matrix",Rg),Ie(Mr,"Path",$s),Ie(Mr,"Registry",LI),Ie(Mr,"Shape",Qy),Ie(Mr,"Text",Jf),Ie(Mr,"Vector",gn),Ie(Mr,"Gradient",tc),Ie(Mr,"ImageSequence",qI),Ie(Mr,"LinearGradient",Ba),Ie(Mr,"RadialGradient",Na),Ie(Mr,"Sprite",HI),Ie(Mr,"Stop",ev),Ie(Mr,"Texture",xo),Ie(Mr,"ArcSegment",W4),Ie(Mr,"Circle",zI),Ie(Mr,"Ellipse",GI),Ie(Mr,"Line",U4),Ie(Mr,"Points",j4),Ie(Mr,"Polygon",q4),Ie(Mr,"Rectangle",q0),Ie(Mr,"RoundedRectangle",jI),Ie(Mr,"Star",X4),Ie(Mr,"CanvasRenderer",AE),Ie(Mr,"SVGRenderer",UJ),Ie(Mr,"WebGLRenderer",GJ),Ie(Mr,"Commands",Ji),Ie(Mr,"Utils",aAe);var IE=Yh.getRequestAnimationFrame();function WJ(){for(let i=0;i<Mr.Instances.length;i++){const t=Mr.Instances[i];t.playing&&t.update()}Mr.nextFrameID=IE(WJ)}IE.init=function(){WJ(),IE.init=function(){}};class hAe extends Mr.Circle{constructor(t,e,n=!0){super(),this._disable=!1,this._hover=!1,this.position=new Mr.Anchor(t+this.radius/2,e+this.radius/2,0,0,0,0,Mr.Commands.line),n&&(this.radius=6,this.fill="#00AEFF",this.stroke="#00AEFF")}get disable(){return this._disable}set disable(t){t?(this.fill="#AAAAAA",this.stroke="#AAAAAA"):(this.fill="#00AEFF",this.stroke="#00AEFF"),this._disable=t}get hover(){return this._hover}set hover(t){this.fill=t?"#FF69B4":this._disable?"#AAAAAA":"#00AEFF",this._hover=t}get x(){return this.position.x}get y(){return this.position.y}}class Dr extends Mr.Group{constructor(t=Dr.DEFAULT,e=1,n=!0){const r=[t.nose,t.left_ear,t.right_ear,t.left_eye,t.right_eye,t.left_shoulder,t.right_shoulder,t.left_elbow,t.right_elbow,t.left_wrist,t.right_wrist,t.left_hip,t.right_hip,t.left_knee,t.right_knee,t.left_ankle,t.right_ankle],s=[],a=[];for(const l of r){const u=new hAe(l.x*e,l.y*e,n);u.disable=l.disable,s.push(u),a.push(u)}for(const l of Dr.CONNECTIONS){const u=new Mr.Path(l.map(h=>a[h].position),!1,!1,!0);u.linewidth=2,u.stroke=u.vertices.every(h=>!h.disable)?"#000000":"#AAAAAA",a.push(u)}super(a),this.joints=s}static rawToSkeleton(t){return{nose:{x:t[0],y:t[1],disable:!1},left_eye:{x:t[2],y:t[3],disable:!1},right_eye:{x:t[4],y:t[5],disable:!1},left_ear:{x:t[6],y:t[7],disable:!1},right_ear:{x:t[8],y:t[9],disable:!1},left_shoulder:{x:t[10],y:t[11],disable:!1},right_shoulder:{x:t[12],y:t[13],disable:!1},left_elbow:{x:t[14],y:t[15],disable:!1},right_elbow:{x:t[16],y:t[17],disable:!1},left_wrist:{x:t[18],y:t[19],disable:!1},right_wrist:{x:t[20],y:t[21],disable:!1},left_hip:{x:t[22],y:t[23],disable:!1},right_hip:{x:t[24],y:t[25],disable:!1},left_knee:{x:t[26],y:t[27],disable:!1},right_knee:{x:t[28],y:t[29],disable:!1},left_ankle:{x:t[30],y:t[31],disable:!1},right_ankle:{x:t[32],y:t[33],disable:!1}}}get nose(){return this.children[0]}get left_ear(){return this.children[1]}get right_ear(){return this.children[2]}get left_eye(){return this.children[3]}get right_eye(){return this.children[4]}get left_shoulder(){return this.children[5]}get right_shoulder(){return this.children[6]}get left_elbow(){return this.children[7]}get right_elbow(){return this.children[8]}get left_wrist(){return this.children[9]}get right_wrist(){return this.children[10]}get left_hip(){return this.children[11]}get right_hip(){return this.children[12]}get left_knee(){return this.children[13]}get right_knee(){return this.children[14]}get left_ankle(){return this.children[15]}get right_ankle(){return this.children[16]}}Dr.CONNECTIONS=[[15,13],[13,11],[16,14],[14,12],[11,12],[5,11],[6,12],[5,6],[5,7],[6,8],[7,9],[8,10],[1,2],[0,1],[0,2],[1,3],[2,4],[0,5],[0,6]],Dr.DEFAULT={nose:{x:.15,y:.02,disable:!1},left_eye:{x:.125,y:0,disable:!1},right_eye:{x:.175,y:0,disable:!1},left_ear:{x:.1,y:.01,disable:!1},right_ear:{x:.2,y:.01,disable:!1},left_shoulder:{x:.05,y:.075,disable:!1},right_shoulder:{x:.25,y:.075,disable:!1},left_elbow:{x:0,y:.15,disable:!1},right_elbow:{x:.3,y:.15,disable:!1},left_wrist:{x:0,y:.25,disable:!1},right_wrist:{x:.3,y:.25,disable:!1},left_hip:{x:.075,y:.35,disable:!1},right_hip:{x:.225,y:.35,disable:!1},left_knee:{x:.05,y:.5,disable:!1},right_knee:{x:.25,y:.5,disable:!1},left_ankle:{x:.075,y:.65,disable:!1},right_ankle:{x:.225,y:.65,disable:!1}},Dr.PRESETS_RAW=[[.14786067473578227,.027725922797031552,.16690833079236223,.004595860913616994,.12813142463937924,.004998386595458036,.19846337429218208,.013536842778684626,.09530139401282084,.014769689848586984,.24295941869330231,.13864771714913168,.05245594884344723,.14004215444598436,.28307719090994365,.2918733096731531,.01671892793090125,.2965361997921151,.2140336349998271,.2878901521438324,.09501507860322922,.2871112376096802,.21086897737504487,.4772577808650923,.08273194070569824,.47733830517027104,.21133751396755993,.7418788543691817,.08202245897562371,.7418986886243101,.209322706855775,.9880255222365016,.08205575029098638,.9886087402602408],[.7213538193000133,.10489923404582464,.7499239456821118,.0862144854537864,.7183635429402153,.07364320264465157,.7695176991348829,.084977065091573,.7051536405641033,.060781363290529904,.740162847974073,.20347430780453243,.6234211294178053,.14212588541486584,.7027353450432424,.3724411039140399,.513828462919117,.25303355520098103,.6564550816226506,.4207381294386795,.4928253898159626,.306962467476444,.4680617608785612,.44847512140294654,.3916056804747765,.3944736689763453,.29745958892936997,.529450591974763,.1951017029727768,.4803908287135377,.06422130930846882,.7071823626748978,0,.6649892244609281],[.34647063578407183,.04402653164155983,.36790758874062335,.01980175062218513,.32994552277887795,.015085660808966013,.38736007944982037,.02438399480806348,.292729848361791,.012633292413831035,.4004927048580237,.15895959500358495,.21907433424934428,.13258183437389534,.40662684279192385,.350007989263702,.13883189739956284,.30124563957636025,.365778601454939,.4307903593607051,.1671166554247022,.3934726027908739,.295449111507498,.49419840901808415,.16973957917259155,.475950529048519,.23631964487843113,.7041273994597045,.1097739857765313,.685714534625916,.18102387260799946,.9739716095205662,.06828135206225336,.9607080642532666],[.3187956812202486,.04834529767141674,.3417736970937995,.022581142646444723,.29656248447420336,.022771517741630574,.3823752722764503,.024066982980132736,.25968917171851436,.024427688338910927,.43938526032325265,.1414973598041731,.20628954177211978,.13999848810082333,.5349356119065684,.26484395683236533,.08250820530693598,.24007011661333716,.5461739375804637,.31673208318139706,.03585897591017134,.27646704097588204,.4027723410969954,.4840825844659735,.25036680176876847,.4840016704409523,.42790075628862834,.7166147909697406,.22611502992786156,.7179230077091516,.43649610269328293,.9743049721607032,.2282998627387093,.9719007646139638],[.2399686708885373,.031366357016517715,.23474780233461792,.008132360385484174,.2382576827103055,.008593978890798682,.15005428537648782,.008706576073356502,.2430454415505657,.01528731809911607,.07827764957270145,.13555725667910168,.26675619494869135,.14372989267587502,.02377247958388249,.3041802271792478,.3128079493797811,.3172522865896448,.05169821954375805,.41523349752558214,.3339424965143624,.4237324947174246,.09526451109656155,.47463611951531814,.222918537537704,.4790019740166299,.11024259019914448,.7351048493761185,.23413073834066173,.7398597746912663,.09671292215892562,.9765975914458251,.21215157356446862,.9867140666257113],[.4722586330777761,.06245592379145936,.47475656179025416,.03863467202913199,.4715430410241313,.0378547590847102,.3987972476624,.023026216975389067,.4902772609724586,.03687385201601231,.3127200816968642,.1217042505174494,.5045059563436225,.1486957225349142,.18610303131990297,.23041443186178573,.5887418714699776,.2881836692183734,.13440913379624567,.29265425693962627,.6558541532672532,.3585136011392305,.2627118861392539,.4718480329234168,.392095565545385,.48621159996779256,.24960725436414338,.6964346471883983,.44046214936270706,.7122215290669175,.18321386552585345,.9383588402308314,.41172873022583956,.9654252233077812],[.23088448716767412,.032759566410586215,.25146982764301623,.008249396954759966,.20919059565560041,.008226896721882747,.28451592861949,.01363460924442895,.17013264901833347,.013189054774432,.3325281668438561,.1384565409313353,.11157304376951052,.1370228346517876,.3998378059507644,.288298596835594,.02718321274630374,.28203737271904133,.38570611559282625,.3553635470518351,.05639421316216023,.3470050931928736,.2927817732601004,.4806818040266989,.1487100571908551,.4808414814118183,.3017698963595466,.7358939157104383,.14666471973444134,.7365555793531067,.2990467003906516,.9806701636944384,.1469308583145921,.9807484473579576],[.16452148040696005,.06431386764223337,.18161682667110002,.04330796171052555,.14848173905379855,.04353057985172961,.20817043174507174,.053790776532373734,.1287204827400301,.054008609766258105,.24111395624536097,.16248553807352786,.10225240070426042,.1602527699647094,.27563543207591706,.21704937710574768,.05028986538820838,.1941354725343216,.2307125428887661,.1309214176945636,.08531180928142099,.09020429933368815,.22017554976790898,.49681892138869554,.12022449090555297,.49609752329185136,.22433755302122801,.7494096529647717,.1177378312887096,.749509069656235,.23150605908831978,.9857252367094845,.12234707809271306,.9839915293025217],[.11606053243874027,.0270437022576296,.13616465440181702,.0028023321750370593,.09747589964739004,.0038782405601956306,.17426433565718014,.012930851893831122,.07210413759440297,.015902492556410495,.22896384138230363,.1485191413282448,.04053162304601461,.15311839064678132,.27026587712773764,.3231407563404719,.013451708384539912,.3269765094835341,.23653231665359598,.45291143205325596,.03367405192029359,.4570689768669852,.1991580979155506,.4907373016433993,.07450152001575303,.49142585516091714,.19743018496962986,.7493930511563287,.07692116649869529,.7494809013062368,.20187063553701953,.9886643142012324,.08697484718723024,.9882643079859232],[.2578750971194341,.042338902016865694,.28573586290059105,.010415898157057363,.22823216598116372,.011270707473312417,.33325784043335377,.016664482178861198,.17717868900578815,.018890007639890603,.4032274025380098,.16775720222168652,.10665618165026788,.17219568226712859,.46763052811312733,.38740177572094125,.04896426877581768,.39710008113074774,.400868830625481,.48804980246619106,.13275920652210593,.4918362767601879,.35475185346935995,.5347165248006728,.161175031404476,.5374322707786174,.4487952313883948,.6447514223523239,.09605790104553598,.6504330559427914,.43305887714886976,.976483257500143,.12012831377021528,.9796812290174097],[.19183184498988115,.028796478624020308,.2123992304912999,.0041782844122647935,.170051883450276,.0037658706182535444,.24383009934622837,.01450177124450753,.1308348047612105,.013340754379977381,.2893731731204516,.1529753483250224,.07172729372375874,.15093279130045906,.3338028341672165,.32708707221267436,.016971408055286952,.32619990008372296,.32059886654947506,.45603778178222826,.037286536519592385,.4588454561494976,.24511069500428714,.49728249895953847,.10467341503296075,.49603115750218796,.24048510745778406,.7498397624809046,.10117939822380141,.7480323904839153,.2282715214624941,.9863556270531314,.09915828597683654,.9854269784748948],[.08226445116034334,.03204743136367326,.0848317332116755,.009340588451672419,.08727337659366007,.008761185350988444,.08532342172537727,.016562127716966586,.17407814140291455,.00915123912344954,.07033089584529298,.14338081388945043,.24452318087475916,.13447611670692078,.04112362648607347,.3210815754774492,.2964935113068324,.3003495825081344,.028135962501173697,.42935873819865494,.26665733921508433,.4054671604274717,.1159352265237858,.4769528585865219,.23622540231007644,.4714263083578554,.10161433333941987,.7392284206818608,.22044113527756246,.7341525090877377,.12479187013565574,.9884480448121034,.23894771159028128,.9764128131921074],[.12734029563359342,.15133950896619194,.12298238868799465,.12656438975095805,.10447817545332672,.14066633557170807,.13433288324003106,.11483870308163883,.10933161977344577,.13316864086569533,.22284232378137966,.1577496208273045,.17681142796072485,.20386976034462864,.30627283633339447,.22933821252671666,.21551951279330592,.31124792148535374,.30478597772161964,.274265869704609,.21955966604011706,.338896950901756,.5196355857073021,.27755918411974106,.49529939575392046,.31655276084673234,.6835140205202531,.3347282185012585,.6602594953135145,.3744873667429691,.915560142236427,.42426099206852425,.8980173378449324,.4557398023243274],[.21302123341881887,.04363235302433048,.21322964055759056,.02050518096878752,.2143883392666789,.0206078075501095,.18883533158838853,.024127377002962223,.28477566639466184,.016756066977891348,.15851813748628082,.14450711495740384,.35537952196897243,.132016467180799,.0699662377312127,.29235936666574575,.43613052187658,.2694748100574851,.0335591809755858,.3667221020375115,.43813408355332845,.3490541987628603,.23237631030890046,.48019400191328926,.364448608219399,.4724704024274065,.20762553260496827,.7263204330607121,.36240295751707613,.7182499381809815,.23288724292025487,.9774128632023387,.3943418587077674,.9614132273752769],[.4007029297206234,.059846459778706985,.4410321932710007,.01779891085672016,.35999258124783323,.0182172139836721,.5081034271685229,.02639114670564744,.29479127722917636,.027051504005909083,.5974320694241122,.21479448459013914,.20773895031239456,.21711731667154938,.6967902001758205,.4885193518111789,.09284901073961242,.49085845193725697,.5858214631701515,.5996856183363171,.1980384309931413,.6015858724846733,.5246138430209295,.6966138312300901,.272819552458593,.6973050613903057,.6886418341777952,.6631719948368995,.09852571555507607,.673195777251188,.5073560759311939,.9690232444252442,.3009852633896299,.9674185446130952],[.08729724098576302,.029076537790297206,.10002900323722641,.005800620438888524,.07599087351083475,.006354885808160438,.11199034203613698,.012379166182121456,.07423690440722099,.01360832994509996,.1397626599607076,.13667867125864308,.06191146072794465,.13842277868517272,.15647995954791258,.30708136199459324,.0542186639686793,.3064852017143683,.11642669218309092,.3639656126524154,.07648885766312609,.36195641639622117,.1294340518835197,.4769195119912557,.07269184868054641,.4764658252824837,.11933184295564823,.7394847979386376,.08152710886634772,.7385874413496263,.12346626647114436,.9881106971849598,.09244248404948137,.9844448277790873],[.5403964923671449,.06514153363900291,.5679493765806723,.039612132362269604,.5238933370135853,.03193810458378029,.5991957380002394,.04056214893492629,.4847477612731233,.02115922861772832,.6120953417307582,.1782058967907241,.39658420963153945,.12997593389437956,.6294450007304006,.37270244512335315,.2760042411031657,.2808346032632218,.5885912195734528,.4482089875076897,.2732927690436038,.36286648771782865,.4393484776495991,.5081109860031218,.2901008609482234,.4718630058546187,.3772154065683869,.6752779886725432,.16928077366787211,.6425089997991871,.26900035213134754,.9628045866996409,.06087791585511874,.9327445506691867],[.461735005769137,.0658643228060434,.48674567044433364,.036216848217923,.4344136971209876,.037536156989411644,.5317921023076083,.02702848213046162,.3867117645808656,.03074506472236926,.6021498533464711,.1313432350712349,.31873114872303526,.1360852035763031,.7432908192052682,.25251979276678355,.14060877531980942,.236578326808535,.7998069635862348,.3183048434790471,.0420451518920686,.30020346774076795,.5777728434139039,.46860713160135753,.39785723332908013,.476431075978916,.6516716554021882,.6310357302188634,.3553248582011672,.6445165327739776,.6804460756740947,.9167081043283383,.36778564440537026,.9204178796319552],[.11043379349002785,.041338434518098016,.1272218479235043,.012095407104605249,.08769011319099713,.018176458290067258,.16774423387179063,.00951077851365802,.06601398053597388,.025365924198830752,.24966941290080333,.1281153054863872,.05502885063625878,.16125999529222856,.33054867498271273,.2967783844222961,.04790594587155612,.34965715687355575,.3042834645135061,.3983747623464269,.08860806120503391,.43862646920247145,.29470959132072777,.4715045180493308,.16173240532717512,.49031814719316363,.34416210301433997,.6995472354876859,.2056913794230918,.7168476546640585,.3878822751916862,.9673049769222047,.25765001324704984,.9785230579779165],[.1698000266872435,.07236754157677126,.18128851296423387,.03742891320345223,.13846606090578986,.048542894315583285,.20535621112108163,.027074009837340467,.10040397427478556,.05338465208909244,.28499611171931427,.13630798452210302,.09369567177768275,.20180583921989015,.41859881703562296,.2818878598529445,.11133593276575543,.4135514568914051,.4523039639331955,.35323533045398836,.19045113935385796,.47855586958544016,.43003658323650734,.4783981922254981,.29936905847046913,.5296161086760959,.5859396989951203,.6059469632540961,.44659012857877284,.6641322125214988,.7101168671653553,.9081644161102826,.6000744471625143,.9434534187311291]],Dr.PRESETS=[Dr.rawToSkeleton(Dr.PRESETS_RAW[0]),Dr.rawToSkeleton(Dr.PRESETS_RAW[1]),Dr.rawToSkeleton(Dr.PRESETS_RAW[2]),Dr.rawToSkeleton(Dr.PRESETS_RAW[3]),Dr.rawToSkeleton(Dr.PRESETS_RAW[4]),Dr.rawToSkeleton(Dr.PRESETS_RAW[5]),Dr.rawToSkeleton(Dr.PRESETS_RAW[6]),Dr.rawToSkeleton(Dr.PRESETS_RAW[7]),Dr.rawToSkeleton(Dr.PRESETS_RAW[8]),Dr.rawToSkeleton(Dr.PRESETS_RAW[9]),Dr.rawToSkeleton(Dr.PRESETS_RAW[10]),Dr.rawToSkeleton(Dr.PRESETS_RAW[11]),Dr.rawToSkeleton(Dr.PRESETS_RAW[12]),Dr.rawToSkeleton(Dr.PRESETS_RAW[13]),Dr.rawToSkeleton(Dr.PRESETS_RAW[14]),Dr.rawToSkeleton(Dr.PRESETS_RAW[15]),Dr.rawToSkeleton(Dr.PRESETS_RAW[16]),Dr.rawToSkeleton(Dr.PRESETS_RAW[17]),Dr.rawToSkeleton(Dr.PRESETS_RAW[18]),Dr.rawToSkeleton(Dr.PRESETS_RAW[19])];const jJ=["*"];class fAe{constructor(){this.columnIndex=0,this.rowIndex=0}get rowCount(){return this.rowIndex+1}get rowspan(){const t=Math.max(...this.tracker);return t>1?this.rowCount+t-1:this.rowCount}update(t,e){this.columnIndex=0,this.rowIndex=0,this.tracker=new Array(t),this.tracker.fill(0,0,this.tracker.length),this.positions=e.map(n=>this._trackTile(n))}_trackTile(t){const e=this._findMatchingGap(t.colspan);return this._markTilePosition(e,t),this.columnIndex=e+t.colspan,new pAe(this.rowIndex,e)}_findMatchingGap(t){let e=-1,n=-1;do{this.columnIndex+t>this.tracker.length?(this._nextRow(),e=this.tracker.indexOf(0,this.columnIndex),n=this._findGapEndIndex(e)):(e=this.tracker.indexOf(0,this.columnIndex),-1!=e?(n=this._findGapEndIndex(e),this.columnIndex=e+1):(this._nextRow(),e=this.tracker.indexOf(0,this.columnIndex),n=this._findGapEndIndex(e)))}while(n-e<t||0==n);return Math.max(e,0)}_nextRow(){this.columnIndex=0,this.rowIndex++;for(let t=0;t<this.tracker.length;t++)this.tracker[t]=Math.max(0,this.tracker[t]-1)}_findGapEndIndex(t){for(let e=t+1;e<this.tracker.length;e++)if(0!=this.tracker[e])return e;return this.tracker.length}_markTilePosition(t,e){for(let n=0;n<e.colspan;n++)this.tracker[t+n]=e.rowspan}}class pAe{constructor(t,e){this.row=t,this.col=e}}const qJ=new gi("MAT_GRID_LIST");let Y4=(()=>{class i{constructor(e,n){this._element=e,this._gridList=n,this._rowspan=1,this._colspan=1}get rowspan(){return this._rowspan}set rowspan(e){this._rowspan=Math.round(Qo(e))}get colspan(){return this._colspan}set colspan(e){this._colspan=Math.round(Qo(e))}_setStyle(e,n){this._element.nativeElement.style[e]=n}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(qJ,8))},i.\u0275cmp=ei({type:i,selectors:[["mat-grid-tile"]],hostAttrs:[1,"mat-grid-tile"],hostVars:2,hostBindings:function(e,n){2&e&&Vi("rowspan",n.rowspan)("colspan",n.colspan)},inputs:{rowspan:"rowspan",colspan:"colspan"},exportAs:["matGridTile"],ngContentSelectors:jJ,decls:2,vars:0,consts:[[1,"mat-grid-tile-content"]],template:function(e,n){1&e&&(As(),Z(0,"div",0),hr(1),J())},styles:[".mat-grid-list{display:block;position:relative}.mat-grid-tile{display:block;position:absolute;overflow:hidden}.mat-grid-tile .mat-grid-tile-header,.mat-grid-tile .mat-grid-tile-footer{display:flex;align-items:center;height:48px;color:#fff;background:rgba(0,0,0,.38);overflow:hidden;padding:0 16px;position:absolute;left:0;right:0}.mat-grid-tile .mat-grid-tile-header>*,.mat-grid-tile .mat-grid-tile-footer>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-grid-tile .mat-grid-tile-header.mat-2-line,.mat-grid-tile .mat-grid-tile-footer.mat-2-line{height:68px}.mat-grid-tile .mat-grid-list-text{display:flex;flex-direction:column;flex:auto;box-sizing:border-box;overflow:hidden}.mat-grid-tile .mat-grid-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-grid-tile .mat-grid-list-text:empty{display:none}.mat-grid-tile .mat-grid-tile-header{top:0}.mat-grid-tile .mat-grid-tile-footer{bottom:0}.mat-grid-tile .mat-grid-avatar{padding-right:16px}[dir=rtl] .mat-grid-tile .mat-grid-avatar{padding-right:0;padding-left:16px}.mat-grid-tile .mat-grid-avatar:empty{display:none}.mat-grid-tile-content{top:0;left:0;right:0;bottom:0;position:absolute;display:flex;align-items:center;justify-content:center;height:100%;padding:0;margin:0}\n"],encapsulation:2,changeDetection:0}),i})();const mAe=/^-?\d+((\.\d+)?[A-Za-z%$]?)+$/;class K4{constructor(){this._rows=0,this._rowspan=0}init(t,e,n,r){this._gutterSize=XJ(t),this._rows=e.rowCount,this._rowspan=e.rowspan,this._cols=n,this._direction=r}getBaseTileSize(t,e){return`(${t}% - (${this._gutterSize} * ${e}))`}getTilePosition(t,e){return 0===e?"0":X0(`(${t} + ${this._gutterSize}) * ${e}`)}getTileSize(t,e){return`(${t} * ${e}) + (${e-1} * ${this._gutterSize})`}setStyle(t,e,n){let r=100/this._cols,s=(this._cols-1)/this._cols;this.setColStyles(t,n,r,s),this.setRowStyles(t,e,r,s)}setColStyles(t,e,n,r){let s=this.getBaseTileSize(n,r);t._setStyle("rtl"===this._direction?"right":"left",this.getTilePosition(s,e)),t._setStyle("width",X0(this.getTileSize(s,t.colspan)))}getGutterSpan(){return`${this._gutterSize} * (${this._rowspan} - 1)`}getTileSpan(t){return`${this._rowspan} * ${this.getTileSize(t,1)}`}getComputedHeight(){return null}}class gAe extends K4{constructor(t){super(),this.fixedRowHeight=t}init(t,e,n,r){super.init(t,e,n,r),this.fixedRowHeight=XJ(this.fixedRowHeight),mAe.test(this.fixedRowHeight)}setRowStyles(t,e){t._setStyle("top",this.getTilePosition(this.fixedRowHeight,e)),t._setStyle("height",X0(this.getTileSize(this.fixedRowHeight,t.rowspan)))}getComputedHeight(){return["height",X0(`${this.getTileSpan(this.fixedRowHeight)} + ${this.getGutterSpan()}`)]}reset(t){t._setListStyle(["height",null]),t._tiles&&t._tiles.forEach(e=>{e._setStyle("top",null),e._setStyle("height",null)})}}class _Ae extends K4{constructor(t){super(),this._parseRatio(t)}setRowStyles(t,e,n,r){this.baseTileHeight=this.getBaseTileSize(n/this.rowHeightRatio,r),t._setStyle("marginTop",this.getTilePosition(this.baseTileHeight,e)),t._setStyle("paddingTop",X0(this.getTileSize(this.baseTileHeight,t.rowspan)))}getComputedHeight(){return["paddingBottom",X0(`${this.getTileSpan(this.baseTileHeight)} + ${this.getGutterSpan()}`)]}reset(t){t._setListStyle(["paddingBottom",null]),t._tiles.forEach(e=>{e._setStyle("marginTop",null),e._setStyle("paddingTop",null)})}_parseRatio(t){const e=t.split(":");this.rowHeightRatio=parseFloat(e[0])/parseFloat(e[1])}}class yAe extends K4{setRowStyles(t,e){let s=this.getBaseTileSize(100/this._rowspan,(this._rows-1)/this._rows);t._setStyle("top",this.getTilePosition(s,e)),t._setStyle("height",X0(this.getTileSize(s,t.rowspan)))}reset(t){t._tiles&&t._tiles.forEach(e=>{e._setStyle("top",null),e._setStyle("height",null)})}}function X0(i){return`calc(${i})`}function XJ(i){return i.match(/([A-Za-z%]+)$/)?i:`${i}px`}let ZJ=(()=>{class i{constructor(e,n){this._element=e,this._dir=n,this._gutter="1px"}get cols(){return this._cols}set cols(e){this._cols=Math.max(1,Math.round(Qo(e)))}get gutterSize(){return this._gutter}set gutterSize(e){this._gutter=`${null==e?"":e}`}get rowHeight(){return this._rowHeight}set rowHeight(e){const n=`${null==e?"":e}`;n!==this._rowHeight&&(this._rowHeight=n,this._setTileStyler(this._rowHeight))}ngOnInit(){this._checkCols(),this._checkRowHeight()}ngAfterContentChecked(){this._layoutTiles()}_checkCols(){}_checkRowHeight(){this._rowHeight||this._setTileStyler("1:1")}_setTileStyler(e){this._tileStyler&&this._tileStyler.reset(this),this._tileStyler="fit"===e?new yAe:e&&e.indexOf(":")>-1?new _Ae(e):new gAe(e)}_layoutTiles(){this._tileCoordinator||(this._tileCoordinator=new fAe);const e=this._tileCoordinator,n=this._tiles.filter(s=>!s._gridList||s._gridList===this),r=this._dir?this._dir.value:"ltr";this._tileCoordinator.update(this.cols,n),this._tileStyler.init(this.gutterSize,e,this.cols,r),n.forEach((s,a)=>{const l=e.positions[a];this._tileStyler.setStyle(s,l.row,l.col)}),this._setListStyle(this._tileStyler.getComputedHeight())}_setListStyle(e){e&&(this._element.nativeElement.style[e[0]]=e[1])}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(Ia,8))},i.\u0275cmp=ei({type:i,selectors:[["mat-grid-list"]],contentQueries:function(e,n,r){if(1&e&&Er(r,Y4,5),2&e){let s;jt(s=qt())&&(n._tiles=s)}},hostAttrs:[1,"mat-grid-list"],hostVars:1,hostBindings:function(e,n){2&e&&Vi("cols",n.cols)},inputs:{cols:"cols",gutterSize:"gutterSize",rowHeight:"rowHeight"},exportAs:["matGridList"],features:[Sn([{provide:qJ,useExisting:i}])],ngContentSelectors:jJ,decls:2,vars:0,template:function(e,n){1&e&&(As(),Z(0,"div"),hr(1),J())},styles:[".mat-grid-list{display:block;position:relative}.mat-grid-tile{display:block;position:absolute;overflow:hidden}.mat-grid-tile .mat-grid-tile-header,.mat-grid-tile .mat-grid-tile-footer{display:flex;align-items:center;height:48px;color:#fff;background:rgba(0,0,0,.38);overflow:hidden;padding:0 16px;position:absolute;left:0;right:0}.mat-grid-tile .mat-grid-tile-header>*,.mat-grid-tile .mat-grid-tile-footer>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-grid-tile .mat-grid-tile-header.mat-2-line,.mat-grid-tile .mat-grid-tile-footer.mat-2-line{height:68px}.mat-grid-tile .mat-grid-list-text{display:flex;flex-direction:column;flex:auto;box-sizing:border-box;overflow:hidden}.mat-grid-tile .mat-grid-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-grid-tile .mat-grid-list-text:empty{display:none}.mat-grid-tile .mat-grid-tile-header{top:0}.mat-grid-tile .mat-grid-tile-footer{bottom:0}.mat-grid-tile .mat-grid-avatar{padding-right:16px}[dir=rtl] .mat-grid-tile .mat-grid-avatar{padding-right:0;padding-left:16px}.mat-grid-tile .mat-grid-avatar:empty{display:none}.mat-grid-tile-content{top:0;left:0;right:0;bottom:0;position:absolute;display:flex;align-items:center;justify-content:center;height:100%;padding:0;margin:0}\n"],encapsulation:2,changeDetection:0}),i})(),YJ=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[Ak,jn],Ak,jn]}),i})();const bAe=["canvas"];function xAe(i,t){if(1&i){const e=Wi();Z(0,"mat-grid-tile",17),je("click",function(){const s=gt(e).$implicit;return Re(2).addNewSkeleton(s[2])}),Z(1,"button",18),yt(2,"img",19),J()()}if(2&i){const e=t.$implicit;se(2),_o("alt",e[0]),fe("src",e[1],Mc)}}function wAe(i,t){if(1&i&&(Z(0,"div")(1,"mat-grid-list",15),Ue(2,xAe,3,2,"mat-grid-tile",16),J()()),2&i){const e=Re();A("width",210,"px"),se(2),fe("ngForOf",e.presets)}}let SAe=(()=>{class i{constructor(e,n,r){this.domSanitizer=e,this._dialogRef=n,this._input=r,this.poses=[],this.dragging=!1,this.presets=[],this.selectedSkeleton=null,this.highlightedSkeleton=null,this.highlightedJoint=null,this._dialogRef.disableClose=!0}ngAfterViewInit(){this.two=new Mr({type:Mr.Types.canvas,width:800,height:450,overdraw:!1,autostart:!0}).appendTo(this.canvas.nativeElement),this.populatePresets(),this.highlightRect=this.two.makeRectangle(0,0,0,0),this.highlightRect.visible=!1,this.highlightRect.stroke="#FF69B4",this.highlightRect.dashes=[1,2],this.selectRect=this.two.makeRectangle(0,0,0,0),this.selectRect.visible=!1,this.selectRect.stroke="#FF69B4";for(const e of this._input)this.addSkeleton(new Dr(e))}addNewSkeleton(e=null){null==e&&(e=Dr.DEFAULT),this.addSkeleton(new Dr(e,Math.min(this.two.width,this.two.height)))}removeSelectedSkeleton(){null!=this.selectedSkeleton&&(this.removeSkeleton(this.selectedSkeleton),this.selectedSkeleton=null,this.selectRect.visible=!1)}copySelectedSkeleton(){null!=this.selectedSkeleton&&this.addSkeleton(new Dr(this.selectedSkeleton))}onMouseDown(e){this.dragging=!0}onMouseUp(e){this.dragging=!1}onMouseLeave(e){this.dragging=!1}onMouseMove(e){const r=new Mr.Vector(e.movementX,e.movementY),s=new Mr.Vector(e.offsetX,e.offsetY);if(!this.dragging||null==this.highlightedJoint&&null==this.highlightedSkeleton){this.highlightedSkeleton=null,this.highlightRect.visible=!1;for(const a of this.poses){const l=a.getBoundingClientRect();if(s.x>=l.left&&s.x<=l.right&&s.y>=l.top&&s.y<=l.bottom){this.highlightRect.width=l.width+10,this.highlightRect.height=l.height+10,this.highlightRect.position.set(l.left+(l.right-l.left)/2,l.top+(l.bottom-l.top)/2),this.highlightRect.visible=!0,this.highlightedSkeleton=a,this.highlightedJoint=null;for(const u of a.joints){if(u.position.distanceToSquared(s)<=36){this.highlightedJoint=u,u.hover=!0;break}u.hover=!1}}}}else this.onMouseDrag(r)}onClick(e){if(this.selectedSkeleton=this.highlightedSkeleton,null!=this.selectedSkeleton){const n=this.selectedSkeleton.getBoundingClientRect();this.selectRect.width=n.width+10,this.selectRect.height=n.height+10,this.selectRect.position.set(n.left+(n.right-n.left)/2,n.top+(n.bottom-n.top)/2),this.selectRect.visible=!0}else this.selectRect.visible=!1}onDoubleClick(e){null!=this.highlightedJoint&&(this.highlightedJoint.disable=!this.highlightedJoint.disable)}close(){this._dialogRef.close({poses:this.poses,image:this.two.renderer.ctx.canvas.toDataURL("image/png")})}setAspect169(){this.two.width=800,this.two.height=450,this._dialogRef.updateSize("800px","600px")}setAspect43(){this.two.width=800,this.two.height=600,this._dialogRef.updateSize("800px","750px")}onMouseDrag(e){if(null!=this.highlightedSkeleton){if(null!=this.highlightedJoint)this.highlightedJoint.translation.add(e.x,e.y);else for(const r of this.highlightedSkeleton.joints)r.translation.add(e.x,e.y);const n=this.highlightedSkeleton.getBoundingClientRect();this.highlightRect.width=n.width+10,this.highlightRect.height=n.height+10,this.highlightRect.position.set(n.left+(n.right-n.left)/2,n.top+(n.bottom-n.top)/2)}}addSkeleton(e){this.poses.push(e),this.two.add(e)}removeSkeleton(e){const n=this.poses.indexOf(e);n>-1&&(this.poses.splice(n,1),this.two.remove(e))}populatePresets(){let e=new Mr({type:Mr.Types.svg,width:50,height:50,overdraw:!1,autostart:!1}),n=1;for(let r of Dr.PRESETS){const s=new Dr(r,50,!1);s.position.add(0,0),e.add(s),e.render();const a=(new XMLSerializer).serializeToString(e.renderer.domElement),l=`data:image/svg+xml;base64,${btoa(a)}`;this.presets.push(["Preset "+n++,this.domSanitizer.bypassSecurityTrustUrl(l),r]),e.remove(s)}}}return i.\u0275fac=function(e){return new(e||i)(B(m1),B(Ip),B(Cy))},i.\u0275cmp=ei({type:i,selectors:[["app-pose-sketchpad"]],viewQuery:function(e,n){if(1&e&&ji(bAe,7),2&e){let r;jt(r=qt())&&(n.canvas=r.first)}},decls:32,vars:4,consts:[["color","primary"],["mat-icon-button","",3,"click"],["matTooltip","Adds a skeleton to."],["mat-icon-button","",3,"matMenuTriggerFor"],["presetMenu","matMenu"],["matMenuContent",""],["mat-icon-button","",3,"disabled","click"],["matTooltip","Removes currently selected skeleton."],["matTooltip","Copies the currently selected skeleton."],[1,"spacer-flex"],["aspectMenu","matMenu"],["mat-menu-item","",3,"click"],["matTooltip","Close window and save."],[1,"canvas",3,"mousedown","mouseup","mouseleave","mousemove","click","dblclick"],["canvas",""],["cols","4","rowHeight","1:1"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["mat-button",""],[3,"src","alt"]],template:function(e,n){if(1&e&&(Z(0,"mat-dialog-content")(1,"mat-toolbar",0)(2,"button",1),je("click",function(){return n.addNewSkeleton()}),Z(3,"mat-icon",2),ue(4,"add"),J()(),Z(5,"button",3)(6,"mat-icon"),ue(7,"menu"),J()(),Z(8,"mat-menu",null,4),Ue(10,wAe,3,3,"ng-template",5),J(),Z(11,"button",6),je("click",function(){return n.removeSelectedSkeleton()}),Z(12,"mat-icon",7),ue(13,"remove"),J()(),Z(14,"button",6),je("click",function(){return n.copySelectedSkeleton()}),Z(15,"mat-icon",8),ue(16,"content_copy"),J()(),yt(17,"span",9),Z(18,"button",3)(19,"mat-icon",8),ue(20,"aspect_ratio"),J()(),Z(21,"mat-menu",null,10)(23,"button",11),je("click",function(){return n.setAspect169()}),ue(24,"16:9"),J(),Z(25,"button",11),je("click",function(){return n.setAspect43()}),ue(26,"4:3"),J()(),Z(27,"button",1),je("click",function(){return n.close()}),Z(28,"mat-icon",12),ue(29,"close"),J()()(),Z(30,"div",13,14),je("mousedown",function(s){return n.onMouseDown(s)})("mouseup",function(s){return n.onMouseUp(s)})("mouseleave",function(s){return n.onMouseLeave(s)})("mousemove",function(s){return n.onMouseMove(s)})("click",function(s){return n.onClick(s)})("dblclick",function(s){return n.onDoubleClick(s)}),J()()),2&e){const r=Yo(9),s=Yo(22);se(5),fe("matMenuTriggerFor",r),se(6),fe("disabled",null==n.selectedSkeleton),se(3),fe("disabled",null==n.selectedSkeleton),se(4),fe("matMenuTriggerFor",s)}},directives:[cS,My,Mo,vo,Fo,YH,RP,zme,ZJ,mo,Y4,fS],styles:[".canvas[_ngcontent-%COMP%]{border-style:solid;border-color:#aaa;margin-bottom:25px}"]}),i})();const CAe=["previewimg"];let MAe=(()=>{class i{constructor(e,n,r){this._dialog=e,this._resolver=n,this._http=r}ngOnInit(){}onViewerClicked(){this.openSketchDialog()}openSketchDialog(e){this._dialog.open(SAe,{data:null!=this.poseQuery?this.poseQuery.poses:[],width:"900px",height:"600px"}).afterClosed().pipe(Xl()).subscribe(r=>this.applyPoseData(r))}applyPoseData(e){this.poseQuery=e,this.previewimg.nativeElement.src=e.image;const n=[];for(const r of e.poses)n.push({coordinates:[r.nose.x,r.nose.y,r.left_eye.x,r.left_eye.y,r.right_eye.x,r.right_eye.y,r.left_ear.x,r.left_ear.y,r.right_ear.x,r.right_ear.y,r.left_shoulder.x,r.left_shoulder.y,r.right_shoulder.x,r.right_shoulder.y,r.left_elbow.x,r.left_elbow.y,r.right_elbow.x,r.right_elbow.y,r.left_wrist.x,r.left_wrist.y,r.right_wrist.x,r.right_wrist.y,r.left_hip.x,r.left_hip.y,r.right_hip.x,r.right_hip.y,r.left_knee.x,r.left_knee.y,r.right_knee.x,r.right_knee.y,r.left_ankle.x,r.left_ankle.y,r.right_ankle.x,r.right_ankle.y],weights:[r.nose.disable?0:1,r.left_eye.disable?0:1,r.right_eye.disable?0:1,r.left_ear.disable?0:1,r.right_ear.disable?0:1,r.left_shoulder.disable?0:1,r.right_shoulder.disable?0:1,r.left_elbow.disable?0:1,r.right_elbow.disable?0:1,r.left_wrist.disable?0:1,r.right_wrist.disable?0:1,r.left_hip.disable?0:1,r.right_hip.disable?0:1,r.left_knee.disable?0:1,r.right_knee.disable?0:1,r.left_ankle.disable?0:1,r.right_ankle.disable?0:1]});this.poseTerm.data="data:application/json;base64,"+btoa(JSON.stringify(n))}}return i.\u0275fac=function(e){return new(e||i)(B(Lu),B(Ts),B(ma))},i.\u0275cmp=ei({type:i,selectors:[["app-qt-pose"]],viewQuery:function(e,n){if(1&e&&ji(CAe,7),2&e){let r;jt(r=qt())&&(n.previewimg=r.first)}},inputs:{poseTerm:"poseTerm",poseQuery:"poseQuery"},decls:2,vars:0,consts:[["matTooltip","Click to change image...","width","150",1,"previewimg",2,"background-image","url('../../../../assets/images/transparent.png')",3,"click"],["previewimg",""]],template:function(e,n){1&e&&(Z(0,"img",0,1),je("click",function(){return n.onViewerClicked()}),J())},directives:[Fo],styles:["img.previewimg[_ngcontent-%COMP%]{width:150px;height:150px;border:#ebebeb solid .5px;display:inline-block}"]}),i})();function TAe(i,t){if(1&i){const e=Wi();Z(0,"div")(1,"button",12),je("click",function(){return gt(e),Re().onPushUpClicked()}),Z(2,"mat-icon"),ue(3,"search"),J(),Z(4,"mat-icon"),ue(5,"keyboard_arrow_up"),J()()()}}function EAe(i,t){1&i&&yt(0,"app-qt-image",13),2&i&&fe("imageTerm",Re().queryTerm)}function AAe(i,t){1&i&&yt(0,"app-qt-audio",14),2&i&&fe("audioTerm",Re().queryTerm)}function DAe(i,t){1&i&&yt(0,"app-qt-m3d",15),2&i&&fe("m3dTerm",Re().queryTerm)}function RAe(i,t){1&i&&yt(0,"app-qt-text",16),2&i&&fe("textTerm",Re().queryTerm)}function kAe(i,t){1&i&&yt(0,"app-qt-tag",17),2&i&&fe("tagTerm",Re().queryTerm)}function PAe(i,t){1&i&&yt(0,"app-qt-semantic",18),2&i&&fe("semanticTerm",Re().queryTerm)}function IAe(i,t){1&i&&yt(0,"app-qt-bool",19),2&i&&fe("boolTerm",Re().queryTerm)}function LAe(i,t){1&i&&yt(0,"app-map-query-term",20),2&i&&fe("locationTerm",Re().queryTerm)}function OAe(i,t){1&i&&yt(0,"app-qt-pose",21),2&i&&fe("poseTerm",Re().queryTerm)}function FAe(i,t){1&i&&yt(0,"hr",22)}let BAe=(()=>{class i{constructor(e){this._config=e,this.stageChange=new Si}onPushUpClicked(){this.stageChange.emit(o0.EARLIER_STAGE)}onPushDownClicked(){this.stageChange.emit(o0.LATER_STAGE)}}return i.\u0275fac=function(e){return new(e||i)(B(dr))},i.\u0275cmp=ei({type:i,selectors:[["app-query-component"]],inputs:{queryTerm:"queryTerm",firstStage:"firstStage",lastStage:"lastStage",lastInStage:"lastInStage"},outputs:{stageChange:"stageChange"},decls:19,vars:11,consts:[[4,"ngIf"],[3,"imageTerm",4,"ngIf"],[3,"audioTerm",4,"ngIf"],[3,"m3dTerm",4,"ngIf"],[3,"textTerm",4,"ngIf"],[3,"tagTerm",4,"ngIf"],[3,"semanticTerm",4,"ngIf"],[3,"boolTerm",4,"ngIf"],[3,"locationTerm",4,"ngIf"],[3,"poseTerm",4,"ngIf"],["mat-icon-button","","color","primary","aria-label","Use as a later filter",3,"click"],["class","fade","style","margin-bottom: 20px; margin-top: 10px;",4,"ngIf"],["mat-icon-button","","color","primary","matTooltip","Use as an earlier filter",2,"width","48px",3,"click"],[3,"imageTerm"],[3,"audioTerm"],[3,"m3dTerm"],[3,"textTerm"],[3,"tagTerm"],[3,"semanticTerm"],[3,"boolTerm"],[3,"locationTerm"],[3,"poseTerm"],[1,"fade",2,"margin-bottom","20px","margin-top","10px"]],template:function(e,n){1&e&&(Z(0,"div"),Ue(1,TAe,6,0,"div",0),Z(2,"div"),Ue(3,EAe,1,1,"app-qt-image",1),Ue(4,AAe,1,1,"app-qt-audio",2),Ue(5,DAe,1,1,"app-qt-m3d",3),Ue(6,RAe,1,1,"app-qt-text",4),Ue(7,kAe,1,1,"app-qt-tag",5),Ue(8,PAe,1,1,"app-qt-semantic",6),Ue(9,IAe,1,1,"app-qt-bool",7),Ue(10,LAe,1,1,"app-map-query-term",8),Ue(11,OAe,1,1,"app-qt-pose",9),J(),Z(12,"div")(13,"button",10),je("click",function(){return n.onPushDownClicked()}),Z(14,"mat-icon"),ue(15,"search"),J(),Z(16,"mat-icon"),ue(17,"keyboard_arrow_down"),J()()(),Ue(18,FAe,1,0,"hr",11),J()),2&e&&(se(1),fe("ngIf",!n.firstStage),se(2),fe("ngIf","IMAGE"===n.queryTerm.type),se(1),fe("ngIf","AUDIO"===n.queryTerm.type),se(1),fe("ngIf","MODEL3D"===n.queryTerm.type),se(1),fe("ngIf","TEXT"===n.queryTerm.type),se(1),fe("ngIf","TAG"===n.queryTerm.type),se(1),fe("ngIf","SEMANTIC"===n.queryTerm.type),se(1),fe("ngIf","BOOLEAN"===n.queryTerm.type),se(1),fe("ngIf","LOCATION"===n.queryTerm.type),se(1),fe("ngIf","SKELETON"===n.queryTerm.type),se(7),fe("ngIf",!n.lastInStage))},directives:[ms,Mo,Fo,vo,jye,eve,CMe,FMe,_1e,M1e,nEe,fEe,MAe],encapsulation:2,changeDetection:0}),i})(),NAe=(()=>{class i{transform(e,n){return e.indexOf(n)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275pipe=Hn({name:"QueryStageIndexPipe",type:i,pure:!0}),i})(),HAe=(()=>{class i{transform(e,n){return e.indexOf(n)===e.length-1}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275pipe=Hn({name:"QueryStageLast",type:i,pure:!0}),i})();function VAe(i,t){if(1&i&&(Z(0,"h3"),ue(1),ti(2,"QueryStageIndexPipe"),J()),2&i){const e=Re();se(1),ui("Stage ",Bs(2,1,e.qsList,e.queryStage),":")}}function zAe(i,t){1&i&&(Z(0,"mat-divider"),ue(1,'style="padding-bottom:10px">'),J())}function UAe(i,t){if(1&i){const e=Wi();Z(0,"app-query-component",2),je("stageChange",function(r){const a=gt(e).$implicit;return Re().onStageChange(r,a)}),ti(1,"QueryStageLast"),J()}if(2&i){const e=t.$implicit,n=Re();fe("queryTerm",e)("firstStage",0==n.qsList.indexOf(n.queryStage))("lastStage",Bs(1,4,n.qsList,n.queryStage))("lastInStage",n.queryStage.terms.indexOf(e)==n.queryStage.terms.length-1)}}let GAe=(()=>{class i{constructor(e){this._configService=e}index(){return this.qsList.indexOf(this.queryStage)}onStageChange(e,n){switch(this.removeQueryTerm(n),e){case o0.EARLIER_STAGE:this.qsList[this.index()-1].terms.push(n);break;case o0.LATER_STAGE:this.isLastStage()&&this.qsList.push(new $H),this.qsList[this.index()+1].terms.push(n)}0===this.queryStage.terms.length&&this.qsList.splice(this.index(),1)}removeQueryTerm(e){this.queryStage.terms.splice(this.queryStage.terms.indexOf(e),1)}isLastStage(){return this.qsList.indexOf(this.queryStage)===this.qsList.length-1}}return i.\u0275fac=function(e){return new(e||i)(B(dr))},i.\u0275cmp=ei({type:i,selectors:[["app-query-stage"]],inputs:{queryStage:"queryStage",qsList:"qsList"},decls:3,vars:3,consts:[[4,"ngIf"],[3,"queryTerm","firstStage","lastStage","lastInStage","stageChange",4,"ngFor","ngForOf"],[3,"queryTerm","firstStage","lastStage","lastInStage","stageChange"]],template:function(e,n){1&e&&(Ue(0,VAe,3,4,"h3",0),Ue(1,zAe,2,0,"mat-divider",0),Ue(2,UAe,2,7,"app-query-component",1)),2&e&&(fe("ngIf",n.qsList.length>1),se(1),fe("ngIf",n.qsList.length>1),se(1),fe("ngForOf",n.queryStage.terms))},directives:[ms,ig,mo,BAe],pipes:[NAe,HAe],encapsulation:2}),i})(),WAe=(()=>{class i{transform(e,n,r){return e.hasTerm(n)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275pipe=Hn({name:"ModelHasTermPipe",type:i,pure:!0}),i})();function jAe(i,t){1&i&&(Z(0,"span"),yt(1,"app-temporal-distance")(2,"mat-divider"),J())}function qAe(i,t){if(1&i){const e=Wi();Z(0,"div",17)(1,"button",18),je("click",function(){return gt(e),Re().onMoveQueryContainerUpButtonClicked()}),Z(2,"mat-icon"),ue(3,"access_time"),J(),Z(4,"mat-icon"),ue(5,"keyboard_arrow_up"),J()(),yt(6,"mat-divider"),Ue(7,jAe,3,0,"span",19),J()}if(2&i){const e=Re();se(7),fe("ngIf","TEMPORAL_DISTANCE"===e.mode&&e.isNotFirst)}}function XAe(i,t){if(1&i){const e=Wi();Z(0,"button",20),je("click",function(){return gt(e),Re().onToggleButtonClicked("IMAGE")}),Z(1,"mat-icon"),ti(2,"ModelHasTermPipe"),ue(3," panorama "),J()()}if(2&i){const e=Re();se(1),Vi("class",Rh(2,1,e.containerModel,"IMAGE",e.trigger)?"material-icons md-primary-250":"material-icons md-primary-100")}}function ZAe(i,t){if(1&i){const e=Wi();Z(0,"button",21),je("click",function(){return gt(e),Re().onToggleButtonClicked("AUDIO")}),Z(1,"mat-icon"),ti(2,"ModelHasTermPipe"),ue(3," audiotrack "),J()()}if(2&i){const e=Re();se(1),Vi("class",Rh(2,1,e.containerModel,"AUDIO",e.trigger)?"material-icons md-primary-250":"material-icons md-primary-100")}}function YAe(i,t){if(1&i){const e=Wi();Z(0,"button",22),je("click",function(){return gt(e),Re().onToggleButtonClicked("MODEL3D")}),Z(1,"mat-icon"),ti(2,"ModelHasTermPipe"),ue(3," 3d_rotation "),J()()}if(2&i){const e=Re();se(1),Vi("class",Rh(2,1,e.containerModel,"MODEL3D",e.trigger)?"material-icons md-primary-250":"material-icons md-primary-100")}}function KAe(i,t){if(1&i){const e=Wi();Z(0,"button",23),je("click",function(){return gt(e),Re().onToggleButtonClicked("TEXT")}),Z(1,"mat-icon"),ti(2,"ModelHasTermPipe"),ue(3," text_fields "),J()()}if(2&i){const e=Re();se(1),Vi("class",Rh(2,1,e.containerModel,"TEXT",e.trigger)?"material-icons md-primary-250":"material-icons md-primary-100")}}function QAe(i,t){if(1&i){const e=Wi();Z(0,"button",24),je("click",function(){return gt(e),Re().onToggleButtonClicked("TAG")}),Z(1,"mat-icon"),ti(2,"ModelHasTermPipe"),ue(3," label "),J()()}if(2&i){const e=Re();se(1),Vi("class",Rh(2,1,e.containerModel,"TAG",e.trigger)?"material-icons md-primary-250":"material-icons md-primary-100")}}function JAe(i,t){if(1&i){const e=Wi();Z(0,"button",25),je("click",function(){return gt(e),Re().onToggleButtonClicked("LOCATION")}),Z(1,"mat-icon"),ti(2,"ModelHasTermPipe"),ue(3," map "),J()()}if(2&i){const e=Re();se(1),Vi("class",Rh(2,1,e.containerModel,"LOCATION",e.trigger)?"material-icons md-primary-250":"material-icons md-primary-100")}}function $Ae(i,t){if(1&i){const e=Wi();Z(0,"button",26),je("click",function(){return gt(e),Re().onToggleButtonClicked("SEMANTIC")}),Z(1,"mat-icon"),ti(2,"ModelHasTermPipe"),ue(3," toys "),J()()}if(2&i){const e=Re();se(1),Vi("class",Rh(2,1,e.containerModel,"SEMANTIC",e.trigger)?"material-icons md-primary-250":"material-icons md-primary-100")}}function eDe(i,t){if(1&i){const e=Wi();Z(0,"button",27),je("click",function(){return gt(e),Re().onToggleButtonClicked("BOOLEAN")}),Z(1,"mat-icon"),ti(2,"ModelHasTermPipe"),ue(3," code "),J()()}if(2&i){const e=Re();se(1),Vi("class",Rh(2,1,e.containerModel,"BOOLEAN",e.trigger)?"material-icons md-primary-250":"material-icons md-primary-100")}}function tDe(i,t){if(1&i){const e=Wi();Z(0,"button",28),je("click",function(){return gt(e),Re().onToggleButtonClicked("SKELETON")}),Z(1,"mat-icon"),ti(2,"ModelHasTermPipe"),ue(3," accessibility "),J()()}if(2&i){const e=Re();se(1),Vi("class",Rh(2,1,e.containerModel,"SKELETON",e.trigger)?"material-icons md-primary-250":"material-icons md-primary-100")}}function iDe(i,t){if(1&i&&yt(0,"app-query-stage",29),2&i){const e=t.$implicit,n=Re();fe("queryStage",e)("qsList",n.containerModel.stages)}}function nDe(i,t){if(1&i){const e=Wi();Z(0,"div",30),yt(1,"mat-divider"),Z(2,"button",31),je("click",function(){return gt(e),Re().onMoveQueryContainerDownButtonClicked()}),Z(3,"mat-icon"),ue(4,"access_time"),J(),Z(5,"mat-icon"),ue(6,"keyboard_arrow_down"),J()()()}}let KJ=(()=>{class i{constructor(e,n){this.ref=n,this.trigger=!1,this.queryOptionsImage=r=>r._config.query.options.image,this.queryOptionsAudio=r=>r._config.query.options.audio,this.queryOptions3D=r=>r._config.query.options.model3d,this.queryOptionsText=r=>r._config.query.options.text,this.queryOptionsTag=r=>r._config.query.options.tag,this.queryOptionsSemantic=r=>r._config.query.options.semantic,this.queryOptionsBoolean=r=>r._config.query.options.boolean,this.queryOptionsMap=r=>r._config.query.options.map,this.queryOptionsSkeleton=r=>r._config.query.options.skeleton,e.configAsObservable.subscribe(r=>this._config=r)}get index(){return this.inList.indexOf(this.containerModel)}onRemoveButtonClicked(){const e=this.inList.indexOf(this.containerModel);e>-1&&this.inList.splice(e,1),this.listReOrder.emit(),this.triggerRedraw()}triggerRedraw(){this.trigger=!this.trigger}onToggleButtonClicked(e){this.containerModel.hasTerm(e)?this.containerModel.removeTerm(e):this.containerModel.addTerm(e),this.triggerRedraw()}onMoveQueryContainerUpButtonClicked(){if(this.isNotFirst){const e=this.index,n=this.inList[e-1];this.inList[e-1]=this.containerModel,this.inList[e]=n,this.listReOrder.emit(),this.updateFirstLast()}this.ref.detectChanges()}onMoveQueryContainerDownButtonClicked(){if(this.isNotLast){const e=this.index,n=this.inList[e+1];this.inList[e+1]=this.containerModel,this.inList[e]=n,this.listReOrder.emit(),this.updateFirstLast()}this.ref.detectChanges()}changeMode(e){this.mode=e}ngAfterContentInit(){this.listReOrder.subscribe(e=>{this.updateFirstLast(),this.ref.markForCheck()}),this.updateFirstLast()}updateFirstLast(){this.isNotFirst=this.index>0,this.isNotLast=this.index>-1&&this.index<this.inList.length-1}}return i.\u0275fac=function(e){return new(e||i)(B(dr),B(Pn))},i.\u0275cmp=ei({type:i,selectors:[["app-query-container"]],viewQuery:function(e,n){if(1&e&&ji(Zq,5),2&e){let r;jt(r=qt())&&(n.temporalDistances=r)}},inputs:{containerModel:"containerModel",inList:"inList",mode:"mode",listReOrder:"listReOrder"},decls:29,vars:39,consts:[[1,"mat-elevation-z8",2,"margin","10px","padding","10px","margin-bottom","15px","margin-top","15px","position","relative"],["mat-mini-fab","","color","warn","matTooltip","Remove query container",1,"icon-button","right-corner",3,"click"],["inline","true",2,"font-size","1.5em","vertical-align","top"],["class","temporal-modifiers",4,"ngIf"],["fxLayout","row inline","fxLayoutGap","15px","fxLayoutAlign","space-around center",2,"width","100%","padding-right","20px"],["class","icon-button","matTooltip","Toggle image query term",3,"click",4,"ngIf"],["class","icon-button","matTooltip","Toggle audio query term",3,"click",4,"ngIf"],["class","icon-button","matTooltip","Toggle 3D query term",3,"click",4,"ngIf"],["class","icon-button","matTooltip","Toggle text query term",3,"click",4,"ngIf"],["class","icon-button","matTooltip","Toggle tag query term",3,"click",4,"ngIf"],["class","icon-button","matTooltip","Toggle map query term",3,"click",4,"ngIf"],["class","icon-button","matTooltip","Toggle semantic sketch query term",3,"click",4,"ngIf"],["class","icon-button","matTooltip","Toggle boolean query term",3,"click",4,"ngIf"],["class","icon-button","matTooltip","Toggle pose query term",3,"click",4,"ngIf"],[2,"padding-top","10px"],[3,"queryStage","qsList",4,"ngFor","ngForOf"],["style","display: inline-flex;justify-content: center;align-items: center;width:100%",4,"ngIf"],[1,"temporal-modifiers"],["matTooltip","Temporally earlier...",1,"icon-button",3,"click"],[4,"ngIf"],["matTooltip","Toggle image query term",1,"icon-button",3,"click"],["matTooltip","Toggle audio query term",1,"icon-button",3,"click"],["matTooltip","Toggle 3D query term",1,"icon-button",3,"click"],["matTooltip","Toggle text query term",1,"icon-button",3,"click"],["matTooltip","Toggle tag query term",1,"icon-button",3,"click"],["matTooltip","Toggle map query term",1,"icon-button",3,"click"],["matTooltip","Toggle semantic sketch query term",1,"icon-button",3,"click"],["matTooltip","Toggle boolean query term",1,"icon-button",3,"click"],["matTooltip","Toggle pose query term",1,"icon-button",3,"click"],[3,"queryStage","qsList"],[2,"display","inline-flex","justify-content","center","align-items","center","width","100%"],["matTooltip","Temporally later...",1,"icon-button",3,"click"]],template:function(e,n){1&e&&(Z(0,"div",0)(1,"button",1),je("click",function(){return n.onRemoveButtonClicked()}),Z(2,"mat-icon",2),ue(3,"close"),J()(),Ue(4,qAe,8,1,"div",3),Z(5,"div")(6,"div",4),Ue(7,XAe,4,5,"button",5),ti(8,"GetConfigVariablePipe"),Ue(9,ZAe,4,5,"button",6),ti(10,"GetConfigVariablePipe"),Ue(11,YAe,4,5,"button",7),ti(12,"GetConfigVariablePipe"),Ue(13,KAe,4,5,"button",8),ti(14,"GetConfigVariablePipe"),Ue(15,QAe,4,5,"button",9),ti(16,"GetConfigVariablePipe"),Ue(17,JAe,4,5,"button",10),ti(18,"GetConfigVariablePipe"),Ue(19,$Ae,4,5,"button",11),ti(20,"GetConfigVariablePipe"),Ue(21,eDe,4,5,"button",12),ti(22,"GetConfigVariablePipe"),Ue(23,tDe,4,5,"button",13),ti(24,"GetConfigVariablePipe"),J()(),yt(25,"mat-divider"),Z(26,"div",14),Ue(27,iDe,1,2,"app-query-stage",15),J(),Ue(28,nDe,7,0,"div",16),J()),2&e&&(se(4),fe("ngIf",n.isNotFirst),se(3),fe("ngIf",Bs(8,12,n._config,n.queryOptionsImage)),se(2),fe("ngIf",Bs(10,15,n._config,n.queryOptionsAudio)),se(2),fe("ngIf",Bs(12,18,n._config,n.queryOptions3D)),se(2),fe("ngIf",Bs(14,21,n._config,n.queryOptionsText)),se(2),fe("ngIf",Bs(16,24,n._config,n.queryOptionsTag)),se(2),fe("ngIf",Bs(18,27,n._config,n.queryOptionsMap)),se(2),fe("ngIf",Bs(20,30,n._config,n.queryOptionsSemantic)),se(2),fe("ngIf",Bs(22,33,n._config,n.queryOptionsBoolean)),se(2),fe("ngIf",Bs(24,36,n._config,n.queryOptionsSkeleton)),se(4),fe("ngForOf",n.containerModel.stages),se(1),fe("ngIf",n.isNotLast))},directives:[Mo,Fo,vo,ms,ig,Zq,ug,oV,hg,mo,GAe],pipes:[dS,WAe],styles:["[_nghost-%COMP%]     .mat-card-header-text{margin:0!important;width:100%!important}.temporal-modifiers[_ngcontent-%COMP%]{max-width:100%}.right-corner[_ngcontent-%COMP%]{position:absolute;top:-10px;right:-10px;float:right}.temporal-arrow\\a0[_ngcontent-%COMP%] {display:inline-flex;justify-content:center;align-items:center}"],changeDetection:0}),i})();function rDe(i,t){if(1&i&&yt(0,"app-query-container",5),2&i){const e=t.$implicit,n=Re();fe("containerModel",e)("inList",n.containers)("mode",n.mode)("listReOrder",n.listReOrder)}}let sDe=(()=>{class i{constructor(e,n,r,s){this._queryService=e,this._filterService=n,this._eventBus=r,this._configService=s,this.containers=[],this._lastEnter=0,this.mode="TEMPORAL_DISTANCE",this.maxLength=600,this.listReOrder=new Si,this._config=this._configService.configAsObservable,this._config.subscribe(a=>{this.maxLength=a._config.query.temporal_max_length,this.mode=a._config.query.temporal_mode})}ngOnInit(){this.addQueryTermContainer()}ngAfterViewInit(){this._config.subscribe(e=>{this.modeChange(e._config.query.temporal_mode)}),this.queryContainers.changes.subscribe(e=>this.modeChange(this.mode))}addQueryTermContainer(){this.containers.push(new Sge),this.listReOrder.emit()}onSearchClicked(){let e=[];this.queryContainers&&this.queryContainers.length>=2&&"TEMPORAL_DISTANCE"===this.mode&&(e=this.getTemporalDistances()),this._queryService.findTemporal(this.containers,e,this.maxLength)}onClearAllClicked(){this._queryService.clear(),this._filterService.clear(),this.containers.length=0,this.addQueryTermContainer(),this._eventBus.publish(new ia(new ao(fr.CLEAR)))}keyEvent(e){if(13===e.keyCode){const n=Date.now();n-this._lastEnter<1e3?(this.onSearchClicked(),this._lastEnter=0):this._lastEnter=n}112==e.keyCode&&this.onSearchClicked(),113==e.keyCode&&this.onClearAllClicked()}getTemporalDistances(){if(this.containers.length>1&&this.mode){const e=[this.containers.length-1];let n=0;return this.queryContainers.forEach(r=>{n>0&&(e[n-1]=r.temporalDistances.first.getTemporalDistanceFromUser()),n+=1}),e}return[]}modeChange(e){this.mode=e,this.queryContainers.forEach(n=>{n.changeMode(e)})}}return i.\u0275fac=function(e){return new(e||i)(B(Rc),B(Rp),B(Zc),B(dr))},i.\u0275cmp=ei({type:i,selectors:[["app-query-sidebar"]],viewQuery:function(e,n){if(1&e&&ji(KJ,5),2&e){let r;jt(r=qt())&&(n.queryContainers=r)}},hostBindings:function(e,n){1&e&&je("keyup",function(s){return n.keyEvent(s)},!1,Ex)},decls:15,vars:7,consts:[[2,"text-align","center"],["mat-raised-button","",2,"width","100%",3,"color","click","keydown.control.enter"],["mat-raised-button","",2,"width","100%",3,"color","click"],[3,"containerModel","inList","mode","listReOrder",4,"ngFor","ngForOf"],["mat-fab","","matTooltip","Add query container",3,"click"],[3,"containerModel","inList","mode","listReOrder"]],template:function(e,n){1&e&&(Z(0,"div",0)(1,"div")(2,"button",1),je("click",function(){return n.onSearchClicked()})("keydown.control.enter",function(){return n.onSearchClicked()}),Z(3,"mat-icon"),ue(4,"search"),J(),ue(5," Search "),J()(),Z(6,"div")(7,"button",2),je("click",function(){return n.onClearAllClicked()}),Z(8,"mat-icon"),ue(9,"clear"),J(),ue(10," Clear all "),J()(),Ue(11,rDe,1,4,"app-query-container",3),Z(12,"button",4),je("click",function(){return n.addQueryTermContainer()}),Z(13,"mat-icon"),ue(14,"add"),J()()()),2&e&&(se(1),A("margin-bottom","15px"),se(1),fe("color","accent"),se(4),A("margin-bottom","15px"),se(1),fe("color","warn"),se(4),fe("ngForOf",n.containers))},directives:[Mo,vo,mo,KJ,Fo],encapsulation:2,changeDetection:0}),i})();function oDe(i,t){1&i&&hr(0)}const QJ=["*"];function aDe(i,t){}const lDe=function(i){return{animationDuration:i}},cDe=function(i,t){return{value:i,params:t}},uDe=["tabListContainer"],hDe=["tabList"],dDe=["tabListInner"],fDe=["nextPaginator"],pDe=["previousPaginator"],mDe=["tabBodyWrapper"],gDe=["tabHeader"];function _De(i,t){}function yDe(i,t){1&i&&Ue(0,_De,0,0,"ng-template",10),2&i&&fe("cdkPortalOutlet",Re().$implicit.templateLabel)}function vDe(i,t){1&i&&ue(0),2&i&&Xt(Re().$implicit.textLabel)}function bDe(i,t){if(1&i){const e=Wi();Z(0,"div",6),je("click",function(){const r=gt(e),s=r.$implicit,a=r.index,l=Re(),u=Yo(1);return l._handleClick(s,u,a)})("cdkFocusChange",function(r){const a=gt(e).index;return Re()._tabFocusChanged(r,a)}),Z(1,"div",7),Ue(2,yDe,1,1,"ng-template",8),Ue(3,vDe,1,1,"ng-template",null,9,QU),J()()}if(2&i){const e=t.$implicit,n=t.index,r=Yo(4),s=Re();N("mat-tab-label-active",s.selectedIndex===n),fe("id",s._getTabLabelId(n))("ngClass",e.labelClass)("disabled",e.disabled)("matRippleDisabled",e.disabled||s.disableRipple),Vi("tabIndex",s._getTabIndex(e,n))("aria-posinset",n+1)("aria-setsize",s._tabs.length)("aria-controls",s._getTabContentId(n))("aria-selected",s.selectedIndex===n)("aria-label",e.ariaLabel||null)("aria-labelledby",!e.ariaLabel&&e.ariaLabelledby?e.ariaLabelledby:null),se(2),fe("ngIf",e.templateLabel)("ngIfElse",r)}}function xDe(i,t){if(1&i){const e=Wi();Z(0,"mat-tab-body",11),je("_onCentered",function(){return gt(e),Re()._removeTabBodyWrapperHeight()})("_onCentering",function(r){return gt(e),Re()._setTabBodyWrapperHeight(r)}),J()}if(2&i){const e=t.$implicit,n=t.index,r=Re();N("mat-tab-body-active",r.selectedIndex===n),fe("id",r._getTabContentId(n))("ngClass",e.bodyClass)("content",e.content)("position",e.position)("origin",e.origin)("animationDuration",r.animationDuration),Vi("tabindex",null!=r.contentTabIndex&&r.selectedIndex===n?r.contentTabIndex:null)("aria-labelledby",r._getTabLabelId(n))}}const wDe=new gi("MatInkBarPositioner",{providedIn:"root",factory:function SDe(){return t=>({left:t?(t.offsetLeft||0)+"px":"0",width:t?(t.offsetWidth||0)+"px":"0"})}});let JJ=(()=>{class i{constructor(e,n,r,s){this._elementRef=e,this._ngZone=n,this._inkBarPositioner=r,this._animationMode=s}alignToElement(e){this.show(),this._ngZone.onStable.pipe(Qr(1)).subscribe(()=>{const n=this._inkBarPositioner(e),r=this._elementRef.nativeElement;r.style.left=n.left,r.style.width=n.width})}show(){this._elementRef.nativeElement.style.visibility="visible"}hide(){this._elementRef.nativeElement.style.visibility="hidden"}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(Rn),B(wDe),B(ga,8))},i.\u0275dir=Be({type:i,selectors:[["mat-ink-bar"]],hostAttrs:[1,"mat-ink-bar"],hostVars:2,hostBindings:function(e,n){2&e&&N("_mat-animation-noopable","NoopAnimations"===n._animationMode)}}),i})();const CDe=new gi("MatTabContent"),$J=new gi("MatTabLabel"),e$=new gi("MAT_TAB");let MDe=(()=>{class i extends Gle{constructor(e,n,r){super(e,n),this._closestTab=r}}return i.\u0275fac=function(e){return new(e||i)(B(Xo),B(Ko),B(e$,8))},i.\u0275dir=Be({type:i,selectors:[["","mat-tab-label",""],["","matTabLabel",""]],features:[Sn([{provide:$J,useExisting:i}]),It]}),i})();const TDe=Hf(class{}),t$=new gi("MAT_TAB_GROUP");let LE=(()=>{class i extends TDe{constructor(e,n){super(),this._viewContainerRef=e,this._closestTabGroup=n,this.textLabel="",this._contentPortal=null,this._stateChanges=new ii,this.position=null,this.origin=null,this.isActive=!1}get templateLabel(){return this._templateLabel}set templateLabel(e){this._setTemplateLabelInput(e)}get content(){return this._contentPortal}ngOnChanges(e){(e.hasOwnProperty("textLabel")||e.hasOwnProperty("disabled"))&&this._stateChanges.next()}ngOnDestroy(){this._stateChanges.complete()}ngOnInit(){this._contentPortal=new Ep(this._explicitContent||this._implicitContent,this._viewContainerRef)}_setTemplateLabelInput(e){e&&e._closestTab===this&&(this._templateLabel=e)}}return i.\u0275fac=function(e){return new(e||i)(B(Ko),B(t$,8))},i.\u0275cmp=ei({type:i,selectors:[["mat-tab"]],contentQueries:function(e,n,r){if(1&e&&(Er(r,$J,5),Er(r,CDe,7,Xo)),2&e){let s;jt(s=qt())&&(n.templateLabel=s.first),jt(s=qt())&&(n._explicitContent=s.first)}},viewQuery:function(e,n){if(1&e&&ji(Xo,7),2&e){let r;jt(r=qt())&&(n._implicitContent=r.first)}},inputs:{disabled:"disabled",textLabel:["label","textLabel"],ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],labelClass:"labelClass",bodyClass:"bodyClass"},exportAs:["matTab"],features:[Sn([{provide:e$,useExisting:i}]),It,Ls],ngContentSelectors:QJ,decls:1,vars:0,template:function(e,n){1&e&&(As(),Ue(0,oDe,1,0,"ng-template"))},encapsulation:2}),i})();const EDe={translateTab:Xd("translateTab",[Cl("center, void, left-origin-center, right-origin-center",Xs({transform:"none"})),Cl("left",Xs({transform:"translate3d(-100%, 0, 0)",minHeight:"1px"})),Cl("right",Xs({transform:"translate3d(100%, 0, 0)",minHeight:"1px"})),Ml("* => left, * => right, left => center, right => center",ql("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")),Ml("void => left-origin-center",[Xs({transform:"translate3d(-100%, 0, 0)"}),ql("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")]),Ml("void => right-origin-center",[Xs({transform:"translate3d(100%, 0, 0)"}),ql("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")])])};let ADe=(()=>{class i extends Wm{constructor(e,n,r,s){super(e,n,s),this._host=r,this._centeringSub=Q.EMPTY,this._leavingSub=Q.EMPTY}ngOnInit(){super.ngOnInit(),this._centeringSub=this._host._beforeCentering.pipe(Tl(this._host._isCenterPosition(this._host._position))).subscribe(e=>{e&&!this.hasAttached()&&this.attach(this._host._content)}),this._leavingSub=this._host._afterLeavingCenter.subscribe(()=>{this.detach()})}ngOnDestroy(){super.ngOnDestroy(),this._centeringSub.unsubscribe(),this._leavingSub.unsubscribe()}}return i.\u0275fac=function(e){return new(e||i)(B(xp),B(Ko),B(rs(()=>i$)),B(ar))},i.\u0275dir=Be({type:i,selectors:[["","matTabBodyHost",""]],features:[It]}),i})(),DDe=(()=>{class i{constructor(e,n,r){this._elementRef=e,this._dir=n,this._dirChangeSubscription=Q.EMPTY,this._translateTabComplete=new ii,this._onCentering=new Si,this._beforeCentering=new Si,this._afterLeavingCenter=new Si,this._onCentered=new Si(!0),this.animationDuration="500ms",n&&(this._dirChangeSubscription=n.change.subscribe(s=>{this._computePositionAnimationState(s),r.markForCheck()})),this._translateTabComplete.pipe(xk((s,a)=>s.fromState===a.fromState&&s.toState===a.toState)).subscribe(s=>{this._isCenterPosition(s.toState)&&this._isCenterPosition(this._position)&&this._onCentered.emit(),this._isCenterPosition(s.fromState)&&!this._isCenterPosition(this._position)&&this._afterLeavingCenter.emit()})}set position(e){this._positionIndex=e,this._computePositionAnimationState()}ngOnInit(){"center"==this._position&&null!=this.origin&&(this._position=this._computePositionFromOrigin(this.origin))}ngOnDestroy(){this._dirChangeSubscription.unsubscribe(),this._translateTabComplete.complete()}_onTranslateTabStarted(e){const n=this._isCenterPosition(e.toState);this._beforeCentering.emit(n),n&&this._onCentering.emit(this._elementRef.nativeElement.clientHeight)}_getLayoutDirection(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}_isCenterPosition(e){return"center"==e||"left-origin-center"==e||"right-origin-center"==e}_computePositionAnimationState(e=this._getLayoutDirection()){this._position=this._positionIndex<0?"ltr"==e?"left":"right":this._positionIndex>0?"ltr"==e?"right":"left":"center"}_computePositionFromOrigin(e){const n=this._getLayoutDirection();return"ltr"==n&&e<=0||"rtl"==n&&e>0?"left-origin-center":"right-origin-center"}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(Ia,8),B(Pn))},i.\u0275dir=Be({type:i,inputs:{_content:["content","_content"],origin:"origin",animationDuration:"animationDuration",position:"position"},outputs:{_onCentering:"_onCentering",_beforeCentering:"_beforeCentering",_afterLeavingCenter:"_afterLeavingCenter",_onCentered:"_onCentered"}}),i})(),i$=(()=>{class i extends DDe{constructor(e,n,r){super(e,n,r)}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(Ia,8),B(Pn))},i.\u0275cmp=ei({type:i,selectors:[["mat-tab-body"]],viewQuery:function(e,n){if(1&e&&ji(Wm,5),2&e){let r;jt(r=qt())&&(n._portalHost=r.first)}},hostAttrs:[1,"mat-tab-body"],features:[It],decls:3,vars:6,consts:[["cdkScrollable","",1,"mat-tab-body-content"],["content",""],["matTabBodyHost",""]],template:function(e,n){1&e&&(Z(0,"div",0,1),je("@translateTab.start",function(s){return n._onTranslateTabStarted(s)})("@translateTab.done",function(s){return n._translateTabComplete.next(s)}),Ue(2,aDe,0,0,"ng-template",2),J()),2&e&&fe("@translateTab",function FU(i,t,e,n,r){return HU(Di(),Vl(),i,t,e,n,r)}(3,cDe,n._position,yb(1,lDe,n.animationDuration)))},directives:[ADe],styles:['.mat-tab-body-content{height:100%;overflow:auto}.mat-tab-group-dynamic-height .mat-tab-body-content{overflow:hidden}.mat-tab-body-content[style*="visibility: hidden"]{display:none}\n'],encapsulation:2,data:{animation:[EDe.translateTab]}}),i})();const n$=new gi("MAT_TABS_CONFIG"),RDe=Hf(class{});let r$=(()=>{class i extends RDe{constructor(e){super(),this.elementRef=e}focus(){this.elementRef.nativeElement.focus()}getOffsetLeft(){return this.elementRef.nativeElement.offsetLeft}getOffsetWidth(){return this.elementRef.nativeElement.offsetWidth}}return i.\u0275fac=function(e){return new(e||i)(B(ai))},i.\u0275dir=Be({type:i,selectors:[["","matTabLabelWrapper",""]],hostVars:3,hostBindings:function(e,n){2&e&&(Vi("aria-disabled",!!n.disabled),N("mat-tab-disabled",n.disabled))},inputs:{disabled:"disabled"},features:[It]}),i})();const s$=ly({passive:!0});let IDe=(()=>{class i{constructor(e,n,r,s,a,l,u){this._elementRef=e,this._changeDetectorRef=n,this._viewportRuler=r,this._dir=s,this._ngZone=a,this._platform=l,this._animationMode=u,this._scrollDistance=0,this._selectedIndexChanged=!1,this._destroyed=new ii,this._showPaginationControls=!1,this._disableScrollAfter=!0,this._disableScrollBefore=!0,this._stopScrolling=new ii,this.disablePagination=!1,this._selectedIndex=0,this.selectFocusedIndex=new Si,this.indexFocused=new Si,a.runOutsideAngular(()=>{os(e.nativeElement,"mouseleave").pipe($n(this._destroyed)).subscribe(()=>{this._stopInterval()})})}get selectedIndex(){return this._selectedIndex}set selectedIndex(e){e=Qo(e),this._selectedIndex!=e&&(this._selectedIndexChanged=!0,this._selectedIndex=e,this._keyManager&&this._keyManager.updateActiveItem(e))}ngAfterViewInit(){os(this._previousPaginator.nativeElement,"touchstart",s$).pipe($n(this._destroyed)).subscribe(()=>{this._handlePaginatorPress("before")}),os(this._nextPaginator.nativeElement,"touchstart",s$).pipe($n(this._destroyed)).subscribe(()=>{this._handlePaginatorPress("after")})}ngAfterContentInit(){const e=this._dir?this._dir.change:Qn("ltr"),n=this._viewportRuler.change(150),r=()=>{this.updatePagination(),this._alignInkBarToSelectedTab()};this._keyManager=new Mk(this._items).withHorizontalOrientation(this._getLayoutDirection()).withHomeAndEnd().withWrap(),this._keyManager.updateActiveItem(this._selectedIndex),this._ngZone.onStable.pipe(Qr(1)).subscribe(r),uo(e,n,this._items.changes).pipe($n(this._destroyed)).subscribe(()=>{this._ngZone.run(()=>Promise.resolve().then(r)),this._keyManager.withHorizontalOrientation(this._getLayoutDirection())}),this._keyManager.change.pipe($n(this._destroyed)).subscribe(s=>{this.indexFocused.emit(s),this._setTabFocus(s)})}ngAfterContentChecked(){this._tabLabelCount!=this._items.length&&(this.updatePagination(),this._tabLabelCount=this._items.length,this._changeDetectorRef.markForCheck()),this._selectedIndexChanged&&(this._scrollToLabel(this._selectedIndex),this._checkScrollingControls(),this._alignInkBarToSelectedTab(),this._selectedIndexChanged=!1,this._changeDetectorRef.markForCheck()),this._scrollDistanceChanged&&(this._updateTabScrollPosition(),this._scrollDistanceChanged=!1,this._changeDetectorRef.markForCheck())}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete(),this._stopScrolling.complete()}_handleKeydown(e){if(!dc(e))switch(e.keyCode){case 13:case 32:this.focusIndex!==this.selectedIndex&&(this.selectFocusedIndex.emit(this.focusIndex),this._itemSelected(e));break;default:this._keyManager.onKeydown(e)}}_onContentChanges(){const e=this._elementRef.nativeElement.textContent;e!==this._currentTextContent&&(this._currentTextContent=e||"",this._ngZone.run(()=>{this.updatePagination(),this._alignInkBarToSelectedTab(),this._changeDetectorRef.markForCheck()}))}updatePagination(){this._checkPaginationEnabled(),this._checkScrollingControls(),this._updateTabScrollPosition()}get focusIndex(){return this._keyManager?this._keyManager.activeItemIndex:0}set focusIndex(e){!this._isValidIndex(e)||this.focusIndex===e||!this._keyManager||this._keyManager.setActiveItem(e)}_isValidIndex(e){if(!this._items)return!0;const n=this._items?this._items.toArray()[e]:null;return!!n&&!n.disabled}_setTabFocus(e){if(this._showPaginationControls&&this._scrollToLabel(e),this._items&&this._items.length){this._items.toArray()[e].focus();const n=this._tabListContainer.nativeElement;n.scrollLeft="ltr"==this._getLayoutDirection()?0:n.scrollWidth-n.offsetWidth}}_getLayoutDirection(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}_updateTabScrollPosition(){if(this.disablePagination)return;const e=this.scrollDistance,n="ltr"===this._getLayoutDirection()?-e:e;this._tabList.nativeElement.style.transform=`translateX(${Math.round(n)}px)`,(this._platform.TRIDENT||this._platform.EDGE)&&(this._tabListContainer.nativeElement.scrollLeft=0)}get scrollDistance(){return this._scrollDistance}set scrollDistance(e){this._scrollTo(e)}_scrollHeader(e){return this._scrollTo(this._scrollDistance+("before"==e?-1:1)*this._tabListContainer.nativeElement.offsetWidth/3)}_handlePaginatorClick(e){this._stopInterval(),this._scrollHeader(e)}_scrollToLabel(e){if(this.disablePagination)return;const n=this._items?this._items.toArray()[e]:null;if(!n)return;const r=this._tabListContainer.nativeElement.offsetWidth,{offsetLeft:s,offsetWidth:a}=n.elementRef.nativeElement;let l,u;"ltr"==this._getLayoutDirection()?(l=s,u=l+a):(u=this._tabListInner.nativeElement.offsetWidth-s,l=u-a);const h=this.scrollDistance,m=this.scrollDistance+r;l<h?this.scrollDistance-=h-l+60:u>m&&(this.scrollDistance+=u-m+60)}_checkPaginationEnabled(){if(this.disablePagination)this._showPaginationControls=!1;else{const e=this._tabListInner.nativeElement.scrollWidth>this._elementRef.nativeElement.offsetWidth;e||(this.scrollDistance=0),e!==this._showPaginationControls&&this._changeDetectorRef.markForCheck(),this._showPaginationControls=e}}_checkScrollingControls(){this.disablePagination?this._disableScrollAfter=this._disableScrollBefore=!0:(this._disableScrollBefore=0==this.scrollDistance,this._disableScrollAfter=this.scrollDistance==this._getMaxScrollDistance(),this._changeDetectorRef.markForCheck())}_getMaxScrollDistance(){return this._tabListInner.nativeElement.scrollWidth-this._tabListContainer.nativeElement.offsetWidth||0}_alignInkBarToSelectedTab(){const e=this._items&&this._items.length?this._items.toArray()[this.selectedIndex]:null,n=e?e.elementRef.nativeElement:null;n?this._inkBar.alignToElement(n):this._inkBar.hide()}_stopInterval(){this._stopScrolling.next()}_handlePaginatorPress(e,n){n&&null!=n.button&&0!==n.button||(this._stopInterval(),ay(650,100).pipe($n(uo(this._stopScrolling,this._destroyed))).subscribe(()=>{const{maxScrollDistance:r,distance:s}=this._scrollHeader(e);(0===s||s>=r)&&this._stopInterval()}))}_scrollTo(e){if(this.disablePagination)return{maxScrollDistance:0,distance:0};const n=this._getMaxScrollDistance();return this._scrollDistance=Math.max(0,Math.min(n,e)),this._scrollDistanceChanged=!0,this._checkScrollingControls(),{maxScrollDistance:n,distance:this._scrollDistance}}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(Pn),B(Tp),B(Ia,8),B(Rn),B(ta),B(ga,8))},i.\u0275dir=Be({type:i,inputs:{disablePagination:"disablePagination"}}),i})(),LDe=(()=>{class i extends IDe{constructor(e,n,r,s,a,l,u){super(e,n,r,s,a,l,u),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(e){this._disableRipple=tn(e)}_itemSelected(e){e.preventDefault()}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(Pn),B(Tp),B(Ia,8),B(Rn),B(ta),B(ga,8))},i.\u0275dir=Be({type:i,inputs:{disableRipple:"disableRipple"},features:[It]}),i})(),ODe=(()=>{class i extends LDe{constructor(e,n,r,s,a,l,u){super(e,n,r,s,a,l,u)}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(Pn),B(Tp),B(Ia,8),B(Rn),B(ta),B(ga,8))},i.\u0275cmp=ei({type:i,selectors:[["mat-tab-header"]],contentQueries:function(e,n,r){if(1&e&&Er(r,r$,4),2&e){let s;jt(s=qt())&&(n._items=s)}},viewQuery:function(e,n){if(1&e&&(ji(JJ,7),ji(uDe,7),ji(hDe,7),ji(dDe,7),ji(fDe,5),ji(pDe,5)),2&e){let r;jt(r=qt())&&(n._inkBar=r.first),jt(r=qt())&&(n._tabListContainer=r.first),jt(r=qt())&&(n._tabList=r.first),jt(r=qt())&&(n._tabListInner=r.first),jt(r=qt())&&(n._nextPaginator=r.first),jt(r=qt())&&(n._previousPaginator=r.first)}},hostAttrs:[1,"mat-tab-header"],hostVars:4,hostBindings:function(e,n){2&e&&N("mat-tab-header-pagination-controls-enabled",n._showPaginationControls)("mat-tab-header-rtl","rtl"==n._getLayoutDirection())},inputs:{selectedIndex:"selectedIndex"},outputs:{selectFocusedIndex:"selectFocusedIndex",indexFocused:"indexFocused"},features:[It],ngContentSelectors:QJ,decls:14,vars:10,consts:[["aria-hidden","true","type","button","mat-ripple","","tabindex","-1",1,"mat-tab-header-pagination","mat-tab-header-pagination-before","mat-elevation-z4",3,"matRippleDisabled","disabled","click","mousedown","touchend"],["previousPaginator",""],[1,"mat-tab-header-pagination-chevron"],[1,"mat-tab-label-container",3,"keydown"],["tabListContainer",""],["role","tablist",1,"mat-tab-list",3,"cdkObserveContent"],["tabList",""],[1,"mat-tab-labels"],["tabListInner",""],["aria-hidden","true","type","button","mat-ripple","","tabindex","-1",1,"mat-tab-header-pagination","mat-tab-header-pagination-after","mat-elevation-z4",3,"matRippleDisabled","disabled","mousedown","click","touchend"],["nextPaginator",""]],template:function(e,n){1&e&&(As(),Z(0,"button",0,1),je("click",function(){return n._handlePaginatorClick("before")})("mousedown",function(s){return n._handlePaginatorPress("before",s)})("touchend",function(){return n._stopInterval()}),yt(2,"div",2),J(),Z(3,"div",3,4),je("keydown",function(s){return n._handleKeydown(s)}),Z(5,"div",5,6),je("cdkObserveContent",function(){return n._onContentChanges()}),Z(7,"div",7,8),hr(9),J(),yt(10,"mat-ink-bar"),J()(),Z(11,"button",9,10),je("mousedown",function(s){return n._handlePaginatorPress("after",s)})("click",function(){return n._handlePaginatorClick("after")})("touchend",function(){return n._stopInterval()}),yt(13,"div",2),J()),2&e&&(N("mat-tab-header-pagination-disabled",n._disableScrollBefore),fe("matRippleDisabled",n._disableScrollBefore||n.disableRipple)("disabled",n._disableScrollBefore||null),se(5),N("_mat-animation-noopable","NoopAnimations"===n._animationMode),se(6),N("mat-tab-header-pagination-disabled",n._disableScrollAfter),fe("matRippleDisabled",n._disableScrollAfter||n.disableRipple)("disabled",n._disableScrollAfter||null))},directives:[hh,wk,JJ],styles:[".mat-tab-header{display:flex;overflow:hidden;position:relative;flex-shrink:0}.mat-tab-header-pagination{-webkit-user-select:none;user-select:none;position:relative;display:none;justify-content:center;align-items:center;min-width:32px;cursor:pointer;z-index:2;-webkit-tap-highlight-color:transparent;touch-action:none;box-sizing:content-box;background:none;border:none;outline:0;padding:0}.mat-tab-header-pagination::-moz-focus-inner{border:0}.mat-tab-header-pagination-controls-enabled .mat-tab-header-pagination{display:flex}.mat-tab-header-pagination-before,.mat-tab-header-rtl .mat-tab-header-pagination-after{padding-left:4px}.mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,.mat-tab-header-rtl .mat-tab-header-pagination-after .mat-tab-header-pagination-chevron{transform:rotate(-135deg)}.mat-tab-header-rtl .mat-tab-header-pagination-before,.mat-tab-header-pagination-after{padding-right:4px}.mat-tab-header-rtl .mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,.mat-tab-header-pagination-after .mat-tab-header-pagination-chevron{transform:rotate(45deg)}.mat-tab-header-pagination-chevron{border-style:solid;border-width:2px 2px 0 0;height:8px;width:8px}.mat-tab-header-pagination-disabled{box-shadow:none;cursor:default}.mat-tab-list{flex-grow:1;position:relative;transition:transform 500ms cubic-bezier(0.35, 0, 0.25, 1)}.mat-ink-bar{position:absolute;bottom:0;height:2px;transition:500ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable.mat-ink-bar{transition:none;animation:none}.mat-tab-group-inverted-header .mat-ink-bar{bottom:auto;top:0}.cdk-high-contrast-active .mat-ink-bar{outline:solid 2px;height:0}.mat-tab-labels{display:flex}[mat-align-tabs=center]>.mat-tab-header .mat-tab-labels{justify-content:center}[mat-align-tabs=end]>.mat-tab-header .mat-tab-labels{justify-content:flex-end}.mat-tab-label-container{display:flex;flex-grow:1;overflow:hidden;z-index:1}._mat-animation-noopable.mat-tab-list{transition:none;animation:none}.mat-tab-label{height:48px;padding:0 24px;cursor:pointer;box-sizing:border-box;opacity:.6;min-width:160px;text-align:center;display:inline-flex;justify-content:center;align-items:center;white-space:nowrap;position:relative}.mat-tab-label:focus{outline:none}.mat-tab-label:focus:not(.mat-tab-disabled){opacity:1}.cdk-high-contrast-active .mat-tab-label:focus{outline:dotted 2px;outline-offset:-2px}.mat-tab-label.mat-tab-disabled{cursor:default}.cdk-high-contrast-active .mat-tab-label.mat-tab-disabled{opacity:.5}.mat-tab-label .mat-tab-label-content{display:inline-flex;justify-content:center;align-items:center;white-space:nowrap}.cdk-high-contrast-active .mat-tab-label{opacity:1}@media(max-width: 599px){.mat-tab-label{min-width:72px}}\n"],encapsulation:2}),i})(),FDe=0;class BDe{}const NDe=Vf(uh(class{constructor(i){this._elementRef=i}}),"primary");let HDe=(()=>{class i extends NDe{constructor(e,n,r,s){var a;super(e),this._changeDetectorRef=n,this._animationMode=s,this._tabs=new ey,this._indexToSelect=0,this._lastFocusedTabIndex=null,this._tabBodyWrapperHeight=0,this._tabsSubscription=Q.EMPTY,this._tabLabelSubscription=Q.EMPTY,this._selectedIndex=null,this.headerPosition="above",this.selectedIndexChange=new Si,this.focusChange=new Si,this.animationDone=new Si,this.selectedTabChange=new Si(!0),this._groupId=FDe++,this.animationDuration=r&&r.animationDuration?r.animationDuration:"500ms",this.disablePagination=!(!r||null==r.disablePagination)&&r.disablePagination,this.dynamicHeight=!(!r||null==r.dynamicHeight)&&r.dynamicHeight,this.contentTabIndex=null!==(a=null==r?void 0:r.contentTabIndex)&&void 0!==a?a:null}get dynamicHeight(){return this._dynamicHeight}set dynamicHeight(e){this._dynamicHeight=tn(e)}get selectedIndex(){return this._selectedIndex}set selectedIndex(e){this._indexToSelect=Qo(e,null)}get animationDuration(){return this._animationDuration}set animationDuration(e){this._animationDuration=/^\d+$/.test(e+"")?e+"ms":e}get contentTabIndex(){return this._contentTabIndex}set contentTabIndex(e){this._contentTabIndex=Qo(e,null)}get backgroundColor(){return this._backgroundColor}set backgroundColor(e){const n=this._elementRef.nativeElement;n.classList.remove(`mat-background-${this.backgroundColor}`),e&&n.classList.add(`mat-background-${e}`),this._backgroundColor=e}ngAfterContentChecked(){const e=this._indexToSelect=this._clampTabIndex(this._indexToSelect);if(this._selectedIndex!=e){const n=null==this._selectedIndex;if(!n){this.selectedTabChange.emit(this._createChangeEvent(e));const r=this._tabBodyWrapper.nativeElement;r.style.minHeight=r.clientHeight+"px"}Promise.resolve().then(()=>{this._tabs.forEach((r,s)=>r.isActive=s===e),n||(this.selectedIndexChange.emit(e),this._tabBodyWrapper.nativeElement.style.minHeight="")})}this._tabs.forEach((n,r)=>{n.position=r-e,null!=this._selectedIndex&&0==n.position&&!n.origin&&(n.origin=e-this._selectedIndex)}),this._selectedIndex!==e&&(this._selectedIndex=e,this._lastFocusedTabIndex=null,this._changeDetectorRef.markForCheck())}ngAfterContentInit(){this._subscribeToAllTabChanges(),this._subscribeToTabLabels(),this._tabsSubscription=this._tabs.changes.subscribe(()=>{const e=this._clampTabIndex(this._indexToSelect);if(e===this._selectedIndex){const n=this._tabs.toArray();let r;for(let s=0;s<n.length;s++)if(n[s].isActive){this._indexToSelect=this._selectedIndex=s,this._lastFocusedTabIndex=null,r=n[s];break}!r&&n[e]&&Promise.resolve().then(()=>{n[e].isActive=!0,this.selectedTabChange.emit(this._createChangeEvent(e))})}this._changeDetectorRef.markForCheck()})}_subscribeToAllTabChanges(){this._allTabs.changes.pipe(Tl(this._allTabs)).subscribe(e=>{this._tabs.reset(e.filter(n=>n._closestTabGroup===this||!n._closestTabGroup)),this._tabs.notifyOnChanges()})}ngOnDestroy(){this._tabs.destroy(),this._tabsSubscription.unsubscribe(),this._tabLabelSubscription.unsubscribe()}realignInkBar(){this._tabHeader&&this._tabHeader._alignInkBarToSelectedTab()}updatePagination(){this._tabHeader&&this._tabHeader.updatePagination()}focusTab(e){const n=this._tabHeader;n&&(n.focusIndex=e)}_focusChanged(e){this._lastFocusedTabIndex=e,this.focusChange.emit(this._createChangeEvent(e))}_createChangeEvent(e){const n=new BDe;return n.index=e,this._tabs&&this._tabs.length&&(n.tab=this._tabs.toArray()[e]),n}_subscribeToTabLabels(){this._tabLabelSubscription&&this._tabLabelSubscription.unsubscribe(),this._tabLabelSubscription=uo(...this._tabs.map(e=>e._stateChanges)).subscribe(()=>this._changeDetectorRef.markForCheck())}_clampTabIndex(e){return Math.min(this._tabs.length-1,Math.max(e||0,0))}_getTabLabelId(e){return`mat-tab-label-${this._groupId}-${e}`}_getTabContentId(e){return`mat-tab-content-${this._groupId}-${e}`}_setTabBodyWrapperHeight(e){if(!this._dynamicHeight||!this._tabBodyWrapperHeight)return;const n=this._tabBodyWrapper.nativeElement;n.style.height=this._tabBodyWrapperHeight+"px",this._tabBodyWrapper.nativeElement.offsetHeight&&(n.style.height=e+"px")}_removeTabBodyWrapperHeight(){const e=this._tabBodyWrapper.nativeElement;this._tabBodyWrapperHeight=e.clientHeight,e.style.height="",this.animationDone.emit()}_handleClick(e,n,r){e.disabled||(this.selectedIndex=n.focusIndex=r)}_getTabIndex(e,n){var r;return e.disabled?null:n===(null!==(r=this._lastFocusedTabIndex)&&void 0!==r?r:this.selectedIndex)?0:-1}_tabFocusChanged(e,n){e&&"mouse"!==e&&"touch"!==e&&(this._tabHeader.focusIndex=n)}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(Pn),B(n$,8),B(ga,8))},i.\u0275dir=Be({type:i,inputs:{dynamicHeight:"dynamicHeight",selectedIndex:"selectedIndex",headerPosition:"headerPosition",animationDuration:"animationDuration",contentTabIndex:"contentTabIndex",disablePagination:"disablePagination",backgroundColor:"backgroundColor"},outputs:{selectedIndexChange:"selectedIndexChange",focusChange:"focusChange",animationDone:"animationDone",selectedTabChange:"selectedTabChange"},features:[It]}),i})(),QI=(()=>{class i extends HDe{constructor(e,n,r,s){super(e,n,r,s)}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(Pn),B(n$,8),B(ga,8))},i.\u0275cmp=ei({type:i,selectors:[["mat-tab-group"]],contentQueries:function(e,n,r){if(1&e&&Er(r,LE,5),2&e){let s;jt(s=qt())&&(n._allTabs=s)}},viewQuery:function(e,n){if(1&e&&(ji(mDe,5),ji(gDe,5)),2&e){let r;jt(r=qt())&&(n._tabBodyWrapper=r.first),jt(r=qt())&&(n._tabHeader=r.first)}},hostAttrs:[1,"mat-tab-group"],hostVars:4,hostBindings:function(e,n){2&e&&N("mat-tab-group-dynamic-height",n.dynamicHeight)("mat-tab-group-inverted-header","below"===n.headerPosition)},inputs:{color:"color",disableRipple:"disableRipple"},exportAs:["matTabGroup"],features:[Sn([{provide:t$,useExisting:i}]),It],decls:6,vars:7,consts:[[3,"selectedIndex","disableRipple","disablePagination","indexFocused","selectFocusedIndex"],["tabHeader",""],["class","mat-tab-label mat-focus-indicator","role","tab","matTabLabelWrapper","","mat-ripple","","cdkMonitorElementFocus","",3,"id","mat-tab-label-active","ngClass","disabled","matRippleDisabled","click","cdkFocusChange",4,"ngFor","ngForOf"],[1,"mat-tab-body-wrapper"],["tabBodyWrapper",""],["role","tabpanel",3,"id","mat-tab-body-active","ngClass","content","position","origin","animationDuration","_onCentered","_onCentering",4,"ngFor","ngForOf"],["role","tab","matTabLabelWrapper","","mat-ripple","","cdkMonitorElementFocus","",1,"mat-tab-label","mat-focus-indicator",3,"id","ngClass","disabled","matRippleDisabled","click","cdkFocusChange"],[1,"mat-tab-label-content"],[3,"ngIf","ngIfElse"],["tabTextLabel",""],[3,"cdkPortalOutlet"],["role","tabpanel",3,"id","ngClass","content","position","origin","animationDuration","_onCentered","_onCentering"]],template:function(e,n){1&e&&(Z(0,"mat-tab-header",0,1),je("indexFocused",function(s){return n._focusChanged(s)})("selectFocusedIndex",function(s){return n.selectedIndex=s}),Ue(2,bDe,5,15,"div",2),J(),Z(3,"div",3,4),Ue(5,xDe,1,10,"mat-tab-body",5),J()),2&e&&(fe("selectedIndex",n.selectedIndex||0)("disableRipple",n.disableRipple)("disablePagination",n.disablePagination),se(2),fe("ngForOf",n._tabs),se(1),N("_mat-animation-noopable","NoopAnimations"===n._animationMode),se(2),fe("ngForOf",n._tabs))},directives:[ODe,i$,mo,r$,hh,Vce,Cp,ms,Wm],styles:[".mat-tab-group{display:flex;flex-direction:column;max-width:100%}.mat-tab-group.mat-tab-group-inverted-header{flex-direction:column-reverse}.mat-tab-label{height:48px;padding:0 24px;cursor:pointer;box-sizing:border-box;opacity:.6;min-width:160px;text-align:center;display:inline-flex;justify-content:center;align-items:center;white-space:nowrap;position:relative}.mat-tab-label:focus{outline:none}.mat-tab-label:focus:not(.mat-tab-disabled){opacity:1}.cdk-high-contrast-active .mat-tab-label:focus{outline:dotted 2px;outline-offset:-2px}.mat-tab-label.mat-tab-disabled{cursor:default}.cdk-high-contrast-active .mat-tab-label.mat-tab-disabled{opacity:.5}.mat-tab-label .mat-tab-label-content{display:inline-flex;justify-content:center;align-items:center;white-space:nowrap}.cdk-high-contrast-active .mat-tab-label{opacity:1}@media(max-width: 599px){.mat-tab-label{padding:0 12px}}@media(max-width: 959px){.mat-tab-label{padding:0 12px}}.mat-tab-group[mat-stretch-tabs]>.mat-tab-header .mat-tab-label{flex-basis:0;flex-grow:1}.mat-tab-body-wrapper{position:relative;overflow:hidden;display:flex;transition:height 500ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable.mat-tab-body-wrapper{transition:none;animation:none}.mat-tab-body{top:0;left:0;right:0;bottom:0;position:absolute;display:block;overflow:hidden;outline:0;flex-basis:100%}.mat-tab-body.mat-tab-body-active{position:relative;overflow-x:hidden;overflow-y:auto;z-index:1;flex-grow:1}.mat-tab-group.mat-tab-group-dynamic-height .mat-tab-body.mat-tab-body-active{overflow-y:hidden}\n"],encapsulation:2}),i})(),a$=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[ka,jn,O1,zf,H1,nN],jn]}),i})();function VDe(i,t){if(1&i&&yt(0,"div"),2&i){const e=t.$implicit;A("width",Re().getWidth(e))("height","10px")("background-color",e.displayColor)}}let zDe=(()=>{class i{constructor(){this.features=[]}getTotal(){return this.features.map(e=>e.weightPercentage).reduce((e,n)=>e+n)}getWidth(e){return e.weightPercentage/this.getTotal()+"%"}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=ei({type:i,selectors:[["app-weight-distribution"]],inputs:{features:"features"},decls:2,vars:1,consts:[[1,"weight-distribution"],[3,"width","height","background-color",4,"ngFor","ngForOf"]],template:function(e,n){1&e&&(Z(0,"div",0),Ue(1,VDe,1,6,"div",1),J()),2&e&&(se(1),fe("ngForOf",n.features))},directives:[mo],encapsulation:2}),i})(),UDe=(()=>{class i{transform(e){return null==e?new Array:Array.from(e).sort((n,r)=>n<r?-1:n>r?1:0)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275pipe=Hn({name:"sortStringSet",type:i,pure:!0}),i})();function GDe(i,t){if(1&i){const e=Wi();Z(0,"div",16)(1,"span",7),ue(2),J(),Z(3,"mat-slider",17),je("change",function(r){const a=gt(e).$implicit;return Re(2).onValueChanged(a,r)}),J(),Z(4,"span",7),ue(5),J()()}if(2&i){const e=t.$implicit;A("color",e.displayColor),se(2),Xt(e.name),se(1),_o("value",e.weightPercentage),fe("max",100)("min",0),se(2),ui(" ",e.weightPercentage,"%")}}function WDe(i,t){1&i&&yt(0,"app-weight-distribution",18),2&i&&fe("features",Re().ngIf)}function jDe(i,t){if(1&i){const e=Wi();Z(0,"mat-checkbox",19),je("change",function(r){const a=gt(e).$implicit;return Re(2).onTypeFilterChanged(a,r)}),ue(1),J()}if(2&i){const e=t.$implicit;fe("checked",Re(2)._filterService.mediatypes.get(e))("name",e),se(1),Xt(e)}}function qDe(i,t){if(1&i){const e=Wi();Z(0,"mat-checkbox",19),je("change",function(r){const a=gt(e).$implicit;return Re(2).onTagFilterChanged(a,r)}),ue(1),J()}if(2&i){const e=t.$implicit;fe("checked",Re(2)._filterService.filterTags.has(e))("name",e.name),se(1),Xt(e.name)}}function XDe(i,t){if(1&i){const e=Wi();Z(0,"mat-checkbox",24),je("change",function(r){const a=gt(e).$implicit,l=Re(2).$implicit;return Re(2).onMetadataFilterChanged(l.key,a,r)}),ue(1),J()}if(2&i){const e=t.$implicit,n=Re(2).$implicit;fe("checked",Re(2).mdFilterChecked(n.key,e)),se(1),Xt(e)}}function ZDe(i,t){if(1&i&&(Z(0,"div",22),Ue(1,XDe,2,2,"mat-checkbox",23),ti(2,"sortStringSet"),J()),2&i){const e=Re().$implicit,n=Re(2);se(1),fe("ngForOf",Qi(2,1,n.checkboxOptions(e.value)))}}function YDe(i,t){if(1&i){const e=Wi();Z(0,"div",25)(1,"form",26)(2,"mat-form-field",27)(3,"mat-label"),ue(4,"Minimum"),J(),Z(5,"input",28),je("input",function(r){gt(e);const s=Re().$implicit;return Re(2).minValue(s.key,r.target.value)}),J(),Z(6,"mat-hint",29)(7,"strong"),ue(8),J()()(),Z(9,"mat-form-field",27)(10,"mat-label"),ue(11,"Maximum"),J(),Z(12,"input",28),je("input",function(r){gt(e);const s=Re().$implicit;return Re(2).maxValue(s.key,r.target.value)}),J(),Z(13,"mat-hint",29)(14,"strong"),ue(15),J()()()()()}if(2&i){const e=Re().$implicit,n=Re(2);se(5),_o("placeholder",n.sliderObject(e.value).min),fe("value",n.min(e.key)),se(3),ui("Minimum: ",n.sliderObject(e.value).sliderOptions().floor,""),se(4),_o("placeholder",n.sliderObject(e.value).max),fe("value",n.max(e.key)),se(3),ui("Maximum: ",n.sliderObject(e.value).sliderOptions().ceil,"")}}function KDe(i,t){if(1&i){const e=Wi();Z(0,"div")(1,"mat-slide-toggle",11),je("change",function(r){const a=gt(e).$implicit;return Re(2).onFilterCategoryToggle(a.key,r)}),ue(2),J(),Ue(3,ZDe,3,3,"div",20),Ue(4,YDe,16,6,"div",21),yt(5,"br"),J()}if(2&i){const e=t.$implicit,n=Re(2);se(1),fe("checked",n.mdShowFilterCategory(e.key)),se(1),Xt(e.key),se(1),fe("ngIf",n.mdShowFilterCategory(e.key)&&n.isCheckbox(e.value)),se(1),fe("ngIf",n.mdShowFilterCategory(e.key)&&n.isSlider(e.value))}}function QDe(i,t){if(1&i){const e=Wi();Z(0,"div")(1,"h3",1),ue(2,"Weights"),J(),Ue(3,GDe,6,7,"div",2),Ue(4,WDe,1,1,"app-weight-distribution",3),Z(5,"h3",1),ue(6,"Filters"),J(),Z(7,"div")(8,"h5",4),ue(9,"Display only objects of type:"),J(),Z(10,"section",5),Ue(11,jDe,2,3,"mat-checkbox",6),J()(),yt(12,"br"),Z(13,"div")(14,"h5",4),ue(15,"Display only objects with score above:"),J(),Z(16,"span",7),ue(17,"Threshold"),J(),Z(18,"mat-slider",8),je("change",function(r){return gt(e),Re().onThresholdValueChanges(r)})("valueChange",function(r){return gt(e),Re()._filterService.threshold=r}),J(),Z(19,"span",7),ue(20),J()(),yt(21,"br"),Z(22,"div")(23,"h5",4),ue(24,"Display only objects with tagged segment:"),J(),Z(25,"section",5),Ue(26,qDe,2,3,"mat-checkbox",6),J()(),yt(27,"br"),Z(28,"div")(29,"h5",4),ue(30,"Display only items with id:"),J(),Z(31,"mat-form-field",9)(32,"input",10),je("ngModelChange",function(r){return gt(e),Re().idFilterValue=r}),J()()(),Z(33,"h3",1),ue(34,"Metadata Filter Configuration"),J(),Z(35,"mat-slide-toggle",11),je("change",function(r){return gt(e),Re().onMdCatOperatorChange(r)}),ue(36,"Use OR for multiple categories "),J(),yt(37,"mat-divider",12),Z(38,"button",13),je("click",function(){return gt(e),Re().resetFilters()}),ue(39,"Reset All Filters "),J(),Z(40,"h3",14),ue(41,"Metadata Filters"),J(),Ue(42,KDe,6,4,"div",15),ti(43,"keyvalue"),ti(44,"async"),J()}if(2&i){const e=t.ngIf,n=Re();se(3),fe("ngForOf",e),se(1),fe("ngIf",e.length>0),se(7),fe("ngForOf",n._filterService.mediatypeKeys),se(7),fe("value",n._filterService.threshold)("max",1)("min",0)("step",.01),se(2),ui("",100*n._filterService.threshold,"%"),se(6),fe("ngForOf",n._selectionService._available),se(6),fe("ngModel",n.idFilterValue),se(3),fe("checked",n._filterService._useOrForMetadataCategoriesFilter),se(7),fe("ngForOf",Qi(43,12,Qi(44,14,n._metadata)))}}function JDe(i,t){1&i&&(Z(0,"div")(1,"p",30),ue(2,"No results available. Execute a query first and/or wait for incoming results."),J()())}let $De=(()=>{class i{constructor(e,n,r,s,a,l){this._queryService=e,this._filterService=n,this._eventBusService=r,this._configService=s,this._selectionService=a,this._cdr=l,this.filtersEnabled=new Map,this._features=aa,this.mdFilterOn=[]}ngOnInit(){this._queryServiceSubscription=this._queryService.observable.pipe(vr(e=>["STARTED","CLEAR"].indexOf(e)>-1)).subscribe(e=>this.onQueryStartEnd(e))}ngOnDestroy(){this._queryServiceSubscription.unsubscribe(),this._queryServiceSubscription=null}onQueryStartEnd(e){"STARTED"===e?(this._features=this._queryService.results.featuresAsObservable,this._features.forEach(()=>this._cdr.markForCheck()),this._metadata=this._queryService.results.metadataAsObservable(this._configService),this._metadata.forEach(()=>this._cdr.markForCheck())):"CLEAR"===e&&(this._features=aa,this._metadata=aa)}onValueChanged(e,n){this._queryService.results?Promise.resolve(this._queryService.results).then(r=>{e.weightPercentage=n.value,this._queryService.results.rerank();const s=new Map;s.set("w:weights",r.features),this._eventBusService.publish(new ia(new ao(fr.REFINE,s)))}):console.warn("no results in queryService, ignoring change")}onTypeFilterChanged(e,n){if(!this._queryService.results)return;this._filterService.mediatypes.set(e,n.checked),this._filterService.update();const r=new Map;r.set("f:type","mediaType"),r.set("f:value",`${n.checked?"+":"-"}${e.toLowerCase()}`),this._eventBusService.publish(new ia(new ao(fr.FILTER)))}onColorFilterChanged(e,n){if(!this._queryService.results)return;this._filterService.dominant.set(e,n.checked),this._filterService.update();const r=new Map;r.set("f:type","dominantColor"),r.set("f:value",`${n.checked?"+":"-"}${e.toLowerCase()}`),this._eventBusService.publish(new ia(new ao(fr.FILTER,r)))}onMetadataFilterChanged(e,n,r){if(!this._queryService.results)return;this._filterService.filterMetadata.has(e)?r.checked?this._filterService.filterMetadata.get(e).add(n):(this._filterService.filterMetadata.get(e).delete(n),0===this._filterService.filterMetadata.get(e).size&&this._filterService.filterMetadata.delete(e)):r.checked&&this._filterService.filterMetadata.set(e,(new Set).add(n)),this._filterService.update();const s=new Map;s.set("f:type","metadata"),s.set("f:value",`${r.checked?"+":"-"}${e.toLowerCase()}:${n.toLowerCase()}`),this._eventBusService.publish(new ia(new ao(fr.FILTER)))}resetFilters(){this._filterService.clear()}mdFilterChecked(e,n){return!!this._filterService.filterMetadata.has(e)&&this._filterService.filterMetadata.get(e).has(n)}mdShowFilterCategory(e){return!this.filtersEnabled.has(e)||this.filtersEnabled.get(e)}onFilterCategoryToggle(e,n){this.filtersEnabled.set(e,n.checked),this._filterService.filterRangeMetadata.delete(e),this._filterService.filterMetadata.delete(e),this._filterService.update();const r=new Map;r.set("f:type","filterCategory"),r.set("f:value",`${n.checked?"+":"-"}${e}`),this._eventBusService.publish(new ia(new ao(fr.FILTER)))}set idFilterValue(e){this._idFilterValue=e,this._filterService._filters.id=e,this._filterService.update();const n=new Map;n.set("f:type","id"),n.set("f:value",`${e}`),this._eventBusService.publish(new ia(new ao(fr.FILTER)))}onMdCatOperatorChange(e){this._filterService._filters.useOrForMetadataCategoriesFilter=e.checked,this._filterService.update();const n=new Map;n.set("f:type","metadata_categoryfilter"),n.set("f:value",`${e.checked}`),this._eventBusService.publish(new ia(new ao(fr.FILTER)))}onThresholdValueChanges(e){this._filterService.update();const n=new Map;n.set("f:type","scoreThreshold"),n.set("f:value",`${e.value}`),this._eventBusService.publish(new ia(new ao(fr.FILTER,n)))}isCheckbox(e){return e.type===$m.CHECKBOX}isSlider(e){return e.type===$m.SLIDER}sliderObject(e){return e}checkboxOptions(e){return e.options}minValue(e,n){const r=this._filterService.filterRangeMetadata.get(e);this._filterService.filterRangeMetadata.set(e,r?[n,r[1]]:[n,null]),this.update();const s=new Map;s.set("f:type","metadata:min"),s.set("f:value",`${e}'-'}${n}`),this._eventBusService.publish(new ia(new ao(fr.FILTER)))}min(e){return this._filterService.filterRangeMetadata.get(e)&&this._filterService.filterRangeMetadata.get(e)[0]?this._filterService.filterRangeMetadata.get(e)[0].toString():""}max(e){return this._filterService.filterRangeMetadata.get(e)&&this._filterService.filterRangeMetadata.get(e)[1]?this._filterService.filterRangeMetadata.get(e)[1].toString():""}update(){clearTimeout(this._timer),this._timer=setTimeout(()=>{this._filterService.update()},100)}maxValue(e,n){const r=this._filterService.filterRangeMetadata.get(e);this._filterService.filterRangeMetadata.set(e,r?[r[0],n]:[null,n]),this.update();const s=new Map;s.set("f:type","metadata:max"),s.set("f:value",`${e}'-'}${n}`),this._eventBusService.publish(new ia(new ao(fr.FILTER)))}onTagFilterChanged(e,n){n.checked?this._filterService.filterTags.add(e):this._filterService.filterTags.delete(e),this._filterService.update();const r=new Map;r.set("f:type","tagfilter"),r.set("f:value",`${e.name}':'}${n.checked}`),this._eventBusService.publish(new ia(new ao(fr.FILTER)))}}return i.\u0275fac=function(e){return new(e||i)(B(Rc),B(Rp),B(Zc),B(dr),B(Bh),B(Pn))},i.\u0275cmp=ei({type:i,selectors:[["app-refinement"]],decls:6,vars:6,consts:[[4,"ngIf"],[1,"mat-h3"],["class","slider-group",3,"color",4,"ngFor","ngForOf"],[3,"features",4,"ngIf"],[1,"mat-h5"],[1,"checkbox-group"],[3,"checked","name","change",4,"ngFor","ngForOf"],[1,"label","constrained"],[3,"value","max","min","step","change","valueChange"],[1,"textinput"],["matInput","","placeholder","id",3,"ngModel","ngModelChange"],[3,"checked","change"],[2,"margin-top","5px","margin-bottom","5px"],["color","primary","mat-raised-button","",2,"width","100%",3,"click"],[1,"mat-h3",2,"margin-top","10px"],[4,"ngFor","ngForOf"],[1,"slider-group"],[3,"max","min","value","change"],[3,"features"],[3,"checked","name","change"],["class","scrolling-checkbox-list",4,"ngIf"],["style","width: 90%;",4,"ngIf"],[1,"scrolling-checkbox-list"],["class","scrolling-checkbox-item",3,"checked","change",4,"ngFor","ngForOf"],[1,"scrolling-checkbox-item",3,"checked","change"],[2,"width","90%"],[1,"example-form"],[2,"width","40%"],["type","number","matInput","",3,"value","placeholder","input"],["align","start"],[1,"text-muted"]],template:function(e,n){1&e&&(Z(0,"h3"),ue(1,"Query refinement"),J(),Ue(2,QDe,45,16,"div",0),ti(3,"async"),Ue(4,JDe,3,0,"div",0),ti(5,"async")),2&e&&(se(2),fe("ngIf",Qi(3,2,n._features)),se(2),fe("ngIf",!Qi(5,4,n._features)))},directives:[ms,mo,Ey,zDe,b4,og,Ty,Bf,ah,lh,v4,ig,Mo,SG,lG,Cb,EP,vme],pipes:[Xc,h1,UDe],styles:[".constrained[_ngcontent-%COMP%]{max-width:100px;overflow:hidden;text-overflow:ellipsis}.checkbox-group[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,50% [col-start])}.checkbox-group[_ngcontent-%COMP%]   mat-checkbox[_ngcontent-%COMP%]{width:100px}.scrolling-checkbox-item[_ngcontent-%COMP%]{padding-left:10px;padding-right:10px}"],changeDetection:0}),i})(),eRe=(()=>{class i{constructor(e,n,r,s){this._configService=e,this._db=n,this._submissionService=r,this._cdr=s,this.maxLength=600,this.cineast=a=>a.cineastEndpointWs,this.hostThumbnails=a=>a._config.resources.host_thumbnails,this.hostObjects=a=>a._config.resources.host_objects,this.mode=a=>a._config.query.temporal_mode,this.defaultContainerDist=a=>a._config.query.default_temporal_distance}onModeChanged(e){this._configService.config._config.query.temporal_mode=e,this._configService.publishChanges()}onMaxLengthSaveClicked(){this._configService.config._config.query.temporal_max_length=this.maxLength,this._configService.publishChanges()}onResetButtonClicked(){this._configService.load()}onDownloadResultsLog(){this.onLogDownload("results",this._resultsLogTable)}onDownloadQueryLog(){this.onLogDownload("queries",this._queryLogTable)}onDownloadDRESInteractionLog(){this.onLogDownload("dres-interaction",this._dresInteractionLogTable)}onDownloadDRESResultsLog(){this.onLogDownload("dres-results",this._dresResultsLogTable)}onDownloadDRESSubmissionLog(){this.onLogDownload("dres-submission",this._dresSubmissionLogTable)}onLogDownload(e,n){const r=[];xr(n.orderBy("id").each((s,a)=>{r.push(s)})).pipe(Xl(),Ui(()=>{const s=new DW,a={base64:!1,binary:!1,date:new Date,createFolders:!1,dir:!1};for(let l=0;l<r.length;l++)s.file(`vitrivrng-${e}-log_${l}.json`,JSON.stringify(r[l],null,2),a);return s})).subscribe(s=>{s.generateAsync({type:"blob",compression:"DEFLATE"}).then(a=>{window.open(window.URL.createObjectURL(a))},a=>{console.log(a)})})}onClearDRESInteractionLog(){this._dresInteractionLogTable.clear().then(()=>console.log("DRES Interaction logs cleared."))}onClearDRESSubmissionLog(){this._dresSubmissionLogTable.clear().then(()=>console.log("DRES Submission logs cleared."))}onClearDRESResultsLog(){this._dresResultsLogTable.clear().then(()=>console.log("DRES Results logs cleared."))}onClearResultsLog(){this._resultsLogTable.clear().then(()=>console.log("Results logs cleared."))}onClearQueryLog(){this._queryLogTable.clear().then(()=>console.log("Query logs cleared."))}ngAfterContentInit(){this._configService.configAsObservable.subscribe(e=>{this._config=e,this.maxLength=e._config.query.temporal_max_length}),this._resultsLogTable=this._db.db.table("log_results"),this._queryLogTable=this._db.db.table("log_queries"),this._dresResultsLogTable=this._db.db.table("log_results_dres"),this._dresInteractionLogTable=this._db.db.table("log_interaction_dres"),this._dresSubmissionLogTable=this._db.db.table("log_submission_dres")}}return i.\u0275fac=function(e){return new(e||i)(B(dr),B(Fh),B(sg),B(Pn))},i.\u0275cmp=ei({type:i,selectors:[["app-preferences"]],decls:105,vars:23,consts:[["dense",""],["mat-subheader",""],["mat-line","",1,"mat-h3"],["mat-line",""],["fxLayoutAlign","center"],[3,"value","selectionChange"],["matTooltip","Sequential temporal scoring",3,"value"],["matTooltip","Time distance temporal scoring",3,"value"],["matInput","","type","number","value","30","matTooltip","Set the maximal length of a temporal sequence",2,"text-align","right",3,"ngModel","ngModelChange"],["matSuffix",""],["color","primary","mat-raised-button","","matTooltip","Change the maximal length of a temporal sequence",3,"click"],["fxLayout","row","fxLayoutAlign","center"],["color","warn","mat-raised-button","","matTooltip","Reset and reload settings from server",3,"click"],["mat-raised-button","","matTooltip","Download vitrivr-ng Results Log",3,"click"],["color","warn","mat-raised-button","","matTooltip","Clear vitrivr-ng Results Log",3,"click"],["mat-raised-button","","matTooltip","Download vitrivr-ng Query Log",3,"click"],["color","warn","mat-raised-button","","matTooltip","Clear vitrivr-ng Query Log",3,"click"],["mat-raised-button","","matTooltip","Download DRES Interaction Log",3,"click"],["color","warn","mat-raised-button","","matTooltip","Clear DRES Interaction Log",3,"click"],["mat-raised-button","","matTooltip","Download DRES Result Log",3,"click"],["color","warn","mat-raised-button","","matTooltip","Clear DRES Result Log",3,"click"],["mat-raised-button","","matTooltip","Download DRES Submission Log",3,"click"],["color","warn","mat-raised-button","","matTooltip","Clear DRES Submission Log",3,"click"]],template:function(e,n){1&e&&(Z(0,"h3"),ue(1,"Preferences"),J(),Z(2,"mat-list",0)(3,"h2",1),ue(4,"Cineast"),J(),Z(5,"mat-list-item"),ue(6),ti(7,"GetConfigVariablePipe"),J(),Z(8,"h2",1),ue(9,"Resources"),J(),Z(10,"mat-list-item")(11,"div",2),ue(12,"Objects:"),J(),Z(13,"div",3),ue(14),ti(15,"GetConfigVariablePipe"),J()(),Z(16,"mat-list-item")(17,"div",2),ue(18,"Thumbnails:"),J(),Z(19,"div",3),ue(20),ti(21,"GetConfigVariablePipe"),J()(),yt(22,"mat-divider"),Z(23,"h2",1),ue(24,"Temporal mode"),J(),Z(25,"mat-list-item")(26,"mat-form-field",4)(27,"mat-select",5),je("selectionChange",function(s){return n.onModeChanged(s.value)}),ti(28,"GetConfigVariablePipe"),Z(29,"mat-option",6),ue(30,"sequential"),J(),Z(31,"mat-option",7),ue(32,"temporal distance "),J()()()(),Z(33,"h2",1),ue(34,"Max sequence length"),J(),Z(35,"mat-list-item")(36,"mat-form-field",4)(37,"input",8),je("ngModelChange",function(s){return n.maxLength=s}),J(),Z(38,"span",9),ue(39,"sec."),J()()(),Z(40,"mat-list-item")(41,"button",10),je("click",function(){return n.onMaxLengthSaveClicked()}),ue(42,"Set "),J()(),Z(43,"h2",1),ue(44,"Temporal Query Defaults"),J(),Z(45,"mat-list-item"),ue(46),ti(47,"GetConfigVariablePipe"),J(),yt(48,"mat-divider"),Z(49,"h2",1),ue(50,"Reset settings"),J(),Z(51,"mat-list-item",11)(52,"button",12),je("click",function(){return n.onResetButtonClicked()}),ue(53,"Reset "),J()()(),Z(54,"h3"),ue(55,"vitrivr-ng Logs"),J(),Z(56,"mat-list",0)(57,"h2",1),ue(58,"Result log"),J(),Z(59,"mat-list-item",11)(60,"button",13),je("click",function(){return n.onDownloadResultsLog()}),Z(61,"mat-icon"),ue(62,"cloud_download"),J()(),Z(63,"button",14),je("click",function(){return n.onClearResultsLog()}),Z(64,"mat-icon"),ue(65,"delete"),J()()(),Z(66,"h2",1),ue(67,"Query log"),J(),Z(68,"mat-list-item",11)(69,"button",15),je("click",function(){return n.onDownloadQueryLog()}),Z(70,"mat-icon"),ue(71,"cloud_download"),J()(),Z(72,"button",16),je("click",function(){return n.onClearQueryLog()}),Z(73,"mat-icon"),ue(74,"delete"),J()()()(),Z(75,"h3"),ue(76,"DRES Logs"),J(),Z(77,"mat-list",0)(78,"h2",1),ue(79,"vitrivr-ng DRES Interaction log"),J(),Z(80,"mat-list-item",11)(81,"button",17),je("click",function(){return n.onDownloadDRESInteractionLog()}),Z(82,"mat-icon"),ue(83,"cloud_download"),J()(),Z(84,"button",18),je("click",function(){return n.onClearDRESInteractionLog()}),Z(85,"mat-icon"),ue(86,"delete"),J()()(),Z(87,"h2",1),ue(88,"DRES Results log"),J(),Z(89,"mat-list-item",11)(90,"button",19),je("click",function(){return n.onDownloadDRESResultsLog()}),Z(91,"mat-icon"),ue(92,"cloud_download"),J()(),Z(93,"button",20),je("click",function(){return n.onClearDRESResultsLog()}),Z(94,"mat-icon"),ue(95,"delete"),J()()(),Z(96,"h2",1),ue(97,"DRES Submission log"),J(),Z(98,"mat-list-item",11)(99,"button",21),je("click",function(){return n.onDownloadDRESSubmissionLog()}),Z(100,"mat-icon"),ue(101,"cloud_download"),J()(),Z(102,"button",22),je("click",function(){return n.onClearDRESSubmissionLog()}),Z(103,"mat-icon"),ue(104,"delete"),J()()()()),2&e&&(se(6),Xt(Bs(7,8,n._config,n.cineast)),se(8),Xt(Bs(15,11,n._config,n.hostObjects)),se(6),Xt(Bs(21,14,n._config,n.hostThumbnails)),se(7),fe("value",Bs(28,17,n._config,n.mode)),se(2),fe("value","SEQUENTIAL"),se(2),fe("value","TEMPORAL_DISTANCE"),se(6),fe("ngModel",n.maxLength),se(9),ui("Default container distance: ",Bs(47,20,n._config,n.defaultContainerDist),""))},directives:[nS,Vj,Jb,Hb,ig,og,hg,C4,Vb,Fo,Ty,WR,Bf,ah,lh,GH,Mo,ug,vo],pipes:[dS],encapsulation:2,changeDetection:0}),i})(),tRe=(()=>{class i{transform(e,n){return e.colorForRelevance(n)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275pipe=Hn({name:"ColorForRelevancePipe",type:i,pure:!0}),i})();function iRe(i,t){1&i&&(Z(0,"div")(1,"p",1),ue(2,"No items highlighted!"),J()())}function nRe(i,t){if(1&i){const e=Wi();Z(0,"button",7),je("click",function(){const s=gt(e).$implicit,a=Re().$implicit;return Re(2).onTagButtonClicked(a[0],s)}),Z(1,"mat-icon"),ti(2,"ColorForRelevancePipe"),ue(3,"album"),J()()}if(2&i){const e=t.$implicit;se(1),A("color",Bs(2,2,e,1))}}function rRe(i,t){if(1&i){const e=Wi();Z(0,"mat-list-item")(1,"button",5),je("click",function(){const s=gt(e).$implicit;return Re(2).onSegmentClicked(s[0])}),ue(2),J(),Ue(3,nRe,4,5,"button",6),J()}if(2&i){const e=t.$implicit;se(2),Xt(e[0]),se(1),fe("ngForOf",e[1])}}function sRe(i,t){if(1&i){const e=Wi();Z(0,"div")(1,"mat-list")(2,"mat-list-item",2)(3,"button",3),je("click",function(){return gt(e),Re().onClearSelectionClicked()}),ue(4," Clear "),J()(),Ue(5,rRe,4,2,"mat-list-item",4),ti(6,"async"),J()()}if(2&i){const e=Re();se(5),fe("ngForOf",Qi(6,1,e._selectionService).entries())}}let oRe=(()=>{class i{constructor(e,n){this._selectionService=e,this._queryService=n}onSegmentClicked(e){this._queryService.lookupSegment(e)}onTagButtonClicked(e,n){this._selectionService.remove(n,e)}onClearSelectionClicked(){this._selectionService.clear()}}return i.\u0275fac=function(e){return new(e||i)(B(Bh),B(Rc))},i.\u0275cmp=ei({type:i,selectors:[["app-selection-management"]],decls:6,vars:6,consts:[[4,"ngIf"],[1,"text-muted"],["fxLayout","row","fxLayoutAlign","center"],["color","warn","mat-raised-button","","matTooltip","Remove all highlighting",3,"click"],[4,"ngFor","ngForOf"],["mat-flat-button","",3,"click"],["mat-icon-button","",3,"click",4,"ngFor","ngForOf"],["mat-icon-button","",3,"click"]],template:function(e,n){1&e&&(Z(0,"h3"),ue(1,"Highlighted items"),J(),Ue(2,iRe,3,0,"div",0),ti(3,"async"),Ue(4,sRe,7,3,"div",0),ti(5,"async")),2&e&&(se(2),fe("ngIf",0==Qi(3,2,n._selectionService).size),se(2),fe("ngIf",Qi(5,4,n._selectionService).size>0))},directives:[ms,nS,Jb,ug,hg,Mo,Fo,mo,vo],pipes:[Xc,tRe],encapsulation:2,changeDetection:0}),i})(),l$=(()=>{class i{transform(e){return!(null===e._config.competition.host||""===e._config.competition.host)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275pipe=Hn({name:"DresEnabledPipe",type:i,pure:!0}),i})(),aRe=(()=>{class i{transform(e){const n=Math.floor(e/3600),r=Math.floor(e%3600/60),s=Math.floor(e%60);let a="";return n>0&&(a+=(n<10?"0":"")+n+":"),a+=(r<10?"0":"")+r+":",a+=(s<10?"0":"")+s,a}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275pipe=Hn({name:"formatTime",type:i,pure:!0}),i})();function lRe(i,t){if(1&i&&(Wo(0),Z(1,"h3",3),ue(2,"User Information"),J(),Z(3,"mat-list-item"),ue(4),J(),Z(5,"mat-list-item"),ue(6),J(),yt(7,"mat-divider"),Z(8,"h3",3),ue(9,"Session Information"),J(),Z(10,"mat-list-item"),ue(11),J(),Z(12,"mat-list-item"),ue(13),J(),jo()),2&i){const e=Re(2);se(4),ui("Username: ",e.dresStatus.username,""),se(2),ui("Role: ",e.dresStatus.role,""),se(5),ui("SessionID: ",null===e.dresStatus?"":e.dresStatus.sessionId,""),se(2),ui("ID: ",e.dresStatus.id,"")}}function cRe(i,t){if(1&i&&(Wo(0),yt(1,"mat-divider"),Z(2,"h3",3),ue(3,"Active Run"),J(),Z(4,"mat-list-item"),ue(5),J(),Z(6,"mat-list-item"),ue(7),J(),jo()),2&i){const e=Re(2);se(5),ui("Name: ",e.activeRun.name,""),se(2),ui("Description: ",e.activeRun.description,"")}}function uRe(i,t){if(1&i&&(Z(0,"mat-list-item")(1,"span"),ue(2),ti(3,"formatTime"),J()()),2&i){const e=Re(3);se(2),ui("Remaining Time: ",Qi(3,1,e.activeTask.remainingTime),"")}}function hRe(i,t){if(1&i&&(Wo(0),yt(1,"mat-divider"),Z(2,"h3",3),ue(3,"Active Task"),J(),Z(4,"mat-list-item")(5,"span"),ue(6),J()(),Z(7,"mat-list-item")(8,"span"),ue(9),J()(),Ue(10,uRe,4,3,"mat-list-item",1),jo()),2&i){const e=Re(2);se(6),ui("Name: ",e.activeTask.name,""),se(3),ui("Type: ",e.activeTask.taskGroup,""),se(1),fe("ngIf",e.activeTask.running)}}function dRe(i,t){if(1&i&&(Z(0,"div")(1,"mat-list-item")(2,"span",2),ue(3),ti(4,"GetConfigVariablePipe"),J()(),yt(5,"mat-divider"),Ue(6,lRe,14,4,"ng-container",1),Ue(7,cRe,8,2,"ng-container",1),Ue(8,hRe,11,3,"ng-container",1),yt(9,"mat-divider"),J()),2&i){const e=Re();se(2),fe("matBadge",e.dresStatusBadge),se(1),ui("Endpoint: ",Bs(4,5,e.config,e.dresAddress),""),se(3),fe("ngIf",e.dresStatus),se(1),fe("ngIf",e.activeRun),se(1),fe("ngIf",e.activeTask)}}let fRe=(()=>{class i{constructor(e,n,r,s,a){this._configService=e,this._notificationService=n,this.cdr=r,this._runInfo=s,this._dresService=a,this.dresStatus=null,this.dresAddress=l=>l._config.competition.host}ngAfterContentInit(){this._configService.configAsObservable.subscribe(e=>{this.config=e}),this._dresService.statusObservable().subscribe({next:e=>{e&&(this.dresStatus=e,this.cdr.markForCheck())}}),this._dresService.activeTaskObservable().subscribe(e=>{this.activeTask=e,this.cdr.markForCheck()}),this._dresService.activeRunObservable().subscribe(e=>{this.activeRun=e,this.cdr.markForCheck()}),this._notificationService.getDresStatusBadgeObservable().subscribe(e=>{this.dresStatusBadge=e,this.cdr.markForCheck()})}}return i.\u0275fac=function(e){return new(e||i)(B(dr),B(TP),B(Pn),B(VH),B(wT))},i.\u0275cmp=ei({type:i,selectors:[["app-dres-sidebar"]],decls:5,vars:3,consts:[["dense",""],[4,"ngIf"],["matBadgeOverlap","false",3,"matBadge"],["matSubheader",""]],template:function(e,n){1&e&&(Z(0,"h3"),ue(1,"DRES Information"),J(),Z(2,"mat-list",0),Ue(3,dRe,10,8,"div",1),ti(4,"DresEnabledPipe"),J()),2&e&&(se(3),fe("ngIf",Qi(4,1,n.config)))},directives:[nS,ms,Jb,UH,ig,Vj],pipes:[l$,dS,aRe],encapsulation:2,changeDetection:0}),i})();function pRe(i,t){1&i&&(Z(0,"mat-icon"),ue(1,"filter_list"),J())}function mRe(i,t){1&i&&(Z(0,"mat-icon"),ue(1,"settings"),J())}function gRe(i,t){1&i&&(Z(0,"mat-icon"),ue(1,"album"),J())}function _Re(i,t){1&i&&(Z(0,"mat-icon",6),ue(1,"cloud_queue"),J()),2&i&&fe("matBadge",Re(2).dresBadgeValue)}function yRe(i,t){1&i&&(Wo(0),Z(1,"mat-tab",5),Ue(2,_Re,2,1,"ng-template",1),yt(3,"app-dres-sidebar"),J(),jo())}let vRe=(()=>{class i{constructor(e,n){this._notificationService=e,this._configService=n,this.dresBadgeValue=Wj.getNotificationSymbol(),this.dresAddress=r=>r._config.competition.host}ngAfterContentInit(){this._configService.configAsObservable.subscribe(e=>{this.config=e}),this._notificationService.getDresStatusBadgeObservable().subscribe(e=>{this.dresBadgeValue=e})}}return i.\u0275fac=function(e){return new(e||i)(B(TP),B(dr))},i.\u0275cmp=ei({type:i,selectors:[["app-settings"]],decls:12,vars:3,consts:[["label","Refinement","matTooltip","Query refinement"],["mat-tab-label",""],["label","Preferences","matTooltip","Preferences refinement"],["label","Tags","matTooltip","Manage selections"],[4,"ngIf"],["label","DRES","matTooltip","DRES Connection Informations"],[3,"matBadge"]],template:function(e,n){1&e&&(Z(0,"mat-tab-group")(1,"mat-tab",0),Ue(2,pRe,2,0,"ng-template",1),yt(3,"app-refinement"),J(),Z(4,"mat-tab",2),Ue(5,mRe,2,0,"ng-template",1),yt(6,"app-preferences"),J(),Z(7,"mat-tab",3),Ue(8,gRe,2,0,"ng-template",1),yt(9,"app-selection-management"),J(),Ue(10,yRe,4,0,"ng-container",4),ti(11,"DresEnabledPipe"),J()),2&e&&(se(10),fe("ngIf",Qi(11,1,n.config)))},directives:[QI,LE,Fo,MDe,vo,$De,eRe,oRe,ms,UH,fRe],pipes:[l$],styles:[".mat-tab-label,   .mat-tab-label-active{min-width:0!important;padding:10px!important;margin:5px!important}"],changeDetection:0}),i})();function bRe(i,t){1&i&&(Z(0,"a",19)(1,"mat-icon"),ue(2,"grid_on"),J()())}function xRe(i,t){if(1&i){const e=Wi();Wo(0),Z(1,"button",20),je("click",function(){return gt(e),Re().showHistory()}),Z(2,"mat-icon"),ue(3,"history"),J()(),jo()}}function wRe(i,t){1&i&&(Z(0,"div"),yt(1,"app-textual-submission",23),J())}function SRe(i,t){if(1&i){const e=Wi();Wo(0),yt(1,"span",2),Ue(2,wRe,2,0,"div",10),Z(3,"button",21),je("click",function(){gt(e);const r=Re();return r.textualSubmissionOpen=!r.textualSubmissionOpen}),Z(4,"mat-icon"),ue(5,"title"),J(),Z(6,"mat-icon",22),ue(7),J()(),jo()}if(2&i){const e=Re();se(2),fe("ngIf",e.textualSubmissionOpen),se(1),fe("matTooltip",(e.textualSubmissionOpen?"Close":"Open")+" textual submission input"),se(4),Xt(e.textualSubmissionOpen?"close":"near_me")}}function CRe(i,t){1&i&&yt(0,"mat-progress-bar",24),2&i&&Vi("color","accent")}var JI=(()=>(function(i){i[i.GALLERY=0]="GALLERY",i[i.LIST=1]="LIST",i[i.TEMPORAL=2]="TEMPORAL"}(JI||(JI={})),JI))();let MRe=(()=>{class i{constructor(e,n,r,s,a,l){this._queryService=e,this._configService=n,this._bottomSheet=r,this._distinctLookupService=s,this._notificationService=a,this._cdr=l,this.settingsBadge="",this.loading=!1,this.textualSubmissionOpen=!1,this.activeView=JI.GALLERY,this.competitionHost=u=>u._config.competition.host,this.textualInput=u=>u._config.competition.textualInput,this.queryHistory=u=>u._config.query.history}ngOnInit(){this._configService.configAsObservable.subscribe(e=>{this.config=e,this.initLookup(e,this._distinctLookupService)}),this._queryService.observable.subscribe(e=>{["STARTED","ENDED","ERROR"].indexOf(e)>-1&&(this.loading=this._queryService.running)})}initLookup(e,n){e._config.query.options.boolean&&e._config.query.boolean.forEach(r=>{_a[r[1]]===_a.DYNAMICOPTIONS.valueOf()&&n.getDistinct(r.table,r.col).subscribe()})}showHistory(){this._bottomSheet.open(lde,{ariaLabel:"Show query history."})}ngAfterViewInit(){this._notificationService.getDresStatusBadgeObservable().subscribe(e=>this.settingsBadge=e)}setActiveView(e){this.activeView=e}}return i.\u0275fac=function(e){return new(e||i)(B(Rc),B(dr),B(pde),B(dH),B(TP),B(Pn))},i.\u0275cmp=ei({type:i,selectors:[["app-vitrivr"]],decls:48,vars:18,consts:[["color","primary"],["src","../assets/images/vitrivr_logo.png"],[1,"spacer-flex"],["mat-icon-button","","matTooltip","Toggle query sidebar",3,"click"],[1,"spacer-xlarge"],["mat-icon-button","","matTooltip","Gallery view","routerLink","/gallery","routerLinkActive","active","skipLocationChange","true",4,"ngIf"],[1,"spacer-medium"],["mat-icon-button","","matTooltip","Mini gallery view","routerLink","/mini-gallery","routerLinkActive","active","skipLocationChange","true",3,"color","click"],["mat-icon-button","","matTooltip","List view","routerLink","/list","routerLinkActive","active","skipLocationChange","true",3,"color","click"],["mat-icon-button","","matTooltip","Temporal Scoring view","routerLink","/temporal-list","routerLinkActive","active","skipLocationChange","true",3,"color","click"],[4,"ngIf"],["mat-icon-button","","matTooltip","Toggle query refinement sidebar",3,"matBadge","click"],["mode","query",4,"ngIf"],["fullscreen","",2,"margin-top","75px"],["mode","side",1,"left",3,"opened"],["querysidenav",""],["id","scrollable"],["mode","side","position","end",1,"right"],["settingssidenav",""],["mat-icon-button","","matTooltip","Gallery view","routerLink","/gallery","routerLinkActive","active","skipLocationChange","true"],["mat-icon-button","","matTooltip","Show query history.",3,"click"],["mat-icon-button","",3,"matTooltip","click"],[2,"transform","translate(-12px, 12px)"],["smallFont","true"],["mode","query"]],template:function(e,n){if(1&e){const r=Wi();Z(0,"mat-toolbar",0),yt(1,"img",1)(2,"span",2),Z(3,"button",3),je("click",function(){return gt(r),Yo(41).toggle()}),Z(4,"mat-icon"),ue(5,"search"),J()(),yt(6,"span",4),Ue(7,bRe,3,0,"a",5),ti(8,"GetConfigVariablePipe"),yt(9,"span",6),Z(10,"a",7),je("click",function(){return n.setActiveView(0)}),Z(11,"mat-icon"),ue(12,"view_comfy"),J()(),yt(13,"span",6),Z(14,"a",8),je("click",function(){return n.setActiveView(1)}),Z(15,"mat-icon"),ue(16,"list"),J()(),yt(17,"span",6),Z(18,"a",9),je("click",function(){return n.setActiveView(2)}),Z(19,"mat-icon"),ue(20,"access_time"),J(),Z(21,"mat-icon"),ue(22,"trending_flat"),J()(),yt(23,"span",4),Ue(24,xRe,4,0,"ng-container",10),ti(25,"GetConfigVariablePipe"),Z(26,"button",11),je("click",function(){return gt(r),Yo(46).toggle()}),Z(27,"mat-icon"),ue(28,"storage"),J()(),Ue(29,SRe,8,3,"ng-container",10),ti(30,"GetConfigVariablePipe"),yt(31,"span",2)(32,"app-dres-timer")(33,"span",6),Z(34,"app-api-status")(35,"mat-icon"),ue(36,"av timer"),J()()(),Z(37,"div"),Ue(38,CRe,1,1,"mat-progress-bar",12),J(),Z(39,"mat-sidenav-container",13)(40,"mat-sidenav",14,15),yt(42,"app-query-sidebar"),J(),Z(43,"mat-sidenav-content",16),yt(44,"router-outlet"),J(),Z(45,"mat-sidenav",17,18),yt(47,"app-settings"),J()()}2&e&&(se(7),fe("ngIf",!Bs(8,9,n.config,n.competitionHost)),se(3),fe("color",0===n.activeView?"accent":""),se(4),fe("color",1===n.activeView?"accent":""),se(4),fe("color",2===n.activeView?"accent":""),se(6),fe("ngIf",Bs(25,12,n.config,n.queryHistory)>0),se(2),fe("matBadge",n.settingsBadge),se(3),fe("ngIf",Bs(30,15,n.config,n.textualInput)),se(9),fe("ngIf",n.loading),se(2),fe("opened",!0))},directives:[My,Mo,Fo,vo,ms,A7,SP,U9,UH,kme,Ime,Yme,kP,Mq,Cq,sDe,JH,EH,vRe],pipes:[dS],styles:["mat-sidenav[_ngcontent-%COMP%]{width:300px;padding:10px;min-width:100px}mat-sidenav.left[_ngcontent-%COMP%]{margin-right:10px}mat-sidenav.right[_ngcontent-%COMP%]{margin-left:10px}.vitrivr-toolbar-menu[_ngcontent-%COMP%]{padding:0 14px;color:#fff}"],changeDetection:0}),i})(),$I=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[Oo,Za]]}),i})(),c$=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[jn],jn]}),i})();function TRe(i,t){if(1&i&&(Zu(),yt(0,"circle",4)),2&i){const e=Re(),n=Yo(1);A("animation-name","mat-progress-spinner-stroke-rotate-"+e._spinnerAnimationLabel)("stroke-dashoffset",e._getStrokeDashOffset(),"px")("stroke-dasharray",e._getStrokeCircumference(),"px")("stroke-width",e._getCircleStrokeWidth(),"%")("transform-origin",e._getCircleTransformOrigin(n)),Vi("r",e._getCircleRadius())}}function ERe(i,t){if(1&i&&(Zu(),yt(0,"circle",4)),2&i){const e=Re(),n=Yo(1);A("stroke-dashoffset",e._getStrokeDashOffset(),"px")("stroke-dasharray",e._getStrokeCircumference(),"px")("stroke-width",e._getCircleStrokeWidth(),"%")("transform-origin",e._getCircleTransformOrigin(n)),Vi("r",e._getCircleRadius())}}const DRe=Vf(class{constructor(i){this._elementRef=i}},"primary"),RRe=new gi("mat-progress-spinner-default-options",{providedIn:"root",factory:function kRe(){return{diameter:100}}});class sf extends DRe{constructor(t,e,n,r,s,a,l,u){super(t),this._document=n,this._diameter=100,this._value=0,this._resizeSubscription=Q.EMPTY,this.mode="determinate";const h=sf._diameters;this._spinnerAnimationLabel=this._getSpinnerAnimationLabel(),h.has(n.head)||h.set(n.head,new Set([100])),this._noopAnimations="NoopAnimations"===r&&!!s&&!s._forceAnimations,"mat-spinner"===t.nativeElement.nodeName.toLowerCase()&&(this.mode="indeterminate"),s&&(s.diameter&&(this.diameter=s.diameter),s.strokeWidth&&(this.strokeWidth=s.strokeWidth)),e.isBrowser&&e.SAFARI&&l&&a&&u&&(this._resizeSubscription=l.change(150).subscribe(()=>{"indeterminate"===this.mode&&u.run(()=>a.markForCheck())}))}get diameter(){return this._diameter}set diameter(t){this._diameter=Qo(t),this._spinnerAnimationLabel=this._getSpinnerAnimationLabel(),this._styleRoot&&this._attachStyleNode()}get strokeWidth(){return this._strokeWidth||this.diameter/10}set strokeWidth(t){this._strokeWidth=Qo(t)}get value(){return"determinate"===this.mode?this._value:0}set value(t){this._value=Math.max(0,Math.min(100,Qo(t)))}ngOnInit(){const t=this._elementRef.nativeElement;this._styleRoot=BW(t)||this._document.head,this._attachStyleNode(),t.classList.add("mat-progress-spinner-indeterminate-animation")}ngOnDestroy(){this._resizeSubscription.unsubscribe()}_getCircleRadius(){return(this.diameter-10)/2}_getViewBox(){const t=2*this._getCircleRadius()+this.strokeWidth;return`0 0 ${t} ${t}`}_getStrokeCircumference(){return 2*Math.PI*this._getCircleRadius()}_getStrokeDashOffset(){return"determinate"===this.mode?this._getStrokeCircumference()*(100-this._value)/100:null}_getCircleStrokeWidth(){return this.strokeWidth/this.diameter*100}_getCircleTransformOrigin(t){var e;const n=50*(null!==(e=t.currentScale)&&void 0!==e?e:1);return`${n}% ${n}%`}_attachStyleNode(){const t=this._styleRoot,e=this._diameter,n=sf._diameters;let r=n.get(t);if(!r||!r.has(e)){const s=this._document.createElement("style");s.setAttribute("mat-spinner-animation",this._spinnerAnimationLabel),s.textContent=this._getAnimationText(),t.appendChild(s),r||(r=new Set,n.set(t,r)),r.add(e)}}_getAnimationText(){const t=this._getStrokeCircumference();return"\n @keyframes mat-progress-spinner-stroke-rotate-DIAMETER {\n    0%      { stroke-dashoffset: START_VALUE;  transform: rotate(0); }\n    12.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(0); }\n    12.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(72.5deg); }\n    25%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(72.5deg); }\n\n    25.0001%   { stroke-dashoffset: START_VALUE;  transform: rotate(270deg); }\n    37.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(270deg); }\n    37.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(161.5deg); }\n    50%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(161.5deg); }\n\n    50.0001%  { stroke-dashoffset: START_VALUE;  transform: rotate(180deg); }\n    62.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(180deg); }\n    62.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(251.5deg); }\n    75%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(251.5deg); }\n\n    75.0001%  { stroke-dashoffset: START_VALUE;  transform: rotate(90deg); }\n    87.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(90deg); }\n    87.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(341.5deg); }\n    100%    { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(341.5deg); }\n  }\n".replace(/START_VALUE/g,""+.95*t).replace(/END_VALUE/g,""+.2*t).replace(/DIAMETER/g,`${this._spinnerAnimationLabel}`)}_getSpinnerAnimationLabel(){return this.diameter.toString().replace(".","_")}}sf._diameters=new WeakMap,sf.\u0275fac=function(t){return new(t||sf)(B(ai),B(ta),B(ar,8),B(ga,8),B(RRe),B(Pn),B(Tp),B(Rn))},sf.\u0275cmp=ei({type:sf,selectors:[["mat-progress-spinner"],["mat-spinner"]],hostAttrs:["role","progressbar","tabindex","-1",1,"mat-progress-spinner","mat-spinner"],hostVars:10,hostBindings:function(t,e){2&t&&(Vi("aria-valuemin","determinate"===e.mode?0:null)("aria-valuemax","determinate"===e.mode?100:null)("aria-valuenow","determinate"===e.mode?e.value:null)("mode",e.mode),A("width",e.diameter,"px")("height",e.diameter,"px"),N("_mat-animation-noopable",e._noopAnimations))},inputs:{color:"color",diameter:"diameter",strokeWidth:"strokeWidth",mode:"mode",value:"value"},exportAs:["matProgressSpinner"],features:[It],decls:4,vars:8,consts:[["preserveAspectRatio","xMidYMid meet","focusable","false","aria-hidden","true",3,"ngSwitch"],["svg",""],["cx","50%","cy","50%",3,"animation-name","stroke-dashoffset","stroke-dasharray","stroke-width","transform-origin",4,"ngSwitchCase"],["cx","50%","cy","50%",3,"stroke-dashoffset","stroke-dasharray","stroke-width","transform-origin",4,"ngSwitchCase"],["cx","50%","cy","50%"]],template:function(t,e){1&t&&(Zu(),Z(0,"svg",0,1),Ue(2,TRe,1,11,"circle",2),Ue(3,ERe,1,9,"circle",3),J()),2&t&&(A("width",e.diameter,"px")("height",e.diameter,"px"),fe("ngSwitch","indeterminate"===e.mode),Vi("viewBox",e._getViewBox()),se(2),fe("ngSwitchCase",!0),se(1),fe("ngSwitchCase",!1))},directives:[Dw,AR],styles:[".mat-progress-spinner{display:block;position:relative;overflow:hidden}.mat-progress-spinner svg{position:absolute;transform:rotate(-90deg);top:0;left:0;transform-origin:center;overflow:visible}.mat-progress-spinner circle{fill:transparent;transition:stroke-dashoffset 225ms linear}._mat-animation-noopable.mat-progress-spinner circle{transition:none;animation:none}.cdk-high-contrast-active .mat-progress-spinner circle{stroke:CanvasText}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] svg{animation:mat-progress-spinner-linear-rotate 2000ms linear infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] svg{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition-property:stroke;animation-duration:4000ms;animation-timing-function:cubic-bezier(0.35, 0, 0.25, 1);animation-iteration-count:infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition:none;animation:none}@keyframes mat-progress-spinner-linear-rotate{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes mat-progress-spinner-stroke-rotate-100{0%{stroke-dashoffset:268.606171575px;transform:rotate(0)}12.5%{stroke-dashoffset:56.5486677px;transform:rotate(0)}12.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(72.5deg)}25%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(72.5deg)}25.0001%{stroke-dashoffset:268.606171575px;transform:rotate(270deg)}37.5%{stroke-dashoffset:56.5486677px;transform:rotate(270deg)}37.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(161.5deg)}50%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(161.5deg)}50.0001%{stroke-dashoffset:268.606171575px;transform:rotate(180deg)}62.5%{stroke-dashoffset:56.5486677px;transform:rotate(180deg)}62.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(251.5deg)}75%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(251.5deg)}75.0001%{stroke-dashoffset:268.606171575px;transform:rotate(90deg)}87.5%{stroke-dashoffset:56.5486677px;transform:rotate(90deg)}87.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(341.5deg)}100%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(341.5deg)}}\n"],encapsulation:2,changeDetection:0});let u$=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[jn,ka],jn]}),i})(),p$=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[zf,jn],jn]}),i})();const jRe=[GK,hH,jw,c$,KK,HK,NH,YJ,oH,uq,Uj,vq,KH,u$,p$,zf,M4,Tq,Qq,OK,hN,a$,tq,sH,jn];let $o=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({providers:[lT],imports:[[jRe,Iw],GK,hH,jw,c$,KK,HK,NH,YJ,oH,uq,Uj,vq,KH,u$,p$,zf,M4,Tq,Qq,OK,hN,a$,tq,sH,jn,Iw]}),i})(),m$=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[$o,Oo,Za,$I,Vye]]}),i})(),qRe=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[Oo,Za]]}),i})(),g$=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[$o,Oo,Za,qRe]]}),i})(),eL=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[Oo,Za]]}),i})(),_$=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[$o,Oo,Za,eL,$I]]}),i})(),y$=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[$o,Oo,Za]]}),i})(),C$=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[tV]]}),i})(),P$=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[tV]]}),i})(),mh=(()=>{class i{constructor(e,n){kw(n)&&!e&&console.warn("Warning: Flex Layout loaded on the server without FlexLayoutServerModule")}static withConfig(e,n=[]){return{ngModule:i,providers:e.serverLoaded?[{provide:Wf,useValue:Object.assign(Object.assign({},iV),e)},{provide:nV,useValue:n,multi:!0},{provide:pS,useValue:!0}]:[{provide:Wf,useValue:Object.assign(Object.assign({},iV),e)},{provide:nV,useValue:n,multi:!0}]}}}return i.\u0275fac=function(e){return new(e||i)(Ve(pS),Ve(kh))},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[Xq,C$,P$],Xq,C$,P$]}),i})(),I$=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[$o,mh,Oo,Za,ZR,bE]]}),i})(),L$=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[$o,Oo,Za,ZR,$I]]}),i})(),PPe=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[$o,Oo,Za,AQ,bE]]}),i})(),O$=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[$o,Oo,Za,PPe]]}),i})(),IPe=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[$o,Oo,Za,mh]]}),i})(),LPe=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[$o,mh,Oo,Za,ZR,bE]]}),i})(),OPe=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[$o,mh,Oo,Za,m$,g$,_$,y$,I$,L$,O$,IPe,LPe]]}),i})(),Qh=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[]]}),i})(),FPe=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[$o,Oo,OPe,Qh]]}),i})(),BPe=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[ka,$o,mh,Za]]}),i})(),NPe=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[$o,mh,Oo,Za,m$,g$,_$,y$,I$,L$,O$,FPe,BPe,Qh]]}),i})(),HPe=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[$o,Oo,Za,$I,NPe]]}),i})(),F$=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({providers:[dH],imports:[[Iw]]}),i})(),B$=(()=>{class i{constructor(e,n){this.eventManager=e,this.document=n,this._ctrlDown=!1,this.handleKeyDown=r=>{"Control"===r.key&&!this._ctrlDown&&(this._ctrlDown=!0,this.ctrlPressed.next(!0))},this.handleKeyUp=r=>{"Control"===r.key&&(this._ctrlDown=!1,this.ctrlPressed.next(!1))},this.eventManager.addEventListener(this.document.body,"keydown",this.handleKeyDown),this.eventManager.addEventListener(this.document.body,"keyup",this.handleKeyUp),this.ctrlPressed=new gs(!1)}}return i.\u0275fac=function(e){return new(e||i)(Ve(f1),Ve(ar))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),N$=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({providers:[Ts,Zc,hq,Fh,B$,TP,wT],imports:[[Iw,NH,jw]]}),i})(),Z0=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({providers:[sg,fH],imports:[[Xpe.forRoot(()=>new fh({basePath:dr.settings.dresEndpointRest,withCredentials:!0})),Iw,$o]]}),i})(),H$=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({providers:[Bh],imports:[[]]}),i})(),V$=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({providers:[Rc,Rp,$N],imports:[[]]}),i})(),tL=(()=>{class i{constructor(e){this._router=e,this.currentUrl="/",this._router.events.pipe(vr(n=>n instanceof sS)).subscribe(({urlAfterRedirects:n})=>{console.debug(`navigating to ${n} from ${this.currentUrl}`),this.previousUrl=this.currentUrl,this.currentUrl=n})}getPreviousRoute(){return this.previousUrl}goToRoot(){console.debug("navigating to root"),this._router.navigate(["/"])}goToPrevious(){console.debug(`navigating to previous location: ${this.getPreviousRoute()}`),this._router.navigate([this.getPreviousRoute()],{skipLocationChange:!0})}}return i.\u0275fac=function(e){return new(e||i)(Ve(Ql))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),VPe=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({providers:[iP,sg,Bh,tL],imports:[[Sj.forRoot(()=>new Kl({basePath:`${dr.settings.cineastEndpointRest}`})),F$,N$,Z0,H$,V$],Sj,F$,N$,Z0,H$,V$]}),i})(),zPe=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[$o,Oo,Za,mh,AQ,Qh,bE,nq,ZR]]}),i})();function UPe(i,t){if(1&i&&(Z(0,"div",1),ue(1),J()),2&i){const e=t.$implicit;se(1),Xt(e)}}let z$=(()=>{class i{constructor(e){this._lines=[],this._title="Metadata for "+e.segmentId,e.metadata.forEach((n,r)=>{this._lines.push(r+": "+n)}),0===e.metadata.size&&this._lines.push("No Metadata available")}get title(){return this._title}get lines(){return this._lines}}return i.\u0275fac=function(e){return new(e||i)(B(kk))},i.\u0275cmp=ei({type:i,selectors:[["app-metadata-details"]],decls:3,vars:2,consts:[["class","snackbar-feature",4,"ngFor","ngForOf"],[1,"snackbar-feature"]],template:function(e,n){1&e&&(Z(0,"h3"),ue(1),J(),Ue(2,UPe,2,1,"div",0)),2&e&&(se(1),Xt(n.title),se(1),fe("ngForOf",n.lines))},directives:[mo],styles:[".snackbar-feature[_ngcontent-%COMP%]{color:#fff;opacity:.65;font-size:1.5em;padding:5px}"]}),i})(),iL=(()=>{class i{transform(e,n=!0){return e&&0!==e.length?e.sort((r,s)=>n?s.score-r.score:r.score-s.score):[]}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275pipe=Hn({name:"OrderByScorePipe",type:i,pure:!0}),i})(),U$=(()=>{class i{transform(e,n=!0){return e&&0!==e.length?e.sort((s,a)=>n?s.startabs&&a.startabs?s.startabs-a.startabs:s.sequenceNumber-a.sequenceNumber:s.startabs&&a.startabs?a.startabs-s.startabs:a.sequenceNumber-s.sequenceNumber):[]}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275pipe=Hn({name:"OrderBySegmentPipe",type:i,pure:!0}),i})(),GPe=(()=>{class i{transform(e,n=!0){return e&&0!==e.length?e.sort((r,s)=>r.segmentId.localeCompare(s.segmentId)):[]}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275pipe=Hn({name:"OrderBySegmentIdPipe",type:i,pure:!0}),i})();var Jh=(()=>(function(i){i[i.SCORE=0]="SCORE",i[i.SEGMENT_TIME=1]="SEGMENT_TIME",i[i.SEGMENT_ID=2]="SEGMENT_ID"}(Jh||(Jh={})),Jh))();let WPe=(()=>{class i{transform(e,n=Jh.SCORE){let r;switch(n){case Jh.SCORE:r=new iL;break;case Jh.SEGMENT_TIME:r=new U$;break;case Jh.SEGMENT_ID:r=new GPe}return r.transform(e)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275pipe=Hn({name:"orderBy",type:i,pure:!0}),i})(),nL=(()=>{class i{constructor(e){this._resolverService=e}transform(e){return this._resolverService.pathToObject(e)}}return i.\u0275fac=function(e){return new(e||i)(B(Ts,16))},i.\u0275pipe=Hn({name:"ObjectPathPipe",type:i,pure:!0}),i})();const jPe=["audioplayer"],qPe=["videoplayer"],XPe=["imageviewer"];function ZPe(i,t){if(1&i){const e=Wi();Z(0,"div")(1,"button",6),je("click",function(){return gt(e),Re().onBackClick()}),Z(2,"mat-icon"),ue(3,"keyboard_backspace"),J()(),Z(4,"h2"),ue(5),J()()}if(2&i){const e=Re();A("display","inline-flex"),se(4),A("margin-top","5px"),se(1),ui("\xa0Media object: ",e.mediaobject.objectid,"")}}function YPe(i,t){if(1&i&&(yt(0,"video",7,8),ti(2,"ObjectPathPipe")),2&i){const e=Re();A("width","400px"),_o("src",Qi(2,3,e.mediaobject),Mc)}}function KPe(i,t){if(1&i&&(yt(0,"audio",9,10),ti(2,"ObjectPathPipe")),2&i){const e=Re();A("width","400px"),_o("src",Qi(2,3,e.mediaobject),Mc)}}function QPe(i,t){1&i&&(yt(0,"img",11,12),ti(2,"ObjectPathPipe")),2&i&&_o("src",Qi(2,1,Re().mediaobject),Mc)}function JPe(i,t){1&i&&(yt(0,"app-m3d-loader",13,14),ti(2,"ObjectPathPipe")),2&i&&(_o("src",Qi(2,4,Re().mediaobject)),fe("height",200)("interaction",!0)("width",200))}function $Pe(i,t){if(1&i&&(Z(0,"div")(1,"dl")(2,"dt"),ue(3,"ID"),J(),Z(4,"dd"),ue(5),J(),Z(6,"dt"),ue(7,"Filename"),J(),Z(8,"dd"),ue(9),J(),Z(10,"dt"),ue(11,"Path"),J(),Z(12,"dd")(13,"a",15),ti(14,"ObjectPathPipe"),ue(15),J()(),Z(16,"dt"),ue(17,"Mediatype"),J(),Z(18,"dd"),ue(19),J()()()),2&i){const e=Re();se(5),Xt(e.mediaobject.objectId),se(4),Xt(e.mediaobject.name),se(4),_o("href",Qi(14,5,e.mediaobject),Mc),se(2),Xt(e.mediaobject.path),se(4),Xt(e.mediaobject.mediatype)}}let G$=(()=>{class i{constructor(e,n,r){this._eventBusService=e,this._resolver=n,this._historyService=r,this.displayHeader=!0,console.debug("initializing objectviewer")}onBackClick(){this._historyService.getPreviousRoute()?this._historyService.goToPrevious():this._historyService.goToRoot()}onPlayClick(e){void 0!==this.audioplayer?(this.audioplayer.nativeElement.currentTime=e.startabs,this.audioplayer.nativeElement.play()):void 0!==this.videoplayer&&(this.videoplayer.nativeElement.currentTime=e.startabs,this.videoplayer.nativeElement.play());const n=new Map;n.set("i:mediaobject",e.objectId),n.set("i:starttime",e.startabs),this._eventBusService.publish(new ia(new ao(fr.PLAY,n)))}}return i.\u0275fac=function(e){return new(e||i)(B(Zc),B(Ts),B(tL))},i.\u0275cmp=ei({type:i,selectors:[["app-objectviewer"]],viewQuery:function(e,n){if(1&e&&(ji(jPe,5),ji(qPe,5),ji(XPe,5)),2&e){let r;jt(r=qt())&&(n.audioplayer=r.first),jt(r=qt())&&(n.videoplayer=r.first),jt(r=qt())&&(n.imageviewer=r.first)}},inputs:{mediaobject:"mediaobject",displayHeader:"displayHeader"},decls:9,vars:12,consts:[[3,"display",4,"ngIf"],["controls","",3,"width","src",4,"ngIf"],["controls","","width","400",3,"width","src",4,"ngIf"],["style","max-height: 400px",3,"src",4,"ngIf"],[3,"height","interaction","width","src",4,"ngIf"],[4,"ngIf"],["mat-icon-button","","matTooltip","Go back...",3,"click"],["controls","",3,"src"],["videoplayer",""],["controls","","width","400",3,"src"],["audioplayer",""],[2,"max-height","400px",3,"src"],["imageviewer",""],[3,"height","interaction","width","src"],["modelviewer",""],["download","",3,"href"]],template:function(e,n){1&e&&(Ue(0,ZPe,6,5,"div",0),Z(1,"div")(2,"div")(3,"div"),Ue(4,YPe,3,5,"video",1),Ue(5,KPe,3,5,"audio",2),Ue(6,QPe,3,3,"img",3),Ue(7,JPe,3,6,"app-m3d-loader",4),J()(),Ue(8,$Pe,20,7,"div",5),J()),2&e&&(fe("ngIf",n.displayHeader),se(1),A("display","flex")("justify-content","flex-start"),se(2),A("max-height","400px"),se(1),fe("ngIf","VIDEO"===n.mediaobject.mediatype),se(1),fe("ngIf","AUDIO"===n.mediaobject.mediatype),se(1),fe("ngIf","IMAGE"===n.mediaobject.mediatype),se(1),fe("ngIf","MODEL3D"===n.mediaobject.mediatype),se(1),fe("ngIf",n.mediaobject.name))},directives:[ms,Mo,Fo,vo,fI],pipes:[nL],encapsulation:2}),i})();const t2e=[[["caption"]],[["colgroup"],["col"]]],i2e=["caption","colgroup, col"];function $4(i){return class extends i{constructor(...t){super(...t),this._sticky=!1,this._hasStickyChanged=!1}get sticky(){return this._sticky}set sticky(t){const e=this._sticky;this._sticky=tn(t),this._hasStickyChanged=e!==this._sticky}hasStickyChanged(){const t=this._hasStickyChanged;return this._hasStickyChanged=!1,t}resetStickyChanged(){this._hasStickyChanged=!1}}}const fC=new gi("CDK_TABLE");let pC=(()=>{class i{constructor(e){this.template=e}}return i.\u0275fac=function(e){return new(e||i)(B(Xo))},i.\u0275dir=Be({type:i,selectors:[["","cdkCellDef",""]]}),i})(),mC=(()=>{class i{constructor(e){this.template=e}}return i.\u0275fac=function(e){return new(e||i)(B(Xo))},i.\u0275dir=Be({type:i,selectors:[["","cdkHeaderCellDef",""]]}),i})(),rL=(()=>{class i{constructor(e){this.template=e}}return i.\u0275fac=function(e){return new(e||i)(B(Xo))},i.\u0275dir=Be({type:i,selectors:[["","cdkFooterCellDef",""]]}),i})();class o2e{}const a2e=$4(o2e);let Pg=(()=>{class i extends a2e{constructor(e){super(),this._table=e,this._stickyEnd=!1}get name(){return this._name}set name(e){this._setNameInput(e)}get stickyEnd(){return this._stickyEnd}set stickyEnd(e){const n=this._stickyEnd;this._stickyEnd=tn(e),this._hasStickyChanged=n!==this._stickyEnd}_updateColumnCssClassName(){this._columnCssClassName=[`cdk-column-${this.cssClassFriendlyName}`]}_setNameInput(e){e&&(this._name=e,this.cssClassFriendlyName=e.replace(/[^a-z0-9_-]/gi,"-"),this._updateColumnCssClassName())}}return i.\u0275fac=function(e){return new(e||i)(B(fC,8))},i.\u0275dir=Be({type:i,selectors:[["","cdkColumnDef",""]],contentQueries:function(e,n,r){if(1&e&&(Er(r,pC,5),Er(r,mC,5),Er(r,rL,5)),2&e){let s;jt(s=qt())&&(n.cell=s.first),jt(s=qt())&&(n.headerCell=s.first),jt(s=qt())&&(n.footerCell=s.first)}},inputs:{sticky:"sticky",name:["cdkColumnDef","name"],stickyEnd:"stickyEnd"},features:[Sn([{provide:"MAT_SORT_HEADER_COLUMN_DEF",useExisting:i}]),It]}),i})();class ez{constructor(t,e){e.nativeElement.classList.add(...t._columnCssClassName)}}let tz=(()=>{class i extends ez{constructor(e,n){super(e,n)}}return i.\u0275fac=function(e){return new(e||i)(B(Pg),B(ai))},i.\u0275dir=Be({type:i,selectors:[["cdk-header-cell"],["th","cdk-header-cell",""]],hostAttrs:["role","columnheader",1,"cdk-header-cell"],features:[It]}),i})(),iz=(()=>{class i extends ez{constructor(e,n){var r;if(super(e,n),1===(null===(r=e._table)||void 0===r?void 0:r._elementRef.nativeElement.nodeType)){const s=e._table._elementRef.nativeElement.getAttribute("role");n.nativeElement.setAttribute("role","grid"===s||"treegrid"===s?"gridcell":"cell")}}}return i.\u0275fac=function(e){return new(e||i)(B(Pg),B(ai))},i.\u0275dir=Be({type:i,selectors:[["cdk-cell"],["td","cdk-cell",""]],hostAttrs:[1,"cdk-cell"],features:[It]}),i})();class j${constructor(){this.tasks=[],this.endTasks=[]}}const nz=new gi("_COALESCED_STYLE_SCHEDULER");let q$=(()=>{class i{constructor(e){this._ngZone=e,this._currentSchedule=null,this._destroyed=new ii}schedule(e){this._createScheduleIfNeeded(),this._currentSchedule.tasks.push(e)}scheduleEnd(e){this._createScheduleIfNeeded(),this._currentSchedule.endTasks.push(e)}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_createScheduleIfNeeded(){this._currentSchedule||(this._currentSchedule=new j$,this._getScheduleObservable().pipe($n(this._destroyed)).subscribe(()=>{for(;this._currentSchedule.tasks.length||this._currentSchedule.endTasks.length;){const e=this._currentSchedule;this._currentSchedule=new j$;for(const n of e.tasks)n();for(const n of e.endTasks)n()}this._currentSchedule=null}))}_getScheduleObservable(){return this._ngZone.isStable?xr(Promise.resolve(void 0)):this._ngZone.onStable.pipe(Qr(1))}}return i.\u0275fac=function(e){return new(e||i)(Ve(Rn))},i.\u0275prov=Nt({token:i,factory:i.\u0275fac}),i})(),rz=(()=>{class i{constructor(e,n){this.template=e,this._differs=n}ngOnChanges(e){if(!this._columnsDiffer){const n=e.columns&&e.columns.currentValue||[];this._columnsDiffer=this._differs.find(n).create(),this._columnsDiffer.diff(n)}}getColumnsDiff(){return this._columnsDiffer.diff(this.columns)}extractCellTemplate(e){return this instanceof OE?e.headerCell.template:this instanceof FE?e.footerCell.template:e.cell.template}}return i.\u0275fac=function(e){return new(e||i)(B(Xo),B(wp))},i.\u0275dir=Be({type:i,features:[Ls]}),i})();class l2e extends rz{}const c2e=$4(l2e);let OE=(()=>{class i extends c2e{constructor(e,n,r){super(e,n),this._table=r}ngOnChanges(e){super.ngOnChanges(e)}}return i.\u0275fac=function(e){return new(e||i)(B(Xo),B(wp),B(fC,8))},i.\u0275dir=Be({type:i,selectors:[["","cdkHeaderRowDef",""]],inputs:{columns:["cdkHeaderRowDef","columns"],sticky:["cdkHeaderRowDefSticky","sticky"]},features:[It,Ls]}),i})();class u2e extends rz{}const h2e=$4(u2e);let FE=(()=>{class i extends h2e{constructor(e,n,r){super(e,n),this._table=r}ngOnChanges(e){super.ngOnChanges(e)}}return i.\u0275fac=function(e){return new(e||i)(B(Xo),B(wp),B(fC,8))},i.\u0275dir=Be({type:i,selectors:[["","cdkFooterRowDef",""]],inputs:{columns:["cdkFooterRowDef","columns"],sticky:["cdkFooterRowDefSticky","sticky"]},features:[It,Ls]}),i})(),sL=(()=>{class i extends rz{constructor(e,n,r){super(e,n),this._table=r}}return i.\u0275fac=function(e){return new(e||i)(B(Xo),B(wp),B(fC,8))},i.\u0275dir=Be({type:i,selectors:[["","cdkRowDef",""]],inputs:{columns:["cdkRowDefColumns","columns"],when:["cdkRowDefWhen","when"]},features:[It]}),i})(),Ig=(()=>{class i{constructor(e){this._viewContainer=e,i.mostRecentCellOutlet=this}ngOnDestroy(){i.mostRecentCellOutlet===this&&(i.mostRecentCellOutlet=null)}}return i.mostRecentCellOutlet=null,i.\u0275fac=function(e){return new(e||i)(B(Ko))},i.\u0275dir=Be({type:i,selectors:[["","cdkCellOutlet",""]]}),i})(),sz=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=ei({type:i,selectors:[["cdk-header-row"],["tr","cdk-header-row",""]],hostAttrs:["role","row",1,"cdk-header-row"],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(e,n){1&e&&Hd(0,0)},directives:[Ig],encapsulation:2}),i})(),az=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=ei({type:i,selectors:[["cdk-row"],["tr","cdk-row",""]],hostAttrs:["role","row",1,"cdk-row"],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(e,n){1&e&&Hd(0,0)},directives:[Ig],encapsulation:2}),i})(),oL=(()=>{class i{constructor(e){this.templateRef=e,this._contentClassName="cdk-no-data-row"}}return i.\u0275fac=function(e){return new(e||i)(B(Xo))},i.\u0275dir=Be({type:i,selectors:[["ng-template","cdkNoDataRow",""]]}),i})();const X$=["top","bottom","left","right"];class d2e{constructor(t,e,n,r,s=!0,a=!0,l){this._isNativeHtmlTable=t,this._stickCellCss=e,this.direction=n,this._coalescedStyleScheduler=r,this._isBrowser=s,this._needsPositionStickyOnElement=a,this._positionListener=l,this._cachedCellWidths=[],this._borderCellCss={top:`${e}-border-elem-top`,bottom:`${e}-border-elem-bottom`,left:`${e}-border-elem-left`,right:`${e}-border-elem-right`}}clearStickyPositioning(t,e){const n=[];for(const r of t)if(r.nodeType===r.ELEMENT_NODE){n.push(r);for(let s=0;s<r.children.length;s++)n.push(r.children[s])}this._coalescedStyleScheduler.schedule(()=>{for(const r of n)this._removeStickyStyle(r,e)})}updateStickyColumns(t,e,n,r=!0){if(!t.length||!this._isBrowser||!e.some(v=>v)&&!n.some(v=>v))return void(this._positionListener&&(this._positionListener.stickyColumnsUpdated({sizes:[]}),this._positionListener.stickyEndColumnsUpdated({sizes:[]})));const s=t[0],a=s.children.length,l=this._getCellWidths(s,r),u=this._getStickyStartColumnPositions(l,e),h=this._getStickyEndColumnPositions(l,n),m=e.lastIndexOf(!0),_=n.indexOf(!0);this._coalescedStyleScheduler.schedule(()=>{const v="rtl"===this.direction,S=v?"right":"left",T=v?"left":"right";for(const I of t)for(let j=0;j<a;j++){const P=I.children[j];e[j]&&this._addStickyStyle(P,S,u[j],j===m),n[j]&&this._addStickyStyle(P,T,h[j],j===_)}this._positionListener&&(this._positionListener.stickyColumnsUpdated({sizes:-1===m?[]:l.slice(0,m+1).map((I,j)=>e[j]?I:null)}),this._positionListener.stickyEndColumnsUpdated({sizes:-1===_?[]:l.slice(_).map((I,j)=>n[j+_]?I:null).reverse()}))})}stickRows(t,e,n){if(!this._isBrowser)return;const r="bottom"===n?t.slice().reverse():t,s="bottom"===n?e.slice().reverse():e,a=[],l=[],u=[];for(let m=0,_=0;m<r.length;m++){if(!s[m])continue;a[m]=_;const v=r[m];u[m]=this._isNativeHtmlTable?Array.from(v.children):[v];const S=v.getBoundingClientRect().height;_+=S,l[m]=S}const h=s.lastIndexOf(!0);this._coalescedStyleScheduler.schedule(()=>{var m,_;for(let v=0;v<r.length;v++){if(!s[v])continue;const S=a[v],T=v===h;for(const I of u[v])this._addStickyStyle(I,n,S,T)}"top"===n?null===(m=this._positionListener)||void 0===m||m.stickyHeaderRowsUpdated({sizes:l,offsets:a,elements:u}):null===(_=this._positionListener)||void 0===_||_.stickyFooterRowsUpdated({sizes:l,offsets:a,elements:u})})}updateStickyFooterContainer(t,e){if(!this._isNativeHtmlTable)return;const n=t.querySelector("tfoot");this._coalescedStyleScheduler.schedule(()=>{e.some(r=>!r)?this._removeStickyStyle(n,["bottom"]):this._addStickyStyle(n,"bottom",0,!1)})}_removeStickyStyle(t,e){for(const r of e)t.style[r]="",t.classList.remove(this._borderCellCss[r]);X$.some(r=>-1===e.indexOf(r)&&t.style[r])?t.style.zIndex=this._getCalculatedZIndex(t):(t.style.zIndex="",this._needsPositionStickyOnElement&&(t.style.position=""),t.classList.remove(this._stickCellCss))}_addStickyStyle(t,e,n,r){t.classList.add(this._stickCellCss),r&&t.classList.add(this._borderCellCss[e]),t.style[e]=`${n}px`,t.style.zIndex=this._getCalculatedZIndex(t),this._needsPositionStickyOnElement&&(t.style.cssText+="position: -webkit-sticky; position: sticky; ")}_getCalculatedZIndex(t){const e={top:100,bottom:10,left:1,right:1};let n=0;for(const r of X$)t.style[r]&&(n+=e[r]);return n?`${n}`:""}_getCellWidths(t,e=!0){if(!e&&this._cachedCellWidths.length)return this._cachedCellWidths;const n=[],r=t.children;for(let s=0;s<r.length;s++)n.push(r[s].getBoundingClientRect().width);return this._cachedCellWidths=n,n}_getStickyStartColumnPositions(t,e){const n=[];let r=0;for(let s=0;s<t.length;s++)e[s]&&(n[s]=r,r+=t[s]);return n}_getStickyEndColumnPositions(t,e){const n=[];let r=0;for(let s=t.length;s>0;s--)e[s]&&(n[s]=r,r+=t[s]);return n}}const lz=new gi("CDK_SPL");let aL=(()=>{class i{constructor(e,n){this.viewContainer=e,this.elementRef=n}}return i.\u0275fac=function(e){return new(e||i)(B(Ko),B(ai))},i.\u0275dir=Be({type:i,selectors:[["","rowOutlet",""]]}),i})(),lL=(()=>{class i{constructor(e,n){this.viewContainer=e,this.elementRef=n}}return i.\u0275fac=function(e){return new(e||i)(B(Ko),B(ai))},i.\u0275dir=Be({type:i,selectors:[["","headerRowOutlet",""]]}),i})(),cL=(()=>{class i{constructor(e,n){this.viewContainer=e,this.elementRef=n}}return i.\u0275fac=function(e){return new(e||i)(B(Ko),B(ai))},i.\u0275dir=Be({type:i,selectors:[["","footerRowOutlet",""]]}),i})(),uL=(()=>{class i{constructor(e,n){this.viewContainer=e,this.elementRef=n}}return i.\u0275fac=function(e){return new(e||i)(B(Ko),B(ai))},i.\u0275dir=Be({type:i,selectors:[["","noDataRowOutlet",""]]}),i})(),hL=(()=>{class i{constructor(e,n,r,s,a,l,u,h,m,_,v,S){this._differs=e,this._changeDetectorRef=n,this._elementRef=r,this._dir=a,this._platform=u,this._viewRepeater=h,this._coalescedStyleScheduler=m,this._viewportRuler=_,this._stickyPositioningListener=v,this._ngZone=S,this._onDestroy=new ii,this._columnDefsByName=new Map,this._customColumnDefs=new Set,this._customRowDefs=new Set,this._customHeaderRowDefs=new Set,this._customFooterRowDefs=new Set,this._headerRowDefChanged=!0,this._footerRowDefChanged=!0,this._stickyColumnStylesNeedReset=!0,this._forceRecalculateCellWidths=!0,this._cachedRenderRowsMap=new Map,this.stickyCssClass="cdk-table-sticky",this.needsPositionStickyOnElement=!0,this._isShowingNoDataRow=!1,this._multiTemplateDataRows=!1,this._fixedLayout=!1,this.contentChanged=new Si,this.viewChange=new gs({start:0,end:Number.MAX_VALUE}),s||this._elementRef.nativeElement.setAttribute("role","table"),this._document=l,this._isNativeHtmlTable="TABLE"===this._elementRef.nativeElement.nodeName}get trackBy(){return this._trackByFn}set trackBy(e){this._trackByFn=e}get dataSource(){return this._dataSource}set dataSource(e){this._dataSource!==e&&this._switchDataSource(e)}get multiTemplateDataRows(){return this._multiTemplateDataRows}set multiTemplateDataRows(e){this._multiTemplateDataRows=tn(e),this._rowOutlet&&this._rowOutlet.viewContainer.length&&(this._forceRenderDataRows(),this.updateStickyColumnStyles())}get fixedLayout(){return this._fixedLayout}set fixedLayout(e){this._fixedLayout=tn(e),this._forceRecalculateCellWidths=!0,this._stickyColumnStylesNeedReset=!0}ngOnInit(){this._setupStickyStyler(),this._isNativeHtmlTable&&this._applyNativeTableSections(),this._dataDiffer=this._differs.find([]).create((e,n)=>this.trackBy?this.trackBy(n.dataIndex,n.data):n),this._viewportRuler.change().pipe($n(this._onDestroy)).subscribe(()=>{this._forceRecalculateCellWidths=!0})}ngAfterContentChecked(){this._cacheRowDefs(),this._cacheColumnDefs();const n=this._renderUpdatedColumns()||this._headerRowDefChanged||this._footerRowDefChanged;this._stickyColumnStylesNeedReset=this._stickyColumnStylesNeedReset||n,this._forceRecalculateCellWidths=n,this._headerRowDefChanged&&(this._forceRenderHeaderRows(),this._headerRowDefChanged=!1),this._footerRowDefChanged&&(this._forceRenderFooterRows(),this._footerRowDefChanged=!1),this.dataSource&&this._rowDefs.length>0&&!this._renderChangeSubscription?this._observeRenderChanges():this._stickyColumnStylesNeedReset&&this.updateStickyColumnStyles(),this._checkStickyStates()}ngOnDestroy(){[this._rowOutlet.viewContainer,this._headerRowOutlet.viewContainer,this._footerRowOutlet.viewContainer,this._cachedRenderRowsMap,this._customColumnDefs,this._customRowDefs,this._customHeaderRowDefs,this._customFooterRowDefs,this._columnDefsByName].forEach(e=>{e.clear()}),this._headerRowDefs=[],this._footerRowDefs=[],this._defaultRowDef=null,this._onDestroy.next(),this._onDestroy.complete(),aH(this.dataSource)&&this.dataSource.disconnect(this)}renderRows(){this._renderRows=this._getAllRenderRows();const e=this._dataDiffer.diff(this._renderRows);if(!e)return this._updateNoDataRow(),void this.contentChanged.next();const n=this._rowOutlet.viewContainer;this._viewRepeater.applyChanges(e,n,(r,s,a)=>this._getEmbeddedViewArgs(r.item,a),r=>r.item.data,r=>{1===r.operation&&r.context&&this._renderCellTemplateForItem(r.record.item.rowDef,r.context)}),this._updateRowIndexContext(),e.forEachIdentityChange(r=>{n.get(r.currentIndex).context.$implicit=r.item.data}),this._updateNoDataRow(),this._ngZone&&Rn.isInAngularZone()?this._ngZone.onStable.pipe(Qr(1),$n(this._onDestroy)).subscribe(()=>{this.updateStickyColumnStyles()}):this.updateStickyColumnStyles(),this.contentChanged.next()}addColumnDef(e){this._customColumnDefs.add(e)}removeColumnDef(e){this._customColumnDefs.delete(e)}addRowDef(e){this._customRowDefs.add(e)}removeRowDef(e){this._customRowDefs.delete(e)}addHeaderRowDef(e){this._customHeaderRowDefs.add(e),this._headerRowDefChanged=!0}removeHeaderRowDef(e){this._customHeaderRowDefs.delete(e),this._headerRowDefChanged=!0}addFooterRowDef(e){this._customFooterRowDefs.add(e),this._footerRowDefChanged=!0}removeFooterRowDef(e){this._customFooterRowDefs.delete(e),this._footerRowDefChanged=!0}setNoDataRow(e){this._customNoDataRow=e}updateStickyHeaderRowStyles(){const e=this._getRenderedRows(this._headerRowOutlet),r=this._elementRef.nativeElement.querySelector("thead");r&&(r.style.display=e.length?"":"none");const s=this._headerRowDefs.map(a=>a.sticky);this._stickyStyler.clearStickyPositioning(e,["top"]),this._stickyStyler.stickRows(e,s,"top"),this._headerRowDefs.forEach(a=>a.resetStickyChanged())}updateStickyFooterRowStyles(){const e=this._getRenderedRows(this._footerRowOutlet),r=this._elementRef.nativeElement.querySelector("tfoot");r&&(r.style.display=e.length?"":"none");const s=this._footerRowDefs.map(a=>a.sticky);this._stickyStyler.clearStickyPositioning(e,["bottom"]),this._stickyStyler.stickRows(e,s,"bottom"),this._stickyStyler.updateStickyFooterContainer(this._elementRef.nativeElement,s),this._footerRowDefs.forEach(a=>a.resetStickyChanged())}updateStickyColumnStyles(){const e=this._getRenderedRows(this._headerRowOutlet),n=this._getRenderedRows(this._rowOutlet),r=this._getRenderedRows(this._footerRowOutlet);(this._isNativeHtmlTable&&!this._fixedLayout||this._stickyColumnStylesNeedReset)&&(this._stickyStyler.clearStickyPositioning([...e,...n,...r],["left","right"]),this._stickyColumnStylesNeedReset=!1),e.forEach((s,a)=>{this._addStickyColumnStyles([s],this._headerRowDefs[a])}),this._rowDefs.forEach(s=>{const a=[];for(let l=0;l<n.length;l++)this._renderRows[l].rowDef===s&&a.push(n[l]);this._addStickyColumnStyles(a,s)}),r.forEach((s,a)=>{this._addStickyColumnStyles([s],this._footerRowDefs[a])}),Array.from(this._columnDefsByName.values()).forEach(s=>s.resetStickyChanged())}_getAllRenderRows(){const e=[],n=this._cachedRenderRowsMap;this._cachedRenderRowsMap=new Map;for(let r=0;r<this._data.length;r++){let s=this._data[r];const a=this._getRenderRowsForData(s,r,n.get(s));this._cachedRenderRowsMap.has(s)||this._cachedRenderRowsMap.set(s,new WeakMap);for(let l=0;l<a.length;l++){let u=a[l];const h=this._cachedRenderRowsMap.get(u.data);h.has(u.rowDef)?h.get(u.rowDef).push(u):h.set(u.rowDef,[u]),e.push(u)}}return e}_getRenderRowsForData(e,n,r){return this._getRowDefs(e,n).map(a=>{const l=r&&r.has(a)?r.get(a):[];if(l.length){const u=l.shift();return u.dataIndex=n,u}return{data:e,rowDef:a,dataIndex:n}})}_cacheColumnDefs(){this._columnDefsByName.clear(),dL(this._getOwnDefs(this._contentColumnDefs),this._customColumnDefs).forEach(n=>{this._columnDefsByName.has(n.name),this._columnDefsByName.set(n.name,n)})}_cacheRowDefs(){this._headerRowDefs=dL(this._getOwnDefs(this._contentHeaderRowDefs),this._customHeaderRowDefs),this._footerRowDefs=dL(this._getOwnDefs(this._contentFooterRowDefs),this._customFooterRowDefs),this._rowDefs=dL(this._getOwnDefs(this._contentRowDefs),this._customRowDefs);const e=this._rowDefs.filter(n=>!n.when);this._defaultRowDef=e[0]}_renderUpdatedColumns(){const e=(a,l)=>a||!!l.getColumnsDiff(),n=this._rowDefs.reduce(e,!1);n&&this._forceRenderDataRows();const r=this._headerRowDefs.reduce(e,!1);r&&this._forceRenderHeaderRows();const s=this._footerRowDefs.reduce(e,!1);return s&&this._forceRenderFooterRows(),n||r||s}_switchDataSource(e){this._data=[],aH(this.dataSource)&&this.dataSource.disconnect(this),this._renderChangeSubscription&&(this._renderChangeSubscription.unsubscribe(),this._renderChangeSubscription=null),e||(this._dataDiffer&&this._dataDiffer.diff([]),this._rowOutlet.viewContainer.clear()),this._dataSource=e}_observeRenderChanges(){if(!this.dataSource)return;let e;aH(this.dataSource)?e=this.dataSource.connect(this):function e2e(i){return!!i&&(i instanceof ft||z(i.lift)&&z(i.subscribe))}(this.dataSource)?e=this.dataSource:Array.isArray(this.dataSource)&&(e=Qn(this.dataSource)),this._renderChangeSubscription=e.pipe($n(this._onDestroy)).subscribe(n=>{this._data=n||[],this.renderRows()})}_forceRenderHeaderRows(){this._headerRowOutlet.viewContainer.length>0&&this._headerRowOutlet.viewContainer.clear(),this._headerRowDefs.forEach((e,n)=>this._renderRow(this._headerRowOutlet,e,n)),this.updateStickyHeaderRowStyles()}_forceRenderFooterRows(){this._footerRowOutlet.viewContainer.length>0&&this._footerRowOutlet.viewContainer.clear(),this._footerRowDefs.forEach((e,n)=>this._renderRow(this._footerRowOutlet,e,n)),this.updateStickyFooterRowStyles()}_addStickyColumnStyles(e,n){const r=Array.from(n.columns||[]).map(l=>this._columnDefsByName.get(l)),s=r.map(l=>l.sticky),a=r.map(l=>l.stickyEnd);this._stickyStyler.updateStickyColumns(e,s,a,!this._fixedLayout||this._forceRecalculateCellWidths)}_getRenderedRows(e){const n=[];for(let r=0;r<e.viewContainer.length;r++){const s=e.viewContainer.get(r);n.push(s.rootNodes[0])}return n}_getRowDefs(e,n){if(1==this._rowDefs.length)return[this._rowDefs[0]];let r=[];if(this.multiTemplateDataRows)r=this._rowDefs.filter(s=>!s.when||s.when(n,e));else{let s=this._rowDefs.find(a=>a.when&&a.when(n,e))||this._defaultRowDef;s&&r.push(s)}return r}_getEmbeddedViewArgs(e,n){return{templateRef:e.rowDef.template,context:{$implicit:e.data},index:n}}_renderRow(e,n,r,s={}){const a=e.viewContainer.createEmbeddedView(n.template,s,r);return this._renderCellTemplateForItem(n,s),a}_renderCellTemplateForItem(e,n){for(let r of this._getCellTemplates(e))Ig.mostRecentCellOutlet&&Ig.mostRecentCellOutlet._viewContainer.createEmbeddedView(r,n);this._changeDetectorRef.markForCheck()}_updateRowIndexContext(){const e=this._rowOutlet.viewContainer;for(let n=0,r=e.length;n<r;n++){const a=e.get(n).context;a.count=r,a.first=0===n,a.last=n===r-1,a.even=n%2==0,a.odd=!a.even,this.multiTemplateDataRows?(a.dataIndex=this._renderRows[n].dataIndex,a.renderIndex=n):a.index=this._renderRows[n].dataIndex}}_getCellTemplates(e){return e&&e.columns?Array.from(e.columns,n=>{const r=this._columnDefsByName.get(n);return e.extractCellTemplate(r)}):[]}_applyNativeTableSections(){const e=this._document.createDocumentFragment(),n=[{tag:"thead",outlets:[this._headerRowOutlet]},{tag:"tbody",outlets:[this._rowOutlet,this._noDataRowOutlet]},{tag:"tfoot",outlets:[this._footerRowOutlet]}];for(const r of n){const s=this._document.createElement(r.tag);s.setAttribute("role","rowgroup");for(const a of r.outlets)s.appendChild(a.elementRef.nativeElement);e.appendChild(s)}this._elementRef.nativeElement.appendChild(e)}_forceRenderDataRows(){this._dataDiffer.diff([]),this._rowOutlet.viewContainer.clear(),this.renderRows()}_checkStickyStates(){const e=(n,r)=>n||r.hasStickyChanged();this._headerRowDefs.reduce(e,!1)&&this.updateStickyHeaderRowStyles(),this._footerRowDefs.reduce(e,!1)&&this.updateStickyFooterRowStyles(),Array.from(this._columnDefsByName.values()).reduce(e,!1)&&(this._stickyColumnStylesNeedReset=!0,this.updateStickyColumnStyles())}_setupStickyStyler(){this._stickyStyler=new d2e(this._isNativeHtmlTable,this.stickyCssClass,this._dir?this._dir.value:"ltr",this._coalescedStyleScheduler,this._platform.isBrowser,this.needsPositionStickyOnElement,this._stickyPositioningListener),(this._dir?this._dir.change:Qn()).pipe($n(this._onDestroy)).subscribe(n=>{this._stickyStyler.direction=n,this.updateStickyColumnStyles()})}_getOwnDefs(e){return e.filter(n=>!n._table||n._table===this)}_updateNoDataRow(){const e=this._customNoDataRow||this._noDataRow;if(!e)return;const n=0===this._rowOutlet.viewContainer.length;if(n===this._isShowingNoDataRow)return;const r=this._noDataRowOutlet.viewContainer;if(n){const s=r.createEmbeddedView(e.templateRef),a=s.rootNodes[0];1===s.rootNodes.length&&(null==a?void 0:a.nodeType)===this._document.ELEMENT_NODE&&(a.setAttribute("role","row"),a.classList.add(e._contentClassName))}else r.clear();this._isShowingNoDataRow=n}}return i.\u0275fac=function(e){return new(e||i)(B(wp),B(Pn),B(ai),zc("role"),B(Ia,8),B(ar),B(ta),B(uT),B(nz),B(Tp),B(lz,12),B(Rn,8))},i.\u0275cmp=ei({type:i,selectors:[["cdk-table"],["table","cdk-table",""]],contentQueries:function(e,n,r){if(1&e&&(Er(r,oL,5),Er(r,Pg,5),Er(r,sL,5),Er(r,OE,5),Er(r,FE,5)),2&e){let s;jt(s=qt())&&(n._noDataRow=s.first),jt(s=qt())&&(n._contentColumnDefs=s),jt(s=qt())&&(n._contentRowDefs=s),jt(s=qt())&&(n._contentHeaderRowDefs=s),jt(s=qt())&&(n._contentFooterRowDefs=s)}},viewQuery:function(e,n){if(1&e&&(ji(aL,7),ji(lL,7),ji(cL,7),ji(uL,7)),2&e){let r;jt(r=qt())&&(n._rowOutlet=r.first),jt(r=qt())&&(n._headerRowOutlet=r.first),jt(r=qt())&&(n._footerRowOutlet=r.first),jt(r=qt())&&(n._noDataRowOutlet=r.first)}},hostAttrs:[1,"cdk-table"],hostVars:2,hostBindings:function(e,n){2&e&&N("cdk-table-fixed-layout",n.fixedLayout)},inputs:{trackBy:"trackBy",dataSource:"dataSource",multiTemplateDataRows:"multiTemplateDataRows",fixedLayout:"fixedLayout"},outputs:{contentChanged:"contentChanged"},exportAs:["cdkTable"],features:[Sn([{provide:fC,useExisting:i},{provide:uT,useClass:Ij},{provide:nz,useClass:q$},{provide:lz,useValue:null}])],ngContentSelectors:i2e,decls:6,vars:0,consts:[["headerRowOutlet",""],["rowOutlet",""],["noDataRowOutlet",""],["footerRowOutlet",""]],template:function(e,n){1&e&&(As(t2e),hr(0),hr(1,1),Hd(2,0)(3,1)(4,2)(5,3))},directives:[lL,aL,uL,cL],styles:[".cdk-table-fixed-layout{table-layout:fixed}\n"],encapsulation:2}),i})();function dL(i,t){return i.concat(Array.from(t))}let p2e=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[WB]]}),i})();const m2e=[[["caption"]],[["colgroup"],["col"]]],g2e=["caption","colgroup, col"];let cz=(()=>{class i extends hL{constructor(){super(...arguments),this.stickyCssClass="mat-table-sticky",this.needsPositionStickyOnElement=!1}}return i.\u0275fac=function(){let t;return function(n){return(t||(t=Ki(i)))(n||i)}}(),i.\u0275cmp=ei({type:i,selectors:[["mat-table"],["table","mat-table",""]],hostAttrs:[1,"mat-table"],hostVars:2,hostBindings:function(e,n){2&e&&N("mat-table-fixed-layout",n.fixedLayout)},exportAs:["matTable"],features:[Sn([{provide:uT,useClass:Ij},{provide:hL,useExisting:i},{provide:fC,useExisting:i},{provide:nz,useClass:q$},{provide:lz,useValue:null}]),It],ngContentSelectors:g2e,decls:6,vars:0,consts:[["headerRowOutlet",""],["rowOutlet",""],["noDataRowOutlet",""],["footerRowOutlet",""]],template:function(e,n){1&e&&(As(m2e),hr(0),hr(1,1),Hd(2,0)(3,1)(4,2)(5,3))},directives:[lL,aL,uL,cL],styles:["mat-table{display:block}mat-header-row{min-height:56px}mat-row,mat-footer-row{min-height:48px}mat-row,mat-header-row,mat-footer-row{display:flex;border-width:0;border-bottom-width:1px;border-style:solid;align-items:center;box-sizing:border-box}mat-cell:first-of-type,mat-header-cell:first-of-type,mat-footer-cell:first-of-type{padding-left:24px}[dir=rtl] mat-cell:first-of-type:not(:only-of-type),[dir=rtl] mat-header-cell:first-of-type:not(:only-of-type),[dir=rtl] mat-footer-cell:first-of-type:not(:only-of-type){padding-left:0;padding-right:24px}mat-cell:last-of-type,mat-header-cell:last-of-type,mat-footer-cell:last-of-type{padding-right:24px}[dir=rtl] mat-cell:last-of-type:not(:only-of-type),[dir=rtl] mat-header-cell:last-of-type:not(:only-of-type),[dir=rtl] mat-footer-cell:last-of-type:not(:only-of-type){padding-right:0;padding-left:24px}mat-cell,mat-header-cell,mat-footer-cell{flex:1;display:flex;align-items:center;overflow:hidden;word-wrap:break-word;min-height:inherit}table.mat-table{border-spacing:0}tr.mat-header-row{height:56px}tr.mat-row,tr.mat-footer-row{height:48px}th.mat-header-cell{text-align:left}[dir=rtl] th.mat-header-cell{text-align:right}th.mat-header-cell,td.mat-cell,td.mat-footer-cell{padding:0;border-bottom-width:1px;border-bottom-style:solid}th.mat-header-cell:first-of-type,td.mat-cell:first-of-type,td.mat-footer-cell:first-of-type{padding-left:24px}[dir=rtl] th.mat-header-cell:first-of-type:not(:only-of-type),[dir=rtl] td.mat-cell:first-of-type:not(:only-of-type),[dir=rtl] td.mat-footer-cell:first-of-type:not(:only-of-type){padding-left:0;padding-right:24px}th.mat-header-cell:last-of-type,td.mat-cell:last-of-type,td.mat-footer-cell:last-of-type{padding-right:24px}[dir=rtl] th.mat-header-cell:last-of-type:not(:only-of-type),[dir=rtl] td.mat-cell:last-of-type:not(:only-of-type),[dir=rtl] td.mat-footer-cell:last-of-type:not(:only-of-type){padding-right:0;padding-left:24px}.mat-table-sticky{position:sticky !important}.mat-table-fixed-layout{table-layout:fixed}\n"],encapsulation:2}),i})(),fL=(()=>{class i extends pC{}return i.\u0275fac=function(){let t;return function(n){return(t||(t=Ki(i)))(n||i)}}(),i.\u0275dir=Be({type:i,selectors:[["","matCellDef",""]],features:[Sn([{provide:pC,useExisting:i}]),It]}),i})(),pL=(()=>{class i extends mC{}return i.\u0275fac=function(){let t;return function(n){return(t||(t=Ki(i)))(n||i)}}(),i.\u0275dir=Be({type:i,selectors:[["","matHeaderCellDef",""]],features:[Sn([{provide:mC,useExisting:i}]),It]}),i})(),mL=(()=>{class i extends Pg{get name(){return this._name}set name(e){this._setNameInput(e)}_updateColumnCssClassName(){super._updateColumnCssClassName(),this._columnCssClassName.push(`mat-column-${this.cssClassFriendlyName}`)}}return i.\u0275fac=function(){let t;return function(n){return(t||(t=Ki(i)))(n||i)}}(),i.\u0275dir=Be({type:i,selectors:[["","matColumnDef",""]],inputs:{sticky:"sticky",name:["matColumnDef","name"]},features:[Sn([{provide:Pg,useExisting:i},{provide:"MAT_SORT_HEADER_COLUMN_DEF",useExisting:i}]),It]}),i})(),gL=(()=>{class i extends tz{}return i.\u0275fac=function(){let t;return function(n){return(t||(t=Ki(i)))(n||i)}}(),i.\u0275dir=Be({type:i,selectors:[["mat-header-cell"],["th","mat-header-cell",""]],hostAttrs:["role","columnheader",1,"mat-header-cell"],features:[It]}),i})(),_L=(()=>{class i extends iz{}return i.\u0275fac=function(){let t;return function(n){return(t||(t=Ki(i)))(n||i)}}(),i.\u0275dir=Be({type:i,selectors:[["mat-cell"],["td","mat-cell",""]],hostAttrs:["role","gridcell",1,"mat-cell"],features:[It]}),i})(),uz=(()=>{class i extends OE{}return i.\u0275fac=function(){let t;return function(n){return(t||(t=Ki(i)))(n||i)}}(),i.\u0275dir=Be({type:i,selectors:[["","matHeaderRowDef",""]],inputs:{columns:["matHeaderRowDef","columns"],sticky:["matHeaderRowDefSticky","sticky"]},features:[Sn([{provide:OE,useExisting:i}]),It]}),i})(),hz=(()=>{class i extends sL{}return i.\u0275fac=function(){let t;return function(n){return(t||(t=Ki(i)))(n||i)}}(),i.\u0275dir=Be({type:i,selectors:[["","matRowDef",""]],inputs:{columns:["matRowDefColumns","columns"],when:["matRowDefWhen","when"]},features:[Sn([{provide:sL,useExisting:i}]),It]}),i})(),dz=(()=>{class i extends sz{}return i.\u0275fac=function(){let t;return function(n){return(t||(t=Ki(i)))(n||i)}}(),i.\u0275cmp=ei({type:i,selectors:[["mat-header-row"],["tr","mat-header-row",""]],hostAttrs:["role","row",1,"mat-header-row"],exportAs:["matHeaderRow"],features:[Sn([{provide:sz,useExisting:i}]),It],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(e,n){1&e&&Hd(0,0)},directives:[Ig],encapsulation:2}),i})(),fz=(()=>{class i extends az{}return i.\u0275fac=function(){let t;return function(n){return(t||(t=Ki(i)))(n||i)}}(),i.\u0275cmp=ei({type:i,selectors:[["mat-row"],["tr","mat-row",""]],hostAttrs:["role","row",1,"mat-row"],exportAs:["matRow"],features:[Sn([{provide:az,useExisting:i}]),It],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(e,n){1&e&&Hd(0,0)},directives:[Ig],encapsulation:2}),i})(),pz=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[p2e,jn],jn]}),i})(),E2e=(()=>{class i{transform(e){return e.sort(function(n,r){const s=n.name.toLowerCase(),a=r.name.toLowerCase();return s<a?-1:s>a?1:0}),e}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275pipe=Hn({name:"SortTagsPipe",type:i,pure:!0}),i})();const A2e=["segmentFeaturesComponent"];function D2e(i,t){1&i&&(Z(0,"div")(1,"p",7),ue(2,"No Tags available for chosen element"),J()())}function R2e(i,t){1&i&&(Z(0,"h4",11)(1,"strong"),ue(2,"Tags"),J()())}function k2e(i,t){if(1&i&&(Z(0,"mat-grid-tile",12)(1,"div"),ue(2),yt(3,"br"),ue(4),J()()),2&i){const e=t.$implicit;se(2),ui(" ",e.name," "),se(2),ui(" (",e.id,") ")}}function P2e(i,t){if(1&i&&(Z(0,"div"),Ue(1,R2e,3,0,"h4",8),Z(2,"mat-grid-list",9),Ue(3,k2e,5,2,"mat-grid-tile",10),ti(4,"SortTagsPipe"),J()()),2&i){const e=Re(2);se(1),fe("ngIf",e._tags.length>0),se(2),fe("ngForOf",Qi(4,2,e._tags))}}function I2e(i,t){if(1&i&&(Z(0,"div",15),ue(1),J()),2&i){const e=t.$implicit,r=t.even;N("Odd",t.odd)("even",r),se(1),ui(" ",e," ")}}function L2e(i,t){if(1&i&&(Z(0,"mat-tab",13)(1,"h4",11)(2,"strong"),ue(3,"Captions"),J()(),Ue(4,I2e,2,5,"div",14),J()),2&i){const e=Re(2);se(4),fe("ngForOf",e._captions)}}function O2e(i,t){if(1&i&&(Z(0,"div",15),ue(1),J()),2&i){const e=t.$implicit,r=t.even;N("Odd",t.odd)("even",r),se(1),ui(" ",e," ")}}function F2e(i,t){if(1&i&&(Z(0,"mat-tab",16)(1,"h4",11)(2,"strong"),ue(3,"ASR"),J()(),Ue(4,O2e,2,5,"div",14),J()),2&i){const e=Re(2);se(4),fe("ngForOf",e._asr)}}function B2e(i,t){if(1&i&&(Z(0,"div",15),ue(1),J()),2&i){const e=t.$implicit,r=t.even;N("Odd",t.odd)("even",r),se(1),ui(" ",e," ")}}function N2e(i,t){if(1&i&&(Z(0,"mat-tab",17)(1,"h4",11)(2,"strong"),ue(3,"OCR"),J()(),Ue(4,B2e,2,5,"div",14),J()),2&i){const e=Re(2);se(4),fe("ngForOf",e._ocr)}}function H2e(i,t){if(1&i&&(Z(0,"th",26),ue(1),J()),2&i){const e=Re().$implicit;se(1),ui(" ",e,"")}}function V2e(i,t){if(1&i&&(Z(0,"td",27),ue(1),J()),2&i){const e=t.$implicit,n=Re().$implicit;se(1),ui(" ",e[n]," ")}}function z2e(i,t){1&i&&(Wo(0,23),Ue(1,H2e,2,1,"th",24),Ue(2,V2e,2,1,"td",25),jo()),2&i&&_o("matColumnDef",t.$implicit)}function U2e(i,t){1&i&&yt(0,"tr",28)}function G2e(i,t){1&i&&yt(0,"tr",29)}function W2e(i,t){if(1&i&&(Z(0,"mat-tab",18)(1,"table",19),Ue(2,z2e,3,1,"ng-container",20),Ue(3,U2e,1,0,"tr",21),Ue(4,G2e,1,0,"tr",22),J()()),2&i){const e=Re(2);se(1),fe("dataSource",e._meta),se(1),fe("ngForOf",e.metaCols),se(1),fe("matHeaderRowDef",e.metaCols),se(1),fe("matRowDefColumns",e.metaCols)}}function j2e(i,t){if(1&i&&(Z(0,"div")(1,"h4")(2,"strong"),ue(3),J()(),Z(4,"mat-tab-group",1)(5,"mat-tab",2),Ue(6,D2e,3,0,"div",0),Ue(7,P2e,5,4,"div",0),J(),Ue(8,L2e,5,1,"mat-tab",3),Ue(9,F2e,5,1,"mat-tab",4),Ue(10,N2e,5,1,"mat-tab",5),Ue(11,W2e,5,4,"mat-tab",6),J()()),2&i){const e=Re();se(3),ui("Features for segment: ",e.segmentId,""),se(3),fe("ngIf",!e._tags),se(1),fe("ngIf",e._tags),se(1),fe("ngIf",e._captions.length>0),se(1),fe("ngIf",e._asr.length>0),se(1),fe("ngIf",e._ocr.length>0),se(1),fe("ngIf",e._meta.length>0)}}let Y$=(()=>{class i{constructor(e,n,r){this._eventBusService=e,this._metaService=n,this._tagService=r,this.metaCols=["domain","key","value"],this._tags=[],this._captions=[],this._asr=[],this._ocr=[],this._meta=[]}onLoadFeaturesButtonClicked(e){this._tags=[],this._captions=[],this._asr=[],this._ocr=[],this.segmentId=e.segmentId;const n=new Map;n.set("i:mediasegment",e.segmentId),this._eventBusService.publish(new ia(new ao(fr.LOAD_FEATURES,n))),this._metaService.findTagInformationById(e.segmentId).subscribe(r=>this._tagService.findTagsById({ids:r.tags}).subscribe(s=>{this._tags=s.tags})),this._metaService.findTextByIDAndCat(e.segmentId,"scenecaption").subscribe(r=>this._captions=r.featureValues),this._metaService.findTextByIDAndCat(e.segmentId,"asr").subscribe(r=>this._asr=r.featureValues),this._metaService.findTextByIDAndCat(e.segmentId,"ocr").subscribe(r=>this._ocr=r.featureValues),this._metaService.findSegMetaById(e.segmentId).subscribe(r=>this._meta=r.content)}}return i.\u0275fac=function(e){return new(e||i)(B(Zc),B(Kb),B(sP))},i.\u0275cmp=ei({type:i,selectors:[["app-segment-features"]],viewQuery:function(e,n){if(1&e&&ji(A2e,5),2&e){let r;jt(r=qt())&&(n.segmentFeaturesComponent=r.first)}},decls:1,vars:1,consts:[[4,"ngIf"],[1,"scrollToBottom"],["label","Tags"],["label","Captions",4,"ngIf"],["label","ASR",4,"ngIf"],["label","OCR",4,"ngIf"],["label","Metadata",4,"ngIf"],[1,"text-muted"],["mat-line","",4,"ngIf"],["cols","5","rowHeight","3:1"],["class","smallerFont",4,"ngFor","ngForOf"],["mat-line",""],[1,"smallerFont"],["label","Captions"],["class","normalfont",3,"Odd","even",4,"ngFor","ngForOf"],[1,"normalfont"],["label","ASR"],["label","OCR"],["label","Metadata"],["mat-table","",3,"dataSource"],[3,"matColumnDef",4,"ngFor","ngForOf"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"matColumnDef"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""]],template:function(e,n){1&e&&Ue(0,j2e,12,7,"div",0),2&e&&fe("ngIf",n.segmentId)},directives:[ms,QI,LE,Hb,ZJ,mo,Y4,cz,mL,pL,gL,fL,_L,uz,dz,hz,fz],pipes:[E2e],styles:["table[_ngcontent-%COMP%]{width:100%}.tile[_ngcontent-%COMP%]{width:200px;height:200px;border-top:10px solid;border-bottom:10px solid;margin-bottom:25px;box-shadow:.15em .15em .05em #0006;position:relative}.tile[_ngcontent-%COMP%]   .tile-header[_ngcontent-%COMP%]{top:0;left:0;right:0;min-height:30px;padding:10px;position:absolute;z-index:100;background-color:#000;opacity:.65;color:#fff}.tile[_ngcontent-%COMP%]   .tile-body[_ngcontent-%COMP%]{width:100%;height:100%}.tile[_ngcontent-%COMP%]   .tile-footer[_ngcontent-%COMP%]{top:150px;left:0;right:0;height:50px;padding:5px;position:absolute;z-index:100;background-color:#000;opacity:.65;color:#fff}.scrollToBottom[_ngcontent-%COMP%]{min-height:800px}.smallerFont[_ngcontent-%COMP%]{font-size:small;text-align:center}.normalfont[_ngcontent-%COMP%]{font-size:medium}.odd[_ngcontent-%COMP%]{background-color:#f2f9ff}.even[_ngcontent-%COMP%]{background-color:#eceff3}mat-grid-tile[_ngcontent-%COMP%]{background:#e0e0e0}"]}),i})(),K$=(()=>{class i{transform(e,n,r,s){return FH.staticBackgroundForScore(e,n,r,s)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275pipe=Hn({name:"BackgroundScorePipe",type:i,pure:!0}),i})(),Q$=(()=>{class i{transform(e){return Math.round(1e3*e)/10}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275pipe=Hn({name:"ScorePercentagePipe",type:i,pure:!0}),i})(),yL=(()=>{class i{constructor(e,n){this._resolverService=n,e.configAsObservable.subscribe(r=>this._host_thumbnails=r._config.resources.host_thumbnails)}transform(e,n,r,s){return this._resolverService.pathToThumbnail(e,n,r,s)}}return i.\u0275fac=function(e){return new(e||i)(B(dr,16),B(Ts,16))},i.\u0275pipe=Hn({name:"ThumbnailPathPipe",type:i,pure:!0}),i})();class gC{static isUrl(t){return gC.URL_PATTERN.test(t)}static replaceUrlByLink(t,e=null){return t.replace(gC.URL_PATTERN,e?"<a href='$1' target='"+e+"'>$1</a>":"<a href='$1'>$1</a>")}}gC.URL_PATTERN=new RegExp("((([A-Za-z]{3,9}:(?:\\/\\/)?)(?:[-;:&=\\+\\$,\\w]+@)?[A-Za-z0-9.-]+|(?:www.|[-;:&=\\+\\$,\\w]+@)[A-Za-z0-9.-]+)((?:\\/[\\+~%\\/.\\w-_]*)?\\??(?:[-\\+=&;%@.\\w_]*)#?(?:[\\w]*))?)","ig");let J$=(()=>{class i{transform(e){return gC.replaceUrlByLink(e,"_blank")}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275pipe=Hn({name:"TextWithLinkPipe",type:i,pure:!0}),i})();const q2e=["objectviewerComponent"],X2e=["segmentFeaturesComponent"];function Z2e(i,t){1&i&&(Z(0,"div"),yt(1,"mat-progress-bar",3),J())}function Y2e(i,t){if(1&i&&(Z(0,"p"),ue(1),J()),2&i){const e=Re().$implicit;A("margin","0"),se(1),hi("",e.startabs.toFixed(2)," - ",e.endabs.toFixed(2),"")}}function K2e(i,t){if(1&i){const e=Wi();Z(0,"button",26),je("click",function(){gt(e);const r=Re().$implicit;return Re(3).onSubmitPressed(r)}),Z(1,"mat-icon"),ue(2,"send"),J()()}}function Q2e(i,t){if(1&i){const e=Wi();Z(0,"button",27),je("click",function(){gt(e);const r=Re().$implicit;return Re(3).onPlayClick(r)}),Z(1,"mat-icon"),ue(2,"play_arrow"),J()()}}const $$=function(){return[]};function J2e(i,t){if(1&i){const e=Wi();Z(0,"div",16),je("dragstart",function(r){const a=gt(e).$implicit;return Re(3).onSegmentDrag(r,a)}),ti(1,"BackgroundScorePipe"),ti(2,"BackgroundScorePipe"),Z(3,"div",17)(4,"p"),ue(5),ti(6,"ScorePercentagePipe"),J(),Ue(7,Y2e,2,4,"p",18),J(),yt(8,"img",19),ti(9,"ThumbnailPathPipe"),Z(10,"div",20),Ue(11,K2e,3,0,"button",21),Ue(12,Q2e,3,0,"button",22),Z(13,"button",23),je("click",function(){const s=gt(e).$implicit;return Re(3).onMltClick(s)}),Z(14,"mat-icon"),ue(15,"youtube_searched_for"),J()(),Z(16,"button",24),je("click",function(){const s=gt(e).$implicit;return Re(3).onInformationButtonClicked(s)}),Z(17,"mat-icon"),ue(18,"help"),J()(),Z(19,"button",25),je("click",function(){const s=gt(e).$implicit;return Re(3).segmentFeatures.onLoadFeaturesButtonClicked(s)}),Z(20,"mat-icon"),ue(21,"remove_red_eye"),J()()()()}if(2&i){const e=t.$implicit,n=Re(2).ngIf,r=Re();A("border-top-color",Rh(1,12,e.score,e,n1(27,$$)))("border-bottom-color",Rh(2,16,e.score,e,n1(28,$$))),se(4),A("margin","0"),se(1),hi("",e.segmentId," (",Qi(6,20,e._score),"%)"),se(2),fe("ngIf",e.endabs>0),se(1),_o("src",uR(9,22,e._objectScoreContainer,e,200,null),Mc),se(3),fe("ngIf",r._showSubmitButton),se(1),fe("ngIf","VIDEO"===n.mediatype||"AUDIO"===n.mediatype)}}function $2e(i,t){if(1&i&&(Z(0,"div",28),ue(1),J()),2&i){const e=Re(2).ngIf;se(1),ui(" No object metadata available for ",e.objectid," ")}}function eIe(i,t){if(1&i&&(Z(0,"mat-list-item")(1,"h4",29)(2,"strong"),ue(3),J()(),yt(4,"p",30),ti(5,"TextWithLinkPipe"),J()),2&i){const e=t.$implicit;se(3),Xt(e.key),se(1),fe("innerHTML",Qi(5,2,e.value),Lv)}}function tIe(i,t){if(1&i){const e=Wi();Z(0,"div")(1,"mat-tab-group")(2,"mat-tab",10)(3,"div",11),Ue(4,J2e,22,29,"div",12),ti(5,"orderBy"),J(),Z(6,"button",13),je("click",function(){const s=gt(e).ngIf;return Re(2).onLoadAllButtonClicked(s[0])}),Z(7,"mat-icon"),ue(8,"all_inclusive"),J(),ue(9," Load all "),J()(),Z(10,"mat-tab",10),Ue(11,$2e,2,1,"div",14),Z(12,"mat-list"),Ue(13,eIe,6,4,"mat-list-item",15),ti(14,"keyvalue"),J()()()()}if(2&i){const e=t.ngIf,n=Re().ngIf,r=Re();se(2),Vd("label","Segments (",e.length,")"),se(2),fe("ngForOf",Bs(5,5,e,r.orderType)),se(6),Vd("label","Object Metadata (",n.metadata.size,")"),se(1),fe("ngIf",0==n.metadata.size),se(2),fe("ngForOf",Qi(14,8,n.metadata))}}function iIe(i,t){if(1&i){const e=Wi();Z(0,"div",4),yt(1,"app-objectviewer",5,6),Z(3,"mat-button-toggle-group",7),je("change",function(r){return gt(e),Re().onOrderTypeChange(r.value)}),Z(4,"mat-button-toggle",8),ue(5,"Score"),J(),Z(6,"mat-button-toggle",9),ue(7,"Time"),J()(),Ue(8,tIe,15,10,"div",0),ti(9,"async"),yt(10,"mat-divider"),J()}if(2&i){const e=t.ngIf,n=Re();se(1),fe("mediaobject",e),se(2),fe("value",n.orderTypeStr),se(5),fe("ngIf",Qi(9,3,n._mediaObject._segmentsObservable))}}let nIe=(()=>{class i{constructor(e,n,r,s,a,l,u,h,m,_,v,S,T){this._route=e,this._snackBar=n,this._metadataLookup=r,this._query=s,this._eventBusService=a,this._resolver=l,this._historyService=u,this._tagService=h,this._metaService=m,this._objectService=_,this._segmentService=v,this._config=S,this._vbs=T,this._showSubmitButton=!1,this._loading=!1,T.isOn.subscribe(I=>this._showSubmitButton=I),this.objectIdObservable=e.params.pipe(Ui(I=>I.objectId),vr(I=>null!=I))}ngOnInit(){this._query.results?this.setOrderType(Jh.SCORE):(this._container=new tH(void 0),this.setOrderType(Jh.SEGMENT_TIME)),this.objectIdObservable.pipe(Ui(e=>this._query.results?this._query.results.getObject(e)?(this._container=this._query.results.getObject(e),void this.updateContainer()):(this._snackBar.open(`Object ${e} could not be found. Returning to gallery...`,"",{duration:2500}),void this._historyService.goToPrevious()):(this._loading=!0,this._objectService.findObjectsByAttribute("id",e).subscribe(n=>{let r=null;0===n.content.length?r=`Cineast returned no results for object ${e} . Returning to gallery...`:""===n.content[0].objectid&&(r=`Cineast returned no object descriptor for object ${e} . Returning to gallery...`),r&&(this._snackBar.open(r,"",{duration:5e3}),this._historyService.goToRoot());const s=n.content[0];this._container.mediatype=s.mediatype,this._container.objectid=s.objectid,this._container.name=s.name,this._container.path=s.path,this._container.contentURL=s.contentURL,this.updateContainer()}),this._segmentService.findSegmentByObjectId(e).subscribe(n=>{this._container.objectid||(this._container.objectid=n.content[0].objectId),this._container.segments=n.content.map(r=>new eH(r,this._container)),this.updateContainer()}),this._metaService.findMetaById(e).subscribe(n=>{n.content&&0!==n.content.length?n.content.forEach(r=>this._container.metadata.set(`${r.domain}.${r.key}`,r.value)):console.log(`no metadata available for ${e}`)}),this._container))).subscribe()}onSegmentDrag(e,n){e.dataTransfer.setData(xy.FORMAT,xy.fromScoreContainer(n).toJSON()),e.dataTransfer.setData(rS.FORMAT,rS.fromScoreContainer(n.objectScoreContainer).toJSON())}onPlayClick(e){this.objectviewer?this.objectviewer.onPlayClick(e):console.log("objectviewer not loaded yet, cannot play from segment")}onMltClick(e){this._query.findMoreLikeThis(e,e.objectScoreContainer.mediatype)}onInformationButtonClicked(e){e.metadata.size>0?this.showMetadata(e):(console.log(`looking up metadata for ${e.segmentId}`),this._loading=!0,this._metaService.findSegMetaById(e.segmentId).subscribe(n=>{n.content.forEach(r=>e.metadata.set(`${r.domain}.${r.key}`,r.value)),this._loading=!1,this.showMetadata(e)}))}showMetadata(e){this._snackBar.openFromComponent(z$,{data:e,duration:2500});const n=new Map;n.set("i:mediasegment",e.segmentId),this._eventBusService.publish(new ia(new ao(fr.EXAMINE,n)))}onLoadAllButtonClicked(e){this._query.lookupNeighboringSegments(e.segmentId,1e3)}updateContainer(){this._mediaObject=this._container,this._loading=!this._mediaObject.name||0===this._mediaObject.segments.length}onSubmitPressed(e){console.debug(`submitting for segment ${e.segmentId}`),this._vbs.submitSegment(e)}onOrderTypeChange(e){switch(e){case"score":this.orderType=Jh.SCORE;break;case"time":this.orderType=Jh.SEGMENT_TIME}}setOrderType(e){switch(this.orderType=e,e){case Jh.SCORE:this.orderTypeStr="score";break;case Jh.SEGMENT_TIME:this.orderTypeStr="time"}}}return i.\u0275fac=function(e){return new(e||i)(B(wy),B(Ru),B(Kb),B(Rc),B(Zc),B(Ts),B(tL),B(sP),B(Kb),B(rP),B(rH),B(dr),B(sg))},i.\u0275cmp=ei({type:i,selectors:[["app-object-details"]],viewQuery:function(e,n){if(1&e&&(ji(q2e,5),ji(X2e,5)),2&e){let r;jt(r=qt())&&(n.objectviewer=r.first),jt(r=qt())&&(n.segmentFeatures=r.first)}},decls:4,vars:2,consts:[[4,"ngIf"],["style","padding:10px;",4,"ngIf"],["segmentFeaturesComponent",""],["mode","buffer"],[2,"padding","10px"],[3,"mediaobject"],["objectviewerComponent",""],["name","orderType","aria-label","Order By",3,"value","change"],["value","score"],["value","time"],[3,"label"],["fxLayout","row","fxLayoutGap","5px","fxLayoutWrap","wrap"],["class","tile","draggable","true","fxFlex","200px",3,"border-top-color","border-bottom-color","dragstart",4,"ngFor","ngForOf"],["color","warn","mat-raised-button","","matTooltip","Load all segments",3,"click"],["style","padding-top:10px",4,"ngIf"],[4,"ngFor","ngForOf"],["draggable","true","fxFlex","200px",1,"tile",3,"dragstart"],["fxLayout","","fxLayoutAlign","space-between start",1,"tile-header"],[3,"margin",4,"ngIf"],["height","200px","width","200px",1,"tile-body",3,"src"],["fxLayout","row-reverse",1,"tile-footer"],["mat-icon-button","","matTooltip","Submit segment to VBS API.",3,"click",4,"ngIf"],["mat-icon-button","","matTooltip","Start playback",3,"click",4,"ngIf"],["mat-icon-button","","matTooltip","More-like-this",3,"click"],["mat-icon-button","","matTooltip","Metadata",3,"click"],["mat-icon-button","","matTooltip","Load Features",3,"click"],["mat-icon-button","","matTooltip","Submit segment to VBS API.",3,"click"],["mat-icon-button","","matTooltip","Start playback",3,"click"],[2,"padding-top","10px"],["mat-line",""],["mat-line","",2,"white-space","pre-wrap",3,"innerHTML"]],template:function(e,n){1&e&&(Ue(0,Z2e,2,0,"div",0),Ue(1,iIe,11,5,"div",1),yt(2,"app-segment-features",null,2)),2&e&&(fe("ngIf",n._loading),se(1),fe("ngIf",n._mediaObject))},directives:[ms,kP,G$,mI,gI,QI,LE,ug,oV,mo,aV,hg,Mo,Fo,vo,nS,Jb,Hb,ig,Y$],pipes:[Xc,K$,WPe,Q$,yL,h1,J$],styles:["table[_ngcontent-%COMP%]{width:100%}.tile[_ngcontent-%COMP%]{width:200px;height:200px;border-top:10px solid;border-bottom:10px solid;margin-bottom:25px;box-shadow:.15em .15em .05em #0006;position:relative}.tile[_ngcontent-%COMP%]   .tile-header[_ngcontent-%COMP%]{top:0;left:0;right:0;min-height:30px;padding:10px;position:absolute;z-index:100;background-color:#000;opacity:.65;color:#fff}.tile[_ngcontent-%COMP%]   .tile-body[_ngcontent-%COMP%]{width:100%;height:100%}.tile[_ngcontent-%COMP%]   .tile-footer[_ngcontent-%COMP%]{top:150px;left:0;right:0;height:50px;padding:5px;position:absolute;z-index:100;background-color:#000;opacity:.65;color:#fff}.scrollToBottom[_ngcontent-%COMP%]{min-height:800px}.smallerFont[_ngcontent-%COMP%]{font-size:small;text-align:center}.normalfont[_ngcontent-%COMP%]{font-size:medium}.odd[_ngcontent-%COMP%]{background-color:#f2f9ff}.even[_ngcontent-%COMP%]{background-color:#eceff3}mat-grid-tile[_ngcontent-%COMP%]{background:#e0e0e0}"]}),i})();const eee={leading:!0,trailing:!1};function oIe(i,t,e,n){const r=window&&!!window.document&&window.document.documentElement;let s=r&&t?window:e;if(i&&(s=i&&r&&"string"==typeof i?function aIe(i,t,e){return(e?window.document:t).querySelector(i)}(i,e.nativeElement,n):i,!s))throw new Error("ngx-infinite-scroll {resolveContainerElement()}: selector for");return s}function mz(i){return i&&!i.firstChange}const cIe={clientHeight:"clientHeight",offsetHeight:"offsetHeight",scrollHeight:"scrollHeight",pageYOffset:"pageYOffset",offsetTop:"offsetTop",scrollTop:"scrollTop",top:"top"},uIe={clientHeight:"clientWidth",offsetHeight:"offsetWidth",scrollHeight:"scrollWidth",pageYOffset:"pageXOffset",offsetTop:"offsetLeft",scrollTop:"scrollLeft",top:"left"};class hIe{constructor(t=!0){this.vertical=t,this.propsMap=t?cIe:uIe}clientHeightKey(){return this.propsMap.clientHeight}offsetHeightKey(){return this.propsMap.offsetHeight}scrollHeightKey(){return this.propsMap.scrollHeight}pageYOffsetKey(){return this.propsMap.pageYOffset}offsetTopKey(){return this.propsMap.offsetTop}scrollTopKey(){return this.propsMap.scrollTop}topKey(){return this.propsMap.top}}function mIe(i){return["Window","global"].some(e=>Object.prototype.toString.call(i).includes(e))}function gz(i,t){return i?t.document.documentElement:null}function tee(i,t){const e=function yIe({container:i,isWindow:t,axis:e}){const{offsetHeightKey:n,clientHeightKey:r}=iee(e);return nee(i,t,n,r)}(t);return t.isWindow?function gIe(i,t,e){const{axis:n,container:r,isWindow:s}=e,{offsetHeightKey:a,clientHeightKey:l}=iee(n),u=i+ree(gz(s,r),n,s),h=nee(t.nativeElement,s,a,l),m=function vIe(i,t,e){const n=t.topKey();if(i.getBoundingClientRect)return i.getBoundingClientRect()[n]+ree(i,t,e)}(t.nativeElement,n,s)+h;return{height:i,scrolled:u,totalToScroll:m,isWindow:s}}(e,i,t):function _Ie(i,t,e){const{axis:n,container:r}=e;return{height:i,scrolled:r[n.scrollTopKey()],totalToScroll:r[n.scrollHeightKey()],isWindow:!1}}(e,0,t)}function iee(i){return{offsetHeightKey:i.offsetHeightKey(),clientHeightKey:i.clientHeightKey()}}function nee(i,t,e,n){if(isNaN(i[e])){const r=gz(t,i);return r?r[n]:0}return i[e]}function ree(i,t,e){const n=t.pageYOffsetKey(),r=t.scrollTopKey(),s=t.offsetTopKey();return isNaN(window.pageYOffset)?gz(e,i)[r]:i.ownerDocument?i.ownerDocument.defaultView[n]:i[s]}function bIe(i,t,e){let n,r;if(i.totalToScroll<=0)return!1;const s=i.isWindow?i.scrolled:i.height+i.scrolled;return e?(n=(i.totalToScroll-s)/i.totalToScroll,r=t.down/10):(n=i.scrolled/(i.scrolled+(i.totalToScroll-s)),r=t.up/10),n<=r}class SIe{constructor({totalToScroll:t}){this.lastScrollPosition=0,this.lastTotalToScroll=0,this.totalToScroll=0,this.triggered={down:0,up:0},this.totalToScroll=t}updateScrollPosition(t){return this.lastScrollPosition=t}updateTotalToScroll(t){this.lastTotalToScroll!==t&&(this.lastTotalToScroll=this.totalToScroll,this.totalToScroll=t)}updateScroll(t,e){this.updateScrollPosition(t),this.updateTotalToScroll(e)}updateTriggeredFlag(t,e){e?this.triggered.down=t:this.triggered.up=t}isTriggeredScroll(t,e){return e?this.triggered.down===t:this.triggered.up===t}}function CIe(i){const{scrollContainer:t,scrollWindow:e,element:n,fromRoot:r}=i,s=function fIe({windowElement:i,axis:t}){return function pIe(i,t){const e=i.isWindow||t&&!t.nativeElement?t:t.nativeElement;return Object.assign(Object.assign({},i),{container:e})}({axis:t,isWindow:mIe(i)},i)}({axis:new hIe(!i.horizontal),windowElement:oIe(t,e,n,r)}),a=new SIe({totalToScroll:tee(n,s)}),u={up:i.upDistance,down:i.downDistance};return function MIe(i){let t=os(i.container,"scroll");return i.throttle&&(t=t.pipe(function sIe(i,t=Hw,e=eee){const n=ay(i,t);return function rIe(i,t=eee){return gr((e,n)=>{const{leading:r,trailing:s}=t;let a=!1,l=null,u=null,h=!1;const m=()=>{null==u||u.unsubscribe(),u=null,s&&(S(),h&&n.complete())},_=()=>{u=null,h&&n.complete()},v=T=>u=eo(i(T)).subscribe(qn(n,m,_)),S=()=>{if(a){a=!1;const T=l;l=null,n.next(T),!h&&v(T)}};e.subscribe(qn(n,T=>{a=!0,l=T,(!u||u.closed)&&(r?S():v(T))},()=>{h=!0,(!(s&&a&&u)||u.closed)&&n.complete()}))})}(()=>n,e)}(i.throttle))),t}({container:s.container,throttle:i.throttle}).pipe(ks(()=>Qn(tee(n,s))),Ui(h=>function TIe(i,t,e){const{scrollDown:n,fire:r}=function wIe(i,t,e){const n=function xIe(i,t){return i<t.scrolled}(i,t);return{fire:bIe(t,e,n),scrollDown:n}}(i,t,e);return{scrollDown:n,fire:r,stats:t}}(a.lastScrollPosition,h,u)),Po(({stats:h})=>a.updateScroll(h.scrolled,h.totalToScroll)),vr(({fire:h,scrollDown:m,stats:{totalToScroll:_}})=>function dIe(i,t,e){return!!(i&&t||!e&&t)}(i.alwaysCallback,h,a.isTriggeredScroll(_,m))),Po(({scrollDown:h,stats:{totalToScroll:m}})=>{a.updateTriggeredFlag(m,h)}),Ui(EIe))}function EIe(i){const{scrollDown:t,stats:{scrolled:e}}=i;return{type:t?"[NGX_ISE] DOWN":"[NGX_ISE] UP",payload:{currentScrollPosition:e}}}let bL=(()=>{class i{constructor(e,n){this.element=e,this.zone=n,this.scrolled=new Si,this.scrolledUp=new Si,this.infiniteScrollDistance=2,this.infiniteScrollUpDistance=1.5,this.infiniteScrollThrottle=150,this.infiniteScrollDisabled=!1,this.infiniteScrollContainer=null,this.scrollWindow=!0,this.immediateCheck=!1,this.horizontal=!1,this.alwaysCallback=!1,this.fromRoot=!1}ngAfterViewInit(){this.infiniteScrollDisabled||this.setup()}ngOnChanges({infiniteScrollContainer:e,infiniteScrollDisabled:n,infiniteScrollDistance:r}){const s=mz(e),a=mz(n),l=mz(r),u=!a&&!this.infiniteScrollDisabled||a&&!n.currentValue||l;(s||a||l)&&(this.destroyScroller(),u&&this.setup())}setup(){(function lIe(){return"undefined"!=typeof window})()&&this.zone.runOutsideAngular(()=>{this.disposeScroller=CIe({fromRoot:this.fromRoot,alwaysCallback:this.alwaysCallback,disable:this.infiniteScrollDisabled,downDistance:this.infiniteScrollDistance,element:this.element,horizontal:this.horizontal,scrollContainer:this.infiniteScrollContainer,scrollWindow:this.scrollWindow,throttle:this.infiniteScrollThrottle,upDistance:this.infiniteScrollUpDistance}).subscribe(e=>this.zone.run(()=>this.handleOnScroll(e)))})}handleOnScroll({type:e,payload:n}){switch(e){case"[NGX_ISE] DOWN":return this.scrolled.emit(n);case"[NGX_ISE] UP":return this.scrolledUp.emit(n);default:return}}ngOnDestroy(){this.destroyScroller()}destroyScroller(){this.disposeScroller&&this.disposeScroller.unsubscribe()}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(Rn))},i.\u0275dir=Be({type:i,selectors:[["","infiniteScroll",""],["","infinite-scroll",""],["","data-infinite-scroll",""]],inputs:{infiniteScrollDistance:"infiniteScrollDistance",infiniteScrollUpDistance:"infiniteScrollUpDistance",infiniteScrollThrottle:"infiniteScrollThrottle",infiniteScrollDisabled:"infiniteScrollDisabled",infiniteScrollContainer:"infiniteScrollContainer",scrollWindow:"scrollWindow",immediateCheck:"immediateCheck",horizontal:"horizontal",alwaysCallback:"alwaysCallback",fromRoot:"fromRoot"},outputs:{scrolled:"scrolled",scrolledUp:"scrolledUp"},features:[Ls]}),i})(),xL=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({providers:[],imports:[[]]}),i})(),see=(()=>{class i{transform(e,n,r=!0){return e&&0!==e.length&&0!==n?r?(console.debug(`Limiting to ${n} segments.`),e.slice(0,n)):e:[]}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275pipe=Hn({name:"LimitPipe",type:i,pure:!0}),i})(),wL=(()=>{class i{transform(e,n){return e&&0!==e.length?0===n.length?e:e.filter(r=>n.every(s=>s(r))):[]}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275pipe=Hn({name:"FilterPipe",type:i,pure:!0}),i})();function AIe(i,t){1&i&&(Z(0,"p",3),ue(1,"No results available. Please start a search..."),J())}function DIe(i,t){1&i&&(Z(0,"p",3),yt(1,"mat-spinner"),J())}function RIe(i,t){if(1&i){const e=Wi();Z(0,"button",13),je("click",function(){const s=gt(e).$implicit,a=Re(2).$implicit;return Re().onHighlightButtonClicked(a.representativeSegment,s)}),Z(1,"mat-icon"),ue(2," album "),J()()}2&i&&Vd("matTooltip","Toggle '",t.$implicit.name,"' tag")}function kIe(i,t){if(1&i&&(Z(0,"div",11),Ue(1,RIe,3,1,"button",12),J()),2&i){const e=Re(2);se(1),fe("ngForOf",e._selectionService._available)}}function PIe(i,t){if(1&i){const e=Wi();Z(0,"div",14)(1,"div")(2,"button",15),je("click",function(){gt(e);const r=Re().$implicit;return Re().onMltButtonClicked(r.representativeSegment)}),Z(3,"mat-icon"),ue(4,"youtube_searched_for"),J()()(),Z(5,"div")(6,"button",16),je("click",function(){gt(e);const r=Re().$implicit;return Re().onDetailsButtonClicked(r.representativeSegment)}),Z(7,"mat-icon"),ue(8,"remove_red_eye"),J()()(),Z(9,"div")(10,"button",17),je("click",function(){gt(e);const r=Re().$implicit;return Re().onInformationButtonClicked(r.representativeSegment)}),Z(11,"mat-icon"),ue(12,"help"),J()()()()}if(2&i){const e=Re().$implicit;A("background",Re().backgroundForSegment(e.representativeSegment))}}function IIe(i,t){if(1&i){const e=Wi();Z(0,"div",4),je("dragstart",function(r){const a=gt(e).$implicit;return Re().onTileDrag(r,a.representativeSegment,a)})("mouseenter",function(){const s=gt(e).$implicit;return Re().focus=s})("mouseleave",function(){return gt(e),Re().focus=null}),Z(1,"div",5)(2,"div",6)(3,"div"),ue(4),J(),Ue(5,kIe,2,1,"div",7),J(),Z(6,"div",8)(7,"p"),ue(8),ti(9,"ScorePercentagePipe"),J(),Z(10,"p")(11,"mat-icon"),ue(12,"filter_none"),J(),ue(13),J()()(),Z(14,"img",9),je("click",function(){const s=gt(e).$implicit;return Re().onDetailsButtonClicked(s.representativeSegment)}),ti(15,"ThumbnailPathPipe"),J(),Ue(16,PIe,13,2,"div",10),J()}if(2&i){const e=t.$implicit,n=Re();se(1),A("background",n.backgroundForSegment(e.representativeSegment)),se(3),ui(" ",e.name," "),se(1),fe("ngIf",n.inFocus(e)),se(3),ui("",Qi(9,8,e._score),";"),se(5),ui("\xa0",e.numberOfSegments,""),se(1),_o("src",Bs(15,10,e,e.representativeSegment),Mc),se(2),fe("ngIf",n.inFocus(e))}}let LIe=(()=>{class i extends FH{constructor(e,n,r,s,a,l,u,h){super(e,n,r,s,a,l,u),this._resolver=h,this.name="object_gallery",this._tilesize=250,this._tilegap=15}set focus(e){this._focus=e}get tilesize(){return this._tilesize}set tilesize(e){e>10&&(this._tilesize=e)}get tilegap(){return this._tilegap}set tilegap(e){e>2&&(this._tilegap=e)}get filters(){return this._filterService._objectFilters}inFocus(e){return this._focus===e}scrollIncrement(){return 200}subscribe(e){e&&(this._dataSource=e.mediaobjectsAsObservable)}onHighlightButtonClicked(e,n){this._selectionService.toggle(n,e.segmentId)}}return i.\u0275fac=function(e){return new(e||i)(B(Pn),B(Rc),B(Rp),B(Bh),B(Zc),B(Ql),B(Ru),B(Ts))},i.\u0275cmp=ei({type:i,selectors:[["app-gallery"]],features:[It],decls:11,vars:24,consts:[["class","background-prompt",4,"ngIf"],["infiniteScroll","",1,"gallery",3,"fromRoot","infiniteScrollContainer","infiniteScrollDistance","infiniteScrollUpDistance","alwaysCallback","scrolled"],["class","tile","draggable","true",3,"dragstart","mouseenter","mouseleave",4,"ngFor","ngForOf"],[1,"background-prompt"],["draggable","true",1,"tile",3,"dragstart","mouseenter","mouseleave"],["fxLayout","","fxLayoutAlign","space-between start",1,"header"],[1,"filename"],["class","tags","fxLayout","row",4,"ngIf"],[1,"score"],["draggable","false",1,"body",3,"src","click"],["class","footer","fxLayout","row-reverse",3,"background",4,"ngIf"],["fxLayout","row",1,"tags"],["mat-icon-button","",3,"matTooltip","click",4,"ngFor","ngForOf"],["mat-icon-button","",3,"matTooltip","click"],["fxLayout","row-reverse",1,"footer"],["mat-icon-button","","matTooltip","More-like-this",3,"click"],["mat-icon-button","","matTooltip","Show details",3,"click"],["mat-icon-button","","matTooltip","Feature information",3,"click"]],template:function(e,n){1&e&&(Ue(0,AIe,2,0,"p",0),ti(1,"async"),Ue(2,DIe,2,0,"p",0),ti(3,"async"),Z(4,"div",1),je("scrolled",function(){return n.incrementCount()}),Ue(5,IIe,17,13,"div",2),ti(6,"LimitPipe"),ti(7,"FilterPipe"),ti(8,"OrderByScorePipe"),ti(9,"async"),ti(10,"async"),J()),2&e&&(fe("ngIf",!Qi(1,8,n._dataSource)&&!n._loading),se(2),fe("ngIf",!Qi(3,10,n._dataSource)&&n._loading),se(2),fe("fromRoot",!0)("infiniteScrollContainer","#scrollable")("infiniteScrollDistance",1)("infiniteScrollUpDistance",2)("alwaysCallback",!0),se(1),fe("ngForOf",Bs(6,12,Bs(7,15,Qi(8,18,Qi(9,20,n._dataSource)),Qi(10,22,n.filters)),n._count)))},directives:[ms,sf,bL,mo,ug,hg,Mo,Fo,vo],pipes:[Xc,see,wL,iL,Q$,yL],styles:[".gallery[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,250px);grid-template-rows:repeat(auto-fill,250px);grid-auto-flow:row;grid-row-gap:10px;grid-column-gap:10px}.tile[_ngcontent-%COMP%]{box-shadow:.15em .15em .05em #0006;position:relative;background:url(loading.a2f1714b50557147.png) no-repeat center;height:250px;width:250px}.tile[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{top:0;left:0;right:0;height:50px;padding:7.5px;position:absolute;z-index:100;opacity:.65;color:#000}.tile[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:contain}.tile[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{top:200px;left:0;right:0;height:50px;padding:5px;position:absolute;z-index:100;opacity:.65;color:#000}div.filename[_ngcontent-%COMP%]{max-width:80%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:14px}.tags[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{max-height:20px!important;max-width:20px!important;line-height:0!important}.tags[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{max-height:18px;max-width:18px}.tags[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:16px!important}div.score[_ngcontent-%COMP%]{max-width:80px;font-size:11px}div.score[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:.25em;margin-bottom:.25em}div.score[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:8px;width:10px;height:10px}"],changeDetection:0}),i})();var OIe=D(4292);let Va=(()=>{class i{}return i.VG_ENDED="ended",i.VG_PAUSED="paused",i.VG_PLAYING="playing",i.VG_LOADING="waiting",i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Ol=(()=>{class i{constructor(){this.medias={},this.playerReadyEvent=new Si(!0),this.isPlayerReady=!1}onPlayerReady(e){this.fsAPI=e,this.isPlayerReady=!0,this.playerReadyEvent.emit(this)}getDefaultMedia(){for(const e in this.medias)if(this.medias[e])return this.medias[e]}getMasterMedia(){let e;for(const n in this.medias)if("true"===this.medias[n].vgMaster||!0===this.medias[n].vgMaster){e=this.medias[n];break}return e||this.getDefaultMedia()}isMasterDefined(){let e=!1;for(const n in this.medias)if("true"===this.medias[n].vgMaster||!0===this.medias[n].vgMaster){e=!0;break}return e}getMediaById(e=null){let n=this.medias[e];return(!e||"*"===e)&&(n=this),n}play(){for(const e in this.medias)this.medias[e]&&this.medias[e].play()}pause(){for(const e in this.medias)this.medias[e]&&this.medias[e].pause()}get duration(){return this.$$getAllProperties("duration")}set currentTime(e){this.$$setAllProperties("currentTime",e)}get currentTime(){return this.$$getAllProperties("currentTime")}set state(e){this.$$setAllProperties("state",e)}get state(){return this.$$getAllProperties("state")}set volume(e){this.$$setAllProperties("volume",e)}get volume(){return this.$$getAllProperties("volume")}set playbackRate(e){this.$$setAllProperties("playbackRate",e)}get playbackRate(){return this.$$getAllProperties("playbackRate")}get canPlay(){return this.$$getAllProperties("canPlay")}get canPlayThrough(){return this.$$getAllProperties("canPlayThrough")}get isMetadataLoaded(){return this.$$getAllProperties("isMetadataLoaded")}get isWaiting(){return this.$$getAllProperties("isWaiting")}get isCompleted(){return this.$$getAllProperties("isCompleted")}get isLive(){return this.$$getAllProperties("isLive")}get isMaster(){return this.$$getAllProperties("isMaster")}get time(){return this.$$getAllProperties("time")}get buffer(){return this.$$getAllProperties("buffer")}get buffered(){return this.$$getAllProperties("buffered")}get subscriptions(){return this.$$getAllProperties("subscriptions")}get textTracks(){return this.$$getAllProperties("textTracks")}seekTime(e,n=!1){for(const r in this.medias)this.medias[r]&&this.$$seek(this.medias[r],e,n)}$$seek(e,n,r=!1){let s,a=e.duration;r?(this.isMasterDefined()&&(a=this.getMasterMedia().duration),s=n*a/100):s=n,e.currentTime=s}addTextTrack(e,n,r){for(const s in this.medias)this.medias[s]&&this.$$addTextTrack(this.medias[s],e,n,r)}$$addTextTrack(e,n,r,s){e.addTextTrack(n,r,s)}$$getAllProperties(e){const n={};let r;for(const a in this.medias)this.medias[a]&&(n[a]=this.medias[a]);switch(Object.keys(n).length){case 0:switch(e){case"state":r=Va.VG_PAUSED;break;case"playbackRate":case"volume":r=1;break;case"time":r={current:0,total:0,left:0}}break;case 1:r=n[Object.keys(n)[0]][e];break;default:r=n[this.getMasterMedia().id][e]}return r}$$setAllProperties(e,n){for(const r in this.medias)this.medias[r]&&(this.medias[r][e]=n)}registerElement(e){this.videogularElement=e}registerMedia(e){this.medias[e.id]=e}unregisterMedia(e){delete this.medias[e.id]}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),_C=(()=>{class i{constructor(){this.isHiddenSubject=new ii,this.isHidden=this.isHiddenSubject.asObservable()}state(e){this.isHiddenSubject.next(e)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),BE=(()=>{class i{static getZIndex(){let n,e=1;const r=document.getElementsByTagName("*");for(let s=0,a=r.length;s<a;s++)n=parseInt(window.getComputedStyle(r[s])["z-index"],10),n>e&&(e=n+1);return e}static isMobileDevice(){return void 0!==window.orientation||-1!==navigator.userAgent.indexOf("IEMobile")}static isiOSDevice(){return(navigator.userAgent.match(/ip(hone|ad|od)/i)||i.isIpadOS())&&!navigator.userAgent.match(/(iemobile)[\/\s]?([\w\.]*)/i)}static isIpadOS(){return navigator.maxTouchPoints&&navigator.maxTouchPoints>2&&/MacIntel/.test(navigator.platform)}static isCordova(){return-1===document.URL.indexOf("http://")&&-1===document.URL.indexOf("https://")}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),NE=(()=>{class i{constructor(){this.nativeFullscreen=!0,this.isFullscreen=!1,this.onChangeFullscreen=new Si}init(e,n){this.videogularElement=e,this.medias=n;const r={w3:{enabled:"fullscreenEnabled",element:"fullscreenElement",request:"requestFullscreen",exit:"exitFullscreen",onchange:"fullscreenchange",onerror:"fullscreenerror"},newWebkit:{enabled:"webkitFullscreenEnabled",element:"webkitFullscreenElement",request:"webkitRequestFullscreen",exit:"webkitExitFullscreen",onchange:"webkitfullscreenchange",onerror:"webkitfullscreenerror"},oldWebkit:{enabled:"webkitIsFullScreen",element:"webkitCurrentFullScreenElement",request:"webkitRequestFullScreen",exit:"webkitCancelFullScreen",onchange:"webkitfullscreenchange",onerror:"webkitfullscreenerror"},moz:{enabled:"mozFullScreen",element:"mozFullScreenElement",request:"mozRequestFullScreen",exit:"mozCancelFullScreen",onchange:"mozfullscreenchange",onerror:"mozfullscreenerror"},ios:{enabled:"webkitFullscreenEnabled",element:"webkitFullscreenElement",request:"webkitEnterFullscreen",exit:"webkitExitFullscreen",onchange:"webkitendfullscreen",onerror:"webkitfullscreenerror"},ms:{enabled:"msFullscreenEnabled",element:"msFullscreenElement",request:"msRequestFullscreen",exit:"msExitFullscreen",onchange:"MSFullscreenChange",onerror:"MSFullscreenError"}};for(const a in r)if(r[a].enabled in document){this.polyfill=r[a];break}if(BE.isiOSDevice()&&(this.polyfill=r.ios),this.isAvailable=null!=this.polyfill,null==this.polyfill)return;let s;switch(this.polyfill.onchange){case"mozfullscreenchange":s=document;break;case"webkitendfullscreen":s=this.medias.toArray()[0].elem;break;default:s=e}this.fsChangeSubscription=os(s,this.polyfill.onchange).subscribe(()=>{this.onFullscreenChange()})}onFullscreenChange(){this.isFullscreen=!!document[this.polyfill.element],this.onChangeFullscreen.emit(this.isFullscreen)}toggleFullscreen(e=null){this.isFullscreen?this.exit():this.request(e)}request(e){e||(e=this.videogularElement),this.isFullscreen=!0,this.onChangeFullscreen.emit(!0),this.isAvailable&&this.nativeFullscreen&&(BE.isMobileDevice()?((!this.polyfill.enabled&&e===this.videogularElement||BE.isiOSDevice())&&(e=this.medias.toArray()[0].elem),this.enterElementInFullScreen(e)):this.enterElementInFullScreen(this.videogularElement))}enterElementInFullScreen(e){e[this.polyfill.request]()}exit(){this.isFullscreen=!1,this.onChangeFullscreen.emit(!1),this.isAvailable&&this.nativeFullscreen&&document[this.polyfill.exit]()}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),No=(()=>{class i{}return i.VG_ABORT="abort",i.VG_CAN_PLAY="canplay",i.VG_CAN_PLAY_THROUGH="canplaythrough",i.VG_DURATION_CHANGE="durationchange",i.VG_EMPTIED="emptied",i.VG_ENCRYPTED="encrypted",i.VG_ENDED="ended",i.VG_ERROR="error",i.VG_LOADED_DATA="loadeddata",i.VG_LOADED_METADATA="loadedmetadata",i.VG_LOAD_START="loadstart",i.VG_PAUSE="pause",i.VG_PLAY="play",i.VG_PLAYING="playing",i.VG_PROGRESS="progress",i.VG_RATE_CHANGE="ratechange",i.VG_SEEK="seek",i.VG_SEEKED="seeked",i.VG_SEEKING="seeking",i.VG_STALLED="stalled",i.VG_SUSPEND="suspend",i.VG_TIME_UPDATE="timeupdate",i.VG_VOLUME_CHANGE="volumechange",i.VG_WAITING="waiting",i.VG_LOAD="load",i.VG_ENTER="enter",i.VG_EXIT="exit",i.VG_START_ADS="startads",i.VG_END_ADS="endads",i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),oee=(()=>{class i{constructor(e){this.ref=e,this.onEnterCuePoint=new Si,this.onUpdateCuePoint=new Si,this.onExitCuePoint=new Si,this.onCompleteCuePoint=new Si,this.subscriptions=[],this.cuesSubscriptions=[],this.totalCues=0}ngOnInit(){this.onLoad$=os(this.ref.nativeElement,No.VG_LOAD),this.subscriptions.push(this.onLoad$.subscribe(this.onLoad.bind(this)))}onLoad(e){const n=e.target.track.cues;this.ref.nativeElement.cues=n,this.updateCuePoints(n)}updateCuePoints(e){this.cuesSubscriptions.forEach(n=>n.unsubscribe());for(let n=0,r=e.length;n<r;n++)this.onEnter$=os(e[n],No.VG_ENTER),this.cuesSubscriptions.push(this.onEnter$.subscribe(this.onEnter.bind(this))),this.onExit$=os(e[n],No.VG_EXIT),this.cuesSubscriptions.push(this.onExit$.subscribe(this.onExit.bind(this)))}onEnter(e){this.onEnterCuePoint.emit(e.target)}onExit(e){this.onExitCuePoint.emit(e.target)}ngDoCheck(){this.ref.nativeElement.track&&this.ref.nativeElement.track.cues&&this.totalCues!==this.ref.nativeElement.track.cues.length&&(this.totalCues=this.ref.nativeElement.track.cues.length,this.ref.nativeElement.cues=this.ref.nativeElement.track.cues,this.updateCuePoints(this.ref.nativeElement.track.cues))}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe())}}return i.\u0275fac=function(e){return new(e||i)(B(ai))},i.\u0275dir=Be({type:i,selectors:[["","vgCuePoints",""]],outputs:{onEnterCuePoint:"onEnterCuePoint",onUpdateCuePoint:"onUpdateCuePoint",onExitCuePoint:"onExitCuePoint",onCompleteCuePoint:"onCompleteCuePoint"}}),i})(),_z=(()=>{class i{constructor(e,n){this.api=e,this.ref=n,this.state=Va.VG_PAUSED,this.time={current:0,total:0,left:0},this.buffer={end:0},this.canPlay=!1,this.canPlayThrough=!1,this.isMetadataLoaded=!1,this.isWaiting=!1,this.isCompleted=!1,this.isLive=!1,this.isBufferDetected=!1,this.checkInterval=200,this.currentPlayPos=0,this.lastPlayPos=0,this.playAtferSync=!1,this.bufferDetected=new ii}ngOnInit(){this.elem=this.vgMedia.nodeName?this.vgMedia:this.vgMedia.elem,this.api.registerMedia(this),this.subscriptions={abort:os(this.elem,No.VG_ABORT),canPlay:os(this.elem,No.VG_CAN_PLAY),canPlayThrough:os(this.elem,No.VG_CAN_PLAY_THROUGH),durationChange:os(this.elem,No.VG_DURATION_CHANGE),emptied:os(this.elem,No.VG_EMPTIED),encrypted:os(this.elem,No.VG_ENCRYPTED),ended:os(this.elem,No.VG_ENDED),error:os(this.elem,No.VG_ERROR),loadedData:os(this.elem,No.VG_LOADED_DATA),loadedMetadata:os(this.elem,No.VG_LOADED_METADATA),loadStart:os(this.elem,No.VG_LOAD_START),pause:os(this.elem,No.VG_PAUSE),play:os(this.elem,No.VG_PLAY),playing:os(this.elem,No.VG_PLAYING),progress:os(this.elem,No.VG_PROGRESS),rateChange:os(this.elem,No.VG_RATE_CHANGE),seeked:os(this.elem,No.VG_SEEKED),seeking:os(this.elem,No.VG_SEEKING),stalled:os(this.elem,No.VG_STALLED),suspend:os(this.elem,No.VG_SUSPEND),timeUpdate:os(this.elem,No.VG_TIME_UPDATE),volumeChange:os(this.elem,No.VG_VOLUME_CHANGE),waiting:os(this.elem,No.VG_WAITING),startAds:os(window,No.VG_START_ADS),endAds:os(window,No.VG_END_ADS),mutation:new ft(e=>{const n=new MutationObserver(r=>{e.next(r)});return n.observe(this.elem,{childList:!0,attributes:!0}),()=>{n.disconnect()}}),bufferDetected:this.bufferDetected},this.mutationObs=this.subscriptions.mutation.subscribe(this.onMutation.bind(this)),this.canPlayObs=this.subscriptions.canPlay.subscribe(this.onCanPlay.bind(this)),this.canPlayThroughObs=this.subscriptions.canPlayThrough.subscribe(this.onCanPlayThrough.bind(this)),this.loadedMetadataObs=this.subscriptions.loadedMetadata.subscribe(this.onLoadMetadata.bind(this)),this.waitingObs=this.subscriptions.waiting.subscribe(this.onWait.bind(this)),this.progressObs=this.subscriptions.progress.subscribe(this.onProgress.bind(this)),this.endedObs=this.subscriptions.ended.subscribe(this.onComplete.bind(this)),this.playingObs=this.subscriptions.playing.subscribe(this.onStartPlaying.bind(this)),this.playObs=this.subscriptions.play.subscribe(this.onPlay.bind(this)),this.pauseObs=this.subscriptions.pause.subscribe(this.onPause.bind(this)),this.timeUpdateObs=this.subscriptions.timeUpdate.subscribe(this.onTimeUpdate.bind(this)),this.volumeChangeObs=this.subscriptions.volumeChange.subscribe(this.onVolumeChange.bind(this)),this.errorObs=this.subscriptions.error.subscribe(this.onError.bind(this)),this.vgMaster&&this.api.playerReadyEvent.subscribe(()=>{this.prepareSync()})}prepareSync(){const e=[];for(const n in this.api.medias)this.api.medias[n]&&e.push(this.api.medias[n].subscriptions.canPlay);this.canPlayAllSubscription=zb(e).pipe(Ui((...n)=>{n.some(a=>!!(null==a?void 0:a.target)&&4===a.target.readyState)&&!this.syncSubscription&&(this.startSync(),this.syncSubscription.unsubscribe())})).subscribe()}startSync(){this.syncSubscription=ay(0,1e3).subscribe(()=>{for(const e in this.api.medias)if(this.api.medias[e]!==this){const n=this.api.medias[e].currentTime-this.currentTime;n<-.3||n>.3?(this.playAtferSync=this.state===Va.VG_PLAYING,this.pause(),this.api.medias[e].pause(),this.api.medias[e].currentTime=this.currentTime):this.playAtferSync&&(this.play(),this.api.medias[e].play(),this.playAtferSync=!1)}})}onMutation(e){for(let n=0,r=e.length;n<r;n++){const s=e[n];if("attributes"===s.type&&"src"===s.attributeName){if(s.target.src&&s.target.src.length>0&&s.target.src.indexOf("blob:")<0){this.loadMedia();break}}else if("childList"===s.type&&s.removedNodes.length&&"source"===s.removedNodes[0].nodeName.toLowerCase()){this.loadMedia();break}}}loadMedia(){this.vgMedia.pause(),this.vgMedia.currentTime=0,this.stopBufferCheck(),this.isBufferDetected=!0,this.bufferDetected.next(this.isBufferDetected),setTimeout(()=>this.vgMedia.load(),10)}play(){if(!(this.playPromise||this.state!==Va.VG_PAUSED&&this.state!==Va.VG_ENDED))return this.playPromise=this.vgMedia.play(),this.playPromise&&this.playPromise.then&&this.playPromise.catch&&this.playPromise.then(()=>{this.playPromise=null}).catch(()=>{this.playPromise=null}),this.playPromise}pause(){this.playPromise?this.playPromise.then(()=>{this.vgMedia.pause()}):this.vgMedia.pause()}get id(){let e;return this.vgMedia&&(e=this.vgMedia.id),e}get duration(){return this.vgMedia.duration===1/0?this.specifiedDuration:this.vgMedia.duration}set currentTime(e){this.vgMedia.currentTime=e}get currentTime(){return this.vgMedia.currentTime}set volume(e){this.vgMedia.volume=e}get volume(){return this.vgMedia.volume}set playbackRate(e){this.vgMedia.playbackRate=e}get playbackRate(){return this.vgMedia.playbackRate}get buffered(){return this.vgMedia.buffered}get textTracks(){return this.vgMedia.textTracks}onCanPlay(e){this.isBufferDetected=!1,this.bufferDetected.next(this.isBufferDetected),this.canPlay=!0,this.ref.detectChanges()}onCanPlayThrough(e){this.isBufferDetected=!1,this.bufferDetected.next(this.isBufferDetected),this.canPlayThrough=!0,this.ref.detectChanges()}onLoadMetadata(e){this.isMetadataLoaded=!0,this.time={current:0,left:0,total:1e3*this.duration},this.state=Va.VG_PAUSED;const n=Math.round(this.time.total);this.isLive=n===1/0,this.ref.detectChanges()}onWait(e){this.isWaiting=!0,this.ref.detectChanges()}onComplete(e){this.isCompleted=!0,this.state=Va.VG_ENDED,this.ref.detectChanges()}onStartPlaying(e){this.state=Va.VG_PLAYING,this.ref.detectChanges()}onPlay(e){this.state=Va.VG_PLAYING,this.vgMaster&&(!this.syncSubscription||this.syncSubscription.closed)&&this.startSync(),this.startBufferCheck(),this.ref.detectChanges()}onPause(e){this.state=Va.VG_PAUSED,this.vgMaster&&(this.playAtferSync||this.syncSubscription.unsubscribe()),this.stopBufferCheck(),this.ref.detectChanges()}onTimeUpdate(e){const n=this.buffered.length-1;this.time={current:1e3*this.currentTime,total:this.time.total,left:1e3*(this.duration-this.currentTime)},n>=0&&(this.buffer={end:1e3*this.buffered.end(n)}),this.ref.detectChanges()}onProgress(e){const n=this.buffered.length-1;n>=0&&(this.buffer={end:1e3*this.buffered.end(n)}),this.ref.detectChanges()}onVolumeChange(e){this.ref.detectChanges()}onError(e){this.ref.detectChanges()}bufferCheck(){const e=1/this.checkInterval;this.currentPlayPos=this.currentTime,!this.isBufferDetected&&this.currentPlayPos<this.lastPlayPos+e&&(this.isBufferDetected=!0),this.isBufferDetected&&this.currentPlayPos>this.lastPlayPos+e&&(this.isBufferDetected=!1),this.bufferDetected.closed||this.bufferDetected.next(this.isBufferDetected),this.lastPlayPos=this.currentPlayPos}startBufferCheck(){this.checkBufferSubscription=ay(0,this.checkInterval).subscribe(()=>{this.bufferCheck()})}stopBufferCheck(){this.checkBufferSubscription&&this.checkBufferSubscription.unsubscribe(),this.isBufferDetected=!1,this.bufferDetected.next(this.isBufferDetected)}seekTime(e,n=!1){let r;r=n?e*this.duration/100:e,this.currentTime=r}addTextTrack(e,n,r,s){const a=this.vgMedia.addTextTrack(e,n,r);return s&&(a.mode=s),a}ngOnDestroy(){var e,n,r,s,a,l,u,h,m,_,v,S,T,I,j,P,E;this.vgMedia.src="",null===(e=this.mutationObs)||void 0===e||e.unsubscribe(),null===(n=this.canPlayObs)||void 0===n||n.unsubscribe(),null===(r=this.canPlayThroughObs)||void 0===r||r.unsubscribe(),null===(s=this.loadedMetadataObs)||void 0===s||s.unsubscribe(),null===(a=this.waitingObs)||void 0===a||a.unsubscribe(),null===(l=this.progressObs)||void 0===l||l.unsubscribe(),null===(u=this.endedObs)||void 0===u||u.unsubscribe(),null===(h=this.playingObs)||void 0===h||h.unsubscribe(),null===(m=this.playObs)||void 0===m||m.unsubscribe(),null===(_=this.pauseObs)||void 0===_||_.unsubscribe(),null===(v=this.timeUpdateObs)||void 0===v||v.unsubscribe(),null===(S=this.volumeChangeObs)||void 0===S||S.unsubscribe(),null===(T=this.errorObs)||void 0===T||T.unsubscribe(),null===(I=this.checkBufferSubscription)||void 0===I||I.unsubscribe(),null===(j=this.syncSubscription)||void 0===j||j.unsubscribe(),null===(P=this.bufferDetected)||void 0===P||P.complete(),null===(E=this.bufferDetected)||void 0===E||E.unsubscribe(),this.api.unregisterMedia(this)}}return i.\u0275fac=function(e){return new(e||i)(B(Ol),B(Pn))},i.\u0275dir=Be({type:i,selectors:[["","vgMedia",""]],inputs:{vgMedia:"vgMedia",vgMaster:"vgMaster"}}),i})();const FIe=["*"];let BIe=(()=>{class i{constructor(e,n,r,s){this.api=n,this.fsAPI=r,this.controlsHidden=s,this.isFullscreen=!1,this.isNativeFullscreen=!1,this.areControlsHidden=!1,this.onPlayerReady=new Si,this.onMediaReady=new Si,this.subscriptions=[],this.elem=e.nativeElement,this.api.registerElement(this.elem)}ngAfterContentInit(){this.medias.toArray().forEach(e=>{this.api.registerMedia(e)}),this.fsAPI.init(this.elem,this.medias),this.subscriptions.push(this.fsAPI.onChangeFullscreen.subscribe(this.onChangeFullscreen.bind(this))),this.subscriptions.push(this.controlsHidden.isHidden.subscribe(this.onHideControls.bind(this))),this.api.onPlayerReady(this.fsAPI),this.onPlayerReady.emit(this.api)}onChangeFullscreen(e){this.fsAPI.nativeFullscreen?this.isNativeFullscreen=e:(this.isFullscreen=e,this.zIndex=e?BE.getZIndex().toString():"auto")}onHideControls(e){this.areControlsHidden=e}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe())}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(Ol),B(NE),B(_C))},i.\u0275cmp=ei({type:i,selectors:[["vg-player"]],contentQueries:function(e,n,r){if(1&e&&Er(r,_z,4),2&e){let s;jt(s=qt())&&(n.medias=s)}},hostVars:8,hostBindings:function(e,n){2&e&&(A("z-index",n.zIndex),N("fullscreen",n.isFullscreen)("native-fullscreen",n.isNativeFullscreen)("controls-hidden",n.areControlsHidden))},outputs:{onPlayerReady:"onPlayerReady",onMediaReady:"onMediaReady"},features:[Sn([Ol,NE,_C])],ngContentSelectors:FIe,decls:1,vars:0,template:function(e,n){1&e&&(As(),hr(0))},styles:['vg-player{font-family:"videogular";position:relative;display:flex;width:100%;height:100%;overflow:hidden;background-color:#000}vg-player.fullscreen{position:fixed;left:0;top:0}vg-player.native-fullscreen.controls-hidden{cursor:none}\n'],encapsulation:2}),i})();const NIe=[Ol,_C,NE,BE,No,Va];let Lg=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({providers:[...NIe],imports:[[ka]]}),i})();const HIe=["*"];let aee=(()=>{class i{constructor(e,n,r){this.API=e,this.hidden=r,this.isAdsPlaying="initial",this.hideControls=!1,this.vgAutohide=!1,this.vgAutohideTime=3,this.subscriptions=[],this.elem=n.nativeElement}ngOnInit(){this.mouseMove$=os(this.API.videogularElement,"mousemove"),this.subscriptions.push(this.mouseMove$.subscribe(this.show.bind(this))),this.touchStart$=os(this.API.videogularElement,"touchstart"),this.subscriptions.push(this.touchStart$.subscribe(this.show.bind(this))),this.mouseClick$=os(this.API.videogularElement,"click"),this.subscriptions.push(this.mouseClick$.subscribe(this.show.bind(this))),this.API.isPlayerReady?this.onPlayerReady():this.subscriptions.push(this.API.playerReadyEvent.subscribe(()=>this.onPlayerReady()))}onPlayerReady(){this.target=this.API.getMediaById(this.vgFor),this.subscriptions.push(this.target.subscriptions.play.subscribe(this.onPlay.bind(this))),this.subscriptions.push(this.target.subscriptions.pause.subscribe(this.onPause.bind(this))),this.subscriptions.push(this.target.subscriptions.startAds.subscribe(this.onStartAds.bind(this))),this.subscriptions.push(this.target.subscriptions.endAds.subscribe(this.onEndAds.bind(this)))}ngAfterViewInit(){this.vgAutohide?this.hide():this.show()}onPlay(){this.vgAutohide&&this.hide()}onPause(){clearTimeout(this.timer),this.hideControls=!1,this.hidden.state(!1)}onStartAds(){this.isAdsPlaying="none"}onEndAds(){this.isAdsPlaying="initial"}hide(){this.vgAutohide&&(clearTimeout(this.timer),this.hideAsync())}show(){clearTimeout(this.timer),this.hideControls=!1,this.hidden.state(!1),this.vgAutohide&&this.hideAsync()}hideAsync(){this.API.state===Va.VG_PLAYING&&(this.timer=setTimeout(()=>{this.hideControls=!0,this.hidden.state(!0)},1e3*this.vgAutohideTime))}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe())}}return i.\u0275fac=function(e){return new(e||i)(B(Ol),B(ai),B(_C))},i.\u0275cmp=ei({type:i,selectors:[["vg-controls"]],hostVars:4,hostBindings:function(e,n){2&e&&(A("pointer-events",n.isAdsPlaying),N("hide",n.hideControls))},inputs:{vgFor:"vgFor",vgAutohide:"vgAutohide",vgAutohideTime:"vgAutohideTime"},ngContentSelectors:HIe,decls:1,vars:0,template:function(e,n){1&e&&(As(),hr(0))},styles:["vg-controls{position:absolute;display:flex;width:100%;height:50px;z-index:300;bottom:0;background-color:#00000080;transition:bottom 1s}vg-controls.hide{bottom:-50px}\n"],encapsulation:2}),i})();function jIe(i,t){1&i&&(Z(0,"span"),ue(1,"LIVE"),J())}function qIe(i,t){if(1&i&&(Z(0,"span"),ue(1),ti(2,"vgUtc"),J()),2&i){const e=Re();se(1),Xt(Bs(2,1,e.getTime(),e.vgFormat))}}const XIe=["*"];let lee=(()=>{class i{transform(e,n){let r=new Date(e),s=n,a=r.getUTCSeconds(),l=r.getUTCMinutes(),u=r.getUTCHours();return a<10&&(a="0"+a),l<10&&(l="0"+l),u<10&&(u="0"+u),s=s.replace(/ss/g,a),s=s.replace(/mm/g,l),s=s.replace(/hh/g,u),s}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275pipe=Hn({name:"vgUtc",type:i,pure:!0}),i})(),cee=(()=>{class i{constructor(e,n){this.API=n,this.vgProperty="current",this.vgFormat="mm:ss",this.subscriptions=[],this.elem=e.nativeElement}ngOnInit(){this.API.isPlayerReady?this.onPlayerReady():this.subscriptions.push(this.API.playerReadyEvent.subscribe(()=>this.onPlayerReady()))}onPlayerReady(){this.target=this.API.getMediaById(this.vgFor)}getTime(){let e=0;return this.target&&(e=Math.round(this.target.time[this.vgProperty]),e=isNaN(e)||this.target.isLive?0:e),e}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe())}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(Ol))},i.\u0275cmp=ei({type:i,selectors:[["vg-time-display"]],inputs:{vgFor:"vgFor",vgProperty:"vgProperty",vgFormat:"vgFormat"},ngContentSelectors:XIe,decls:3,vars:2,consts:[[4,"ngIf"]],template:function(e,n){1&e&&(As(),Ue(0,jIe,2,0,"span",0),Ue(1,qIe,3,4,"span",0),hr(2)),2&e&&(fe("ngIf",null==n.target?null:n.target.isLive),se(1),fe("ngIf",!(null!=n.target&&n.target.isLive)))},directives:[ms],pipes:[lee],styles:["vg-time-display{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;display:flex;justify-content:center;height:50px;width:60px;cursor:pointer;color:#fff;line-height:50px;pointer-events:none;font-family:Helvetica Neue,Helvetica,Arial,sans-serif}\n"],encapsulation:2}),i})();const ZIe=["*"];let uee=(()=>{class i{constructor(e,n,r){this.API=n,this.hideScrubBar=!1,this.vgSlider=!0,this.isSeeking=!1,this.wasPlaying=!1,this.subscriptions=[],this.elem=e.nativeElement,this.subscriptions.push(r.isHidden.subscribe(s=>this.onHideScrubBar(s)))}ngOnInit(){this.API.isPlayerReady?this.onPlayerReady():this.subscriptions.push(this.API.playerReadyEvent.subscribe(()=>this.onPlayerReady()))}onPlayerReady(){this.target=this.API.getMediaById(this.vgFor)}seekStart(){this.target.canPlay&&(this.isSeeking=!0,this.target.state===Va.VG_PLAYING&&(this.wasPlaying=!0),this.target.pause())}seekMove(e){if(this.isSeeking){const n=Math.max(Math.min(100*e/this.elem.scrollWidth,99.9),0);this.target.time.current=n*this.target.time.total/100,this.target.seekTime(n,!0)}}seekEnd(e){if(this.isSeeking=!1,this.target.canPlay){const n=Math.max(Math.min(100*e/this.elem.scrollWidth,99.9),0);this.target.seekTime(n,!0),this.wasPlaying&&(this.wasPlaying=!1,this.target.play())}}touchEnd(){this.isSeeking=!1,this.wasPlaying&&(this.wasPlaying=!1,this.target.play())}getTouchOffset(e){let n=0,r=e.target;for(;r;)n+=r.offsetLeft,r=r.offsetParent;return e.touches[0].pageX-n}onMouseDownScrubBar(e){this.target&&(this.target.isLive||(this.vgSlider?this.seekStart():this.seekEnd(e.offsetX)))}onMouseMoveScrubBar(e){this.target&&!this.target.isLive&&this.vgSlider&&this.isSeeking&&this.seekMove(e.offsetX)}onMouseUpScrubBar(e){this.target&&!this.target.isLive&&this.vgSlider&&this.isSeeking&&this.seekEnd(e.offsetX)}onTouchStartScrubBar(e){this.target&&(this.target.isLive||(this.vgSlider?this.seekStart():this.seekEnd(this.getTouchOffset(e))))}onTouchMoveScrubBar(e){this.target&&!this.target.isLive&&this.vgSlider&&this.isSeeking&&this.seekMove(this.getTouchOffset(e))}onTouchCancelScrubBar(e){this.target&&!this.target.isLive&&this.vgSlider&&this.isSeeking&&this.touchEnd()}onTouchEndScrubBar(e){this.target&&!this.target.isLive&&this.vgSlider&&this.isSeeking&&this.touchEnd()}arrowAdjustVolume(e){this.target&&(38===e.keyCode||39===e.keyCode?(e.preventDefault(),this.target.seekTime((this.target.time.current+5e3)/1e3,!1)):(37===e.keyCode||40===e.keyCode)&&(e.preventDefault(),this.target.seekTime((this.target.time.current-5e3)/1e3,!1)))}getPercentage(){return this.target?Math.round(100*this.target.time.current/this.target.time.total)+"%":"0%"}onHideScrubBar(e){this.hideScrubBar=e}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe())}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(Ol),B(_C))},i.\u0275cmp=ei({type:i,selectors:[["vg-scrub-bar"]],hostVars:2,hostBindings:function(e,n){1&e&&je("mousedown",function(s){return n.onMouseDownScrubBar(s)})("mousemove",function(s){return n.onMouseMoveScrubBar(s)},!1,Mh)("mouseup",function(s){return n.onMouseUpScrubBar(s)},!1,Mh)("touchstart",function(s){return n.onTouchStartScrubBar(s)})("touchmove",function(s){return n.onTouchMoveScrubBar(s)},!1,Mh)("touchcancel",function(s){return n.onTouchCancelScrubBar(s)},!1,Mh)("touchend",function(s){return n.onTouchEndScrubBar(s)},!1,Mh)("keydown",function(s){return n.arrowAdjustVolume(s)}),2&e&&N("hide",n.hideScrubBar)},inputs:{vgFor:"vgFor",vgSlider:"vgSlider"},ngContentSelectors:ZIe,decls:2,vars:2,consts:[["tabindex","0","role","slider","aria-label","scrub bar","aria-level","polite","aria-valuemin","0","aria-valuemax","100",1,"scrubBar"]],template:function(e,n){1&e&&(As(),Z(0,"div",0),hr(1),J()),2&e&&Vi("aria-valuenow",n.getPercentage())("aria-valuetext",n.getPercentage())},styles:["vg-scrub-bar{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;position:absolute;width:100%;height:5px;bottom:50px;margin:0;cursor:pointer;align-items:center;background:rgba(0,0,0,.75);z-index:250;transition:bottom 1s,opacity .5s}vg-scrub-bar .scrubBar{position:relative;display:flex;flex-grow:1;align-items:center;height:100%}vg-controls vg-scrub-bar{position:relative;bottom:0;background:transparent;height:50px;flex-grow:1;flex-basis:0;margin:0 10px;transition:none 0s ease 0s;transition:initial}vg-scrub-bar.hide{bottom:0;opacity:0}vg-controls vg-scrub-bar.hide{bottom:auto;bottom:initial;opacity:1;opacity:initial}\n"],encapsulation:2}),i})(),hee=(()=>{class i{constructor(e,n,r){this.API=n,this.cdr=r,this.subscriptions=[],this.ariaValue=1,this.elem=e.nativeElement,this.playbackValues=["0.5","1.0","1.5","2.0"],this.playbackIndex=1}ngOnInit(){this.API.isPlayerReady?this.onPlayerReady():this.subscriptions.push(this.API.playerReadyEvent.subscribe(()=>this.onPlayerReady()))}onPlayerReady(){this.target=this.API.getMediaById(this.vgFor)}onClick(){this.updatePlaybackSpeed()}onKeyDown(e){(13===e.keyCode||32===e.keyCode)&&(e.preventDefault(),this.updatePlaybackSpeed())}updatePlaybackSpeed(){this.playbackIndex=++this.playbackIndex%this.playbackValues.length,this.target instanceof Ol?this.target.playbackRate=this.playbackValues[this.playbackIndex]:this.target.playbackRate[this.vgFor]=this.playbackValues[this.playbackIndex],this.detectChanges()}getPlaybackRate(){return this.ariaValue=this.target?this.target.playbackRate:1,this.ariaValue}detectChanges(){try{this.cdr.detectChanges()}catch(e){console.warn(e)}}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe())}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(Ol),B(Pn))},i.\u0275cmp=ei({type:i,selectors:[["vg-playback-button"]],hostBindings:function(e,n){1&e&&je("click",function(){return n.onClick()})("keydown",function(s){return n.onKeyDown(s)})},inputs:{vgFor:"vgFor",playbackValues:"playbackValues"},decls:2,vars:2,consts:[["tabindex","0","role","button","aria-label","playback speed button",1,"button"]],template:function(e,n){1&e&&(Z(0,"span",0),ue(1),J()),2&e&&(Vi("aria-valuetext",n.ariaValue),se(1),ui(" ",n.getPlaybackRate(),"x "))},styles:["vg-playback-button{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;display:flex;justify-content:center;height:50px;width:50px;cursor:pointer;color:#fff;line-height:50px;font-family:Helvetica Neue,Helvetica,Arial,sans-serif}vg-playback-button .button{display:flex;align-items:center;justify-content:center;width:50px}\n"],encapsulation:2}),i})(),dee=(()=>{class i{constructor(e,n){this.API=n,this.subscriptions=[],this.ariaValue=Va.VG_PAUSED,this.elem=e.nativeElement}ngOnInit(){this.API.isPlayerReady?this.onPlayerReady():this.subscriptions.push(this.API.playerReadyEvent.subscribe(()=>this.onPlayerReady()))}onPlayerReady(){this.target=this.API.getMediaById(this.vgFor)}onClick(){this.playPause()}onKeyDown(e){(13===e.keyCode||32===e.keyCode)&&(e.preventDefault(),this.playPause())}playPause(){switch(this.getState()){case Va.VG_PLAYING:this.target.pause();break;case Va.VG_PAUSED:case Va.VG_ENDED:this.target.play()}}getState(){return this.ariaValue=this.target?this.target.state:Va.VG_PAUSED,this.ariaValue}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe())}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(Ol))},i.\u0275cmp=ei({type:i,selectors:[["vg-play-pause"]],hostBindings:function(e,n){1&e&&je("click",function(){return n.onClick()})("keydown",function(s){return n.onKeyDown(s)})},inputs:{vgFor:"vgFor"},decls:1,vars:6,consts:[["tabindex","0","role","button",1,"icon"]],template:function(e,n){1&e&&yt(0,"div",0),2&e&&(N("vg-icon-pause","playing"===n.getState())("vg-icon-play_arrow","paused"===n.getState()||"ended"===n.getState()),Vi("aria-label","paused"===n.getState()?"play":"pause")("aria-valuetext",n.ariaValue))},styles:["vg-play-pause{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;display:flex;justify-content:center;height:50px;width:50px;cursor:pointer;color:#fff;line-height:50px}vg-play-pause .icon{pointer-events:none}\n"],encapsulation:2}),i})(),fee=(()=>{class i{constructor(e,n){this.API=n,this.subscriptions=[],this.ariaValue="unmuted",this.elem=e.nativeElement}ngOnInit(){this.API.isPlayerReady?this.onPlayerReady():this.subscriptions.push(this.API.playerReadyEvent.subscribe(()=>this.onPlayerReady()))}onPlayerReady(){this.target=this.API.getMediaById(this.vgFor),this.currentVolume=this.target.volume}onClick(){this.changeMuteState()}onKeyDown(e){(13===e.keyCode||32===e.keyCode)&&(e.preventDefault(),this.changeMuteState())}changeMuteState(){const e=this.getVolume();0===e?(0===this.target.volume&&0===this.currentVolume&&(this.currentVolume=1),this.target.volume=this.currentVolume):(this.currentVolume=e,this.target.volume=0)}getVolume(){const e=this.target?this.target.volume:0;return this.ariaValue=e?"unmuted":"muted",e}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe())}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(Ol))},i.\u0275cmp=ei({type:i,selectors:[["vg-mute"]],hostBindings:function(e,n){1&e&&je("click",function(){return n.onClick()})("keydown",function(s){return n.onKeyDown(s)})},inputs:{vgFor:"vgFor"},decls:1,vars:9,consts:[["tabindex","0","role","button","aria-label","mute button",1,"icon"]],template:function(e,n){1&e&&yt(0,"div",0),2&e&&(N("vg-icon-volume_up",n.getVolume()>=.75)("vg-icon-volume_down",n.getVolume()>=.25&&n.getVolume()<.75)("vg-icon-volume_mute",n.getVolume()>0&&n.getVolume()<.25)("vg-icon-volume_off",0===n.getVolume()),Vi("aria-valuetext",n.ariaValue))},styles:["vg-mute{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;display:flex;justify-content:center;height:50px;width:50px;cursor:pointer;color:#fff;line-height:50px}vg-mute .icon{pointer-events:none}\n"],encapsulation:2}),i})(),pee=(()=>{class i{constructor(e,n,r){this.API=n,this.fsAPI=r,this.isFullscreen=!1,this.subscriptions=[],this.ariaValue="normal mode",this.elem=e.nativeElement,this.subscriptions.push(this.fsAPI.onChangeFullscreen.subscribe(this.onChangeFullscreen.bind(this)))}ngOnInit(){this.API.isPlayerReady?this.onPlayerReady():this.subscriptions.push(this.API.playerReadyEvent.subscribe(()=>this.onPlayerReady()))}onPlayerReady(){this.target=this.API.getMediaById(this.vgFor)}onChangeFullscreen(e){this.ariaValue=e?"fullscreen mode":"normal mode",this.isFullscreen=e}onClick(){this.changeFullscreenState()}onKeyDown(e){(13===e.keyCode||32===e.keyCode)&&(e.preventDefault(),this.changeFullscreenState())}changeFullscreenState(){let e=this.target;this.target instanceof Ol&&(e=null),this.fsAPI.toggleFullscreen(e)}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe())}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(Ol),B(NE))},i.\u0275cmp=ei({type:i,selectors:[["vg-fullscreen"]],hostBindings:function(e,n){1&e&&je("click",function(){return n.onClick()})("keydown",function(s){return n.onKeyDown(s)})},decls:1,vars:5,consts:[["tabindex","0","role","button","aria-label","fullscreen button",1,"icon"]],template:function(e,n){1&e&&yt(0,"div",0),2&e&&(N("vg-icon-fullscreen",!n.isFullscreen)("vg-icon-fullscreen_exit",n.isFullscreen),Vi("aria-valuetext",n.ariaValue))},styles:["vg-fullscreen{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;display:flex;justify-content:center;height:50px;width:50px;cursor:pointer;color:#fff;line-height:50px}vg-fullscreen .icon{pointer-events:none}\n"],encapsulation:2}),i})(),mee=(()=>{class i{constructor(e,n){this.API=n,this.subscriptions=[],this.elem=e.nativeElement}ngOnInit(){this.API.isPlayerReady?this.onPlayerReady():this.subscriptions.push(this.API.playerReadyEvent.subscribe(()=>this.onPlayerReady()))}onPlayerReady(){this.target=this.API.getMediaById(this.vgFor)}getBufferTime(){var e,n;let r="0%";return(null===(n=null===(e=this.target)||void 0===e?void 0:e.buffered)||void 0===n?void 0:n.length)&&(r=0===this.target.time.total?"0%":this.target.buffer.end/this.target.time.total*100+"%"),r}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe())}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(Ol))},i.\u0275cmp=ei({type:i,selectors:[["vg-scrub-bar-buffering-time"]],inputs:{vgFor:"vgFor"},decls:1,vars:2,consts:[[1,"background"]],template:function(e,n){1&e&&yt(0,"div",0),2&e&&A("width",n.getBufferTime())},styles:["vg-scrub-bar-buffering-time{display:flex;width:100%;height:5px;pointer-events:none;position:absolute}vg-scrub-bar-buffering-time .background{background-color:#ffffff4d}vg-controls vg-scrub-bar-buffering-time{position:absolute;top:calc(50% - 3px)}vg-controls vg-scrub-bar-buffering-time .background{border-radius:2px}\n"],encapsulation:2}),i})();function QIe(i,t){if(1&i&&yt(0,"span",2),2&i){const e=t.$implicit;A("width",null==e.$$style?null:e.$$style.width)("left",null==e.$$style?null:e.$$style.left)}}let gee=(()=>{class i{constructor(e,n){this.API=n,this.onLoadedMetadataCalled=!1,this.cuePoints=[],this.subscriptions=[],this.totalCues=0,this.elem=e.nativeElement}ngOnInit(){this.API.isPlayerReady?this.onPlayerReady():this.subscriptions.push(this.API.playerReadyEvent.subscribe(()=>this.onPlayerReady()))}onPlayerReady(){this.target=this.API.getMediaById(this.vgFor),this.subscriptions.push(this.target.subscriptions.loadedMetadata.subscribe(this.onLoadedMetadata.bind(this))),this.onLoadedMetadataCalled&&this.onLoadedMetadata()}onLoadedMetadata(){if(this.vgCuePoints){this.cuePoints=[];for(let e=0,n=this.vgCuePoints.length;e<n;e++){const s=1e3*((this.vgCuePoints[e].endTime>=0?this.vgCuePoints[e].endTime:this.vgCuePoints[e].startTime+1)-this.vgCuePoints[e].startTime);let a="0",l="0";"number"==typeof s&&this.target.time.total&&(l=100*s/this.target.time.total+"%",a=100*this.vgCuePoints[e].startTime/Math.round(this.target.time.total/1e3)+"%"),this.vgCuePoints[e].$$style={width:l,left:a},this.cuePoints.push(this.vgCuePoints[e])}}}updateCuePoints(){this.target?this.onLoadedMetadata():this.onLoadedMetadataCalled=!0}ngOnChanges(e){e.vgCuePoints.currentValue&&this.updateCuePoints()}ngDoCheck(){this.vgCuePoints&&this.totalCues!==this.vgCuePoints.length&&(this.totalCues=this.vgCuePoints.length,this.updateCuePoints())}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe())}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(Ol))},i.\u0275cmp=ei({type:i,selectors:[["vg-scrub-bar-cue-points"]],inputs:{vgCuePoints:"vgCuePoints",vgFor:"vgFor"},features:[Ls],decls:2,vars:1,consts:[[1,"cue-point-container"],["class","cue-point",3,"width","left",4,"ngFor","ngForOf"],[1,"cue-point"]],template:function(e,n){1&e&&(Z(0,"div",0),Ue(1,QIe,1,4,"span",1),J()),2&e&&(se(1),fe("ngForOf",n.cuePoints))},directives:[mo],styles:["vg-scrub-bar-cue-points{display:flex;width:100%;height:5px;pointer-events:none;position:absolute}vg-scrub-bar-cue-points .cue-point-container .cue-point{position:absolute;height:5px;background-color:#ffcc00b3}vg-controls vg-scrub-bar-cue-points{position:absolute;top:calc(50% - 3px)}\n"],encapsulation:2}),i})();function JIe(i,t){1&i&&yt(0,"span",2)}let _ee=(()=>{class i{constructor(e,n){this.API=n,this.vgSlider=!1,this.subscriptions=[],this.elem=e.nativeElement}ngOnInit(){this.API.isPlayerReady?this.onPlayerReady():this.subscriptions.push(this.API.playerReadyEvent.subscribe(()=>this.onPlayerReady()))}onPlayerReady(){this.target=this.API.getMediaById(this.vgFor)}getPercentage(){return this.target?Math.round(100*this.target.time.current/this.target.time.total)+"%":"0%"}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe())}}return i.\u0275fac=function(e){return new(e||i)(B(ai),B(Ol))},i.\u0275cmp=ei({type:i,selectors:[["vg-scrub-bar-current-time"]],inputs:{vgFor:"vgFor",vgSlider:"vgSlider"},decls:2,vars:3,consts:[[1,"background"],["class","slider",4,"ngIf"],[1,"slider"]],template:function(e,n){1&e&&(yt(0,"div",0),Ue(1,JIe,1,0,"span",1)),2&e&&(A("width",n.getPercentage()),se(1),fe("ngIf",n.vgSlider))},directives:[ms],styles:["vg-scrub-bar-current-time{display:flex;width:100%;height:5px;pointer-events:none;position:absolute}vg-scrub-bar-current-time .background{background-color:#fff}vg-controls vg-scrub-bar-current-time{position:absolute;top:calc(50% - 3px);border-radius:2px}vg-controls vg-scrub-bar-current-time .background{border:1px solid white;border-radius:2px}vg-scrub-bar-current-time .slider{background:white;height:15px;width:15px;border-radius:50%;box-shadow:0 0 10px #000;margin-top:-5px;margin-left:-10px}\n"],encapsulation:2}),i})(),$Ie=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[ka,Lg]]}),i})(),yz=(()=>{class i{constructor(e){this._config=e}transform(e){if(e){if("vbs"===e||"lsc"===e)return this._config.configAsObservable.pipe(Ui(n=>n.get("competition."+e)));if(0===e.length)return this._config.configAsObservable.pipe(Ui(n=>n.get("competition.host")));throw Error(`Invalid competition type: ${e}`)}return this._config.configAsObservable.pipe(Ui(n=>n.get("competition.host")))}}return i.\u0275fac=function(e){return new(e||i)(B(dr,16))},i.\u0275pipe=Hn({name:"competitionEnabledPipe",type:i,pure:!0}),i})();function eLe(i,t){if(1&i&&(yt(0,"video",12,13),ti(2,"ObjectPathPipe")),2&i){const e=Yo(1),n=Re();A("width",n.width+"px"),_o("src",Qi(2,5,n.mediaobject),Mc),fe("autoplay",n.auto)("vgMedia",e)}}function tLe(i,t){if(1&i&&(yt(0,"audio",14,13),ti(2,"ObjectPathPipe")),2&i){const e=Yo(1),n=Re();_o("src",Qi(2,3,n.mediaobject),Mc),fe("autoplay",n.auto)("vgMedia",e)}}function iLe(i,t){1&i&&(yt(0,"vg-scrub-bar-cue-points",15),ti(1,"async")),2&i&&fe("vgCuePoints",Qi(1,1,Re()._track).cues)}function nLe(i,t){if(1&i){const e=Wi();Z(0,"mat-icon",16),je("click",function(){return gt(e),Re().onSubmitPressed()}),ue(1,"send "),J()}}const rLe=function(){return["0.5","1.0","2.0","4.0","8.0"]};let yee=(()=>{class i{constructor(e,n,r,s){this._resolver=e,this._vbs=n,this._cdRef=r,this._eventBusService=s,this.auto=!1,this._track=new gs(null)}onPlayerReady(e){this._api=e,this._api.addTextTrack("metadata","Segments");for(const n of this.mediaobject.segments){const r=new VTTCue(n.startabs,n.endabs,"Segment: "+n.segmentId);r.id=n.segmentId,this._api.textTracks[0].addCue(r)}this._track.next(this._api.textTracks[0]),this._api.getDefaultMedia().subscriptions.loadedData.pipe(Xl()).subscribe(()=>this.seekToFocusPosition())}ngAfterViewChecked(){this._cdRef.detectChanges()}onSubmitPressed(){console.debug(`submitting for time ${this._api.currentTime}`),this._vbs.submit(this.focus,this._api.currentTime)}seekToFocusPosition(){this.focus&&this._api.seekTime(this.focus.startabs);const e=new Map;e.set("i:mediaobject",this.focus.objectId),e.set("i:starttime",this.focus.startabs),this._eventBusService.publish(new ia(new ao(fr.PLAY,e)))}seekToNext(){const e=this._api.time.current/1e3,n=this.mediaobject.segments.map(r=>r.startabs).filter(r=>r>e).sort((r,s)=>r-s);n.length>0&&this._api.seekTime(n[0])}seekToPrevious(){const e=this._api.time.current/1e3,n=this.mediaobject.segments.map(r=>r.startabs).filter(r=>r<e).sort((r,s)=>s-r);n.length>0&&this._api.seekTime(n[0])}}return i.\u0275fac=function(e){return new(e||i)(B(Ts),B(sg),B(Pn),B(Zc))},i.\u0275cmp=ei({type:i,selectors:[["app-advanced-media-player"]],inputs:{mediaobject:"mediaobject",focus:"focus",auto:"auto",width:"width"},decls:28,vars:28,consts:[[3,"onPlayerReady"],["id","videoplayer","preload","auto","style","object-fit: contain;",3,"autoplay","vgMedia","src","width",4,"ngIf"],["id","audioplayer","preload","auto",3,"autoplay","vgMedia","src",4,"ngIf"],["vgFormat","mm:ss","vgProperty","current"],[3,"vgCuePoints",4,"ngIf"],["vgFormat","mm:ss","vgProperty","total"],[3,"playbackValues"],[1,"spacer-flex"],["matTooltip","Seek to the begin of the segment preceding the current position in time.",1,"player-button",3,"click"],["matTooltip","Seek to position of focused segment.",1,"player-button",3,"click"],["matTooltip","Seek to the begin of the segment succeeding this position in time.",1,"player-button",3,"click"],["class","player-button","matTooltip","Submit current position to VBS API.",3,"click",4,"ngIf"],["id","videoplayer","preload","auto",2,"object-fit","contain",3,"autoplay","vgMedia","src"],["media",""],["id","audioplayer","preload","auto",3,"autoplay","vgMedia","src"],[3,"vgCuePoints"],["matTooltip","Submit current position to VBS API.",1,"player-button",3,"click"]],template:function(e,n){1&e&&(Z(0,"vg-player",0),je("onPlayerReady",function(s){return n.onPlayerReady(s)}),Ue(1,eLe,3,7,"video",1),Ue(2,tLe,3,5,"audio",2),Z(3,"vg-controls")(4,"div"),yt(5,"vg-time-display",3),Z(6,"vg-scrub-bar"),yt(7,"vg-scrub-bar-current-time")(8,"vg-scrub-bar-buffering-time"),Ue(9,iLe,2,3,"vg-scrub-bar-cue-points",4),ti(10,"async"),J(),yt(11,"vg-time-display",5),J(),Z(12,"div"),yt(13,"vg-play-pause")(14,"vg-playback-button",6)(15,"div",7),Z(16,"mat-icon",8),je("click",function(){return n.seekToPrevious()}),ue(17,"fast_rewind "),J(),Z(18,"mat-icon",9),je("click",function(){return n.seekToFocusPosition()}),ue(19," replay "),J(),Z(20,"mat-icon",10),je("click",function(){return n.seekToNext()}),ue(21,"fast_forward "),J(),yt(22,"div",7),Ue(23,nLe,2,0,"mat-icon",11),ti(24,"async"),ti(25,"competitionEnabledPipe"),yt(26,"vg-mute")(27,"vg-fullscreen"),J()()()),2&e&&(A("display","block")("width",n.width+"px"),se(1),fe("ngIf","VIDEO"===n.mediaobject.mediatype),se(1),fe("ngIf","AUDIO"===n.mediaobject.mediatype),se(1),A("display","block")("height","100px")("position","relative"),se(1),A("display","flex"),se(5),fe("ngIf",Qi(10,21,n._track)),se(3),A("align-content","space-between")("display","flex"),se(2),fe("playbackValues",n1(27,rLe)),se(9),fe("ngIf",Qi(24,23,Qi(25,25,""))))},directives:[BIe,ms,_z,aee,cee,uee,_ee,mee,gee,oee,dee,hee,vo,Fo,fee,pee],pipes:[nL,Xc,yz],styles:[".player-button[_ngcontent-%COMP%]{color:#fff;display:flex;justify-content:center;height:50px;width:50px;cursor:pointer;line-height:50px}"]}),i})(),sLe=(()=>{class i{transform(e){return Ts.iiifUrlToObject(e,!0)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275pipe=Hn({name:"IiifResourceUrlPipe",type:i,pure:!0}),i})(),oLe=(()=>{class i{constructor(e){this._resolverService=e}transform(e){return this._resolverService.pathToSegment(e)}}return i.\u0275fac=function(e){return new(e||i)(B(Ts,16))},i.\u0275pipe=Hn({name:"SegmentPathPipe",type:i,pure:!0}),i})();const aLe=["audioplayer"],lLe=["videoplayer"],cLe=["imageviewer"];function uLe(i,t){if(1&i&&yt(0,"app-advanced-media-player",9),2&i){const e=Re();fe("auto",!0)("focus",e._segment)("mediaobject",e.mediaobject)("width",600)}}function hLe(i,t){1&i&&yt(0,"div",10)}function dLe(i,t){if(1&i&&(yt(0,"img",11,12),ti(2,"ObjectPathPipe"),ti(3,"SegmentPathPipe")),2&i){const e=Re();_o("src","IMAGE"===e.mediaobject.mediatype?Qi(2,1,e.mediaobject):Qi(3,3,e._segment),Mc)}}function fLe(i,t){1&i&&(yt(0,"app-m3d-loader",13,14),ti(2,"ObjectPathPipe")),2&i&&(_o("src",Qi(2,4,Re().mediaobject)),fe("height",400)("interaction",!0)("width",400))}function pLe(i,t){if(1&i){const e=Wi();Z(0,"button",15),je("click",function(){return gt(e),Re().onSubmitPressed()}),Z(1,"mat-icon"),ue(2,"send"),J()()}}function mLe(i,t){if(1&i&&(Z(0,"mat-list-item"),ue(1),J()),2&i){const e=t.$implicit;se(1),hi(" ",e.key,": ",e.value," ")}}function gLe(i,t){if(1&i&&(Wo(0),Z(1,"div",16)(2,"mat-list"),Ue(3,mLe,2,2,"mat-list-item",17),ti(4,"keyvalue"),J()(),jo()),2&i){const e=Re();se(3),fe("ngForOf",Qi(4,1,e._segment.metadata))}}let _Le=(()=>{class i{constructor(e,n,r,s,a){if(this._resolver=n,this._vbs=r,this._ngZone=s,this._configService=a,this.showMd=l=>l._config.refinement.showMetadataInViewer,e instanceof tH)this._segment=e.representativeSegment;else{if(!(e instanceof eH))throw new Error("You must either provide a MediaObjectScoreContainer or a SegmentScoreContainer to an instance von QuickViewerComponent!");this._segment=e}this.mediaobject=this._segment.objectScoreContainer}ngAfterContentInit(){this._configService.configAsObservable.subscribe(e=>{this._config=e})}ngAfterViewInit(){let e=Ts.iiifUrlToObject(this.mediaobject,!0);if(!e)return null;e+="info.json",this._ngZone.runOutsideAngular(()=>OIe({id:"openseadragon",preserveViewport:!0,showNavigator:!0,visibilityRatio:1,degrees:parseFloat(this.mediaobject.metadata.get("IIIF.rotation"))||0,showRotationControl:!0,minZoomLevel:1,defaultZoomLevel:1,prefixUrl:"/assets/images/openseadragon/",tileSources:[e]}))}onSubmitPressed(){this._vbs.submitSegment(this._segment)}}return i.\u0275fac=function(e){return new(e||i)(B(Cy),B(Ts),B(sg),B(Rn),B(dr))},i.\u0275cmp=ei({type:i,selectors:[["app-quick-viewer"]],viewQuery:function(e,n){if(1&e&&(ji(aLe,5),ji(lLe,5),ji(cLe,5)),2&e){let r;jt(r=qt())&&(n.audioplayer=r.first),jt(r=qt())&&(n.videoplayer=r.first),jt(r=qt())&&(n.imageviewer=r.first)}},decls:19,vars:20,consts:[["matDialogTitle","",1,"title"],[2,"display","table","clear","both","min-width","600px"],["mat-dialog-content","",1,"content"],[3,"auto","focus","mediaobject","width",4,"ngIf"],["id","openseadragon",4,"ngIf"],["style","max-width:100%; height:auto;",3,"src",4,"ngIf"],[3,"height","interaction","width","src",4,"ngIf"],["color","primary","mat-flat-button","",3,"click",4,"ngIf"],[4,"ngIf"],[3,"auto","focus","mediaobject","width"],["id","openseadragon"],[2,"max-width","100%","height","auto",3,"src"],["imageviewer",""],[3,"height","interaction","width","src"],["modelviewer",""],["color","primary","mat-flat-button","",3,"click"],[2,"float","right"],[4,"ngFor","ngForOf"]],template:function(e,n){1&e&&(Z(0,"h1",0),ue(1),J(),Z(2,"p")(3,"strong"),ue(4,"Segment:"),J(),ue(5),J(),Z(6,"div",1)(7,"div",2),Ue(8,uLe,1,4,"app-advanced-media-player",3),Ue(9,hLe,1,0,"div",4),ti(10,"IiifResourceUrlPipe"),Ue(11,dLe,4,5,"img",5),ti(12,"IiifResourceUrlPipe"),Ue(13,fLe,3,6,"app-m3d-loader",6),Ue(14,pLe,3,0,"button",7),ti(15,"async"),ti(16,"competitionEnabledPipe"),J(),Ue(17,gLe,5,3,"ng-container",8),ti(18,"GetConfigVariablePipe"),J()),2&e&&(se(1),hi("",n.mediaobject.objectid," (",n.mediaobject.name,")"),se(4),ui(" ",n._segment.segmentId,""),se(3),fe("ngIf","VIDEO"===n.mediaobject.mediatype||"AUDIO"===n.mediaobject.mediatype),se(1),fe("ngIf",Qi(10,9,n.mediaobject)),se(2),fe("ngIf",!Qi(12,11,n.mediaobject)&&"IMAGE"===n.mediaobject.mediatype||"IMAGE_SEQUENCE"===n.mediaobject.mediatype),se(2),fe("ngIf","MODEL3D"===n.mediaobject.mediatype),se(1),fe("ngIf",Qi(15,13,Qi(16,15,"lsc"))),se(3),fe("ngIf",Bs(18,17,n._config,n.showMd)))},directives:[K9,cS,ms,yee,fI,Mo,vo,nS,mo,Jb],pipes:[sLe,nL,oLe,Xc,yz,dS,h1],styles:[".title[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:600px}.content[_ngcontent-%COMP%]{max-height:600px;max-width:600px;float:left}#openseadragon[_ngcontent-%COMP%]{width:600px;height:600px}"]}),i})();function yLe(i,t){if(1&i){const e=Wi();Z(0,"button",6),je("click",function(){const s=gt(e).$implicit,a=Re(2);return a.onHighlightButtonClicked(a.segment,s)}),Z(1,"mat-icon"),ue(2," album "),J()()}2&i&&Vd("matTooltip","Toggle '",t.$implicit.name,"' tag")}function vLe(i,t){if(1&i&&(Z(0,"div",4),Ue(1,yLe,3,1,"button",5),J()),2&i){const e=Re();se(1),fe("ngForOf",e.container._selectionService._available)}}function bLe(i,t){if(1&i){const e=Wi();Z(0,"button",13),je("click",function(){return gt(e),Re(2).submit()}),Z(1,"mat-icon"),ue(2,"send"),J()()}}function xLe(i,t){if(1&i){const e=Wi();Z(0,"button",14),je("click",function(){return gt(e),Re(2).onNeighborsButtonClicked()})("contextmenu",function(r){return gt(e),Re(2).onNeighborsButtonRightClicked(r)}),Z(1,"mat-icon"),ue(2,"settings_ethernet"),J()()}}function wLe(i,t){if(1&i){const e=Wi();Z(0,"div",7),Ue(1,bLe,3,0,"button",8),ti(2,"async"),ti(3,"competitionEnabledPipe"),Z(4,"button",9),je("click",function(){gt(e);const r=Re();return r.container.onDetailsButtonClicked(r.segment)}),Z(5,"mat-icon"),ue(6,"remove_red_eye"),J()(),Z(7,"button",10),je("click",function(){gt(e);const r=Re();return r.container.onInformationButtonClicked(r.segment,r.temporalObject)}),Z(8,"mat-icon"),ue(9,"help"),J()(),Z(10,"button",11),je("click",function(){gt(e);const r=Re();return r.container.onMltButtonClicked(r.segment)}),Z(11,"mat-icon"),ue(12,"youtube_searched_for"),J()(),Ue(13,xLe,3,0,"button",12),J()}if(2&i){const e=Re();se(1),fe("ngIf",Qi(2,2,Qi(3,4,""))),se(12),fe("ngIf",e.mltEnabled)}}let vz=(()=>{class i{constructor(e,n,r,s,a,l,u,h,m){this._keyboardService=e,this._queryService=n,this._eventBusService=r,this._vbs=s,this._dialog=a,this._resolver=l,this._configService=u,this._selectionService=h,this._cdr=m,this.mltEnabled=!0,this._focus=!1,this._tags=[]}ngOnInit(){this._tags=this._selectionService.getTags(this.segment.segmentId),this._selectionService.register(this.segment.segmentId).subscribe(e=>{this._tags=[...e],this._cdr.detectChanges()})}ngOnDestroy(){this._selectionService.deregister(this.segment.segmentId)}get id(){return this.segment.segmentId}onNeighborsButtonClicked(){this._queryService.lookupNeighboringSegments(this.segment.segmentId,this._configService.config.get("query.config.neighboringSegmentLookupCount"))}onNeighborsButtonRightClicked(e){this._queryService.lookupNeighboringSegments(this.segment.segmentId,this._configService.config.get("query.config.neighboringSegmentLookupAllCount")),e.preventDefault()}onHighlightButtonClicked(e,n){this._selectionService.toggle(n,e.segmentId)}submit(){this._vbs.submitSegment(this.segment),this._tags=this._selectionService.getTags(this.segment.segmentId)}onTileClicked(e){if(e.shiftKey)this.submit();else{this._dialog.open(_Le,{data:this.segment});const n=new Map;n.set("i:mediasegment",this.segment.segmentId),this._eventBusService.publish(new ia(new ao(fr.EXAMINE,n)))}}}return i.\u0275fac=function(e){return new(e||i)(B(B$),B(Rc),B(Zc),B(sg),B(Lu),B(Ts),B(dr),B(Bh),B(Pn))},i.\u0275cmp=ei({type:i,selectors:[["app-result-segment-preview-tile"]],inputs:{mltEnabled:"mltEnabled",segment:"segment",container:"container",temporalObject:"temporalObject",score:"score"},decls:6,vars:16,consts:[["draggable","true",1,"segment",3,"id","dragstart","mouseenter","mouseleave"],["draggable","false",3,"src","click"],["class","header","fxLayout","row","fxLayoutAlign","space-evenly",4,"ngIf"],["class","footer","fxLayout","row","fxLayoutAlign","space-evenly",4,"ngIf"],["fxLayout","row","fxLayoutAlign","space-evenly",1,"header"],["mat-icon-button","",3,"matTooltip","click",4,"ngFor","ngForOf"],["mat-icon-button","",3,"matTooltip","click"],["fxLayout","row","fxLayoutAlign","space-evenly",1,"footer"],["mat-icon-button","","matTooltip","Submit segment to VBS",3,"click",4,"ngIf"],["mat-icon-button","","matTooltip","Show details",3,"click"],["mat-icon-button","","matTooltip","Feature information",3,"click"],["mat-icon-button","","matTooltip","More-like-this",3,"click"],["mat-icon-button","","matTooltip","Load neighboring segments",3,"click","contextmenu",4,"ngIf"],["mat-icon-button","","matTooltip","Submit segment to VBS",3,"click"],["mat-icon-button","","matTooltip","Load neighboring segments",3,"click","contextmenu"]],template:function(e,n){1&e&&(Z(0,"div",0),je("dragstart",function(s){return n.container.onTileDrag(s,n.segment,n.segment._objectScoreContainer)})("mouseenter",function(){return n._focus=!0})("mouseleave",function(){return n._focus=!1}),ti(1,"BackgroundScorePipe"),Z(2,"img",1),je("click",function(s){return n.onTileClicked(s)}),ti(3,"ThumbnailPathPipe"),J(),Ue(4,vLe,2,1,"div",2),Ue(5,wLe,14,6,"div",3),J()),2&e&&(A("background",uR(1,6,n.score,n.segment,n._tags,n.temporalObject)),_o("id",n.segment.segmentId),se(2),_o("src",uR(3,11,n.segment._objectScoreContainer,n.segment,80,120),Mc),se(2),fe("ngIf",n._focus),se(1),fe("ngIf",n._focus))},directives:[ms,ug,hg,mo,Mo,Fo,vo],pipes:[K$,yL,Xc,yz],styles:[".mini-gallery[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,120px);grid-template-rows:repeat(auto-fill,100px);grid-auto-flow:row;grid-row-gap:5px;grid-column-gap:5px}.segment[_ngcontent-%COMP%]{width:120px;height:100px;position:relative;margin-bottom:5px}.segment.marked[_ngcontent-%COMP%]{border:.5px solid #0101ff}.segment[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;object-fit:contain}.segment[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{position:absolute;top:0;height:25px;left:0;right:0;z-index:100;background-color:#000;opacity:.65;color:#fff}.segment[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{position:absolute;top:75px;height:25px;left:0;right:0;z-index:100;background-color:#000;opacity:.65;color:#fff}.header[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{max-height:20px!important;max-width:20px!important;line-height:0!important}.header[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{max-height:18px;max-width:18px}.header[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:16px!important}.footer[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{max-height:20px!important;max-width:20px!important;line-height:0!important}.footer[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{max-height:18px;max-width:18px}.footer[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:16px!important}"],changeDetection:0}),i})(),SLe=(()=>{class i{transform(e,n,r){if(!e||0===e.length)return[];if(!n||0===r.size)return e;const s=Array.from(r);return e.filter(a=>s.map(l=>!(!n.has(a.segmentId)||(console.log(n.get(a.segmentId)),!n.get(a.segmentId).find(u=>u.name==l.name)))).indexOf(!1)<0)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275pipe=Hn({name:"FilterTagsPipe",type:i,pure:!0}),i})();function CLe(i,t){1&i&&(Z(0,"p",3),ue(1,"No results available. Please start a search..."),J())}function MLe(i,t){1&i&&(Z(0,"p",3),yt(1,"mat-spinner"),J())}function TLe(i,t){if(1&i&&yt(0,"app-result-segment-preview-tile",4),2&i){const e=t.$implicit;fe("container",Re())("score",e._score)("segment",e)}}let vee=(()=>{class i extends HH{constructor(e,n,r,s,a,l,u,h,m,_){super(e,n,r,s,a,l,u,h,m,_),this.name="segment_gallery"}segmentTracking(e,n){return n.segmentId}scrollIncrement(){return 500}subscribe(e){e&&(this._dataSource=e.segmentsAsObservable)}}return i.\u0275fac=function(e){return new(e||i)(B(Pn),B(Rc),B(Rp),B(Bh),B(Zc),B(Ql),B(Ru),B(dr),B(Ts),B(Lu))},i.\u0275cmp=ei({type:i,selectors:[["app-mini-gallery"]],features:[It],decls:13,vars:31,consts:[["class","background-prompt",4,"ngIf"],["infiniteScroll","",1,"mini-gallery",3,"fromRoot","infiniteScrollContainer","infiniteScrollDistance","infiniteScrollUpDistance","alwaysCallback","scrolled"],[3,"container","score","segment",4,"ngFor","ngForOf","ngForTrackBy"],[1,"background-prompt"],[3,"container","score","segment"]],template:function(e,n){1&e&&(Ue(0,CLe,2,0,"p",0),ti(1,"async"),Ue(2,MLe,2,0,"p",0),ti(3,"async"),Z(4,"div",1),je("scrolled",function(){return n.incrementCount()}),Ue(5,TLe,1,3,"app-result-segment-preview-tile",2),ti(6,"LimitPipe"),ti(7,"FilterTagsPipe"),ti(8,"FilterPipe"),ti(9,"OrderByScorePipe"),ti(10,"async"),ti(11,"async"),ti(12,"async"),J()),2&e&&(fe("ngIf",!Qi(1,9,n._dataSource)&&!n._loading),se(2),fe("ngIf",!Qi(3,11,n._dataSource)&&n._loading),se(2),fe("fromRoot",!0)("infiniteScrollContainer","#scrollable")("infiniteScrollDistance",1)("infiniteScrollUpDistance",2)("alwaysCallback",!0),se(1),fe("ngForOf",Bs(6,13,Rh(7,16,Bs(8,20,Qi(9,23,Qi(10,25,n._dataSource)),Qi(11,27,n._filterService._segmentFilters)),Qi(12,29,n._selectionService),n._filterService.filterTags),n._count))("ngForTrackBy",n.segmentTracking))},directives:[ms,sf,bL,mo,vz],pipes:[Xc,see,SLe,wL,iL],styles:[".mini-gallery[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,120px);grid-template-rows:repeat(auto-fill,100px);grid-auto-flow:row;grid-row-gap:5px;grid-column-gap:5px}.segment[_ngcontent-%COMP%]{width:120px;height:100px;position:relative;margin-bottom:5px}.segment.marked[_ngcontent-%COMP%]{border:.5px solid #0101ff}.segment[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;object-fit:contain}.segment[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{position:absolute;top:0;height:25px;left:0;right:0;z-index:100;background-color:#000;opacity:.65;color:#fff}.segment[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{position:absolute;top:75px;height:25px;left:0;right:0;z-index:100;background-color:#000;opacity:.65;color:#fff}.header[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{max-height:20px!important;max-width:20px!important;line-height:0!important}.header[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{max-height:18px;max-width:18px}.header[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:16px!important}.footer[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{max-height:20px!important;max-width:20px!important;line-height:0!important}.footer[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{max-height:18px;max-width:18px}.footer[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:16px!important}"],changeDetection:0}),i})(),ELe=(()=>{class i{transform(e,n){if(!e||0===e.length||0===n)return[[],0];console.debug(`Limiting to ${n} media objects.`);const r=[];let s=0,a=0;return e.forEach(l=>{a>n||(a+l.segments.length>n&&(s=n-a),a+=l.segments.length,r.push(l))}),a<=n&&(s=r[r.length-1].segments.length),[r,s]}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275pipe=Hn({name:"LimitObjectsPipe",type:i,pure:!0}),i})();function ALe(i,t){1&i&&(Z(0,"p",4),ue(1,"No results available. Please start a search..."),J())}function DLe(i,t){1&i&&(Z(0,"p",4),yt(1,"mat-spinner"),J())}function RLe(i,t){if(1&i&&yt(0,"app-result-segment-preview-tile",8),2&i){const e=t.$implicit;fe("container",Re(3))("score",e._score)("segment",e)}}function kLe(i,t){if(1&i&&(Z(0,"div",6),Ue(1,RLe,1,3,"app-result-segment-preview-tile",7),ti(2,"OrderBySegmentPipe"),ti(3,"FilterPipe"),ti(4,"async"),J()),2&i){const e=t.$implicit,n=Re(2);se(1),fe("ngForOf",Qi(2,2,Bs(3,4,e._segments,Qi(4,7,n._filterService._segmentFilters))))("ngForTrackBy",n.segmentTracking)}}function PLe(i,t){if(1&i&&(Wo(0),Ue(1,kLe,5,9,"div",5),jo()),2&i){const e=t.ngIf,n=Re();se(1),fe("ngForOf",e[0])("ngForTrackBy",n.trackByFunction)}}let ILe=(()=>{class i extends HH{constructor(e,n,r,s,a,l,u,h,m,_){super(e,n,r,s,a,u,h,l,m,_),this.name="segment_list",this._count=5*this.scrollIncrement()}trackByFunction(e,n){return n.objectid+"_"+n.numberOfSegments}segmentTracking(e,n){return n.segmentId}scrollIncrement(){return 100}subscribe(e){e&&(this._dataSource=e.mediaobjectsAsObservable)}}return i.\u0275fac=function(e){return new(e||i)(B(Pn),B(Rc),B(Rp),B(Bh),B(Zc),B(dr),B(Ql),B(Ru),B(Ts),B(Lu))},i.\u0275cmp=ei({type:i,selectors:[["app-list"]],features:[It],decls:12,vars:24,consts:[[2,"padding","10px"],["class","background-prompt",4,"ngIf"],["infiniteScroll","",1,"list",3,"fromRoot","infiniteScrollContainer","alwaysCallback","infiniteScrollDistance","infiniteScrollUpDistance","scrolled"],[4,"ngIf"],[1,"background-prompt"],["class","object",4,"ngFor","ngForOf","ngForTrackBy"],[1,"object"],[3,"container","score","segment",4,"ngFor","ngForOf","ngForTrackBy"],[3,"container","score","segment"]],template:function(e,n){1&e&&(Z(0,"div",0),Ue(1,ALe,2,0,"p",1),ti(2,"async"),Ue(3,DLe,2,0,"p",1),ti(4,"async"),Z(5,"div",2),je("scrolled",function(){return n.incrementCount()}),Ue(6,PLe,2,2,"ng-container",3),ti(7,"LimitObjectsPipe"),ti(8,"OrderByScorePipe"),ti(9,"FilterPipe"),ti(10,"async"),ti(11,"async"),J()()),2&e&&(se(1),fe("ngIf",!Qi(2,8,n._dataSource)&&!n._loading),se(2),fe("ngIf",!Qi(4,10,n._dataSource)&&n._loading),se(2),fe("fromRoot",!0)("infiniteScrollContainer","#scrollable")("alwaysCallback",!0)("infiniteScrollDistance",1)("infiniteScrollUpDistance",2),se(1),fe("ngIf",Bs(7,12,Qi(8,15,Bs(9,17,Qi(10,20,n._dataSource),Qi(11,22,n._filterService._objectFilters))),n._count)))},directives:[ms,sf,bL,mo,vz],pipes:[Xc,ELe,iL,wL,U$],styles:[".object[_ngcontent-%COMP%]{width:100%;border:1px solid #808080;padding:4px;margin-bottom:10px;display:grid;grid-template-columns:repeat(auto-fill,120px);grid-template-rows:repeat(auto-fill,110px);grid-auto-flow:row;grid-row-gap:5px;grid-column-gap:5px}.segment[_ngcontent-%COMP%]{width:120px;height:110px;position:relative}.segment.marked[_ngcontent-%COMP%]{border:.5px solid #0101ff}.segment[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;object-fit:contain}.segment[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{position:absolute;top:0;height:25px;left:0;right:0;z-index:100;background-color:#000;opacity:.65;color:#fff}.segment[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{position:absolute;top:75px;left:0;right:0;height:25px;z-index:100;background-color:#000;opacity:.65;color:#fff}.header[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{max-height:20px!important;max-width:20px!important;line-height:0!important}.header[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{max-height:18px;max-width:18px}.header[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:16px!important}.footer[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{max-height:20px!important;max-width:20px!important;line-height:0!important}.footer[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{max-height:18px;max-width:18px}.footer[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:16px!important}"],changeDetection:0}),i})();const LLe=["objectviewerComponent"],OLe=["segmentFeaturesComponent"];function FLe(i,t){1&i&&(Z(0,"div"),yt(1,"mat-progress-bar",4),J())}function BLe(i,t){if(1&i){const e=Wi();Z(0,"div")(1,"button",5),je("click",function(){return gt(e),Re().onBackClick()}),Z(2,"mat-icon"),ue(3,"keyboard_backspace"),J()(),Z(4,"h2"),ue(5),J()()}if(2&i){const e=Re();A("display","inline-flex"),se(4),A("margin-top","5px"),se(1),ui("\xa0Media segment: ",e._mediaSegment.segmentId,"")}}function NLe(i,t){if(1&i&&(Z(0,"div")(1,"dl")(2,"dt"),ue(3,"SegmentID"),J(),Z(4,"dd"),ue(5),J(),Z(6,"dt"),ue(7,"Sequencenumber"),J(),Z(8,"dd"),ue(9),J(),Z(10,"dt"),ue(11,"Start"),J(),Z(12,"dd"),ue(13),J(),Z(14,"dt"),ue(15,"Start (Abs)"),J(),Z(16,"dd"),ue(17),J(),Z(18,"dt"),ue(19,"End"),J(),Z(20,"dd"),ue(21),J(),Z(22,"dt"),ue(23,"End (Abs)"),J(),Z(24,"dd"),ue(25),J()()()),2&i){const e=Re(3);se(5),Xt(e._mediaSegment.segmentId),se(4),Xt(e._mediaSegment.sequenceNumber),se(4),Xt(e._mediaSegment.start),se(4),Xt(e._mediaSegment.startabs),se(4),Xt(e._mediaSegment.end),se(4),Xt(e._mediaSegment.endabs)}}function HLe(i,t){if(1&i&&(Z(0,"p"),ue(1),J()),2&i){const e=Re(3);A("margin","0"),se(1),hi("",e._mediaSegment.startabs.toFixed(2)," - ",e._mediaSegment.endabs.toFixed(2),"")}}function VLe(i,t){if(1&i){const e=Wi();Z(0,"button",18),je("click",function(){gt(e);const r=Re(3);return r.onPlayClick(r._mediaSegment)}),Z(1,"mat-icon"),ue(2,"play_arrow"),J()()}}function zLe(i,t){if(1&i&&(Z(0,"div",21),ue(1),J()),2&i){const e=Re(4);se(1),ui(" No segment metadata available for ",e._mediaSegment.segmentId," ")}}function ULe(i,t){if(1&i&&(Z(0,"mat-list-item")(1,"h4",22)(2,"strong"),ue(3),J()(),yt(4,"p",23),ti(5,"TextWithLinkPipe"),J()),2&i){const e=t.$implicit;se(3),Xt(e.key),se(1),fe("innerHTML",Qi(5,2,e.value),Lv)}}function GLe(i,t){if(1&i&&(Z(0,"mat-tab",9),Ue(1,zLe,2,1,"div",19),Z(2,"mat-list"),Ue(3,ULe,6,4,"mat-list-item",20),ti(4,"keyvalue"),J()()),2&i){const e=Re(3);Vd("label","Segment Metadata (",e._segMetadata.size,")"),se(1),fe("ngIf",0==e._segMetadata.size),se(2),fe("ngForOf",Qi(4,3,e._segMetadata))}}function WLe(i,t){if(1&i&&(Z(0,"div",21),ue(1),J()),2&i){const e=Re(4);se(1),ui(" No object metadata available for ",e._mediaObject.objectId," ")}}function jLe(i,t){if(1&i&&(Z(0,"mat-list-item")(1,"h4",22)(2,"strong"),ue(3),J()(),yt(4,"p",23),ti(5,"TextWithLinkPipe"),J()),2&i){const e=t.$implicit;se(3),Xt(e.key),se(1),fe("innerHTML",Qi(5,2,e.value),Lv)}}function qLe(i,t){if(1&i&&(Z(0,"mat-tab",9),Ue(1,WLe,2,1,"div",19),Z(2,"mat-list"),Ue(3,jLe,6,4,"mat-list-item",20),ti(4,"keyvalue"),J()()),2&i){const e=Re(3);Vd("label","Object Metadata (",e._objMetadata.size,")"),se(1),fe("ngIf",0==e._objMetadata.size),se(2),fe("ngForOf",Qi(4,3,e._objMetadata))}}function XLe(i,t){if(1&i){const e=Wi();Z(0,"div"),Ue(1,NLe,26,6,"div",0),Z(2,"mat-tab-group")(3,"mat-tab",9)(4,"div",10),je("dragstart",function(r){return gt(e),Re(2).onSegmentDrag(r)}),Z(5,"div",11)(6,"p"),ue(7),J(),Ue(8,HLe,2,4,"p",12),J(),yt(9,"img",13),ti(10,"ThumbnailPathPipe"),Z(11,"div",14),Ue(12,VLe,3,0,"button",15),Z(13,"button",16),je("click",function(){gt(e);const r=Re(2);return r.onMltClick(r._mediaSegment)}),Z(14,"mat-icon"),ue(15,"youtube_searched_for"),J()()()()(),Ue(16,GLe,5,5,"mat-tab",17),Ue(17,qLe,5,5,"mat-tab",17),J()()}if(2&i){const e=Re(2);se(1),fe("ngIf",e._mediaSegment.segmentId),se(2),Vd("label","Segment ",e._mediaSegment.segmentId,""),se(3),A("margin","0"),se(1),Xt(e._mediaSegment.segmentId),se(1),fe("ngIf",e._mediaSegment.endabs>0),se(1),_o("src",Bs(10,10,e._mediaObject,e._mediaSegment),Mc),se(3),fe("ngIf","VIDEO"===e._mediaObject.mediatype||"AUDIO"===e._mediaObject.mediatype),se(4),fe("ngIf",e._segMetadata),se(1),fe("ngIf",e._objMetadata)}}function ZLe(i,t){if(1&i&&(Z(0,"div",6)(1,"h3"),ue(2,"Object Details"),J(),yt(3,"app-objectviewer",7,8),Z(5,"h3"),ue(6,"Segment Details"),J(),Ue(7,XLe,18,13,"div",0),yt(8,"mat-divider"),J()),2&i){const e=Re();se(3),fe("mediaobject",e._mediaObject)("displayHeader",!1),se(4),fe("ngIf",e._mediaSegment)}}let YLe=(()=>{class i{constructor(e,n,r,s,a,l,u,h,m){this._route=e,this._snackBar=n,this._metadataLookup=r,this._query=s,this._eventBusService=a,this._resolver=l,this._historyService=u,this._objectService=h,this._segmentService=m,this._loading=!0,this.segmentIdObservable=e.params.pipe(Ui(_=>_.segmentId),vr(_=>null!=_))}onBackClick(){this._historyService.getPreviousRoute()?this._historyService.goToPrevious():this._historyService.goToRoot()}updateLoading(){this._loading=!(this._mediaObject&&this._mediaSegment&&this._mediaObject.name&&this._mediaSegment.objectId)}ngAfterViewInit(){this.segmentIdObservable.pipe(Ui(e=>{this._segmentService.findSegmentById(e).subscribe(n=>{let r=null;0===n.content.length&&(r=`Cineast returned no results for segment id ${e}. Returning to gallery...`);const s=n.content[0];s||(r=`Cineast returned no segment for id ${e}. Returning to gallery...`),r&&(this._snackBar.open(r,"",{duration:5e3}),this._historyService.goToRoot()),this._mediaSegment=s,this._metadataLookup.findSegMetaById(s.segmentId).subscribe(a=>{if(a.content){const l=new Map;a.content.forEach(u=>{l.set(`${u.domain}.${u.key}`,u.value)}),this._segMetadata=l,this.updateLoading()}}),this.segmentFeatures.onLoadFeaturesButtonClicked(s),this._objectService.findObjectsByAttribute("id",s.objectId).subscribe(a=>{r=null,0===a.content.length&&(r=`Cineast returned no results for object ${s.objectId} . Returning to gallery...`),""===a.content[0].objectid&&(r=`Cineast returned no object descriptor for object ${s.objectId} . Returning to gallery...`),r&&(this._snackBar.open(r,"",{duration:5e3}),this._historyService.goToRoot()),this._mediaObject=a.content[0],this._metadataLookup.findSegMetaById(this._mediaObject.objectid).subscribe(l=>{if(l.content){const u=new Map;l.content.forEach(h=>{u.set(`${h.domain}.${h.key}`,h.value)}),this._objMetadata=u,this.updateLoading()}})})})})).subscribe()}onSegmentDrag(e){e.dataTransfer.setData(xy.FORMAT,new xy(this._mediaObject,this._mediaSegment).toJSON()),e.dataTransfer.setData(rS.FORMAT,rS.fromDescriptor(this._mediaObject).toJSON())}onPlayClick(e){this.objectviewer?this.objectviewer.onPlayClick(e):console.log("objectviewer not loaded yet, cannot play from segment")}onMltClick(e){this._query.findMoreLikeThis(e,this._mediaObject.mediatype)}onInformationButtonClicked(e){this._snackBar.openFromComponent(z$,{data:e,duration:2500});const n=new Map;n.set("i:mediasegment",e.segmentId),this._eventBusService.publish(new ia(new ao(fr.EXAMINE,n)))}}return i.\u0275fac=function(e){return new(e||i)(B(wy),B(Ru),B(Kb),B(Rc),B(Zc),B(Ts),B(tL),B(rP),B(rH))},i.\u0275cmp=ei({type:i,selectors:[["app-segment-details"]],viewQuery:function(e,n){if(1&e&&(ji(LLe,5),ji(OLe,5)),2&e){let r;jt(r=qt())&&(n.objectviewer=r.first),jt(r=qt())&&(n.segmentFeatures=r.first)}},decls:5,vars:3,consts:[[4,"ngIf"],[3,"display",4,"ngIf"],["style","padding:10px;",4,"ngIf"],["segmentFeaturesComponent",""],["mode","buffer"],["mat-icon-button","","matTooltip","Go back...",3,"click"],[2,"padding","10px"],[3,"mediaobject","displayHeader"],["objectviewerComponent",""],[3,"label"],["draggable","true","fxFlex","200px",1,"tile",3,"dragstart"],["fxLayout","","fxLayoutAlign","space-between start",1,"tile-header"],[3,"margin",4,"ngIf"],["height","200px","width","200px",1,"tile-body",3,"src"],["fxLayout","row-reverse",1,"tile-footer"],["mat-icon-button","","matTooltip","Start playback",3,"click",4,"ngIf"],["mat-icon-button","","matTooltip","More-like-this",3,"click"],[3,"label",4,"ngIf"],["mat-icon-button","","matTooltip","Start playback",3,"click"],["style","padding-top:10px",4,"ngIf"],[4,"ngFor","ngForOf"],[2,"padding-top","10px"],["mat-line",""],["mat-line","",2,"white-space","pre-wrap",3,"innerHTML"]],template:function(e,n){1&e&&(Ue(0,FLe,2,0,"div",0),Ue(1,BLe,6,5,"div",1),Ue(2,ZLe,9,3,"div",2),yt(3,"app-segment-features",null,3)),2&e&&(fe("ngIf",n._loading),se(1),fe("ngIf",n._mediaSegment),se(1),fe("ngIf",n._mediaObject))},directives:[ms,kP,Mo,Fo,vo,G$,QI,LE,aV,ug,hg,nS,mo,Jb,Hb,ig,Y$],pipes:[yL,h1,J$],styles:["table[_ngcontent-%COMP%]{width:100%}.tile[_ngcontent-%COMP%]{width:200px;height:200px;border-top:10px solid;border-bottom:10px solid;margin-bottom:25px;box-shadow:.15em .15em .05em #0006;position:relative}.tile[_ngcontent-%COMP%]   .tile-header[_ngcontent-%COMP%]{top:0;left:0;right:0;min-height:30px;padding:10px;position:absolute;z-index:100;background-color:#000;opacity:.65;color:#fff}.tile[_ngcontent-%COMP%]   .tile-body[_ngcontent-%COMP%]{width:100%;height:100%}.tile[_ngcontent-%COMP%]   .tile-footer[_ngcontent-%COMP%]{top:150px;left:0;right:0;height:50px;padding:5px;position:absolute;z-index:100;background-color:#000;opacity:.65;color:#fff}.scrollToBottom[_ngcontent-%COMP%]{min-height:800px}.smallerFont[_ngcontent-%COMP%]{font-size:small;text-align:center}.normalfont[_ngcontent-%COMP%]{font-size:medium}.odd[_ngcontent-%COMP%]{background-color:#f2f9ff}.even[_ngcontent-%COMP%]{background-color:#eceff3}mat-grid-tile[_ngcontent-%COMP%]{background:#e0e0e0}"]}),i})();function KLe(i,t){if(1&i&&(Z(0,"mat-option",19),ue(1),J()),2&i){const e=t.$implicit;fe("value",e),se(1),ui(" ",e," ")}}function QLe(i,t){if(1&i){const e=Wi();Z(0,"mat-form-field",16)(1,"mat-select",17),je("selectionChange",function(r){return gt(e),Re(2)._changePageSize(r.value)}),Ue(2,KLe,2,2,"mat-option",18),J()()}if(2&i){const e=Re(2);fe("appearance",e._formFieldAppearance)("color",e.color),se(1),fe("value",e.pageSize)("disabled",e.disabled)("aria-label",e._intl.itemsPerPageLabel),se(1),fe("ngForOf",e._displayedPageSizeOptions)}}function JLe(i,t){if(1&i&&(Z(0,"div",20),ue(1),J()),2&i){const e=Re(2);se(1),Xt(e.pageSize)}}function $Le(i,t){if(1&i&&(Z(0,"div",12)(1,"div",13),ue(2),J(),Ue(3,QLe,3,6,"mat-form-field",14),Ue(4,JLe,2,1,"div",15),J()),2&i){const e=Re();se(2),ui(" ",e._intl.itemsPerPageLabel," "),se(1),fe("ngIf",e._displayedPageSizeOptions.length>1),se(1),fe("ngIf",e._displayedPageSizeOptions.length<=1)}}function eOe(i,t){if(1&i){const e=Wi();Z(0,"button",21),je("click",function(){return gt(e),Re().firstPage()}),Zu(),Z(1,"svg",7),yt(2,"path",22),J()()}if(2&i){const e=Re();fe("matTooltip",e._intl.firstPageLabel)("matTooltipDisabled",e._previousButtonsDisabled())("matTooltipPosition","above")("disabled",e._previousButtonsDisabled()),Vi("aria-label",e._intl.firstPageLabel)}}function tOe(i,t){if(1&i){const e=Wi();Zu(),xd(),Z(0,"button",23),je("click",function(){return gt(e),Re().lastPage()}),Zu(),Z(1,"svg",7),yt(2,"path",24),J()()}if(2&i){const e=Re();fe("matTooltip",e._intl.lastPageLabel)("matTooltipDisabled",e._nextButtonsDisabled())("matTooltipPosition","above")("disabled",e._nextButtonsDisabled()),Vi("aria-label",e._intl.lastPageLabel)}}let SL=(()=>{class i{constructor(){this.changes=new ii,this.itemsPerPageLabel="Items per page:",this.nextPageLabel="Next page",this.previousPageLabel="Previous page",this.firstPageLabel="First page",this.lastPageLabel="Last page",this.getRangeLabel=(e,n,r)=>{if(0==r||0==n)return`0 of ${r}`;const s=e*n;return`${s+1} \u2013 ${s<(r=Math.max(r,0))?Math.min(s+n,r):s+n} of ${r}`}}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Nt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const nOe={provide:SL,deps:[[new wh,new mm,SL]],useFactory:function iOe(i){return i||new SL}},sOe=new gi("MAT_PAGINATOR_DEFAULT_OPTIONS"),oOe=Hf(Xce(class{}));let aOe=(()=>{class i extends oOe{constructor(e,n,r){if(super(),this._intl=e,this._changeDetectorRef=n,this._pageIndex=0,this._length=0,this._pageSizeOptions=[],this._hidePageSize=!1,this._showFirstLastButtons=!1,this.page=new Si,this._intlChanges=e.changes.subscribe(()=>this._changeDetectorRef.markForCheck()),r){const{pageSize:s,pageSizeOptions:a,hidePageSize:l,showFirstLastButtons:u}=r;null!=s&&(this._pageSize=s),null!=a&&(this._pageSizeOptions=a),null!=l&&(this._hidePageSize=l),null!=u&&(this._showFirstLastButtons=u)}}get pageIndex(){return this._pageIndex}set pageIndex(e){this._pageIndex=Math.max(Qo(e),0),this._changeDetectorRef.markForCheck()}get length(){return this._length}set length(e){this._length=Qo(e),this._changeDetectorRef.markForCheck()}get pageSize(){return this._pageSize}set pageSize(e){this._pageSize=Math.max(Qo(e),0),this._updateDisplayedPageSizeOptions()}get pageSizeOptions(){return this._pageSizeOptions}set pageSizeOptions(e){this._pageSizeOptions=(e||[]).map(n=>Qo(n)),this._updateDisplayedPageSizeOptions()}get hidePageSize(){return this._hidePageSize}set hidePageSize(e){this._hidePageSize=tn(e)}get showFirstLastButtons(){return this._showFirstLastButtons}set showFirstLastButtons(e){this._showFirstLastButtons=tn(e)}ngOnInit(){this._initialized=!0,this._updateDisplayedPageSizeOptions(),this._markInitialized()}ngOnDestroy(){this._intlChanges.unsubscribe()}nextPage(){if(!this.hasNextPage())return;const e=this.pageIndex;this.pageIndex=this.pageIndex+1,this._emitPageEvent(e)}previousPage(){if(!this.hasPreviousPage())return;const e=this.pageIndex;this.pageIndex=this.pageIndex-1,this._emitPageEvent(e)}firstPage(){if(!this.hasPreviousPage())return;const e=this.pageIndex;this.pageIndex=0,this._emitPageEvent(e)}lastPage(){if(!this.hasNextPage())return;const e=this.pageIndex;this.pageIndex=this.getNumberOfPages()-1,this._emitPageEvent(e)}hasPreviousPage(){return this.pageIndex>=1&&0!=this.pageSize}hasNextPage(){const e=this.getNumberOfPages()-1;return this.pageIndex<e&&0!=this.pageSize}getNumberOfPages(){return this.pageSize?Math.ceil(this.length/this.pageSize):0}_changePageSize(e){const r=this.pageIndex;this.pageIndex=Math.floor(this.pageIndex*this.pageSize/e)||0,this.pageSize=e,this._emitPageEvent(r)}_nextButtonsDisabled(){return this.disabled||!this.hasNextPage()}_previousButtonsDisabled(){return this.disabled||!this.hasPreviousPage()}_updateDisplayedPageSizeOptions(){!this._initialized||(this.pageSize||(this._pageSize=0!=this.pageSizeOptions.length?this.pageSizeOptions[0]:50),this._displayedPageSizeOptions=this.pageSizeOptions.slice(),-1===this._displayedPageSizeOptions.indexOf(this.pageSize)&&this._displayedPageSizeOptions.push(this.pageSize),this._displayedPageSizeOptions.sort((e,n)=>e-n),this._changeDetectorRef.markForCheck())}_emitPageEvent(e){this.page.emit({previousPageIndex:e,pageIndex:this.pageIndex,pageSize:this.pageSize,length:this.length})}}return i.\u0275fac=function(e){Nd()},i.\u0275dir=Be({type:i,inputs:{color:"color",pageIndex:"pageIndex",length:"length",pageSize:"pageSize",pageSizeOptions:"pageSizeOptions",hidePageSize:"hidePageSize",showFirstLastButtons:"showFirstLastButtons"},outputs:{page:"page"},features:[It]}),i})(),lOe=(()=>{class i extends aOe{constructor(e,n,r){super(e,n,r),r&&null!=r.formFieldAppearance&&(this._formFieldAppearance=r.formFieldAppearance)}}return i.\u0275fac=function(e){return new(e||i)(B(SL),B(Pn),B(sOe,8))},i.\u0275cmp=ei({type:i,selectors:[["mat-paginator"]],hostAttrs:["role","group",1,"mat-paginator"],inputs:{disabled:"disabled"},exportAs:["matPaginator"],features:[It],decls:14,vars:14,consts:[[1,"mat-paginator-outer-container"],[1,"mat-paginator-container"],["class","mat-paginator-page-size",4,"ngIf"],[1,"mat-paginator-range-actions"],[1,"mat-paginator-range-label"],["mat-icon-button","","type","button","class","mat-paginator-navigation-first",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click",4,"ngIf"],["mat-icon-button","","type","button",1,"mat-paginator-navigation-previous",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["viewBox","0 0 24 24","focusable","false",1,"mat-paginator-icon"],["d","M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"],["mat-icon-button","","type","button",1,"mat-paginator-navigation-next",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["d","M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"],["mat-icon-button","","type","button","class","mat-paginator-navigation-last",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click",4,"ngIf"],[1,"mat-paginator-page-size"],[1,"mat-paginator-page-size-label"],["class","mat-paginator-page-size-select",3,"appearance","color",4,"ngIf"],["class","mat-paginator-page-size-value",4,"ngIf"],[1,"mat-paginator-page-size-select",3,"appearance","color"],[3,"value","disabled","aria-label","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"mat-paginator-page-size-value"],["mat-icon-button","","type","button",1,"mat-paginator-navigation-first",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["d","M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"],["mat-icon-button","","type","button",1,"mat-paginator-navigation-last",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["d","M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"]],template:function(e,n){1&e&&(Z(0,"div",0)(1,"div",1),Ue(2,$Le,5,3,"div",2),Z(3,"div",3)(4,"div",4),ue(5),J(),Ue(6,eOe,3,5,"button",5),Z(7,"button",6),je("click",function(){return n.previousPage()}),Zu(),Z(8,"svg",7),yt(9,"path",8),J()(),xd(),Z(10,"button",9),je("click",function(){return n.nextPage()}),Zu(),Z(11,"svg",7),yt(12,"path",10),J()(),Ue(13,tOe,3,5,"button",11),J()()()),2&e&&(se(2),fe("ngIf",!n.hidePageSize),se(3),ui(" ",n._intl.getRangeLabel(n.pageIndex,n.pageSize,n.length)," "),se(1),fe("ngIf",n.showFirstLastButtons),se(1),fe("matTooltip",n._intl.previousPageLabel)("matTooltipDisabled",n._previousButtonsDisabled())("matTooltipPosition","above")("disabled",n._previousButtonsDisabled()),Vi("aria-label",n._intl.previousPageLabel),se(3),fe("matTooltip",n._intl.nextPageLabel)("matTooltipDisabled",n._nextButtonsDisabled())("matTooltipPosition","above")("disabled",n._nextButtonsDisabled()),Vi("aria-label",n._intl.nextPageLabel),se(3),fe("ngIf",n.showFirstLastButtons))},directives:[og,C4,Vb,Mo,ms,mo,Fo],styles:[".mat-paginator{display:block}.mat-paginator-outer-container{display:flex}.mat-paginator-container{display:flex;align-items:center;justify-content:flex-end;padding:0 8px;flex-wrap:wrap-reverse;width:100%}.mat-paginator-page-size{display:flex;align-items:baseline;margin-right:8px}[dir=rtl] .mat-paginator-page-size{margin-right:0;margin-left:8px}.mat-paginator-page-size-label{margin:0 4px}.mat-paginator-page-size-select{margin:6px 4px 0 4px;width:56px}.mat-paginator-page-size-select.mat-form-field-appearance-outline{width:64px}.mat-paginator-page-size-select.mat-form-field-appearance-fill{width:64px}.mat-paginator-range-label{margin:0 32px 0 24px}.mat-paginator-range-actions{display:flex;align-items:center}.mat-paginator-icon{width:28px;fill:currentColor}[dir=rtl] .mat-paginator-icon{transform:rotate(180deg)}.cdk-high-contrast-active .mat-paginator-icon{fill:CanvasText}\n"],encapsulation:2,changeDetection:0}),i})(),cOe=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({providers:[nOe],imports:[[ka,jw,M4,sH,jn]]}),i})();function uOe(i,t){1&i&&(Z(0,"div"),yt(1,"mat-progress-bar",11),J())}function hOe(i,t){if(1&i&&(Z(0,"th",13),ue(1),J()),2&i){const e=Re().$implicit;se(1),ui(" ",e,"")}}function dOe(i,t){if(1&i&&(Z(0,"td",14),ue(1),J()),2&i){const e=t.$implicit,n=Re().$implicit;se(1),ui(" ",e[n]," ")}}function fOe(i,t){1&i&&(Wo(0,12),Ue(1,hOe,2,1,"th",5),Ue(2,dOe,2,1,"td",6),jo()),2&i&&_o("matColumnDef",t.$implicit)}function pOe(i,t){1&i&&(Z(0,"th",13),ue(1," Location"),J())}function mOe(i,t){if(1&i&&(Z(0,"td",14)(1,"a",15),ti(2,"ObjectPathPipe"),Z(3,"mat-icon"),ue(4,"open_in_new"),J()()()),2&i){const e=t.$implicit;se(1),_o("href",Qi(2,1,e),Mc)}}function gOe(i,t){if(1&i&&(Z(0,"th",13),ue(1),J()),2&i){const e=Re().$implicit;se(1),ui(" ",e,"")}}function _Oe(i,t){if(1&i&&(Z(0,"td",14),ue(1),J()),2&i){const e=t.$implicit,n=Re().$implicit;se(1),ui(" ",e[n]," ")}}function yOe(i,t){1&i&&(Wo(0,12),Ue(1,gOe,2,1,"th",5),Ue(2,_Oe,2,1,"td",6),jo()),2&i&&_o("matColumnDef",t.$implicit)}function vOe(i,t){1&i&&yt(0,"tr",19)}function bOe(i,t){1&i&&yt(0,"tr",20)}function xOe(i,t){if(1&i&&(Z(0,"div")(1,"table",17),Ue(2,yOe,3,1,"ng-container",3),Ue(3,vOe,1,0,"tr",8),Ue(4,bOe,1,0,"tr",18),J()()),2&i){const e=Re(2);se(1),fe("dataSource",e.detailData),se(1),fe("ngForOf",e.detailColumnsToDisplay),se(1),fe("matHeaderRowDef",e.detailColumnsToDisplay),se(1),fe("matRowDefColumns",e.detailColumnsToDisplay)}}function wOe(i,t){if(1&i&&(Z(0,"td",14)(1,"div",16),Ue(2,xOe,5,4,"div",0),J()()),2&i){const e=t.$implicit,n=Re();Vi("colspan",n.columnsToDisplay.length),se(1),fe("@detailExpand",e===n.expandedElement?"expanded":"collapsed"),se(1),fe("ngIf",e===n.expandedElement)}}function SOe(i,t){1&i&&yt(0,"tr",19)}function COe(i,t){if(1&i){const e=Wi();Z(0,"tr",21),je("click",function(){const s=gt(e).$implicit;return Re().toggleRow(s)}),J()}}function MOe(i,t){1&i&&yt(0,"tr",22)}const TOe=function(){return["expandedDetail"]},EOe=[{path:"mediaobject/:objectId",component:nIe},{path:"mediasegment/:segmentId",component:YLe},{path:"collection",component:(()=>{class i{constructor(e,n,r,s,a,l){this._query=e,this._object=n,this._misc=r,this._metadata=s,this._cdr=a,this._resolver=l,this.autoGeneratedCols=["objectid","name","mediatype","path"],this.columnsToDisplay=this.autoGeneratedCols.concat(["location"]),this.detailColumnsToDisplay=["objectid","domain","key","value"],this._loading=!0,this._loadingMetadata=!1,this.length=0,this.pageSize=10,this.pageSizeOptions=[5,10,25,100],this.data=[],this.detailData=[],this._index=0}ngAfterViewInit(){this._loading=!0,this._misc.countRows("cineast_multimediaobject").subscribe(e=>{console.log(`row count: ${e.value}`),this.length=e.value}),this.fetchInformation()}fetchInformation(){this._loading=!0,this._object.findObjectsPagination(this._index*this.pageSize,this.pageSize).subscribe(r=>{this.data=r.content,this._loading=!1})}fetchMetadata(){this._loadingMetadata=!0,console.log(this.expandedElement.objectid),this._metadata.findMetaById(this.expandedElement.objectid).subscribe(e=>{console.log(e),this.detailData=e.content,this._loadingMetadata=!1,this._cdr.detectChanges()})}pagination(e){this.pageSize=e.pageSize,this._index=e.pageIndex,this.fetchInformation()}toggleRow(e){this.expandedElement=this.expandedElement===e?null:e,this.detailData=[],this.expandedElement&&this.fetchMetadata()}trackById(e,n){return n.objectid}}return i.\u0275fac=function(e){return new(e||i)(B(Rc),B(rP),B(nP),B(Kb),B(Pn),B(Ts))},i.\u0275cmp=ei({type:i,selectors:[["app-collection"]],decls:16,vars:11,consts:[[4,"ngIf"],[3,"length","pageSize","pageSizeOptions","page"],["mat-table","","multiTemplateDataRows","",3,"dataSource","trackBy"],[3,"matColumnDef",4,"ngFor","ngForOf"],["matColumnDef","location"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","expandedDetail"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"click",4,"matRowDef","matRowDefColumns"],["mat-row","","class","detail-row",4,"matRowDef","matRowDefColumns"],["mode","buffer"],[3,"matColumnDef"],["mat-header-cell",""],["mat-cell",""],["mat-mini-fab","",3,"href"],[1,"example-element-detail"],["mat-table","",3,"dataSource"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-row",""],["mat-row",""],["mat-row","",3,"click"],["mat-row","",1,"detail-row"]],template:function(e,n){1&e&&(Ue(0,uOe,2,0,"div",0),Z(1,"h2"),ue(2,"Information about all Multimedia Objects in the database"),J(),Z(3,"h3"),ue(4,"Click on an object to see all metadata"),J(),Z(5,"mat-paginator",1),je("page",function(s){return n.pagination(s)}),J(),Z(6,"table",2),Ue(7,fOe,3,1,"ng-container",3),Wo(8,4),Ue(9,pOe,2,0,"th",5),Ue(10,mOe,5,3,"td",6),jo(),Wo(11,7),Ue(12,wOe,3,3,"td",6),jo(),Ue(13,SOe,1,0,"tr",8),Ue(14,COe,1,0,"tr",9),Ue(15,MOe,1,0,"tr",10),J()),2&e&&(fe("ngIf",n._loading||n._loadingMetadata),se(5),fe("length",n.length)("pageSize",n.pageSize)("pageSizeOptions",n.pageSizeOptions),se(1),fe("dataSource",n.data)("trackBy",n.trackById),se(1),fe("ngForOf",n.autoGeneratedCols),se(6),fe("matHeaderRowDef",n.columnsToDisplay),se(1),fe("matRowDefColumns",n.columnsToDisplay),se(1),fe("matRowDefColumns",n1(10,TOe)))},directives:[ms,kP,lOe,cz,mo,mL,pL,gL,fL,_L,A7,vo,uz,dz,hz,fz],pipes:[nL],styles:["table[_ngcontent-%COMP%]{width:100%}tr.detail-row[_ngcontent-%COMP%]{height:0}.element-detail[_ngcontent-%COMP%]{overflow:hidden;display:flex}"],data:{animation:[Xd("detailExpand",[Cl("collapsed",Xs({height:"0px",minHeight:"0"})),Cl("expanded",Xs({height:"*"})),Ml("expanded <=> collapsed",ql("225ms cubic-bezier(0.4, 0.0, 0.2, 1)"))])]}}),i})()},{path:"gallery",component:LIe},{path:"list",component:ILe},{path:"temporal-list",component:MP},{path:"mini-gallery",component:vee},{path:"",component:vee}];let rv=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({providers:[],imports:[[LH.forRoot(EOe,{relativeLinkResolution:"legacy"})],LH]}),i})(),AOe=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[ka,Lg]]}),i})(),DOe=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[ka,Lg]]}),i})(),bz=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i,bootstrap:[yee]}),i.\u0275inj=xi({imports:[[$o,ka,Oo,Lg,$Ie,AOe,DOe,Z0,Qh]]}),i})(),bee=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[$o,mh,Oo,rv,eL,bz,Qh,pz]]}),i})(),xee=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[$o,mh,Oo,rv,eL,Qh,bz,bee,bE,pz]]}),i})(),xz=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[$o,Oo,Za,rv,mh,Qh,Z0,xL,Lg]]}),i})(),wee=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[$o,Oo,Za,rv,mh,Qh,Z0,xL,Lg,xz]]}),i})(),See=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[$o,Oo,Za,rv,mh,Qh,xL,Z0,Lg,xz]]}),i})(),ROe=(()=>{class i{transform(e,n){if(!e||0===e.length||0===n)return[[],0];console.debug(`Limiting to ${n} media objects.`);const r=[];let s=0,a=0;return e.forEach(l=>{a>n||(a+l.segments.length>n&&(s=n-a),a+=l.segments.length,r.push(l))}),a<=n&&(s=r[r.length-1].segments.length),[r,s]}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275pipe=Hn({name:"LimitPathsPipe",type:i,pure:!0}),i})(),kOe=(()=>{class i{transform(e){return e.map(n=>function(r){return n(r.object)})}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275pipe=Hn({name:"ObjectFilterTemporalPipe",type:i,pure:!0}),i})(),Cee=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[$o,Oo,Za,rv,mh,Qh,Z0,xL,Lg,xz]]}),i})();!function hv(i,t,e){const n=i.\u0275cmp;n.directiveDefs=()=>t.map(J0),n.pipeDefs=()=>e.map(lm)}(MP,[ms,sf,bL,mo,Mo,Fo,vo,vz],[Xc,ROe,wL,kOe]);let POe=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[See,wee,Cee,Oo,$o,Lg],See,wee,Cee]}),i})(),IOe=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[$o,mh,Oo,rv,eL,bz,bee,xee,Qh]]}),i})(),LOe=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i}),i.\u0275inj=xi({imports:[[cOe,KH,pz,ka,Qh,LH,jw,oH]]}),i})();function OOe(i){return()=>i.load()}let FOe=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=yi({type:i,bootstrap:[MRe]}),i.\u0275inj=xi({providers:[dr,{provide:mR,useFactory:OOe,deps:[dr],multi:!0}],imports:[[Iw,VPe,Oo,$o,cle,Za,rv,POe,xee,LOe,IOe,zPe,HPe,nq,Qh]]}),i})();(function Iie(){A8=!1})(),Hre().bootstrapModule(FOe)},4999:C=>{"use strict";var b=function(Fe){return function D(we){return!!we&&"object"==typeof we}(Fe)&&!function F(we){var Fe=Object.prototype.toString.call(we);return"[object RegExp]"===Fe||"[object Date]"===Fe||function V(we){return we.$$typeof===z}(we)}(Fe)},z="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function te(we,Fe){return!1!==Fe.clone&&Fe.isMergeableObject(we)?G(function W(we){return Array.isArray(we)?[]:{}}(we),we,Fe):we}function Q(we,Fe,Le){return we.concat(Fe).map(function(it){return te(it,Le)})}function ae(we){return Object.keys(we).concat(function be(we){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(we).filter(function(Fe){return we.propertyIsEnumerable(Fe)}):[]}(we))}function Te(we,Fe){try{return Fe in we}catch(Le){return!1}}function G(we,Fe,Le){(Le=Le||{}).arrayMerge=Le.arrayMerge||Q,Le.isMergeableObject=Le.isMergeableObject||b,Le.cloneUnlessOtherwiseSpecified=te;var it=Array.isArray(Fe);return it===Array.isArray(we)?it?Le.arrayMerge(we,Fe,Le):function me(we,Fe,Le){var it={};return Le.isMergeableObject(we)&&ae(we).forEach(function(at){it[at]=te(we[at],Le)}),ae(Fe).forEach(function(at){(function Ae(we,Fe){return Te(we,Fe)&&!(Object.hasOwnProperty.call(we,Fe)&&Object.propertyIsEnumerable.call(we,Fe))})(we,at)||(it[at]=Te(we,at)&&Le.isMergeableObject(Fe[at])?function he(we,Fe){if(!Fe.customMerge)return G;var Le=Fe.customMerge(we);return"function"==typeof Le?Le:G}(at,Le)(we[at],Fe[at],Le):te(Fe[at],Le))}),it}(we,Fe,Le):te(Fe,Le)}G.all=function(Fe,Le){if(!Array.isArray(Fe))throw new Error("first argument should be an array");return Fe.reduce(function(it,at){return G(it,at,Le)},{})},C.exports=G},5650:C=>{C.exports=function b(D,F,H){function z(te,Q){if(!F[te]){if(!D[te]){if(V)return V(te,!0);var be=new Error("Cannot find module '"+te+"'");throw be.code="MODULE_NOT_FOUND",be}var ae=F[te]={exports:{}};D[te][0].call(ae.exports,function(Te){return z(D[te][1][Te]||Te)},ae,ae.exports,b,D,F,H)}return F[te].exports}for(var V=void 0,W=0;W<H.length;W++)z(H[W]);return z}({1:[function(b,D,F){"use strict";var H=b("./utils"),z=b("./support"),V="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";F.encode=function(W){for(var te,Q,he,ae,Te,Ae,me=[],G=0,de=W.length,we=de,Fe="string"!==H.getTypeOf(W);G<W.length;)we=de-G,he=Fe?(te=W[G++],Q=G<de?W[G++]:0,G<de?W[G++]:0):(te=W.charCodeAt(G++),Q=G<de?W.charCodeAt(G++):0,G<de?W.charCodeAt(G++):0),ae=(3&te)<<4|Q>>4,Te=1<we?(15&Q)<<2|he>>6:64,Ae=2<we?63&he:64,me.push(V.charAt(te>>2)+V.charAt(ae)+V.charAt(Te)+V.charAt(Ae));return me.join("")},F.decode=function(W){var te,Q,he,be,ae,Te,Ae=0,me=0,G="data:";if(W.substr(0,G.length)===G)throw new Error("Invalid base64 input, it looks like a data url.");var de,we=3*(W=W.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;if(W.charAt(W.length-1)===V.charAt(64)&&we--,W.charAt(W.length-2)===V.charAt(64)&&we--,we%1!=0)throw new Error("Invalid base64 input, bad content length.");for(de=z.uint8array?new Uint8Array(0|we):new Array(0|we);Ae<W.length;)te=V.indexOf(W.charAt(Ae++))<<2|(be=V.indexOf(W.charAt(Ae++)))>>4,Q=(15&be)<<4|(ae=V.indexOf(W.charAt(Ae++)))>>2,he=(3&ae)<<6|(Te=V.indexOf(W.charAt(Ae++))),de[me++]=te,64!==ae&&(de[me++]=Q),64!==Te&&(de[me++]=he);return de}},{"./support":30,"./utils":32}],2:[function(b,D,F){"use strict";var H=b("./external"),z=b("./stream/DataWorker"),V=b("./stream/Crc32Probe"),W=b("./stream/DataLengthProbe");function te(Q,he,be,ae,Te){this.compressedSize=Q,this.uncompressedSize=he,this.crc32=be,this.compression=ae,this.compressedContent=Te}te.prototype={getContentWorker:function(){var Q=new z(H.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new W("data_length")),he=this;return Q.on("end",function(){if(this.streamInfo.data_length!==he.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),Q},getCompressedWorker:function(){return new z(H.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},te.createWorkerFrom=function(Q,he,be){return Q.pipe(new V).pipe(new W("uncompressedSize")).pipe(he.compressWorker(be)).pipe(new W("compressedSize")).withStreamInfo("compression",he)},D.exports=te},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(b,D,F){"use strict";var H=b("./stream/GenericWorker");F.STORE={magic:"\0\0",compressWorker:function(z){return new H("STORE compression")},uncompressWorker:function(){return new H("STORE decompression")}},F.DEFLATE=b("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(b,D,F){"use strict";var H=b("./utils"),z=function(){for(var V,W=[],te=0;te<256;te++){V=te;for(var Q=0;Q<8;Q++)V=1&V?3988292384^V>>>1:V>>>1;W[te]=V}return W}();D.exports=function(V,W){return void 0!==V&&V.length?"string"!==H.getTypeOf(V)?function(te,Q,he,be){var ae=z,Te=0+he;te^=-1;for(var Ae=0;Ae<Te;Ae++)te=te>>>8^ae[255&(te^Q[Ae])];return-1^te}(0|W,V,V.length):function(te,Q,he,be){var ae=z,Te=0+he;te^=-1;for(var Ae=0;Ae<Te;Ae++)te=te>>>8^ae[255&(te^Q.charCodeAt(Ae))];return-1^te}(0|W,V,V.length):0}},{"./utils":32}],5:[function(b,D,F){"use strict";F.base64=!1,F.binary=!1,F.dir=!1,F.createFolders=!0,F.date=null,F.compression=null,F.compressionOptions=null,F.comment=null,F.unixPermissions=null,F.dosPermissions=null},{}],6:[function(b,D,F){"use strict";var H;H="undefined"!=typeof Promise?Promise:b("lie"),D.exports={Promise:H}},{lie:37}],7:[function(b,D,F){"use strict";var H="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,z=b("pako"),V=b("./utils"),W=b("./stream/GenericWorker"),te=H?"uint8array":"array";function Q(he,be){W.call(this,"FlateWorker/"+he),this._pako=null,this._pakoAction=he,this._pakoOptions=be,this.meta={}}F.magic="\b\0",V.inherits(Q,W),Q.prototype.processChunk=function(he){this.meta=he.meta,null===this._pako&&this._createPako(),this._pako.push(V.transformTo(te,he.data),!1)},Q.prototype.flush=function(){W.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},Q.prototype.cleanUp=function(){W.prototype.cleanUp.call(this),this._pako=null},Q.prototype._createPako=function(){this._pako=new z[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var he=this;this._pako.onData=function(be){he.push({data:be,meta:he.meta})}},F.compressWorker=function(he){return new Q("Deflate",he)},F.uncompressWorker=function(){return new Q("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(b,D,F){"use strict";function H(ae,Te){var Ae,me="";for(Ae=0;Ae<Te;Ae++)me+=String.fromCharCode(255&ae),ae>>>=8;return me}function z(ae,Te,Ae,me,G,de){var we,Fe,Le=ae.file,it=ae.compression,at=de!==te.utf8encode,Dt=V.transformTo("string",de(Le.name)),dt=V.transformTo("string",te.utf8encode(Le.name)),Kt=Le.comment,oi=V.transformTo("string",de(Kt)),We=V.transformTo("string",te.utf8encode(Kt)),xt=dt.length!==Le.name.length,_e=We.length!==Kt.length,Lt="",$i="",Wt="",Ei=Le.dir,Rt=Le.date,On={crc32:0,compressedSize:0,uncompressedSize:0};Te&&!Ae||(On.crc32=ae.crc32,On.compressedSize=ae.compressedSize,On.uncompressedSize=ae.uncompressedSize);var Ct=0;Te&&(Ct|=8),at||!xt&&!_e||(Ct|=2048);var Fi,ii,ft=0,bn=0;Ei&&(ft|=16),"UNIX"===G?(bn=798,ft|=(ii=Fi=Le.unixPermissions,Fi||(ii=Ei?16893:33204),(65535&ii)<<16)):(bn=20,ft|=function(Fi){return 63&(Fi||0)}(Le.dosPermissions)),we=Rt.getUTCHours(),we<<=6,we|=Rt.getUTCMinutes(),we<<=5,we|=Rt.getUTCSeconds()/2,Fe=Rt.getUTCFullYear()-1980,Fe<<=4,Fe|=Rt.getUTCMonth()+1,Fe<<=5,Fe|=Rt.getUTCDate(),xt&&($i=H(1,1)+H(Q(Dt),4)+dt,Lt+="up"+H($i.length,2)+$i),_e&&(Wt=H(1,1)+H(Q(oi),4)+We,Lt+="uc"+H(Wt.length,2)+Wt);var qi="";return qi+="\n\0",qi+=H(Ct,2),qi+=it.magic,qi+=H(we,2),qi+=H(Fe,2),qi+=H(On.crc32,4),qi+=H(On.compressedSize,4),qi+=H(On.uncompressedSize,4),qi+=H(Dt.length,2),qi+=H(Lt.length,2),{fileRecord:he.LOCAL_FILE_HEADER+qi+Dt+Lt,dirRecord:he.CENTRAL_FILE_HEADER+H(bn,2)+qi+H(oi.length,2)+"\0\0\0\0"+H(ft,4)+H(me,4)+Dt+Lt+oi}}var V=b("../utils"),W=b("../stream/GenericWorker"),te=b("../utf8"),Q=b("../crc32"),he=b("../signature");function be(ae,Te,Ae,me){W.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=Te,this.zipPlatform=Ae,this.encodeFileName=me,this.streamFiles=ae,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}V.inherits(be,W),be.prototype.push=function(ae){var Te=ae.meta.percent||0,Ae=this.entriesCount,me=this._sources.length;this.accumulate?this.contentBuffer.push(ae):(this.bytesWritten+=ae.data.length,W.prototype.push.call(this,{data:ae.data,meta:{currentFile:this.currentFile,percent:Ae?(Te+100*(Ae-me-1))/Ae:100}}))},be.prototype.openedSource=function(ae){this.currentSourceOffset=this.bytesWritten,this.currentFile=ae.file.name;var Te=this.streamFiles&&!ae.file.dir;if(Te){var Ae=z(ae,Te,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:Ae.fileRecord,meta:{percent:0}})}else this.accumulate=!0},be.prototype.closedSource=function(ae){this.accumulate=!1;var me,Te=this.streamFiles&&!ae.file.dir,Ae=z(ae,Te,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(Ae.dirRecord),Te)this.push({data:(me=ae,he.DATA_DESCRIPTOR+H(me.crc32,4)+H(me.compressedSize,4)+H(me.uncompressedSize,4)),meta:{percent:100}});else for(this.push({data:Ae.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},be.prototype.flush=function(){for(var ae=this.bytesWritten,Te=0;Te<this.dirRecords.length;Te++)this.push({data:this.dirRecords[Te],meta:{percent:100}});var G,de,we,it,me=(G=this.dirRecords.length,de=this.bytesWritten-ae,we=ae,it=V.transformTo("string",(0,this.encodeFileName)(this.zipComment)),he.CENTRAL_DIRECTORY_END+"\0\0\0\0"+H(G,2)+H(G,2)+H(de,4)+H(we,4)+H(it.length,2)+it);this.push({data:me,meta:{percent:100}})},be.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},be.prototype.registerPrevious=function(ae){this._sources.push(ae);var Te=this;return ae.on("data",function(Ae){Te.processChunk(Ae)}),ae.on("end",function(){Te.closedSource(Te.previous.streamInfo),Te._sources.length?Te.prepareNextSource():Te.end()}),ae.on("error",function(Ae){Te.error(Ae)}),this},be.prototype.resume=function(){return!!W.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},be.prototype.error=function(ae){var Te=this._sources;if(!W.prototype.error.call(this,ae))return!1;for(var Ae=0;Ae<Te.length;Ae++)try{Te[Ae].error(ae)}catch(me){}return!0},be.prototype.lock=function(){W.prototype.lock.call(this);for(var ae=this._sources,Te=0;Te<ae.length;Te++)ae[Te].lock()},D.exports=be},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(b,D,F){"use strict";var H=b("../compressions"),z=b("./ZipFileWorker");F.generateWorker=function(V,W,te){var Q=new z(W.streamFiles,te,W.platform,W.encodeFileName),he=0;try{V.forEach(function(be,ae){he++;var Te=function(de,we){var Fe=de||we,Le=H[Fe];if(!Le)throw new Error(Fe+" is not a valid compression method !");return Le}(ae.options.compression,W.compression),me=ae.dir,G=ae.date;ae._compressWorker(Te,ae.options.compressionOptions||W.compressionOptions||{}).withStreamInfo("file",{name:be,dir:me,date:G,comment:ae.comment||"",unixPermissions:ae.unixPermissions,dosPermissions:ae.dosPermissions}).pipe(Q)}),Q.entriesCount=he}catch(be){Q.error(be)}return Q}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(b,D,F){"use strict";function H(){if(!(this instanceof H))return new H;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var z=new H;for(var V in this)"function"!=typeof this[V]&&(z[V]=this[V]);return z}}(H.prototype=b("./object")).loadAsync=b("./load"),H.support=b("./support"),H.defaults=b("./defaults"),H.version="3.7.1",H.loadAsync=function(z,V){return(new H).loadAsync(z,V)},H.external=b("./external"),D.exports=H},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(b,D,F){"use strict";var H=b("./utils"),z=b("./external"),V=b("./utf8"),W=b("./zipEntries"),te=b("./stream/Crc32Probe"),Q=b("./nodejsUtils");function he(be){return new z.Promise(function(ae,Te){var Ae=be.decompressed.getContentWorker().pipe(new te);Ae.on("error",function(me){Te(me)}).on("end",function(){Ae.streamInfo.crc32!==be.decompressed.crc32?Te(new Error("Corrupted zip : CRC32 mismatch")):ae()}).resume()})}D.exports=function(be,ae){var Te=this;return ae=H.extend(ae||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:V.utf8decode}),Q.isNode&&Q.isStream(be)?z.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):H.prepareContent("the loaded zip file",be,!0,ae.optimizedBinaryString,ae.base64).then(function(Ae){var me=new W(ae);return me.load(Ae),me}).then(function(Ae){var me=[z.Promise.resolve(Ae)],G=Ae.files;if(ae.checkCRC32)for(var de=0;de<G.length;de++)me.push(he(G[de]));return z.Promise.all(me)}).then(function(Ae){for(var me=Ae.shift(),G=me.files,de=0;de<G.length;de++){var we=G[de];Te.file(we.fileNameStr,we.decompressed,{binary:!0,optimizedBinaryString:!0,date:we.date,dir:we.dir,comment:we.fileCommentStr.length?we.fileCommentStr:null,unixPermissions:we.unixPermissions,dosPermissions:we.dosPermissions,createFolders:ae.createFolders})}return me.zipComment.length&&(Te.comment=me.zipComment),Te})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(b,D,F){"use strict";var H=b("../utils"),z=b("../stream/GenericWorker");function V(W,te){z.call(this,"Nodejs stream input adapter for "+W),this._upstreamEnded=!1,this._bindStream(te)}H.inherits(V,z),V.prototype._bindStream=function(W){var te=this;(this._stream=W).pause(),W.on("data",function(Q){te.push({data:Q,meta:{percent:0}})}).on("error",function(Q){te.isPaused?this.generatedError=Q:te.error(Q)}).on("end",function(){te.isPaused?te._upstreamEnded=!0:te.end()})},V.prototype.pause=function(){return!!z.prototype.pause.call(this)&&(this._stream.pause(),!0)},V.prototype.resume=function(){return!!z.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},D.exports=V},{"../stream/GenericWorker":28,"../utils":32}],13:[function(b,D,F){"use strict";var H=b("readable-stream").Readable;function z(V,W,te){H.call(this,W),this._helper=V;var Q=this;V.on("data",function(he,be){Q.push(he)||Q._helper.pause(),te&&te(be)}).on("error",function(he){Q.emit("error",he)}).on("end",function(){Q.push(null)})}b("../utils").inherits(z,H),z.prototype._read=function(){this._helper.resume()},D.exports=z},{"../utils":32,"readable-stream":16}],14:[function(b,D,F){"use strict";D.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(H,z){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(H,z);if("number"==typeof H)throw new Error('The "data" argument must not be a number');return new Buffer(H,z)},allocBuffer:function(H){if(Buffer.alloc)return Buffer.alloc(H);var z=new Buffer(H);return z.fill(0),z},isBuffer:function(H){return Buffer.isBuffer(H)},isStream:function(H){return H&&"function"==typeof H.on&&"function"==typeof H.pause&&"function"==typeof H.resume}}},{}],15:[function(b,D,F){"use strict";function H(Le,it,at){var Dt,dt=V.getTypeOf(it),Kt=V.extend(at||{},Q);Kt.date=Kt.date||new Date,null!==Kt.compression&&(Kt.compression=Kt.compression.toUpperCase()),"string"==typeof Kt.unixPermissions&&(Kt.unixPermissions=parseInt(Kt.unixPermissions,8)),Kt.unixPermissions&&16384&Kt.unixPermissions&&(Kt.dir=!0),Kt.dosPermissions&&16&Kt.dosPermissions&&(Kt.dir=!0),Kt.dir&&(Le=G(Le)),Kt.createFolders&&(Dt=me(Le))&&de.call(this,Dt,!0),at&&void 0!==at.binary||(Kt.binary=!("string"===dt&&!1===Kt.binary&&!1===Kt.base64)),(it instanceof he&&0===it.uncompressedSize||Kt.dir||!it||0===it.length)&&(Kt.base64=!1,Kt.binary=!0,it="",Kt.compression="STORE",dt="string");var We;We=it instanceof he||it instanceof W?it:Te.isNode&&Te.isStream(it)?new Ae(Le,it):V.prepareContent(Le,it,Kt.binary,Kt.optimizedBinaryString,Kt.base64);var xt=new be(Le,We,Kt);this.files[Le]=xt}var z=b("./utf8"),V=b("./utils"),W=b("./stream/GenericWorker"),te=b("./stream/StreamHelper"),Q=b("./defaults"),he=b("./compressedObject"),be=b("./zipObject"),ae=b("./generate"),Te=b("./nodejsUtils"),Ae=b("./nodejs/NodejsStreamInputAdapter"),me=function(Le){"/"===Le.slice(-1)&&(Le=Le.substring(0,Le.length-1));var it=Le.lastIndexOf("/");return 0<it?Le.substring(0,it):""},G=function(Le){return"/"!==Le.slice(-1)&&(Le+="/"),Le},de=function(Le,it){return it=void 0!==it?it:Q.createFolders,Le=G(Le),this.files[Le]||H.call(this,Le,null,{dir:!0,createFolders:it}),this.files[Le]};function we(Le){return"[object RegExp]"===Object.prototype.toString.call(Le)}var Fe={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(Le){var it,at,Dt;for(it in this.files)Dt=this.files[it],(at=it.slice(this.root.length,it.length))&&it.slice(0,this.root.length)===this.root&&Le(at,Dt)},filter:function(Le){var it=[];return this.forEach(function(at,Dt){Le(at,Dt)&&it.push(Dt)}),it},file:function(Le,it,at){if(1!==arguments.length)return H.call(this,Le=this.root+Le,it,at),this;if(we(Le)){var Dt=Le;return this.filter(function(Kt,oi){return!oi.dir&&Dt.test(Kt)})}var dt=this.files[this.root+Le];return dt&&!dt.dir?dt:null},folder:function(Le){if(!Le)return this;if(we(Le))return this.filter(function(dt,Kt){return Kt.dir&&Le.test(dt)});var at=de.call(this,this.root+Le),Dt=this.clone();return Dt.root=at.name,Dt},remove:function(Le){var it=this.files[Le=this.root+Le];if(it||("/"!==Le.slice(-1)&&(Le+="/"),it=this.files[Le]),it&&!it.dir)delete this.files[Le];else for(var at=this.filter(function(dt,Kt){return Kt.name.slice(0,Le.length)===Le}),Dt=0;Dt<at.length;Dt++)delete this.files[at[Dt].name];return this},generate:function(Le){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(Le){var it,at={};try{if((at=V.extend(Le||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:z.utf8encode})).type=at.type.toLowerCase(),at.compression=at.compression.toUpperCase(),"binarystring"===at.type&&(at.type="string"),!at.type)throw new Error("No output type specified.");V.checkSupport(at.type),"darwin"!==at.platform&&"freebsd"!==at.platform&&"linux"!==at.platform&&"sunos"!==at.platform||(at.platform="UNIX"),"win32"===at.platform&&(at.platform="DOS"),it=ae.generateWorker(this,at,at.comment||this.comment||"")}catch(dt){(it=new W("error")).error(dt)}return new te(it,at.type||"string",at.mimeType)},generateAsync:function(Le,it){return this.generateInternalStream(Le).accumulate(it)},generateNodeStream:function(Le,it){return(Le=Le||{}).type||(Le.type="nodebuffer"),this.generateInternalStream(Le).toNodejsStream(it)}};D.exports=Fe},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(b,D,F){D.exports=b("stream")},{stream:void 0}],17:[function(b,D,F){"use strict";var H=b("./DataReader");function z(V){H.call(this,V);for(var W=0;W<this.data.length;W++)V[W]=255&V[W]}b("../utils").inherits(z,H),z.prototype.byteAt=function(V){return this.data[this.zero+V]},z.prototype.lastIndexOfSignature=function(V){for(var W=V.charCodeAt(0),te=V.charCodeAt(1),Q=V.charCodeAt(2),he=V.charCodeAt(3),be=this.length-4;0<=be;--be)if(this.data[be]===W&&this.data[be+1]===te&&this.data[be+2]===Q&&this.data[be+3]===he)return be-this.zero;return-1},z.prototype.readAndCheckSignature=function(V){var W=V.charCodeAt(0),te=V.charCodeAt(1),Q=V.charCodeAt(2),he=V.charCodeAt(3),be=this.readData(4);return W===be[0]&&te===be[1]&&Q===be[2]&&he===be[3]},z.prototype.readData=function(V){if(this.checkOffset(V),0===V)return[];var W=this.data.slice(this.zero+this.index,this.zero+this.index+V);return this.index+=V,W},D.exports=z},{"../utils":32,"./DataReader":18}],18:[function(b,D,F){"use strict";var H=b("../utils");function z(V){this.data=V,this.length=V.length,this.index=0,this.zero=0}z.prototype={checkOffset:function(V){this.checkIndex(this.index+V)},checkIndex:function(V){if(this.length<this.zero+V||V<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+V+"). Corrupted zip ?")},setIndex:function(V){this.checkIndex(V),this.index=V},skip:function(V){this.setIndex(this.index+V)},byteAt:function(V){},readInt:function(V){var W,te=0;for(this.checkOffset(V),W=this.index+V-1;W>=this.index;W--)te=(te<<8)+this.byteAt(W);return this.index+=V,te},readString:function(V){return H.transformTo("string",this.readData(V))},readData:function(V){},lastIndexOfSignature:function(V){},readAndCheckSignature:function(V){},readDate:function(){var V=this.readInt(4);return new Date(Date.UTC(1980+(V>>25&127),(V>>21&15)-1,V>>16&31,V>>11&31,V>>5&63,(31&V)<<1))}},D.exports=z},{"../utils":32}],19:[function(b,D,F){"use strict";var H=b("./Uint8ArrayReader");function z(V){H.call(this,V)}b("../utils").inherits(z,H),z.prototype.readData=function(V){this.checkOffset(V);var W=this.data.slice(this.zero+this.index,this.zero+this.index+V);return this.index+=V,W},D.exports=z},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(b,D,F){"use strict";var H=b("./DataReader");function z(V){H.call(this,V)}b("../utils").inherits(z,H),z.prototype.byteAt=function(V){return this.data.charCodeAt(this.zero+V)},z.prototype.lastIndexOfSignature=function(V){return this.data.lastIndexOf(V)-this.zero},z.prototype.readAndCheckSignature=function(V){return V===this.readData(4)},z.prototype.readData=function(V){this.checkOffset(V);var W=this.data.slice(this.zero+this.index,this.zero+this.index+V);return this.index+=V,W},D.exports=z},{"../utils":32,"./DataReader":18}],21:[function(b,D,F){"use strict";var H=b("./ArrayReader");function z(V){H.call(this,V)}b("../utils").inherits(z,H),z.prototype.readData=function(V){if(this.checkOffset(V),0===V)return new Uint8Array(0);var W=this.data.subarray(this.zero+this.index,this.zero+this.index+V);return this.index+=V,W},D.exports=z},{"../utils":32,"./ArrayReader":17}],22:[function(b,D,F){"use strict";var H=b("../utils"),z=b("../support"),V=b("./ArrayReader"),W=b("./StringReader"),te=b("./NodeBufferReader"),Q=b("./Uint8ArrayReader");D.exports=function(he){var be=H.getTypeOf(he);return H.checkSupport(be),"string"!==be||z.uint8array?"nodebuffer"===be?new te(he):z.uint8array?new Q(H.transformTo("uint8array",he)):new V(H.transformTo("array",he)):new W(he)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(b,D,F){"use strict";F.LOCAL_FILE_HEADER="PK\x03\x04",F.CENTRAL_FILE_HEADER="PK\x01\x02",F.CENTRAL_DIRECTORY_END="PK\x05\x06",F.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",F.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",F.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(b,D,F){"use strict";var H=b("./GenericWorker"),z=b("../utils");function V(W){H.call(this,"ConvertWorker to "+W),this.destType=W}z.inherits(V,H),V.prototype.processChunk=function(W){this.push({data:z.transformTo(this.destType,W.data),meta:W.meta})},D.exports=V},{"../utils":32,"./GenericWorker":28}],25:[function(b,D,F){"use strict";var H=b("./GenericWorker"),z=b("../crc32");function V(){H.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}b("../utils").inherits(V,H),V.prototype.processChunk=function(W){this.streamInfo.crc32=z(W.data,this.streamInfo.crc32||0),this.push(W)},D.exports=V},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(b,D,F){"use strict";var H=b("../utils"),z=b("./GenericWorker");function V(W){z.call(this,"DataLengthProbe for "+W),this.propName=W,this.withStreamInfo(W,0)}H.inherits(V,z),V.prototype.processChunk=function(W){W&&(this.streamInfo[this.propName]=(this.streamInfo[this.propName]||0)+W.data.length),z.prototype.processChunk.call(this,W)},D.exports=V},{"../utils":32,"./GenericWorker":28}],27:[function(b,D,F){"use strict";var H=b("../utils"),z=b("./GenericWorker");function V(W){z.call(this,"DataWorker");var te=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,W.then(function(Q){te.dataIsReady=!0,te.data=Q,te.max=Q&&Q.length||0,te.type=H.getTypeOf(Q),te.isPaused||te._tickAndRepeat()},function(Q){te.error(Q)})}H.inherits(V,z),V.prototype.cleanUp=function(){z.prototype.cleanUp.call(this),this.data=null},V.prototype.resume=function(){return!!z.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,H.delay(this._tickAndRepeat,[],this)),!0)},V.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(H.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},V.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var W=null,te=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":W=this.data.substring(this.index,te);break;case"uint8array":W=this.data.subarray(this.index,te);break;case"array":case"nodebuffer":W=this.data.slice(this.index,te)}return this.index=te,this.push({data:W,meta:{percent:this.max?this.index/this.max*100:0}})},D.exports=V},{"../utils":32,"./GenericWorker":28}],28:[function(b,D,F){"use strict";function H(z){this.name=z||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}H.prototype={push:function(z){this.emit("data",z)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(z){this.emit("error",z)}return!0},error:function(z){return!this.isFinished&&(this.isPaused?this.generatedError=z:(this.isFinished=!0,this.emit("error",z),this.previous&&this.previous.error(z),this.cleanUp()),!0)},on:function(z,V){return this._listeners[z].push(V),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(z,V){if(this._listeners[z])for(var W=0;W<this._listeners[z].length;W++)this._listeners[z][W].call(this,V)},pipe:function(z){return z.registerPrevious(this)},registerPrevious:function(z){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=z.streamInfo,this.mergeStreamInfo(),this.previous=z;var V=this;return z.on("data",function(W){V.processChunk(W)}),z.on("end",function(){V.end()}),z.on("error",function(W){V.error(W)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var z=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),z=!0),this.previous&&this.previous.resume(),!z},flush:function(){},processChunk:function(z){this.push(z)},withStreamInfo:function(z,V){return this.extraStreamInfo[z]=V,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var z in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(z)&&(this.streamInfo[z]=this.extraStreamInfo[z])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var z="Worker "+this.name;return this.previous?this.previous+" -> "+z:z}},D.exports=H},{}],29:[function(b,D,F){"use strict";var H=b("../utils"),z=b("./ConvertWorker"),V=b("./GenericWorker"),W=b("../base64"),te=b("../support"),Q=b("../external"),he=null;if(te.nodestream)try{he=b("../nodejs/NodejsStreamOutputAdapter")}catch(Te){}function ae(Te,Ae,me){var G=Ae;switch(Ae){case"blob":case"arraybuffer":G="uint8array";break;case"base64":G="string"}try{this._internalType=G,this._outputType=Ae,this._mimeType=me,H.checkSupport(G),this._worker=Te.pipe(new z(G)),Te.lock()}catch(de){this._worker=new V("error"),this._worker.error(de)}}ae.prototype={accumulate:function(Te){return function be(Te,Ae){return new Q.Promise(function(me,G){var de=[],we=Te._internalType,Fe=Te._outputType,Le=Te._mimeType;Te.on("data",function(it,at){de.push(it),Ae&&Ae(at)}).on("error",function(it){de=[],G(it)}).on("end",function(){try{var it=function(at,Dt,dt){switch(at){case"blob":return H.newBlob(H.transformTo("arraybuffer",Dt),dt);case"base64":return W.encode(Dt);default:return H.transformTo(at,Dt)}}(Fe,function(at,Dt){var dt,Kt=0,oi=null,We=0;for(dt=0;dt<Dt.length;dt++)We+=Dt[dt].length;switch(at){case"string":return Dt.join("");case"array":return Array.prototype.concat.apply([],Dt);case"uint8array":for(oi=new Uint8Array(We),dt=0;dt<Dt.length;dt++)oi.set(Dt[dt],Kt),Kt+=Dt[dt].length;return oi;case"nodebuffer":return Buffer.concat(Dt);default:throw new Error("concat : unsupported type '"+at+"'")}}(we,de),Le);me(it)}catch(at){G(at)}de=[]}).resume()})}(this,Te)},on:function(Te,Ae){var me=this;return this._worker.on(Te,"data"===Te?function(G){Ae.call(me,G.data,G.meta)}:function(){H.delay(Ae,arguments,me)}),this},resume:function(){return H.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(Te){if(H.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new he(this,{objectMode:"nodebuffer"!==this._outputType},Te)}},D.exports=ae},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(b,D,F){"use strict";if(F.base64=!0,F.array=!0,F.string=!0,F.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,F.nodebuffer="undefined"!=typeof Buffer,F.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)F.blob=!1;else{var H=new ArrayBuffer(0);try{F.blob=0===new Blob([H],{type:"application/zip"}).size}catch(V){try{var z=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);z.append(H),F.blob=0===z.getBlob("application/zip").size}catch(W){F.blob=!1}}}try{F.nodestream=!!b("readable-stream").Readable}catch(V){F.nodestream=!1}},{"readable-stream":16}],31:[function(b,D,F){"use strict";for(var H=b("./utils"),z=b("./support"),V=b("./nodejsUtils"),W=b("./stream/GenericWorker"),te=new Array(256),Q=0;Q<256;Q++)te[Q]=252<=Q?6:248<=Q?5:240<=Q?4:224<=Q?3:192<=Q?2:1;function he(){W.call(this,"utf-8 decode"),this.leftOver=null}function be(){W.call(this,"utf-8 encode")}te[254]=te[254]=1,F.utf8encode=function(ae){return z.nodebuffer?V.newBufferFrom(ae,"utf-8"):function(Te){var Ae,me,G,de,we,Fe=Te.length,Le=0;for(de=0;de<Fe;de++)55296==(64512&(me=Te.charCodeAt(de)))&&de+1<Fe&&56320==(64512&(G=Te.charCodeAt(de+1)))&&(me=65536+(me-55296<<10)+(G-56320),de++),Le+=me<128?1:me<2048?2:me<65536?3:4;for(Ae=z.uint8array?new Uint8Array(Le):new Array(Le),de=we=0;we<Le;de++)55296==(64512&(me=Te.charCodeAt(de)))&&de+1<Fe&&56320==(64512&(G=Te.charCodeAt(de+1)))&&(me=65536+(me-55296<<10)+(G-56320),de++),me<128?Ae[we++]=me:(me<2048?Ae[we++]=192|me>>>6:(me<65536?Ae[we++]=224|me>>>12:(Ae[we++]=240|me>>>18,Ae[we++]=128|me>>>12&63),Ae[we++]=128|me>>>6&63),Ae[we++]=128|63&me);return Ae}(ae)},F.utf8decode=function(ae){return z.nodebuffer?H.transformTo("nodebuffer",ae).toString("utf-8"):function(Te){var Ae,me,G,de,we=Te.length,Fe=new Array(2*we);for(Ae=me=0;Ae<we;)if((G=Te[Ae++])<128)Fe[me++]=G;else if(4<(de=te[G]))Fe[me++]=65533,Ae+=de-1;else{for(G&=2===de?31:3===de?15:7;1<de&&Ae<we;)G=G<<6|63&Te[Ae++],de--;1<de?Fe[me++]=65533:G<65536?Fe[me++]=G:(Fe[me++]=55296|(G-=65536)>>10&1023,Fe[me++]=56320|1023&G)}return Fe.length!==me&&(Fe.subarray?Fe=Fe.subarray(0,me):Fe.length=me),H.applyFromCharCode(Fe)}(ae=H.transformTo(z.uint8array?"uint8array":"array",ae))},H.inherits(he,W),he.prototype.processChunk=function(ae){var Te=H.transformTo(z.uint8array?"uint8array":"array",ae.data);if(this.leftOver&&this.leftOver.length){if(z.uint8array){var Ae=Te;(Te=new Uint8Array(Ae.length+this.leftOver.length)).set(this.leftOver,0),Te.set(Ae,this.leftOver.length)}else Te=this.leftOver.concat(Te);this.leftOver=null}var me=function(de,we){var Fe;for((we=we||de.length)>de.length&&(we=de.length),Fe=we-1;0<=Fe&&128==(192&de[Fe]);)Fe--;return Fe<0||0===Fe?we:Fe+te[de[Fe]]>we?Fe:we}(Te),G=Te;me!==Te.length&&(z.uint8array?(G=Te.subarray(0,me),this.leftOver=Te.subarray(me,Te.length)):(G=Te.slice(0,me),this.leftOver=Te.slice(me,Te.length))),this.push({data:F.utf8decode(G),meta:ae.meta})},he.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:F.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},F.Utf8DecodeWorker=he,H.inherits(be,W),be.prototype.processChunk=function(ae){this.push({data:F.utf8encode(ae.data),meta:ae.meta})},F.Utf8EncodeWorker=be},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(b,D,F){"use strict";var H=b("./support"),z=b("./base64"),V=b("./nodejsUtils"),W=b("set-immediate-shim"),te=b("./external");function Q(me){return me}function he(me,G){for(var de=0;de<me.length;++de)G[de]=255&me.charCodeAt(de);return G}F.newBlob=function(me,G){F.checkSupport("blob");try{return new Blob([me],{type:G})}catch(we){try{var de=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return de.append(me),de.getBlob(G)}catch(Fe){throw new Error("Bug : can't construct the Blob.")}}};var be={stringifyByChunk:function(me,G,de){var we=[],Fe=0,Le=me.length;if(Le<=de)return String.fromCharCode.apply(null,me);for(;Fe<Le;)we.push(String.fromCharCode.apply(null,"array"===G||"nodebuffer"===G?me.slice(Fe,Math.min(Fe+de,Le)):me.subarray(Fe,Math.min(Fe+de,Le)))),Fe+=de;return we.join("")},stringifyByChar:function(me){for(var G="",de=0;de<me.length;de++)G+=String.fromCharCode(me[de]);return G},applyCanBeUsed:{uint8array:function(){try{return H.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(me){return!1}}(),nodebuffer:function(){try{return H.nodebuffer&&1===String.fromCharCode.apply(null,V.allocBuffer(1)).length}catch(me){return!1}}()}};function ae(me){var G=65536,de=F.getTypeOf(me),we=!0;if("uint8array"===de?we=be.applyCanBeUsed.uint8array:"nodebuffer"===de&&(we=be.applyCanBeUsed.nodebuffer),we)for(;1<G;)try{return be.stringifyByChunk(me,de,G)}catch(Fe){G=Math.floor(G/2)}return be.stringifyByChar(me)}function Te(me,G){for(var de=0;de<me.length;de++)G[de]=me[de];return G}F.applyFromCharCode=ae;var Ae={};Ae.string={string:Q,array:function(me){return he(me,new Array(me.length))},arraybuffer:function(me){return Ae.string.uint8array(me).buffer},uint8array:function(me){return he(me,new Uint8Array(me.length))},nodebuffer:function(me){return he(me,V.allocBuffer(me.length))}},Ae.array={string:ae,array:Q,arraybuffer:function(me){return new Uint8Array(me).buffer},uint8array:function(me){return new Uint8Array(me)},nodebuffer:function(me){return V.newBufferFrom(me)}},Ae.arraybuffer={string:function(me){return ae(new Uint8Array(me))},array:function(me){return Te(new Uint8Array(me),new Array(me.byteLength))},arraybuffer:Q,uint8array:function(me){return new Uint8Array(me)},nodebuffer:function(me){return V.newBufferFrom(new Uint8Array(me))}},Ae.uint8array={string:ae,array:function(me){return Te(me,new Array(me.length))},arraybuffer:function(me){return me.buffer},uint8array:Q,nodebuffer:function(me){return V.newBufferFrom(me)}},Ae.nodebuffer={string:ae,array:function(me){return Te(me,new Array(me.length))},arraybuffer:function(me){return Ae.nodebuffer.uint8array(me).buffer},uint8array:function(me){return Te(me,new Uint8Array(me.length))},nodebuffer:Q},F.transformTo=function(me,G){if(G=G||"",!me)return G;F.checkSupport(me);var de=F.getTypeOf(G);return Ae[de][me](G)},F.getTypeOf=function(me){return"string"==typeof me?"string":"[object Array]"===Object.prototype.toString.call(me)?"array":H.nodebuffer&&V.isBuffer(me)?"nodebuffer":H.uint8array&&me instanceof Uint8Array?"uint8array":H.arraybuffer&&me instanceof ArrayBuffer?"arraybuffer":void 0},F.checkSupport=function(me){if(!H[me.toLowerCase()])throw new Error(me+" is not supported by this platform")},F.MAX_VALUE_16BITS=65535,F.MAX_VALUE_32BITS=-1,F.pretty=function(me){var G,de,we="";for(de=0;de<(me||"").length;de++)we+="\\x"+((G=me.charCodeAt(de))<16?"0":"")+G.toString(16).toUpperCase();return we},F.delay=function(me,G,de){W(function(){me.apply(de||null,G||[])})},F.inherits=function(me,G){function de(){}de.prototype=G.prototype,me.prototype=new de},F.extend=function(){var me,G,de={};for(me=0;me<arguments.length;me++)for(G in arguments[me])arguments[me].hasOwnProperty(G)&&void 0===de[G]&&(de[G]=arguments[me][G]);return de},F.prepareContent=function(me,G,de,we,Fe){return te.Promise.resolve(G).then(function(Le){return H.blob&&(Le instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(Le)))&&"undefined"!=typeof FileReader?new te.Promise(function(it,at){var Dt=new FileReader;Dt.onload=function(dt){it(dt.target.result)},Dt.onerror=function(dt){at(dt.target.error)},Dt.readAsArrayBuffer(Le)}):Le}).then(function(Le){var at,it=F.getTypeOf(Le);return it?("arraybuffer"===it?Le=F.transformTo("uint8array",Le):"string"===it&&(Fe?Le=z.decode(Le):de&&!0!==we&&(Le=he(at=Le,H.uint8array?new Uint8Array(at.length):new Array(at.length)))),Le):te.Promise.reject(new Error("Can't read the data of '"+me+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,"set-immediate-shim":54}],33:[function(b,D,F){"use strict";var H=b("./reader/readerFor"),z=b("./utils"),V=b("./signature"),W=b("./zipEntry"),te=(b("./utf8"),b("./support"));function Q(he){this.files=[],this.loadOptions=he}Q.prototype={checkSignature:function(he){if(!this.reader.readAndCheckSignature(he)){this.reader.index-=4;var be=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+z.pretty(be)+", expected "+z.pretty(he)+")")}},isSignature:function(he,be){var ae=this.reader.index;this.reader.setIndex(he);var Te=this.reader.readString(4)===be;return this.reader.setIndex(ae),Te},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var he=this.reader.readData(this.zipCommentLength),ae=z.transformTo(te.uint8array?"uint8array":"array",he);this.zipComment=this.loadOptions.decodeFileName(ae)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var he,be,ae,Te=this.zip64EndOfCentralSize-44;0<Te;)he=this.reader.readInt(2),be=this.reader.readInt(4),ae=this.reader.readData(be),this.zip64ExtensibleData[he]={id:he,length:be,value:ae}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var he,be;for(he=0;he<this.files.length;he++)this.reader.setIndex((be=this.files[he]).localHeaderOffset),this.checkSignature(V.LOCAL_FILE_HEADER),be.readLocalPart(this.reader),be.handleUTF8(),be.processAttributes()},readCentralDir:function(){var he;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(V.CENTRAL_FILE_HEADER);)(he=new W({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(he);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var he=this.reader.lastIndexOfSignature(V.CENTRAL_DIRECTORY_END);if(he<0)throw this.isSignature(0,V.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(he);var be=he;if(this.checkSignature(V.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===z.MAX_VALUE_16BITS||this.diskWithCentralDirStart===z.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===z.MAX_VALUE_16BITS||this.centralDirRecords===z.MAX_VALUE_16BITS||this.centralDirSize===z.MAX_VALUE_32BITS||this.centralDirOffset===z.MAX_VALUE_32BITS){if(this.zip64=!0,(he=this.reader.lastIndexOfSignature(V.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(he),this.checkSignature(V.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,V.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(V.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(V.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var ae=this.centralDirOffset+this.centralDirSize;this.zip64&&(ae+=20,ae+=12+this.zip64EndOfCentralSize);var Te=be-ae;if(0<Te)this.isSignature(be,V.CENTRAL_FILE_HEADER)||(this.reader.zero=Te);else if(Te<0)throw new Error("Corrupted zip: missing "+Math.abs(Te)+" bytes.")},prepareReader:function(he){this.reader=H(he)},load:function(he){this.prepareReader(he),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},D.exports=Q},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utf8":31,"./utils":32,"./zipEntry":34}],34:[function(b,D,F){"use strict";var H=b("./reader/readerFor"),z=b("./utils"),V=b("./compressedObject"),W=b("./crc32"),te=b("./utf8"),Q=b("./compressions"),he=b("./support");function be(ae,Te){this.options=ae,this.loadOptions=Te}be.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(ae){var Te,Ae;if(ae.skip(22),this.fileNameLength=ae.readInt(2),Ae=ae.readInt(2),this.fileName=ae.readData(this.fileNameLength),ae.skip(Ae),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(Te=function(me){for(var G in Q)if(Q.hasOwnProperty(G)&&Q[G].magic===me)return Q[G];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+z.pretty(this.compressionMethod)+" unknown (inner file : "+z.transformTo("string",this.fileName)+")");this.decompressed=new V(this.compressedSize,this.uncompressedSize,this.crc32,Te,ae.readData(this.compressedSize))},readCentralPart:function(ae){this.versionMadeBy=ae.readInt(2),ae.skip(2),this.bitFlag=ae.readInt(2),this.compressionMethod=ae.readString(2),this.date=ae.readDate(),this.crc32=ae.readInt(4),this.compressedSize=ae.readInt(4),this.uncompressedSize=ae.readInt(4);var Te=ae.readInt(2);if(this.extraFieldsLength=ae.readInt(2),this.fileCommentLength=ae.readInt(2),this.diskNumberStart=ae.readInt(2),this.internalFileAttributes=ae.readInt(2),this.externalFileAttributes=ae.readInt(4),this.localHeaderOffset=ae.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");ae.skip(Te),this.readExtraFields(ae),this.parseZIP64ExtraField(ae),this.fileComment=ae.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var ae=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==ae&&(this.dosPermissions=63&this.externalFileAttributes),3==ae&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(ae){if(this.extraFields[1]){var Te=H(this.extraFields[1].value);this.uncompressedSize===z.MAX_VALUE_32BITS&&(this.uncompressedSize=Te.readInt(8)),this.compressedSize===z.MAX_VALUE_32BITS&&(this.compressedSize=Te.readInt(8)),this.localHeaderOffset===z.MAX_VALUE_32BITS&&(this.localHeaderOffset=Te.readInt(8)),this.diskNumberStart===z.MAX_VALUE_32BITS&&(this.diskNumberStart=Te.readInt(4))}},readExtraFields:function(ae){var Te,Ae,me,G=ae.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});ae.index+4<G;)Te=ae.readInt(2),Ae=ae.readInt(2),me=ae.readData(Ae),this.extraFields[Te]={id:Te,length:Ae,value:me};ae.setIndex(G)},handleUTF8:function(){var ae=he.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=te.utf8decode(this.fileName),this.fileCommentStr=te.utf8decode(this.fileComment);else{var Te=this.findExtraFieldUnicodePath();if(null!==Te)this.fileNameStr=Te;else{var Ae=z.transformTo(ae,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(Ae)}var me=this.findExtraFieldUnicodeComment();if(null!==me)this.fileCommentStr=me;else{var G=z.transformTo(ae,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(G)}}},findExtraFieldUnicodePath:function(){var ae=this.extraFields[28789];if(ae){var Te=H(ae.value);return 1!==Te.readInt(1)||W(this.fileName)!==Te.readInt(4)?null:te.utf8decode(Te.readData(ae.length-5))}return null},findExtraFieldUnicodeComment:function(){var ae=this.extraFields[25461];if(ae){var Te=H(ae.value);return 1!==Te.readInt(1)||W(this.fileComment)!==Te.readInt(4)?null:te.utf8decode(Te.readData(ae.length-5))}return null}},D.exports=be},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(b,D,F){"use strict";function H(Te,Ae,me){this.name=Te,this.dir=me.dir,this.date=me.date,this.comment=me.comment,this.unixPermissions=me.unixPermissions,this.dosPermissions=me.dosPermissions,this._data=Ae,this._dataBinary=me.binary,this.options={compression:me.compression,compressionOptions:me.compressionOptions}}var z=b("./stream/StreamHelper"),V=b("./stream/DataWorker"),W=b("./utf8"),te=b("./compressedObject"),Q=b("./stream/GenericWorker");H.prototype={internalStream:function(Te){var Ae=null,me="string";try{if(!Te)throw new Error("No output type specified.");var G="string"===(me=Te.toLowerCase())||"text"===me;"binarystring"!==me&&"text"!==me||(me="string"),Ae=this._decompressWorker();var de=!this._dataBinary;de&&!G&&(Ae=Ae.pipe(new W.Utf8EncodeWorker)),!de&&G&&(Ae=Ae.pipe(new W.Utf8DecodeWorker))}catch(we){(Ae=new Q("error")).error(we)}return new z(Ae,me,"")},async:function(Te,Ae){return this.internalStream(Te).accumulate(Ae)},nodeStream:function(Te,Ae){return this.internalStream(Te||"nodebuffer").toNodejsStream(Ae)},_compressWorker:function(Te,Ae){if(this._data instanceof te&&this._data.compression.magic===Te.magic)return this._data.getCompressedWorker();var me=this._decompressWorker();return this._dataBinary||(me=me.pipe(new W.Utf8EncodeWorker)),te.createWorkerFrom(me,Te,Ae)},_decompressWorker:function(){return this._data instanceof te?this._data.getContentWorker():this._data instanceof Q?this._data:new V(this._data)}};for(var he=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],be=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},ae=0;ae<he.length;ae++)H.prototype[he[ae]]=be;D.exports=H},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(b,D,F){(function(H){"use strict";var z,V,W=H.MutationObserver||H.WebKitMutationObserver;if(W){var te=0,Q=new W(Te),he=H.document.createTextNode("");Q.observe(he,{characterData:!0}),z=function(){he.data=te=++te%2}}else if(H.setImmediate||void 0===H.MessageChannel)z="document"in H&&"onreadystatechange"in H.document.createElement("script")?function(){var Ae=H.document.createElement("script");Ae.onreadystatechange=function(){Te(),Ae.onreadystatechange=null,Ae.parentNode.removeChild(Ae),Ae=null},H.document.documentElement.appendChild(Ae)}:function(){setTimeout(Te,0)};else{var be=new H.MessageChannel;be.port1.onmessage=Te,z=function(){be.port2.postMessage(0)}}var ae=[];function Te(){var Ae,me;V=!0;for(var G=ae.length;G;){for(me=ae,ae=[],Ae=-1;++Ae<G;)me[Ae]();G=ae.length}V=!1}D.exports=function(Ae){1!==ae.push(Ae)||V||z()}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(b,D,F){"use strict";var H=b("immediate");function z(){}var V={},W=["REJECTED"],te=["FULFILLED"],Q=["PENDING"];function he(G){if("function"!=typeof G)throw new TypeError("resolver must be a function");this.state=Q,this.queue=[],this.outcome=void 0,G!==z&&Ae(this,G)}function be(G,de,we){this.promise=G,"function"==typeof de&&(this.onFulfilled=de,this.callFulfilled=this.otherCallFulfilled),"function"==typeof we&&(this.onRejected=we,this.callRejected=this.otherCallRejected)}function ae(G,de,we){H(function(){var Fe;try{Fe=de(we)}catch(Le){return V.reject(G,Le)}Fe===G?V.reject(G,new TypeError("Cannot resolve promise with itself")):V.resolve(G,Fe)})}function Te(G){var de=G&&G.then;if(G&&("object"==typeof G||"function"==typeof G)&&"function"==typeof de)return function(){de.apply(G,arguments)}}function Ae(G,de){var we=!1;function Fe(at){we||(we=!0,V.reject(G,at))}function Le(at){we||(we=!0,V.resolve(G,at))}var it=me(function(){de(Le,Fe)});"error"===it.status&&Fe(it.value)}function me(G,de){var we={};try{we.value=G(de),we.status="success"}catch(Fe){we.status="error",we.value=Fe}return we}(D.exports=he).prototype.finally=function(G){if("function"!=typeof G)return this;var de=this.constructor;return this.then(function(we){return de.resolve(G()).then(function(){return we})},function(we){return de.resolve(G()).then(function(){throw we})})},he.prototype.catch=function(G){return this.then(null,G)},he.prototype.then=function(G,de){if("function"!=typeof G&&this.state===te||"function"!=typeof de&&this.state===W)return this;var we=new this.constructor(z);return this.state!==Q?ae(we,this.state===te?G:de,this.outcome):this.queue.push(new be(we,G,de)),we},be.prototype.callFulfilled=function(G){V.resolve(this.promise,G)},be.prototype.otherCallFulfilled=function(G){ae(this.promise,this.onFulfilled,G)},be.prototype.callRejected=function(G){V.reject(this.promise,G)},be.prototype.otherCallRejected=function(G){ae(this.promise,this.onRejected,G)},V.resolve=function(G,de){var we=me(Te,de);if("error"===we.status)return V.reject(G,we.value);var Fe=we.value;if(Fe)Ae(G,Fe);else{G.state=te,G.outcome=de;for(var Le=-1,it=G.queue.length;++Le<it;)G.queue[Le].callFulfilled(de)}return G},V.reject=function(G,de){G.state=W,G.outcome=de;for(var we=-1,Fe=G.queue.length;++we<Fe;)G.queue[we].callRejected(de);return G},he.resolve=function(G){return G instanceof this?G:V.resolve(new this(z),G)},he.reject=function(G){var de=new this(z);return V.reject(de,G)},he.all=function(G){var de=this;if("[object Array]"!==Object.prototype.toString.call(G))return this.reject(new TypeError("must be an array"));var we=G.length,Fe=!1;if(!we)return this.resolve([]);for(var Le=new Array(we),it=0,at=-1,Dt=new this(z);++at<we;)dt(G[at],at);return Dt;function dt(Kt,oi){de.resolve(Kt).then(function(We){Le[oi]=We,++it!==we||Fe||(Fe=!0,V.resolve(Dt,Le))},function(We){Fe||(Fe=!0,V.reject(Dt,We))})}},he.race=function(G){if("[object Array]"!==Object.prototype.toString.call(G))return this.reject(new TypeError("must be an array"));var we=G.length,Fe=!1;if(!we)return this.resolve([]);for(var Le=-1,it=new this(z);++Le<we;)this.resolve(G[Le]).then(function(Dt){Fe||(Fe=!0,V.resolve(it,Dt))},function(Dt){Fe||(Fe=!0,V.reject(it,Dt))});return it}},{immediate:36}],38:[function(b,D,F){"use strict";var H={};(0,b("./lib/utils/common").assign)(H,b("./lib/deflate"),b("./lib/inflate"),b("./lib/zlib/constants")),D.exports=H},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(b,D,F){"use strict";var H=b("./zlib/deflate"),z=b("./utils/common"),V=b("./utils/strings"),W=b("./zlib/messages"),te=b("./zlib/zstream"),Q=Object.prototype.toString;function Ae(G){if(!(this instanceof Ae))return new Ae(G);this.options=z.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},G||{});var de=this.options;de.raw&&0<de.windowBits?de.windowBits=-de.windowBits:de.gzip&&0<de.windowBits&&de.windowBits<16&&(de.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new te,this.strm.avail_out=0;var we=H.deflateInit2(this.strm,de.level,de.method,de.windowBits,de.memLevel,de.strategy);if(0!==we)throw new Error(W[we]);if(de.header&&H.deflateSetHeader(this.strm,de.header),de.dictionary){var Fe;if(Fe="string"==typeof de.dictionary?V.string2buf(de.dictionary):"[object ArrayBuffer]"===Q.call(de.dictionary)?new Uint8Array(de.dictionary):de.dictionary,0!==(we=H.deflateSetDictionary(this.strm,Fe)))throw new Error(W[we]);this._dict_set=!0}}function me(G,de){var we=new Ae(de);if(we.push(G,!0),we.err)throw we.msg||W[we.err];return we.result}Ae.prototype.push=function(G,de){var we,Fe,Le=this.strm,it=this.options.chunkSize;if(this.ended)return!1;Fe=de===~~de?de:!0===de?4:0,Le.input="string"==typeof G?V.string2buf(G):"[object ArrayBuffer]"===Q.call(G)?new Uint8Array(G):G,Le.next_in=0,Le.avail_in=Le.input.length;do{if(0===Le.avail_out&&(Le.output=new z.Buf8(it),Le.next_out=0,Le.avail_out=it),1!==(we=H.deflate(Le,Fe))&&0!==we)return this.onEnd(we),!(this.ended=!0);0!==Le.avail_out&&(0!==Le.avail_in||4!==Fe&&2!==Fe)||this.onData("string"===this.options.to?V.buf2binstring(z.shrinkBuf(Le.output,Le.next_out)):z.shrinkBuf(Le.output,Le.next_out))}while((0<Le.avail_in||0===Le.avail_out)&&1!==we);return 4===Fe?(we=H.deflateEnd(this.strm),this.onEnd(we),this.ended=!0,0===we):2!==Fe||(this.onEnd(0),!(Le.avail_out=0))},Ae.prototype.onData=function(G){this.chunks.push(G)},Ae.prototype.onEnd=function(G){0===G&&(this.result="string"===this.options.to?this.chunks.join(""):z.flattenChunks(this.chunks)),this.chunks=[],this.err=G,this.msg=this.strm.msg},F.Deflate=Ae,F.deflate=me,F.deflateRaw=function(G,de){return(de=de||{}).raw=!0,me(G,de)},F.gzip=function(G,de){return(de=de||{}).gzip=!0,me(G,de)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(b,D,F){"use strict";var H=b("./zlib/inflate"),z=b("./utils/common"),V=b("./utils/strings"),W=b("./zlib/constants"),te=b("./zlib/messages"),Q=b("./zlib/zstream"),he=b("./zlib/gzheader"),be=Object.prototype.toString;function ae(Ae){if(!(this instanceof ae))return new ae(Ae);this.options=z.assign({chunkSize:16384,windowBits:0,to:""},Ae||{});var me=this.options;me.raw&&0<=me.windowBits&&me.windowBits<16&&(me.windowBits=-me.windowBits,0===me.windowBits&&(me.windowBits=-15)),!(0<=me.windowBits&&me.windowBits<16)||Ae&&Ae.windowBits||(me.windowBits+=32),15<me.windowBits&&me.windowBits<48&&0==(15&me.windowBits)&&(me.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Q,this.strm.avail_out=0;var G=H.inflateInit2(this.strm,me.windowBits);if(G!==W.Z_OK)throw new Error(te[G]);this.header=new he,H.inflateGetHeader(this.strm,this.header)}function Te(Ae,me){var G=new ae(me);if(G.push(Ae,!0),G.err)throw G.msg||te[G.err];return G.result}ae.prototype.push=function(Ae,me){var G,de,we,Fe,Le,it,at=this.strm,Dt=this.options.chunkSize,dt=this.options.dictionary,Kt=!1;if(this.ended)return!1;de=me===~~me?me:!0===me?W.Z_FINISH:W.Z_NO_FLUSH,at.input="string"==typeof Ae?V.binstring2buf(Ae):"[object ArrayBuffer]"===be.call(Ae)?new Uint8Array(Ae):Ae,at.next_in=0,at.avail_in=at.input.length;do{if(0===at.avail_out&&(at.output=new z.Buf8(Dt),at.next_out=0,at.avail_out=Dt),(G=H.inflate(at,W.Z_NO_FLUSH))===W.Z_NEED_DICT&&dt&&(it="string"==typeof dt?V.string2buf(dt):"[object ArrayBuffer]"===be.call(dt)?new Uint8Array(dt):dt,G=H.inflateSetDictionary(this.strm,it)),G===W.Z_BUF_ERROR&&!0===Kt&&(G=W.Z_OK,Kt=!1),G!==W.Z_STREAM_END&&G!==W.Z_OK)return this.onEnd(G),!(this.ended=!0);at.next_out&&(0!==at.avail_out&&G!==W.Z_STREAM_END&&(0!==at.avail_in||de!==W.Z_FINISH&&de!==W.Z_SYNC_FLUSH)||("string"===this.options.to?(we=V.utf8border(at.output,at.next_out),Fe=at.next_out-we,Le=V.buf2string(at.output,we),at.next_out=Fe,at.avail_out=Dt-Fe,Fe&&z.arraySet(at.output,at.output,we,Fe,0),this.onData(Le)):this.onData(z.shrinkBuf(at.output,at.next_out)))),0===at.avail_in&&0===at.avail_out&&(Kt=!0)}while((0<at.avail_in||0===at.avail_out)&&G!==W.Z_STREAM_END);return G===W.Z_STREAM_END&&(de=W.Z_FINISH),de===W.Z_FINISH?(G=H.inflateEnd(this.strm),this.onEnd(G),this.ended=!0,G===W.Z_OK):de!==W.Z_SYNC_FLUSH||(this.onEnd(W.Z_OK),!(at.avail_out=0))},ae.prototype.onData=function(Ae){this.chunks.push(Ae)},ae.prototype.onEnd=function(Ae){Ae===W.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):z.flattenChunks(this.chunks)),this.chunks=[],this.err=Ae,this.msg=this.strm.msg},F.Inflate=ae,F.inflate=Te,F.inflateRaw=function(Ae,me){return(me=me||{}).raw=!0,Te(Ae,me)},F.ungzip=Te},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(b,D,F){"use strict";var H="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;F.assign=function(W){for(var te=Array.prototype.slice.call(arguments,1);te.length;){var Q=te.shift();if(Q){if("object"!=typeof Q)throw new TypeError(Q+"must be non-object");for(var he in Q)Q.hasOwnProperty(he)&&(W[he]=Q[he])}}return W},F.shrinkBuf=function(W,te){return W.length===te?W:W.subarray?W.subarray(0,te):(W.length=te,W)};var z={arraySet:function(W,te,Q,he,be){if(te.subarray&&W.subarray)W.set(te.subarray(Q,Q+he),be);else for(var ae=0;ae<he;ae++)W[be+ae]=te[Q+ae]},flattenChunks:function(W){var te,Q,he,be,ae,Te;for(te=he=0,Q=W.length;te<Q;te++)he+=W[te].length;for(Te=new Uint8Array(he),te=be=0,Q=W.length;te<Q;te++)Te.set(ae=W[te],be),be+=ae.length;return Te}},V={arraySet:function(W,te,Q,he,be){for(var ae=0;ae<he;ae++)W[be+ae]=te[Q+ae]},flattenChunks:function(W){return[].concat.apply([],W)}};F.setTyped=function(W){W?(F.Buf8=Uint8Array,F.Buf16=Uint16Array,F.Buf32=Int32Array,F.assign(F,z)):(F.Buf8=Array,F.Buf16=Array,F.Buf32=Array,F.assign(F,V))},F.setTyped(H)},{}],42:[function(b,D,F){"use strict";var H=b("./common"),z=!0,V=!0;try{String.fromCharCode.apply(null,[0])}catch(he){z=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(he){V=!1}for(var W=new H.Buf8(256),te=0;te<256;te++)W[te]=252<=te?6:248<=te?5:240<=te?4:224<=te?3:192<=te?2:1;function Q(he,be){if(be<65537&&(he.subarray&&V||!he.subarray&&z))return String.fromCharCode.apply(null,H.shrinkBuf(he,be));for(var ae="",Te=0;Te<be;Te++)ae+=String.fromCharCode(he[Te]);return ae}W[254]=W[254]=1,F.string2buf=function(he){var be,ae,Te,Ae,me,G=he.length,de=0;for(Ae=0;Ae<G;Ae++)55296==(64512&(ae=he.charCodeAt(Ae)))&&Ae+1<G&&56320==(64512&(Te=he.charCodeAt(Ae+1)))&&(ae=65536+(ae-55296<<10)+(Te-56320),Ae++),de+=ae<128?1:ae<2048?2:ae<65536?3:4;for(be=new H.Buf8(de),Ae=me=0;me<de;Ae++)55296==(64512&(ae=he.charCodeAt(Ae)))&&Ae+1<G&&56320==(64512&(Te=he.charCodeAt(Ae+1)))&&(ae=65536+(ae-55296<<10)+(Te-56320),Ae++),ae<128?be[me++]=ae:(ae<2048?be[me++]=192|ae>>>6:(ae<65536?be[me++]=224|ae>>>12:(be[me++]=240|ae>>>18,be[me++]=128|ae>>>12&63),be[me++]=128|ae>>>6&63),be[me++]=128|63&ae);return be},F.buf2binstring=function(he){return Q(he,he.length)},F.binstring2buf=function(he){for(var be=new H.Buf8(he.length),ae=0,Te=be.length;ae<Te;ae++)be[ae]=he.charCodeAt(ae);return be},F.buf2string=function(he,be){var ae,Te,Ae,me,G=be||he.length,de=new Array(2*G);for(ae=Te=0;ae<G;)if((Ae=he[ae++])<128)de[Te++]=Ae;else if(4<(me=W[Ae]))de[Te++]=65533,ae+=me-1;else{for(Ae&=2===me?31:3===me?15:7;1<me&&ae<G;)Ae=Ae<<6|63&he[ae++],me--;1<me?de[Te++]=65533:Ae<65536?de[Te++]=Ae:(de[Te++]=55296|(Ae-=65536)>>10&1023,de[Te++]=56320|1023&Ae)}return Q(de,Te)},F.utf8border=function(he,be){var ae;for((be=be||he.length)>he.length&&(be=he.length),ae=be-1;0<=ae&&128==(192&he[ae]);)ae--;return ae<0||0===ae?be:ae+W[he[ae]]>be?ae:be}},{"./common":41}],43:[function(b,D,F){"use strict";D.exports=function(H,z,V,W){for(var te=65535&H|0,Q=H>>>16&65535|0,he=0;0!==V;){for(V-=he=2e3<V?2e3:V;Q=Q+(te=te+z[W++]|0)|0,--he;);te%=65521,Q%=65521}return te|Q<<16|0}},{}],44:[function(b,D,F){"use strict";D.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(b,D,F){"use strict";var H=function(){for(var z,V=[],W=0;W<256;W++){z=W;for(var te=0;te<8;te++)z=1&z?3988292384^z>>>1:z>>>1;V[W]=z}return V}();D.exports=function(z,V,W,te){var Q=H,he=te+W;z^=-1;for(var be=te;be<he;be++)z=z>>>8^Q[255&(z^V[be])];return-1^z}},{}],46:[function(b,D,F){"use strict";var H,z=b("../utils/common"),V=b("./trees"),W=b("./adler32"),te=b("./crc32"),Q=b("./messages"),Kt=258,oi=262;function Ei(O,Me){return O.msg=Q[Me],Me}function Rt(O){return(O<<1)-(4<O?9:0)}function On(O){for(var Me=O.length;0<=--Me;)O[Me]=0}function Ct(O){var Me=O.state,Ke=Me.pending;Ke>O.avail_out&&(Ke=O.avail_out),0!==Ke&&(z.arraySet(O.output,Me.pending_buf,Me.pending_out,Ke,O.next_out),O.next_out+=Ke,Me.pending_out+=Ke,O.total_out+=Ke,O.avail_out-=Ke,Me.pending-=Ke,0===Me.pending&&(Me.pending_out=0))}function ft(O,Me){V._tr_flush_block(O,0<=O.block_start?O.block_start:-1,O.strstart-O.block_start,Me),O.block_start=O.strstart,Ct(O.strm)}function bn(O,Me){O.pending_buf[O.pending++]=Me}function qi(O,Me){O.pending_buf[O.pending++]=Me>>>8&255,O.pending_buf[O.pending++]=255&Me}function Fi(O,Me){var Ke,ke,Ee=O.max_chain_length,ut=O.strstart,Tt=O.prev_length,$t=O.nice_match,wt=O.strstart>O.w_size-oi?O.strstart-(O.w_size-oi):0,ri=O.window,di=O.w_mask,fi=O.prev,Hi=O.strstart+Kt,_r=ri[ut+Tt-1],rr=ri[ut+Tt];O.prev_length>=O.good_match&&(Ee>>=2),$t>O.lookahead&&($t=O.lookahead);do{if(ri[(Ke=Me)+Tt]===rr&&ri[Ke+Tt-1]===_r&&ri[Ke]===ri[ut]&&ri[++Ke]===ri[ut+1]){ut+=2,Ke++;do{}while(ri[++ut]===ri[++Ke]&&ri[++ut]===ri[++Ke]&&ri[++ut]===ri[++Ke]&&ri[++ut]===ri[++Ke]&&ri[++ut]===ri[++Ke]&&ri[++ut]===ri[++Ke]&&ri[++ut]===ri[++Ke]&&ri[++ut]===ri[++Ke]&&ut<Hi);if(ke=Kt-(Hi-ut),ut=Hi-Kt,Tt<ke){if(O.match_start=Me,$t<=(Tt=ke))break;_r=ri[ut+Tt-1],rr=ri[ut+Tt]}}}while((Me=fi[Me&di])>wt&&0!=--Ee);return Tt<=O.lookahead?Tt:O.lookahead}function cr(O){var Me,Ke,ke,Ee,ut,Tt,$t,wt,ri,di,fi=O.w_size;do{if(Ee=O.window_size-O.lookahead-O.strstart,O.strstart>=fi+(fi-oi)){for(z.arraySet(O.window,O.window,fi,fi,0),O.match_start-=fi,O.strstart-=fi,O.block_start-=fi,Me=Ke=O.hash_size;ke=O.head[--Me],O.head[Me]=fi<=ke?ke-fi:0,--Ke;);for(Me=Ke=fi;ke=O.prev[--Me],O.prev[Me]=fi<=ke?ke-fi:0,--Ke;);Ee+=fi}if(0===O.strm.avail_in)break;if($t=O.window,wt=O.strstart+O.lookahead,di=void 0,(ri=Ee)<(di=(Tt=O.strm).avail_in)&&(di=ri),Ke=0===di?0:(Tt.avail_in-=di,z.arraySet($t,Tt.input,Tt.next_in,di,wt),1===Tt.state.wrap?Tt.adler=W(Tt.adler,$t,di,wt):2===Tt.state.wrap&&(Tt.adler=te(Tt.adler,$t,di,wt)),Tt.next_in+=di,Tt.total_in+=di,di),O.lookahead+=Ke,O.lookahead+O.insert>=3)for(O.ins_h=O.window[ut=O.strstart-O.insert],O.ins_h=(O.ins_h<<O.hash_shift^O.window[ut+1])&O.hash_mask;O.insert&&(O.ins_h=(O.ins_h<<O.hash_shift^O.window[ut+3-1])&O.hash_mask,O.prev[ut&O.w_mask]=O.head[O.ins_h],O.head[O.ins_h]=ut,ut++,O.insert--,!(O.lookahead+O.insert<3)););}while(O.lookahead<oi&&0!==O.strm.avail_in)}function ii(O,Me){for(var Ke,ke;;){if(O.lookahead<oi){if(cr(O),O.lookahead<oi&&0===Me)return 1;if(0===O.lookahead)break}if(Ke=0,O.lookahead>=3&&(O.ins_h=(O.ins_h<<O.hash_shift^O.window[O.strstart+3-1])&O.hash_mask,Ke=O.prev[O.strstart&O.w_mask]=O.head[O.ins_h],O.head[O.ins_h]=O.strstart),0!==Ke&&O.strstart-Ke<=O.w_size-oi&&(O.match_length=Fi(O,Ke)),O.match_length>=3)if(ke=V._tr_tally(O,O.strstart-O.match_start,O.match_length-3),O.lookahead-=O.match_length,O.match_length<=O.max_lazy_match&&O.lookahead>=3){for(O.match_length--;O.strstart++,O.ins_h=(O.ins_h<<O.hash_shift^O.window[O.strstart+3-1])&O.hash_mask,Ke=O.prev[O.strstart&O.w_mask]=O.head[O.ins_h],O.head[O.ins_h]=O.strstart,0!=--O.match_length;);O.strstart++}else O.strstart+=O.match_length,O.match_length=0,O.ins_h=O.window[O.strstart],O.ins_h=(O.ins_h<<O.hash_shift^O.window[O.strstart+1])&O.hash_mask;else ke=V._tr_tally(O,0,O.window[O.strstart]),O.lookahead--,O.strstart++;if(ke&&(ft(O,!1),0===O.strm.avail_out))return 1}return O.insert=O.strstart<2?O.strstart:2,4===Me?(ft(O,!0),0===O.strm.avail_out?3:4):O.last_lit&&(ft(O,!1),0===O.strm.avail_out)?1:2}function mr(O,Me){for(var Ke,ke,Ee;;){if(O.lookahead<oi){if(cr(O),O.lookahead<oi&&0===Me)return 1;if(0===O.lookahead)break}if(Ke=0,O.lookahead>=3&&(O.ins_h=(O.ins_h<<O.hash_shift^O.window[O.strstart+3-1])&O.hash_mask,Ke=O.prev[O.strstart&O.w_mask]=O.head[O.ins_h],O.head[O.ins_h]=O.strstart),O.prev_length=O.match_length,O.prev_match=O.match_start,O.match_length=2,0!==Ke&&O.prev_length<O.max_lazy_match&&O.strstart-Ke<=O.w_size-oi&&(O.match_length=Fi(O,Ke),O.match_length<=5&&(1===O.strategy||3===O.match_length&&4096<O.strstart-O.match_start)&&(O.match_length=2)),O.prev_length>=3&&O.match_length<=O.prev_length){for(Ee=O.strstart+O.lookahead-3,ke=V._tr_tally(O,O.strstart-1-O.prev_match,O.prev_length-3),O.lookahead-=O.prev_length-1,O.prev_length-=2;++O.strstart<=Ee&&(O.ins_h=(O.ins_h<<O.hash_shift^O.window[O.strstart+3-1])&O.hash_mask,Ke=O.prev[O.strstart&O.w_mask]=O.head[O.ins_h],O.head[O.ins_h]=O.strstart),0!=--O.prev_length;);if(O.match_available=0,O.match_length=2,O.strstart++,ke&&(ft(O,!1),0===O.strm.avail_out))return 1}else if(O.match_available){if((ke=V._tr_tally(O,0,O.window[O.strstart-1]))&&ft(O,!1),O.strstart++,O.lookahead--,0===O.strm.avail_out)return 1}else O.match_available=1,O.strstart++,O.lookahead--}return O.match_available&&(ke=V._tr_tally(O,0,O.window[O.strstart-1]),O.match_available=0),O.insert=O.strstart<2?O.strstart:2,4===Me?(ft(O,!0),0===O.strm.avail_out?3:4):O.last_lit&&(ft(O,!1),0===O.strm.avail_out)?1:2}function zr(O,Me,Ke,ke,Ee){this.good_length=O,this.max_lazy=Me,this.nice_length=Ke,this.max_chain=ke,this.func=Ee}function gr(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new z.Buf16(1146),this.dyn_dtree=new z.Buf16(122),this.bl_tree=new z.Buf16(78),On(this.dyn_ltree),On(this.dyn_dtree),On(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new z.Buf16(16),this.heap=new z.Buf16(573),On(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new z.Buf16(573),On(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function qn(O){var Me;return O&&O.state?(O.total_in=O.total_out=0,O.data_type=2,(Me=O.state).pending=0,Me.pending_out=0,Me.wrap<0&&(Me.wrap=-Me.wrap),Me.status=Me.wrap?42:113,O.adler=2===Me.wrap?0:1,Me.last_flush=0,V._tr_init(Me),0):Ei(O,-2)}function za(O){var Ke,Me=qn(O);return 0===Me&&((Ke=O.state).window_size=2*Ke.w_size,On(Ke.head),Ke.max_lazy_match=H[Ke.level].max_lazy,Ke.good_match=H[Ke.level].good_length,Ke.nice_match=H[Ke.level].nice_length,Ke.max_chain_length=H[Ke.level].max_chain,Ke.strstart=0,Ke.block_start=0,Ke.lookahead=0,Ke.insert=0,Ke.match_length=Ke.prev_length=2,Ke.match_available=0,Ke.ins_h=0),Me}function Ui(O,Me,Ke,ke,Ee,ut){if(!O)return-2;var Tt=1;if(-1===Me&&(Me=6),ke<0?(Tt=0,ke=-ke):15<ke&&(Tt=2,ke-=16),Ee<1||9<Ee||8!==Ke||ke<8||15<ke||Me<0||9<Me||ut<0||4<ut)return Ei(O,-2);8===ke&&(ke=9);var $t=new gr;return(O.state=$t).strm=O,$t.wrap=Tt,$t.gzhead=null,$t.w_bits=ke,$t.w_size=1<<$t.w_bits,$t.w_mask=$t.w_size-1,$t.hash_bits=Ee+7,$t.hash_size=1<<$t.hash_bits,$t.hash_mask=$t.hash_size-1,$t.hash_shift=~~(($t.hash_bits+3-1)/3),$t.window=new z.Buf8(2*$t.w_size),$t.head=new z.Buf16($t.hash_size),$t.prev=new z.Buf16($t.w_size),$t.lit_bufsize=1<<Ee+6,$t.pending_buf_size=4*$t.lit_bufsize,$t.pending_buf=new z.Buf8($t.pending_buf_size),$t.d_buf=1*$t.lit_bufsize,$t.l_buf=3*$t.lit_bufsize,$t.level=Me,$t.strategy=ut,$t.method=Ke,za(O)}H=[new zr(0,0,0,0,function(O,Me){var Ke=65535;for(Ke>O.pending_buf_size-5&&(Ke=O.pending_buf_size-5);;){if(O.lookahead<=1){if(cr(O),0===O.lookahead&&0===Me)return 1;if(0===O.lookahead)break}O.strstart+=O.lookahead,O.lookahead=0;var ke=O.block_start+Ke;if((0===O.strstart||O.strstart>=ke)&&(O.lookahead=O.strstart-ke,O.strstart=ke,ft(O,!1),0===O.strm.avail_out)||O.strstart-O.block_start>=O.w_size-oi&&(ft(O,!1),0===O.strm.avail_out))return 1}return O.insert=0,4===Me?(ft(O,!0),0===O.strm.avail_out?3:4):(O.strstart>O.block_start&&ft(O,!1),1)}),new zr(4,4,8,4,ii),new zr(4,5,16,8,ii),new zr(4,6,32,32,ii),new zr(4,4,16,16,mr),new zr(8,16,32,32,mr),new zr(8,16,128,128,mr),new zr(8,32,128,256,mr),new zr(32,128,258,1024,mr),new zr(32,258,258,4096,mr)],F.deflateInit=function(O,Me){return Ui(O,Me,8,15,8,0)},F.deflateInit2=Ui,F.deflateReset=za,F.deflateResetKeep=qn,F.deflateSetHeader=function(O,Me){return O&&O.state?2!==O.state.wrap?-2:(O.state.gzhead=Me,0):-2},F.deflate=function(O,Me){var Ke,ke,Ee,ut;if(!O||!O.state||5<Me||Me<0)return O?Ei(O,-2):-2;if(ke=O.state,!O.output||!O.input&&0!==O.avail_in||666===ke.status&&4!==Me)return Ei(O,0===O.avail_out?-5:-2);if(ke.strm=O,Ke=ke.last_flush,ke.last_flush=Me,42===ke.status)if(2===ke.wrap)O.adler=0,bn(ke,31),bn(ke,139),bn(ke,8),ke.gzhead?(bn(ke,(ke.gzhead.text?1:0)+(ke.gzhead.hcrc?2:0)+(ke.gzhead.extra?4:0)+(ke.gzhead.name?8:0)+(ke.gzhead.comment?16:0)),bn(ke,255&ke.gzhead.time),bn(ke,ke.gzhead.time>>8&255),bn(ke,ke.gzhead.time>>16&255),bn(ke,ke.gzhead.time>>24&255),bn(ke,9===ke.level?2:2<=ke.strategy||ke.level<2?4:0),bn(ke,255&ke.gzhead.os),ke.gzhead.extra&&ke.gzhead.extra.length&&(bn(ke,255&ke.gzhead.extra.length),bn(ke,ke.gzhead.extra.length>>8&255)),ke.gzhead.hcrc&&(O.adler=te(O.adler,ke.pending_buf,ke.pending,0)),ke.gzindex=0,ke.status=69):(bn(ke,0),bn(ke,0),bn(ke,0),bn(ke,0),bn(ke,0),bn(ke,9===ke.level?2:2<=ke.strategy||ke.level<2?4:0),bn(ke,3),ke.status=113);else{var Tt=8+(ke.w_bits-8<<4)<<8;Tt|=(2<=ke.strategy||ke.level<2?0:ke.level<6?1:6===ke.level?2:3)<<6,0!==ke.strstart&&(Tt|=32),Tt+=31-Tt%31,ke.status=113,qi(ke,Tt),0!==ke.strstart&&(qi(ke,O.adler>>>16),qi(ke,65535&O.adler)),O.adler=1}if(69===ke.status)if(ke.gzhead.extra){for(Ee=ke.pending;ke.gzindex<(65535&ke.gzhead.extra.length)&&(ke.pending!==ke.pending_buf_size||(ke.gzhead.hcrc&&ke.pending>Ee&&(O.adler=te(O.adler,ke.pending_buf,ke.pending-Ee,Ee)),Ct(O),Ee=ke.pending,ke.pending!==ke.pending_buf_size));)bn(ke,255&ke.gzhead.extra[ke.gzindex]),ke.gzindex++;ke.gzhead.hcrc&&ke.pending>Ee&&(O.adler=te(O.adler,ke.pending_buf,ke.pending-Ee,Ee)),ke.gzindex===ke.gzhead.extra.length&&(ke.gzindex=0,ke.status=73)}else ke.status=73;if(73===ke.status)if(ke.gzhead.name){Ee=ke.pending;do{if(ke.pending===ke.pending_buf_size&&(ke.gzhead.hcrc&&ke.pending>Ee&&(O.adler=te(O.adler,ke.pending_buf,ke.pending-Ee,Ee)),Ct(O),Ee=ke.pending,ke.pending===ke.pending_buf_size)){ut=1;break}ut=ke.gzindex<ke.gzhead.name.length?255&ke.gzhead.name.charCodeAt(ke.gzindex++):0,bn(ke,ut)}while(0!==ut);ke.gzhead.hcrc&&ke.pending>Ee&&(O.adler=te(O.adler,ke.pending_buf,ke.pending-Ee,Ee)),0===ut&&(ke.gzindex=0,ke.status=91)}else ke.status=91;if(91===ke.status)if(ke.gzhead.comment){Ee=ke.pending;do{if(ke.pending===ke.pending_buf_size&&(ke.gzhead.hcrc&&ke.pending>Ee&&(O.adler=te(O.adler,ke.pending_buf,ke.pending-Ee,Ee)),Ct(O),Ee=ke.pending,ke.pending===ke.pending_buf_size)){ut=1;break}ut=ke.gzindex<ke.gzhead.comment.length?255&ke.gzhead.comment.charCodeAt(ke.gzindex++):0,bn(ke,ut)}while(0!==ut);ke.gzhead.hcrc&&ke.pending>Ee&&(O.adler=te(O.adler,ke.pending_buf,ke.pending-Ee,Ee)),0===ut&&(ke.status=103)}else ke.status=103;if(103===ke.status&&(ke.gzhead.hcrc?(ke.pending+2>ke.pending_buf_size&&Ct(O),ke.pending+2<=ke.pending_buf_size&&(bn(ke,255&O.adler),bn(ke,O.adler>>8&255),O.adler=0,ke.status=113)):ke.status=113),0!==ke.pending){if(Ct(O),0===O.avail_out)return ke.last_flush=-1,0}else if(0===O.avail_in&&Rt(Me)<=Rt(Ke)&&4!==Me)return Ei(O,-5);if(666===ke.status&&0!==O.avail_in)return Ei(O,-5);if(0!==O.avail_in||0!==ke.lookahead||0!==Me&&666!==ke.status){var $t=2===ke.strategy?function(wt,ri){for(var di;;){if(0===wt.lookahead&&(cr(wt),0===wt.lookahead)){if(0===ri)return 1;break}if(wt.match_length=0,di=V._tr_tally(wt,0,wt.window[wt.strstart]),wt.lookahead--,wt.strstart++,di&&(ft(wt,!1),0===wt.strm.avail_out))return 1}return wt.insert=0,4===ri?(ft(wt,!0),0===wt.strm.avail_out?3:4):wt.last_lit&&(ft(wt,!1),0===wt.strm.avail_out)?1:2}(ke,Me):3===ke.strategy?function(wt,ri){for(var di,fi,Hi,_r,rr=wt.window;;){if(wt.lookahead<=Kt){if(cr(wt),wt.lookahead<=Kt&&0===ri)return 1;if(0===wt.lookahead)break}if(wt.match_length=0,wt.lookahead>=3&&0<wt.strstart&&(fi=rr[Hi=wt.strstart-1])===rr[++Hi]&&fi===rr[++Hi]&&fi===rr[++Hi]){_r=wt.strstart+Kt;do{}while(fi===rr[++Hi]&&fi===rr[++Hi]&&fi===rr[++Hi]&&fi===rr[++Hi]&&fi===rr[++Hi]&&fi===rr[++Hi]&&fi===rr[++Hi]&&fi===rr[++Hi]&&Hi<_r);wt.match_length=Kt-(_r-Hi),wt.match_length>wt.lookahead&&(wt.match_length=wt.lookahead)}if(wt.match_length>=3?(di=V._tr_tally(wt,1,wt.match_length-3),wt.lookahead-=wt.match_length,wt.strstart+=wt.match_length,wt.match_length=0):(di=V._tr_tally(wt,0,wt.window[wt.strstart]),wt.lookahead--,wt.strstart++),di&&(ft(wt,!1),0===wt.strm.avail_out))return 1}return wt.insert=0,4===ri?(ft(wt,!0),0===wt.strm.avail_out?3:4):wt.last_lit&&(ft(wt,!1),0===wt.strm.avail_out)?1:2}(ke,Me):H[ke.level].func(ke,Me);if(3!==$t&&4!==$t||(ke.status=666),1===$t||3===$t)return 0===O.avail_out&&(ke.last_flush=-1),0;if(2===$t&&(1===Me?V._tr_align(ke):5!==Me&&(V._tr_stored_block(ke,0,0,!1),3===Me&&(On(ke.head),0===ke.lookahead&&(ke.strstart=0,ke.block_start=0,ke.insert=0))),Ct(O),0===O.avail_out))return ke.last_flush=-1,0}return 4!==Me?0:ke.wrap<=0?1:(2===ke.wrap?(bn(ke,255&O.adler),bn(ke,O.adler>>8&255),bn(ke,O.adler>>16&255),bn(ke,O.adler>>24&255),bn(ke,255&O.total_in),bn(ke,O.total_in>>8&255),bn(ke,O.total_in>>16&255),bn(ke,O.total_in>>24&255)):(qi(ke,O.adler>>>16),qi(ke,65535&O.adler)),Ct(O),0<ke.wrap&&(ke.wrap=-ke.wrap),0!==ke.pending?0:1)},F.deflateEnd=function(O){var Me;return O&&O.state?42!==(Me=O.state.status)&&69!==Me&&73!==Me&&91!==Me&&103!==Me&&113!==Me&&666!==Me?Ei(O,-2):(O.state=null,113===Me?Ei(O,-3):0):-2},F.deflateSetDictionary=function(O,Me){var Ke,ke,Ee,ut,Tt,$t,wt,ri,di=Me.length;if(!O||!O.state||2===(ut=(Ke=O.state).wrap)||1===ut&&42!==Ke.status||Ke.lookahead)return-2;for(1===ut&&(O.adler=W(O.adler,Me,di,0)),Ke.wrap=0,di>=Ke.w_size&&(0===ut&&(On(Ke.head),Ke.strstart=0,Ke.block_start=0,Ke.insert=0),ri=new z.Buf8(Ke.w_size),z.arraySet(ri,Me,di-Ke.w_size,Ke.w_size,0),Me=ri,di=Ke.w_size),Tt=O.avail_in,$t=O.next_in,wt=O.input,O.avail_in=di,O.next_in=0,O.input=Me,cr(Ke);Ke.lookahead>=3;){for(ke=Ke.strstart,Ee=Ke.lookahead-2;Ke.ins_h=(Ke.ins_h<<Ke.hash_shift^Ke.window[ke+3-1])&Ke.hash_mask,Ke.prev[ke&Ke.w_mask]=Ke.head[Ke.ins_h],Ke.head[Ke.ins_h]=ke,ke++,--Ee;);Ke.strstart=ke,Ke.lookahead=2,cr(Ke)}return Ke.strstart+=Ke.lookahead,Ke.block_start=Ke.strstart,Ke.insert=Ke.lookahead,Ke.lookahead=0,Ke.match_length=Ke.prev_length=2,Ke.match_available=0,O.next_in=$t,O.input=wt,O.avail_in=Tt,Ke.wrap=ut,0},F.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(b,D,F){"use strict";D.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(b,D,F){"use strict";D.exports=function(H,z){var V,W,te,Q,he,be,ae,Te,Ae,me,G,de,we,Fe,Le,it,at,Dt,dt,Kt,oi,We,xt,_e,Lt;_e=H.input,te=(W=H.next_in)+(H.avail_in-5),Lt=H.output,he=(Q=H.next_out)-(z-H.avail_out),be=Q+(H.avail_out-257),ae=(V=H.state).dmax,Te=V.wsize,Ae=V.whave,me=V.wnext,G=V.window,de=V.hold,we=V.bits,Fe=V.lencode,Le=V.distcode,it=(1<<V.lenbits)-1,at=(1<<V.distbits)-1;e:do{we<15&&(de+=_e[W++]<<we,de+=_e[W++]<<(we+=8),we+=8),Dt=Fe[de&it];t:for(;;){if(de>>>=dt=Dt>>>24,we-=dt,0==(dt=Dt>>>16&255))Lt[Q++]=65535&Dt;else{if(!(16&dt)){if(0==(64&dt)){Dt=Fe[(65535&Dt)+(de&(1<<dt)-1)];continue t}if(32&dt){V.mode=12;break e}H.msg="invalid literal/length code",V.mode=30;break e}Kt=65535&Dt,(dt&=15)&&(we<dt&&(de+=_e[W++]<<we,we+=8),Kt+=de&(1<<dt)-1,de>>>=dt,we-=dt),we<15&&(de+=_e[W++]<<we,de+=_e[W++]<<(we+=8),we+=8),Dt=Le[de&at];i:for(;;){if(de>>>=dt=Dt>>>24,we-=dt,!(16&(dt=Dt>>>16&255))){if(0==(64&dt)){Dt=Le[(65535&Dt)+(de&(1<<dt)-1)];continue i}H.msg="invalid distance code",V.mode=30;break e}if(oi=65535&Dt,we<(dt&=15)&&(de+=_e[W++]<<we,(we+=8)<dt&&(de+=_e[W++]<<we,we+=8)),ae<(oi+=de&(1<<dt)-1)){H.msg="invalid distance too far back",V.mode=30;break e}if(de>>>=dt,we-=dt,(dt=Q-he)<oi){if(Ae<(dt=oi-dt)&&V.sane){H.msg="invalid distance too far back",V.mode=30;break e}if(xt=G,(We=0)===me){if(We+=Te-dt,dt<Kt){for(Kt-=dt;Lt[Q++]=G[We++],--dt;);We=Q-oi,xt=Lt}}else if(me<dt){if(We+=Te+me-dt,(dt-=me)<Kt){for(Kt-=dt;Lt[Q++]=G[We++],--dt;);if(We=0,me<Kt){for(Kt-=dt=me;Lt[Q++]=G[We++],--dt;);We=Q-oi,xt=Lt}}}else if(We+=me-dt,dt<Kt){for(Kt-=dt;Lt[Q++]=G[We++],--dt;);We=Q-oi,xt=Lt}for(;2<Kt;)Lt[Q++]=xt[We++],Lt[Q++]=xt[We++],Lt[Q++]=xt[We++],Kt-=3;Kt&&(Lt[Q++]=xt[We++],1<Kt&&(Lt[Q++]=xt[We++]))}else{for(We=Q-oi;Lt[Q++]=Lt[We++],Lt[Q++]=Lt[We++],Lt[Q++]=Lt[We++],2<(Kt-=3););Kt&&(Lt[Q++]=Lt[We++],1<Kt&&(Lt[Q++]=Lt[We++]))}break}}break}}while(W<te&&Q<be);W-=Kt=we>>3,de&=(1<<(we-=Kt<<3))-1,H.next_in=W,H.next_out=Q,H.avail_in=W<te?te-W+5:5-(W-te),H.avail_out=Q<be?be-Q+257:257-(Q-be),V.hold=de,V.bits=we}},{}],49:[function(b,D,F){"use strict";var H=b("../utils/common"),z=b("./adler32"),V=b("./crc32"),W=b("./inffast"),te=b("./inftrees");function G(We){return(We>>>24&255)+(We>>>8&65280)+((65280&We)<<8)+((255&We)<<24)}function de(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new H.Buf16(320),this.work=new H.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function we(We){var xt;return We&&We.state?(We.total_in=We.total_out=(xt=We.state).total=0,We.msg="",xt.wrap&&(We.adler=1&xt.wrap),xt.mode=1,xt.last=0,xt.havedict=0,xt.dmax=32768,xt.head=null,xt.hold=0,xt.bits=0,xt.lencode=xt.lendyn=new H.Buf32(852),xt.distcode=xt.distdyn=new H.Buf32(592),xt.sane=1,xt.back=-1,0):-2}function Fe(We){var xt;return We&&We.state?((xt=We.state).wsize=0,xt.whave=0,xt.wnext=0,we(We)):-2}function Le(We,xt){var _e,Lt;return We&&We.state?(Lt=We.state,xt<0?(_e=0,xt=-xt):(_e=1+(xt>>4),xt<48&&(xt&=15)),xt&&(xt<8||15<xt)?-2:(null!==Lt.window&&Lt.wbits!==xt&&(Lt.window=null),Lt.wrap=_e,Lt.wbits=xt,Fe(We))):-2}function it(We,xt){var _e,Lt;return We?(Lt=new de,(We.state=Lt).window=null,0!==(_e=Le(We,xt))&&(We.state=null),_e):-2}var at,Dt,dt=!0;function Kt(We){if(dt){var xt;for(at=new H.Buf32(512),Dt=new H.Buf32(32),xt=0;xt<144;)We.lens[xt++]=8;for(;xt<256;)We.lens[xt++]=9;for(;xt<280;)We.lens[xt++]=7;for(;xt<288;)We.lens[xt++]=8;for(te(1,We.lens,0,288,at,0,We.work,{bits:9}),xt=0;xt<32;)We.lens[xt++]=5;te(2,We.lens,0,32,Dt,0,We.work,{bits:5}),dt=!1}We.lencode=at,We.lenbits=9,We.distcode=Dt,We.distbits=5}function oi(We,xt,_e,Lt){var $i,Wt=We.state;return null===Wt.window&&(Wt.wsize=1<<Wt.wbits,Wt.wnext=0,Wt.whave=0,Wt.window=new H.Buf8(Wt.wsize)),Lt>=Wt.wsize?(H.arraySet(Wt.window,xt,_e-Wt.wsize,Wt.wsize,0),Wt.wnext=0,Wt.whave=Wt.wsize):(Lt<($i=Wt.wsize-Wt.wnext)&&($i=Lt),H.arraySet(Wt.window,xt,_e-Lt,$i,Wt.wnext),(Lt-=$i)?(H.arraySet(Wt.window,xt,_e-Lt,Lt,0),Wt.wnext=Lt,Wt.whave=Wt.wsize):(Wt.wnext+=$i,Wt.wnext===Wt.wsize&&(Wt.wnext=0),Wt.whave<Wt.wsize&&(Wt.whave+=$i))),0}F.inflateReset=Fe,F.inflateReset2=Le,F.inflateResetKeep=we,F.inflateInit=function(We){return it(We,15)},F.inflateInit2=it,F.inflate=function(We,xt){var _e,Lt,$i,Wt,Ei,Rt,On,Ct,ft,bn,qi,Fi,cr,ii,mr,zr,gr,qn,za,Ui,O,Me,Ke,ke,Ee=0,ut=new H.Buf8(4),Tt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!We||!We.state||!We.output||!We.input&&0!==We.avail_in)return-2;12===(_e=We.state).mode&&(_e.mode=13),Ei=We.next_out,$i=We.output,Wt=We.next_in,Lt=We.input,Ct=_e.hold,ft=_e.bits,bn=Rt=We.avail_in,qi=On=We.avail_out,Me=0;e:for(;;)switch(_e.mode){case 1:if(0===_e.wrap){_e.mode=13;break}for(;ft<16;){if(0===Rt)break e;Rt--,Ct+=Lt[Wt++]<<ft,ft+=8}if(2&_e.wrap&&35615===Ct){ut[_e.check=0]=255&Ct,ut[1]=Ct>>>8&255,_e.check=V(_e.check,ut,2,0),ft=Ct=0,_e.mode=2;break}if(_e.flags=0,_e.head&&(_e.head.done=!1),!(1&_e.wrap)||(((255&Ct)<<8)+(Ct>>8))%31){We.msg="incorrect header check",_e.mode=30;break}if(8!=(15&Ct)){We.msg="unknown compression method",_e.mode=30;break}if(ft-=4,O=8+(15&(Ct>>>=4)),0===_e.wbits)_e.wbits=O;else if(O>_e.wbits){We.msg="invalid window size",_e.mode=30;break}_e.dmax=1<<O,We.adler=_e.check=1,_e.mode=512&Ct?10:12,ft=Ct=0;break;case 2:for(;ft<16;){if(0===Rt)break e;Rt--,Ct+=Lt[Wt++]<<ft,ft+=8}if(_e.flags=Ct,8!=(255&_e.flags)){We.msg="unknown compression method",_e.mode=30;break}if(57344&_e.flags){We.msg="unknown header flags set",_e.mode=30;break}_e.head&&(_e.head.text=Ct>>8&1),512&_e.flags&&(ut[0]=255&Ct,ut[1]=Ct>>>8&255,_e.check=V(_e.check,ut,2,0)),ft=Ct=0,_e.mode=3;case 3:for(;ft<32;){if(0===Rt)break e;Rt--,Ct+=Lt[Wt++]<<ft,ft+=8}_e.head&&(_e.head.time=Ct),512&_e.flags&&(ut[0]=255&Ct,ut[1]=Ct>>>8&255,ut[2]=Ct>>>16&255,ut[3]=Ct>>>24&255,_e.check=V(_e.check,ut,4,0)),ft=Ct=0,_e.mode=4;case 4:for(;ft<16;){if(0===Rt)break e;Rt--,Ct+=Lt[Wt++]<<ft,ft+=8}_e.head&&(_e.head.xflags=255&Ct,_e.head.os=Ct>>8),512&_e.flags&&(ut[0]=255&Ct,ut[1]=Ct>>>8&255,_e.check=V(_e.check,ut,2,0)),ft=Ct=0,_e.mode=5;case 5:if(1024&_e.flags){for(;ft<16;){if(0===Rt)break e;Rt--,Ct+=Lt[Wt++]<<ft,ft+=8}_e.length=Ct,_e.head&&(_e.head.extra_len=Ct),512&_e.flags&&(ut[0]=255&Ct,ut[1]=Ct>>>8&255,_e.check=V(_e.check,ut,2,0)),ft=Ct=0}else _e.head&&(_e.head.extra=null);_e.mode=6;case 6:if(1024&_e.flags&&(Rt<(Fi=_e.length)&&(Fi=Rt),Fi&&(_e.head&&(O=_e.head.extra_len-_e.length,_e.head.extra||(_e.head.extra=new Array(_e.head.extra_len)),H.arraySet(_e.head.extra,Lt,Wt,Fi,O)),512&_e.flags&&(_e.check=V(_e.check,Lt,Fi,Wt)),Rt-=Fi,Wt+=Fi,_e.length-=Fi),_e.length))break e;_e.length=0,_e.mode=7;case 7:if(2048&_e.flags){if(0===Rt)break e;for(Fi=0;O=Lt[Wt+Fi++],_e.head&&O&&_e.length<65536&&(_e.head.name+=String.fromCharCode(O)),O&&Fi<Rt;);if(512&_e.flags&&(_e.check=V(_e.check,Lt,Fi,Wt)),Rt-=Fi,Wt+=Fi,O)break e}else _e.head&&(_e.head.name=null);_e.length=0,_e.mode=8;case 8:if(4096&_e.flags){if(0===Rt)break e;for(Fi=0;O=Lt[Wt+Fi++],_e.head&&O&&_e.length<65536&&(_e.head.comment+=String.fromCharCode(O)),O&&Fi<Rt;);if(512&_e.flags&&(_e.check=V(_e.check,Lt,Fi,Wt)),Rt-=Fi,Wt+=Fi,O)break e}else _e.head&&(_e.head.comment=null);_e.mode=9;case 9:if(512&_e.flags){for(;ft<16;){if(0===Rt)break e;Rt--,Ct+=Lt[Wt++]<<ft,ft+=8}if(Ct!==(65535&_e.check)){We.msg="header crc mismatch",_e.mode=30;break}ft=Ct=0}_e.head&&(_e.head.hcrc=_e.flags>>9&1,_e.head.done=!0),We.adler=_e.check=0,_e.mode=12;break;case 10:for(;ft<32;){if(0===Rt)break e;Rt--,Ct+=Lt[Wt++]<<ft,ft+=8}We.adler=_e.check=G(Ct),ft=Ct=0,_e.mode=11;case 11:if(0===_e.havedict)return We.next_out=Ei,We.avail_out=On,We.next_in=Wt,We.avail_in=Rt,_e.hold=Ct,_e.bits=ft,2;We.adler=_e.check=1,_e.mode=12;case 12:if(5===xt||6===xt)break e;case 13:if(_e.last){Ct>>>=7&ft,ft-=7&ft,_e.mode=27;break}for(;ft<3;){if(0===Rt)break e;Rt--,Ct+=Lt[Wt++]<<ft,ft+=8}switch(_e.last=1&Ct,ft-=1,3&(Ct>>>=1)){case 0:_e.mode=14;break;case 1:if(Kt(_e),_e.mode=20,6!==xt)break;Ct>>>=2,ft-=2;break e;case 2:_e.mode=17;break;case 3:We.msg="invalid block type",_e.mode=30}Ct>>>=2,ft-=2;break;case 14:for(Ct>>>=7&ft,ft-=7&ft;ft<32;){if(0===Rt)break e;Rt--,Ct+=Lt[Wt++]<<ft,ft+=8}if((65535&Ct)!=(Ct>>>16^65535)){We.msg="invalid stored block lengths",_e.mode=30;break}if(_e.length=65535&Ct,ft=Ct=0,_e.mode=15,6===xt)break e;case 15:_e.mode=16;case 16:if(Fi=_e.length){if(Rt<Fi&&(Fi=Rt),On<Fi&&(Fi=On),0===Fi)break e;H.arraySet($i,Lt,Wt,Fi,Ei),Rt-=Fi,Wt+=Fi,On-=Fi,Ei+=Fi,_e.length-=Fi;break}_e.mode=12;break;case 17:for(;ft<14;){if(0===Rt)break e;Rt--,Ct+=Lt[Wt++]<<ft,ft+=8}if(_e.nlen=257+(31&Ct),ft-=5,_e.ndist=1+(31&(Ct>>>=5)),ft-=5,_e.ncode=4+(15&(Ct>>>=5)),Ct>>>=4,ft-=4,286<_e.nlen||30<_e.ndist){We.msg="too many length or distance symbols",_e.mode=30;break}_e.have=0,_e.mode=18;case 18:for(;_e.have<_e.ncode;){for(;ft<3;){if(0===Rt)break e;Rt--,Ct+=Lt[Wt++]<<ft,ft+=8}_e.lens[Tt[_e.have++]]=7&Ct,Ct>>>=3,ft-=3}for(;_e.have<19;)_e.lens[Tt[_e.have++]]=0;if(_e.lencode=_e.lendyn,_e.lenbits=7,Me=te(0,_e.lens,0,19,_e.lencode,0,_e.work,Ke={bits:_e.lenbits}),_e.lenbits=Ke.bits,Me){We.msg="invalid code lengths set",_e.mode=30;break}_e.have=0,_e.mode=19;case 19:for(;_e.have<_e.nlen+_e.ndist;){for(;zr=(Ee=_e.lencode[Ct&(1<<_e.lenbits)-1])>>>16&255,gr=65535&Ee,!((mr=Ee>>>24)<=ft);){if(0===Rt)break e;Rt--,Ct+=Lt[Wt++]<<ft,ft+=8}if(gr<16)Ct>>>=mr,ft-=mr,_e.lens[_e.have++]=gr;else{if(16===gr){for(ke=mr+2;ft<ke;){if(0===Rt)break e;Rt--,Ct+=Lt[Wt++]<<ft,ft+=8}if(Ct>>>=mr,ft-=mr,0===_e.have){We.msg="invalid bit length repeat",_e.mode=30;break}O=_e.lens[_e.have-1],Fi=3+(3&Ct),Ct>>>=2,ft-=2}else if(17===gr){for(ke=mr+3;ft<ke;){if(0===Rt)break e;Rt--,Ct+=Lt[Wt++]<<ft,ft+=8}ft-=mr,O=0,Fi=3+(7&(Ct>>>=mr)),Ct>>>=3,ft-=3}else{for(ke=mr+7;ft<ke;){if(0===Rt)break e;Rt--,Ct+=Lt[Wt++]<<ft,ft+=8}ft-=mr,O=0,Fi=11+(127&(Ct>>>=mr)),Ct>>>=7,ft-=7}if(_e.have+Fi>_e.nlen+_e.ndist){We.msg="invalid bit length repeat",_e.mode=30;break}for(;Fi--;)_e.lens[_e.have++]=O}}if(30===_e.mode)break;if(0===_e.lens[256]){We.msg="invalid code -- missing end-of-block",_e.mode=30;break}if(_e.lenbits=9,Me=te(1,_e.lens,0,_e.nlen,_e.lencode,0,_e.work,Ke={bits:_e.lenbits}),_e.lenbits=Ke.bits,Me){We.msg="invalid literal/lengths set",_e.mode=30;break}if(_e.distbits=6,_e.distcode=_e.distdyn,Me=te(2,_e.lens,_e.nlen,_e.ndist,_e.distcode,0,_e.work,Ke={bits:_e.distbits}),_e.distbits=Ke.bits,Me){We.msg="invalid distances set",_e.mode=30;break}if(_e.mode=20,6===xt)break e;case 20:_e.mode=21;case 21:if(6<=Rt&&258<=On){We.next_out=Ei,We.avail_out=On,We.next_in=Wt,We.avail_in=Rt,_e.hold=Ct,_e.bits=ft,W(We,qi),Ei=We.next_out,$i=We.output,On=We.avail_out,Wt=We.next_in,Lt=We.input,Rt=We.avail_in,Ct=_e.hold,ft=_e.bits,12===_e.mode&&(_e.back=-1);break}for(_e.back=0;zr=(Ee=_e.lencode[Ct&(1<<_e.lenbits)-1])>>>16&255,gr=65535&Ee,!((mr=Ee>>>24)<=ft);){if(0===Rt)break e;Rt--,Ct+=Lt[Wt++]<<ft,ft+=8}if(zr&&0==(240&zr)){for(qn=mr,za=zr,Ui=gr;zr=(Ee=_e.lencode[Ui+((Ct&(1<<qn+za)-1)>>qn)])>>>16&255,gr=65535&Ee,!(qn+(mr=Ee>>>24)<=ft);){if(0===Rt)break e;Rt--,Ct+=Lt[Wt++]<<ft,ft+=8}Ct>>>=qn,ft-=qn,_e.back+=qn}if(Ct>>>=mr,ft-=mr,_e.back+=mr,_e.length=gr,0===zr){_e.mode=26;break}if(32&zr){_e.back=-1,_e.mode=12;break}if(64&zr){We.msg="invalid literal/length code",_e.mode=30;break}_e.extra=15&zr,_e.mode=22;case 22:if(_e.extra){for(ke=_e.extra;ft<ke;){if(0===Rt)break e;Rt--,Ct+=Lt[Wt++]<<ft,ft+=8}_e.length+=Ct&(1<<_e.extra)-1,Ct>>>=_e.extra,ft-=_e.extra,_e.back+=_e.extra}_e.was=_e.length,_e.mode=23;case 23:for(;zr=(Ee=_e.distcode[Ct&(1<<_e.distbits)-1])>>>16&255,gr=65535&Ee,!((mr=Ee>>>24)<=ft);){if(0===Rt)break e;Rt--,Ct+=Lt[Wt++]<<ft,ft+=8}if(0==(240&zr)){for(qn=mr,za=zr,Ui=gr;zr=(Ee=_e.distcode[Ui+((Ct&(1<<qn+za)-1)>>qn)])>>>16&255,gr=65535&Ee,!(qn+(mr=Ee>>>24)<=ft);){if(0===Rt)break e;Rt--,Ct+=Lt[Wt++]<<ft,ft+=8}Ct>>>=qn,ft-=qn,_e.back+=qn}if(Ct>>>=mr,ft-=mr,_e.back+=mr,64&zr){We.msg="invalid distance code",_e.mode=30;break}_e.offset=gr,_e.extra=15&zr,_e.mode=24;case 24:if(_e.extra){for(ke=_e.extra;ft<ke;){if(0===Rt)break e;Rt--,Ct+=Lt[Wt++]<<ft,ft+=8}_e.offset+=Ct&(1<<_e.extra)-1,Ct>>>=_e.extra,ft-=_e.extra,_e.back+=_e.extra}if(_e.offset>_e.dmax){We.msg="invalid distance too far back",_e.mode=30;break}_e.mode=25;case 25:if(0===On)break e;if(_e.offset>(Fi=qi-On)){if((Fi=_e.offset-Fi)>_e.whave&&_e.sane){We.msg="invalid distance too far back",_e.mode=30;break}cr=Fi>_e.wnext?_e.wsize-(Fi-=_e.wnext):_e.wnext-Fi,Fi>_e.length&&(Fi=_e.length),ii=_e.window}else ii=$i,cr=Ei-_e.offset,Fi=_e.length;for(On<Fi&&(Fi=On),On-=Fi,_e.length-=Fi;$i[Ei++]=ii[cr++],--Fi;);0===_e.length&&(_e.mode=21);break;case 26:if(0===On)break e;$i[Ei++]=_e.length,On--,_e.mode=21;break;case 27:if(_e.wrap){for(;ft<32;){if(0===Rt)break e;Rt--,Ct|=Lt[Wt++]<<ft,ft+=8}if(We.total_out+=qi-=On,_e.total+=qi,qi&&(We.adler=_e.check=_e.flags?V(_e.check,$i,qi,Ei-qi):z(_e.check,$i,qi,Ei-qi)),qi=On,(_e.flags?Ct:G(Ct))!==_e.check){We.msg="incorrect data check",_e.mode=30;break}ft=Ct=0}_e.mode=28;case 28:if(_e.wrap&&_e.flags){for(;ft<32;){if(0===Rt)break e;Rt--,Ct+=Lt[Wt++]<<ft,ft+=8}if(Ct!==(4294967295&_e.total)){We.msg="incorrect length check",_e.mode=30;break}ft=Ct=0}_e.mode=29;case 29:Me=1;break e;case 30:Me=-3;break e;case 31:return-4;default:return-2}return We.next_out=Ei,We.avail_out=On,We.next_in=Wt,We.avail_in=Rt,_e.hold=Ct,_e.bits=ft,(_e.wsize||qi!==We.avail_out&&_e.mode<30&&(_e.mode<27||4!==xt))&&oi(We,We.output,We.next_out,qi-We.avail_out)?(_e.mode=31,-4):(qi-=We.avail_out,We.total_in+=bn-=We.avail_in,We.total_out+=qi,_e.total+=qi,_e.wrap&&qi&&(We.adler=_e.check=_e.flags?V(_e.check,$i,qi,We.next_out-qi):z(_e.check,$i,qi,We.next_out-qi)),We.data_type=_e.bits+(_e.last?64:0)+(12===_e.mode?128:0)+(20===_e.mode||15===_e.mode?256:0),(0==bn&&0===qi||4===xt)&&0===Me&&(Me=-5),Me)},F.inflateEnd=function(We){if(!We||!We.state)return-2;var xt=We.state;return xt.window&&(xt.window=null),We.state=null,0},F.inflateGetHeader=function(We,xt){var _e;return We&&We.state?0==(2&(_e=We.state).wrap)?-2:((_e.head=xt).done=!1,0):-2},F.inflateSetDictionary=function(We,xt){var _e,Lt=xt.length;return We&&We.state?0!==(_e=We.state).wrap&&11!==_e.mode?-2:11===_e.mode&&z(1,xt,Lt,0)!==_e.check?-3:oi(We,xt,Lt,Lt)?(_e.mode=31,-4):(_e.havedict=1,0):-2},F.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(b,D,F){"use strict";var H=b("../utils/common"),z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],V=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],W=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],te=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];D.exports=function(Q,he,be,ae,Te,Ae,me,G){var de,we,Fe,Le,it,at,Dt,dt,Kt,oi=G.bits,We=0,xt=0,_e=0,Lt=0,$i=0,Wt=0,Ei=0,Rt=0,On=0,Ct=0,ft=null,bn=0,qi=new H.Buf16(16),Fi=new H.Buf16(16),cr=null,ii=0;for(We=0;We<=15;We++)qi[We]=0;for(xt=0;xt<ae;xt++)qi[he[be+xt]]++;for($i=oi,Lt=15;1<=Lt&&0===qi[Lt];Lt--);if(Lt<$i&&($i=Lt),0===Lt)return Te[Ae++]=20971520,Te[Ae++]=20971520,G.bits=1,0;for(_e=1;_e<Lt&&0===qi[_e];_e++);for($i<_e&&($i=_e),We=Rt=1;We<=15;We++)if(Rt<<=1,(Rt-=qi[We])<0)return-1;if(0<Rt&&(0===Q||1!==Lt))return-1;for(Fi[1]=0,We=1;We<15;We++)Fi[We+1]=Fi[We]+qi[We];for(xt=0;xt<ae;xt++)0!==he[be+xt]&&(me[Fi[he[be+xt]]++]=xt);if(at=0===Q?(ft=cr=me,19):1===Q?(ft=z,bn-=257,cr=V,ii-=257,256):(ft=W,cr=te,-1),We=_e,it=Ae,Ei=xt=Ct=0,Fe=-1,Le=(On=1<<(Wt=$i))-1,1===Q&&852<On||2===Q&&592<On)return 1;for(;;){for(Dt=We-Ei,Kt=me[xt]<at?(dt=0,me[xt]):me[xt]>at?(dt=cr[ii+me[xt]],ft[bn+me[xt]]):(dt=96,0),de=1<<We-Ei,_e=we=1<<Wt;Te[it+(Ct>>Ei)+(we-=de)]=Dt<<24|dt<<16|Kt|0,0!==we;);for(de=1<<We-1;Ct&de;)de>>=1;if(0!==de?(Ct&=de-1,Ct+=de):Ct=0,xt++,0==--qi[We]){if(We===Lt)break;We=he[be+me[xt]]}if($i<We&&(Ct&Le)!==Fe){for(0===Ei&&(Ei=$i),it+=_e,Rt=1<<(Wt=We-Ei);Wt+Ei<Lt&&!((Rt-=qi[Wt+Ei])<=0);)Wt++,Rt<<=1;if(On+=1<<Wt,1===Q&&852<On||2===Q&&592<On)return 1;Te[Fe=Ct&Le]=$i<<24|Wt<<16|it-Ae|0}}return 0!==Ct&&(Te[it+Ct]=We-Ei<<24|64<<16|0),G.bits=$i,0}},{"../utils/common":41}],51:[function(b,D,F){"use strict";D.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(b,D,F){"use strict";var H=b("../utils/common");function W(Ee){for(var ut=Ee.length;0<=--ut;)Ee[ut]=0}var at=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Dt=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],dt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Kt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],oi=new Array(576);W(oi);var We=new Array(60);W(We);var xt=new Array(512);W(xt);var _e=new Array(256);W(_e);var Lt=new Array(29);W(Lt);var $i,Wt,Ei,Rt=new Array(30);function On(Ee,ut,Tt,$t,wt){this.static_tree=Ee,this.extra_bits=ut,this.extra_base=Tt,this.elems=$t,this.max_length=wt,this.has_stree=Ee&&Ee.length}function Ct(Ee,ut){this.dyn_tree=Ee,this.max_code=0,this.stat_desc=ut}function ft(Ee){return Ee<256?xt[Ee]:xt[256+(Ee>>>7)]}function bn(Ee,ut){Ee.pending_buf[Ee.pending++]=255&ut,Ee.pending_buf[Ee.pending++]=ut>>>8&255}function qi(Ee,ut,Tt){Ee.bi_valid>16-Tt?(Ee.bi_buf|=ut<<Ee.bi_valid&65535,bn(Ee,Ee.bi_buf),Ee.bi_buf=ut>>16-Ee.bi_valid,Ee.bi_valid+=Tt-16):(Ee.bi_buf|=ut<<Ee.bi_valid&65535,Ee.bi_valid+=Tt)}function Fi(Ee,ut,Tt){qi(Ee,Tt[2*ut],Tt[2*ut+1])}function cr(Ee,ut){for(var Tt=0;Tt|=1&Ee,Ee>>>=1,Tt<<=1,0<--ut;);return Tt>>>1}function ii(Ee,ut,Tt){var $t,wt,ri=new Array(16),di=0;for($t=1;$t<=15;$t++)ri[$t]=di=di+Tt[$t-1]<<1;for(wt=0;wt<=ut;wt++){var fi=Ee[2*wt+1];0!==fi&&(Ee[2*wt]=cr(ri[fi]++,fi))}}function mr(Ee){var ut;for(ut=0;ut<286;ut++)Ee.dyn_ltree[2*ut]=0;for(ut=0;ut<30;ut++)Ee.dyn_dtree[2*ut]=0;for(ut=0;ut<19;ut++)Ee.bl_tree[2*ut]=0;Ee.dyn_ltree[512]=1,Ee.opt_len=Ee.static_len=0,Ee.last_lit=Ee.matches=0}function zr(Ee){8<Ee.bi_valid?bn(Ee,Ee.bi_buf):0<Ee.bi_valid&&(Ee.pending_buf[Ee.pending++]=Ee.bi_buf),Ee.bi_buf=0,Ee.bi_valid=0}function gr(Ee,ut,Tt,$t){var wt=2*ut,ri=2*Tt;return Ee[wt]<Ee[ri]||Ee[wt]===Ee[ri]&&$t[ut]<=$t[Tt]}function qn(Ee,ut,Tt){for(var $t=Ee.heap[Tt],wt=Tt<<1;wt<=Ee.heap_len&&(wt<Ee.heap_len&&gr(ut,Ee.heap[wt+1],Ee.heap[wt],Ee.depth)&&wt++,!gr(ut,$t,Ee.heap[wt],Ee.depth));)Ee.heap[Tt]=Ee.heap[wt],Tt=wt,wt<<=1;Ee.heap[Tt]=$t}function za(Ee,ut,Tt){var $t,wt,ri,di,fi=0;if(0!==Ee.last_lit)for(;$t=Ee.pending_buf[Ee.d_buf+2*fi]<<8|Ee.pending_buf[Ee.d_buf+2*fi+1],wt=Ee.pending_buf[Ee.l_buf+fi],fi++,0===$t?Fi(Ee,wt,ut):(Fi(Ee,(ri=_e[wt])+256+1,ut),0!==(di=at[ri])&&qi(Ee,wt-=Lt[ri],di),Fi(Ee,ri=ft(--$t),Tt),0!==(di=Dt[ri])&&qi(Ee,$t-=Rt[ri],di)),fi<Ee.last_lit;);Fi(Ee,256,ut)}function Ui(Ee,ut){var Tt,$t,wt,ri=ut.dyn_tree,di=ut.stat_desc.static_tree,fi=ut.stat_desc.has_stree,Hi=ut.stat_desc.elems,_r=-1;for(Ee.heap_len=0,Ee.heap_max=573,Tt=0;Tt<Hi;Tt++)0!==ri[2*Tt]?(Ee.heap[++Ee.heap_len]=_r=Tt,Ee.depth[Tt]=0):ri[2*Tt+1]=0;for(;Ee.heap_len<2;)ri[2*(wt=Ee.heap[++Ee.heap_len]=_r<2?++_r:0)]=1,Ee.depth[wt]=0,Ee.opt_len--,fi&&(Ee.static_len-=di[2*wt+1]);for(ut.max_code=_r,Tt=Ee.heap_len>>1;1<=Tt;Tt--)qn(Ee,ri,Tt);for(wt=Hi;Tt=Ee.heap[1],Ee.heap[1]=Ee.heap[Ee.heap_len--],qn(Ee,ri,1),$t=Ee.heap[1],Ee.heap[--Ee.heap_max]=Tt,Ee.heap[--Ee.heap_max]=$t,ri[2*wt]=ri[2*Tt]+ri[2*$t],Ee.depth[wt]=(Ee.depth[Tt]>=Ee.depth[$t]?Ee.depth[Tt]:Ee.depth[$t])+1,ri[2*Tt+1]=ri[2*$t+1]=wt,Ee.heap[1]=wt++,qn(Ee,ri,1),2<=Ee.heap_len;);Ee.heap[--Ee.heap_max]=Ee.heap[1],function(rr,Vo){var Eo,oa,Lo,no,ro,Oc,ve=Vo.dyn_tree,pe=Vo.max_code,st=Vo.stat_desc.static_tree,tt=Vo.stat_desc.has_stree,Ni=Vo.stat_desc.extra_bits,_n=Vo.stat_desc.extra_base,Gi=Vo.stat_desc.max_length,Xi=0;for(no=0;no<=15;no++)rr.bl_count[no]=0;for(ve[2*rr.heap[rr.heap_max]+1]=0,Eo=rr.heap_max+1;Eo<573;Eo++)Gi<(no=ve[2*ve[2*(oa=rr.heap[Eo])+1]+1]+1)&&(no=Gi,Xi++),ve[2*oa+1]=no,pe<oa||(rr.bl_count[no]++,ro=0,_n<=oa&&(ro=Ni[oa-_n]),rr.opt_len+=(Oc=ve[2*oa])*(no+ro),tt&&(rr.static_len+=Oc*(st[2*oa+1]+ro)));if(0!==Xi){do{for(no=Gi-1;0===rr.bl_count[no];)no--;rr.bl_count[no]--,rr.bl_count[no+1]+=2,rr.bl_count[Gi]--,Xi-=2}while(0<Xi);for(no=Gi;0!==no;no--)for(oa=rr.bl_count[no];0!==oa;)pe<(Lo=rr.heap[--Eo])||(ve[2*Lo+1]!==no&&(rr.opt_len+=(no-ve[2*Lo+1])*ve[2*Lo],ve[2*Lo+1]=no),oa--)}}(Ee,ut),ii(ri,_r,Ee.bl_count)}function O(Ee,ut,Tt){var $t,wt,ri=-1,di=ut[1],fi=0,Hi=7,_r=4;for(0===di&&(Hi=138,_r=3),ut[2*(Tt+1)+1]=65535,$t=0;$t<=Tt;$t++)wt=di,di=ut[2*($t+1)+1],++fi<Hi&&wt===di||(fi<_r?Ee.bl_tree[2*wt]+=fi:0!==wt?(wt!==ri&&Ee.bl_tree[2*wt]++,Ee.bl_tree[32]++):fi<=10?Ee.bl_tree[34]++:Ee.bl_tree[36]++,ri=wt,_r=(fi=0)===di?(Hi=138,3):wt===di?(Hi=6,3):(Hi=7,4))}function Me(Ee,ut,Tt){var $t,wt,ri=-1,di=ut[1],fi=0,Hi=7,_r=4;for(0===di&&(Hi=138,_r=3),$t=0;$t<=Tt;$t++)if(wt=di,di=ut[2*($t+1)+1],!(++fi<Hi&&wt===di)){if(fi<_r)for(;Fi(Ee,wt,Ee.bl_tree),0!=--fi;);else 0!==wt?(wt!==ri&&(Fi(Ee,wt,Ee.bl_tree),fi--),Fi(Ee,16,Ee.bl_tree),qi(Ee,fi-3,2)):fi<=10?(Fi(Ee,17,Ee.bl_tree),qi(Ee,fi-3,3)):(Fi(Ee,18,Ee.bl_tree),qi(Ee,fi-11,7));ri=wt,_r=(fi=0)===di?(Hi=138,3):wt===di?(Hi=6,3):(Hi=7,4)}}W(Rt);var Ke=!1;function ke(Ee,ut,Tt,$t){var wt,ri,di;qi(Ee,0+($t?1:0),3),ri=ut,di=Tt,zr(wt=Ee),bn(wt,di),bn(wt,~di),H.arraySet(wt.pending_buf,wt.window,ri,di,wt.pending),wt.pending+=di}F._tr_init=function(Ee){Ke||(function(){var ut,Tt,$t,wt,ri,di=new Array(16);for(wt=$t=0;wt<28;wt++)for(Lt[wt]=$t,ut=0;ut<1<<at[wt];ut++)_e[$t++]=wt;for(_e[$t-1]=wt,wt=ri=0;wt<16;wt++)for(Rt[wt]=ri,ut=0;ut<1<<Dt[wt];ut++)xt[ri++]=wt;for(ri>>=7;wt<30;wt++)for(Rt[wt]=ri<<7,ut=0;ut<1<<Dt[wt]-7;ut++)xt[256+ri++]=wt;for(Tt=0;Tt<=15;Tt++)di[Tt]=0;for(ut=0;ut<=143;)oi[2*ut+1]=8,ut++,di[8]++;for(;ut<=255;)oi[2*ut+1]=9,ut++,di[9]++;for(;ut<=279;)oi[2*ut+1]=7,ut++,di[7]++;for(;ut<=287;)oi[2*ut+1]=8,ut++,di[8]++;for(ii(oi,287,di),ut=0;ut<30;ut++)We[2*ut+1]=5,We[2*ut]=cr(ut,5);$i=new On(oi,at,257,286,15),Wt=new On(We,Dt,0,30,15),Ei=new On(new Array(0),dt,0,19,7)}(),Ke=!0),Ee.l_desc=new Ct(Ee.dyn_ltree,$i),Ee.d_desc=new Ct(Ee.dyn_dtree,Wt),Ee.bl_desc=new Ct(Ee.bl_tree,Ei),Ee.bi_buf=0,Ee.bi_valid=0,mr(Ee)},F._tr_stored_block=ke,F._tr_flush_block=function(Ee,ut,Tt,$t){var wt,ri,di=0;0<Ee.level?(2===Ee.strm.data_type&&(Ee.strm.data_type=function(fi){var Hi,_r=4093624447;for(Hi=0;Hi<=31;Hi++,_r>>>=1)if(1&_r&&0!==fi.dyn_ltree[2*Hi])return 0;if(0!==fi.dyn_ltree[18]||0!==fi.dyn_ltree[20]||0!==fi.dyn_ltree[26])return 1;for(Hi=32;Hi<256;Hi++)if(0!==fi.dyn_ltree[2*Hi])return 1;return 0}(Ee)),Ui(Ee,Ee.l_desc),Ui(Ee,Ee.d_desc),di=function(fi){var Hi;for(O(fi,fi.dyn_ltree,fi.l_desc.max_code),O(fi,fi.dyn_dtree,fi.d_desc.max_code),Ui(fi,fi.bl_desc),Hi=18;3<=Hi&&0===fi.bl_tree[2*Kt[Hi]+1];Hi--);return fi.opt_len+=3*(Hi+1)+5+5+4,Hi}(Ee),(ri=Ee.static_len+3+7>>>3)<=(wt=Ee.opt_len+3+7>>>3)&&(wt=ri)):wt=ri=Tt+5,Tt+4<=wt&&-1!==ut?ke(Ee,ut,Tt,$t):4===Ee.strategy||ri===wt?(qi(Ee,2+($t?1:0),3),za(Ee,oi,We)):(qi(Ee,4+($t?1:0),3),function(fi,Hi,_r,rr){var Vo;for(qi(fi,Hi-257,5),qi(fi,_r-1,5),qi(fi,rr-4,4),Vo=0;Vo<rr;Vo++)qi(fi,fi.bl_tree[2*Kt[Vo]+1],3);Me(fi,fi.dyn_ltree,Hi-1),Me(fi,fi.dyn_dtree,_r-1)}(Ee,Ee.l_desc.max_code+1,Ee.d_desc.max_code+1,di+1),za(Ee,Ee.dyn_ltree,Ee.dyn_dtree)),mr(Ee),$t&&zr(Ee)},F._tr_tally=function(Ee,ut,Tt){return Ee.pending_buf[Ee.d_buf+2*Ee.last_lit]=ut>>>8&255,Ee.pending_buf[Ee.d_buf+2*Ee.last_lit+1]=255&ut,Ee.pending_buf[Ee.l_buf+Ee.last_lit]=255&Tt,Ee.last_lit++,0===ut?Ee.dyn_ltree[2*Tt]++:(Ee.matches++,ut--,Ee.dyn_ltree[2*(_e[Tt]+256+1)]++,Ee.dyn_dtree[2*ft(ut)]++),Ee.last_lit===Ee.lit_bufsize-1},F._tr_align=function(Ee){var ut;qi(Ee,2,3),Fi(Ee,256,oi),16===(ut=Ee).bi_valid?(bn(ut,ut.bi_buf),ut.bi_buf=0,ut.bi_valid=0):8<=ut.bi_valid&&(ut.pending_buf[ut.pending++]=255&ut.bi_buf,ut.bi_buf>>=8,ut.bi_valid-=8)}},{"../utils/common":41}],53:[function(b,D,F){"use strict";D.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(b,D,F){"use strict";D.exports="function"==typeof setImmediate?setImmediate:function(){var H=[].slice.apply(arguments);H.splice(1,0,0),setTimeout.apply(null,H)}},{}]},{},[10])(10)},8407:function(C,b){!function(D){"use strict";function H(f){var x,k,X,oe;for(k=1,X=arguments.length;k<X;k++)for(x in oe=arguments[k])f[x]=oe[x];return f}var z=Object.create||function(){function f(){}return function(x){return f.prototype=x,new f}}();function V(f,x){var k=Array.prototype.slice;if(f.bind)return f.bind.apply(f,k.call(arguments,1));var X=k.call(arguments,2);return function(){return f.apply(x,X.length?X.concat(k.call(arguments)):arguments)}}var W=0;function te(f){return f._leaflet_id=f._leaflet_id||++W,f._leaflet_id}function Q(f,x,k){var X,oe,De,lt;return lt=function(){X=!1,oe&&(De.apply(k,oe),oe=!1)},De=function(){X?oe=arguments:(f.apply(k,arguments),setTimeout(lt,x),X=!0)},De}function he(f,x,k){var X=x[1],oe=x[0],De=X-oe;return f===X&&k?f:((f-oe)%De+De)%De+oe}function be(){return!1}function ae(f,x){var k=Math.pow(10,void 0===x?6:x);return Math.round(f*k)/k}function Te(f){return f.trim?f.trim():f.replace(/^\s+|\s+$/g,"")}function Ae(f){return Te(f).split(/\s+/)}function me(f,x){for(var k in Object.prototype.hasOwnProperty.call(f,"options")||(f.options=f.options?z(f.options):{}),x)f.options[k]=x[k];return f.options}function G(f,x,k){var X=[];for(var oe in f)X.push(encodeURIComponent(k?oe.toUpperCase():oe)+"="+encodeURIComponent(f[oe]));return(x&&-1!==x.indexOf("?")?"&":"?")+X.join("&")}var de=/\{ *([\w_-]+) *\}/g;function we(f,x){return f.replace(de,function(k,X){var oe=x[X];if(void 0===oe)throw new Error("No value provided for variable "+k);return"function"==typeof oe&&(oe=oe(x)),oe})}var Fe=Array.isArray||function(f){return"[object Array]"===Object.prototype.toString.call(f)};function Le(f,x){for(var k=0;k<f.length;k++)if(f[k]===x)return k;return-1}var it="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function at(f){return window["webkit"+f]||window["moz"+f]||window["ms"+f]}var Dt=0;function dt(f){var x=+new Date,k=Math.max(0,16-(x-Dt));return Dt=x+k,window.setTimeout(f,k)}var Kt=window.requestAnimationFrame||at("RequestAnimationFrame")||dt,oi=window.cancelAnimationFrame||at("CancelAnimationFrame")||at("CancelRequestAnimationFrame")||function(f){window.clearTimeout(f)};function We(f,x,k){if(!k||Kt!==dt)return Kt.call(window,V(f,x));f.call(x)}function xt(f){f&&oi.call(window,f)}var _e={extend:H,create:z,bind:V,lastId:W,stamp:te,throttle:Q,wrapNum:he,falseFn:be,formatNum:ae,trim:Te,splitWords:Ae,setOptions:me,getParamString:G,template:we,isArray:Fe,indexOf:Le,emptyImageUrl:it,requestFn:Kt,cancelFn:oi,requestAnimFrame:We,cancelAnimFrame:xt};function Lt(){}Lt.extend=function(f){var x=function(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},k=x.__super__=this.prototype,X=z(k);for(var oe in X.constructor=x,x.prototype=X,this)Object.prototype.hasOwnProperty.call(this,oe)&&"prototype"!==oe&&"__super__"!==oe&&(x[oe]=this[oe]);return f.statics&&(H(x,f.statics),delete f.statics),f.includes&&(function $i(f){if("undefined"!=typeof L&&L&&L.Mixin){f=Fe(f)?f:[f];for(var x=0;x<f.length;x++)f[x]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",(new Error).stack)}}(f.includes),H.apply(null,[X].concat(f.includes)),delete f.includes),X.options&&(f.options=H(z(X.options),f.options)),H(X,f),X._initHooks=[],X.callInitHooks=function(){if(!this._initHooksCalled){k.callInitHooks&&k.callInitHooks.call(this),this._initHooksCalled=!0;for(var De=0,lt=X._initHooks.length;De<lt;De++)X._initHooks[De].call(this)}},x},Lt.include=function(f){return H(this.prototype,f),this},Lt.mergeOptions=function(f){return H(this.prototype.options,f),this},Lt.addInitHook=function(f){var x=Array.prototype.slice.call(arguments,1),k="function"==typeof f?f:function(){this[f].apply(this,x)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(k),this};var Wt={on:function(f,x,k){if("object"==typeof f)for(var X in f)this._on(X,f[X],x);else for(var oe=0,De=(f=Ae(f)).length;oe<De;oe++)this._on(f[oe],x,k);return this},off:function(f,x,k){if(f)if("object"==typeof f)for(var X in f)this._off(X,f[X],x);else for(var oe=0,De=(f=Ae(f)).length;oe<De;oe++)this._off(f[oe],x,k);else delete this._events;return this},_on:function(f,x,k){this._events=this._events||{};var X=this._events[f];X||(this._events[f]=X=[]),k===this&&(k=void 0);for(var oe={fn:x,ctx:k},De=X,lt=0,_t=De.length;lt<_t;lt++)if(De[lt].fn===x&&De[lt].ctx===k)return;De.push(oe)},_off:function(f,x,k){var X,oe,De;if(this._events&&(X=this._events[f])){if(!x){for(oe=0,De=X.length;oe<De;oe++)X[oe].fn=be;return void delete this._events[f]}if(k===this&&(k=void 0),X)for(oe=0,De=X.length;oe<De;oe++){var lt=X[oe];if(lt.ctx===k&&lt.fn===x)return lt.fn=be,this._firingCount&&(this._events[f]=X=X.slice()),void X.splice(oe,1)}}},fire:function(f,x,k){if(!this.listens(f,k))return this;var X=H({},x,{type:f,target:this,sourceTarget:x&&x.sourceTarget||this});if(this._events){var oe=this._events[f];if(oe){this._firingCount=this._firingCount+1||1;for(var De=0,lt=oe.length;De<lt;De++){var _t=oe[De];_t.fn.call(_t.ctx||this,X)}this._firingCount--}}return k&&this._propagateEvent(X),this},listens:function(f,x){var k=this._events&&this._events[f];if(k&&k.length)return!0;if(x)for(var X in this._eventParents)if(this._eventParents[X].listens(f,x))return!0;return!1},once:function(f,x,k){if("object"==typeof f){for(var X in f)this.once(X,f[X],x);return this}var oe=V(function(){this.off(f,x,k).off(f,oe,k)},this);return this.on(f,x,k).on(f,oe,k)},addEventParent:function(f){return this._eventParents=this._eventParents||{},this._eventParents[te(f)]=f,this},removeEventParent:function(f){return this._eventParents&&delete this._eventParents[te(f)],this},_propagateEvent:function(f){for(var x in this._eventParents)this._eventParents[x].fire(f.type,H({layer:f.target,propagatedFrom:f.target},f),!0)}};Wt.addEventListener=Wt.on,Wt.removeEventListener=Wt.clearAllEventListeners=Wt.off,Wt.addOneTimeEventListener=Wt.once,Wt.fireEvent=Wt.fire,Wt.hasEventListeners=Wt.listens;var Ei=Lt.extend(Wt);function Rt(f,x,k){this.x=k?Math.round(f):f,this.y=k?Math.round(x):x}var On=Math.trunc||function(f){return f>0?Math.floor(f):Math.ceil(f)};function Ct(f,x,k){return f instanceof Rt?f:Fe(f)?new Rt(f[0],f[1]):null==f?f:"object"==typeof f&&"x"in f&&"y"in f?new Rt(f.x,f.y):new Rt(f,x,k)}function ft(f,x){if(f)for(var k=x?[f,x]:f,X=0,oe=k.length;X<oe;X++)this.extend(k[X])}function bn(f,x){return!f||f instanceof ft?f:new ft(f,x)}function qi(f,x){if(f)for(var k=x?[f,x]:f,X=0,oe=k.length;X<oe;X++)this.extend(k[X])}function Fi(f,x){return f instanceof qi?f:new qi(f,x)}function cr(f,x,k){if(isNaN(f)||isNaN(x))throw new Error("Invalid LatLng object: ("+f+", "+x+")");this.lat=+f,this.lng=+x,void 0!==k&&(this.alt=+k)}function ii(f,x,k){return f instanceof cr?f:Fe(f)&&"object"!=typeof f[0]?3===f.length?new cr(f[0],f[1],f[2]):2===f.length?new cr(f[0],f[1]):null:null==f?f:"object"==typeof f&&"lat"in f?new cr(f.lat,"lng"in f?f.lng:f.lon,f.alt):void 0===x?null:new cr(f,x,k)}Rt.prototype={clone:function(){return new Rt(this.x,this.y)},add:function(f){return this.clone()._add(Ct(f))},_add:function(f){return this.x+=f.x,this.y+=f.y,this},subtract:function(f){return this.clone()._subtract(Ct(f))},_subtract:function(f){return this.x-=f.x,this.y-=f.y,this},divideBy:function(f){return this.clone()._divideBy(f)},_divideBy:function(f){return this.x/=f,this.y/=f,this},multiplyBy:function(f){return this.clone()._multiplyBy(f)},_multiplyBy:function(f){return this.x*=f,this.y*=f,this},scaleBy:function(f){return new Rt(this.x*f.x,this.y*f.y)},unscaleBy:function(f){return new Rt(this.x/f.x,this.y/f.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=On(this.x),this.y=On(this.y),this},distanceTo:function(f){var x=(f=Ct(f)).x-this.x,k=f.y-this.y;return Math.sqrt(x*x+k*k)},equals:function(f){return(f=Ct(f)).x===this.x&&f.y===this.y},contains:function(f){return f=Ct(f),Math.abs(f.x)<=Math.abs(this.x)&&Math.abs(f.y)<=Math.abs(this.y)},toString:function(){return"Point("+ae(this.x)+", "+ae(this.y)+")"}},ft.prototype={extend:function(f){return f=Ct(f),this.min||this.max?(this.min.x=Math.min(f.x,this.min.x),this.max.x=Math.max(f.x,this.max.x),this.min.y=Math.min(f.y,this.min.y),this.max.y=Math.max(f.y,this.max.y)):(this.min=f.clone(),this.max=f.clone()),this},getCenter:function(f){return new Rt((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,f)},getBottomLeft:function(){return new Rt(this.min.x,this.max.y)},getTopRight:function(){return new Rt(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(f){var x,k;return(f="number"==typeof f[0]||f instanceof Rt?Ct(f):bn(f))instanceof ft?(x=f.min,k=f.max):x=k=f,x.x>=this.min.x&&k.x<=this.max.x&&x.y>=this.min.y&&k.y<=this.max.y},intersects:function(f){f=bn(f);var x=this.min,k=this.max,X=f.min,oe=f.max;return oe.x>=x.x&&X.x<=k.x&&oe.y>=x.y&&X.y<=k.y},overlaps:function(f){f=bn(f);var x=this.min,k=this.max,X=f.min,oe=f.max;return oe.x>x.x&&X.x<k.x&&oe.y>x.y&&X.y<k.y},isValid:function(){return!(!this.min||!this.max)}},qi.prototype={extend:function(f){var X,oe,x=this._southWest,k=this._northEast;if(f instanceof cr)X=f,oe=f;else{if(!(f instanceof qi))return f?this.extend(ii(f)||Fi(f)):this;if(oe=f._northEast,!(X=f._southWest)||!oe)return this}return x||k?(x.lat=Math.min(X.lat,x.lat),x.lng=Math.min(X.lng,x.lng),k.lat=Math.max(oe.lat,k.lat),k.lng=Math.max(oe.lng,k.lng)):(this._southWest=new cr(X.lat,X.lng),this._northEast=new cr(oe.lat,oe.lng)),this},pad:function(f){var x=this._southWest,k=this._northEast,X=Math.abs(x.lat-k.lat)*f,oe=Math.abs(x.lng-k.lng)*f;return new qi(new cr(x.lat-X,x.lng-oe),new cr(k.lat+X,k.lng+oe))},getCenter:function(){return new cr((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new cr(this.getNorth(),this.getWest())},getSouthEast:function(){return new cr(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(f){f="number"==typeof f[0]||f instanceof cr||"lat"in f?ii(f):Fi(f);var X,oe,x=this._southWest,k=this._northEast;return f instanceof qi?(X=f.getSouthWest(),oe=f.getNorthEast()):X=oe=f,X.lat>=x.lat&&oe.lat<=k.lat&&X.lng>=x.lng&&oe.lng<=k.lng},intersects:function(f){f=Fi(f);var x=this._southWest,k=this._northEast,X=f.getSouthWest(),oe=f.getNorthEast();return oe.lat>=x.lat&&X.lat<=k.lat&&oe.lng>=x.lng&&X.lng<=k.lng},overlaps:function(f){f=Fi(f);var x=this._southWest,k=this._northEast,X=f.getSouthWest(),oe=f.getNorthEast();return oe.lat>x.lat&&X.lat<k.lat&&oe.lng>x.lng&&X.lng<k.lng},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(f,x){return!!f&&(f=Fi(f),this._southWest.equals(f.getSouthWest(),x)&&this._northEast.equals(f.getNorthEast(),x))},isValid:function(){return!(!this._southWest||!this._northEast)}},cr.prototype={equals:function(f,x){return!!f&&(f=ii(f),Math.max(Math.abs(this.lat-f.lat),Math.abs(this.lng-f.lng))<=(void 0===x?1e-9:x))},toString:function(f){return"LatLng("+ae(this.lat,f)+", "+ae(this.lng,f)+")"},distanceTo:function(f){return zr.distance(this,ii(f))},wrap:function(){return zr.wrapLatLng(this)},toBounds:function(f){var x=180*f/40075017,k=x/Math.cos(Math.PI/180*this.lat);return Fi([this.lat-x,this.lng-k],[this.lat+x,this.lng+k])},clone:function(){return new cr(this.lat,this.lng,this.alt)}};var f,mr={latLngToPoint:function(f,x){var k=this.projection.project(f),X=this.scale(x);return this.transformation._transform(k,X)},pointToLatLng:function(f,x){var k=this.scale(x),X=this.transformation.untransform(f,k);return this.projection.unproject(X)},project:function(f){return this.projection.project(f)},unproject:function(f){return this.projection.unproject(f)},scale:function(f){return 256*Math.pow(2,f)},zoom:function(f){return Math.log(f/256)/Math.LN2},getProjectedBounds:function(f){if(this.infinite)return null;var x=this.projection.bounds,k=this.scale(f);return new ft(this.transformation.transform(x.min,k),this.transformation.transform(x.max,k))},infinite:!1,wrapLatLng:function(f){var x=this.wrapLng?he(f.lng,this.wrapLng,!0):f.lng;return new cr(this.wrapLat?he(f.lat,this.wrapLat,!0):f.lat,x,f.alt)},wrapLatLngBounds:function(f){var x=f.getCenter(),k=this.wrapLatLng(x),X=x.lat-k.lat,oe=x.lng-k.lng;if(0===X&&0===oe)return f;var De=f.getSouthWest(),lt=f.getNorthEast();return new qi(new cr(De.lat-X,De.lng-oe),new cr(lt.lat-X,lt.lng-oe))}},zr=H({},mr,{wrapLng:[-180,180],R:6371e3,distance:function(f,x){var k=Math.PI/180,X=f.lat*k,oe=x.lat*k,De=Math.sin((x.lat-f.lat)*k/2),lt=Math.sin((x.lng-f.lng)*k/2),_t=De*De+Math.cos(X)*Math.cos(oe)*lt*lt,Vt=2*Math.atan2(Math.sqrt(_t),Math.sqrt(1-_t));return this.R*Vt}}),qn={R:6378137,MAX_LATITUDE:85.0511287798,project:function(f){var x=Math.PI/180,k=this.MAX_LATITUDE,X=Math.max(Math.min(k,f.lat),-k),oe=Math.sin(X*x);return new Rt(this.R*f.lng*x,this.R*Math.log((1+oe)/(1-oe))/2)},unproject:function(f){var x=180/Math.PI;return new cr((2*Math.atan(Math.exp(f.y/this.R))-Math.PI/2)*x,f.x*x/this.R)},bounds:(f=6378137*Math.PI,new ft([-f,-f],[f,f]))};function za(f,x,k,X){if(Fe(f))return this._a=f[0],this._b=f[1],this._c=f[2],void(this._d=f[3]);this._a=f,this._b=x,this._c=k,this._d=X}function Ui(f,x,k,X){return new za(f,x,k,X)}za.prototype={transform:function(f,x){return this._transform(f.clone(),x)},_transform:function(f,x){return f.x=(x=x||1)*(this._a*f.x+this._b),f.y=x*(this._c*f.y+this._d),f},untransform:function(f,x){return new Rt((f.x/(x=x||1)-this._b)/this._a,(f.y/x-this._d)/this._c)}};var O=H({},zr,{code:"EPSG:3857",projection:qn,transformation:function(){var f=.5/(Math.PI*qn.R);return Ui(f,.5,-f,.5)}()}),Me=H({},O,{code:"EPSG:900913"});function Ke(f){return document.createElementNS("http://www.w3.org/2000/svg",f)}function ke(f,x){var X,oe,De,lt,_t,Vt,k="";for(X=0,De=f.length;X<De;X++){for(oe=0,lt=(_t=f[X]).length;oe<lt;oe++)k+=(oe?"L":"M")+(Vt=_t[oe]).x+" "+Vt.y;k+=x?ic?"z":"x":""}return k||"M0 0"}var Ee=document.documentElement.style,ut="ActiveXObject"in window,Tt=ut&&!document.addEventListener,$t="msLaunchUri"in navigator&&!("documentMode"in document),wt=Sa("webkit"),ri=Sa("android"),di=Sa("android 2")||Sa("android 3"),fi=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Hi=ri&&Sa("Google")&&fi<537&&!("AudioNode"in window),_r=!!window.opera,rr=!$t&&Sa("chrome"),Vo=Sa("gecko")&&!wt&&!_r&&!ut,Eo=!rr&&Sa("safari"),oa=Sa("phantom"),Lo="OTransition"in Ee,no=0===navigator.platform.indexOf("Win"),ro=ut&&"transition"in Ee,Oc="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!di,ve="MozPerspective"in Ee,pe=!window.L_DISABLE_3D&&(ro||Oc||ve)&&!Lo&&!oa,st="undefined"!=typeof orientation||Sa("mobile"),tt=st&&wt,Ni=st&&Oc,_n=!window.PointerEvent&&window.MSPointerEvent,Gi=!(!window.PointerEvent&&!_n),Xi=!window.L_NO_TOUCH&&(Gi||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),Xn=st&&_r,cs=st&&Vo,Rr=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,vs=function(){var f=!1;try{var x=Object.defineProperty({},"passive",{get:function(){f=!0}});window.addEventListener("testPassiveEventSupport",be,x),window.removeEventListener("testPassiveEventSupport",be,x)}catch(k){}return f}(),kr=!!document.createElement("canvas").getContext,ic=!(!document.createElementNS||!Ke("svg").createSVGRect),eo=!ic&&function(){try{var f=document.createElement("div");f.innerHTML='<v:shape adj="1"/>';var x=f.firstChild;return x.style.behavior="url(#default#VML)",x&&"object"==typeof x.adj}catch(k){return!1}}();function Sa(f){return navigator.userAgent.toLowerCase().indexOf(f)>=0}var Bg={ie:ut,ielt9:Tt,edge:$t,webkit:wt,android:ri,android23:di,androidStock:Hi,opera:_r,chrome:rr,gecko:Vo,safari:Eo,phantom:oa,opera12:Lo,win:no,ie3d:ro,webkit3d:Oc,gecko3d:ve,any3d:pe,mobile:st,mobileWebkit:tt,mobileWebkit3d:Ni,msPointer:_n,pointer:Gi,touch:Xi,mobileOpera:Xn,mobileGecko:cs,retina:Rr,passiveEvents:vs,canvas:kr,svg:ic,vml:eo},Ng=_n?"MSPointerDown":"pointerdown",gh=_n?"MSPointerMove":"pointermove",Kp=_n?"MSPointerUp":"pointerup",Ua=_n?"MSPointerCancel":"pointercancel",af={},Fc=!1;function ed(f,x,k,X){return"touchstart"===x?function lf(f,x,k){var X=V(function(oe){oe.MSPOINTER_TYPE_TOUCH&&oe.pointerType===oe.MSPOINTER_TYPE_TOUCH&&pu(oe),Qp(oe,x)});f["_leaflet_touchstart"+k]=X,f.addEventListener(Ng,X,!1),Fc||(document.addEventListener(Ng,aa,!0),document.addEventListener(gh,vC,!0),document.addEventListener(Kp,sv,!0),document.addEventListener(Ua,sv,!0),Fc=!0)}(f,k,X):"touchmove"===x?function ep(f,x,k){var X=function(oe){oe.pointerType===(oe.MSPOINTER_TYPE_MOUSE||"mouse")&&0===oe.buttons||Qp(oe,x)};f["_leaflet_touchmove"+k]=X,f.addEventListener(gh,X,!1)}(f,k,X):"touchend"===x&&function Jp(f,x,k){var X=function(oe){Qp(oe,x)};f["_leaflet_touchend"+k]=X,f.addEventListener(Kp,X,!1),f.addEventListener(Ua,X,!1)}(f,k,X),this}function aa(f){af[f.pointerId]=f}function vC(f){af[f.pointerId]&&(af[f.pointerId]=f)}function sv(f){delete af[f.pointerId]}function Qp(f,x){for(var k in f.touches=[],af)f.touches.push(af[k]);f.changedTouches=[f],x(f)}var tu=_n?"MSPointerDown":Gi?"pointerdown":"touchstart",cf=_n?"MSPointerUp":Gi?"pointerup":"touchend",_h="_leaflet_";var id,yr,la,hu,el,$p=Br(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),tp=Br(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Vg="webkitTransition"===tp||"OTransition"===tp?tp+"End":"transitionend";function em(f){return"string"==typeof f?document.getElementById(f):f}function uf(f,x){var k=f.style[x]||f.currentStyle&&f.currentStyle[x];if((!k||"auto"===k)&&document.defaultView){var X=document.defaultView.getComputedStyle(f,null);k=X?X[x]:null}return"auto"===k?null:k}function Ps(f,x,k){var X=document.createElement(f);return X.className=x||"",k&&k.appendChild(X),X}function xr(f){var x=f.parentNode;x&&x.removeChild(f)}function uo(f){for(;f.firstChild;)f.removeChild(f.firstChild)}function Qr(f){var x=f.parentNode;x&&x.lastChild!==f&&x.appendChild(f)}function yh(f){var x=f.parentNode;x&&x.firstChild!==f&&x.insertBefore(f,x.firstChild)}function hf(f,x){if(void 0!==f.classList)return f.classList.contains(x);var k=td(f);return k.length>0&&new RegExp("(^|\\s)"+x+"(\\s|$)").test(k)}function xn(f,x){if(void 0!==f.classList)for(var k=Ae(x),X=0,oe=k.length;X<oe;X++)f.classList.add(k[X]);else if(!hf(f,x)){var De=td(f);Us(f,(De?De+" ":"")+x)}}function Ao(f,x){void 0!==f.classList?f.classList.remove(x):Us(f,Te((" "+td(f)+" ").replace(" "+x+" "," ")))}function Us(f,x){void 0===f.className.baseVal?f.className=x:f.className.baseVal=x}function td(f){return f.correspondingElement&&(f=f.correspondingElement),void 0===f.className.baseVal?f.className:f.className.baseVal}function vc(f,x){"opacity"in f.style?f.style.opacity=x:"filter"in f.style&&function rs(f,x){var k=!1,X="DXImageTransform.Microsoft.Alpha";try{k=f.filters.item(X)}catch(oe){if(1===x)return}x=Math.round(100*x),k?(k.Enabled=100!==x,k.Opacity=x):f.style.filter+=" progid:"+X+"(opacity="+x+")"}(f,x)}function Br(f){for(var x=document.documentElement.style,k=0;k<f.length;k++)if(f[k]in x)return f[k];return!1}function Nu(f,x,k){var X=x||new Rt(0,0);f.style[$p]=(ro?"translate("+X.x+"px,"+X.y+"px)":"translate3d("+X.x+"px,"+X.y+"px,0)")+(k?" scale("+k+")":"")}function Ca(f,x){f._leaflet_pos=x,pe?Nu(f,x):(f.style.left=x.x+"px",f.style.top=x.y+"px")}function ln(f){return f._leaflet_pos||new Rt(0,0)}if("onselectstart"in document)id=function(){zn(window,"selectstart",pu)},yr=function(){ca(window,"selectstart",pu)};else{var nd=Br(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);id=function(){if(nd){var f=document.documentElement.style;la=f[nd],f[nd]="none"}},yr=function(){nd&&(document.documentElement.style[nd]=la,la=void 0)}}function rd(){zn(window,"dragstart",pu)}function sd(){ca(window,"dragstart",pu)}function zg(f){for(;-1===f.tabIndex;)f=f.parentNode;!f.style||(tm(),hu=f,el=f.style.outline,f.style.outline="none",zn(window,"keydown",tm))}function tm(){!hu||(hu.style.outline=el,hu=void 0,el=void 0,ca(window,"keydown",tm))}function bC(f){do{f=f.parentNode}while(!(f.offsetWidth&&f.offsetHeight||f===document.body));return f}function du(f){var x=f.getBoundingClientRect();return{x:x.width/f.offsetWidth||1,y:x.height/f.offsetHeight||1,boundingClientRect:x}}var od={TRANSFORM:$p,TRANSITION:tp,TRANSITION_END:Vg,get:em,getStyle:uf,create:Ps,remove:xr,empty:uo,toFront:Qr,toBack:yh,hasClass:hf,addClass:xn,removeClass:Ao,setClass:Us,getClass:td,setOpacity:vc,testProp:Br,setTransform:Nu,setPosition:Ca,getPosition:ln,disableTextSelection:id,enableTextSelection:yr,disableImageDrag:rd,enableImageDrag:sd,preventOutline:zg,restoreOutline:tm,getSizedParentNode:bC,getScale:du};function zn(f,x,k,X){if("object"==typeof x)for(var oe in x)Ug(f,oe,x[oe],k);else for(var De=0,lt=(x=Ae(x)).length;De<lt;De++)Ug(f,x[De],k,X);return this}var fu="_leaflet_events";function ca(f,x,k,X){if("object"==typeof x)for(var oe in x)im(f,oe,x[oe],k);else if(x)for(var De=0,lt=(x=Ae(x)).length;De<lt;De++)im(f,x[De],k,X);else{for(var _t in f[fu])im(f,_t,f[fu][_t]);delete f[fu]}return this}function ad(){if(Gi)return!($t||Eo)}var av={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Ug(f,x,k,X){var oe=x+te(k)+(X?"_"+te(X):"");if(f[fu]&&f[fu][oe])return this;var De=function(_t){return k.call(X||f,_t||window.event)},lt=De;Gi&&0===x.indexOf("touch")?ed(f,x,De,oe):Xi&&"dblclick"===x&&!ad()?function Hg(f,x,k){var X,oe,De=!1;function _t(_i){if(Gi){if(!_i.isPrimary||"mouse"===_i.pointerType)return}else if(_i.touches.length>1)return;var on=Date.now(),Ln=on-(X||on);oe=_i.touches?_i.touches[0]:_i,De=Ln>0&&Ln<=250,X=on}function Vt(_i){if(De&&!oe.cancelBubble){if(Gi){if("mouse"===_i.pointerType)return;var Ln,ps,on={};for(ps in oe)on[ps]=(Ln=oe[ps])&&Ln.bind?Ln.bind(oe):Ln;oe=on}oe.type="dblclick",oe.button=0,x(oe),X=null}}return f[_h+tu+k]=_t,f[_h+cf+k]=Vt,f[_h+"dblclick"+k]=x,f.addEventListener(tu,_t,!!vs&&{passive:!1}),f.addEventListener(cf,Vt,!!vs&&{passive:!1}),f.addEventListener("dblclick",x,!1),this}(f,De,oe):"addEventListener"in f?"touchstart"===x||"touchmove"===x||"wheel"===x||"mousewheel"===x?f.addEventListener(av[x]||x,De,!!vs&&{passive:!1}):"mouseenter"===x||"mouseleave"===x?f.addEventListener(av[x],De=function(_t){_t=_t||window.event,jg(f,_t)&&lt(_t)},!1):f.addEventListener(x,lt,!1):"attachEvent"in f&&f.attachEvent("on"+x,De),f[fu]=f[fu]||{},f[fu][oe]=De}function im(f,x,k,X){var oe=x+te(k)+(X?"_"+te(X):""),De=f[fu]&&f[fu][oe];if(!De)return this;Gi&&0===x.indexOf("touch")?function ks(f,x,k){var X=f["_leaflet_"+x+k];return"touchstart"===x?f.removeEventListener(Ng,X,!1):"touchmove"===x?f.removeEventListener(gh,X,!1):"touchend"===x&&(f.removeEventListener(Kp,X,!1),f.removeEventListener(Ua,X,!1)),this}(f,x,oe):Xi&&"dblclick"===x&&!ad()?function ov(f,x){var X=f[_h+cf+x],oe=f[_h+"dblclick"+x];return f.removeEventListener(tu,f[_h+tu+x],!!vs&&{passive:!1}),f.removeEventListener(cf,X,!!vs&&{passive:!1}),f.removeEventListener("dblclick",oe,!1),this}(f,oe):"removeEventListener"in f?f.removeEventListener(av[x]||x,De,!1):"detachEvent"in f&&f.detachEvent("on"+x,De),f[fu][oe]=null}function Ga(f){return f.stopPropagation?f.stopPropagation():f.originalEvent?f.originalEvent._stopped=!0:f.cancelBubble=!0,lv(f),this}function So(f){return Ug(f,"wheel",Ga),this}function Gg(f){return zn(f,"mousedown touchstart dblclick",Ga),Ug(f,"click",Wg),this}function pu(f){return f.preventDefault?f.preventDefault():f.returnValue=!1,this}function ld(f){return pu(f),Ga(f),this}function Nt(f,x){if(!x)return new Rt(f.clientX,f.clientY);var k=du(x),X=k.boundingClientRect;return new Rt((f.clientX-X.left)/k.x-x.clientLeft,(f.clientY-X.top)/k.y-x.clientTop)}var VE=no&&rr?2*window.devicePixelRatio:Vo?window.devicePixelRatio:1;function xi(f){return $t?f.wheelDeltaY/2:f.deltaY&&0===f.deltaMode?-f.deltaY/VE:f.deltaY&&1===f.deltaMode?20*-f.deltaY:f.deltaY&&2===f.deltaMode?60*-f.deltaY:f.deltaX||f.deltaZ?0:f.wheelDelta?(f.wheelDeltaY||f.wheelDelta)/2:f.detail&&Math.abs(f.detail)<32765?20*-f.detail:f.detail?f.detail/-32765*60:0}var nm={};function Wg(f){nm[f.type]=!0}function lv(f){var x=nm[f.type];return nm[f.type]=!1,x}function jg(f,x){var k=x.relatedTarget;if(!k)return!0;try{for(;k&&k!==f;)k=k.parentNode}catch(X){return!1}return k!==f}var K0={on:zn,off:ca,stopPropagation:Ga,disableScrollPropagation:So,disableClickPropagation:Gg,preventDefault:pu,stop:ld,getMousePosition:Nt,getWheelDelta:xi,fakeStop:Wg,skipped:lv,isExternalTarget:jg,addListener:zn,removeListener:ca},ip=Ei.extend({run:function(f,x,k,X){this.stop(),this._el=f,this._inProgress=!0,this._duration=k||.25,this._easeOutPower=1/Math.max(X||.5,.2),this._startPos=ln(f),this._offset=x.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){!this._inProgress||(this._step(!0),this._complete())},_animate:function(){this._animId=We(this._animate,this),this._step()},_step:function(f){var x=+new Date-this._startTime,k=1e3*this._duration;x<k?this._runFrame(this._easeOut(x/k),f):(this._runFrame(1),this._complete())},_runFrame:function(f,x){var k=this._startPos.add(this._offset.multiplyBy(f));x&&k._round(),Ca(this._el,k),this.fire("step")},_complete:function(){xt(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(f){return 1-Math.pow(1-f,this._easeOutPower)}}),ds=Ei.extend({options:{crs:O,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(f,x){x=me(this,x),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(f),this._initLayout(),this._onResize=V(this._onResize,this),this._initEvents(),x.maxBounds&&this.setMaxBounds(x.maxBounds),void 0!==x.zoom&&(this._zoom=this._limitZoom(x.zoom)),x.center&&void 0!==x.zoom&&this.setView(ii(x.center),x.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=tp&&pe&&!Xn&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),zn(this._proxy,Vg,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(f,x,k){return x=void 0===x?this._zoom:this._limitZoom(x),f=this._limitCenter(ii(f),x,this.options.maxBounds),k=k||{},this._stop(),this._loaded&&!k.reset&&!0!==k&&(void 0!==k.animate&&(k.zoom=H({animate:k.animate},k.zoom),k.pan=H({animate:k.animate,duration:k.duration},k.pan)),this._zoom!==x?this._tryAnimatedZoom&&this._tryAnimatedZoom(f,x,k.zoom):this._tryAnimatedPan(f,k.pan))?(clearTimeout(this._sizeTimer),this):(this._resetView(f,x),this)},setZoom:function(f,x){return this._loaded?this.setView(this.getCenter(),f,{zoom:x}):(this._zoom=f,this)},zoomIn:function(f,x){return this.setZoom(this._zoom+(f=f||(pe?this.options.zoomDelta:1)),x)},zoomOut:function(f,x){return this.setZoom(this._zoom-(f=f||(pe?this.options.zoomDelta:1)),x)},setZoomAround:function(f,x,k){var X=this.getZoomScale(x),oe=this.getSize().divideBy(2),lt=(f instanceof Rt?f:this.latLngToContainerPoint(f)).subtract(oe).multiplyBy(1-1/X),_t=this.containerPointToLatLng(oe.add(lt));return this.setView(_t,x,{zoom:k})},_getBoundsCenterZoom:function(f,x){x=x||{},f=f.getBounds?f.getBounds():Fi(f);var k=Ct(x.paddingTopLeft||x.padding||[0,0]),X=Ct(x.paddingBottomRight||x.padding||[0,0]),oe=this.getBoundsZoom(f,!1,k.add(X));if((oe="number"==typeof x.maxZoom?Math.min(x.maxZoom,oe):oe)===1/0)return{center:f.getCenter(),zoom:oe};var De=X.subtract(k).divideBy(2),lt=this.project(f.getSouthWest(),oe),_t=this.project(f.getNorthEast(),oe);return{center:this.unproject(lt.add(_t).divideBy(2).add(De),oe),zoom:oe}},fitBounds:function(f,x){if(!(f=Fi(f)).isValid())throw new Error("Bounds are not valid.");var k=this._getBoundsCenterZoom(f,x);return this.setView(k.center,k.zoom,x)},fitWorld:function(f){return this.fitBounds([[-90,-180],[90,180]],f)},panTo:function(f,x){return this.setView(f,this._zoom,{pan:x})},panBy:function(f,x){if(x=x||{},!(f=Ct(f).round()).x&&!f.y)return this.fire("moveend");if(!0!==x.animate&&!this.getSize().contains(f))return this._resetView(this.unproject(this.project(this.getCenter()).add(f)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new ip,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),x.noMoveStart||this.fire("movestart"),!1!==x.animate){xn(this._mapPane,"leaflet-pan-anim");var k=this._getMapPanePos().subtract(f).round();this._panAnim.run(this._mapPane,k,x.duration||.25,x.easeLinearity)}else this._rawPanBy(f),this.fire("move").fire("moveend");return this},flyTo:function(f,x,k){if(!1===(k=k||{}).animate||!pe)return this.setView(f,x,k);this._stop();var X=this.project(this.getCenter()),oe=this.project(f),De=this.getSize(),lt=this._zoom;f=ii(f),x=void 0===x?lt:x;var _t=Math.max(De.x,De.y),Vt=_t*this.getZoomScale(lt,x),_i=oe.distanceTo(X)||1,on=1.42,Ln=on*on;function ps(Zn){var Vc=(Vt*Vt-_t*_t+(Zn?-1:1)*Ln*Ln*_i*_i)/(2*(Zn?Vt:_t)*Ln*_i),$g=Math.sqrt(Vc*Vc+1)-Vc;return $g<1e-9?-18:Math.log($g)}function Hc(Zn){return(Math.exp(Zn)-Math.exp(-Zn))/2}function fo(Zn){return(Math.exp(Zn)+Math.exp(-Zn))/2}var Wu=ps(0);function ha(Zn){return _t*(fo(Wu)*function bf(Zn){return Hc(Zn)/fo(Zn)}(Wu+on*Zn)-Hc(Wu))/Ln}var da=Date.now(),fa=(ps(1)-Wu)/on,Do=k.duration?1e3*k.duration:1e3*fa*.8;return this._moveStart(!0,k.noMoveStart),function xf(){var Zn=(Date.now()-da)/Do,yl=function GE(Zn){return 1-Math.pow(1-Zn,1.5)}(Zn)*fa;Zn<=1?(this._flyToFrame=We(xf,this),this._move(this.unproject(X.add(oe.subtract(X).multiplyBy(ha(yl)/_i)),lt),this.getScaleZoom(_t/function zo(Zn){return _t*(fo(Wu)/fo(Wu+on*Zn))}(yl),lt),{flyTo:!0})):this._move(f,x)._moveEnd(!0)}.call(this),this},flyToBounds:function(f,x){var k=this._getBoundsCenterZoom(f,x);return this.flyTo(k.center,k.zoom,x)},setMaxBounds:function(f){return(f=Fi(f)).isValid()?(this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this.options.maxBounds=f,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds))},setMinZoom:function(f){var x=this.options.minZoom;return this.options.minZoom=f,this._loaded&&x!==f&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(f):this},setMaxZoom:function(f){var x=this.options.maxZoom;return this.options.maxZoom=f,this._loaded&&x!==f&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(f):this},panInsideBounds:function(f,x){this._enforcingBounds=!0;var k=this.getCenter(),X=this._limitCenter(k,this._zoom,Fi(f));return k.equals(X)||this.panTo(X,x),this._enforcingBounds=!1,this},panInside:function(f,x){var k=Ct((x=x||{}).paddingTopLeft||x.padding||[0,0]),X=Ct(x.paddingBottomRight||x.padding||[0,0]),oe=this.getCenter(),De=this.project(oe),lt=this.project(f),_t=this.getPixelBounds(),Vt=_t.getSize().divideBy(2),_i=bn([_t.min.add(k),_t.max.subtract(X)]);if(!_i.contains(lt)){this._enforcingBounds=!0;var on=De.subtract(lt),Ln=Ct(lt.x+on.x,lt.y+on.y);(lt.x<_i.min.x||lt.x>_i.max.x)&&(Ln.x=De.x-on.x,on.x>0?Ln.x+=Vt.x-k.x:Ln.x-=Vt.x-X.x),(lt.y<_i.min.y||lt.y>_i.max.y)&&(Ln.y=De.y-on.y,on.y>0?Ln.y+=Vt.y-k.y:Ln.y-=Vt.y-X.y),this.panTo(this.unproject(Ln),x),this._enforcingBounds=!1}return this},invalidateSize:function(f){if(!this._loaded)return this;f=H({animate:!1,pan:!0},!0===f?{animate:!0}:f);var x=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var k=this.getSize(),X=x.divideBy(2).round(),oe=k.divideBy(2).round(),De=X.subtract(oe);return De.x||De.y?(f.animate&&f.pan?this.panBy(De):(f.pan&&this._rawPanBy(De),this.fire("move"),f.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(V(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:x,newSize:k})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(f){if(f=this._locateOptions=H({timeout:1e4,watch:!1},f),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var x=V(this._handleGeolocationResponse,this),k=V(this._handleGeolocationError,this);return f.watch?this._locationWatchId=navigator.geolocation.watchPosition(x,k,f):navigator.geolocation.getCurrentPosition(x,k,f),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(f){var x=f.code,k=f.message||(1===x?"permission denied":2===x?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:x,message:"Geolocation error: "+k+"."})},_handleGeolocationResponse:function(f){var X=new cr(f.coords.latitude,f.coords.longitude),oe=X.toBounds(2*f.coords.accuracy),De=this._locateOptions;if(De.setView){var lt=this.getBoundsZoom(oe);this.setView(X,De.maxZoom?Math.min(lt,De.maxZoom):lt)}var _t={latlng:X,bounds:oe,timestamp:f.timestamp};for(var Vt in f.coords)"number"==typeof f.coords[Vt]&&(_t[Vt]=f.coords[Vt]);this.fire("locationfound",_t)},addHandler:function(f,x){if(!x)return this;var k=this[f]=new x(this);return this._handlers.push(k),this.options[f]&&k.enable(),this},remove:function(){if(this._initEvents(!0),this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(x){this._container._leaflet_id=void 0,this._containerId=void 0}var f;for(f in void 0!==this._locationWatchId&&this.stopLocate(),this._stop(),xr(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(xt(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload"),this._layers)this._layers[f].remove();for(f in this._panes)xr(this._panes[f]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(f,x){var X=Ps("div","leaflet-pane"+(f?" leaflet-"+f.replace("Pane","")+"-pane":""),x||this._mapPane);return f&&(this._panes[f]=X),X},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var f=this.getPixelBounds();return new qi(this.unproject(f.getBottomLeft()),this.unproject(f.getTopRight()))},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(f,x,k){f=Fi(f),k=Ct(k||[0,0]);var X=this.getZoom()||0,oe=this.getMinZoom(),De=this.getMaxZoom(),lt=f.getNorthWest(),_t=f.getSouthEast(),Vt=this.getSize().subtract(k),_i=bn(this.project(_t,X),this.project(lt,X)).getSize(),on=pe?this.options.zoomSnap:1,Ln=Vt.x/_i.x,ps=Vt.y/_i.y,Hc=x?Math.max(Ln,ps):Math.min(Ln,ps);return X=this.getScaleZoom(Hc,X),on&&(X=Math.round(X/(on/100))*(on/100),X=x?Math.ceil(X/on)*on:Math.floor(X/on)*on),Math.max(oe,Math.min(De,X))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new Rt(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(f,x){var k=this._getTopLeftPoint(f,x);return new ft(k,k.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(f){return this.options.crs.getProjectedBounds(void 0===f?this.getZoom():f)},getPane:function(f){return"string"==typeof f?this._panes[f]:f},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(f,x){var k=this.options.crs;return x=void 0===x?this._zoom:x,k.scale(f)/k.scale(x)},getScaleZoom:function(f,x){var k=this.options.crs,X=k.zoom(f*k.scale(x=void 0===x?this._zoom:x));return isNaN(X)?1/0:X},project:function(f,x){return x=void 0===x?this._zoom:x,this.options.crs.latLngToPoint(ii(f),x)},unproject:function(f,x){return x=void 0===x?this._zoom:x,this.options.crs.pointToLatLng(Ct(f),x)},layerPointToLatLng:function(f){var x=Ct(f).add(this.getPixelOrigin());return this.unproject(x)},latLngToLayerPoint:function(f){return this.project(ii(f))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(f){return this.options.crs.wrapLatLng(ii(f))},wrapLatLngBounds:function(f){return this.options.crs.wrapLatLngBounds(Fi(f))},distance:function(f,x){return this.options.crs.distance(ii(f),ii(x))},containerPointToLayerPoint:function(f){return Ct(f).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(f){return Ct(f).add(this._getMapPanePos())},containerPointToLatLng:function(f){var x=this.containerPointToLayerPoint(Ct(f));return this.layerPointToLatLng(x)},latLngToContainerPoint:function(f){return this.layerPointToContainerPoint(this.latLngToLayerPoint(ii(f)))},mouseEventToContainerPoint:function(f){return Nt(f,this._container)},mouseEventToLayerPoint:function(f){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(f))},mouseEventToLatLng:function(f){return this.layerPointToLatLng(this.mouseEventToLayerPoint(f))},_initContainer:function(f){var x=this._container=em(f);if(!x)throw new Error("Map container not found.");if(x._leaflet_id)throw new Error("Map container is already initialized.");zn(x,"scroll",this._onScroll,this),this._containerId=te(x)},_initLayout:function(){var f=this._container;this._fadeAnimated=this.options.fadeAnimation&&pe,xn(f,"leaflet-container"+(Xi?" leaflet-touch":"")+(Rr?" leaflet-retina":"")+(Tt?" leaflet-oldie":"")+(Eo?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var x=uf(f,"position");"absolute"!==x&&"relative"!==x&&"fixed"!==x&&(f.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var f=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Ca(this._mapPane,new Rt(0,0)),this.createPane("tilePane"),this.createPane("shadowPane"),this.createPane("overlayPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(xn(f.markerPane,"leaflet-zoom-hide"),xn(f.shadowPane,"leaflet-zoom-hide"))},_resetView:function(f,x){Ca(this._mapPane,new Rt(0,0));var k=!this._loaded;this._loaded=!0,x=this._limitZoom(x),this.fire("viewprereset");var X=this._zoom!==x;this._moveStart(X,!1)._move(f,x)._moveEnd(X),this.fire("viewreset"),k&&this.fire("load")},_moveStart:function(f,x){return f&&this.fire("zoomstart"),x||this.fire("movestart"),this},_move:function(f,x,k){void 0===x&&(x=this._zoom);var X=this._zoom!==x;return this._zoom=x,this._lastCenter=f,this._pixelOrigin=this._getNewPixelOrigin(f),(X||k&&k.pinch)&&this.fire("zoom",k),this.fire("move",k)},_moveEnd:function(f){return f&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return xt(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(f){Ca(this._mapPane,this._getMapPanePos().subtract(f))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(f){this._targets={},this._targets[te(this._container)]=this;var x=f?ca:zn;x(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&x(window,"resize",this._onResize,this),pe&&this.options.transform3DLimit&&(f?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){xt(this._resizeRequest),this._resizeRequest=We(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var f=this._getMapPanePos();Math.max(Math.abs(f.x),Math.abs(f.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(f,x){for(var X,k=[],oe="mouseout"===x||"mouseover"===x,De=f.target||f.srcElement,lt=!1;De;){if((X=this._targets[te(De)])&&("click"===x||"preclick"===x)&&!f._simulated&&this._draggableMoved(X)){lt=!0;break}if(X&&X.listens(x,!0)&&(oe&&!jg(De,f)||(k.push(X),oe))||De===this._container)break;De=De.parentNode}return!k.length&&!lt&&!oe&&jg(De,f)&&(k=[this]),k},_handleDOMEvent:function(f){if(this._loaded&&!lv(f)){var x=f.type;("mousedown"===x||"keypress"===x||"keyup"===x||"keydown"===x)&&zg(f.target||f.srcElement),this._fireDOMEvent(f,x)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(f,x,k){if("click"===f.type){var X=H({},f);X.type="preclick",this._fireDOMEvent(X,X.type,k)}if(!f._stopped&&(k=(k||[]).concat(this._findEventTargets(f,x))).length){var oe=k[0];"contextmenu"===x&&oe.listens(x,!0)&&pu(f);var De={originalEvent:f};if("keypress"!==f.type&&"keydown"!==f.type&&"keyup"!==f.type){var lt=oe.getLatLng&&(!oe._radius||oe._radius<=10);De.containerPoint=lt?this.latLngToContainerPoint(oe.getLatLng()):this.mouseEventToContainerPoint(f),De.layerPoint=this.containerPointToLayerPoint(De.containerPoint),De.latlng=lt?oe.getLatLng():this.layerPointToLatLng(De.layerPoint)}for(var _t=0;_t<k.length;_t++)if(k[_t].fire(x,De,!0),De.originalEvent._stopped||!1===k[_t].options.bubblingMouseEvents&&-1!==Le(this._mouseEvents,x))return}},_draggableMoved:function(f){return(f=f.dragging&&f.dragging.enabled()?f:this).dragging&&f.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var f=0,x=this._handlers.length;f<x;f++)this._handlers[f].disable()},whenReady:function(f,x){return this._loaded?f.call(x||this,{target:this}):this.on("load",f,x),this},_getMapPanePos:function(){return ln(this._mapPane)||new Rt(0,0)},_moved:function(){var f=this._getMapPanePos();return f&&!f.equals([0,0])},_getTopLeftPoint:function(f,x){return(f&&void 0!==x?this._getNewPixelOrigin(f,x):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(f,x){var k=this.getSize()._divideBy(2);return this.project(f,x)._subtract(k)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(f,x,k){var X=this._getNewPixelOrigin(k,x);return this.project(f,x)._subtract(X)},_latLngBoundsToNewLayerBounds:function(f,x,k){var X=this._getNewPixelOrigin(k,x);return bn([this.project(f.getSouthWest(),x)._subtract(X),this.project(f.getNorthWest(),x)._subtract(X),this.project(f.getSouthEast(),x)._subtract(X),this.project(f.getNorthEast(),x)._subtract(X)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(f){return this.latLngToLayerPoint(f).subtract(this._getCenterLayerPoint())},_limitCenter:function(f,x,k){if(!k)return f;var X=this.project(f,x),oe=this.getSize().divideBy(2),De=new ft(X.subtract(oe),X.add(oe)),lt=this._getBoundsOffset(De,k,x);return lt.round().equals([0,0])?f:this.unproject(X.add(lt),x)},_limitOffset:function(f,x){if(!x)return f;var k=this.getPixelBounds(),X=new ft(k.min.add(f),k.max.add(f));return f.add(this._getBoundsOffset(X,x))},_getBoundsOffset:function(f,x,k){var X=bn(this.project(x.getNorthEast(),k),this.project(x.getSouthWest(),k)),oe=X.min.subtract(f.min),De=X.max.subtract(f.max);return new Rt(this._rebound(oe.x,-De.x),this._rebound(oe.y,-De.y))},_rebound:function(f,x){return f+x>0?Math.round(f-x)/2:Math.max(0,Math.ceil(f))-Math.max(0,Math.floor(x))},_limitZoom:function(f){var x=this.getMinZoom(),k=this.getMaxZoom(),X=pe?this.options.zoomSnap:1;return X&&(f=Math.round(f/X)*X),Math.max(x,Math.min(k,f))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Ao(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(f,x){var k=this._getCenterOffset(f)._trunc();return!(!0!==(x&&x.animate)&&!this.getSize().contains(k)||(this.panBy(k,x),0))},_createAnimProxy:function(){var f=this._proxy=Ps("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(f),this.on("zoomanim",function(x){var k=$p,X=this._proxy.style[k];Nu(this._proxy,this.project(x.center,x.zoom),this.getZoomScale(x.zoom,1)),X===this._proxy.style[k]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){xr(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var f=this.getCenter(),x=this.getZoom();Nu(this._proxy,this.project(f,x),this.getZoomScale(x,1))},_catchTransitionEnd:function(f){this._animatingZoom&&f.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(f,x,k){if(this._animatingZoom)return!0;if(k=k||{},!this._zoomAnimated||!1===k.animate||this._nothingToAnimate()||Math.abs(x-this._zoom)>this.options.zoomAnimationThreshold)return!1;var X=this.getZoomScale(x),oe=this._getCenterOffset(f)._divideBy(1-1/X);return!(!0!==k.animate&&!this.getSize().contains(oe)||(We(function(){this._moveStart(!0,!1)._animateZoom(f,x,!0)},this),0))},_animateZoom:function(f,x,k,X){!this._mapPane||(k&&(this._animatingZoom=!0,this._animateToCenter=f,this._animateToZoom=x,xn(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:f,zoom:x,noUpdate:X}),setTimeout(V(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){!this._animatingZoom||(this._mapPane&&Ao(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom),We(function(){this._moveEnd(!0)},this))}});var mu=Lt.extend({options:{position:"topright"},initialize:function(f){me(this,f)},getPosition:function(){return this.options.position},setPosition:function(f){var x=this._map;return x&&x.removeControl(this),this.options.position=f,x&&x.addControl(this),this},getContainer:function(){return this._container},addTo:function(f){this.remove(),this._map=f;var x=this._container=this.onAdd(f),k=this.getPosition(),X=f._controlCorners[k];return xn(x,"leaflet-control"),-1!==k.indexOf("bottom")?X.insertBefore(x,X.firstChild):X.appendChild(x),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(xr(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(f){this._map&&f&&f.screenX>0&&f.screenY>0&&this._map.getContainer().focus()}}),wr=function(f){return new mu(f)};ds.include({addControl:function(f){return f.addTo(this),this},removeControl:function(f){return f.remove(),this},_initControlPos:function(){var f=this._controlCorners={},x="leaflet-",k=this._controlContainer=Ps("div",x+"control-container",this._container);function X(oe,De){f[oe+De]=Ps("div",x+oe+" "+x+De,k)}X("top","left"),X("top","right"),X("bottom","left"),X("bottom","right")},_clearControlPos:function(){for(var f in this._controlCorners)xr(this._controlCorners[f]);xr(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var qg=mu.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(f,x,k,X){return k<X?-1:X<k?1:0}},initialize:function(f,x,k){for(var X in me(this,k),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,f)this._addLayer(f[X],X);for(X in x)this._addLayer(x[X],X,!0)},onAdd:function(f){this._initLayout(),this._update(),this._map=f,f.on("zoomend",this._checkDisabledLayers,this);for(var x=0;x<this._layers.length;x++)this._layers[x].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(f){return mu.prototype.addTo.call(this,f),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var f=0;f<this._layers.length;f++)this._layers[f].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(f,x){return this._addLayer(f,x),this._map?this._update():this},addOverlay:function(f,x){return this._addLayer(f,x,!0),this._map?this._update():this},removeLayer:function(f){f.off("add remove",this._onLayerChange,this);var x=this._getLayer(te(f));return x&&this._layers.splice(this._layers.indexOf(x),1),this._map?this._update():this},expand:function(){xn(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var f=this._map.getSize().y-(this._container.offsetTop+50);return f<this._section.clientHeight?(xn(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=f+"px"):Ao(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Ao(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var f="leaflet-control-layers",x=this._container=Ps("div",f),k=this.options.collapsed;x.setAttribute("aria-haspopup",!0),Gg(x),So(x);var X=this._section=Ps("section",f+"-list");k&&(this._map.on("click",this.collapse,this),ri||zn(x,{mouseenter:this.expand,mouseleave:this.collapse},this));var oe=this._layersLink=Ps("a",f+"-toggle",x);oe.href="#",oe.title="Layers",Xi?(zn(oe,"click",ld),zn(oe,"click",this.expand,this)):zn(oe,"focus",this.expand,this),k||this.expand(),this._baseLayersList=Ps("div",f+"-base",X),this._separator=Ps("div",f+"-separator",X),this._overlaysList=Ps("div",f+"-overlays",X),x.appendChild(X)},_getLayer:function(f){for(var x=0;x<this._layers.length;x++)if(this._layers[x]&&te(this._layers[x].layer)===f)return this._layers[x]},_addLayer:function(f,x,k){this._map&&f.on("add remove",this._onLayerChange,this),this._layers.push({layer:f,name:x,overlay:k}),this.options.sortLayers&&this._layers.sort(V(function(X,oe){return this.options.sortFunction(X.layer,oe.layer,X.name,oe.name)},this)),this.options.autoZIndex&&f.setZIndex&&(this._lastZIndex++,f.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;uo(this._baseLayersList),uo(this._overlaysList),this._layerControlInputs=[];var f,x,k,X,oe=0;for(k=0;k<this._layers.length;k++)this._addItem(X=this._layers[k]),x=x||X.overlay,f=f||!X.overlay,oe+=X.overlay?0:1;return this.options.hideSingleBase&&(this._baseLayersList.style.display=(f=f&&oe>1)?"":"none"),this._separator.style.display=x&&f?"":"none",this},_onLayerChange:function(f){this._handlingClick||this._update();var x=this._getLayer(te(f.target)),k=x.overlay?"add"===f.type?"overlayadd":"overlayremove":"add"===f.type?"baselayerchange":null;k&&this._map.fire(k,x)},_createRadioElement:function(f,x){var k='<input type="radio" class="leaflet-control-layers-selector" name="'+f+'"'+(x?' checked="checked"':"")+"/>",X=document.createElement("div");return X.innerHTML=k,X.firstChild},_addItem:function(f){var X,x=document.createElement("label"),k=this._map.hasLayer(f.layer);f.overlay?((X=document.createElement("input")).type="checkbox",X.className="leaflet-control-layers-selector",X.defaultChecked=k):X=this._createRadioElement("leaflet-base-layers_"+te(this),k),this._layerControlInputs.push(X),X.layerId=te(f.layer),zn(X,"click",this._onInputClick,this);var oe=document.createElement("span");oe.innerHTML=" "+f.name;var De=document.createElement("div");return x.appendChild(De),De.appendChild(X),De.appendChild(oe),(f.overlay?this._overlaysList:this._baseLayersList).appendChild(x),this._checkDisabledLayers(),x},_onInputClick:function(){var x,k,f=this._layerControlInputs,X=[],oe=[];this._handlingClick=!0;for(var De=f.length-1;De>=0;De--)k=this._getLayer((x=f[De]).layerId).layer,x.checked?X.push(k):x.checked||oe.push(k);for(De=0;De<oe.length;De++)this._map.hasLayer(oe[De])&&this._map.removeLayer(oe[De]);for(De=0;De<X.length;De++)this._map.hasLayer(X[De])||this._map.addLayer(X[De]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var x,k,f=this._layerControlInputs,X=this._map.getZoom(),oe=f.length-1;oe>=0;oe--)k=this._getLayer((x=f[oe]).layerId).layer,x.disabled=void 0!==k.options.minZoom&&X<k.options.minZoom||void 0!==k.options.maxZoom&&X>k.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}}),Hu=mu.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out"},onAdd:function(f){var x="leaflet-control-zoom",k=Ps("div",x+" leaflet-bar"),X=this.options;return this._zoomInButton=this._createButton(X.zoomInText,X.zoomInTitle,x+"-in",k,this._zoomIn),this._zoomOutButton=this._createButton(X.zoomOutText,X.zoomOutTitle,x+"-out",k,this._zoomOut),this._updateDisabled(),f.on("zoomend zoomlevelschange",this._updateDisabled,this),k},onRemove:function(f){f.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(f){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(f.shiftKey?3:1))},_zoomOut:function(f){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(f.shiftKey?3:1))},_createButton:function(f,x,k,X,oe){var De=Ps("a",k,X);return De.innerHTML=f,De.href="#",De.title=x,De.setAttribute("role","button"),De.setAttribute("aria-label",x),Gg(De),zn(De,"click",ld),zn(De,"click",oe,this),zn(De,"click",this._refocusOnMap,this),De},_updateDisabled:function(){var f=this._map,x="leaflet-disabled";Ao(this._zoomInButton,x),Ao(this._zoomOutButton,x),(this._disabled||f._zoom===f.getMinZoom())&&xn(this._zoomOutButton,x),(this._disabled||f._zoom===f.getMaxZoom())&&xn(this._zoomInButton,x)}});ds.mergeOptions({zoomControl:!0}),ds.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Hu,this.addControl(this.zoomControl))});var wC=mu.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(f){var x="leaflet-control-scale",k=Ps("div",x),X=this.options;return this._addScales(X,x+"-line",k),f.on(X.updateWhenIdle?"moveend":"move",this._update,this),f.whenReady(this._update,this),k},onRemove:function(f){f.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(f,x,k){f.metric&&(this._mScale=Ps("div",x,k)),f.imperial&&(this._iScale=Ps("div",x,k))},_update:function(){var f=this._map,x=f.getSize().y/2,k=f.distance(f.containerPointToLatLng([0,x]),f.containerPointToLatLng([this.options.maxWidth,x]));this._updateScales(k)},_updateScales:function(f){this.options.metric&&f&&this._updateMetric(f),this.options.imperial&&f&&this._updateImperial(f)},_updateMetric:function(f){var x=this._getRoundNum(f);this._updateScale(this._mScale,x<1e3?x+" m":x/1e3+" km",x/f)},_updateImperial:function(f){var k,X,oe,x=3.2808399*f;x>5280?(X=this._getRoundNum(k=x/5280),this._updateScale(this._iScale,X+" mi",X/k)):(oe=this._getRoundNum(x),this._updateScale(this._iScale,oe+" ft",oe/x))},_updateScale:function(f,x,k){f.style.width=Math.round(this.options.maxWidth*k)+"px",f.innerHTML=x},_getRoundNum:function(f){var x=Math.pow(10,(Math.floor(f)+"").length-1),k=f/x;return x*(k>=10?10:k>=5?5:k>=3?3:k>=2?2:1)}}),nc=mu.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(f){me(this,f),this._attributions={}},onAdd:function(f){for(var x in f.attributionControl=this,this._container=Ps("div","leaflet-control-attribution"),Gg(this._container),f._layers)f._layers[x].getAttribution&&this.addAttribution(f._layers[x].getAttribution());return this._update(),this._container},setPrefix:function(f){return this.options.prefix=f,this._update(),this},addAttribution:function(f){return f?(this._attributions[f]||(this._attributions[f]=0),this._attributions[f]++,this._update(),this):this},removeAttribution:function(f){return f?(this._attributions[f]&&(this._attributions[f]--,this._update()),this):this},_update:function(){if(this._map){var f=[];for(var x in this._attributions)this._attributions[x]&&f.push(x);var k=[];this.options.prefix&&k.push(this.options.prefix),f.length&&k.push(f.join(", ")),this._container.innerHTML=k.join(" | ")}}});ds.mergeOptions({attributionControl:!0}),ds.addInitHook(function(){this.options.attributionControl&&(new nc).addTo(this)});mu.Layers=qg,mu.Zoom=Hu,mu.Scale=wC,mu.Attribution=nc,wr.layers=function(f,x,k){return new qg(f,x,k)},wr.zoom=function(f){return new Hu(f)},wr.scale=function(f){return new wC(f)},wr.attribution=function(f){return new nc(f)};var Fl=Lt.extend({initialize:function(f){this._map=f},enable:function(){return this._enabled||(this._enabled=!0,this.addHooks()),this},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Fl.addTo=function(f,x){return f.addHandler(x,this),this};var Zg,Co={Events:Wt},rm=Xi?"touchstart mousedown":"mousedown",ud={mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},ff={mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"},tl=Ei.extend({options:{clickTolerance:3},initialize:function(f,x,k,X){me(this,X),this._element=f,this._dragStartTarget=x||f,this._preventOutline=k},enable:function(){this._enabled||(zn(this._dragStartTarget,rm,this._onDown,this),this._enabled=!0)},disable:function(){!this._enabled||(tl._dragging===this&&this.finishDrag(),ca(this._dragStartTarget,rm,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(f){if(!f._simulated&&this._enabled&&(this._moved=!1,!hf(this._element,"leaflet-zoom-anim")&&!(tl._dragging||f.shiftKey||1!==f.which&&1!==f.button&&!f.touches)&&(tl._dragging=this,this._preventOutline&&zg(this._element),rd(),id(),!this._moving))){this.fire("down");var x=f.touches?f.touches[0]:f,k=bC(this._element);this._startPoint=new Rt(x.clientX,x.clientY),this._parentScale=du(k),zn(document,ff[f.type],this._onMove,this),zn(document,ud[f.type],this._onUp,this)}},_onMove:function(f){if(!f._simulated&&this._enabled){if(f.touches&&f.touches.length>1)return void(this._moved=!0);var x=f.touches&&1===f.touches.length?f.touches[0]:f,k=new Rt(x.clientX,x.clientY)._subtract(this._startPoint);!k.x&&!k.y||Math.abs(k.x)+Math.abs(k.y)<this.options.clickTolerance||(k.x/=this._parentScale.x,k.y/=this._parentScale.y,pu(f),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=ln(this._element).subtract(k),xn(document.body,"leaflet-dragging"),this._lastTarget=f.target||f.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),xn(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(k),this._moving=!0,xt(this._animRequest),this._lastEvent=f,this._animRequest=We(this._updatePosition,this,!0))}},_updatePosition:function(){var f={originalEvent:this._lastEvent};this.fire("predrag",f),Ca(this._element,this._newPos),this.fire("drag",f)},_onUp:function(f){f._simulated||!this._enabled||this.finishDrag()},finishDrag:function(){for(var f in Ao(document.body,"leaflet-dragging"),this._lastTarget&&(Ao(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),ff)ca(document,ff[f],this._onMove,this),ca(document,ud[f],this._onUp,this);sd(),yr(),this._moved&&this._moving&&(xt(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1,tl._dragging=!1}});function Ur(f,x){if(!x||!f.length)return f.slice();var k=x*x;return function np(f,x){var k=f.length,oe=new(typeof Uint8Array!=void 0+""?Uint8Array:Array)(k);oe[0]=oe[k-1]=1,Gs(f,oe,x,0,k-1);var De,lt=[];for(De=0;De<k;De++)oe[De]&&lt.push(f[De]);return lt}(f=function Xg(f,x){for(var k=[f[0]],X=1,oe=0,De=f.length;X<De;X++)om(f[X],f[oe])>x&&(k.push(f[X]),oe=X);return oe<De-1&&k.push(f[De-1]),k}(f,k),k)}function uv(f,x,k){return Math.sqrt(am(f,x,k,!0))}function Gs(f,x,k,X,oe){var lt,_t,Vt,De=0;for(_t=X+1;_t<=oe-1;_t++)(Vt=am(f[_t],f[X],f[oe],!0))>De&&(lt=_t,De=Vt);De>k&&(x[lt]=1,Gs(f,x,k,X,lt),Gs(f,x,k,lt,oe))}function Yg(f,x,k,X,oe){var _t,Vt,_i,De=X?Zg:rc(f,k),lt=rc(x,k);for(Zg=lt;;){if(!(De|lt))return[f,x];if(De&lt)return!1;_i=rc(Vt=sm(f,x,_t=De||lt,k,oe),k),_t===De?(f=Vt,De=_i):(x=Vt,lt=_i)}}function sm(f,x,k,X,oe){var _i,on,De=x.x-f.x,lt=x.y-f.y,_t=X.min,Vt=X.max;return 8&k?(_i=f.x+De*(Vt.y-f.y)/lt,on=Vt.y):4&k?(_i=f.x+De*(_t.y-f.y)/lt,on=_t.y):2&k?(_i=Vt.x,on=f.y+lt*(Vt.x-f.x)/De):1&k&&(_i=_t.x,on=f.y+lt*(_t.x-f.x)/De),new Rt(_i,on,oe)}function rc(f,x){var k=0;return f.x<x.min.x?k|=1:f.x>x.max.x&&(k|=2),f.y<x.min.y?k|=4:f.y>x.max.y&&(k|=8),k}function om(f,x){var k=x.x-f.x,X=x.y-f.y;return k*k+X*X}function am(f,x,k,X){var _i,oe=x.x,De=x.y,lt=k.x-oe,_t=k.y-De,Vt=lt*lt+_t*_t;return Vt>0&&((_i=((f.x-oe)*lt+(f.y-De)*_t)/Vt)>1?(oe=k.x,De=k.y):_i>0&&(oe+=lt*_i,De+=_t*_i)),lt=f.x-oe,_t=f.y-De,X?lt*lt+_t*_t:new Rt(oe,De)}function ei(f){return!Fe(f[0])||"object"!=typeof f[0][0]&&void 0!==f[0][0]}function hv(f){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),ei(f)}var J0={simplify:Ur,pointToSegmentDistance:uv,closestPointOnSegment:function zE(f,x,k){return am(f,x,k)},clipSegment:Yg,_getEdgeIntersection:sm,_getBitCode:rc,_sqClosestPointOnSegment:am,isFlat:ei,_flat:hv};function lm(f,x,k){var X,De,lt,_t,Vt,_i,on,Ln,ps,oe=[1,4,2,8];for(De=0,on=f.length;De<on;De++)f[De]._code=rc(f[De],x);for(_t=0;_t<4;_t++){for(Ln=oe[_t],X=[],De=0,lt=(on=f.length)-1;De<on;lt=De++)_i=f[lt],(Vt=f[De])._code&Ln?_i._code&Ln||((ps=sm(_i,Vt,Ln,x,k))._code=rc(ps,x),X.push(ps)):(_i._code&Ln&&((ps=sm(_i,Vt,Ln,x,k))._code=rc(ps,x),X.push(ps)),X.push(Vt));f=X}return f}var dv={clipPolygon:lm},yi={project:function(f){return new Rt(f.lng,f.lat)},unproject:function(f){return new cr(f.y,f.x)},bounds:new ft([-180,-90],[180,90])},fv={R:6378137,R_MINOR:6356752.314245179,bounds:new ft([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(f){var x=Math.PI/180,k=this.R,X=f.lat*x,oe=this.R_MINOR/k,De=Math.sqrt(1-oe*oe),lt=De*Math.sin(X),_t=Math.tan(Math.PI/4-X/2)/Math.pow((1-lt)/(1+lt),De/2);return X=-k*Math.log(Math.max(_t,1e-10)),new Rt(f.lng*x*k,X)},unproject:function(f){for(var _i,x=180/Math.PI,k=this.R,X=this.R_MINOR/k,oe=Math.sqrt(1-X*X),De=Math.exp(-f.y/k),lt=Math.PI/2-2*Math.atan(De),_t=0,Vt=.1;_t<15&&Math.abs(Vt)>1e-7;_t++)_i=oe*Math.sin(lt),_i=Math.pow((1-_i)/(1+_i),oe/2),lt+=Vt=Math.PI/2-2*Math.atan(De*_i)-lt;return new cr(lt*x,f.x*x/k)}},pv={LonLat:yi,Mercator:fv,SphericalMercator:qn},Be=H({},zr,{code:"EPSG:3395",projection:fv,transformation:function(){var f=.5/(Math.PI*fv.R);return Ui(f,.5,-f,.5)}()}),Hn=H({},zr,{code:"EPSG:4326",projection:yi,transformation:Ui(1/180,1,-1/180,.5)}),pl=H({},mr,{projection:yi,transformation:Ui(1,0,-1,0),scale:function(f){return Math.pow(2,f)},zoom:function(f){return Math.log(f)/Math.LN2},distance:function(f,x){var k=x.lng-f.lng,X=x.lat-f.lat;return Math.sqrt(k*k+X*X)},infinite:!0});mr.Earth=zr,mr.EPSG3395=Be,mr.EPSG3857=O,mr.EPSG900913=Me,mr.EPSG4326=Hn,mr.Simple=pl;var il=Ei.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(f){return f.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(f){return f&&f.removeLayer(this),this},getPane:function(f){return this._map.getPane(f?this.options[f]||f:this.options.pane)},addInteractiveTarget:function(f){return this._map._targets[te(f)]=this,this},removeInteractiveTarget:function(f){return delete this._map._targets[te(f)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(f){var x=f.target;if(x.hasLayer(this)){if(this._map=x,this._zoomAnimated=x._zoomAnimated,this.getEvents){var k=this.getEvents();x.on(k,this),this.once("remove",function(){x.off(k,this)},this)}this.onAdd(x),this.getAttribution&&x.attributionControl&&x.attributionControl.addAttribution(this.getAttribution()),this.fire("add"),x.fire("layeradd",{layer:this})}}});ds.include({addLayer:function(f){if(!f._layerAdd)throw new Error("The provided object is not a Layer.");var x=te(f);return this._layers[x]||(this._layers[x]=f,f._mapToAdd=this,f.beforeAdd&&f.beforeAdd(this),this.whenReady(f._layerAdd,f)),this},removeLayer:function(f){var x=te(f);return this._layers[x]?(this._loaded&&f.onRemove(this),f.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(f.getAttribution()),delete this._layers[x],this._loaded&&(this.fire("layerremove",{layer:f}),f.fire("remove")),f._map=f._mapToAdd=null,this):this},hasLayer:function(f){return!!f&&te(f)in this._layers},eachLayer:function(f,x){for(var k in this._layers)f.call(x,this._layers[k]);return this},_addLayers:function(f){for(var x=0,k=(f=f?Fe(f)?f:[f]:[]).length;x<k;x++)this.addLayer(f[x])},_addZoomLimit:function(f){(isNaN(f.options.maxZoom)||!isNaN(f.options.minZoom))&&(this._zoomBoundLayers[te(f)]=f,this._updateZoomLevels())},_removeZoomLimit:function(f){var x=te(f);this._zoomBoundLayers[x]&&(delete this._zoomBoundLayers[x],this._updateZoomLevels())},_updateZoomLevels:function(){var f=1/0,x=-1/0,k=this._getZoomSpan();for(var X in this._zoomBoundLayers){var oe=this._zoomBoundLayers[X].options;f=void 0===oe.minZoom?f:Math.min(f,oe.minZoom),x=void 0===oe.maxZoom?x:Math.max(x,oe.maxZoom)}this._layersMaxZoom=x===-1/0?void 0:x,this._layersMinZoom=f===1/0?void 0:f,k!==this._getZoomSpan()&&this.fire("zoomlevelschange"),void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var ml=il.extend({initialize:function(f,x){var k,X;if(me(this,x),this._layers={},f)for(k=0,X=f.length;k<X;k++)this.addLayer(f[k])},addLayer:function(f){var x=this.getLayerId(f);return this._layers[x]=f,this._map&&this._map.addLayer(f),this},removeLayer:function(f){var x=f in this._layers?f:this.getLayerId(f);return this._map&&this._layers[x]&&this._map.removeLayer(this._layers[x]),delete this._layers[x],this},hasLayer:function(f){return!!f&&("number"==typeof f?f:this.getLayerId(f))in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(f){var k,X,x=Array.prototype.slice.call(arguments,1);for(k in this._layers)(X=this._layers[k])[f]&&X[f].apply(X,x);return this},onAdd:function(f){this.eachLayer(f.addLayer,f)},onRemove:function(f){this.eachLayer(f.removeLayer,f)},eachLayer:function(f,x){for(var k in this._layers)f.call(x,this._layers[k]);return this},getLayer:function(f){return this._layers[f]},getLayers:function(){var f=[];return this.eachLayer(f.push,f),f},setZIndex:function(f){return this.invoke("setZIndex",f)},getLayerId:function(f){return te(f)}}),Vu=ml.extend({addLayer:function(f){return this.hasLayer(f)?this:(f.addEventParent(this),ml.prototype.addLayer.call(this,f),this.fire("layeradd",{layer:f}))},removeLayer:function(f){return this.hasLayer(f)?(f in this._layers&&(f=this._layers[f]),f.removeEventParent(this),ml.prototype.removeLayer.call(this,f),this.fire("layerremove",{layer:f})):this},setStyle:function(f){return this.invoke("setStyle",f)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var f=new qi;for(var x in this._layers){var k=this._layers[x];f.extend(k.getBounds?k.getBounds():k.getLatLng())}return f}}),Nc=Lt.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0]},initialize:function(f){me(this,f)},createIcon:function(f){return this._createIcon("icon",f)},createShadow:function(f){return this._createIcon("shadow",f)},_createIcon:function(f,x){var k=this._getIconUrl(f);if(!k){if("icon"===f)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var X=this._createImg(k,x&&"IMG"===x.tagName?x:null);return this._setIconStyles(X,f),X},_setIconStyles:function(f,x){var k=this.options,X=k[x+"Size"];"number"==typeof X&&(X=[X,X]);var oe=Ct(X),De=Ct("shadow"===x&&k.shadowAnchor||k.iconAnchor||oe&&oe.divideBy(2,!0));f.className="leaflet-marker-"+x+" "+(k.className||""),De&&(f.style.marginLeft=-De.x+"px",f.style.marginTop=-De.y+"px"),oe&&(f.style.width=oe.x+"px",f.style.height=oe.y+"px")},_createImg:function(f,x){return(x=x||document.createElement("img")).src=f,x},_getIconUrl:function(f){return Rr&&this.options[f+"RetinaUrl"]||this.options[f+"Url"]}});var Nl=Nc.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(f){return Nl.imagePath||(Nl.imagePath=this._detectIconPath()),(this.options.imagePath||Nl.imagePath)+Nc.prototype._getIconUrl.call(this,f)},_detectIconPath:function(){var f=Ps("div","leaflet-default-icon-path",document.body),x=uf(f,"background-image")||uf(f,"backgroundImage");return document.body.removeChild(f),null===x||0!==x.indexOf("url")?"":x.replace(/^url\(["']?/,"").replace(/marker-icon\.png["']?\)$/,"")}}),Wa=Fl.extend({initialize:function(f){this._marker=f},addHooks:function(){var f=this._marker._icon;this._draggable||(this._draggable=new tl(f,f,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),xn(f,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Ao(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(f){var x=this._marker,k=x._map,X=this._marker.options.autoPanSpeed,oe=this._marker.options.autoPanPadding,De=ln(x._icon),lt=k.getPixelBounds(),_t=k.getPixelOrigin(),Vt=bn(lt.min._subtract(_t).add(oe),lt.max._subtract(_t).subtract(oe));if(!Vt.contains(De)){var _i=Ct((Math.max(Vt.max.x,De.x)-Vt.max.x)/(lt.max.x-Vt.max.x)-(Math.min(Vt.min.x,De.x)-Vt.min.x)/(lt.min.x-Vt.min.x),(Math.max(Vt.max.y,De.y)-Vt.max.y)/(lt.max.y-Vt.max.y)-(Math.min(Vt.min.y,De.y)-Vt.min.y)/(lt.min.y-Vt.min.y)).multiplyBy(X);k.panBy(_i,{animate:!1}),this._draggable._newPos._add(_i),this._draggable._startPos._add(_i),Ca(x._icon,this._draggable._newPos),this._onDrag(f),this._panRequest=We(this._adjustPan.bind(this,f))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(f){this._marker.options.autoPan&&(xt(this._panRequest),this._panRequest=We(this._adjustPan.bind(this,f)))},_onDrag:function(f){var x=this._marker,k=x._shadow,X=ln(x._icon),oe=x._map.layerPointToLatLng(X);k&&Ca(k,X),x._latlng=oe,f.latlng=oe,f.oldLatLng=this._oldLatLng,x.fire("move",f).fire("drag",f)},_onDragEnd:function(f){xt(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",f)}}),cn=il.extend({options:{icon:new Nl,interactive:!0,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(f,x){me(this,x),this._latlng=ii(f)},onAdd:function(f){this._zoomAnimated=this._zoomAnimated&&f.options.markerZoomAnimation,this._zoomAnimated&&f.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(f){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&f.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(f){var x=this._latlng;return this._latlng=ii(f),this.update(),this.fire("move",{oldLatLng:x,latlng:this._latlng})},setZIndexOffset:function(f){return this.options.zIndexOffset=f,this.update()},getIcon:function(){return this.options.icon},setIcon:function(f){return this.options.icon=f,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var f=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(f)}return this},_initIcon:function(){var f=this.options,x="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),k=f.icon.createIcon(this._icon),X=!1;k!==this._icon&&(this._icon&&this._removeIcon(),X=!0,f.title&&(k.title=f.title),"IMG"===k.tagName&&(k.alt=f.alt||"")),xn(k,x),f.keyboard&&(k.tabIndex="0"),this._icon=k,f.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var oe=f.icon.createShadow(this._shadow),De=!1;oe!==this._shadow&&(this._removeShadow(),De=!0),oe&&(xn(oe,x),oe.alt=""),this._shadow=oe,f.opacity<1&&this._updateOpacity(),X&&this.getPane().appendChild(this._icon),this._initInteraction(),oe&&De&&this.getPane(f.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),xr(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&xr(this._shadow),this._shadow=null},_setPos:function(f){this._icon&&Ca(this._icon,f),this._shadow&&Ca(this._shadow,f),this._zIndex=f.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(f){this._icon&&(this._icon.style.zIndex=this._zIndex+f)},_animateZoom:function(f){var x=this._map._latLngToNewLayerPoint(this._latlng,f.zoom,f.center).round();this._setPos(x)},_initInteraction:function(){if(this.options.interactive&&(xn(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Wa)){var f=this.options.draggable;this.dragging&&(f=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Wa(this),f&&this.dragging.enable()}},setOpacity:function(f){return this.options.opacity=f,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var f=this.options.opacity;this._icon&&vc(this._icon,f),this._shadow&&vc(this._shadow,f)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});var Yi=il.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(f){this._renderer=f.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(f){return me(this,f),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&f&&Object.prototype.hasOwnProperty.call(f,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+this._renderer.options.tolerance}}),us=Yi.extend({options:{fill:!0,radius:10},initialize:function(f,x){me(this,x),this._latlng=ii(f),this._radius=this.options.radius},setLatLng:function(f){var x=this._latlng;return this._latlng=ii(f),this.redraw(),this.fire("move",{oldLatLng:x,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(f){return this.options.radius=this._radius=f,this.redraw()},getRadius:function(){return this._radius},setStyle:function(f){var x=f&&f.radius||this._radius;return Yi.prototype.setStyle.call(this,f),this.setRadius(x),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var f=this._radius,x=this._radiusY||f,k=this._clickTolerance(),X=[f+k,x+k];this._pxBounds=new ft(this._point.subtract(X),this._point.add(X))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(f){return f.distanceTo(this._point)<=this._radius+this._clickTolerance()}});var _l=us.extend({initialize:function(f,x,k){if("number"==typeof x&&(x=H({},k,{radius:x})),me(this,x),this._latlng=ii(f),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(f){return this._mRadius=f,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var f=[this._radius,this._radiusY||this._radius];return new qi(this._map.layerPointToLatLng(this._point.subtract(f)),this._map.layerPointToLatLng(this._point.add(f)))},setStyle:Yi.prototype.setStyle,_project:function(){var f=this._latlng.lng,x=this._latlng.lat,k=this._map,X=k.options.crs;if(X.distance===zr.distance){var oe=Math.PI/180,De=this._mRadius/zr.R/oe,lt=k.project([x+De,f]),_t=k.project([x-De,f]),Vt=lt.add(_t).divideBy(2),_i=k.unproject(Vt).lat,on=Math.acos((Math.cos(De*oe)-Math.sin(x*oe)*Math.sin(_i*oe))/(Math.cos(x*oe)*Math.cos(_i*oe)))/oe;(isNaN(on)||0===on)&&(on=De/Math.cos(Math.PI/180*x)),this._point=Vt.subtract(k.getPixelOrigin()),this._radius=isNaN(on)?0:Vt.x-k.project([_i,f-on]).x,this._radiusY=Vt.y-lt.y}else{var Ln=X.unproject(X.project(this._latlng).subtract([this._mRadius,0]));this._point=k.latLngToLayerPoint(this._latlng),this._radius=this._point.x-k.latLngToLayerPoint(Ln).x}this._updateBounds()}});var bs=Yi.extend({options:{smoothFactor:1,noClip:!1},initialize:function(f,x){me(this,x),this._setLatLngs(f)},getLatLngs:function(){return this._latlngs},setLatLngs:function(f){return this._setLatLngs(f),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(f){for(var oe,De,x=1/0,k=null,X=am,lt=0,_t=this._parts.length;lt<_t;lt++)for(var Vt=this._parts[lt],_i=1,on=Vt.length;_i<on;_i++){var Ln=X(f,oe=Vt[_i-1],De=Vt[_i],!0);Ln<x&&(x=Ln,k=X(f,oe,De))}return k&&(k.distance=Math.sqrt(x)),k},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var f,x,k,X,oe,De,lt,_t=this._rings[0],Vt=_t.length;if(!Vt)return null;for(f=0,x=0;f<Vt-1;f++)x+=_t[f].distanceTo(_t[f+1])/2;if(0===x)return this._map.layerPointToLatLng(_t[0]);for(f=0,X=0;f<Vt-1;f++)if((X+=k=(oe=_t[f]).distanceTo(De=_t[f+1]))>x)return this._map.layerPointToLatLng([De.x-(lt=(X-x)/k)*(De.x-oe.x),De.y-lt*(De.y-oe.y)])},getBounds:function(){return this._bounds},addLatLng:function(f,x){return x=x||this._defaultShape(),f=ii(f),x.push(f),this._bounds.extend(f),this.redraw()},_setLatLngs:function(f){this._bounds=new qi,this._latlngs=this._convertLatLngs(f)},_defaultShape:function(){return ei(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(f){for(var x=[],k=ei(f),X=0,oe=f.length;X<oe;X++)k?(x[X]=ii(f[X]),this._bounds.extend(x[X])):x[X]=this._convertLatLngs(f[X]);return x},_project:function(){var f=new ft;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,f),this._bounds.isValid()&&f.isValid()&&(this._rawPxBounds=f,this._updateBounds())},_updateBounds:function(){var f=this._clickTolerance(),x=new Rt(f,f);this._pxBounds=new ft([this._rawPxBounds.min.subtract(x),this._rawPxBounds.max.add(x)])},_projectLatlngs:function(f,x,k){var De,lt,oe=f.length;if(f[0]instanceof cr){for(lt=[],De=0;De<oe;De++)lt[De]=this._map.latLngToLayerPoint(f[De]),k.extend(lt[De]);x.push(lt)}else for(De=0;De<oe;De++)this._projectLatlngs(f[De],x,k)},_clipPoints:function(){var f=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(f)){if(this.options.noClip)return void(this._parts=this._rings);var k,X,oe,De,lt,_t,Vt,x=this._parts;for(k=0,oe=0,De=this._rings.length;k<De;k++)for(X=0,lt=(Vt=this._rings[k]).length;X<lt-1;X++)(_t=Yg(Vt[X],Vt[X+1],f,X,!0))&&(x[oe]=x[oe]||[],x[oe].push(_t[0]),(_t[1]!==Vt[X+1]||X===lt-2)&&(x[oe].push(_t[1]),oe++))}},_simplifyPoints:function(){for(var f=this._parts,x=this.options.smoothFactor,k=0,X=f.length;k<X;k++)f[k]=Ur(f[k],x)},_update:function(){!this._map||(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(f,x){var k,X,oe,De,lt,_t,Vt=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(f))return!1;for(k=0,De=this._parts.length;k<De;k++)for(X=0,oe=(lt=(_t=this._parts[k]).length)-1;X<lt;oe=X++)if((x||0!==X)&&uv(f,_t[oe],_t[X])<=Vt)return!0;return!1}});bs._flat=hv;var ho=bs.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var f,x,k,X,oe,De,lt,_t,_i=this._rings[0],on=_i.length;if(!on)return null;for(De=lt=_t=0,f=0,x=on-1;f<on;x=f++)lt+=((k=_i[f]).x+(X=_i[x]).x)*(oe=k.y*X.x-X.y*k.x),_t+=(k.y+X.y)*oe,De+=3*oe;return this._map.layerPointToLatLng(0===De?_i[0]:[lt/De,_t/De])},_convertLatLngs:function(f){var x=bs.prototype._convertLatLngs.call(this,f),k=x.length;return k>=2&&x[0]instanceof cr&&x[0].equals(x[k-1])&&x.pop(),x},_setLatLngs:function(f){bs.prototype._setLatLngs.call(this,f),ei(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return ei(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var f=this._renderer._bounds,x=this.options.weight,k=new Rt(x,x);if(f=new ft(f.min.subtract(k),f.max.add(k)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(f)){if(this.options.noClip)return void(this._parts=this._rings);for(var De,X=0,oe=this._rings.length;X<oe;X++)(De=lm(this._rings[X],f,!0)).length&&this._parts.push(De)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(f){var k,X,oe,De,lt,_t,Vt,_i,x=!1;if(!this._pxBounds||!this._pxBounds.contains(f))return!1;for(De=0,Vt=this._parts.length;De<Vt;De++)for(lt=0,_t=(_i=(k=this._parts[De]).length)-1;lt<_i;_t=lt++)(X=k[lt]).y>f.y!=(oe=k[_t]).y>f.y&&f.x<(oe.x-X.x)*(f.y-X.y)/(oe.y-X.y)+X.x&&(x=!x);return x||bs.prototype._containsPoint.call(this,f,!0)}});var Ne=Vu.extend({initialize:function(f,x){me(this,x),this._layers={},f&&this.addData(f)},addData:function(f){var k,X,oe,x=Fe(f)?f:f.features;if(x){for(k=0,X=x.length;k<X;k++)((oe=x[k]).geometries||oe.geometry||oe.features||oe.coordinates)&&this.addData(oe);return this}var De=this.options;if(De.filter&&!De.filter(f))return this;var lt=Gr(f,De);return lt?(lt.feature=wc(f),lt.defaultOptions=lt.options,this.resetStyle(lt),De.onEachFeature&&De.onEachFeature(f,lt),this.addLayer(lt)):this},resetStyle:function(f){return void 0===f?this.eachLayer(this.resetStyle,this):(f.options=H({},f.defaultOptions),this._setLayerStyle(f,this.options.style),this)},setStyle:function(f){return this.eachLayer(function(x){this._setLayerStyle(x,f)},this)},_setLayerStyle:function(f,x){f.setStyle&&("function"==typeof x&&(x=x(f.feature)),f.setStyle(x))}});function Gr(f,x){var _t,Vt,_i,on,k="Feature"===f.type?f.geometry:f,X=k?k.coordinates:null,oe=[],De=x&&x.pointToLayer,lt=x&&x.coordsToLatLng||Ma;if(!X&&!k)return null;switch(k.type){case"Point":return sp(De,f,_t=lt(X),x);case"MultiPoint":for(_i=0,on=X.length;_i<on;_i++)_t=lt(X[_i]),oe.push(sp(De,f,_t,x));return new Vu(oe);case"LineString":case"MultiLineString":return Vt=bc(X,"LineString"===k.type?0:1,lt),new bs(Vt,x);case"Polygon":case"MultiPolygon":return Vt=bc(X,"Polygon"===k.type?1:2,lt),new ho(Vt,x);case"GeometryCollection":for(_i=0,on=k.geometries.length;_i<on;_i++){var Ln=Gr({geometry:k.geometries[_i],type:"Feature",properties:f.properties},x);Ln&&oe.push(Ln)}return new Vu(oe);default:throw new Error("Invalid GeoJSON object.")}}function sp(f,x,k,X){return f?f(x,k):new cn(k,X&&X.markersInheritOptions&&X)}function Ma(f){return new cr(f[1],f[0],f[2])}function bc(f,x,k){for(var lt,X=[],oe=0,De=f.length;oe<De;oe++)lt=x?bc(f[oe],x-1,k):(k||Ma)(f[oe]),X.push(lt);return X}function xc(f,x){return x="number"==typeof x?x:6,void 0!==f.alt?[ae(f.lng,x),ae(f.lat,x),ae(f.alt,x)]:[ae(f.lng,x),ae(f.lat,x)]}function ja(f,x,k,X){for(var oe=[],De=0,lt=f.length;De<lt;De++)oe.push(x?ja(f[De],x-1,k,X):xc(f[De],X));return!x&&k&&oe.push(oe[0]),oe}function sc(f,x){return f.feature?H({},f.feature,{geometry:x}):wc(x)}function wc(f){return"Feature"===f.type||"FeatureCollection"===f.type?f:{type:"Feature",properties:{},geometry:f}}var nl={toGeoJSON:function(f){return sc(this,{type:"Point",coordinates:xc(this.getLatLng(),f)})}};function Is(f,x){return new Ne(f,x)}cn.include(nl),_l.include(nl),us.include(nl),bs.include({toGeoJSON:function(f){var x=!ei(this._latlngs);return sc(this,{type:(x?"Multi":"")+"LineString",coordinates:ja(this._latlngs,x?1:0,!1,f)})}}),ho.include({toGeoJSON:function(f){var x=!ei(this._latlngs),k=x&&!ei(this._latlngs[0]),X=ja(this._latlngs,k?2:x?1:0,!0,f);return x||(X=[X]),sc(this,{type:(k?"Multi":"")+"Polygon",coordinates:X})}}),ml.include({toMultiPoint:function(f){var x=[];return this.eachLayer(function(k){x.push(k.toGeoJSON(f).geometry.coordinates)}),sc(this,{type:"MultiPoint",coordinates:x})},toGeoJSON:function(f){var x=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===x)return this.toMultiPoint(f);var k="GeometryCollection"===x,X=[];return this.eachLayer(function(oe){if(oe.toGeoJSON){var De=oe.toGeoJSON(f);if(k)X.push(De.geometry);else{var lt=wc(De);"FeatureCollection"===lt.type?X.push.apply(X,lt.features):X.push(lt)}}}),k?sc(this,{geometries:X,type:"GeometryCollection"}):{type:"FeatureCollection",features:X}}});var dd=Is,zu=il.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(f,x,k){this._url=f,this._bounds=Fi(x),me(this,k)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(xn(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){xr(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(f){return this.options.opacity=f,this._image&&this._updateOpacity(),this},setStyle:function(f){return f.opacity&&this.setOpacity(f.opacity),this},bringToFront:function(){return this._map&&Qr(this._image),this},bringToBack:function(){return this._map&&yh(this._image),this},setUrl:function(f){return this._url=f,this._image&&(this._image.src=f),this},setBounds:function(f){return this._bounds=Fi(f),this._map&&this._reset(),this},getEvents:function(){var f={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(f.zoomanim=this._animateZoom),f},setZIndex:function(f){return this.options.zIndex=f,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var f="IMG"===this._url.tagName,x=this._image=f?this._url:Ps("img");xn(x,"leaflet-image-layer"),this._zoomAnimated&&xn(x,"leaflet-zoom-animated"),this.options.className&&xn(x,this.options.className),x.onselectstart=be,x.onmousemove=be,x.onload=V(this.fire,this,"load"),x.onerror=V(this._overlayOnError,this,"error"),(this.options.crossOrigin||""===this.options.crossOrigin)&&(x.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),f?this._url=x.src:(x.src=this._url,x.alt=this.options.alt)},_animateZoom:function(f){var x=this._map.getZoomScale(f.zoom),k=this._map._latLngBoundsToNewLayerBounds(this._bounds,f.zoom,f.center).min;Nu(this._image,k,x)},_reset:function(){var f=this._image,x=new ft(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),k=x.getSize();Ca(f,x.min),f.style.width=k.x+"px",f.style.height=k.y+"px"},_updateOpacity:function(){vc(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&null!=this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var f=this.options.errorOverlayUrl;f&&this._url!==f&&(this._url=f,this._image.src=f)}}),oc=zu.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1},_initImage:function(){var f="VIDEO"===this._url.tagName,x=this._image=f?this._url:Ps("video");if(xn(x,"leaflet-image-layer"),this._zoomAnimated&&xn(x,"leaflet-zoom-animated"),this.options.className&&xn(x,this.options.className),x.onselectstart=be,x.onmousemove=be,x.onloadeddata=V(this.fire,this,"load"),f){for(var k=x.getElementsByTagName("source"),X=[],oe=0;oe<k.length;oe++)X.push(k[oe].src);this._url=k.length>0?X:[x.src]}else{Fe(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(x.style,"objectFit")&&(x.style.objectFit="fill"),x.autoplay=!!this.options.autoplay,x.loop=!!this.options.loop,x.muted=!!this.options.muted;for(var De=0;De<this._url.length;De++){var lt=Ps("source");lt.src=this._url[De],x.appendChild(lt)}}}});var gu=zu.extend({_initImage:function(){var f=this._image=this._url;xn(f,"leaflet-image-layer"),this._zoomAnimated&&xn(f,"leaflet-zoom-animated"),this.options.className&&xn(f,this.options.className),f.onselectstart=be,f.onmousemove=be}});var qa=il.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(f,x){me(this,f),this._source=x},onAdd:function(f){this._zoomAnimated=f._zoomAnimated,this._container||this._initLayout(),f._fadeAnimated&&vc(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),f._fadeAnimated&&vc(this._container,1),this.bringToFront()},onRemove:function(f){f._fadeAnimated?(vc(this._container,0),this._removeTimeout=setTimeout(V(xr,void 0,this._container),200)):xr(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(f){return this._latlng=ii(f),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(f){return this._content=f,this.update(),this},getElement:function(){return this._container},update:function(){!this._map||(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var f={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(f.zoomanim=this._animateZoom),f},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Qr(this._container),this},bringToBack:function(){return this._map&&yh(this._container),this},_prepareOpen:function(f,x,k){if(x instanceof il||(k=x,x=f),x instanceof Vu)for(var X in f._layers){x=f._layers[X];break}if(!k)if(x.getCenter)k=x.getCenter();else{if(!x.getLatLng)throw new Error("Unable to get source layer LatLng.");k=x.getLatLng()}return this._source=x,this.update(),k},_updateContent:function(){if(this._content){var f=this._contentNode,x="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof x)f.innerHTML=x;else{for(;f.hasChildNodes();)f.removeChild(f.firstChild);f.appendChild(x)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var f=this._map.latLngToLayerPoint(this._latlng),x=Ct(this.options.offset),k=this._getAnchor();this._zoomAnimated?Ca(this._container,f.add(k)):x=x.add(f).add(k);var X=this._containerBottom=-x.y,oe=this._containerLeft=-Math.round(this._containerWidth/2)+x.x;this._container.style.bottom=X+"px",this._container.style.left=oe+"px"}},_getAnchor:function(){return[0,0]}}),pf=qa.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(f){return f.openPopup(this),this},onAdd:function(f){qa.prototype.onAdd.call(this,f),f.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Yi||this._source.on("preclick",Ga))},onRemove:function(f){qa.prototype.onRemove.call(this,f),f.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Yi||this._source.off("preclick",Ga))},getEvents:function(){var f=qa.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(f.preclick=this._close),this.options.keepInView&&(f.moveend=this._adjustPan),f},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var f="leaflet-popup",x=this._container=Ps("div",f+" "+(this.options.className||"")+" leaflet-zoom-animated"),k=this._wrapper=Ps("div",f+"-content-wrapper",x);if(this._contentNode=Ps("div",f+"-content",k),Gg(x),So(this._contentNode),zn(x,"contextmenu",Ga),this._tipContainer=Ps("div",f+"-tip-container",x),this._tip=Ps("div",f+"-tip",this._tipContainer),this.options.closeButton){var X=this._closeButton=Ps("a",f+"-close-button",x);X.href="#close",X.innerHTML="&#215;",zn(X,"click",this._onCloseButtonClick,this)}},_updateLayout:function(){var f=this._contentNode,x=f.style;x.width="",x.whiteSpace="nowrap";var k=f.offsetWidth;k=Math.min(k,this.options.maxWidth),k=Math.max(k,this.options.minWidth),x.width=k+1+"px",x.whiteSpace="",x.height="";var oe=this.options.maxHeight,De="leaflet-popup-scrolled";oe&&f.offsetHeight>oe?(x.height=oe+"px",xn(f,De)):Ao(f,De),this._containerWidth=this._container.offsetWidth},_animateZoom:function(f){var x=this._map._latLngToNewLayerPoint(this._latlng,f.zoom,f.center),k=this._getAnchor();Ca(this._container,x.add(k))},_adjustPan:function(){if(this.options.autoPan){this._map._panAnim&&this._map._panAnim.stop();var f=this._map,x=parseInt(uf(this._container,"marginBottom"),10)||0,k=this._container.offsetHeight+x,X=this._containerWidth,oe=new Rt(this._containerLeft,-k-this._containerBottom);oe._add(ln(this._container));var De=f.layerPointToContainerPoint(oe),lt=Ct(this.options.autoPanPadding),_t=Ct(this.options.autoPanPaddingTopLeft||lt),Vt=Ct(this.options.autoPanPaddingBottomRight||lt),_i=f.getSize(),on=0,Ln=0;De.x+X+Vt.x>_i.x&&(on=De.x+X-_i.x+Vt.x),De.x-on-_t.x<0&&(on=De.x-_t.x),De.y+k+Vt.y>_i.y&&(Ln=De.y+k-_i.y+Vt.y),De.y-Ln-_t.y<0&&(Ln=De.y-_t.y),(on||Ln)&&f.fire("autopanstart").panBy([on,Ln])}},_onCloseButtonClick:function(f){this._close(),ld(f)},_getAnchor:function(){return Ct(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}});ds.mergeOptions({closePopupOnClick:!0}),ds.include({openPopup:function(f,x,k){return f instanceof pf||(f=new pf(k).setContent(f)),x&&f.setLatLng(x),this.hasLayer(f)?this:(this._popup&&this._popup.options.autoClose&&this.closePopup(),this._popup=f,this.addLayer(f))},closePopup:function(f){return(!f||f===this._popup)&&(f=this._popup,this._popup=null),f&&this.removeLayer(f),this}}),il.include({bindPopup:function(f,x){return f instanceof pf?(me(f,x),this._popup=f,f._source=this):((!this._popup||x)&&(this._popup=new pf(x,this)),this._popup.setContent(f)),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(f,x){return this._popup&&this._map&&(x=this._popup._prepareOpen(this,f,x),this._map.openPopup(this._popup,x)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(f){return this._popup&&(this._popup._map?this.closePopup():this.openPopup(f)),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(f){return this._popup&&this._popup.setContent(f),this},getPopup:function(){return this._popup},_openPopup:function(f){var x=f.layer||f.target;if(this._popup&&this._map){if(ld(f),x instanceof Yi)return void this.openPopup(f.layer||f.target,f.latlng);this._map.hasLayer(this._popup)&&this._popup._source===x?this.closePopup():this.openPopup(x,f.latlng)}},_movePopup:function(f){this._popup.setLatLng(f.latlng)},_onKeyPress:function(f){13===f.originalEvent.keyCode&&this._openPopup(f)}});var fd=qa.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,interactive:!1,opacity:.9},onAdd:function(f){qa.prototype.onAdd.call(this,f),this.setOpacity(this.options.opacity),f.fire("tooltipopen",{tooltip:this}),this._source&&this._source.fire("tooltipopen",{tooltip:this},!0)},onRemove:function(f){qa.prototype.onRemove.call(this,f),f.fire("tooltipclose",{tooltip:this}),this._source&&this._source.fire("tooltipclose",{tooltip:this},!0)},getEvents:function(){var f=qa.prototype.getEvents.call(this);return Xi&&!this.options.permanent&&(f.preclick=this._close),f},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){this._contentNode=this._container=Ps("div","leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(f){var x,k,X=this._map,oe=this._container,De=X.latLngToContainerPoint(X.getCenter()),lt=X.layerPointToContainerPoint(f),_t=this.options.direction,Vt=oe.offsetWidth,_i=oe.offsetHeight,on=Ct(this.options.offset),Ln=this._getAnchor();"top"===_t?(x=Vt/2,k=_i):"bottom"===_t?(x=Vt/2,k=0):"center"===_t?(x=Vt/2,k=_i/2):"right"===_t?(x=0,k=_i/2):"left"===_t?(x=Vt,k=_i/2):lt.x<De.x?(_t="right",x=0,k=_i/2):(_t="left",x=Vt+2*(on.x+Ln.x),k=_i/2),f=f.subtract(Ct(x,k,!0)).add(on).add(Ln),Ao(oe,"leaflet-tooltip-right"),Ao(oe,"leaflet-tooltip-left"),Ao(oe,"leaflet-tooltip-top"),Ao(oe,"leaflet-tooltip-bottom"),xn(oe,"leaflet-tooltip-"+_t),Ca(oe,f)},_updatePosition:function(){var f=this._map.latLngToLayerPoint(this._latlng);this._setPosition(f)},setOpacity:function(f){this.options.opacity=f,this._container&&vc(this._container,f)},_animateZoom:function(f){var x=this._map._latLngToNewLayerPoint(this._latlng,f.zoom,f.center);this._setPosition(x)},_getAnchor:function(){return Ct(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}});ds.include({openTooltip:function(f,x,k){return f instanceof fd||(f=new fd(k).setContent(f)),x&&f.setLatLng(x),this.hasLayer(f)?this:this.addLayer(f)},closeTooltip:function(f){return f&&this.removeLayer(f),this}}),il.include({bindTooltip:function(f,x){return f instanceof fd?(me(f,x),this._tooltip=f,f._source=this):((!this._tooltip||x)&&(this._tooltip=new fd(x,this)),this._tooltip.setContent(f)),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(f){if(f||!this._tooltipHandlersAdded){var x=f?"off":"on",k={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?k.add=this._openTooltip:(k.mouseover=this._openTooltip,k.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(k.mousemove=this._moveTooltip),Xi&&(k.click=this._openTooltip)),this[x](k),this._tooltipHandlersAdded=!f}},openTooltip:function(f,x){return this._tooltip&&this._map&&(x=this._tooltip._prepareOpen(this,f,x),this._map.openTooltip(this._tooltip,x),this._tooltip.options.interactive&&this._tooltip._container&&(xn(this._tooltip._container,"leaflet-clickable"),this.addInteractiveTarget(this._tooltip._container))),this},closeTooltip:function(){return this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive&&this._tooltip._container&&(Ao(this._tooltip._container,"leaflet-clickable"),this.removeInteractiveTarget(this._tooltip._container))),this},toggleTooltip:function(f){return this._tooltip&&(this._tooltip._map?this.closeTooltip():this.openTooltip(f)),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(f){return this._tooltip&&this._tooltip.setContent(f),this},getTooltip:function(){return this._tooltip},_openTooltip:function(f){!this._tooltip||!this._map||this.openTooltip(f.layer||f.target,this._tooltip.options.sticky?f.latlng:void 0)},_moveTooltip:function(f){var k,X,x=f.latlng;this._tooltip.options.sticky&&f.originalEvent&&(k=this._map.mouseEventToContainerPoint(f.originalEvent),X=this._map.containerPointToLayerPoint(k),x=this._map.layerPointToLatLng(X)),this._tooltip.setLatLng(x)}});var vh=Nc.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(f){var x=f&&"DIV"===f.tagName?f:document.createElement("div"),k=this.options;if(k.html instanceof Element?(uo(x),x.appendChild(k.html)):x.innerHTML=!1!==k.html?k.html:"",k.bgPos){var X=Ct(k.bgPos);x.style.backgroundPosition=-X.x+"px "+-X.y+"px"}return this._setIconStyles(x,"icon"),x},createShadow:function(){return null}});Nc.Default=Nl;var mf=il.extend({options:{tileSize:256,opacity:1,updateWhenIdle:st,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(f){me(this,f)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView(),this._update()},beforeAdd:function(f){f._addZoomLimit(this)},onRemove:function(f){this._removeAllTiles(),xr(this._container),f._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Qr(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(yh(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(f){return this.options.opacity=f,this._updateOpacity(),this},setZIndex:function(f){return this.options.zIndex=f,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllTiles(),this._update()),this},getEvents:function(){var f={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=Q(this._onMoveEnd,this.options.updateInterval,this)),f.move=this._onMove),this._zoomAnimated&&(f.zoomanim=this._animateZoom),f},createTile:function(){return document.createElement("div")},getTileSize:function(){var f=this.options.tileSize;return f instanceof Rt?f:new Rt(f,f)},_updateZIndex:function(){this._container&&null!=this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(f){for(var De,x=this.getPane().children,k=-f(-1/0,1/0),X=0,oe=x.length;X<oe;X++)De=x[X].style.zIndex,x[X]!==this._container&&De&&(k=f(k,+De));isFinite(k)&&(this.options.zIndex=k+f(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Tt){vc(this._container,this.options.opacity);var f=+new Date,x=!1,k=!1;for(var X in this._tiles){var oe=this._tiles[X];if(oe.current&&oe.loaded){var De=Math.min(1,(f-oe.loaded)/200);vc(oe.el,De),De<1?x=!0:(oe.active?k=!0:this._onOpaqueTile(oe),oe.active=!0)}}k&&!this._noPrune&&this._pruneTiles(),x&&(xt(this._fadeFrame),this._fadeFrame=We(this._updateOpacity,this))}},_onOpaqueTile:be,_initContainer:function(){this._container||(this._container=Ps("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var f=this._tileZoom,x=this.options.maxZoom;if(void 0!==f){for(var k in this._levels)k=Number(k),this._levels[k].el.children.length||k===f?(this._levels[k].el.style.zIndex=x-Math.abs(f-k),this._onUpdateLevel(k)):(xr(this._levels[k].el),this._removeTilesAtZoom(k),this._onRemoveLevel(k),delete this._levels[k]);var X=this._levels[f],oe=this._map;return X||((X=this._levels[f]={}).el=Ps("div","leaflet-tile-container leaflet-zoom-animated",this._container),X.el.style.zIndex=x,X.origin=oe.project(oe.unproject(oe.getPixelOrigin()),f).round(),X.zoom=f,this._setZoomTransform(X,oe.getCenter(),oe.getZoom()),this._onCreateLevel(X)),this._level=X,X}},_onUpdateLevel:be,_onRemoveLevel:be,_onCreateLevel:be,_pruneTiles:function(){if(this._map){var f,x,k=this._map.getZoom();if(k>this.options.maxZoom||k<this.options.minZoom)return void this._removeAllTiles();for(f in this._tiles)(x=this._tiles[f]).retain=x.current;for(f in this._tiles)if((x=this._tiles[f]).current&&!x.active){var X=x.coords;this._retainParent(X.x,X.y,X.z,X.z-5)||this._retainChildren(X.x,X.y,X.z,X.z+2)}for(f in this._tiles)this._tiles[f].retain||this._removeTile(f)}},_removeTilesAtZoom:function(f){for(var x in this._tiles)this._tiles[x].coords.z===f&&this._removeTile(x)},_removeAllTiles:function(){for(var f in this._tiles)this._removeTile(f)},_invalidateAll:function(){for(var f in this._levels)xr(this._levels[f].el),this._onRemoveLevel(Number(f)),delete this._levels[f];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(f,x,k,X){var oe=Math.floor(f/2),De=Math.floor(x/2),lt=k-1,_t=new Rt(+oe,+De);_t.z=+lt;var Vt=this._tileCoordsToKey(_t),_i=this._tiles[Vt];return _i&&_i.active?(_i.retain=!0,!0):(_i&&_i.loaded&&(_i.retain=!0),lt>X&&this._retainParent(oe,De,lt,X))},_retainChildren:function(f,x,k,X){for(var oe=2*f;oe<2*f+2;oe++)for(var De=2*x;De<2*x+2;De++){var lt=new Rt(oe,De);lt.z=k+1;var _t=this._tileCoordsToKey(lt),Vt=this._tiles[_t];Vt&&Vt.active?Vt.retain=!0:(Vt&&Vt.loaded&&(Vt.retain=!0),k+1<X&&this._retainChildren(oe,De,k+1,X))}},_resetView:function(f){var x=f&&(f.pinch||f.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),x,x)},_animateZoom:function(f){this._setView(f.center,f.zoom,!0,f.noUpdate)},_clampZoom:function(f){var x=this.options;return void 0!==x.minNativeZoom&&f<x.minNativeZoom?x.minNativeZoom:void 0!==x.maxNativeZoom&&x.maxNativeZoom<f?x.maxNativeZoom:f},_setView:function(f,x,k,X){var oe=Math.round(x);oe=void 0!==this.options.maxZoom&&oe>this.options.maxZoom||void 0!==this.options.minZoom&&oe<this.options.minZoom?void 0:this._clampZoom(oe),(!X||this.options.updateWhenZooming&&oe!==this._tileZoom)&&(this._tileZoom=oe,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==oe&&this._update(f),k||this._pruneTiles(),this._noPrune=!!k),this._setZoomTransforms(f,x)},_setZoomTransforms:function(f,x){for(var k in this._levels)this._setZoomTransform(this._levels[k],f,x)},_setZoomTransform:function(f,x,k){var X=this._map.getZoomScale(k,f.zoom),oe=f.origin.multiplyBy(X).subtract(this._map._getNewPixelOrigin(x,k)).round();pe?Nu(f.el,oe,X):Ca(f.el,oe)},_resetGrid:function(){var f=this._map,x=f.options.crs,k=this._tileSize=this.getTileSize(),X=this._tileZoom,oe=this._map.getPixelWorldBounds(this._tileZoom);oe&&(this._globalTileRange=this._pxBoundsToTileRange(oe)),this._wrapX=x.wrapLng&&!this.options.noWrap&&[Math.floor(f.project([0,x.wrapLng[0]],X).x/k.x),Math.ceil(f.project([0,x.wrapLng[1]],X).x/k.y)],this._wrapY=x.wrapLat&&!this.options.noWrap&&[Math.floor(f.project([x.wrapLat[0],0],X).y/k.x),Math.ceil(f.project([x.wrapLat[1],0],X).y/k.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(f){var x=this._map,k=x._animatingZoom?Math.max(x._animateToZoom,x.getZoom()):x.getZoom(),X=x.getZoomScale(k,this._tileZoom),oe=x.project(f,this._tileZoom).floor(),De=x.getSize().divideBy(2*X);return new ft(oe.subtract(De),oe.add(De))},_update:function(f){var x=this._map;if(x){var k=this._clampZoom(x.getZoom());if(void 0===f&&(f=x.getCenter()),void 0!==this._tileZoom){var X=this._getTiledPixelBounds(f),oe=this._pxBoundsToTileRange(X),De=oe.getCenter(),lt=[],_t=this.options.keepBuffer,Vt=new ft(oe.getBottomLeft().subtract([_t,-_t]),oe.getTopRight().add([_t,-_t]));if(!(isFinite(oe.min.x)&&isFinite(oe.min.y)&&isFinite(oe.max.x)&&isFinite(oe.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var _i in this._tiles){var on=this._tiles[_i].coords;(on.z!==this._tileZoom||!Vt.contains(new Rt(on.x,on.y)))&&(this._tiles[_i].current=!1)}if(Math.abs(k-this._tileZoom)>1)return void this._setView(f,k);for(var Ln=oe.min.y;Ln<=oe.max.y;Ln++)for(var ps=oe.min.x;ps<=oe.max.x;ps++){var Hc=new Rt(ps,Ln);if(Hc.z=this._tileZoom,this._isValidTile(Hc)){var fo=this._tiles[this._tileCoordsToKey(Hc)];fo?fo.current=!0:lt.push(Hc)}}if(lt.sort(function(Wu,zo){return Wu.distanceTo(De)-zo.distanceTo(De)}),0!==lt.length){this._loading||(this._loading=!0,this.fire("loading"));var bf=document.createDocumentFragment();for(ps=0;ps<lt.length;ps++)this._addTile(lt[ps],bf);this._level.el.appendChild(bf)}}}},_isValidTile:function(f){var x=this._map.options.crs;if(!x.infinite){var k=this._globalTileRange;if(!x.wrapLng&&(f.x<k.min.x||f.x>k.max.x)||!x.wrapLat&&(f.y<k.min.y||f.y>k.max.y))return!1}if(!this.options.bounds)return!0;var X=this._tileCoordsToBounds(f);return Fi(this.options.bounds).overlaps(X)},_keyToBounds:function(f){return this._tileCoordsToBounds(this._keyToTileCoords(f))},_tileCoordsToNwSe:function(f){var x=this._map,k=this.getTileSize(),X=f.scaleBy(k),oe=X.add(k);return[x.unproject(X,f.z),x.unproject(oe,f.z)]},_tileCoordsToBounds:function(f){var x=this._tileCoordsToNwSe(f),k=new qi(x[0],x[1]);return this.options.noWrap||(k=this._map.wrapLatLngBounds(k)),k},_tileCoordsToKey:function(f){return f.x+":"+f.y+":"+f.z},_keyToTileCoords:function(f){var x=f.split(":"),k=new Rt(+x[0],+x[1]);return k.z=+x[2],k},_removeTile:function(f){var x=this._tiles[f];!x||(xr(x.el),delete this._tiles[f],this.fire("tileunload",{tile:x.el,coords:this._keyToTileCoords(f)}))},_initTile:function(f){xn(f,"leaflet-tile");var x=this.getTileSize();f.style.width=x.x+"px",f.style.height=x.y+"px",f.onselectstart=be,f.onmousemove=be,Tt&&this.options.opacity<1&&vc(f,this.options.opacity),ri&&!di&&(f.style.WebkitBackfaceVisibility="hidden")},_addTile:function(f,x){var k=this._getTilePos(f),X=this._tileCoordsToKey(f),oe=this.createTile(this._wrapCoords(f),V(this._tileReady,this,f));this._initTile(oe),this.createTile.length<2&&We(V(this._tileReady,this,f,null,oe)),Ca(oe,k),this._tiles[X]={el:oe,coords:f,current:!0},x.appendChild(oe),this.fire("tileloadstart",{tile:oe,coords:f})},_tileReady:function(f,x,k){x&&this.fire("tileerror",{error:x,tile:k,coords:f});var X=this._tileCoordsToKey(f);(k=this._tiles[X])&&(k.loaded=+new Date,this._map._fadeAnimated?(vc(k.el,0),xt(this._fadeFrame),this._fadeFrame=We(this._updateOpacity,this)):(k.active=!0,this._pruneTiles()),x||(xn(k.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:k.el,coords:f})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Tt||!this._map._fadeAnimated?We(this._pruneTiles,this):setTimeout(V(this._pruneTiles,this),250)))},_getTilePos:function(f){return f.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(f){var x=new Rt(this._wrapX?he(f.x,this._wrapX):f.x,this._wrapY?he(f.y,this._wrapY):f.y);return x.z=f.z,x},_pxBoundsToTileRange:function(f){var x=this.getTileSize();return new ft(f.min.unscaleBy(x).floor(),f.max.unscaleBy(x).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var f in this._tiles)if(!this._tiles[f].loaded)return!1;return!0}});var _f=mf.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(f,x){this._url=f,(x=me(this,x)).detectRetina&&Rr&&x.maxZoom>0&&(x.tileSize=Math.floor(x.tileSize/2),x.zoomReverse?(x.zoomOffset--,x.minZoom++):(x.zoomOffset++,x.maxZoom--),x.minZoom=Math.max(0,x.minZoom)),"string"==typeof x.subdomains&&(x.subdomains=x.subdomains.split("")),ri||this.on("tileunload",this._onTileRemove)},setUrl:function(f,x){return this._url===f&&void 0===x&&(x=!0),this._url=f,x||this.redraw(),this},createTile:function(f,x){var k=document.createElement("img");return zn(k,"load",V(this._tileOnLoad,this,x,k)),zn(k,"error",V(this._tileOnError,this,x,k)),(this.options.crossOrigin||""===this.options.crossOrigin)&&(k.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),k.alt="",k.setAttribute("role","presentation"),k.src=this.getTileUrl(f),k},getTileUrl:function(f){var x={r:Rr?"@2x":"",s:this._getSubdomain(f),x:f.x,y:f.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var k=this._globalTileRange.max.y-f.y;this.options.tms&&(x.y=k),x["-y"]=k}return we(this._url,H(x,this.options))},_tileOnLoad:function(f,x){Tt?setTimeout(V(f,this,null,x),0):f(null,x)},_tileOnError:function(f,x,k){var X=this.options.errorTileUrl;X&&x.getAttribute("src")!==X&&(x.src=X),f(k,x)},_onTileRemove:function(f){f.tile.onload=null},_getZoomForUrl:function(){var f=this._tileZoom;return this.options.zoomReverse&&(f=this.options.maxZoom-f),f+this.options.zoomOffset},_getSubdomain:function(f){var x=Math.abs(f.x+f.y)%this.options.subdomains.length;return this.options.subdomains[x]},_abortLoading:function(){var f,x;for(f in this._tiles)this._tiles[f].coords.z!==this._tileZoom&&((x=this._tiles[f].el).onload=be,x.onerror=be,x.complete||(x.src=it,xr(x),delete this._tiles[f]))},_removeTile:function(f){var x=this._tiles[f];if(x)return Hi||x.el.setAttribute("src",it),mf.prototype._removeTile.call(this,f)},_tileReady:function(f,x,k){if(this._map&&(!k||k.getAttribute("src")!==it))return mf.prototype._tileReady.call(this,f,x,k)}});function Kg(f,x){return new _f(f,x)}var gv=_f.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(f,x){this._url=f;var k=H({},this.defaultWmsParams);for(var X in x)X in this.options||(k[X]=x[X]);var oe=(x=me(this,x)).detectRetina&&Rr?2:1,De=this.getTileSize();k.width=De.x*oe,k.height=De.y*oe,this.wmsParams=k},onAdd:function(f){this._crs=this.options.crs||f.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version),this.wmsParams[this._wmsVersion>=1.3?"crs":"srs"]=this._crs.code,_f.prototype.onAdd.call(this,f)},getTileUrl:function(f){var x=this._tileCoordsToNwSe(f),k=this._crs,X=bn(k.project(x[0]),k.project(x[1])),oe=X.min,De=X.max,lt=(this._wmsVersion>=1.3&&this._crs===Hn?[oe.y,oe.x,De.y,De.x]:[oe.x,oe.y,De.x,De.y]).join(","),_t=_f.prototype.getTileUrl.call(this,f);return _t+G(this.wmsParams,_t,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+lt},setParams:function(f,x){return H(this.wmsParams,f),x||this.redraw(),this}});_f.WMS=gv,Kg.wms=function yf(f,x){return new gv(f,x)};var Mn=il.extend({options:{padding:.1,tolerance:0},initialize:function(f){me(this,f),te(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&xn(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var f={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(f.zoomanim=this._onAnimZoom),f},_onAnimZoom:function(f){this._updateTransform(f.center,f.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(f,x){var k=this._map.getZoomScale(x,this._zoom),X=ln(this._container),oe=this._map.getSize().multiplyBy(.5+this.options.padding),De=this._map.project(this._center,x),_t=this._map.project(f,x).subtract(De),Vt=oe.multiplyBy(-k).add(X).add(oe).subtract(_t);pe?Nu(this._container,Vt,k):Ca(this._container,Vt)},_reset:function(){for(var f in this._update(),this._updateTransform(this._center,this._zoom),this._layers)this._layers[f]._reset()},_onZoomEnd:function(){for(var f in this._layers)this._layers[f]._project()},_updatePaths:function(){for(var f in this._layers)this._layers[f]._update()},_update:function(){var f=this.options.padding,x=this._map.getSize(),k=this._map.containerPointToLayerPoint(x.multiplyBy(-f)).round();this._bounds=new ft(k,k.add(x.multiplyBy(1+2*f)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),lp=Mn.extend({getEvents:function(){var f=Mn.prototype.getEvents.call(this);return f.viewprereset=this._onViewPreReset,f},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Mn.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var f=this._container=document.createElement("canvas");zn(f,"mousemove",this._onMouseMove,this),zn(f,"click dblclick mousedown mouseup contextmenu",this._onClick,this),zn(f,"mouseout",this._handleMouseOut,this),this._ctx=f.getContext("2d")},_destroyContainer:function(){xt(this._redrawRequest),delete this._ctx,xr(this._container),ca(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){for(var x in this._redrawBounds=null,this._layers)this._layers[x]._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){Mn.prototype._update.call(this);var f=this._bounds,x=this._container,k=f.getSize(),X=Rr?2:1;Ca(x,f.min),x.width=X*k.x,x.height=X*k.y,x.style.width=k.x+"px",x.style.height=k.y+"px",Rr&&this._ctx.scale(2,2),this._ctx.translate(-f.min.x,-f.min.y),this.fire("update")}},_reset:function(){Mn.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(f){this._updateDashArray(f),this._layers[te(f)]=f;var x=f._order={layer:f,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=x),this._drawLast=x,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(f){this._requestRedraw(f)},_removePath:function(f){var x=f._order,k=x.next,X=x.prev;k?k.prev=X:this._drawLast=X,X?X.next=k:this._drawFirst=k,delete f._order,delete this._layers[te(f)],this._requestRedraw(f)},_updatePath:function(f){this._extendRedrawBounds(f),f._project(),f._update(),this._requestRedraw(f)},_updateStyle:function(f){this._updateDashArray(f),this._requestRedraw(f)},_updateDashArray:function(f){if("string"==typeof f.options.dashArray){var X,oe,x=f.options.dashArray.split(/[, ]+/),k=[];for(oe=0;oe<x.length;oe++){if(X=Number(x[oe]),isNaN(X))return;k.push(X)}f.options._dashArray=k}else f.options._dashArray=f.options.dashArray},_requestRedraw:function(f){!this._map||(this._extendRedrawBounds(f),this._redrawRequest=this._redrawRequest||We(this._redraw,this))},_extendRedrawBounds:function(f){if(f._pxBounds){var x=(f.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new ft,this._redrawBounds.extend(f._pxBounds.min.subtract([x,x])),this._redrawBounds.extend(f._pxBounds.max.add([x,x]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var f=this._redrawBounds;if(f){var x=f.getSize();this._ctx.clearRect(f.min.x,f.min.y,x.x,x.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var f,x=this._redrawBounds;if(this._ctx.save(),x){var k=x.getSize();this._ctx.beginPath(),this._ctx.rect(x.min.x,x.min.y,k.x,k.y),this._ctx.clip()}this._drawing=!0;for(var X=this._drawFirst;X;X=X.next)f=X.layer,(!x||f._pxBounds&&f._pxBounds.intersects(x))&&f._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(f,x){if(this._drawing){var k,X,oe,De,lt=f._parts,_t=lt.length,Vt=this._ctx;if(_t){for(Vt.beginPath(),k=0;k<_t;k++){for(X=0,oe=lt[k].length;X<oe;X++)Vt[X?"lineTo":"moveTo"]((De=lt[k][X]).x,De.y);x&&Vt.closePath()}this._fillStroke(Vt,f)}}},_updateCircle:function(f){if(this._drawing&&!f._empty()){var x=f._point,k=this._ctx,X=Math.max(Math.round(f._radius),1),oe=(Math.max(Math.round(f._radiusY),1)||X)/X;1!==oe&&(k.save(),k.scale(1,oe)),k.beginPath(),k.arc(x.x,x.y/oe,X,0,2*Math.PI,!1),1!==oe&&k.restore(),this._fillStroke(k,f)}},_fillStroke:function(f,x){var k=x.options;k.fill&&(f.globalAlpha=k.fillOpacity,f.fillStyle=k.fillColor||k.color,f.fill(k.fillRule||"evenodd")),k.stroke&&0!==k.weight&&(f.setLineDash&&f.setLineDash(x.options&&x.options._dashArray||[]),f.globalAlpha=k.opacity,f.lineWidth=k.weight,f.strokeStyle=k.color,f.lineCap=k.lineCap,f.lineJoin=k.lineJoin,f.stroke())},_onClick:function(f){for(var k,X,x=this._map.mouseEventToLayerPoint(f),oe=this._drawFirst;oe;oe=oe.next)(k=oe.layer).options.interactive&&k._containsPoint(x)&&("click"!==f.type&&"preclick"===f.type||!this._map._draggableMoved(k))&&(X=k);X&&(Wg(f),this._fireEvent([X],f))},_onMouseMove:function(f){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var x=this._map.mouseEventToLayerPoint(f);this._handleMouseHover(f,x)}},_handleMouseOut:function(f){var x=this._hoveredLayer;x&&(Ao(this._container,"leaflet-interactive"),this._fireEvent([x],f,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(f,x){if(!this._mouseHoverThrottled){for(var k,X,oe=this._drawFirst;oe;oe=oe.next)(k=oe.layer).options.interactive&&k._containsPoint(x)&&(X=k);X!==this._hoveredLayer&&(this._handleMouseOut(f),X&&(xn(this._container,"leaflet-interactive"),this._fireEvent([X],f,"mouseover"),this._hoveredLayer=X)),this._hoveredLayer&&this._fireEvent([this._hoveredLayer],f),this._mouseHoverThrottled=!0,setTimeout(V(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(f,x,k){this._map._fireDOMEvent(x,k||x.type,f)},_bringToFront:function(f){var x=f._order;if(x){var k=x.next,X=x.prev;if(!k)return;k.prev=X,X?X.next=k:k&&(this._drawFirst=k),x.prev=this._drawLast,this._drawLast.next=x,x.next=null,this._drawLast=x,this._requestRedraw(f)}},_bringToBack:function(f){var x=f._order;if(x){var k=x.next,X=x.prev;if(!X)return;X.next=k,k?k.prev=X:X&&(this._drawLast=X),x.prev=null,x.next=this._drawFirst,this._drawFirst.prev=x,this._drawFirst=x,this._requestRedraw(f)}}});function _u(f){return kr?new lp(f):null}var Qg=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(f){return document.createElement("<lvml:"+f+' class="lvml">')}}catch(f){return function(x){return document.createElement("<"+x+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),UE={_initContainer:function(){this._container=Ps("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Mn.prototype._update.call(this),this.fire("update"))},_initPath:function(f){var x=f._container=Qg("shape");xn(x,"leaflet-vml-shape "+(this.options.className||"")),x.coordsize="1 1",f._path=Qg("path"),x.appendChild(f._path),this._updateStyle(f),this._layers[te(f)]=f},_addPath:function(f){var x=f._container;this._container.appendChild(x),f.options.interactive&&f.addInteractiveTarget(x)},_removePath:function(f){var x=f._container;xr(x),f.removeInteractiveTarget(x),delete this._layers[te(f)]},_updateStyle:function(f){var x=f._stroke,k=f._fill,X=f.options,oe=f._container;oe.stroked=!!X.stroke,oe.filled=!!X.fill,X.stroke?(x||(x=f._stroke=Qg("stroke")),oe.appendChild(x),x.weight=X.weight+"px",x.color=X.color,x.opacity=X.opacity,x.dashStyle=X.dashArray?Fe(X.dashArray)?X.dashArray.join(" "):X.dashArray.replace(/( *, *)/g," "):"",x.endcap=X.lineCap.replace("butt","flat"),x.joinstyle=X.lineJoin):x&&(oe.removeChild(x),f._stroke=null),X.fill?(k||(k=f._fill=Qg("fill")),oe.appendChild(k),k.color=X.fillColor||X.color,k.opacity=X.fillOpacity):k&&(oe.removeChild(k),f._fill=null)},_updateCircle:function(f){var x=f._point.round(),k=Math.round(f._radius),X=Math.round(f._radiusY||k);this._setPath(f,f._empty()?"M0 0":"AL "+x.x+","+x.y+" "+k+","+X+" 0,23592600")},_setPath:function(f,x){f._path.v=x},_bringToFront:function(f){Qr(f._container)},_bringToBack:function(f){yh(f._container)}},Uu=eo?Qg:Ke,bh=Mn.extend({getEvents:function(){var f=Mn.prototype.getEvents.call(this);return f.zoomstart=this._onZoomStart,f},_initContainer:function(){this._container=Uu("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Uu("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){xr(this._container),ca(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_onZoomStart:function(){this._update()},_update:function(){if(!this._map._animatingZoom||!this._bounds){Mn.prototype._update.call(this);var f=this._bounds,x=f.getSize(),k=this._container;(!this._svgSize||!this._svgSize.equals(x))&&(this._svgSize=x,k.setAttribute("width",x.x),k.setAttribute("height",x.y)),Ca(k,f.min),k.setAttribute("viewBox",[f.min.x,f.min.y,x.x,x.y].join(" ")),this.fire("update")}},_initPath:function(f){var x=f._path=Uu("path");f.options.className&&xn(x,f.options.className),f.options.interactive&&xn(x,"leaflet-interactive"),this._updateStyle(f),this._layers[te(f)]=f},_addPath:function(f){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(f._path),f.addInteractiveTarget(f._path)},_removePath:function(f){xr(f._path),f.removeInteractiveTarget(f._path),delete this._layers[te(f)]},_updatePath:function(f){f._project(),f._update()},_updateStyle:function(f){var x=f._path,k=f.options;!x||(k.stroke?(x.setAttribute("stroke",k.color),x.setAttribute("stroke-opacity",k.opacity),x.setAttribute("stroke-width",k.weight),x.setAttribute("stroke-linecap",k.lineCap),x.setAttribute("stroke-linejoin",k.lineJoin),k.dashArray?x.setAttribute("stroke-dasharray",k.dashArray):x.removeAttribute("stroke-dasharray"),k.dashOffset?x.setAttribute("stroke-dashoffset",k.dashOffset):x.removeAttribute("stroke-dashoffset")):x.setAttribute("stroke","none"),k.fill?(x.setAttribute("fill",k.fillColor||k.color),x.setAttribute("fill-opacity",k.fillOpacity),x.setAttribute("fill-rule",k.fillRule||"evenodd")):x.setAttribute("fill","none"))},_updatePoly:function(f,x){this._setPath(f,ke(f._parts,x))},_updateCircle:function(f){var x=f._point,k=Math.max(Math.round(f._radius),1),oe="a"+k+","+(Math.max(Math.round(f._radiusY),1)||k)+" 0 1,0 ",De=f._empty()?"M0 0":"M"+(x.x-k)+","+x.y+oe+2*k+",0 "+oe+2*-k+",0 ";this._setPath(f,De)},_setPath:function(f,x){f._path.setAttribute("d",x)},_bringToFront:function(f){Qr(f._path)},_bringToBack:function(f){yh(f._path)}});function Hl(f){return ic||eo?new bh(f):null}eo&&bh.include(UE),ds.include({getRenderer:function(f){var x=f.options.renderer||this._getPaneRenderer(f.options.pane)||this.options.renderer||this._renderer;return x||(x=this._renderer=this._createRenderer()),this.hasLayer(x)||this.addLayer(x),x},_getPaneRenderer:function(f){if("overlayPane"===f||void 0===f)return!1;var x=this._paneRenderers[f];return void 0===x&&(x=this._createRenderer({pane:f}),this._paneRenderers[f]=x),x},_createRenderer:function(f){return this.options.preferCanvas&&_u(f)||Hl(f)}});var ex=ho.extend({initialize:function(f,x){ho.prototype.initialize.call(this,this._boundsToLatLngs(f),x)},setBounds:function(f){return this.setLatLngs(this._boundsToLatLngs(f))},_boundsToLatLngs:function(f){return[(f=Fi(f)).getSouthWest(),f.getNorthWest(),f.getNorthEast(),f.getSouthEast()]}});bh.create=Uu,bh.pointsToPath=ke,Ne.geometryToLayer=Gr,Ne.coordsToLatLng=Ma,Ne.coordsToLatLngs=bc,Ne.latLngToCoords=xc,Ne.latLngsToCoords=ja,Ne.getFeature=sc,Ne.asFeature=wc,ds.mergeOptions({boxZoom:!0});var vf=Fl.extend({initialize:function(f){this._map=f,this._container=f._container,this._pane=f._panes.overlayPane,this._resetStateTimeout=0,f.on("unload",this._destroy,this)},addHooks:function(){zn(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){ca(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){xr(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(f){if(!f.shiftKey||1!==f.which&&1!==f.button)return!1;this._clearDeferredResetState(),this._resetState(),id(),rd(),this._startPoint=this._map.mouseEventToContainerPoint(f),zn(document,{contextmenu:ld,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(f){this._moved||(this._moved=!0,this._box=Ps("div","leaflet-zoom-box",this._container),xn(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(f);var x=new ft(this._point,this._startPoint),k=x.getSize();Ca(this._box,x.min),this._box.style.width=k.x+"px",this._box.style.height=k.y+"px"},_finish:function(){this._moved&&(xr(this._box),Ao(this._container,"leaflet-crosshair")),yr(),sd(),ca(document,{contextmenu:ld,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(f){if((1===f.which||1===f.button)&&(this._finish(),this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(V(this._resetState,this),0);var x=new qi(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(x).fire("boxzoomend",{boxZoomBounds:x})}},_onKeyDown:function(f){27===f.keyCode&&this._finish()}});ds.addInitHook("addHandler","boxZoom",vf),ds.mergeOptions({doubleClickZoom:!0});var yu=Fl.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(f){var x=this._map,k=x.getZoom(),X=x.options.zoomDelta,oe=f.originalEvent.shiftKey?k-X:k+X;"center"===x.options.doubleClickZoom?x.setZoom(oe):x.setZoomAround(f.containerPoint,oe)}});ds.addInitHook("addHandler","doubleClickZoom",yu),ds.mergeOptions({dragging:!0,inertia:!di,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var tx=Fl.extend({addHooks:function(){if(!this._draggable){var f=this._map;this._draggable=new tl(f._mapPane,f._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),f.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),f.on("zoomend",this._onZoomEnd,this),f.whenReady(this._onZoomEnd,this))}xn(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Ao(this._map._container,"leaflet-grab"),Ao(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var f=this._map;if(f._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var x=Fi(this._map.options.maxBounds);this._offsetLimit=bn(this._map.latLngToContainerPoint(x.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(x.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;f.fire("movestart").fire("dragstart"),f.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(f){if(this._map.options.inertia){var x=this._lastTime=+new Date,k=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(k),this._times.push(x),this._prunePositions(x)}this._map.fire("move",f).fire("drag",f)},_prunePositions:function(f){for(;this._positions.length>1&&f-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var f=this._map.getSize().divideBy(2),x=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=x.subtract(f).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(f,x){return f-(f-x)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var f=this._draggable._newPos.subtract(this._draggable._startPos),x=this._offsetLimit;f.x<x.min.x&&(f.x=this._viscousLimit(f.x,x.min.x)),f.y<x.min.y&&(f.y=this._viscousLimit(f.y,x.min.y)),f.x>x.max.x&&(f.x=this._viscousLimit(f.x,x.max.x)),f.y>x.max.y&&(f.y=this._viscousLimit(f.y,x.max.y)),this._draggable._newPos=this._draggable._startPos.add(f)}},_onPreDragWrap:function(){var f=this._worldWidth,x=Math.round(f/2),k=this._initialWorldOffset,X=this._draggable._newPos.x,oe=(X-x+k)%f+x-k,De=(X+x+k)%f-x-k,lt=Math.abs(oe+k)<Math.abs(De+k)?oe:De;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=lt},_onDragEnd:function(f){var x=this._map,k=x.options,X=!k.inertia||this._times.length<2;if(x.fire("dragend",f),X)x.fire("moveend");else{this._prunePositions(+new Date);var oe=this._lastPos.subtract(this._positions[0]),lt=k.easeLinearity,_t=oe.multiplyBy(lt/((this._lastTime-this._times[0])/1e3)),Vt=_t.distanceTo([0,0]),_i=Math.min(k.inertiaMaxSpeed,Vt),on=_t.multiplyBy(_i/Vt),Ln=_i/(k.inertiaDeceleration*lt),ps=on.multiplyBy(-Ln/2).round();ps.x||ps.y?(ps=x._limitOffset(ps,x.options.maxBounds),We(function(){x.panBy(ps,{duration:Ln,easeLinearity:lt,noMoveStart:!0,animate:!0})})):x.fire("moveend")}}});ds.addInitHook("addHandler","dragging",tx),ds.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Ls=Fl.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(f){this._map=f,this._setPanDelta(f.options.keyboardPanDelta),this._setZoomDelta(f.options.zoomDelta)},addHooks:function(){var f=this._map._container;f.tabIndex<=0&&(f.tabIndex="0"),zn(f,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),ca(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var f=document.body,x=document.documentElement,k=f.scrollTop||x.scrollTop,X=f.scrollLeft||x.scrollLeft;this._map._container.focus(),window.scrollTo(X,k)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(f){var X,oe,x=this._panKeys={},k=this.keyCodes;for(X=0,oe=k.left.length;X<oe;X++)x[k.left[X]]=[-1*f,0];for(X=0,oe=k.right.length;X<oe;X++)x[k.right[X]]=[f,0];for(X=0,oe=k.down.length;X<oe;X++)x[k.down[X]]=[0,f];for(X=0,oe=k.up.length;X<oe;X++)x[k.up[X]]=[0,-1*f]},_setZoomDelta:function(f){var X,oe,x=this._zoomKeys={},k=this.keyCodes;for(X=0,oe=k.zoomIn.length;X<oe;X++)x[k.zoomIn[X]]=f;for(X=0,oe=k.zoomOut.length;X<oe;X++)x[k.zoomOut[X]]=-f},_addHooks:function(){zn(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){ca(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(f){if(!(f.altKey||f.ctrlKey||f.metaKey)){var X,x=f.keyCode,k=this._map;if(x in this._panKeys)(!k._panAnim||!k._panAnim._inProgress)&&(X=this._panKeys[x],f.shiftKey&&(X=Ct(X).multiplyBy(3)),k.panBy(X),k.options.maxBounds&&k.panInsideBounds(k.options.maxBounds));else if(x in this._zoomKeys)k.setZoom(k.getZoom()+(f.shiftKey?3:1)*this._zoomKeys[x]);else{if(27!==x||!k._popup||!k._popup.options.closeOnEscapeKey)return;k.closePopup()}ld(f)}}});ds.addInitHook("addHandler","keyboard",Ls),ds.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var md=Fl.extend({addHooks:function(){zn(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){ca(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(f){var x=xi(f),k=this._map.options.wheelDebounceTime;this._delta+=x,this._lastMousePos=this._map.mouseEventToContainerPoint(f),this._startTime||(this._startTime=+new Date);var X=Math.max(k-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(V(this._performZoom,this),X),ld(f)},_performZoom:function(){var f=this._map,x=f.getZoom(),k=this._map.options.zoomSnap||0;f._stop();var oe=4*Math.log(2/(1+Math.exp(-Math.abs(this._delta/(4*this._map.options.wheelPxPerZoomLevel)))))/Math.LN2,De=k?Math.ceil(oe/k)*k:oe,lt=f._limitZoom(x+(this._delta>0?De:-De))-x;this._delta=0,this._startTime=null,lt&&("center"===f.options.scrollWheelZoom?f.setZoom(x+lt):f.setZoomAround(this._lastMousePos,x+lt))}});ds.addInitHook("addHandler","scrollWheelZoom",md),ds.mergeOptions({tap:!0,tapTolerance:15});var Gu=Fl.extend({addHooks:function(){zn(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){ca(this._map._container,"touchstart",this._onDown,this)},_onDown:function(f){if(f.touches){if(pu(f),this._fireClick=!0,f.touches.length>1)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var x=f.touches[0],k=x.target;this._startPos=this._newPos=new Rt(x.clientX,x.clientY),k.tagName&&"a"===k.tagName.toLowerCase()&&xn(k,"leaflet-active"),this._holdTimeout=setTimeout(V(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",x))},this),1e3),this._simulateEvent("mousedown",x),zn(document,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(f){if(clearTimeout(this._holdTimeout),ca(document,{touchmove:this._onMove,touchend:this._onUp},this),this._fireClick&&f&&f.changedTouches){var x=f.changedTouches[0],k=x.target;k&&k.tagName&&"a"===k.tagName.toLowerCase()&&Ao(k,"leaflet-active"),this._simulateEvent("mouseup",x),this._isTapValid()&&this._simulateEvent("click",x)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(f){var x=f.touches[0];this._newPos=new Rt(x.clientX,x.clientY),this._simulateEvent("mousemove",x)},_simulateEvent:function(f,x){var k=document.createEvent("MouseEvents");k._simulated=!0,x.target._simulatedClick=!0,k.initMouseEvent(f,!0,!0,window,1,x.screenX,x.screenY,x.clientX,x.clientY,!1,!1,!1,!1,0,null),x.target.dispatchEvent(k)}});Xi&&(!Gi||Eo)&&ds.addInitHook("addHandler","tap",Gu),ds.mergeOptions({touchZoom:Xi&&!di,bounceAtZoomLimits:!0});var cm=Fl.extend({addHooks:function(){xn(this._map._container,"leaflet-touch-zoom"),zn(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Ao(this._map._container,"leaflet-touch-zoom"),ca(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(f){var x=this._map;if(f.touches&&2===f.touches.length&&!x._animatingZoom&&!this._zooming){var k=x.mouseEventToContainerPoint(f.touches[0]),X=x.mouseEventToContainerPoint(f.touches[1]);this._centerPoint=x.getSize()._divideBy(2),this._startLatLng=x.containerPointToLatLng(this._centerPoint),"center"!==x.options.touchZoom&&(this._pinchStartLatLng=x.containerPointToLatLng(k.add(X)._divideBy(2))),this._startDist=k.distanceTo(X),this._startZoom=x.getZoom(),this._moved=!1,this._zooming=!0,x._stop(),zn(document,"touchmove",this._onTouchMove,this),zn(document,"touchend",this._onTouchEnd,this),pu(f)}},_onTouchMove:function(f){if(f.touches&&2===f.touches.length&&this._zooming){var x=this._map,k=x.mouseEventToContainerPoint(f.touches[0]),X=x.mouseEventToContainerPoint(f.touches[1]),oe=k.distanceTo(X)/this._startDist;if(this._zoom=x.getScaleZoom(oe,this._startZoom),!x.options.bounceAtZoomLimits&&(this._zoom<x.getMinZoom()&&oe<1||this._zoom>x.getMaxZoom()&&oe>1)&&(this._zoom=x._limitZoom(this._zoom)),"center"===x.options.touchZoom){if(this._center=this._startLatLng,1===oe)return}else{var De=k._add(X)._divideBy(2)._subtract(this._centerPoint);if(1===oe&&0===De.x&&0===De.y)return;this._center=x.unproject(x.project(this._pinchStartLatLng,this._zoom).subtract(De),this._zoom)}this._moved||(x._moveStart(!0,!1),this._moved=!0),xt(this._animRequest);var lt=V(x._move,x,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=We(lt,this,!0),pu(f)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,xt(this._animRequest),ca(document,"touchmove",this._onTouchMove,this),ca(document,"touchend",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});ds.addInitHook("addHandler","touchZoom",cm),ds.BoxZoom=vf,ds.DoubleClickZoom=yu,ds.Drag=tx,ds.Keyboard=Ls,ds.ScrollWheelZoom=md,ds.Tap=Gu,ds.TouchZoom=cm,D.version="1.7.1",D.Control=mu,D.control=wr,D.Browser=Bg,D.Evented=Ei,D.Mixin=Co,D.Util=_e,D.Class=Lt,D.Handler=Fl,D.extend=H,D.bind=V,D.stamp=te,D.setOptions=me,D.DomEvent=K0,D.DomUtil=od,D.PosAnimation=ip,D.Draggable=tl,D.LineUtil=J0,D.PolyUtil=dv,D.Point=Rt,D.point=Ct,D.Bounds=ft,D.bounds=bn,D.Transformation=za,D.transformation=Ui,D.Projection=pv,D.LatLng=cr,D.latLng=ii,D.LatLngBounds=qi,D.latLngBounds=Fi,D.CRS=mr,D.GeoJSON=Ne,D.geoJSON=Is,D.geoJson=dd,D.Layer=il,D.LayerGroup=ml,D.layerGroup=function(f,x){return new ml(f,x)},D.FeatureGroup=Vu,D.featureGroup=function(f,x){return new Vu(f,x)},D.ImageOverlay=zu,D.imageOverlay=function(f,x,k){return new zu(f,x,k)},D.VideoOverlay=oc,D.videoOverlay=function op(f,x,k){return new oc(f,x,k)},D.SVGOverlay=gu,D.svgOverlay=function ap(f,x,k){return new gu(f,x,k)},D.DivOverlay=qa,D.Popup=pf,D.popup=function(f,x){return new pf(f,x)},D.Tooltip=fd,D.tooltip=function(f,x){return new fd(f,x)},D.Icon=Nc,D.icon=function rp(f){return new Nc(f)},D.DivIcon=vh,D.divIcon=function $0(f){return new vh(f)},D.Marker=cn,D.marker=function gl(f,x){return new cn(f,x)},D.TileLayer=_f,D.tileLayer=Kg,D.GridLayer=mf,D.gridLayer=function gf(f){return new mf(f)},D.SVG=bh,D.svg=Hl,D.Renderer=Mn,D.Canvas=lp,D.canvas=_u,D.Path=Yi,D.CircleMarker=us,D.circleMarker=function Jr(f,x){return new us(f,x)},D.Circle=_l,D.circle=function Es(f,x,k){return new _l(f,x,k)},D.Polyline=bs,D.polyline=function hd(f,x){return new bs(f,x)},D.Polygon=ho,D.polygon=function ua(f,x){return new ho(f,x)},D.Rectangle=ex,D.rectangle=function SC(f,x){return new ex(f,x)},D.Map=ds,D.map=function df(f,x){return new ds(f,x)};var cp=window.L;D.noConflict=function(){return window.L=cp,this},window.L=D}(b)},4292:function(module,exports){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__,C,b;function OpenSeadragon(C){return new OpenSeadragon.Viewer(C)}(function(C){C.version={versionStr:"2.4.2",major:parseInt("2",10),minor:parseInt("4",10),revision:parseInt("2",10)};var H,b={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object"},D=Object.prototype.toString,F=Object.prototype.hasOwnProperty;C.isFunction=function(H){return"function"===C.type(H)},C.isArray=Array.isArray||function(H){return"array"===C.type(H)},C.isWindow=function(H){return H&&"object"==typeof H&&"setInterval"in H},C.type=function(H){return null==H?String(H):b[D.call(H)]||"object"},C.isPlainObject=function(H){if(!H||"object"!==OpenSeadragon.type(H)||H.nodeType||C.isWindow(H)||H.constructor&&!F.call(H,"constructor")&&!F.call(H.constructor.prototype,"isPrototypeOf"))return!1;var z;for(var V in H)z=V;return void 0===z||F.call(H,z)},C.isEmptyObject=function(H){for(var z in H)return!1;return!0},C.freezeObject=function(H){return C.freezeObject=Object.freeze?Object.freeze:function(z){return z},C.freezeObject(H)},C.supportsCanvas=(H=document.createElement("canvas"),!(!C.isFunction(H.getContext)||!H.getContext("2d"))),C.isCanvasTainted=function(H){var z=!1;try{H.getContext("2d").getImageData(0,0,1,1)}catch(V){z=!0}return z},C.pixelDensityRatio=function(){if(C.supportsCanvas){var H=document.createElement("canvas").getContext("2d"),z=window.devicePixelRatio||1,V=H.webkitBackingStorePixelRatio||H.mozBackingStorePixelRatio||H.msBackingStorePixelRatio||H.oBackingStorePixelRatio||H.backingStorePixelRatio||1;return Math.max(z,1)/V}return 1}()})(OpenSeadragon),function($){$.extend=function(){var C,b,D,F,H,z,V=arguments[0]||{},W=arguments.length,te=!1,Q=1;for("boolean"==typeof V&&(te=V,V=arguments[1]||{},Q=2),"object"!=typeof V&&!OpenSeadragon.isFunction(V)&&(V={}),W===Q&&(V=this,--Q);Q<W;Q++)if(null!==(C=arguments[Q])||void 0!==C)for(b in C)D=V[b],V!==(F=C[b])&&(te&&F&&(OpenSeadragon.isPlainObject(F)||(H=OpenSeadragon.isArray(F)))?(H?(H=!1,z=D&&OpenSeadragon.isArray(D)?D:[]):z=D&&OpenSeadragon.isPlainObject(D)?D:{},V[b]=OpenSeadragon.extend(te,z,F)):void 0!==F&&(V[b]=F));return V};var isIOSDevice=function(){if("object"!=typeof navigator)return!1;var C=navigator.userAgent;return"string"==typeof C&&(-1!==C.indexOf("iPhone")||-1!==C.indexOf("iPad")||-1!==C.indexOf("iPod"))};$.extend($,{DEFAULT_SETTINGS:{xmlPath:null,tileSources:null,tileHost:null,initialPage:0,crossOriginPolicy:!1,ajaxWithCredentials:!1,loadTilesWithAjax:!1,ajaxHeaders:{},panHorizontal:!0,panVertical:!0,constrainDuringPan:!1,wrapHorizontal:!1,wrapVertical:!1,visibilityRatio:.5,minPixelRatio:.5,defaultZoomLevel:0,minZoomLevel:null,maxZoomLevel:null,homeFillsViewer:!1,clickTimeThreshold:300,clickDistThreshold:5,dblClickTimeThreshold:300,dblClickDistThreshold:20,springStiffness:6.5,animationTime:1.2,gestureSettingsMouse:{scrollToZoom:!0,clickToZoom:!0,dblClickToZoom:!1,pinchToZoom:!1,zoomToRefPoint:!0,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsTouch:{scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,pinchToZoom:!0,zoomToRefPoint:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsPen:{scrollToZoom:!1,clickToZoom:!0,dblClickToZoom:!1,pinchToZoom:!1,zoomToRefPoint:!0,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsUnknown:{scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,pinchToZoom:!0,zoomToRefPoint:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},zoomPerClick:2,zoomPerScroll:1.2,zoomPerSecond:1,blendTime:0,alwaysBlend:!1,autoHideControls:!0,immediateRender:!1,minZoomImageRatio:.9,maxZoomPixelRatio:1.1,smoothTileEdgesMinZoom:1.1,iOSDevice:isIOSDevice(),pixelsPerWheelLine:40,pixelsPerArrowPress:40,autoResize:!0,preserveImageSizeOnResize:!1,minScrollDeltaTime:50,rotationIncrement:90,showSequenceControl:!0,sequenceControlAnchor:null,preserveViewport:!1,preserveOverlays:!1,navPrevNextWrap:!1,showNavigationControl:!0,navigationControlAnchor:null,showZoomControl:!0,showHomeControl:!0,showFullPageControl:!0,showRotationControl:!1,showFlipControl:!1,controlsFadeDelay:2e3,controlsFadeLength:1500,mouseNavEnabled:!0,showNavigator:!1,navigatorId:null,navigatorPosition:null,navigatorSizeRatio:.2,navigatorMaintainSizeRatio:!1,navigatorTop:null,navigatorLeft:null,navigatorHeight:null,navigatorWidth:null,navigatorAutoResize:!0,navigatorAutoFade:!0,navigatorRotate:!0,navigatorBackground:"#000",navigatorOpacity:.8,navigatorBorderColor:"#555",navigatorDisplayRegionColor:"#900",degrees:0,flipped:!1,opacity:1,preload:!1,compositeOperation:null,imageSmoothingEnabled:!0,placeholderFillStyle:null,showReferenceStrip:!1,referenceStripScroll:"horizontal",referenceStripElement:null,referenceStripHeight:null,referenceStripWidth:null,referenceStripPosition:"BOTTOM_LEFT",referenceStripSizeRatio:.2,collectionRows:3,collectionColumns:0,collectionLayout:"horizontal",collectionMode:!1,collectionTileSize:800,collectionTileMargin:80,imageLoaderLimit:0,maxImageCacheCount:200,timeout:3e4,useCanvas:!0,prefixUrl:"/images/",navImages:{zoomIn:{REST:"zoomin_rest.png",GROUP:"zoomin_grouphover.png",HOVER:"zoomin_hover.png",DOWN:"zoomin_pressed.png"},zoomOut:{REST:"zoomout_rest.png",GROUP:"zoomout_grouphover.png",HOVER:"zoomout_hover.png",DOWN:"zoomout_pressed.png"},home:{REST:"home_rest.png",GROUP:"home_grouphover.png",HOVER:"home_hover.png",DOWN:"home_pressed.png"},fullpage:{REST:"fullpage_rest.png",GROUP:"fullpage_grouphover.png",HOVER:"fullpage_hover.png",DOWN:"fullpage_pressed.png"},rotateleft:{REST:"rotateleft_rest.png",GROUP:"rotateleft_grouphover.png",HOVER:"rotateleft_hover.png",DOWN:"rotateleft_pressed.png"},rotateright:{REST:"rotateright_rest.png",GROUP:"rotateright_grouphover.png",HOVER:"rotateright_hover.png",DOWN:"rotateright_pressed.png"},flip:{REST:"flip_rest.png",GROUP:"flip_grouphover.png",HOVER:"flip_hover.png",DOWN:"flip_pressed.png"},previous:{REST:"previous_rest.png",GROUP:"previous_grouphover.png",HOVER:"previous_hover.png",DOWN:"previous_pressed.png"},next:{REST:"next_rest.png",GROUP:"next_grouphover.png",HOVER:"next_hover.png",DOWN:"next_pressed.png"}},debugMode:!1,debugGridColor:["#437AB2","#1B9E77","#D95F02","#7570B3","#E7298A","#66A61E","#E6AB02","#A6761D","#666666"]},SIGNAL:"----seadragon----",delegate:function(C,b){return function(){var D=arguments;return void 0===D&&(D=[]),b.apply(C,D)}},BROWSERS:{UNKNOWN:0,IE:1,FIREFOX:2,SAFARI:3,CHROME:4,OPERA:5},getElement:function(C){return"string"==typeof C&&(C=document.getElementById(C)),C},getElementPosition:function(C){var D,F,b=new $.Point;for(F=getOffsetParent(C=$.getElement(C),D="fixed"==$.getElementStyle(C).position);F;)b.x+=C.offsetLeft,b.y+=C.offsetTop,D&&(b=b.plus($.getPageScroll())),F=getOffsetParent(C=F,D="fixed"==$.getElementStyle(C).position);return b},getElementOffset:function(C){var D,F,b=(C=$.getElement(C))&&C.ownerDocument,H={top:0,left:0};return b?(D=b.documentElement,void 0!==C.getBoundingClientRect&&(H=C.getBoundingClientRect()),new $.Point(H.left+((F=b==b.window?b:9===b.nodeType&&(b.defaultView||b.parentWindow)).pageXOffset||D.scrollLeft)-(D.clientLeft||0),H.top+(F.pageYOffset||D.scrollTop)-(D.clientTop||0))):new $.Point},getElementSize:function(C){return C=$.getElement(C),new $.Point(C.clientWidth,C.clientHeight)},getElementStyle:document.documentElement.currentStyle?function(C){return(C=$.getElement(C)).currentStyle}:function(C){return C=$.getElement(C),window.getComputedStyle(C,"")},getCssPropertyWithVendorPrefix:function(C){var b={};return $.getCssPropertyWithVendorPrefix=function(D){if(void 0!==b[D])return b[D];var F=document.createElement("div").style,H=null;if(void 0!==F[D])H=D;else for(var z=["Webkit","Moz","MS","O","webkit","moz","ms","o"],V=$.capitalizeFirstLetter(D),W=0;W<z.length;W++){var te=z[W]+V;if(void 0!==F[te]){H=te;break}}return b[D]=H,H},$.getCssPropertyWithVendorPrefix(C)},capitalizeFirstLetter:function(C){return C.charAt(0).toUpperCase()+C.slice(1)},positiveModulo:function(C,b){var D=C%b;return D<0&&(D+=b),D},pointInElement:function(C,b){C=$.getElement(C);var D=$.getElementOffset(C),F=$.getElementSize(C);return b.x>=D.x&&b.x<D.x+F.x&&b.y<D.y+F.y&&b.y>=D.y},getEvent:function(C){return $.getEvent=C?function(b){return b}:function(){return window.event},$.getEvent(C)},getMousePosition:function(C){if("number"==typeof C.pageX)$.getMousePosition=function(b){var D=new $.Point;return b=$.getEvent(b),D.x=b.pageX,D.y=b.pageY,D};else{if("number"!=typeof C.clientX)throw new Error("Unknown event mouse position, no known technique.");$.getMousePosition=function(b){var D=new $.Point;return b=$.getEvent(b),D.x=b.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,D.y=b.clientY+document.body.scrollTop+document.documentElement.scrollTop,D}}return $.getMousePosition(C)},getPageScroll:function(){var C=document.documentElement||{},b=document.body||{};if("number"==typeof window.pageXOffset)$.getPageScroll=function(){return new $.Point(window.pageXOffset,window.pageYOffset)};else if(b.scrollLeft||b.scrollTop)$.getPageScroll=function(){return new $.Point(document.body.scrollLeft,document.body.scrollTop)};else{if(!C.scrollLeft&&!C.scrollTop)return new $.Point(0,0);$.getPageScroll=function(){return new $.Point(document.documentElement.scrollLeft,document.documentElement.scrollTop)}}return $.getPageScroll()},setPageScroll:function(C){if(void 0!==window.scrollTo)$.setPageScroll=function(F){window.scrollTo(F.x,F.y)};else{var b=$.getPageScroll();if(b.x===C.x&&b.y===C.y)return;document.body.scrollLeft=C.x,document.body.scrollTop=C.y;var D=$.getPageScroll();if(D.x!==b.x&&D.y!==b.y)return void($.setPageScroll=function(F){document.body.scrollLeft=F.x,document.body.scrollTop=F.y});if(document.documentElement.scrollLeft=C.x,document.documentElement.scrollTop=C.y,(D=$.getPageScroll()).x!==b.x&&D.y!==b.y)return void($.setPageScroll=function(F){document.documentElement.scrollLeft=F.x,document.documentElement.scrollTop=F.y});$.setPageScroll=function(F){}}return $.setPageScroll(C)},getWindowSize:function(){var C=document.documentElement||{},b=document.body||{};if("number"==typeof window.innerWidth)$.getWindowSize=function(){return new $.Point(window.innerWidth,window.innerHeight)};else if(C.clientWidth||C.clientHeight)$.getWindowSize=function(){return new $.Point(document.documentElement.clientWidth,document.documentElement.clientHeight)};else{if(!b.clientWidth&&!b.clientHeight)throw new Error("Unknown window size, no known technique.");$.getWindowSize=function(){return new $.Point(document.body.clientWidth,document.body.clientHeight)}}return $.getWindowSize()},makeCenteredNode:function(C){C=$.getElement(C);var b=[$.makeNeutralElement("div"),$.makeNeutralElement("div"),$.makeNeutralElement("div")];return $.extend(b[0].style,{display:"table",height:"100%",width:"100%"}),$.extend(b[1].style,{display:"table-row"}),$.extend(b[2].style,{display:"table-cell",verticalAlign:"middle",textAlign:"center"}),b[0].appendChild(b[1]),b[1].appendChild(b[2]),b[2].appendChild(C),b[0]},makeNeutralElement:function(C){var b=document.createElement(C),D=b.style;return D.background="transparent none",D.border="none",D.margin="0px",D.padding="0px",D.position="static",b},now:function(){return $.now=Date.now?Date.now:function(){return(new Date).getTime()},$.now()},makeTransparentImage:function(C){return $.makeTransparentImage=function(b){var D=$.makeNeutralElement("img");return D.src=b,D},$.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<7&&($.makeTransparentImage=function(b){var D=$.makeNeutralElement("img"),F=null;return(F=$.makeNeutralElement("span")).style.display="inline-block",D.onload=function(){F.style.width=F.style.width||D.width+"px",F.style.height=F.style.height||D.height+"px",D.onload=null,D=null},D.src=b,F.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+b+"', sizingMethod='scale')",F}),$.makeTransparentImage(C)},setElementOpacity:function(C,b,D){var F;C=$.getElement(C),D&&!$.Browser.alpha&&(b=Math.round(b)),$.Browser.opacity?C.style.opacity=b<1?b:"":b<1?(F=Math.round(100*b),C.style.filter="alpha(opacity="+F+")"):C.style.filter=""},setElementTouchActionNone:function(C){void 0!==(C=$.getElement(C)).style.touchAction?C.style.touchAction="none":void 0!==C.style.msTouchAction&&(C.style.msTouchAction="none")},addClass:function(C,b){(C=$.getElement(C)).className?-1===(" "+C.className+" ").indexOf(" "+b+" ")&&(C.className+=" "+b):C.className=b},indexOf:function(C,b,D){return this.indexOf=Array.prototype.indexOf?function(F,H,z){return F.indexOf(H,z)}:function(F,H,z){var V,te,W=z||0;if(!F)throw new TypeError;if(0===(te=F.length)||W>=te)return-1;for(W<0&&(W=te-Math.abs(W)),V=W;V<te;V++)if(F[V]===H)return V;return-1},this.indexOf(C,b,D)},removeClass:function(C,b){var D,H,F=[];for(D=(C=$.getElement(C)).className.split(/\s+/),H=0;H<D.length;H++)D[H]&&D[H]!==b&&F.push(D[H]);C.className=F.join(" ")},addEvent:function(){if(window.addEventListener)return function(C,b,D,F){(C=$.getElement(C)).addEventListener(b,D,F)};if(window.attachEvent)return function(C,b,D,F){(C=$.getElement(C)).attachEvent("on"+b,D)};throw new Error("No known event model.")}(),removeEvent:function(){if(window.removeEventListener)return function(C,b,D,F){(C=$.getElement(C)).removeEventListener(b,D,F)};if(window.detachEvent)return function(C,b,D,F){(C=$.getElement(C)).detachEvent("on"+b,D)};throw new Error("No known event model.")}(),cancelEvent:function(C){C=$.getEvent(C),$.cancelEvent=C.preventDefault?function(b){b.preventDefault()}:function(b){(b=$.getEvent(b)).cancel=!0,b.returnValue=!1},$.cancelEvent(C)},stopEvent:function(C){C=$.getEvent(C),$.stopEvent=C.stopPropagation?function(b){b.stopPropagation()}:function(b){(b=$.getEvent(b)).cancelBubble=!0},$.stopEvent(C)},createCallback:function(C,b){var F,D=[];for(F=2;F<arguments.length;F++)D.push(arguments[F]);return function(){var z,H=D.concat([]);for(z=0;z<arguments.length;z++)H.push(arguments[z]);return b.apply(C,H)}},getUrlParameter:function(C){return URLPARAMS[C]||null},getUrlProtocol:function(C){var b=C.match(/^([a-z]+:)\/\//i);return null===b?window.location.protocol:b[1].toLowerCase()},createAjaxRequest:function(C){var b;try{b=!!new ActiveXObject("Microsoft.XMLHTTP")}catch(D){b=!1}if(b)$.createAjaxRequest=window.XMLHttpRequest?function(D){return D?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest}:function(){return new ActiveXObject("Microsoft.XMLHTTP")};else{if(!window.XMLHttpRequest)throw new Error("Browser doesn't support XMLHttpRequest.");$.createAjaxRequest=function(){return new XMLHttpRequest}}return $.createAjaxRequest(C)},makeAjaxRequest:function(C,b,D){var F,H,z;$.isPlainObject(C)&&(b=C.success,D=C.error,F=C.withCredentials,H=C.headers,z=C.responseType||null,C=C.url);var V=$.getUrlProtocol(C),W=$.createAjaxRequest("file:"===V);if(!$.isFunction(b))throw new Error("makeAjaxRequest requires a success callback");W.onreadystatechange=function(){4==W.readyState&&(W.onreadystatechange=function(){},W.status>=200&&W.status<300||0===W.status&&"http:"!==V&&"https:"!==V?b(W):($.console.log("AJAX request returned %d: %s",W.status,C),$.isFunction(D)&&D(W)))};try{if(W.open("GET",C,!0),z&&(W.responseType=z),H)for(var te in H)Object.prototype.hasOwnProperty.call(H,te)&&H[te]&&W.setRequestHeader(te,H[te]);F&&(W.withCredentials=!0),W.send(null)}catch(ae){var Q=ae.message;if($.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<10&&void 0!==ae.number&&-2147024891==ae.number&&(Q+="\nSee http://msdn.microsoft.com/en-us/library/ms537505(v=vs.85).aspx#xdomain"),$.console.log("%s while making AJAX request: %s",ae.name,Q),W.onreadystatechange=function(){},window.XDomainRequest){var be=new window.XDomainRequest;if(be){be.onload=function(Te){$.isFunction(b)&&b({responseText:be.responseText,status:200,statusText:"OK"})},be.onerror=function(Te){$.isFunction(D)&&D({responseText:be.responseText,status:444,statusText:"An error happened. Due to an XDomainRequest deficiency we can not extract any information about this error. Upgrade your browser."})};try{be.open("GET",C),be.send()}catch(Te){$.isFunction(D)&&D(W,ae)}}}else $.isFunction(D)&&D(W,ae)}return W},jsonp:function(C){var b,D=C.url,F=document.head||document.getElementsByTagName("head")[0]||document.documentElement,H=C.callbackName||"openseadragon"+$.now(),z=window[H],W=C.param||"callback",te=C.callback;D=D.replace(/(\=)\?(&|$)|\?\?/i,"$1"+H+"$2"),D+=(/\?/.test(D)?"&":"?")+W+"="+H,window[H]=function(Q){if(z)window[H]=z;else try{delete window[H]}catch(he){}te&&$.isFunction(te)&&te(Q)},b=document.createElement("script"),(void 0!==C.async||!1!==C.async)&&(b.async="async"),C.scriptCharset&&(b.charset=C.scriptCharset),b.src=D,b.onload=b.onreadystatechange=function(Q,he){(he||!b.readyState||/loaded|complete/.test(b.readyState))&&(b.onload=b.onreadystatechange=null,F&&b.parentNode&&F.removeChild(b),b=void 0)},F.insertBefore(b,F.firstChild)},createFromDZI:function(){throw"OpenSeadragon.createFromDZI is deprecated, use Viewer.open."},parseXml:function(C){if(window.DOMParser)$.parseXml=function(b){return(new DOMParser).parseFromString(b,"text/xml")};else{if(!window.ActiveXObject)throw new Error("Browser doesn't support XML DOM.");$.parseXml=function(b){var D=null;return(D=new ActiveXObject("Microsoft.XMLDOM")).async=!1,D.loadXML(b),D}}return $.parseXml(C)},parseJSON:function(string){return $.parseJSON=window.JSON&&window.JSON.parse?window.JSON.parse:function(string){return eval("("+string+")")},$.parseJSON(string)},imageFormatSupported:function(C){return!!FILEFORMATS[(C=C||"").toLowerCase()]}});var nullfunction=function(C){};$.console=window.console||{log:nullfunction,debug:nullfunction,info:nullfunction,warn:nullfunction,error:nullfunction,assert:nullfunction},$.Browser={vendor:$.BROWSERS.UNKNOWN,version:0,alpha:!0};var FILEFORMATS={bmp:!1,jpeg:!0,jpg:!0,png:!0,tif:!1,wdp:!1},URLPARAMS={};function getOffsetParent(C,b){return b&&C!=document.body?document.body:C.offsetParent}(function(){var C=navigator.appVersion,b=navigator.userAgent;switch(navigator.appName){case"Microsoft Internet Explorer":window.attachEvent&&window.ActiveXObject&&($.Browser.vendor=$.BROWSERS.IE,$.Browser.version=parseFloat(b.substring(b.indexOf("MSIE")+5,b.indexOf(";",b.indexOf("MSIE")))));break;case"Netscape":window.addEventListener&&(b.indexOf("Firefox")>=0?($.Browser.vendor=$.BROWSERS.FIREFOX,$.Browser.version=parseFloat(b.substring(b.indexOf("Firefox")+8))):b.indexOf("Safari")>=0?($.Browser.vendor=b.indexOf("Chrome")>=0?$.BROWSERS.CHROME:$.BROWSERS.SAFARI,$.Browser.version=parseFloat(b.substring(b.substring(0,b.indexOf("Safari")).lastIndexOf("/")+1,b.indexOf("Safari")))):null!==new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})").exec(b)&&($.Browser.vendor=$.BROWSERS.IE,$.Browser.version=parseFloat(RegExp.$1)));break;case"Opera":$.Browser.vendor=$.BROWSERS.OPERA,$.Browser.version=parseFloat(C)}var z,V,W,H=window.location.search.substring(1).split("&");for(W=0;W<H.length;W++)if((V=(z=H[W]).indexOf("="))>0){var te=z.substring(0,V),Q=z.substring(V+1);try{URLPARAMS[te]=decodeURIComponent(Q)}catch(he){$.console.error("Ignoring malformed URL parameter: %s=%s",te,Q)}}$.Browser.alpha=!($.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<9||$.Browser.vendor==$.BROWSERS.CHROME&&$.Browser.version<2),$.Browser.opacity=!($.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<9)})(),function(C){var b=C.requestAnimationFrame||C.mozRequestAnimationFrame||C.webkitRequestAnimationFrame||C.msRequestAnimationFrame,D=C.cancelAnimationFrame||C.mozCancelAnimationFrame||C.webkitCancelAnimationFrame||C.msCancelAnimationFrame;if(b&&D)$.requestAnimationFrame=function(){return b.apply(C,arguments)},$.cancelAnimationFrame=function(){return D.apply(C,arguments)};else{var V,F=[],H=[],z=0;$.requestAnimationFrame=function(W){return F.push([++z,W]),V||(V=setInterval(function(){if(F.length){var te=$.now(),Q=H;for(H=F,F=Q;H.length;)H.shift()[1](te)}else clearInterval(V),V=void 0},20)),z},$.cancelAnimationFrame=function(W){var te,Q;for(te=0,Q=F.length;te<Q;te+=1)if(F[te][0]===W)return void F.splice(te,1);for(te=0,Q=H.length;te<Q;te+=1)if(H[te][0]===W)return void H.splice(te,1)}}}(window)}(OpenSeadragon),__WEBPACK_AMD_DEFINE_ARRAY__=[],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=function(){return OpenSeadragon})?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__),C=OpenSeadragon,b={supportsFullScreen:!1,isFullScreen:function(){return!1},getFullScreenElement:function(){return null},requestFullScreen:function(){},exitFullScreen:function(){},cancelFullScreen:function(){},fullScreenEventName:"",fullScreenErrorEventName:""},document.exitFullscreen?(b.supportsFullScreen=!0,b.getFullScreenElement=function(){return document.fullscreenElement},b.requestFullScreen=function(D){return D.requestFullscreen()},b.exitFullScreen=function(){document.exitFullscreen()},b.fullScreenEventName="fullscreenchange",b.fullScreenErrorEventName="fullscreenerror"):document.msExitFullscreen?(b.supportsFullScreen=!0,b.getFullScreenElement=function(){return document.msFullscreenElement},b.requestFullScreen=function(D){return D.msRequestFullscreen()},b.exitFullScreen=function(){document.msExitFullscreen()},b.fullScreenEventName="MSFullscreenChange",b.fullScreenErrorEventName="MSFullscreenError"):document.webkitExitFullscreen?(b.supportsFullScreen=!0,b.getFullScreenElement=function(){return document.webkitFullscreenElement},b.requestFullScreen=function(D){return D.webkitRequestFullscreen()},b.exitFullScreen=function(){document.webkitExitFullscreen()},b.fullScreenEventName="webkitfullscreenchange",b.fullScreenErrorEventName="webkitfullscreenerror"):document.webkitCancelFullScreen?(b.supportsFullScreen=!0,b.getFullScreenElement=function(){return document.webkitCurrentFullScreenElement},b.requestFullScreen=function(D){return D.webkitRequestFullScreen()},b.exitFullScreen=function(){document.webkitCancelFullScreen()},b.fullScreenEventName="webkitfullscreenchange",b.fullScreenErrorEventName="webkitfullscreenerror"):document.mozCancelFullScreen&&(b.supportsFullScreen=!0,b.getFullScreenElement=function(){return document.mozFullScreenElement},b.requestFullScreen=function(D){return D.mozRequestFullScreen()},b.exitFullScreen=function(){document.mozCancelFullScreen()},b.fullScreenEventName="mozfullscreenchange",b.fullScreenErrorEventName="mozfullscreenerror"),b.isFullScreen=function(){return null!==b.getFullScreenElement()},b.cancelFullScreen=function(){C.console.error("cancelFullScreen is deprecated. Use exitFullScreen instead."),b.exitFullScreen()},C.extend(C,b),function(C){C.EventSource=function(){this.events={}},C.EventSource.prototype={addOnceHandler:function(b,D,F,H){var z=this;H=H||1;var V=0,W=function(te){++V===H&&z.removeHandler(b,W),D(te)};this.addHandler(b,W,F)},addHandler:function(b,D,F){var H=this.events[b];H||(this.events[b]=H=[]),D&&C.isFunction(D)&&(H[H.length]={handler:D,userData:F||null})},removeHandler:function(b,D){var z,F=this.events[b],H=[];if(F&&C.isArray(F)){for(z=0;z<F.length;z++)F[z].handler!==D&&H.push(F[z]);this.events[b]=H}},removeAllHandlers:function(b){if(b)this.events[b]=[];else for(var D in this.events)this.events[D]=[]},getHandler:function(b){var D=this.events[b];return D&&D.length?(D=1===D.length?[D[0]]:Array.apply(null,D),function(F,H){var z,V=D.length;for(z=0;z<V;z++)D[z]&&(H.eventSource=F,H.userData=D[z].userData,D[z].handler(H))}):null},raiseEvent:function(b,D){var F=this.getHandler(b);F&&(D||(D={}),F(this,D))}}}(OpenSeadragon),function(C){var ve,pe,st,tt,Ni,b=[],D={};function F(ve){var st,pe=D[ve.hash],tt=pe.activePointersLists.length;for(st=0;st<tt;st++)pe.activePointersLists[st].captureCount>0&&(C.removeEvent(C.MouseTracker.captureElement,"mousemove",pe.mousemovecaptured,!0),C.removeEvent(C.MouseTracker.captureElement,"mouseup",pe.mouseupcaptured,!0),C.removeEvent(C.MouseTracker.captureElement,C.MouseTracker.unprefixedPointerEvents?"pointermove":"MSPointerMove",pe.pointermovecaptured,!0),C.removeEvent(C.MouseTracker.captureElement,C.MouseTracker.unprefixedPointerEvents?"pointerup":"MSPointerUp",pe.pointerupcaptured,!0),C.removeEvent(C.MouseTracker.captureElement,"touchmove",pe.touchmovecaptured,!0),C.removeEvent(C.MouseTracker.captureElement,"touchend",pe.touchendcaptured,!0),pe.activePointersLists[st].captureCount=0);for(st=0;st<tt;st++)pe.activePointersLists.pop()}function z(ve){var st,tt,pe=D[ve.hash];if(pe.tracking){for(tt=0;tt<C.MouseTracker.subscribeEvents.length;tt++)C.removeEvent(ve.element,st=C.MouseTracker.subscribeEvents[tt],pe[st],!1);F(ve),pe.tracking=!1}}function V(ve,pe){var st=D[ve.hash];if("pointerevent"===pe)return{upName:C.MouseTracker.unprefixedPointerEvents?"pointerup":"MSPointerUp",upHandler:st.pointerupcaptured,moveName:C.MouseTracker.unprefixedPointerEvents?"pointermove":"MSPointerMove",moveHandler:st.pointermovecaptured};if("mouse"===pe)return{upName:"mouseup",upHandler:st.mouseupcaptured,moveName:"mousemove",moveHandler:st.mousemovecaptured};if("touch"===pe)return{upName:"touchend",upHandler:st.touchendcaptured,moveName:"touchmove",moveHandler:st.touchmovecaptured};throw new Error("MouseTracker.getCaptureEventParams: Unknown pointer type.")}function W(ve,pe,st){var Ni,tt=ve.getActivePointersListByType(pe);tt.captureCount+=st||1,1===tt.captureCount&&(C.Browser.vendor===C.BROWSERS.IE&&C.Browser.version<9?ve.element.setCapture(!0):(Ni=V(ve,C.MouseTracker.havePointerEvents?"pointerevent":pe),ro&&Oc(window.top)&&C.addEvent(window.top,Ni.upName,Ni.upHandler,!0),C.addEvent(C.MouseTracker.captureElement,Ni.upName,Ni.upHandler,!0),C.addEvent(C.MouseTracker.captureElement,Ni.moveName,Ni.moveHandler,!0)))}function te(ve,pe,st){var Ni,tt=ve.getActivePointersListByType(pe);tt.captureCount-=st||1,0===tt.captureCount&&(C.Browser.vendor===C.BROWSERS.IE&&C.Browser.version<9?ve.element.releaseCapture():(Ni=V(ve,C.MouseTracker.havePointerEvents?"pointerevent":pe),ro&&Oc(window.top)&&C.removeEvent(window.top,Ni.upName,Ni.upHandler,!0),C.removeEvent(C.MouseTracker.captureElement,Ni.moveName,Ni.moveHandler,!0),C.removeEvent(C.MouseTracker.captureElement,Ni.upName,Ni.upHandler,!0)))}function Q(ve){var pe;if(C.MouseTracker.unprefixedPointerEvents)pe=ve.pointerType;else switch(ve.pointerType){case 2:pe="touch";break;case 3:pe="pen";break;case 4:pe="mouse";break;default:pe=""}return pe}function he(ve){return C.getMousePosition(ve)}function be(ve,pe){return ae(he(ve),pe)}function ae(ve,pe){var st=C.getElementOffset(pe);return ve.minus(st)}function Te(ve,pe){return new C.Point((ve.x+pe.x)/2,(ve.y+pe.y)/2)}function Ae(ve,pe){ve.clickHandler&&C.cancelEvent(pe)}function me(ve,pe){ve.dblClickHandler&&C.cancelEvent(pe)}function G(ve,pe){ve.keyDownHandler&&(pe=C.getEvent(pe),ve.keyDownHandler({eventSource:ve,keyCode:pe.keyCode?pe.keyCode:pe.charCode,ctrl:pe.ctrlKey,shift:pe.shiftKey,alt:pe.altKey,meta:pe.metaKey,originalEvent:pe,preventDefaultAction:!1,userData:ve.userData})||C.cancelEvent(pe))}function de(ve,pe){ve.keyUpHandler&&(pe=C.getEvent(pe),ve.keyUpHandler({eventSource:ve,keyCode:pe.keyCode?pe.keyCode:pe.charCode,ctrl:pe.ctrlKey,shift:pe.shiftKey,alt:pe.altKey,meta:pe.metaKey,originalEvent:pe,preventDefaultAction:!1,userData:ve.userData})||C.cancelEvent(pe))}function we(ve,pe){ve.keyHandler&&(pe=C.getEvent(pe),ve.keyHandler({eventSource:ve,keyCode:pe.keyCode?pe.keyCode:pe.charCode,ctrl:pe.ctrlKey,shift:pe.shiftKey,alt:pe.altKey,meta:pe.metaKey,originalEvent:pe,preventDefaultAction:!1,userData:ve.userData})||C.cancelEvent(pe))}function Fe(ve,pe){ve.focusHandler&&(pe=C.getEvent(pe),!1===ve.focusHandler({eventSource:ve,originalEvent:pe,preventDefaultAction:!1,userData:ve.userData})&&C.cancelEvent(pe))}function Le(ve,pe){ve.blurHandler&&(pe=C.getEvent(pe),!1===ve.blurHandler({eventSource:ve,originalEvent:pe,preventDefaultAction:!1,userData:ve.userData})&&C.cancelEvent(pe))}function it(ve,pe){Dt(ve,pe,pe)}function at(ve,pe){var st={target:(pe=C.getEvent(pe)).target||pe.srcElement,type:"wheel",shiftKey:pe.shiftKey||!1,clientX:pe.clientX,clientY:pe.clientY,pageX:pe.pageX?pe.pageX:pe.clientX,pageY:pe.pageY?pe.pageY:pe.clientY,deltaMode:"MozMousePixelScroll"==pe.type?0:1,deltaX:0,deltaZ:0};st.deltaY="mousewheel"==C.MouseTracker.wheelEventName?-pe.wheelDelta/C.DEFAULT_SETTINGS.pixelsPerWheelLine:pe.detail,Dt(ve,st,pe)}function Dt(ve,pe,st){var tt;tt=pe.deltaY<0?1:-1,ve.scrollHandler&&!1===ve.scrollHandler({eventSource:ve,pointerType:"mouse",position:be(pe,ve.element),scroll:tt,shift:pe.shiftKey,isTouchEvent:!1,originalEvent:st,preventDefaultAction:!1,userData:ve.userData})&&C.cancelEvent(st)}function dt(ve,pe){if(ve===pe)return!1;for(;pe&&pe!==ve;)pe=pe.parentNode;return pe===ve}function Kt(ve,pe){We(ve,pe=C.getEvent(pe))}function oi(ve,pe){(pe=C.getEvent(pe)).currentTarget!==pe.relatedTarget&&!dt(pe.currentTarget,pe.relatedTarget)&&We(ve,pe)}function We(ve,pe){_r(ve,pe,[{id:C.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:he(pe),currentTime:C.now()}])}function xt(ve,pe){Lt(ve,pe=C.getEvent(pe))}function _e(ve,pe){(pe=C.getEvent(pe)).currentTarget!==pe.relatedTarget&&!dt(pe.currentTarget,pe.relatedTarget)&&Lt(ve,pe)}function Lt(ve,pe){rr(ve,pe,[{id:C.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:he(pe),currentTime:C.now()}])}function $i(ve){return C.Browser.vendor===C.BROWSERS.IE&&C.Browser.version<9?1===ve?0:2===ve?2:4===ve?1:-1:ve}function Wt(ve,pe){Vo(ve,pe=C.getEvent(pe),[{id:C.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:he(pe),currentTime:C.now()}],$i(pe.button))&&(C.stopEvent(pe),W(ve,"mouse")),(ve.clickHandler||ve.dblClickHandler||ve.pressHandler||ve.dragHandler||ve.dragEndHandler)&&C.cancelEvent(pe)}function Ei(ve,pe){On(ve,pe)}function Rt(ve,pe){On(ve,pe),C.stopEvent(pe)}function On(ve,pe){Eo(ve,pe=C.getEvent(pe),[{id:C.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:he(pe),currentTime:C.now()}],$i(pe.button))&&te(ve,"mouse")}function Ct(ve,pe){bn(ve,pe)}function ft(ve,pe){bn(ve,pe),C.stopEvent(pe)}function bn(ve,pe){oa(ve,pe=C.getEvent(pe),[{id:C.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:he(pe),currentTime:C.now()}])}function qi(ve,pe,st){var tt,Ni=st.getLength(),_n=[];if("touch"===st.type||st.contacts>0){for(tt=0;tt<Ni;tt++)_n.push(st.getByIndex(tt));_n.length>0&&(Eo(ve,pe,_n,0),st.captureCount=1,te(ve,st.type),rr(ve,pe,_n))}}function Fi(ve,pe){var st,tt,Ni,Xi,_n=pe.changedTouches.length,Gi=[],Xn=ve.getActivePointersListByType("touch");for(st=C.now(),Xn.getLength()>pe.touches.length-_n&&(C.console.warn("Tracked touch contact count doesn't match event.touches.length. Removing all tracked touch pointers."),qi(ve,pe,Xn)),tt=0;tt<_n;tt++)Gi.push({id:pe.changedTouches[tt].identifier,type:"touch",currentPos:he(pe.changedTouches[tt]),currentTime:st});for(_r(ve,pe,Gi),tt=0;tt<b.length;tt++)if(b[tt]!==ve&&b[tt].isTracking()&&dt(b[tt].element,ve.element)){for(Xi=[],Ni=0;Ni<_n;Ni++)Xi.push({id:pe.changedTouches[Ni].identifier,type:"touch",currentPos:he(pe.changedTouches[Ni]),currentTime:st});_r(b[tt],pe,Xi)}Vo(ve,pe,Gi,0)&&(C.stopEvent(pe),W(ve,"touch",_n)),C.cancelEvent(pe)}function cr(ve,pe){mr(ve,pe)}function ii(ve,pe){mr(ve,pe),C.stopEvent(pe)}function mr(ve,pe){var st,tt,Ni,Xi,_n=pe.changedTouches.length,Gi=[];for(st=C.now(),tt=0;tt<_n;tt++)Gi.push({id:pe.changedTouches[tt].identifier,type:"touch",currentPos:he(pe.changedTouches[tt]),currentTime:st});for(Eo(ve,pe,Gi,0)&&te(ve,"touch",_n),rr(ve,pe,Gi),tt=0;tt<b.length;tt++)if(b[tt]!==ve&&b[tt].isTracking()&&dt(b[tt].element,ve.element)){for(Xi=[],Ni=0;Ni<_n;Ni++)Xi.push({id:pe.changedTouches[Ni].identifier,type:"touch",currentPos:he(pe.changedTouches[Ni]),currentTime:st});rr(b[tt],pe,Xi)}C.cancelEvent(pe)}function zr(ve,pe){qn(ve,pe)}function gr(ve,pe){qn(ve,pe),C.stopEvent(pe)}function qn(ve,pe){var st,tt=pe.changedTouches.length,Ni=[];for(st=0;st<tt;st++)Ni.push({id:pe.changedTouches[st].identifier,type:"touch",currentPos:he(pe.changedTouches[st]),currentTime:C.now()});oa(ve,pe,Ni),C.cancelEvent(pe)}function za(ve,pe){var st=ve.getActivePointersListByType("touch");qi(ve,pe,st)}function Ui(ve,pe){return pe.stopPropagation(),pe.preventDefault(),!1}function O(ve,pe){return pe.stopPropagation(),pe.preventDefault(),!1}function Me(ve,pe){pe.currentTarget===pe.relatedTarget||dt(pe.currentTarget,pe.relatedTarget)||_r(ve,pe,[{id:pe.pointerId,type:Q(pe),isPrimary:pe.isPrimary,currentPos:he(pe),currentTime:C.now()}])}function Ke(ve,pe){pe.currentTarget===pe.relatedTarget||dt(pe.currentTarget,pe.relatedTarget)||rr(ve,pe,[{id:pe.pointerId,type:Q(pe),isPrimary:pe.isPrimary,currentPos:he(pe),currentTime:C.now()}])}function ke(ve,pe){var st;Vo(ve,pe,[st={id:pe.pointerId,type:Q(pe),isPrimary:pe.isPrimary,currentPos:he(pe),currentTime:C.now()}],pe.button)&&(C.stopEvent(pe),W(ve,st.type)),(ve.clickHandler||ve.dblClickHandler||ve.pressHandler||ve.dragHandler||ve.dragEndHandler||ve.pinchHandler)&&C.cancelEvent(pe)}function Ee(ve,pe){Tt(ve,pe)}function ut(ve,pe){ve.getActivePointersListByType(Q(pe)).getById(pe.pointerId)&&Tt(ve,pe),C.stopEvent(pe)}function Tt(ve,pe){var st;Eo(ve,pe,[st={id:pe.pointerId,type:Q(pe),isPrimary:pe.isPrimary,currentPos:he(pe),currentTime:C.now()}],pe.button)&&te(ve,st.type)}function $t(ve,pe){ri(ve,pe)}function wt(ve,pe){ve.getActivePointersListByType(Q(pe)).getById(pe.pointerId)&&ri(ve,pe),C.stopEvent(pe)}function ri(ve,pe){oa(ve,pe,[{id:pe.pointerId,type:Q(pe),isPrimary:pe.isPrimary,currentPos:he(pe),currentTime:C.now()}])}function di(ve,pe){!function Lo(ve,pe,st){Eo(ve,pe,st,0),rr(ve,pe,st)}(ve,pe,[{id:pe.pointerId,type:Q(pe)}])}function fi(ve,pe){return Object.prototype.hasOwnProperty.call(pe,"isPrimary")||(pe.isPrimary=0===ve.getLength()),pe.speed=0,pe.direction=0,pe.contactPos=pe.currentPos,pe.contactTime=pe.currentTime,pe.lastPos=pe.currentPos,pe.lastTime=pe.currentTime,ve.add(pe)}function Hi(ve,pe){var st,tt;return ve.getById(pe.id)?(st=ve.removeById(pe.id),Object.prototype.hasOwnProperty.call(pe,"isPrimary")||(tt=ve.getPrimary())||(tt=ve.getByIndex(0))&&(tt.isPrimary=!0)):st=ve.getLength(),st}function _r(ve,pe,st){var Ni,Gi,Xi,tt=ve.getActivePointersListByType(st[0].type),_n=st.length;for(Ni=0;Ni<_n;Ni++)(Xi=tt.getById((Gi=st[Ni]).id))?(Xi.insideElement=!0,Xi.lastPos=Xi.currentPos,Xi.lastTime=Xi.currentTime,Xi.currentPos=Gi.currentPos,Xi.currentTime=Gi.currentTime,Gi=Xi):(Gi.captured=!1,Gi.insideElementPressed=!1,Gi.insideElement=!0,fi(tt,Gi)),ve.enterHandler&&!1===ve.enterHandler({eventSource:ve,pointerType:Gi.type,position:ae(Gi.currentPos,ve.element),buttons:tt.buttons,pointers:ve.getActivePointerCount(),insideElementPressed:Gi.insideElementPressed,buttonDownAny:0!==tt.buttons,isTouchEvent:"touch"===Gi.type,originalEvent:pe,preventDefaultAction:!1,userData:ve.userData})&&C.cancelEvent(pe)}function rr(ve,pe,st){var Ni,Gi,Xi,tt=ve.getActivePointersListByType(st[0].type),_n=st.length;for(Ni=0;Ni<_n;Ni++)(Xi=tt.getById((Gi=st[Ni]).id))&&(Xi.captured?(Xi.insideElement=!1,Xi.lastPos=Xi.currentPos,Xi.lastTime=Xi.currentTime,Xi.currentPos=Gi.currentPos,Xi.currentTime=Gi.currentTime):Hi(tt,Xi),Gi=Xi),ve.exitHandler&&!1===ve.exitHandler({eventSource:ve,pointerType:Gi.type,position:Gi.currentPos&&ae(Gi.currentPos,ve.element),buttons:tt.buttons,pointers:ve.getActivePointerCount(),insideElementPressed:!!Xi&&Xi.insideElementPressed,buttonDownAny:0!==tt.buttons,isTouchEvent:"touch"===Gi.type,originalEvent:pe,preventDefaultAction:!1,userData:ve.userData})&&C.cancelEvent(pe)}function Vo(ve,pe,st,tt){var Xi,cs,Rr,Ni=D[ve.hash],Gi=ve.getActivePointersListByType(st[0].type),Xn=st.length;void 0!==pe.buttons?Gi.buttons=pe.buttons:C.Browser.vendor===C.BROWSERS.IE&&C.Browser.version<9?0===tt?Gi.buttons+=1:1===tt?Gi.buttons+=4:2===tt?Gi.buttons+=2:3===tt?Gi.buttons+=8:4===tt?Gi.buttons+=16:5===tt&&(Gi.buttons+=32):0===tt?Gi.buttons|=1:1===tt?Gi.buttons|=4:2===tt?Gi.buttons|=2:3===tt?Gi.buttons|=8:4===tt?Gi.buttons|=16:5===tt&&(Gi.buttons|=32);var vs=ve.getActivePointersListsExceptType(st[0].type);for(Xi=0;Xi<vs.length;Xi++)qi(ve,pe,vs[Xi]);if(0!==tt)return ve.nonPrimaryPressHandler&&!1===ve.nonPrimaryPressHandler({eventSource:ve,pointerType:st[0].type,position:ae(st[0].currentPos,ve.element),button:tt,buttons:Gi.buttons,isTouchEvent:"touch"===st[0].type,originalEvent:pe,preventDefaultAction:!1,userData:ve.userData})&&C.cancelEvent(pe),!1;for(Xi=0;Xi<Xn;Xi++)(Rr=Gi.getById((cs=st[Xi]).id))?(Rr.captured=!0,Rr.insideElementPressed=!0,Rr.insideElement=!0,Rr.contactPos=cs.currentPos,Rr.contactTime=cs.currentTime,Rr.lastPos=Rr.currentPos,Rr.lastTime=Rr.currentTime,Rr.currentPos=cs.currentPos,Rr.currentTime=cs.currentTime,cs=Rr):(cs.captured=!0,cs.insideElementPressed=!0,cs.insideElement=!0,fi(Gi,cs)),Gi.addContact(),(ve.dragHandler||ve.dragEndHandler||ve.pinchHandler)&&C.MouseTracker.gesturePointVelocityTracker.addPoint(ve,cs),1===Gi.contacts?ve.pressHandler&&!1===ve.pressHandler({eventSource:ve,pointerType:cs.type,position:ae(cs.contactPos,ve.element),buttons:Gi.buttons,isTouchEvent:"touch"===cs.type,originalEvent:pe,preventDefaultAction:!1,userData:ve.userData})&&C.cancelEvent(pe):2===Gi.contacts&&ve.pinchHandler&&"touch"===cs.type&&(Ni.pinchGPoints=Gi.asArray(),Ni.lastPinchDist=Ni.currentPinchDist=Ni.pinchGPoints[0].currentPos.distanceTo(Ni.pinchGPoints[1].currentPos),Ni.lastPinchCenter=Ni.currentPinchCenter=Te(Ni.pinchGPoints[0].currentPos,Ni.pinchGPoints[1].currentPos));return!0}function Eo(ve,pe,st,tt){var Xi,Xn,cs,vs,kr,Sa,Ni=D[ve.hash],_n=ve.getActivePointersListByType(st[0].type),Rr=st.length,ic=!1,eo=!1;if(void 0!==pe.buttons?_n.buttons=pe.buttons:C.Browser.vendor===C.BROWSERS.IE&&C.Browser.version<9?0===tt?_n.buttons-=1:1===tt?_n.buttons-=4:2===tt?_n.buttons-=2:3===tt?_n.buttons-=8:4===tt?_n.buttons-=16:5===tt&&(_n.buttons-=32):0===tt?_n.buttons^=-2:1===tt?_n.buttons^=-5:2===tt?_n.buttons^=-3:3===tt?_n.buttons^=-9:4===tt?_n.buttons^=-17:5===tt&&(_n.buttons^=-33),0!==tt){ve.nonPrimaryReleaseHandler&&!1===ve.nonPrimaryReleaseHandler({eventSource:ve,pointerType:st[0].type,position:ae(st[0].currentPos,ve.element),button:tt,buttons:_n.buttons,isTouchEvent:"touch"===st[0].type,originalEvent:pe,preventDefaultAction:!1,userData:ve.userData})&&C.cancelEvent(pe);var Bg=ve.getActivePointersListByType("mouse");return qi(ve,pe,Bg),!1}if(void 0===st[0].currentPos)return qi(ve,pe,_n),!1;for(cs=0;cs<Rr;cs++)(kr=_n.getById((vs=st[cs]).id))&&(kr.captured&&(kr.captured=!1,ic=!0,eo=!0),kr.lastPos=kr.currentPos,kr.lastTime=kr.currentTime,kr.currentPos=vs.currentPos,kr.currentTime=vs.currentTime,kr.insideElement||Hi(_n,kr),Xi=kr.currentPos,Xn=kr.currentTime,eo?(_n.removeContact(),(ve.dragHandler||ve.dragEndHandler||ve.pinchHandler)&&C.MouseTracker.gesturePointVelocityTracker.removePoint(ve,kr),0===_n.contacts?(ve.releaseHandler&&!1===ve.releaseHandler({eventSource:ve,pointerType:kr.type,position:ae(Xi,ve.element),buttons:_n.buttons,insideElementPressed:kr.insideElementPressed,insideElementReleased:kr.insideElement,isTouchEvent:"touch"===kr.type,originalEvent:pe,preventDefaultAction:!1,userData:ve.userData})&&C.cancelEvent(pe),ve.dragEndHandler&&!kr.currentPos.equals(kr.contactPos)&&!1===ve.dragEndHandler({eventSource:ve,pointerType:kr.type,position:ae(kr.currentPos,ve.element),speed:kr.speed,direction:kr.direction,shift:pe.shiftKey,isTouchEvent:"touch"===kr.type,originalEvent:pe,preventDefaultAction:!1,userData:ve.userData})&&C.cancelEvent(pe),(ve.clickHandler||ve.dblClickHandler)&&kr.insideElement&&(Sa=Xn-kr.contactTime<=ve.clickTimeThreshold&&kr.contactPos.distanceTo(Xi)<=ve.clickDistThreshold,ve.clickHandler&&!1===ve.clickHandler({eventSource:ve,pointerType:kr.type,position:ae(kr.currentPos,ve.element),quick:Sa,shift:pe.shiftKey,isTouchEvent:"touch"===kr.type,originalEvent:pe,preventDefaultAction:!1,userData:ve.userData})&&C.cancelEvent(pe),ve.dblClickHandler&&Sa&&(_n.clicks++,1===_n.clicks?(Ni.lastClickPos=Xi,Ni.dblClickTimeOut=setTimeout(function(){_n.clicks=0},ve.dblClickTimeThreshold)):2===_n.clicks&&(clearTimeout(Ni.dblClickTimeOut),_n.clicks=0,Ni.lastClickPos.distanceTo(Xi)<=ve.dblClickDistThreshold&&!1===ve.dblClickHandler({eventSource:ve,pointerType:kr.type,position:ae(kr.currentPos,ve.element),shift:pe.shiftKey,isTouchEvent:"touch"===kr.type,originalEvent:pe,preventDefaultAction:!1,userData:ve.userData})&&C.cancelEvent(pe),Ni.lastClickPos=null)))):2===_n.contacts&&ve.pinchHandler&&"touch"===kr.type&&(Ni.pinchGPoints=_n.asArray(),Ni.lastPinchDist=Ni.currentPinchDist=Ni.pinchGPoints[0].currentPos.distanceTo(Ni.pinchGPoints[1].currentPos),Ni.lastPinchCenter=Ni.currentPinchCenter=Te(Ni.pinchGPoints[0].currentPos,Ni.pinchGPoints[1].currentPos))):ve.releaseHandler&&!1===ve.releaseHandler({eventSource:ve,pointerType:kr.type,position:ae(Xi,ve.element),buttons:_n.buttons,insideElementPressed:kr.insideElementPressed,insideElementReleased:kr.insideElement,isTouchEvent:"touch"===kr.type,originalEvent:pe,preventDefaultAction:!1,userData:ve.userData})&&C.cancelEvent(pe));return ic}function oa(ve,pe,st){var _n,Xi,Xn,cs,Rr,tt=D[ve.hash],Ni=ve.getActivePointersListByType(st[0].type),Gi=st.length;for(void 0!==pe.buttons&&(Ni.buttons=pe.buttons),_n=0;_n<Gi;_n++)(Xn=Ni.getById((Xi=st[_n]).id))?(Object.prototype.hasOwnProperty.call(Xi,"isPrimary")&&(Xn.isPrimary=Xi.isPrimary),Xn.lastPos=Xn.currentPos,Xn.lastTime=Xn.currentTime,Xn.currentPos=Xi.currentPos,Xn.currentTime=Xi.currentTime):(Xi.captured=!1,Xi.insideElementPressed=!1,Xi.insideElement=!0,fi(Ni,Xi));ve.stopHandler&&"mouse"===st[0].type&&(clearTimeout(ve.stopTimeOut),ve.stopTimeOut=setTimeout(function(){!function no(ve,pe,st){ve.stopHandler&&ve.stopHandler({eventSource:ve,pointerType:st,position:be(pe,ve.element),buttons:ve.getActivePointersListByType(st).buttons,isTouchEvent:"touch"===st,originalEvent:pe,preventDefaultAction:!1,userData:ve.userData})}(ve,pe,st[0].type)},ve.stopDelay)),0===Ni.contacts?ve.moveHandler&&!1===ve.moveHandler({eventSource:ve,pointerType:st[0].type,position:ae(st[0].currentPos,ve.element),buttons:Ni.buttons,isTouchEvent:"touch"===st[0].type,originalEvent:pe,preventDefaultAction:!1,userData:ve.userData})&&C.cancelEvent(pe):1===Ni.contacts?(ve.moveHandler&&(Xn=Ni.asArray()[0],!1===ve.moveHandler({eventSource:ve,pointerType:Xn.type,position:ae(Xn.currentPos,ve.element),buttons:Ni.buttons,isTouchEvent:"touch"===Xn.type,originalEvent:pe,preventDefaultAction:!1,userData:ve.userData})&&C.cancelEvent(pe)),ve.dragHandler&&(Rr=(Xn=Ni.asArray()[0]).currentPos.minus(Xn.lastPos),!1===ve.dragHandler({eventSource:ve,pointerType:Xn.type,position:ae(Xn.currentPos,ve.element),buttons:Ni.buttons,delta:Rr,speed:Xn.speed,direction:Xn.direction,shift:pe.shiftKey,isTouchEvent:"touch"===Xn.type,originalEvent:pe,preventDefaultAction:!1,userData:ve.userData})&&C.cancelEvent(pe))):2===Ni.contacts&&(ve.moveHandler&&(cs=Ni.asArray(),!1===ve.moveHandler({eventSource:ve,pointerType:cs[0].type,position:ae(Te(cs[0].currentPos,cs[1].currentPos),ve.element),buttons:Ni.buttons,isTouchEvent:"touch"===cs[0].type,originalEvent:pe,preventDefaultAction:!1,userData:ve.userData})&&C.cancelEvent(pe)),ve.pinchHandler&&"touch"===st[0].type&&(Rr=tt.pinchGPoints[0].currentPos.distanceTo(tt.pinchGPoints[1].currentPos))!=tt.currentPinchDist&&(tt.lastPinchDist=tt.currentPinchDist,tt.currentPinchDist=Rr,tt.lastPinchCenter=tt.currentPinchCenter,tt.currentPinchCenter=Te(tt.pinchGPoints[0].currentPos,tt.pinchGPoints[1].currentPos),!1===ve.pinchHandler({eventSource:ve,pointerType:"touch",gesturePoints:tt.pinchGPoints,lastCenter:ae(tt.lastPinchCenter,ve.element),center:ae(tt.currentPinchCenter,ve.element),lastDistance:tt.lastPinchDist,distance:tt.currentPinchDist,shift:pe.shiftKey,originalEvent:pe,preventDefaultAction:!1,userData:ve.userData})&&C.cancelEvent(pe)))}C.MouseTracker=function(ve){b.push(this);var pe=arguments;C.isPlainObject(ve)||(ve={element:pe[0],clickTimeThreshold:pe[1],clickDistThreshold:pe[2]}),this.hash=Math.random(),this.element=C.getElement(ve.element),this.clickTimeThreshold=ve.clickTimeThreshold||C.DEFAULT_SETTINGS.clickTimeThreshold,this.clickDistThreshold=ve.clickDistThreshold||C.DEFAULT_SETTINGS.clickDistThreshold,this.dblClickTimeThreshold=ve.dblClickTimeThreshold||C.DEFAULT_SETTINGS.dblClickTimeThreshold,this.dblClickDistThreshold=ve.dblClickDistThreshold||C.DEFAULT_SETTINGS.dblClickDistThreshold,this.userData=ve.userData||null,this.stopDelay=ve.stopDelay||50,this.enterHandler=ve.enterHandler||null,this.exitHandler=ve.exitHandler||null,this.pressHandler=ve.pressHandler||null,this.nonPrimaryPressHandler=ve.nonPrimaryPressHandler||null,this.releaseHandler=ve.releaseHandler||null,this.nonPrimaryReleaseHandler=ve.nonPrimaryReleaseHandler||null,this.moveHandler=ve.moveHandler||null,this.scrollHandler=ve.scrollHandler||null,this.clickHandler=ve.clickHandler||null,this.dblClickHandler=ve.dblClickHandler||null,this.dragHandler=ve.dragHandler||null,this.dragEndHandler=ve.dragEndHandler||null,this.pinchHandler=ve.pinchHandler||null,this.stopHandler=ve.stopHandler||null,this.keyDownHandler=ve.keyDownHandler||null,this.keyUpHandler=ve.keyUpHandler||null,this.keyHandler=ve.keyHandler||null,this.focusHandler=ve.focusHandler||null,this.blurHandler=ve.blurHandler||null;var st=this;D[this.hash]={click:function(tt){Ae(st,tt)},dblclick:function(tt){me(st,tt)},keydown:function(tt){G(st,tt)},keyup:function(tt){de(st,tt)},keypress:function(tt){we(st,tt)},focus:function(tt){Fe(st,tt)},blur:function(tt){Le(st,tt)},wheel:function(tt){it(st,tt)},mousewheel:function(tt){at(st,tt)},DOMMouseScroll:function(tt){at(st,tt)},MozMousePixelScroll:function(tt){at(st,tt)},mouseenter:function(tt){Kt(st,tt)},mouseleave:function(tt){xt(st,tt)},mouseover:function(tt){oi(st,tt)},mouseout:function(tt){_e(st,tt)},mousedown:function(tt){Wt(st,tt)},mouseup:function(tt){Ei(st,tt)},mouseupcaptured:function(tt){Rt(st,tt)},mousemove:function(tt){Ct(st,tt)},mousemovecaptured:function(tt){ft(st,tt)},touchstart:function(tt){Fi(st,tt)},touchend:function(tt){cr(st,tt)},touchendcaptured:function(tt){ii(st,tt)},touchmove:function(tt){zr(st,tt)},touchmovecaptured:function(tt){gr(st,tt)},touchcancel:function(tt){za(st,tt)},gesturestart:function(tt){Ui(0,tt)},gesturechange:function(tt){O(0,tt)},pointerover:function(tt){Me(st,tt)},MSPointerOver:function(tt){Me(st,tt)},pointerout:function(tt){Ke(st,tt)},MSPointerOut:function(tt){Ke(st,tt)},pointerdown:function(tt){ke(st,tt)},MSPointerDown:function(tt){ke(st,tt)},pointerup:function(tt){Ee(st,tt)},MSPointerUp:function(tt){Ee(st,tt)},pointermove:function(tt){$t(st,tt)},MSPointerMove:function(tt){$t(st,tt)},pointercancel:function(tt){di(st,tt)},MSPointerCancel:function(tt){di(st,tt)},pointerupcaptured:function(tt){ut(st,tt)},pointermovecaptured:function(tt){wt(st,tt)},tracking:!1,activePointersLists:[],lastClickPos:null,dblClickTimeOut:null,pinchGPoints:[],lastPinchDist:0,currentPinchDist:0,lastPinchCenter:null,currentPinchCenter:null},ve.startDisabled||this.setTracking(!0)},C.MouseTracker.prototype={destroy:function(){var ve;for(z(this),this.element=null,ve=0;ve<b.length;ve++)if(b[ve]===this){b.splice(ve,1);break}D[this.hash]=null,delete D[this.hash]},isTracking:function(){return D[this.hash].tracking},setTracking:function(ve){return ve?function H(ve){var st,tt,pe=D[ve.hash];if(!pe.tracking){for(tt=0;tt<C.MouseTracker.subscribeEvents.length;tt++)C.addEvent(ve.element,st=C.MouseTracker.subscribeEvents[tt],pe[st],!1);F(ve),pe.tracking=!0}}(this):z(this),this},getActivePointersListsExceptType:function(ve){for(var pe=D[this.hash],st=[],tt=0;tt<pe.activePointersLists.length;++tt)pe.activePointersLists[tt].type!==ve&&st.push(pe.activePointersLists[tt]);return st},getActivePointersListByType:function(ve){var st,Ni,pe=D[this.hash],tt=pe.activePointersLists.length;for(st=0;st<tt;st++)if(pe.activePointersLists[st].type===ve)return pe.activePointersLists[st];return Ni=new C.MouseTracker.GesturePointList(ve),pe.activePointersLists.push(Ni),Ni},getActivePointerCount:function(){var pe,ve=D[this.hash],st=ve.activePointersLists.length,tt=0;for(pe=0;pe<st;pe++)tt+=ve.activePointersLists[pe].getLength();return tt},enterHandler:function(){},exitHandler:function(){},pressHandler:function(){},nonPrimaryPressHandler:function(){},releaseHandler:function(){},nonPrimaryReleaseHandler:function(){},moveHandler:function(){},scrollHandler:function(){},clickHandler:function(){},dblClickHandler:function(){},dragHandler:function(){},dragEndHandler:function(){},pinchHandler:function(){},stopHandler:function(){},keyDownHandler:function(){},keyUpHandler:function(){},keyHandler:function(){},focusHandler:function(){},blurHandler:function(){}},C.MouseTracker.resetAllMouseTrackers=function(){for(var ve=0;ve<b.length;ve++)b[ve].isTracking()&&(b[ve].setTracking(!1),b[ve].setTracking(!0))},C.MouseTracker.gesturePointVelocityTracker=(ve=[],pe=0,st=0,tt=function(Xi,Xn){return Xi.hash.toString()+Xn.type+Xn.id.toString()},Ni=function(){var Xi,cs,Rr,kr,ic,Xn=ve.length,vs=C.now();for(kr=vs-st,st=vs,Xi=0;Xi<Xn;Xi++)(Rr=(cs=ve[Xi]).gPoint).direction=Math.atan2(Rr.currentPos.y-cs.lastPos.y,Rr.currentPos.x-cs.lastPos.x),ic=cs.lastPos.distanceTo(Rr.currentPos),cs.lastPos=Rr.currentPos,Rr.speed=1e3*ic/(kr+1)*.75+.25*Rr.speed},{addPoint:function(Xi,Xn){var cs=tt(Xi,Xn);ve.push({guid:cs,gPoint:Xn,lastPos:Xn.currentPos}),1===ve.length&&(st=C.now(),pe=window.setInterval(Ni,50))},removePoint:function(Xi,Xn){var Rr,cs=tt(Xi,Xn),vs=ve.length;for(Rr=0;Rr<vs;Rr++)if(ve[Rr].guid===cs){ve.splice(Rr,1),0==--vs&&window.clearInterval(pe);break}}}),C.MouseTracker.captureElement=document,C.MouseTracker.wheelEventName=C.Browser.vendor==C.BROWSERS.IE&&C.Browser.version>8||"onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",C.MouseTracker.supportsMouseCapture=function(){var ve=document.createElement("div");return C.isFunction(ve.setCapture)&&C.isFunction(ve.releaseCapture)}(),C.MouseTracker.subscribeEvents=["click","dblclick","keydown","keyup","keypress","focus","blur",C.MouseTracker.wheelEventName],"DOMMouseScroll"==C.MouseTracker.wheelEventName&&C.MouseTracker.subscribeEvents.push("MozMousePixelScroll"),window.PointerEvent&&(window.navigator.pointerEnabled||C.Browser.vendor!==C.BROWSERS.IE)?(C.MouseTracker.havePointerEvents=!0,C.MouseTracker.subscribeEvents.push("pointerover","pointerout","pointerdown","pointerup","pointermove","pointercancel"),C.MouseTracker.unprefixedPointerEvents=!0,C.MouseTracker.maxTouchPoints=navigator.maxTouchPoints?navigator.maxTouchPoints:0,C.MouseTracker.haveMouseEnter=!1):window.MSPointerEvent&&window.navigator.msPointerEnabled?(C.MouseTracker.havePointerEvents=!0,C.MouseTracker.subscribeEvents.push("MSPointerOver","MSPointerOut","MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"),C.MouseTracker.unprefixedPointerEvents=!1,C.MouseTracker.maxTouchPoints=navigator.msMaxTouchPoints?navigator.msMaxTouchPoints:0,C.MouseTracker.haveMouseEnter=!1):(C.MouseTracker.havePointerEvents=!1,C.Browser.vendor===C.BROWSERS.IE&&C.Browser.version<9?(C.MouseTracker.subscribeEvents.push("mouseenter","mouseleave"),C.MouseTracker.haveMouseEnter=!0):(C.MouseTracker.subscribeEvents.push("mouseover","mouseout"),C.MouseTracker.haveMouseEnter=!1),C.MouseTracker.subscribeEvents.push("mousedown","mouseup","mousemove"),"ontouchstart"in window&&C.MouseTracker.subscribeEvents.push("touchstart","touchend","touchmove","touchcancel"),"ongesturestart"in window&&C.MouseTracker.subscribeEvents.push("gesturestart","gesturechange"),C.MouseTracker.mousePointerId="legacy-mouse",C.MouseTracker.maxTouchPoints=10),C.MouseTracker.GesturePointList=function(ve){this._gPoints=[],this.type=ve,this.buttons=0,this.contacts=0,this.clicks=0,this.captureCount=0},C.MouseTracker.GesturePointList.prototype={getLength:function(){return this._gPoints.length},asArray:function(){return this._gPoints},add:function(ve){return this._gPoints.push(ve)},removeById:function(ve){var pe,st=this._gPoints.length;for(pe=0;pe<st;pe++)if(this._gPoints[pe].id===ve){this._gPoints.splice(pe,1);break}return this._gPoints.length},getByIndex:function(ve){return ve<this._gPoints.length?this._gPoints[ve]:null},getById:function(ve){var pe,st=this._gPoints.length;for(pe=0;pe<st;pe++)if(this._gPoints[pe].id===ve)return this._gPoints[pe];return null},getPrimary:function(ve){var pe,st=this._gPoints.length;for(pe=0;pe<st;pe++)if(this._gPoints[pe].isPrimary)return this._gPoints[pe];return null},addContact:function(){++this.contacts,this.contacts>1&&("mouse"===this.type||"pen"===this.type)&&(this.contacts=1)},removeContact:function(){--this.contacts,this.contacts<0&&(this.contacts=0)}};var ro=function(){try{return window.self!==window.top}catch(ve){return!0}}();function Oc(ve){try{return ve.addEventListener&&ve.removeEventListener}catch(pe){return!1}}}(OpenSeadragon),function(C){C.ControlAnchor={NONE:0,TOP_LEFT:1,TOP_RIGHT:2,BOTTOM_RIGHT:3,BOTTOM_LEFT:4,ABSOLUTE:5},C.Control=function(b,D,F){var H=b.parentNode;"number"==typeof D&&(C.console.error("Passing an anchor directly into the OpenSeadragon.Control constructor is deprecated; please use an options object instead.  Support for this deprecated variant is scheduled for removal in December 2013"),D={anchor:D}),D.attachToViewer=void 0===D.attachToViewer||D.attachToViewer,this.autoFade=void 0===D.autoFade||D.autoFade,this.element=b,this.anchor=D.anchor,this.container=F,this.anchor==C.ControlAnchor.ABSOLUTE?(this.wrapper=C.makeNeutralElement("div"),this.wrapper.style.position="absolute",this.wrapper.style.top="number"==typeof D.top?D.top+"px":D.top,this.wrapper.style.left="number"==typeof D.left?D.left+"px":D.left,this.wrapper.style.height="number"==typeof D.height?D.height+"px":D.height,this.wrapper.style.width="number"==typeof D.width?D.width+"px":D.width,this.wrapper.style.margin="0px",this.wrapper.style.padding="0px",this.element.style.position="relative",this.element.style.top="0px",this.element.style.left="0px",this.element.style.height="100%",this.element.style.width="100%"):(this.wrapper=C.makeNeutralElement("div"),this.wrapper.style.display="inline-block",this.anchor==C.ControlAnchor.NONE&&(this.wrapper.style.width=this.wrapper.style.height="100%")),this.wrapper.appendChild(this.element),D.attachToViewer?this.anchor==C.ControlAnchor.TOP_RIGHT||this.anchor==C.ControlAnchor.BOTTOM_RIGHT?this.container.insertBefore(this.wrapper,this.container.firstChild):this.container.appendChild(this.wrapper):H.appendChild(this.wrapper)},C.Control.prototype={destroy:function(){this.wrapper.removeChild(this.element),this.container.removeChild(this.wrapper)},isVisible:function(){return"none"!=this.wrapper.style.display},setVisible:function(b){this.wrapper.style.display=b?this.anchor==C.ControlAnchor.ABSOLUTE?"block":"inline-block":"none"},setOpacity:function(b){C.setElementOpacity(this.element[C.SIGNAL]&&C.Browser.vendor==C.BROWSERS.IE?this.element:this.wrapper,b,!0)}}}(OpenSeadragon),function(C){function b(D,F){var z,H=D.controls;for(z=H.length-1;z>=0;z--)if(H[z].element==F)return z;return-1}C.ControlDock=function(D){var H,z,F=["topleft","topright","bottomright","bottomleft"];for(C.extend(!0,this,{id:"controldock-"+C.now()+"-"+Math.floor(1e6*Math.random()),container:C.makeNeutralElement("div"),controls:[]},D),this.container.onsubmit=function(){return!1},this.element&&(this.element=C.getElement(this.element),this.element.appendChild(this.container),this.element.style.position="relative",this.container.style.width="100%",this.container.style.height="100%"),z=0;z<F.length;z++)this.controls[H=F[z]]=C.makeNeutralElement("div"),this.controls[H].style.position="absolute",H.match("left")&&(this.controls[H].style.left="0px"),H.match("right")&&(this.controls[H].style.right="0px"),H.match("top")&&(this.controls[H].style.top="0px"),H.match("bottom")&&(this.controls[H].style.bottom="0px");this.container.appendChild(this.controls.topleft),this.container.appendChild(this.controls.topright),this.container.appendChild(this.controls.bottomright),this.container.appendChild(this.controls.bottomleft)},C.ControlDock.prototype={addControl:function(D,F){var H=null;if(!(b(this,D=C.getElement(D))>=0)){switch(F.anchor){case C.ControlAnchor.TOP_RIGHT:H=this.controls.topright,D.style.position="relative",D.style.paddingRight="0px",D.style.paddingTop="0px";break;case C.ControlAnchor.BOTTOM_RIGHT:H=this.controls.bottomright,D.style.position="relative",D.style.paddingRight="0px",D.style.paddingBottom="0px";break;case C.ControlAnchor.BOTTOM_LEFT:H=this.controls.bottomleft,D.style.position="relative",D.style.paddingLeft="0px",D.style.paddingBottom="0px";break;case C.ControlAnchor.TOP_LEFT:H=this.controls.topleft,D.style.position="relative",D.style.paddingLeft="0px",D.style.paddingTop="0px";break;default:H=this.container,D.style.margin="0px",D.style.padding="0px"}this.controls.push(new C.Control(D,F,H)),D.style.display="inline-block"}},removeControl:function(D){var F=b(this,D=C.getElement(D));return F>=0&&(this.controls[F].destroy(),this.controls.splice(F,1)),this},clearControls:function(){for(;this.controls.length>0;)this.controls.pop().destroy();return this},areControlsEnabled:function(){var D;for(D=this.controls.length-1;D>=0;D--)if(this.controls[D].isVisible())return!0;return!1},setControlsEnabled:function(D){var F;for(F=this.controls.length-1;F>=0;F--)this.controls[F].setVisible(D);return this}}}(OpenSeadragon),function(C){C.Placement=C.freezeObject({CENTER:0,TOP_LEFT:1,TOP:2,TOP_RIGHT:3,RIGHT:4,BOTTOM_RIGHT:5,BOTTOM:6,BOTTOM_LEFT:7,LEFT:8,properties:{0:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!1,isVerticallyCentered:!0,isBottom:!1},1:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!0,isVerticallyCentered:!1,isBottom:!1},2:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!0,isVerticallyCentered:!1,isBottom:!1},3:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!0,isVerticallyCentered:!1,isBottom:!1},4:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!1,isVerticallyCentered:!0,isBottom:!1},5:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!1,isVerticallyCentered:!1,isBottom:!0},6:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!1,isVerticallyCentered:!1,isBottom:!0},7:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!1,isVerticallyCentered:!1,isBottom:!0},8:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!1,isVerticallyCentered:!0,isBottom:!1}}})}(OpenSeadragon),function(C){var b={},D=1;function F(O){return O=C.getElement(O),new C.Point(0===O.clientWidth?1:O.clientWidth,0===O.clientHeight?1:O.clientHeight)}function z(O,Me){if(Me instanceof C.Overlay)return Me;var Ke=null;if(Me.element)Ke=C.getElement(Me.element);else{var ke=Me.id?Me.id:"openseadragon-overlay-"+Math.floor(1e7*Math.random());(Ke=C.getElement(Me.id))||((Ke=document.createElement("a")).href="#/overlay/"+ke),Ke.id=ke,C.addClass(Ke,Me.className?Me.className:"openseadragon-overlay")}var Ee=Me.location,ut=Me.width,Tt=Me.height;if(!Ee){var $t=Me.x,wt=Me.y;if(void 0!==Me.px){var ri=O.viewport.imageToViewportRectangle(new C.Rect(Me.px,Me.py,ut||0,Tt||0));$t=ri.x,wt=ri.y,ut=void 0!==ut?ri.width:void 0,Tt=void 0!==Tt?ri.height:void 0}Ee=new C.Point($t,wt)}var di=Me.placement;return di&&"string"===C.type(di)&&(di=C.Placement[Me.placement.toUpperCase()]),new C.Overlay({element:Ke,location:Ee,placement:di,onDraw:Me.onDraw,checkResize:Me.checkResize,width:ut,height:Tt,rotationMode:Me.rotationMode})}function V(O,Me){var Ke;for(Ke=O.length-1;Ke>=0;Ke--)if(O[Ke].element===Me)return Ke;return-1}function W(O,Me){return C.requestAnimationFrame(function(){Me(O)})}function te(O){C.requestAnimationFrame(function(){!function he(O){var ke,Ee;if(O.controlsShouldFade){for(ke=1-(C.now()-O.controlsFadeBeginTime)/O.controlsFadeLength,ke=Math.min(1,ke),ke=Math.max(0,ke),Ee=O.controls.length-1;Ee>=0;Ee--)O.controls[Ee].autoFade&&O.controls[Ee].setOpacity(ke);ke>0&&te(O)}}(O)})}function Q(O){!O.autoHideControls||(O.controlsShouldFade=!0,O.controlsFadeBeginTime=C.now()+O.controlsFadeDelay,window.setTimeout(function(){te(O)},O.controlsFadeDelay))}function be(O){var Me;for(O.controlsShouldFade=!1,Me=O.controls.length-1;Me>=0;Me--)O.controls[Me].setOpacity(1)}function ae(){be(this)}function Te(){Q(this)}function Ae(O){var Me={originalEvent:O.originalEvent,preventDefaultAction:O.preventDefaultAction,preventVerticalPan:O.preventVerticalPan,preventHorizontalPan:O.preventHorizontalPan};if(this.raiseEvent("canvas-key",Me),Me.preventDefaultAction||O.ctrl||O.alt||O.meta)return!0;switch(O.keyCode){case 38:return Me.preventVerticalPan||(O.shift?this.viewport.zoomBy(1.1):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new C.Point(0,-this.pixelsPerArrowPress))),this.viewport.applyConstraints()),!1;case 40:return Me.preventVerticalPan||(O.shift?this.viewport.zoomBy(.9):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new C.Point(0,this.pixelsPerArrowPress))),this.viewport.applyConstraints()),!1;case 37:return Me.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new C.Point(-this.pixelsPerArrowPress,0))),this.viewport.applyConstraints()),!1;case 39:return Me.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new C.Point(this.pixelsPerArrowPress,0))),this.viewport.applyConstraints()),!1;default:return!0}}function me(O){var Me={originalEvent:O.originalEvent,preventDefaultAction:O.preventDefaultAction,preventVerticalPan:O.preventVerticalPan,preventHorizontalPan:O.preventHorizontalPan};if(this.raiseEvent("canvas-key",Me),Me.preventDefaultAction||O.ctrl||O.alt||O.meta)return!0;switch(O.keyCode){case 43:case 61:return this.viewport.zoomBy(1.1),this.viewport.applyConstraints(),!1;case 45:return this.viewport.zoomBy(.9),this.viewport.applyConstraints(),!1;case 48:return this.viewport.goHome(),this.viewport.applyConstraints(),!1;case 119:case 87:return Me.preventVerticalPan||(O.shift?this.viewport.zoomBy(1.1):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new C.Point(0,-40))),this.viewport.applyConstraints()),!1;case 115:case 83:return Me.preventVerticalPan||(O.shift?this.viewport.zoomBy(.9):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new C.Point(0,40))),this.viewport.applyConstraints()),!1;case 97:return Me.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new C.Point(-40,0))),this.viewport.applyConstraints()),!1;case 100:return Me.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new C.Point(40,0))),this.viewport.applyConstraints()),!1;case 114:return this.viewport.setRotation(C.positiveModulo(this.viewport.flipped?this.viewport.degrees-this.rotationIncrement:this.viewport.degrees+this.rotationIncrement,360)),this.viewport.applyConstraints(),!1;case 82:return this.viewport.setRotation(C.positiveModulo(this.viewport.flipped?this.viewport.degrees+this.rotationIncrement:this.viewport.degrees-this.rotationIncrement,360)),this.viewport.applyConstraints(),!1;case 102:return this.viewport.toggleFlip(),!1;default:return!0}}function G(O){var Me;document.activeElement==this.canvas||this.canvas.focus(),this.viewport.flipped&&(O.position.x=this.viewport.getContainerSize().x-O.position.x);var ke={tracker:O.eventSource,position:O.position,quick:O.quick,shift:O.shift,originalEvent:O.originalEvent,preventDefaultAction:O.preventDefaultAction};this.raiseEvent("canvas-click",ke),!ke.preventDefaultAction&&this.viewport&&O.quick&&(Me=this.gestureSettingsByDeviceType(O.pointerType)).clickToZoom&&(this.viewport.zoomBy(O.shift?1/this.zoomPerClick:this.zoomPerClick,Me.zoomToRefPoint?this.viewport.pointFromPixel(O.position,!0):null),this.viewport.applyConstraints())}function de(O){var Me,Ke={tracker:O.eventSource,position:O.position,shift:O.shift,originalEvent:O.originalEvent,preventDefaultAction:O.preventDefaultAction};this.raiseEvent("canvas-double-click",Ke),!Ke.preventDefaultAction&&this.viewport&&(Me=this.gestureSettingsByDeviceType(O.pointerType)).dblClickToZoom&&(this.viewport.zoomBy(O.shift?1/this.zoomPerClick:this.zoomPerClick,Me.zoomToRefPoint?this.viewport.pointFromPixel(O.position,!0):null),this.viewport.applyConstraints())}function we(O){var Me,Ke={tracker:O.eventSource,position:O.position,delta:O.delta,speed:O.speed,direction:O.direction,shift:O.shift,originalEvent:O.originalEvent,preventDefaultAction:O.preventDefaultAction};if(this.raiseEvent("canvas-drag",Ke),!Ke.preventDefaultAction&&this.viewport){if(Me=this.gestureSettingsByDeviceType(O.pointerType),this.panHorizontal||(O.delta.x=0),this.panVertical||(O.delta.y=0),this.viewport.flipped&&(O.delta.x=-O.delta.x),this.constrainDuringPan){var ke=this.viewport.deltaPointsFromPixels(O.delta.negate());this.viewport.centerSpringX.target.value+=ke.x,this.viewport.centerSpringY.target.value+=ke.y;var Ee=this.viewport.getBounds(),ut=this.viewport.getConstrainedBounds();this.viewport.centerSpringX.target.value-=ke.x,this.viewport.centerSpringY.target.value-=ke.y,Ee.x!=ut.x&&(O.delta.x=0),Ee.y!=ut.y&&(O.delta.y=0)}this.viewport.panBy(this.viewport.deltaPointsFromPixels(O.delta.negate()),Me.flickEnabled&&!this.constrainDuringPan)}}function Fe(O){if(!O.preventDefaultAction&&this.viewport){var Me=this.gestureSettingsByDeviceType(O.pointerType);if(Me.flickEnabled&&O.speed>=Me.flickMinSpeed){var Ke=0;this.panHorizontal&&(Ke=Me.flickMomentum*O.speed*Math.cos(O.direction));var ke=0;this.panVertical&&(ke=Me.flickMomentum*O.speed*Math.sin(O.direction));var Ee=this.viewport.pixelFromPoint(this.viewport.getCenter(!0)),ut=this.viewport.pointFromPixel(new C.Point(Ee.x-Ke,Ee.y-ke));this.viewport.panTo(ut,!1)}this.viewport.applyConstraints()}this.raiseEvent("canvas-drag-end",{tracker:O.eventSource,position:O.position,speed:O.speed,direction:O.direction,shift:O.shift,originalEvent:O.originalEvent})}function Le(O){this.raiseEvent("canvas-enter",{tracker:O.eventSource,pointerType:O.pointerType,position:O.position,buttons:O.buttons,pointers:O.pointers,insideElementPressed:O.insideElementPressed,buttonDownAny:O.buttonDownAny,originalEvent:O.originalEvent})}function it(O){window.location!=window.parent.location&&C.MouseTracker.resetAllMouseTrackers(),this.raiseEvent("canvas-exit",{tracker:O.eventSource,pointerType:O.pointerType,position:O.position,buttons:O.buttons,pointers:O.pointers,insideElementPressed:O.insideElementPressed,buttonDownAny:O.buttonDownAny,originalEvent:O.originalEvent})}function at(O){this.raiseEvent("canvas-press",{tracker:O.eventSource,pointerType:O.pointerType,position:O.position,insideElementPressed:O.insideElementPressed,insideElementReleased:O.insideElementReleased,originalEvent:O.originalEvent})}function Dt(O){this.raiseEvent("canvas-release",{tracker:O.eventSource,pointerType:O.pointerType,position:O.position,insideElementPressed:O.insideElementPressed,insideElementReleased:O.insideElementReleased,originalEvent:O.originalEvent})}function dt(O){this.raiseEvent("canvas-nonprimary-press",{tracker:O.eventSource,position:O.position,pointerType:O.pointerType,button:O.button,buttons:O.buttons,originalEvent:O.originalEvent})}function Kt(O){this.raiseEvent("canvas-nonprimary-release",{tracker:O.eventSource,position:O.position,pointerType:O.pointerType,button:O.button,buttons:O.buttons,originalEvent:O.originalEvent})}function oi(O){var Me,Ke,Ee;if(!O.preventDefaultAction&&this.viewport&&((Me=this.gestureSettingsByDeviceType(O.pointerType)).pinchToZoom&&(Ke=this.viewport.pointFromPixel(O.center,!0),Ee=this.viewport.pointFromPixel(O.lastCenter,!0).minus(Ke),this.panHorizontal||(Ee.x=0),this.panVertical||(Ee.y=0),this.viewport.zoomBy(O.distance/O.lastDistance,Ke,!0),Me.zoomToRefPoint&&this.viewport.panBy(Ee,!0),this.viewport.applyConstraints()),Me.pinchRotate)){var ut=Math.atan2(O.gesturePoints[0].currentPos.y-O.gesturePoints[1].currentPos.y,O.gesturePoints[0].currentPos.x-O.gesturePoints[1].currentPos.x),Tt=Math.atan2(O.gesturePoints[0].lastPos.y-O.gesturePoints[1].lastPos.y,O.gesturePoints[0].lastPos.x-O.gesturePoints[1].lastPos.x);this.viewport.setRotation(this.viewport.getRotation()+(ut-Tt)*(180/Math.PI))}return this.raiseEvent("canvas-pinch",{tracker:O.eventSource,gesturePoints:O.gesturePoints,lastCenter:O.lastCenter,center:O.center,lastDistance:O.lastDistance,distance:O.distance,shift:O.shift,originalEvent:O.originalEvent}),!1}function We(O){var Me,Ke,ke;if((ke=C.now())-this._lastScrollTime>this.minScrollDeltaTime){if(this._lastScrollTime=ke,this.viewport.flipped&&(O.position.x=this.viewport.getContainerSize().x-O.position.x),!O.preventDefaultAction&&this.viewport&&(Me=this.gestureSettingsByDeviceType(O.pointerType)).scrollToZoom&&(Ke=Math.pow(this.zoomPerScroll,O.scroll),this.viewport.zoomBy(Ke,Me.zoomToRefPoint?this.viewport.pointFromPixel(O.position,!0):null),this.viewport.applyConstraints()),this.raiseEvent("canvas-scroll",{tracker:O.eventSource,position:O.position,scroll:O.scroll,shift:O.shift,originalEvent:O.originalEvent}),Me&&Me.scrollToZoom)return!1}else if((Me=this.gestureSettingsByDeviceType(O.pointerType))&&Me.scrollToZoom)return!1}function xt(O){b[this.hash].mouseInside=!0,be(this),this.raiseEvent("container-enter",{tracker:O.eventSource,position:O.position,buttons:O.buttons,pointers:O.pointers,insideElementPressed:O.insideElementPressed,buttonDownAny:O.buttonDownAny,originalEvent:O.originalEvent})}function _e(O){O.pointers<1&&(b[this.hash].mouseInside=!1,b[this.hash].animating||Q(this)),this.raiseEvent("container-exit",{tracker:O.eventSource,position:O.position,buttons:O.buttons,pointers:O.pointers,insideElementPressed:O.insideElementPressed,buttonDownAny:O.buttonDownAny,originalEvent:O.originalEvent})}function Lt(O){(function $i(O){if(!O._opening){if(O.autoResize){var Me=F(O.container),Ke=b[O.hash].prevContainerSize;if(!Me.equals(Ke)){var ke=O.viewport;if(O.preserveImageSizeOnResize){var Ee=Ke.x/Me.x,ut=ke.getZoom()*Ee,Tt=ke.getCenter();ke.resize(Me,!1),ke.zoomTo(ut,null,!0),ke.panTo(Tt,!0)}else{var $t=ke.getBounds();ke.resize(Me,!0),ke.fitBoundsWithConstraints($t,!0)}b[O.hash].prevContainerSize=Me,b[O.hash].forceRedraw=!0}}var wt=O.viewport.update(),ri=O.world.update()||wt;wt&&O.raiseEvent("viewport-change"),O.referenceStrip&&(ri=O.referenceStrip.update(O.viewport)||ri),!b[O.hash].animating&&ri&&(O.raiseEvent("animation-start"),be(O)),(ri||b[O.hash].forceRedraw||O.world.needsDraw())&&(function Wt(O){O.imageLoader.clear(),O.drawer.clear(),O.world.draw(),O.raiseEvent("update-viewport",{})}(O),O._drawOverlays(),O.navigator&&O.navigator.update(O.viewport),b[O.hash].forceRedraw=!1,ri&&O.raiseEvent("animation")),b[O.hash].animating&&!ri&&(O.raiseEvent("animation-finish"),b[O.hash].mouseInside||Q(O)),b[O.hash].animating=ri}})(O),O._updateRequestId=!!O.isOpen()&&W(O,Lt)}function Ei(O,Me){return O?O+Me:Me}function Rt(){b[this.hash].lastZoomTime=C.now(),b[this.hash].zoomFactor=this.zoomPerSecond,b[this.hash].zooming=!0,ft(this)}function On(){b[this.hash].lastZoomTime=C.now(),b[this.hash].zoomFactor=1/this.zoomPerSecond,b[this.hash].zooming=!0,ft(this)}function Ct(){b[this.hash].zooming=!1}function ft(O){C.requestAnimationFrame(C.delegate(O,bn))}function bn(){var O,Ke;b[this.hash].zooming&&this.viewport&&(O=C.now(),Ke=Math.pow(b[this.hash].zoomFactor,(O-b[this.hash].lastZoomTime)/1e3),this.viewport.zoomBy(Ke),this.viewport.applyConstraints(),b[this.hash].lastZoomTime=O,ft(this))}function qi(){this.viewport&&(b[this.hash].zooming=!1,this.viewport.zoomBy(this.zoomPerClick/1),this.viewport.applyConstraints())}function Fi(){this.viewport&&(b[this.hash].zooming=!1,this.viewport.zoomBy(1/this.zoomPerClick),this.viewport.applyConstraints())}function cr(){this.buttons.emulateEnter(),this.buttons.emulateExit()}function ii(){this.viewport&&this.viewport.goHome()}function mr(){this.isFullPage()&&!C.isFullScreen()?this.setFullPage(!1):this.setFullScreen(!this.isFullPage()),this.buttons&&this.buttons.emulateExit(),this.fullPageButton.element.focus(),this.viewport&&this.viewport.applyConstraints()}function zr(){if(this.viewport){var O=this.viewport.getRotation();O=C.positiveModulo(this.viewport.flipped?O+this.rotationIncrement:O-this.rotationIncrement,360),this.viewport.setRotation(O)}}function gr(){if(this.viewport){var O=this.viewport.getRotation();O=C.positiveModulo(this.viewport.flipped?O-this.rotationIncrement:O+this.rotationIncrement,360),this.viewport.setRotation(O)}}function qn(){this.viewport.toggleFlip()}function za(){var O=this._sequenceIndex-1;this.navPrevNextWrap&&O<0&&(O+=this.tileSources.length),this.goToPage(O)}function Ui(){var O=this._sequenceIndex+1;this.navPrevNextWrap&&O>=this.tileSources.length&&(O=0),this.goToPage(O)}C.Viewer=function(O){var ke,Ee,Me=arguments,Ke=this;if(C.isPlainObject(O)||(O={id:Me[0],xmlPath:Me.length>1?Me[1]:void 0,prefixUrl:Me.length>2?Me[2]:void 0,controls:Me.length>3?Me[3]:void 0,overlays:Me.length>4?Me[4]:void 0}),O.config&&(C.extend(!0,O,O.config),delete O.config),C.extend(!0,this,{id:O.id,hash:O.hash||D++,initialPage:0,element:null,container:null,canvas:null,overlays:[],overlaysContainer:null,previousBody:[],customControls:[],source:null,drawer:null,world:null,viewport:null,navigator:null,collectionViewport:null,collectionDrawer:null,navImages:null,buttons:null,profiler:null},C.DEFAULT_SETTINGS,O),void 0===this.hash)throw new Error("A hash must be defined, either by specifying options.id or options.hash.");for(void 0!==b[this.hash]&&C.console.warn("Hash "+this.hash+" has already been used."),b[this.hash]={fsBoundsDelta:new C.Point(1,1),prevContainerSize:null,animating:!1,forceRedraw:!1,mouseInside:!1,group:null,zooming:!1,zoomFactor:null,lastZoomTime:null,fullPage:!1,onfullscreenchange:null},this._sequenceIndex=0,this._firstOpen=!0,this._updateRequestId=null,this._loadQueue=[],this.currentOverlays=[],this._lastScrollTime=C.now(),C.EventSource.call(this),this.addHandler("open-failed",function(Ee){var ut=C.getString("Errors.OpenFailed",Ee.eventSource,Ee.message);Ke._showMessage(ut)}),C.ControlDock.call(this,O),this.xmlPath&&(this.tileSources=[this.xmlPath]),this.element=this.element||document.getElementById(this.id),this.canvas=C.makeNeutralElement("div"),this.canvas.className="openseadragon-canvas",(Ee=this.canvas.style).width="100%",Ee.height="100%",Ee.overflow="hidden",Ee.position="absolute",Ee.top="0px",Ee.left="0px",C.setElementTouchActionNone(this.canvas),""!==O.tabIndex&&(this.canvas.tabIndex=void 0===O.tabIndex?0:O.tabIndex),this.container.className="openseadragon-container",function(Ee){Ee.width="100%",Ee.height="100%",Ee.position="relative",Ee.overflow="hidden",Ee.left="0px",Ee.top="0px",Ee.textAlign="left"}(this.container.style),this.container.insertBefore(this.canvas,this.container.firstChild),this.element.appendChild(this.container),this.bodyWidth=document.body.style.width,this.bodyHeight=document.body.style.height,this.bodyOverflow=document.body.style.overflow,this.docOverflow=document.documentElement.style.overflow,this.innerTracker=new C.MouseTracker({element:this.canvas,startDisabled:!this.mouseNavEnabled,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,dblClickTimeThreshold:this.dblClickTimeThreshold,dblClickDistThreshold:this.dblClickDistThreshold,keyDownHandler:C.delegate(this,Ae),keyHandler:C.delegate(this,me),clickHandler:C.delegate(this,G),dblClickHandler:C.delegate(this,de),dragHandler:C.delegate(this,we),dragEndHandler:C.delegate(this,Fe),enterHandler:C.delegate(this,Le),exitHandler:C.delegate(this,it),pressHandler:C.delegate(this,at),releaseHandler:C.delegate(this,Dt),nonPrimaryPressHandler:C.delegate(this,dt),nonPrimaryReleaseHandler:C.delegate(this,Kt),scrollHandler:C.delegate(this,We),pinchHandler:C.delegate(this,oi)}),this.outerTracker=new C.MouseTracker({element:this.container,startDisabled:!this.mouseNavEnabled,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,dblClickTimeThreshold:this.dblClickTimeThreshold,dblClickDistThreshold:this.dblClickDistThreshold,enterHandler:C.delegate(this,xt),exitHandler:C.delegate(this,_e)}),this.toolbar&&(this.toolbar=new C.ControlDock({element:this.toolbar})),this.bindStandardControls(),b[this.hash].prevContainerSize=F(this.container),this.world=new C.World({viewer:this}),this.world.addHandler("add-item",function(Ee){Ke.source=Ke.world.getItemAt(0).source,b[Ke.hash].forceRedraw=!0,Ke._updateRequestId||(Ke._updateRequestId=W(Ke,Lt))}),this.world.addHandler("remove-item",function(Ee){Ke.source=Ke.world.getItemCount()?Ke.world.getItemAt(0).source:null,b[Ke.hash].forceRedraw=!0}),this.world.addHandler("metrics-change",function(Ee){Ke.viewport&&Ke.viewport._setContentBounds(Ke.world.getHomeBounds(),Ke.world.getContentFactor())}),this.world.addHandler("item-index-change",function(Ee){Ke.source=Ke.world.getItemAt(0).source}),this.viewport=new C.Viewport({containerSize:b[this.hash].prevContainerSize,springStiffness:this.springStiffness,animationTime:this.animationTime,minZoomImageRatio:this.minZoomImageRatio,maxZoomPixelRatio:this.maxZoomPixelRatio,visibilityRatio:this.visibilityRatio,wrapHorizontal:this.wrapHorizontal,wrapVertical:this.wrapVertical,defaultZoomLevel:this.defaultZoomLevel,minZoomLevel:this.minZoomLevel,maxZoomLevel:this.maxZoomLevel,viewer:this,degrees:this.degrees,flipped:this.flipped,navigatorRotate:this.navigatorRotate,homeFillsViewer:this.homeFillsViewer,margins:this.viewportMargins}),this.viewport._setContentBounds(this.world.getHomeBounds(),this.world.getContentFactor()),this.imageLoader=new C.ImageLoader({jobLimit:this.imageLoaderLimit,timeout:O.timeout}),this.tileCache=new C.TileCache({maxImageCacheCount:this.maxImageCacheCount}),this.drawer=new C.Drawer({viewer:this,viewport:this.viewport,element:this.canvas,debugGridColor:this.debugGridColor}),this.overlaysContainer=C.makeNeutralElement("div"),this.canvas.appendChild(this.overlaysContainer),this.drawer.canRotate()||(this.rotateLeft&&(ke=this.buttons.buttons.indexOf(this.rotateLeft),this.buttons.buttons.splice(ke,1),this.buttons.element.removeChild(this.rotateLeft.element)),this.rotateRight&&(ke=this.buttons.buttons.indexOf(this.rotateRight),this.buttons.buttons.splice(ke,1),this.buttons.element.removeChild(this.rotateRight.element))),this.showNavigator&&(this.navigator=new C.Navigator({id:this.navigatorId,position:this.navigatorPosition,sizeRatio:this.navigatorSizeRatio,maintainSizeRatio:this.navigatorMaintainSizeRatio,top:this.navigatorTop,left:this.navigatorLeft,width:this.navigatorWidth,height:this.navigatorHeight,autoResize:this.navigatorAutoResize,autoFade:this.navigatorAutoFade,prefixUrl:this.prefixUrl,viewer:this,navigatorRotate:this.navigatorRotate,background:this.navigatorBackground,opacity:this.navigatorOpacity,borderColor:this.navigatorBorderColor,displayRegionColor:this.navigatorDisplayRegionColor,crossOriginPolicy:this.crossOriginPolicy})),this.sequenceMode&&this.bindSequenceControls(),this.tileSources&&this.open(this.tileSources),ke=0;ke<this.customControls.length;ke++)this.addControl(this.customControls[ke].id,{anchor:this.customControls[ke].anchor});C.requestAnimationFrame(function(){Q(Ke)}),void 0!==this.imageSmoothingEnabled&&!this.imageSmoothingEnabled&&this.drawer.setImageSmoothingEnabled(this.imageSmoothingEnabled)},C.extend(C.Viewer.prototype,C.EventSource.prototype,C.ControlDock.prototype,{isOpen:function(){return!!this.world.getItemCount()},openDzi:function(O){return C.console.error("[Viewer.openDzi] this function is deprecated; use Viewer.open() instead."),this.open(O)},openTileSource:function(O){return C.console.error("[Viewer.openTileSource] this function is deprecated; use Viewer.open() instead."),this.open(O)},open:function(O,Me){var Ke=this;if(this.close(),O){if(this.sequenceMode&&C.isArray(O))return this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null),void 0!==Me&&!isNaN(Me)&&(this.initialPage=Me),this.tileSources=O,this._sequenceIndex=Math.max(0,Math.min(this.tileSources.length-1,this.initialPage)),this.tileSources.length&&(this.open(this.tileSources[this._sequenceIndex]),this.showReferenceStrip&&this.addReferenceStrip()),void this._updateSequenceButtons(this._sequenceIndex);if(C.isArray(O)||(O=[O]),O.length){this._opening=!0;for(var Tt,ke=O.length,Ee=0,ut=0,$t=function(){if(Ee+ut===ke)if(Ee){(Ke._firstOpen||!Ke.preserveViewport)&&(Ke.viewport.goHome(!0),Ke.viewport.update()),Ke._firstOpen=!1;var di=O[0];if(di.tileSource&&(di=di.tileSource),Ke.overlays&&!Ke.preserveOverlays)for(var fi=0;fi<Ke.overlays.length;fi++)Ke.currentOverlays[fi]=z(Ke,Ke.overlays[fi]);Ke._drawOverlays(),Ke._opening=!1,Ke.raiseEvent("open",{source:di})}else Ke._opening=!1,Ke.raiseEvent("open-failed",Tt)},wt=function(di){(!C.isPlainObject(di)||!di.tileSource)&&(di={tileSource:di}),void 0!==di.index&&(C.console.error("[Viewer.open] setting indexes here is not supported; use addTiledImage instead"),delete di.index),void 0===di.collectionImmediately&&(di.collectionImmediately=!0);var fi=di.success;di.success=function(_r){if(Ee++,di.tileSource.overlays)for(var rr=0;rr<di.tileSource.overlays.length;rr++)Ke.addOverlay(di.tileSource.overlays[rr]);fi&&fi(_r),$t()};var Hi=di.error;di.error=function(_r){ut++,Tt||(Tt=_r),Hi&&Hi(_r),$t()},Ke.addTiledImage(di)},ri=0;ri<O.length;ri++)wt(O[ri]);return this}}},close:function(){return b[this.hash]?(this._opening=!1,this.navigator&&this.navigator.close(),this.preserveOverlays||(this.clearOverlays(),this.overlaysContainer.innerHTML=""),b[this.hash].animating=!1,this.world.removeAll(),this.imageLoader.clear(),this.raiseEvent("close"),this):this},destroy:function(){if(b[this.hash]){if(this.close(),this.clearOverlays(),this.overlaysContainer.innerHTML="",this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null),null!==this._updateRequestId&&(C.cancelAnimationFrame(this._updateRequestId),this._updateRequestId=null),this.drawer&&this.drawer.destroy(),this.removeAllHandlers(),this.element)for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.innerTracker&&this.innerTracker.destroy(),this.outerTracker&&this.outerTracker.destroy(),b[this.hash]=null,delete b[this.hash],this.canvas=null,this.container=null,this.element=null}},isMouseNavEnabled:function(){return this.innerTracker.isTracking()},setMouseNavEnabled:function(O){return this.innerTracker.setTracking(O),this.outerTracker.setTracking(O),this.raiseEvent("mouse-enabled",{enabled:O}),this},areControlsEnabled:function(){var Me,O=this.controls.length;for(Me=0;Me<this.controls.length;Me++)O=O&&this.controls[Me].isVisible();return O},setControlsEnabled:function(O){return O?be(this):Q(this),this.raiseEvent("controls-enabled",{enabled:O}),this},setDebugMode:function(O){for(var Me=0;Me<this.world.getItemCount();Me++)this.world.getItemAt(Me).debugMode=O;this.debugMode=O,this.forceRedraw()},isFullPage:function(){return b[this.hash].fullPage},setFullPage:function(O){var ut,Tt,Me=document.body,Ke=Me.style,ke=document.documentElement.style,Ee=this;if(O==this.isFullPage())return this;var $t={fullPage:O,preventDefaultAction:!1};if(this.raiseEvent("pre-full-page",$t),$t.preventDefaultAction)return this;if(O){for(this.elementSize=C.getElementSize(this.element),this.pageScroll=C.getPageScroll(),this.elementMargin=this.element.style.margin,this.element.style.margin="0",this.elementPadding=this.element.style.padding,this.element.style.padding="0",this.bodyMargin=Ke.margin,this.docMargin=ke.margin,Ke.margin="0",ke.margin="0",this.bodyPadding=Ke.padding,this.docPadding=ke.padding,Ke.padding="0",ke.padding="0",this.bodyWidth=Ke.width,this.docWidth=ke.width,Ke.width="100%",ke.width="100%",this.bodyHeight=Ke.height,this.docHeight=ke.height,Ke.height="100%",ke.height="100%",this.previousBody=[],b[this.hash].prevElementParent=this.element.parentNode,b[this.hash].prevNextSibling=this.element.nextSibling,b[this.hash].prevElementWidth=this.element.style.width,b[this.hash].prevElementHeight=this.element.style.height,ut=Me.childNodes.length,Tt=0;Tt<ut;Tt++)this.previousBody.push(Me.childNodes[0]),Me.removeChild(Me.childNodes[0]);this.toolbar&&this.toolbar.element&&(this.toolbar.parentNode=this.toolbar.element.parentNode,this.toolbar.nextSibling=this.toolbar.element.nextSibling,Me.appendChild(this.toolbar.element),C.addClass(this.toolbar.element,"fullpage")),C.addClass(this.element,"fullpage"),Me.appendChild(this.element),this.element.style.height=C.getWindowSize().y+"px",this.element.style.width=C.getWindowSize().x+"px",this.toolbar&&this.toolbar.element&&(this.element.style.height=C.getElementSize(this.element).y-C.getElementSize(this.toolbar.element).y+"px"),b[this.hash].fullPage=!0,C.delegate(this,xt)({})}else{for(this.element.style.margin=this.elementMargin,this.element.style.padding=this.elementPadding,Ke.margin=this.bodyMargin,ke.margin=this.docMargin,Ke.padding=this.bodyPadding,ke.padding=this.docPadding,Ke.width=this.bodyWidth,ke.width=this.docWidth,Ke.height=this.bodyHeight,ke.height=this.docHeight,Me.removeChild(this.element),ut=this.previousBody.length,Tt=0;Tt<ut;Tt++)Me.appendChild(this.previousBody.shift());C.removeClass(this.element,"fullpage"),b[this.hash].prevElementParent.insertBefore(this.element,b[this.hash].prevNextSibling),this.toolbar&&this.toolbar.element&&(Me.removeChild(this.toolbar.element),C.removeClass(this.toolbar.element,"fullpage"),this.toolbar.parentNode.insertBefore(this.toolbar.element,this.toolbar.nextSibling),delete this.toolbar.parentNode,delete this.toolbar.nextSibling),this.element.style.width=b[this.hash].prevElementWidth,this.element.style.height=b[this.hash].prevElementHeight;var wt=0,ri=function(){C.setPageScroll(Ee.pageScroll);var di=C.getPageScroll();++wt<10&&(di.x!==Ee.pageScroll.x||di.y!==Ee.pageScroll.y)&&C.requestAnimationFrame(ri)};C.requestAnimationFrame(ri),b[this.hash].fullPage=!1,C.delegate(this,_e)({})}return this.navigator&&this.viewport&&this.navigator.update(this.viewport),this.raiseEvent("full-page",{fullPage:O}),this},setFullScreen:function(O){var Me=this;if(!C.supportsFullScreen)return this.setFullPage(O);if(C.isFullScreen()===O)return this;var Ke={fullScreen:O,preventDefaultAction:!1};if(this.raiseEvent("pre-full-screen",Ke),Ke.preventDefaultAction)return this;if(O){if(this.setFullPage(!0),!this.isFullPage())return this;this.fullPageStyleWidth=this.element.style.width,this.fullPageStyleHeight=this.element.style.height,this.element.style.width="100%",this.element.style.height="100%";var ke=function(){var Ee=C.isFullScreen();Ee||(C.removeEvent(document,C.fullScreenEventName,ke),C.removeEvent(document,C.fullScreenErrorEventName,ke),Me.setFullPage(!1),Me.isFullPage()&&(Me.element.style.width=Me.fullPageStyleWidth,Me.element.style.height=Me.fullPageStyleHeight)),Me.navigator&&Me.viewport&&setTimeout(function(){Me.navigator.update(Me.viewport)}),Me.raiseEvent("full-screen",{fullScreen:Ee})};C.addEvent(document,C.fullScreenEventName,ke),C.addEvent(document,C.fullScreenErrorEventName,ke),C.requestFullScreen(document.body)}else C.exitFullScreen();return this},isVisible:function(){return"hidden"!=this.container.style.visibility},setVisible:function(O){return this.container.style.visibility=O?"":"hidden",this.raiseEvent("visible",{visible:O}),this},addTiledImage:function(O){C.console.assert(O,"[Viewer.addTiledImage] options is required"),C.console.assert(O.tileSource,"[Viewer.addTiledImage] options.tileSource is required"),C.console.assert(!O.replace||O.index>-1&&O.index<this.world.getItemCount(),"[Viewer.addTiledImage] if options.replace is used, options.index must be a valid index in Viewer.world");var Me=this;O.replace&&(O.replaceItem=Me.world.getItemAt(O.index)),this._hideMessage(),void 0===O.placeholderFillStyle&&(O.placeholderFillStyle=this.placeholderFillStyle),void 0===O.opacity&&(O.opacity=this.opacity),void 0===O.preload&&(O.preload=this.preload),void 0===O.compositeOperation&&(O.compositeOperation=this.compositeOperation),void 0===O.crossOriginPolicy&&(O.crossOriginPolicy=void 0!==O.tileSource.crossOriginPolicy?O.tileSource.crossOriginPolicy:this.crossOriginPolicy),void 0===O.ajaxWithCredentials&&(O.ajaxWithCredentials=this.ajaxWithCredentials),void 0===O.loadTilesWithAjax&&(O.loadTilesWithAjax=this.loadTilesWithAjax),null==O.ajaxHeaders?O.ajaxHeaders=this.ajaxHeaders:C.isPlainObject(O.ajaxHeaders)&&C.isPlainObject(this.ajaxHeaders)&&(O.ajaxHeaders=C.extend({},this.ajaxHeaders,O.ajaxHeaders));var Ke={options:O};function ke(Tt){for(var $t=0;$t<Me._loadQueue.length;$t++)if(Me._loadQueue[$t]===Ke){Me._loadQueue.splice($t,1);break}0===Me._loadQueue.length&&Ee(Ke),Me.raiseEvent("add-item-failed",Tt),O.error&&O.error(Tt)}function Ee(Tt){Me.collectionMode&&(Me.world.arrange({immediately:Tt.options.collectionImmediately,rows:Me.collectionRows,columns:Me.collectionColumns,layout:Me.collectionLayout,tileSize:Me.collectionTileSize,tileMargin:Me.collectionTileMargin}),Me.world.setAutoRefigureSizes(!0))}function ut(){for(var Tt,$t,wt;Me._loadQueue.length&&(Tt=Me._loadQueue[0]).tileSource;){if(Me._loadQueue.splice(0,1),Tt.options.replace){var ri=Me.world.getIndexOfItem(Tt.options.replaceItem);-1!=ri&&(Tt.options.index=ri),Me.world.removeItem(Tt.options.replaceItem)}$t=new C.TiledImage({viewer:Me,source:Tt.tileSource,viewport:Me.viewport,drawer:Me.drawer,tileCache:Me.tileCache,imageLoader:Me.imageLoader,x:Tt.options.x,y:Tt.options.y,width:Tt.options.width,height:Tt.options.height,fitBounds:Tt.options.fitBounds,fitBoundsPlacement:Tt.options.fitBoundsPlacement,clip:Tt.options.clip,placeholderFillStyle:Tt.options.placeholderFillStyle,opacity:Tt.options.opacity,preload:Tt.options.preload,degrees:Tt.options.degrees,compositeOperation:Tt.options.compositeOperation,springStiffness:Me.springStiffness,animationTime:Me.animationTime,minZoomImageRatio:Me.minZoomImageRatio,wrapHorizontal:Me.wrapHorizontal,wrapVertical:Me.wrapVertical,immediateRender:Me.immediateRender,blendTime:Me.blendTime,alwaysBlend:Me.alwaysBlend,minPixelRatio:Me.minPixelRatio,smoothTileEdgesMinZoom:Me.smoothTileEdgesMinZoom,iOSDevice:Me.iOSDevice,crossOriginPolicy:Tt.options.crossOriginPolicy,ajaxWithCredentials:Tt.options.ajaxWithCredentials,loadTilesWithAjax:Tt.options.loadTilesWithAjax,ajaxHeaders:Tt.options.ajaxHeaders,debugMode:Me.debugMode}),Me.collectionMode&&Me.world.setAutoRefigureSizes(!1),Me.world.addItem($t,{index:Tt.options.index}),0===Me._loadQueue.length&&Ee(Tt),1===Me.world.getItemCount()&&!Me.preserveViewport&&Me.viewport.goHome(!0),Me.navigator&&(wt=C.extend({},Tt.options,{replace:!1,originalTiledImage:$t,tileSource:Tt.tileSource}),Me.navigator.addTiledImage(wt)),Tt.options.success&&Tt.options.success({item:$t})}}C.isArray(O.tileSource)?setTimeout(function(){ke({message:"[Viewer.addTiledImage] Sequences can not be added; add them one at a time instead.",source:O.tileSource,options:O})}):(this._loadQueue.push(Ke),function H(O,Me,Ke,ke,Ee){var ut=O;if("string"==C.type(Me))if(Me.match(/^\s*<.*>\s*$/))Me=C.parseXml(Me);else if(Me.match(/^\s*[\{\[].*[\}\]]\s*$/))try{var Tt=C.parseJSON(Me);Me=Tt}catch(wt){}function $t(wt,ri){wt.ready?ke(wt):(wt.addHandler("ready",function(){ke(wt)}),wt.addHandler("open-failed",function(di){Ee({message:di.message,source:ri})}))}setTimeout(function(){if("string"==C.type(Me))(Me=new C.TileSource({url:Me,crossOriginPolicy:void 0!==Ke.crossOriginPolicy?Ke.crossOriginPolicy:O.crossOriginPolicy,ajaxWithCredentials:O.ajaxWithCredentials,ajaxHeaders:O.ajaxHeaders,useCanvas:O.useCanvas,success:function(fi){ke(fi.tileSource)}})).addHandler("open-failed",function(fi){Ee(fi)});else if(C.isPlainObject(Me)||Me.nodeType)if(void 0===Me.crossOriginPolicy&&(void 0!==Ke.crossOriginPolicy||void 0!==O.crossOriginPolicy)&&(Me.crossOriginPolicy=void 0!==Ke.crossOriginPolicy?Ke.crossOriginPolicy:O.crossOriginPolicy),void 0===Me.ajaxWithCredentials&&(Me.ajaxWithCredentials=O.ajaxWithCredentials),void 0===Me.useCanvas&&(Me.useCanvas=O.useCanvas),C.isFunction(Me.getTileUrl)){var wt=new C.TileSource(Me);wt.getTileUrl=Me.getTileUrl,ke(wt)}else{var ri=C.TileSource.determineType(ut,Me);if(!ri)return void Ee({message:"Unable to load TileSource",source:Me});var di=ri.prototype.configure.apply(ut,[Me]);$t(new ri(di),Me)}else $t(Me,Me)})}(this,O.tileSource,O,function(Tt){Ke.tileSource=Tt,ut()},function(Tt){Tt.options=O,ke(Tt),ut()}))},addSimpleImage:function(O){C.console.assert(O,"[Viewer.addSimpleImage] options is required"),C.console.assert(O.url,"[Viewer.addSimpleImage] options.url is required");var Me=C.extend({},O,{tileSource:{type:"image",url:O.url}});delete Me.url,this.addTiledImage(Me)},addLayer:function(O){var Me=this;C.console.error("[Viewer.addLayer] this function is deprecated; use Viewer.addTiledImage() instead.");var Ke=C.extend({},O,{success:function(ke){Me.raiseEvent("add-layer",{options:O,drawer:ke.item})},error:function(ke){Me.raiseEvent("add-layer-failed",ke)}});return this.addTiledImage(Ke),this},getLayerAtLevel:function(O){return C.console.error("[Viewer.getLayerAtLevel] this function is deprecated; use World.getItemAt() instead."),this.world.getItemAt(O)},getLevelOfLayer:function(O){return C.console.error("[Viewer.getLevelOfLayer] this function is deprecated; use World.getIndexOfItem() instead."),this.world.getIndexOfItem(O)},getLayersCount:function(){return C.console.error("[Viewer.getLayersCount] this function is deprecated; use World.getItemCount() instead."),this.world.getItemCount()},setLayerLevel:function(O,Me){return C.console.error("[Viewer.setLayerLevel] this function is deprecated; use World.setItemIndex() instead."),this.world.setItemIndex(O,Me)},removeLayer:function(O){return C.console.error("[Viewer.removeLayer] this function is deprecated; use World.removeItem() instead."),this.world.removeItem(O)},forceRedraw:function(){return b[this.hash].forceRedraw=!0,this},bindSequenceControls:function(){var O=C.delegate(this,ae),Me=C.delegate(this,Te),Ke=C.delegate(this,Ui),ke=C.delegate(this,za),Ee=this.navImages,ut=!0;return this.showSequenceControl&&((this.previousButton||this.nextButton)&&(ut=!1),this.previousButton=new C.Button({element:this.previousButton?C.getElement(this.previousButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:C.getString("Tooltips.PreviousPage"),srcRest:Ei(this.prefixUrl,Ee.previous.REST),srcGroup:Ei(this.prefixUrl,Ee.previous.GROUP),srcHover:Ei(this.prefixUrl,Ee.previous.HOVER),srcDown:Ei(this.prefixUrl,Ee.previous.DOWN),onRelease:ke,onFocus:O,onBlur:Me}),this.nextButton=new C.Button({element:this.nextButton?C.getElement(this.nextButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:C.getString("Tooltips.NextPage"),srcRest:Ei(this.prefixUrl,Ee.next.REST),srcGroup:Ei(this.prefixUrl,Ee.next.GROUP),srcHover:Ei(this.prefixUrl,Ee.next.HOVER),srcDown:Ei(this.prefixUrl,Ee.next.DOWN),onRelease:Ke,onFocus:O,onBlur:Me}),this.navPrevNextWrap||this.previousButton.disable(),(!this.tileSources||!this.tileSources.length)&&this.nextButton.disable(),ut&&(this.paging=new C.ButtonGroup({buttons:[this.previousButton,this.nextButton],clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.pagingControl=this.paging.element,this.toolbar?this.toolbar.addControl(this.pagingControl,{anchor:C.ControlAnchor.BOTTOM_RIGHT}):this.addControl(this.pagingControl,{anchor:this.sequenceControlAnchor||C.ControlAnchor.TOP_LEFT}))),this},bindStandardControls:function(){var O=C.delegate(this,Rt),Me=C.delegate(this,Ct),Ke=C.delegate(this,qi),ke=C.delegate(this,On),Ee=C.delegate(this,Fi),ut=C.delegate(this,ii),Tt=C.delegate(this,mr),$t=C.delegate(this,zr),wt=C.delegate(this,gr),ri=C.delegate(this,qn),di=C.delegate(this,ae),fi=C.delegate(this,Te),Hi=this.navImages,_r=[],rr=!0;return this.showNavigationControl&&((this.zoomInButton||this.zoomOutButton||this.homeButton||this.fullPageButton||this.rotateLeftButton||this.rotateRightButton||this.flipButton)&&(rr=!1),this.showZoomControl&&(_r.push(this.zoomInButton=new C.Button({element:this.zoomInButton?C.getElement(this.zoomInButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:C.getString("Tooltips.ZoomIn"),srcRest:Ei(this.prefixUrl,Hi.zoomIn.REST),srcGroup:Ei(this.prefixUrl,Hi.zoomIn.GROUP),srcHover:Ei(this.prefixUrl,Hi.zoomIn.HOVER),srcDown:Ei(this.prefixUrl,Hi.zoomIn.DOWN),onPress:O,onRelease:Me,onClick:Ke,onEnter:O,onExit:Me,onFocus:di,onBlur:fi})),_r.push(this.zoomOutButton=new C.Button({element:this.zoomOutButton?C.getElement(this.zoomOutButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:C.getString("Tooltips.ZoomOut"),srcRest:Ei(this.prefixUrl,Hi.zoomOut.REST),srcGroup:Ei(this.prefixUrl,Hi.zoomOut.GROUP),srcHover:Ei(this.prefixUrl,Hi.zoomOut.HOVER),srcDown:Ei(this.prefixUrl,Hi.zoomOut.DOWN),onPress:ke,onRelease:Me,onClick:Ee,onEnter:ke,onExit:Me,onFocus:di,onBlur:fi}))),this.showHomeControl&&_r.push(this.homeButton=new C.Button({element:this.homeButton?C.getElement(this.homeButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:C.getString("Tooltips.Home"),srcRest:Ei(this.prefixUrl,Hi.home.REST),srcGroup:Ei(this.prefixUrl,Hi.home.GROUP),srcHover:Ei(this.prefixUrl,Hi.home.HOVER),srcDown:Ei(this.prefixUrl,Hi.home.DOWN),onRelease:ut,onFocus:di,onBlur:fi})),this.showFullPageControl&&_r.push(this.fullPageButton=new C.Button({element:this.fullPageButton?C.getElement(this.fullPageButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:C.getString("Tooltips.FullPage"),srcRest:Ei(this.prefixUrl,Hi.fullpage.REST),srcGroup:Ei(this.prefixUrl,Hi.fullpage.GROUP),srcHover:Ei(this.prefixUrl,Hi.fullpage.HOVER),srcDown:Ei(this.prefixUrl,Hi.fullpage.DOWN),onRelease:Tt,onFocus:di,onBlur:fi})),this.showRotationControl&&(_r.push(this.rotateLeftButton=new C.Button({element:this.rotateLeftButton?C.getElement(this.rotateLeftButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:C.getString("Tooltips.RotateLeft"),srcRest:Ei(this.prefixUrl,Hi.rotateleft.REST),srcGroup:Ei(this.prefixUrl,Hi.rotateleft.GROUP),srcHover:Ei(this.prefixUrl,Hi.rotateleft.HOVER),srcDown:Ei(this.prefixUrl,Hi.rotateleft.DOWN),onRelease:$t,onFocus:di,onBlur:fi})),_r.push(this.rotateRightButton=new C.Button({element:this.rotateRightButton?C.getElement(this.rotateRightButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:C.getString("Tooltips.RotateRight"),srcRest:Ei(this.prefixUrl,Hi.rotateright.REST),srcGroup:Ei(this.prefixUrl,Hi.rotateright.GROUP),srcHover:Ei(this.prefixUrl,Hi.rotateright.HOVER),srcDown:Ei(this.prefixUrl,Hi.rotateright.DOWN),onRelease:wt,onFocus:di,onBlur:fi}))),this.showFlipControl&&_r.push(this.flipButton=new C.Button({element:this.flipButton?C.getElement(this.flipButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:C.getString("Tooltips.Flip"),srcRest:Ei(this.prefixUrl,Hi.flip.REST),srcGroup:Ei(this.prefixUrl,Hi.flip.GROUP),srcHover:Ei(this.prefixUrl,Hi.flip.HOVER),srcDown:Ei(this.prefixUrl,Hi.flip.DOWN),onRelease:ri,onFocus:di,onBlur:fi})),rr&&(this.buttons=new C.ButtonGroup({buttons:_r,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.navControl=this.buttons.element,this.addHandler("open",C.delegate(this,cr)),this.toolbar?this.toolbar.addControl(this.navControl,{anchor:this.navigationControlAnchor||C.ControlAnchor.TOP_LEFT}):this.addControl(this.navControl,{anchor:this.navigationControlAnchor||C.ControlAnchor.TOP_LEFT}))),this},currentPage:function(){return this._sequenceIndex},goToPage:function(O){return this.tileSources&&O>=0&&O<this.tileSources.length&&(this._sequenceIndex=O,this._updateSequenceButtons(O),this.open(this.tileSources[O]),this.referenceStrip&&this.referenceStrip.setFocus(O),this.raiseEvent("page",{page:O})),this},addOverlay:function(O,Me,Ke,ke){var Ee;if(Ee=C.isPlainObject(O)?O:{element:O,location:Me,placement:Ke,onDraw:ke},O=C.getElement(Ee.element),V(this.currentOverlays,O)>=0)return this;var ut=z(this,Ee);return this.currentOverlays.push(ut),ut.drawHTML(this.overlaysContainer,this.viewport),this.raiseEvent("add-overlay",{element:O,location:Ee.location,placement:Ee.placement}),this},updateOverlay:function(O,Me,Ke){var ke;return O=C.getElement(O),(ke=V(this.currentOverlays,O))>=0&&(this.currentOverlays[ke].update(Me,Ke),b[this.hash].forceRedraw=!0,this.raiseEvent("update-overlay",{element:O,location:Me,placement:Ke})),this},removeOverlay:function(O){var Me;return O=C.getElement(O),(Me=V(this.currentOverlays,O))>=0&&(this.currentOverlays[Me].destroy(),this.currentOverlays.splice(Me,1),b[this.hash].forceRedraw=!0,this.raiseEvent("remove-overlay",{element:O})),this},clearOverlays:function(){for(;this.currentOverlays.length>0;)this.currentOverlays.pop().destroy();return b[this.hash].forceRedraw=!0,this.raiseEvent("clear-overlay",{}),this},getOverlayById:function(O){var Me;return O=C.getElement(O),(Me=V(this.currentOverlays,O))>=0?this.currentOverlays[Me]:null},_updateSequenceButtons:function(O){this.nextButton&&(this.tileSources&&this.tileSources.length-1!==O?this.nextButton.enable():this.navPrevNextWrap||this.nextButton.disable()),this.previousButton&&(O>0?this.previousButton.enable():this.navPrevNextWrap||this.previousButton.disable())},_showMessage:function(O){this._hideMessage();var Me=C.makeNeutralElement("div");Me.appendChild(document.createTextNode(O)),this.messageDiv=C.makeCenteredNode(Me),C.addClass(this.messageDiv,"openseadragon-message"),this.container.appendChild(this.messageDiv)},_hideMessage:function(){var O=this.messageDiv;O&&(O.parentNode.removeChild(O),delete this.messageDiv)},gestureSettingsByDeviceType:function(O){switch(O){case"mouse":return this.gestureSettingsMouse;case"touch":return this.gestureSettingsTouch;case"pen":return this.gestureSettingsPen;default:return this.gestureSettingsUnknown}},_drawOverlays:function(){var O,Me=this.currentOverlays.length;for(O=0;O<Me;O++)this.currentOverlays[O].drawHTML(this.overlaysContainer,this.viewport)},_cancelPendingImages:function(){this._loadQueue=[]},removeReferenceStrip:function(){this.showReferenceStrip=!1,this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null)},addReferenceStrip:function(){if(this.showReferenceStrip=!0,this.sequenceMode){if(this.referenceStrip)return;this.tileSources.length&&this.tileSources.length>1&&(this.referenceStrip=new C.ReferenceStrip({id:this.referenceStripElement,position:this.referenceStripPosition,sizeRatio:this.referenceStripSizeRatio,scroll:this.referenceStripScroll,height:this.referenceStripHeight,width:this.referenceStripWidth,tileSources:this.tileSources,prefixUrl:this.prefixUrl,useCanvas:this.useCanvas,viewer:this}),this.referenceStrip.setFocus(this._sequenceIndex))}else C.console.warn('Attempting to display a reference strip while "sequenceMode" is off.')}})}(OpenSeadragon),function(C){function b(W){var te={tracker:W.eventSource,position:W.position,quick:W.quick,shift:W.shift,originalEvent:W.originalEvent,preventDefaultAction:W.preventDefaultAction};if(this.viewer.raiseEvent("navigator-click",te),!te.preventDefaultAction&&W.quick&&this.viewer.viewport&&(this.panVertical||this.panHorizontal)){this.viewer.viewport.flipped&&(W.position.x=this.viewport.getContainerSize().x-W.position.x);var Q=this.viewport.pointFromPixel(W.position);this.panVertical?this.panHorizontal||(Q.x=this.viewer.viewport.getCenter(!0).x):Q.y=this.viewer.viewport.getCenter(!0).y,this.viewer.viewport.panTo(Q),this.viewer.viewport.applyConstraints()}}function D(W){var te={tracker:W.eventSource,position:W.position,delta:W.delta,speed:W.speed,direction:W.direction,shift:W.shift,originalEvent:W.originalEvent,preventDefaultAction:W.preventDefaultAction};this.viewer.raiseEvent("navigator-drag",te),!te.preventDefaultAction&&this.viewer.viewport&&(this.panHorizontal||(W.delta.x=0),this.panVertical||(W.delta.y=0),this.viewer.viewport.flipped&&(W.delta.x=-W.delta.x),this.viewer.viewport.panBy(this.viewport.deltaPointsFromPixels(W.delta)),this.viewer.constrainDuringPan&&this.viewer.viewport.applyConstraints())}function F(W){W.insideElementPressed&&this.viewer.viewport&&this.viewer.viewport.applyConstraints()}function H(W){return this.viewer.raiseEvent("navigator-scroll",{tracker:W.eventSource,position:W.position,scroll:W.scroll,shift:W.shift,originalEvent:W.originalEvent}),!1}function z(W,te){V(W,"rotate("+te+"deg)")}function V(W,te){W.style.webkitTransform=te,W.style.mozTransform=te,W.style.msTransform=te,W.style.oTransform=te,W.style.transform=te}C.Navigator=function(W){var he,be,Ae,me,te=W.viewer,Q=this;function ae(Ae){z(Q.displayRegionContainer,Ae),z(Q.displayRegion,-Ae),Q.viewport.setRotation(Ae)}W.id?(this.element=document.getElementById(W.id),W.controlOptions={anchor:C.ControlAnchor.NONE,attachToViewer:!1,autoFade:!1}):(W.id="navigator-"+C.now(),this.element=C.makeNeutralElement("div"),W.controlOptions={anchor:C.ControlAnchor.TOP_RIGHT,attachToViewer:!0,autoFade:W.autoFade},W.position&&("BOTTOM_RIGHT"==W.position?W.controlOptions.anchor=C.ControlAnchor.BOTTOM_RIGHT:"BOTTOM_LEFT"==W.position?W.controlOptions.anchor=C.ControlAnchor.BOTTOM_LEFT:"TOP_RIGHT"==W.position?W.controlOptions.anchor=C.ControlAnchor.TOP_RIGHT:"TOP_LEFT"==W.position?W.controlOptions.anchor=C.ControlAnchor.TOP_LEFT:"ABSOLUTE"==W.position&&(W.controlOptions.anchor=C.ControlAnchor.ABSOLUTE,W.controlOptions.top=W.top,W.controlOptions.left=W.left,W.controlOptions.height=W.height,W.controlOptions.width=W.width))),this.element.id=W.id,this.element.className+=" navigator",(W=C.extend(!0,{sizeRatio:C.DEFAULT_SETTINGS.navigatorSizeRatio},W,{element:this.element,tabIndex:-1,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:0,autoResize:W.autoResize,minZoomImageRatio:1,background:W.background,opacity:W.opacity,borderColor:W.borderColor,displayRegionColor:W.displayRegionColor})).minPixelRatio=this.minPixelRatio=te.minPixelRatio,C.setElementTouchActionNone(this.element),this.borderWidth=2,this.fudge=new C.Point(1,1),this.totalBorderWidths=new C.Point(2*this.borderWidth,2*this.borderWidth).minus(this.fudge),W.controlOptions.anchor!=C.ControlAnchor.NONE&&(me=this.borderWidth,(Ae=this.element.style).margin="0px",Ae.border=me+"px solid "+W.borderColor,Ae.padding="0px",Ae.background=W.background,Ae.opacity=W.opacity,Ae.overflow="hidden"),this.displayRegion=C.makeNeutralElement("div"),this.displayRegion.id=this.element.id+"-displayregion",this.displayRegion.className="displayregion",function(Ae,me){Ae.position="relative",Ae.top="0px",Ae.left="0px",Ae.fontSize="0px",Ae.overflow="hidden",Ae.border=me+"px solid "+W.displayRegionColor,Ae.margin="0px",Ae.padding="0px",Ae.background="transparent",Ae.float="left",Ae.cssFloat="left",Ae.styleFloat="left",Ae.zIndex=999999999,Ae.cursor="default"}(this.displayRegion.style,this.borderWidth),this.displayRegionContainer=C.makeNeutralElement("div"),this.displayRegionContainer.id=this.element.id+"-displayregioncontainer",this.displayRegionContainer.className="displayregioncontainer",this.displayRegionContainer.style.width="100%",this.displayRegionContainer.style.height="100%",te.addControl(this.element,W.controlOptions),this._resizeWithViewer=W.controlOptions.anchor!=C.ControlAnchor.ABSOLUTE&&W.controlOptions.anchor!=C.ControlAnchor.NONE,W.width&&W.height?(this.setWidth(W.width),this.setHeight(W.height)):this._resizeWithViewer&&(he=C.getElementSize(te.element),this.element.style.height=Math.round(he.y*W.sizeRatio)+"px",this.element.style.width=Math.round(he.x*W.sizeRatio)+"px",this.oldViewerSize=he,be=C.getElementSize(this.element),this.elementArea=be.x*be.y),this.oldContainerSize=new C.Point(0,0),C.Viewer.apply(this,[W]),this.displayRegionContainer.appendChild(this.displayRegion),this.element.getElementsByTagName("div")[0].appendChild(this.displayRegionContainer),W.navigatorRotate&&(ae(W.viewer.viewport?W.viewer.viewport.getRotation():W.viewer.degrees||0),W.viewer.addHandler("rotate",function(Ae){ae(Ae.degrees)})),this.innerTracker.destroy(),this.innerTracker=new C.MouseTracker({element:this.element,dragHandler:C.delegate(this,D),clickHandler:C.delegate(this,b),releaseHandler:C.delegate(this,F),scrollHandler:C.delegate(this,H)}),this.addHandler("reset-size",function(){Q.viewport&&Q.viewport.goHome(!0)}),te.world.addHandler("item-index-change",function(Ae){window.setTimeout(function(){var me=Q.world.getItemAt(Ae.previousIndex);Q.world.setItemIndex(me,Ae.newIndex)},1)}),te.world.addHandler("remove-item",function(Ae){var G=Q._getMatchingItem(Ae.item);G&&Q.world.removeItem(G)}),this.update(te.viewport)},C.extend(C.Navigator.prototype,C.EventSource.prototype,C.Viewer.prototype,{updateSize:function(){if(this.viewport){var W=new C.Point(0===this.container.clientWidth?1:this.container.clientWidth,0===this.container.clientHeight?1:this.container.clientHeight);W.equals(this.oldContainerSize)||(this.viewport.resize(W,!0),this.viewport.goHome(!0),this.oldContainerSize=W,this.drawer.clear(),this.world.draw())}},setWidth:function(W){this.width=W,this.element.style.width="number"==typeof W?W+"px":W,this._resizeWithViewer=!1},setHeight:function(W){this.height=W,this.element.style.height="number"==typeof W?W+"px":W,this._resizeWithViewer=!1},setFlip:function(W){return this.viewport.setFlip(W),this.setDisplayTransform(this.viewer.viewport.getFlip()?"scale(-1,1)":"scale(1,1)"),this},setDisplayTransform:function(W){V(this.displayRegion,W),V(this.canvas,W),V(this.element,W)},update:function(W){var te,Q,he,be,ae,Te;if(te=C.getElementSize(this.viewer.element),this._resizeWithViewer&&te.x&&te.y&&!te.equals(this.oldViewerSize)&&(this.oldViewerSize=te,this.maintainSizeRatio||!this.elementArea?(Q=te.x*this.sizeRatio,he=te.y*this.sizeRatio):(Q=Math.sqrt(this.elementArea*(te.x/te.y)),he=this.elementArea/Q),this.element.style.width=Math.round(Q)+"px",this.element.style.height=Math.round(he)+"px",this.elementArea||(this.elementArea=Q*he),this.updateSize()),W&&this.viewport){be=W.getBoundsNoRotate(!0),ae=this.viewport.pixelFromPointNoRotate(be.getTopLeft(),!1),Te=this.viewport.pixelFromPointNoRotate(be.getBottomRight(),!1).minus(this.totalBorderWidths);var Ae=this.displayRegion.style;Ae.display=this.world.getItemCount()?"block":"none",Ae.top=Math.round(ae.y)+"px",Ae.left=Math.round(ae.x)+"px";var me=Math.abs(ae.x-Te.x),G=Math.abs(ae.y-Te.y);Ae.width=Math.round(Math.max(me,0))+"px",Ae.height=Math.round(Math.max(G,0))+"px"}},addTiledImage:function(W){var te=this,Q=W.originalTiledImage;delete W.original;var he=C.extend({},W,{success:function(be){var ae=be.item;function Te(){te._matchBounds(ae,Q)}ae._originalForNavigator=Q,te._matchBounds(ae,Q,!0),Q.addHandler("bounds-change",Te),Q.addHandler("clip-change",Te),Q.addHandler("opacity-change",function Ae(){te._matchOpacity(ae,Q)}),Q.addHandler("composite-operation-change",function me(){te._matchCompositeOperation(ae,Q)})}});return C.Viewer.prototype.addTiledImage.apply(this,[he])},_getMatchingItem:function(W){for(var Q,te=this.world.getItemCount(),he=0;he<te;he++)if((Q=this.world.getItemAt(he))._originalForNavigator===W)return Q;return null},_matchBounds:function(W,te,Q){var he=te.getBoundsNoRotate();W.setPosition(he.getTopLeft(),Q),W.setWidth(he.width,Q),W.setRotation(te.getRotation(),Q),W.setClip(te.getClip())},_matchOpacity:function(W,te){W.setOpacity(te.opacity)},_matchCompositeOperation:function(W,te){W.setCompositeOperation(te.compositeOperation)}})}(OpenSeadragon),function(C){var b={Errors:{Dzc:"Sorry, we don't support Deep Zoom Collections!",Dzi:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",Xml:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",ImageFormat:"Sorry, we don't support {0}-based Deep Zoom Images.",Security:"It looks like a security restriction stopped us from loading this Deep Zoom Image.",Status:"This space unintentionally left blank ({0} {1}).",OpenFailed:"Unable to open {0}: {1}"},Tooltips:{FullPage:"Toggle full page",Home:"Go home",ZoomIn:"Zoom in",ZoomOut:"Zoom out",NextPage:"Next page",PreviousPage:"Previous page",RotateLeft:"Rotate left",RotateRight:"Rotate right",Flip:"Flip Horizontally"}};C.extend(C,{getString:function(D){var W,F=D.split("."),H=null,z=arguments,V=b;for(W=0;W<F.length-1;W++)V=V[F[W]]||{};return"string"!=typeof(H=V[F[W]])&&(C.console.log("Untranslated source string:",D),H=""),H.replace(/\{\d+\}/g,function(te){var Q=parseInt(te.match(/\d+/),10)+1;return Q<z.length?z[Q]:""})},setString:function(D,F){var V,H=D.split("."),z=b;for(V=0;V<H.length-1;V++)z[H[V]]||(z[H[V]]={}),z=z[H[V]];z[H[V]]=F}})}(OpenSeadragon),function(C){C.Point=function(b,D){this.x="number"==typeof b?b:0,this.y="number"==typeof D?D:0},C.Point.prototype={clone:function(){return new C.Point(this.x,this.y)},plus:function(b){return new C.Point(this.x+b.x,this.y+b.y)},minus:function(b){return new C.Point(this.x-b.x,this.y-b.y)},times:function(b){return new C.Point(this.x*b,this.y*b)},divide:function(b){return new C.Point(this.x/b,this.y/b)},negate:function(){return new C.Point(-this.x,-this.y)},distanceTo:function(b){return Math.sqrt(Math.pow(this.x-b.x,2)+Math.pow(this.y-b.y,2))},squaredDistanceTo:function(b){return Math.pow(this.x-b.x,2)+Math.pow(this.y-b.y,2)},apply:function(b){return new C.Point(b(this.x),b(this.y))},equals:function(b){return b instanceof C.Point&&this.x===b.x&&this.y===b.y},rotate:function(b,D){var F,H;if(D=D||new C.Point(0,0),b%90==0)switch(C.positiveModulo(b,360)){case 0:F=1,H=0;break;case 90:F=0,H=1;break;case 180:F=-1,H=0;break;case 270:F=0,H=-1}else{var V=b*Math.PI/180;F=Math.cos(V),H=Math.sin(V)}return new C.Point(F*(this.x-D.x)-H*(this.y-D.y)+D.x,H*(this.x-D.x)+F*(this.y-D.y)+D.y)},toString:function(){return"("+Math.round(100*this.x)/100+","+Math.round(100*this.y)/100+")"}}}(OpenSeadragon),function(C){C.TileSource=function(D,F,H,z,V,W){var he,be,te=this,Q=arguments;if(he=C.isPlainObject(D)?D:{width:Q[0],height:Q[1],tileSize:Q[2],tileOverlap:Q[3],minLevel:Q[4],maxLevel:Q[5]},C.EventSource.call(this),C.extend(!0,this,he),!this.success)for(be=0;be<arguments.length;be++)if(C.isFunction(arguments[be])){this.success=arguments[be];break}this.success&&this.addHandler("ready",function(ae){te.success(ae)}),"string"==C.type(arguments[0])&&(this.url=arguments[0]),this.url?(this.aspectRatio=1,this.dimensions=new C.Point(10,10),this._tileWidth=0,this._tileHeight=0,this.tileOverlap=0,this.minLevel=0,this.maxLevel=0,this.ready=!1,this.getImageInfo(this.url)):(this.ready=!0,this.aspectRatio=he.width&&he.height?he.width/he.height:1,this.dimensions=new C.Point(he.width,he.height),this.tileSize?(this._tileWidth=this._tileHeight=this.tileSize,delete this.tileSize):(this.tileWidth?(this._tileWidth=this.tileWidth,delete this.tileWidth):this._tileWidth=0,this.tileHeight?(this._tileHeight=this.tileHeight,delete this.tileHeight):this._tileHeight=0),this.tileOverlap=he.tileOverlap?he.tileOverlap:0,this.minLevel=he.minLevel?he.minLevel:0,this.maxLevel=null!=he.maxLevel?he.maxLevel:he.width&&he.height?Math.ceil(Math.log(Math.max(he.width,he.height))/Math.log(2)):0,this.success&&C.isFunction(this.success)&&this.success(this))},C.TileSource.prototype={getTileSize:function(D){return C.console.error("[TileSource.getTileSize] is deprecated. Use TileSource.getTileWidth() and TileSource.getTileHeight() instead"),this._tileWidth},getTileWidth:function(D){return this._tileWidth?this._tileWidth:this.getTileSize(D)},getTileHeight:function(D){return this._tileHeight?this._tileHeight:this.getTileSize(D)},getLevelScale:function(D){var H,F={};for(H=0;H<=this.maxLevel;H++)F[H]=1/Math.pow(2,this.maxLevel-H);return this.getLevelScale=function(z){return F[z]},this.getLevelScale(D)},getNumTiles:function(D){var F=this.getLevelScale(D),H=Math.ceil(F*this.dimensions.x/this.getTileWidth(D)),z=Math.ceil(F*this.dimensions.y/this.getTileHeight(D));return new C.Point(H,z)},getPixelRatio:function(D){var F=this.dimensions.times(this.getLevelScale(D));return new C.Point(1/F.x,1/F.y)},getClosestLevel:function(){var D,F;for(D=this.minLevel+1;D<=this.maxLevel&&!((F=this.getNumTiles(D)).x>1||F.y>1);D++);return D-1},getTileAtPoint:function(D,F){C.console.assert(F.x>=0&&F.x<=1&&F.y>=0&&F.y<=1/this.aspectRatio,"[TileSource.getTileAtPoint] must be called with a valid point.");var z=this.dimensions.x*this.getLevelScale(D),W=F.y*z,te=Math.floor(F.x*z/this.getTileWidth(D)),Q=Math.floor(W/this.getTileHeight(D));return F.x>=1&&(te=this.getNumTiles(D).x-1),F.y>=1/this.aspectRatio-1e-15&&(Q=this.getNumTiles(D).y-1),new C.Point(te,Q)},getTileBounds:function(D,F,H,z){var V=this.dimensions.times(this.getLevelScale(D)),W=this.getTileWidth(D),te=this.getTileHeight(D),Q=0===F?0:W*F-this.tileOverlap,he=0===H?0:te*H-this.tileOverlap,be=W+(0===F?1:2)*this.tileOverlap,ae=te+(0===H?1:2)*this.tileOverlap,Te=1/V.x;return be=Math.min(be,V.x-Q),ae=Math.min(ae,V.y-he),z?new C.Rect(0,0,be,ae):new C.Rect(Q*Te,he*Te,be*Te,ae*Te)},getImageInfo:function(D){var H,z,V,W,te,Q,he,F=this;D&&(he=(Q=(te=D.split("/"))[te.length-1]).lastIndexOf("."))>-1&&(te[te.length-1]=Q.slice(0,he)),z=function(be){"string"==typeof be&&(be=C.parseXml(be));var ae=C.TileSource.determineType(F,be,D);ae?(void 0===(W=ae.prototype.configure.apply(F,[be,D])).ajaxWithCredentials&&(W.ajaxWithCredentials=F.ajaxWithCredentials),V=new ae(W),F.ready=!0,F.raiseEvent("ready",{tileSource:V})):F.raiseEvent("open-failed",{message:"Unable to load TileSource",source:D})},D.match(/\.js$/)?(H=D.split("/").pop().replace(".js",""),C.jsonp({url:D,async:!1,callbackName:H,callback:z})):C.makeAjaxRequest({url:D,withCredentials:this.ajaxWithCredentials,headers:this.ajaxHeaders,success:function(be){var ae=function b(D){var V,F=D.responseText,H=D.status;if(!D)throw new Error(C.getString("Errors.Security"));if(200!==D.status&&0!==D.status)throw H=D.status,new Error(C.getString("Errors.Status",H,404==H?"Not Found":D.statusText));if(F.match(/\s*<.*/))try{V=D.responseXML&&D.responseXML.documentElement?D.responseXML:C.parseXml(F)}catch(W){V=D.responseText}else if(F.match(/\s*[\{\[].*/))try{V=C.parseJSON(F)}catch(W){V=F}else V=F;return V}(be);z(ae)},error:function(be,ae){var Te;try{Te="HTTP "+be.status+" attempting to load TileSource"}catch(me){Te=(void 0!==ae&&ae.toString?ae.toString():"Unknown error")+" attempting to load TileSource"}F.raiseEvent("open-failed",{message:Te,source:D})}})},supports:function(D,F){return!1},configure:function(D,F){throw new Error("Method not implemented.")},getTileUrl:function(D,F,H){throw new Error("Method not implemented.")},getTileAjaxHeaders:function(D,F,H){return{}},tileExists:function(D,F,H){var z=this.getNumTiles(D);return D>=this.minLevel&&D<=this.maxLevel&&F>=0&&H>=0&&F<z.x&&H<z.y}},C.extend(!0,C.TileSource.prototype,C.EventSource.prototype),C.TileSource.determineType=function(D,F,H){var z;for(z in OpenSeadragon)if(z.match(/.+TileSource$/)&&C.isFunction(OpenSeadragon[z])&&C.isFunction(OpenSeadragon[z].prototype.supports)&&OpenSeadragon[z].prototype.supports.call(D,F,H))return OpenSeadragon[z];C.console.error("No TileSource was able to open %s %s",H,F)}}(OpenSeadragon),function(C){function D(F,H){var me,G,z=H.Image,V=z.Url,W=z.Format,te=z.Size,Q=z.DisplayRect||[],he=parseInt(te.Width,10),be=parseInt(te.Height,10),ae=parseInt(z.TileSize,10),Te=parseInt(z.Overlap,10),Ae=[];for(G=0;G<Q.length;G++)me=Q[G].Rect,Ae.push(new C.DisplayRect(parseInt(me.X,10),parseInt(me.Y,10),parseInt(me.Width,10),parseInt(me.Height,10),parseInt(me.MinLevel,10),parseInt(me.MaxLevel,10)));return C.extend(!0,{width:he,height:be,tileSize:ae,tileOverlap:Te,minLevel:null,maxLevel:null,tilesUrl:V,fileFormat:W,displayRects:Ae},H)}C.DziTileSource=function(F,H,z,V,W,te,Q,he,be){var ae,Te,Ae,me;if(me=C.isPlainObject(F)?F:{width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4],fileFormat:arguments[5],displayRects:arguments[6],minLevel:arguments[7],maxLevel:arguments[8]},this._levelRects={},this.tilesUrl=me.tilesUrl,this.fileFormat=me.fileFormat,this.displayRects=me.displayRects,this.displayRects)for(ae=this.displayRects.length-1;ae>=0;ae--)for(Ae=(Te=this.displayRects[ae]).minLevel;Ae<=Te.maxLevel;Ae++)this._levelRects[Ae]||(this._levelRects[Ae]=[]),this._levelRects[Ae].push(Te);C.TileSource.apply(this,[me])},C.extend(C.DziTileSource.prototype,C.TileSource.prototype,{supports:function(F,H){var z;return F.Image?z=F.Image.xmlns:F.documentElement&&("Image"==F.documentElement.localName||"Image"==F.documentElement.tagName)&&(z=F.documentElement.namespaceURI),-1!==(z=(z||"").toLowerCase()).indexOf("schemas.microsoft.com/deepzoom/2008")||-1!==z.indexOf("schemas.microsoft.com/deepzoom/2009")},configure:function(F,H){var z;return z=C.isPlainObject(F)?D(0,F):function b(F,H){if(!H||!H.documentElement)throw new Error(C.getString("Errors.Xml"));var he,be,ae,Te,Ae,z=H.documentElement,V=z.localName||z.tagName,W=H.documentElement.namespaceURI,te=null,Q=[];if("Image"==V)try{if(void 0===(Te=z.getElementsByTagName("Size")[0])&&(Te=z.getElementsByTagNameNS(W,"Size")[0]),te={Image:{xmlns:"http://schemas.microsoft.com/deepzoom/2008",Url:z.getAttribute("Url"),Format:z.getAttribute("Format"),DisplayRect:null,Overlap:parseInt(z.getAttribute("Overlap"),10),TileSize:parseInt(z.getAttribute("TileSize"),10),Size:{Height:parseInt(Te.getAttribute("Height"),10),Width:parseInt(Te.getAttribute("Width"),10)}}},!C.imageFormatSupported(te.Image.Format))throw new Error(C.getString("Errors.ImageFormat",te.Image.Format.toUpperCase()));for(void 0===(he=z.getElementsByTagName("DisplayRect"))&&(he=z.getElementsByTagNameNS(W,"DisplayRect")[0]),Ae=0;Ae<he.length;Ae++)void 0===(ae=(be=he[Ae]).getElementsByTagName("Rect")[0])&&(ae=be.getElementsByTagNameNS(W,"Rect")[0]),Q.push({Rect:{X:parseInt(ae.getAttribute("X"),10),Y:parseInt(ae.getAttribute("Y"),10),Width:parseInt(ae.getAttribute("Width"),10),Height:parseInt(ae.getAttribute("Height"),10),MinLevel:parseInt(be.getAttribute("MinLevel"),10),MaxLevel:parseInt(be.getAttribute("MaxLevel"),10)}});return Q.length&&(te.Image.DisplayRect=Q),D(0,te)}catch(de){throw de instanceof Error?de:new Error(C.getString("Errors.Dzi"))}else{if("Collection"==V)throw new Error(C.getString("Errors.Dzc"));if("Error"==V){var me=z.getElementsByTagName("Message")[0];throw new Error(me.firstChild.nodeValue)}}throw new Error(C.getString("Errors.Dzi"))}(0,F),H&&!z.tilesUrl&&(z.tilesUrl=H.replace(/([^\/]+?)(\.(dzi|xml|js)?(\?[^\/]*)?)?\/?$/,"$1_files/"),z.queryParams=-1!=H.search(/\.(dzi|xml|js)\?/)?H.match(/\?.*/):""),z},getTileUrl:function(F,H,z){return[this.tilesUrl,F,"/",H,"_",z,".",this.fileFormat,this.queryParams].join("")},tileExists:function(F,H,z){var W,te,Q,he,be,ae,Te,V=this._levelRects[F];if(this.minLevel&&F<this.minLevel||this.maxLevel&&F>this.maxLevel)return!1;if(!V||!V.length)return!0;for(Te=V.length-1;Te>=0;Te--)if(!(F<(W=V[Te]).minLevel||F>W.maxLevel)&&(te=this.getLevelScale(F),be=(Q=W.x*te)+W.width*te,ae=(he=W.y*te)+W.height*te,Q=Math.floor(Q/this._tileWidth),he=Math.floor(he/this._tileWidth),be=Math.ceil(be/this._tileWidth),ae=Math.ceil(ae/this._tileWidth),Q<=H&&H<be&&he<=z&&z<ae))return!0;return!1}})}(OpenSeadragon),function(C){function b(z){var W=Array.isArray(z.profile)?z.profile[0]:z.profile,te=-1!==["http://library.stanford.edu/iiif/image-api/compliance.html#level0","http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0","http://iiif.io/api/image/2/level0.json","level0","https://iiif.io/api/image/3/level0.json"].indexOf(W),Q=!1;return 2===z.version&&z.profile.length>1&&z.profile[1].supports&&(Q=-1!==z.profile[1].supports.indexOf("sizeByW")),3===z.version&&z.extraFeatures&&(Q=-1!==z.extraFeatures.indexOf("sizeByWh")),!te||Q}function D(z){for(var V=[],W=0;W<z.sizes.length;W++)V.push({url:z["@id"]+"/full/"+z.sizes[W].width+","+(3===z.version?z.sizes[W].height:"")+"/0/default."+z.tileFormat,width:z.sizes[W].width,height:z.sizes[W].height});return V.sort(function(te,Q){return te.width-Q.width})}function H(z,V,W){var te,Q;if(3==z.nodeType&&W)(Q=z.nodeValue.trim()).match(/^\d*$/)&&(Q=Number(Q)),V[W]?(C.isArray(V[W])||(V[W]=[V[W]]),V[W].push(Q)):V[W]=Q;else if(1==z.nodeType)for(te=0;te<z.childNodes.length;te++)H(z.childNodes[te],V,z.nodeName)}C.IIIFTileSource=function(z){if(C.extend(!0,this,z),!(this.height&&this.width&&this["@id"]))throw new Error("IIIF required parameters not provided.");if(z.tileSizePerScaleFactor={},this.tileFormat=this.tileFormat||"jpg",this.version=z.version,this.tile_width&&this.tile_height)z.tileWidth=this.tile_width,z.tileHeight=this.tile_height;else if(this.tile_width)z.tileSize=this.tile_width;else if(this.tile_height)z.tileSize=this.tile_height;else if(this.tiles)if(1==this.tiles.length)z.tileWidth=this.tiles[0].width,z.tileHeight=this.tiles[0].height||this.tiles[0].width,this.scale_factors=this.tiles[0].scaleFactors;else{this.scale_factors=[];for(var V=0;V<this.tiles.length;V++)for(var W=0;W<this.tiles[V].scaleFactors.length;W++){var te=this.tiles[V].scaleFactors[W];this.scale_factors.push(te),z.tileSizePerScaleFactor[te]={width:this.tiles[V].width,height:this.tiles[V].height||this.tiles[V].width}}}else if(b(z)){for(var Q=Math.min(this.height,this.width),he=[256,512,1024],be=[],ae=0;ae<he.length;ae++)he[ae]<=Q&&be.push(he[ae]);z.tileSize=be.length>0?Math.max.apply(null,be):Q}else this.sizes&&this.sizes.length>0?(this.emulateLegacyImagePyramid=!0,z.levels=D(this),C.extend(!0,z,{width:z.levels[z.levels.length-1].width,height:z.levels[z.levels.length-1].height,tileSize:Math.max(z.height,z.width),tileOverlap:0,minLevel:0,maxLevel:z.levels.length-1}),this.levels=z.levels):C.console.error("Nothing in the info.json to construct image pyramids from");if(!z.maxLevel&&!this.emulateLegacyImagePyramid)if(this.scale_factors){var Te=Math.max.apply(null,this.scale_factors);z.maxLevel=Math.round(Math.log(Te)*Math.LOG2E)}else z.maxLevel=Number(Math.ceil(Math.log(Math.max(this.width,this.height),2)));C.TileSource.apply(this,[z])},C.extend(C.IIIFTileSource.prototype,C.TileSource.prototype,{supports:function(z,V){return!!(z.protocol&&"http://iiif.io/api/image"==z.protocol||z["@context"]&&("http://library.stanford.edu/iiif/image-api/1.1/context.json"==z["@context"]||"http://iiif.io/api/image/1/context.json"==z["@context"])||z.profile&&0===z.profile.indexOf("http://library.stanford.edu/iiif/image-api/compliance.html")||z.identifier&&z.width&&z.height)||!(!z.documentElement||"info"!=z.documentElement.tagName||"http://library.stanford.edu/iiif/image-api/ns/"!=z.documentElement.namespaceURI)},configure:function(z,V){if(C.isPlainObject(z)){if(z["@context"]){var te=z["@context"];if(Array.isArray(te))for(var Q=0;Q<te.length;Q++)if("string"==typeof te[Q]&&(/^http:\/\/iiif\.io\/api\/image\/[1-3]\/context\.json$/.test(te[Q])||"http://library.stanford.edu/iiif/image-api/1.1/context.json"===te[Q])){te=te[Q];break}switch(te){case"http://iiif.io/api/image/1/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/context.json":z.version=1;break;case"http://iiif.io/api/image/2/context.json":z.version=2;break;case"http://iiif.io/api/image/3/context.json":z.version=3;break;default:C.console.error("Data has a @context property which contains no known IIIF context URI.")}}else z["@context"]="http://iiif.io/api/image/1.0/context.json",z["@id"]=V.replace("/info.json",""),z.version=1;if(!z["@id"]&&z.id&&(z["@id"]=z.id),z.preferredFormats)for(var he=0;he<z.preferredFormats.length;he++)if(OpenSeadragon.imageFormatSupported(z.preferredFormats[he])){z.tileFormat=z.preferredFormats[he];break}return z}var W=function F(z){if(!z||!z.documentElement)throw new Error(C.getString("Errors.Xml"));var V=z.documentElement,te=null;if("info"==V.tagName)try{return H(V,te={}),te}catch(Q){throw Q instanceof Error?Q:new Error(C.getString("Errors.IIIF"))}throw new Error(C.getString("Errors.IIIF"))}(z);return W["@context"]="http://iiif.io/api/image/1.0/context.json",W["@id"]=V.replace("/info.xml",""),W.version=1,W},getTileWidth:function(z){if(this.emulateLegacyImagePyramid)return C.TileSource.prototype.getTileWidth.call(this,z);var V=Math.pow(2,this.maxLevel-z);return this.tileSizePerScaleFactor&&this.tileSizePerScaleFactor[V]?this.tileSizePerScaleFactor[V].width:this._tileWidth},getTileHeight:function(z){if(this.emulateLegacyImagePyramid)return C.TileSource.prototype.getTileHeight.call(this,z);var V=Math.pow(2,this.maxLevel-z);return this.tileSizePerScaleFactor&&this.tileSizePerScaleFactor[V]?this.tileSizePerScaleFactor[V].height:this._tileHeight},getLevelScale:function(z){if(this.emulateLegacyImagePyramid){var V=NaN;return this.levels.length>0&&z>=this.minLevel&&z<=this.maxLevel&&(V=this.levels[z].width/this.levels[this.maxLevel].width),V}return C.TileSource.prototype.getLevelScale.call(this,z)},getNumTiles:function(z){return this.emulateLegacyImagePyramid?this.getLevelScale(z)?new C.Point(1,1):new C.Point(0,0):C.TileSource.prototype.getNumTiles.call(this,z)},getTileAtPoint:function(z,V){return this.emulateLegacyImagePyramid?new C.Point(0,0):C.TileSource.prototype.getTileAtPoint.call(this,z,V)},getTileUrl:function(z,V,W){if(this.emulateLegacyImagePyramid){var te=null;return this.levels.length>0&&z>=this.minLevel&&z<=this.maxLevel&&(te=this.levels[z].url),te}var Te,Ae,me,G,de,we,Fe,Le,it,at,Dt,dt,Kt,he=Math.pow(.5,this.maxLevel-z),be=Math.ceil(this.width*he),ae=Math.ceil(this.height*he);return Te=this.getTileWidth(z),Ae=this.getTileHeight(z),me=Math.ceil(Te/he),G=Math.ceil(Ae/he),Kt=1===this.version?"native."+this.tileFormat:"default."+this.tileFormat,be<Te&&ae<Ae?(at=2===this.version&&be===this.width||3===this.version&&be===this.width&&ae===this.height?"max":3===this.version?be+","+ae:be+",",de="full"):(we=V*me,Fe=W*G,Le=Math.min(me,this.width-we),it=Math.min(G,this.height-Fe),de=0===V&&0===W&&Le===this.width&&it===this.height?"full":[we,Fe,Le,it].join(","),Dt=Math.ceil(Le*he),dt=Math.ceil(it*he),at=2===this.version&&Dt===this.width||3===this.version&&Dt===this.width&&dt===this.height?"max":3===this.version?Dt+","+dt:Dt+","),[this["@id"],de,at,"0",Kt].join("/")},__testonly__:{canBeTiled:b,constructLevels:D}})}(OpenSeadragon),function(C){C.OsmTileSource=function(b,D,F,H,z){var V;(!(V=C.isPlainObject(b)?b:{width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4]}).width||!V.height)&&(V.width=65572864,V.height=65572864),V.tileSize||(V.tileSize=256,V.tileOverlap=0),V.tilesUrl||(V.tilesUrl="http://tile.openstreetmap.org/"),V.minLevel=8,C.TileSource.apply(this,[V])},C.extend(C.OsmTileSource.prototype,C.TileSource.prototype,{supports:function(b,D){return b.type&&"openstreetmaps"==b.type},configure:function(b,D){return b},getTileUrl:function(b,D,F){return this.tilesUrl+(b-8)+"/"+D+"/"+F+".png"}})}(OpenSeadragon),function(C){C.TmsTileSource=function(b,D,F,H,z){var V;V=C.isPlainObject(b)?b:{width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4]};var Q,W=256*Math.ceil(V.width/256),te=256*Math.ceil(V.height/256);Q=W>te?W/256:te/256,V.maxLevel=Math.ceil(Math.log(Q)/Math.log(2))-1,V.tileSize=256,V.width=W,V.height=te,C.TileSource.apply(this,[V])},C.extend(C.TmsTileSource.prototype,C.TileSource.prototype,{supports:function(b,D){return b.type&&"tiledmapservice"==b.type},configure:function(b,D){return b},getTileUrl:function(b,D,F){var H=this.getNumTiles(b).y-1;return this.tilesUrl+b+"/"+D+"/"+(H-F)+".png"}})}(OpenSeadragon),function(C){C.ZoomifyTileSource=function(b){b.tileSize=256;var D={x:b.width,y:b.height};for(b.imageSizes=[{x:b.width,y:b.height}],b.gridSize=[this._getGridSize(b.width,b.height,b.tileSize)];parseInt(D.x,10)>b.tileSize||parseInt(D.y,10)>b.tileSize;)D.x=Math.floor(D.x/2),D.y=Math.floor(D.y/2),b.imageSizes.push({x:D.x,y:D.y}),b.gridSize.push(this._getGridSize(D.x,D.y,b.tileSize));b.imageSizes.reverse(),b.gridSize.reverse(),b.minLevel=0,b.maxLevel=b.gridSize.length-1,OpenSeadragon.TileSource.apply(this,[b])},C.extend(C.ZoomifyTileSource.prototype,C.TileSource.prototype,{_getGridSize:function(b,D,F){return{x:Math.ceil(b/F),y:Math.ceil(D/F)}},_calculateAbsoluteTileNumber:function(b,D,F){for(var H=0,z={},V=0;V<b;V++)H+=(z=this.gridSize[V]).x*z.y;return H+((z=this.gridSize[b]).x*F+D)},supports:function(b,D){return b.type&&"zoomifytileservice"==b.type},configure:function(b,D){return b},getTileUrl:function(b,D,F){var H,z=this._calculateAbsoluteTileNumber(b,D,F);return H=Math.floor(z/256),this.tilesUrl+"TileGroup"+H+"/"+b+"-"+D+"-"+F+".jpg"}})}(OpenSeadragon),function(C){function F(H,z){return z.levels}C.LegacyTileSource=function(H){var z,V,W;C.isArray(H)&&(z={type:"legacy-image-pyramid",levels:H}),z.levels=function b(H){var V,W,z=[];for(W=0;W<H.length;W++)(V=H[W]).height&&V.width&&V.url?z.push({url:V.url,width:Number(V.width),height:Number(V.height)}):C.console.error("Unsupported image format: %s",V.url?V.url:"<no URL>");return z.sort(function(te,Q){return te.height-Q.height})}(z.levels),z.levels.length>0?(V=z.levels[z.levels.length-1].width,W=z.levels[z.levels.length-1].height):(V=0,W=0,C.console.error("No supported image formats found")),C.extend(!0,z,{width:V,height:W,tileSize:Math.max(W,V),tileOverlap:0,minLevel:0,maxLevel:z.levels.length>0?z.levels.length-1:0}),C.TileSource.apply(this,[z]),this.levels=z.levels},C.extend(C.LegacyTileSource.prototype,C.TileSource.prototype,{supports:function(H,z){return H.type&&"legacy-image-pyramid"==H.type||H.documentElement&&"legacy-image-pyramid"==H.documentElement.getAttribute("type")},configure:function(H,z){var V;return V=C.isPlainObject(H)?F(0,H):function D(H,z){if(!z||!z.documentElement)throw new Error(C.getString("Errors.Xml"));var he,be,V=z.documentElement,W=V.tagName,te=null,Q=[];if("image"==W)try{for(te={type:V.getAttribute("type"),levels:[]},Q=V.getElementsByTagName("level"),be=0;be<Q.length;be++)te.levels.push({url:(he=Q[be]).getAttribute("url"),width:parseInt(he.getAttribute("width"),10),height:parseInt(he.getAttribute("height"),10)});return F(0,te)}catch(ae){throw ae instanceof Error?ae:new Error("Unknown error parsing Legacy Image Pyramid XML.")}else{if("collection"==W)throw new Error("Legacy Image Pyramid Collections not yet supported.");if("error"==W)throw new Error("Error: "+z)}throw new Error("Unknown element "+W)}(0,H),V},getLevelScale:function(H){var z=NaN;return this.levels.length>0&&H>=this.minLevel&&H<=this.maxLevel&&(z=this.levels[H].width/this.levels[this.maxLevel].width),z},getNumTiles:function(H){return this.getLevelScale(H)?new C.Point(1,1):new C.Point(0,0)},getTileUrl:function(H,z,V){var W=null;return this.levels.length>0&&H>=this.minLevel&&H<=this.maxLevel&&(W=this.levels[H].url),W}})}(OpenSeadragon),function(C){C.ImageTileSource=function(b){b=C.extend({buildPyramid:!0,crossOriginPolicy:!1,ajaxWithCredentials:!1,useCanvas:!0},b),C.TileSource.apply(this,[b])},C.extend(C.ImageTileSource.prototype,C.TileSource.prototype,{supports:function(b,D){return b.type&&"image"===b.type},configure:function(b,D){return b},getImageInfo:function(b){var D=this._image=new Image,F=this;this.crossOriginPolicy&&(D.crossOrigin=this.crossOriginPolicy),this.ajaxWithCredentials&&(D.useCredentials=this.ajaxWithCredentials),C.addEvent(D,"load",function(){F.width=Object.prototype.hasOwnProperty.call(D,"naturalWidth")?D.naturalWidth:D.width,F.height=Object.prototype.hasOwnProperty.call(D,"naturalHeight")?D.naturalHeight:D.height,F.aspectRatio=F.width/F.height,F.dimensions=new C.Point(F.width,F.height),F._tileWidth=F.width,F._tileHeight=F.height,F.tileOverlap=0,F.minLevel=0,F.levels=F._buildLevels(),F.maxLevel=F.levels.length-1,F.ready=!0,F.raiseEvent("ready",{tileSource:F})}),C.addEvent(D,"error",function(){F.raiseEvent("open-failed",{message:"Error loading image at "+b,source:b})}),D.src=b},getLevelScale:function(b){var D=NaN;return b>=this.minLevel&&b<=this.maxLevel&&(D=this.levels[b].width/this.levels[this.maxLevel].width),D},getNumTiles:function(b){return this.getLevelScale(b)?new C.Point(1,1):new C.Point(0,0)},getTileUrl:function(b,D,F){var H=null;return b>=this.minLevel&&b<=this.maxLevel&&(H=this.levels[b].url),H},getContext2D:function(b,D,F){var H=null;return b>=this.minLevel&&b<=this.maxLevel&&(H=this.levels[b].context2D),H},_buildLevels:function(){var b=[{url:this._image.src,width:Object.prototype.hasOwnProperty.call(this._image,"naturalWidth")?this._image.naturalWidth:this._image.width,height:Object.prototype.hasOwnProperty.call(this._image,"naturalHeight")?this._image.naturalHeight:this._image.height}];if(!this.buildPyramid||!C.supportsCanvas||!this.useCanvas)return delete this._image,b;var D=Object.prototype.hasOwnProperty.call(this._image,"naturalWidth")?this._image.naturalWidth:this._image.width,F=Object.prototype.hasOwnProperty.call(this._image,"naturalHeight")?this._image.naturalHeight:this._image.height,H=document.createElement("canvas"),z=H.getContext("2d");if(H.width=D,H.height=F,z.drawImage(this._image,0,0,D,F),b[0].context2D=z,delete this._image,C.isCanvasTainted(H))return b;for(;D>=2&&F>=2;){D=Math.floor(D/2),F=Math.floor(F/2);var V=document.createElement("canvas"),W=V.getContext("2d");V.width=D,V.height=F,W.drawImage(H,0,0,D,F),b.splice(0,0,{context2D:W,width:D,height:F}),H=V,z=W}return b}})}(OpenSeadragon),function(C){C.TileSourceCollection=function(b,D,F,H){C.console.error("TileSourceCollection is deprecated; use World instead")}}(OpenSeadragon),function(C){function b(W){C.requestAnimationFrame(function(){!function D(W){var he;W.shouldFade&&(he=1-(C.now()-W.fadeBeginTime)/W.fadeLength,he=Math.min(1,he),he=Math.max(0,he),W.imgGroup&&C.setElementOpacity(W.imgGroup,he,!0),he>0&&b(W))}(W)})}function z(W,te){W.element.disabled||(te>=C.ButtonState.GROUP&&W.currentState==C.ButtonState.REST&&(function H(W){W.shouldFade=!1,W.imgGroup&&C.setElementOpacity(W.imgGroup,1,!0)}(W),W.currentState=C.ButtonState.GROUP),te>=C.ButtonState.HOVER&&W.currentState==C.ButtonState.GROUP&&(W.imgHover&&(W.imgHover.style.visibility=""),W.currentState=C.ButtonState.HOVER),te>=C.ButtonState.DOWN&&W.currentState==C.ButtonState.HOVER&&(W.imgDown&&(W.imgDown.style.visibility=""),W.currentState=C.ButtonState.DOWN))}function V(W,te){W.element.disabled||(te<=C.ButtonState.HOVER&&W.currentState==C.ButtonState.DOWN&&(W.imgDown&&(W.imgDown.style.visibility="hidden"),W.currentState=C.ButtonState.HOVER),te<=C.ButtonState.GROUP&&W.currentState==C.ButtonState.HOVER&&(W.imgHover&&(W.imgHover.style.visibility="hidden"),W.currentState=C.ButtonState.GROUP),te<=C.ButtonState.REST&&W.currentState==C.ButtonState.GROUP&&(function F(W){W.shouldFade=!0,W.fadeBeginTime=C.now()+W.fadeDelay,window.setTimeout(function(){b(W)},W.fadeDelay)}(W),W.currentState=C.ButtonState.REST))}C.ButtonState={REST:0,GROUP:1,HOVER:2,DOWN:3},C.Button=function(W){var te=this;C.EventSource.call(this),C.extend(!0,this,{tooltip:null,srcRest:null,srcGroup:null,srcHover:null,srcDown:null,clickTimeThreshold:C.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:C.DEFAULT_SETTINGS.clickDistThreshold,fadeDelay:0,fadeLength:2e3,onPress:null,onRelease:null,onClick:null,onEnter:null,onExit:null,onFocus:null,onBlur:null},W),this.element=W.element||C.makeNeutralElement("div"),W.element||(this.imgRest=C.makeTransparentImage(this.srcRest),this.imgGroup=C.makeTransparentImage(this.srcGroup),this.imgHover=C.makeTransparentImage(this.srcHover),this.imgDown=C.makeTransparentImage(this.srcDown),this.imgRest.alt=this.imgGroup.alt=this.imgHover.alt=this.imgDown.alt=this.tooltip,this.element.style.position="relative",C.setElementTouchActionNone(this.element),this.imgGroup.style.position=this.imgHover.style.position=this.imgDown.style.position="absolute",this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top="0px",this.imgGroup.style.left=this.imgHover.style.left=this.imgDown.style.left="0px",this.imgHover.style.visibility=this.imgDown.style.visibility="hidden",C.Browser.vendor==C.BROWSERS.FIREFOX&&C.Browser.version<3&&(this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top=""),this.element.appendChild(this.imgRest),this.element.appendChild(this.imgGroup),this.element.appendChild(this.imgHover),this.element.appendChild(this.imgDown)),this.addHandler("press",this.onPress),this.addHandler("release",this.onRelease),this.addHandler("click",this.onClick),this.addHandler("enter",this.onEnter),this.addHandler("exit",this.onExit),this.addHandler("focus",this.onFocus),this.addHandler("blur",this.onBlur),this.currentState=C.ButtonState.GROUP,this.fadeBeginTime=null,this.shouldFade=!1,this.element.style.display="inline-block",this.element.style.position="relative",this.element.title=this.tooltip,this.tracker=new C.MouseTracker({element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(Q){Q.insideElementPressed?(z(te,C.ButtonState.DOWN),te.raiseEvent("enter",{originalEvent:Q.originalEvent})):Q.buttonDownAny||z(te,C.ButtonState.HOVER)},focusHandler:function(Q){this.enterHandler(Q),te.raiseEvent("focus",{originalEvent:Q.originalEvent})},exitHandler:function(Q){V(te,C.ButtonState.GROUP),Q.insideElementPressed&&te.raiseEvent("exit",{originalEvent:Q.originalEvent})},blurHandler:function(Q){this.exitHandler(Q),te.raiseEvent("blur",{originalEvent:Q.originalEvent})},pressHandler:function(Q){z(te,C.ButtonState.DOWN),te.raiseEvent("press",{originalEvent:Q.originalEvent})},releaseHandler:function(Q){Q.insideElementPressed&&Q.insideElementReleased?(V(te,C.ButtonState.HOVER),te.raiseEvent("release",{originalEvent:Q.originalEvent})):Q.insideElementPressed?V(te,C.ButtonState.GROUP):z(te,C.ButtonState.HOVER)},clickHandler:function(Q){Q.quick&&te.raiseEvent("click",{originalEvent:Q.originalEvent})},keyHandler:function(Q){return 13!==Q.keyCode||(te.raiseEvent("click",{originalEvent:Q.originalEvent}),te.raiseEvent("release",{originalEvent:Q.originalEvent}),!1)}}),V(this,C.ButtonState.REST)},C.extend(C.Button.prototype,C.EventSource.prototype,{notifyGroupEnter:function(){z(this,C.ButtonState.GROUP)},notifyGroupExit:function(){V(this,C.ButtonState.REST)},disable:function(){this.notifyGroupExit(),this.element.disabled=!0,C.setElementOpacity(this.element,.2,!0)},enable:function(){this.element.disabled=!1,C.setElementOpacity(this.element,1,!0),this.notifyGroupEnter()}})}(OpenSeadragon),function(C){C.ButtonGroup=function(b){C.extend(!0,this,{buttons:[],clickTimeThreshold:C.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:C.DEFAULT_SETTINGS.clickDistThreshold,labelText:""},b);var H,D=this.buttons.concat([]),F=this;if(this.element=b.element||C.makeNeutralElement("div"),!b.group)for(this.element.style.display="inline-block",H=0;H<D.length;H++)this.element.appendChild(D[H].element);C.setElementTouchActionNone(this.element),this.tracker=new C.MouseTracker({element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(z){var V;for(V=0;V<F.buttons.length;V++)F.buttons[V].notifyGroupEnter()},exitHandler:function(z){var V;if(!z.insideElementPressed)for(V=0;V<F.buttons.length;V++)F.buttons[V].notifyGroupExit()}})},C.ButtonGroup.prototype={emulateEnter:function(){this.tracker.enterHandler({eventSource:this.tracker})},emulateExit:function(){this.tracker.exitHandler({eventSource:this.tracker})}}}(OpenSeadragon),function(C){C.Rect=function(b,D,F,H,z){var V,W;this.x="number"==typeof b?b:0,this.y="number"==typeof D?D:0,this.width="number"==typeof F?F:0,this.height="number"==typeof H?H:0,this.degrees="number"==typeof z?z:0,this.degrees=C.positiveModulo(this.degrees,360),this.degrees>=270?(V=this.getTopRight(),this.x=V.x,this.y=V.y,W=this.height,this.height=this.width,this.width=W,this.degrees-=270):this.degrees>=180?(V=this.getBottomRight(),this.x=V.x,this.y=V.y,this.degrees-=180):this.degrees>=90&&(V=this.getBottomLeft(),this.x=V.x,this.y=V.y,W=this.height,this.height=this.width,this.width=W,this.degrees-=90)},C.Rect.fromSummits=function(b,D,F){var H=b.distanceTo(D),z=b.distanceTo(F),V=D.minus(b),W=Math.atan(V.y/V.x);return V.x<0?W+=Math.PI:V.y<0&&(W+=2*Math.PI),new C.Rect(b.x,b.y,H,z,W/Math.PI*180)},C.Rect.prototype={clone:function(){return new C.Rect(this.x,this.y,this.width,this.height,this.degrees)},getAspectRatio:function(){return this.width/this.height},getTopLeft:function(){return new C.Point(this.x,this.y)},getBottomRight:function(){return new C.Point(this.x+this.width,this.y+this.height).rotate(this.degrees,this.getTopLeft())},getTopRight:function(){return new C.Point(this.x+this.width,this.y).rotate(this.degrees,this.getTopLeft())},getBottomLeft:function(){return new C.Point(this.x,this.y+this.height).rotate(this.degrees,this.getTopLeft())},getCenter:function(){return new C.Point(this.x+this.width/2,this.y+this.height/2).rotate(this.degrees,this.getTopLeft())},getSize:function(){return new C.Point(this.width,this.height)},equals:function(b){return b instanceof C.Rect&&this.x===b.x&&this.y===b.y&&this.width===b.width&&this.height===b.height&&this.degrees===b.degrees},times:function(b){return new C.Rect(this.x*b,this.y*b,this.width*b,this.height*b,this.degrees)},translate:function(b){return new C.Rect(this.x+b.x,this.y+b.y,this.width,this.height,this.degrees)},union:function(b){var D=this.getBoundingBox(),F=b.getBoundingBox(),H=Math.min(D.x,F.x),z=Math.min(D.y,F.y),V=Math.max(D.x+D.width,F.x+F.width),W=Math.max(D.y+D.height,F.y+F.height);return new C.Rect(H,z,V-H,W-z)},intersection:function(b){var D=1e-10,F=[],H=this.getTopLeft();b.containsPoint(H,D)&&F.push(H);var z=this.getTopRight();b.containsPoint(z,D)&&F.push(z);var V=this.getBottomLeft();b.containsPoint(V,D)&&F.push(V);var W=this.getBottomRight();b.containsPoint(W,D)&&F.push(W);var te=b.getTopLeft();this.containsPoint(te,D)&&F.push(te);var Q=b.getTopRight();this.containsPoint(Q,D)&&F.push(Q);var he=b.getBottomLeft();this.containsPoint(he,D)&&F.push(he);var be=b.getBottomRight();this.containsPoint(be,D)&&F.push(be);for(var ae=this._getSegments(),Te=b._getSegments(),Ae=0;Ae<ae.length;Ae++)for(var me=ae[Ae],G=0;G<Te.length;G++){var de=Te[G],we=Fe(me[0],me[1],de[0],de[1]);we&&F.push(we)}function Fe(oi,We,xt,_e){var Lt=We.minus(oi),$i=_e.minus(xt),Wt=-$i.x*Lt.y+Lt.x*$i.y;if(0===Wt)return null;var Ei=(Lt.x*(oi.y-xt.y)-Lt.y*(oi.x-xt.x))/Wt,Rt=($i.x*(oi.y-xt.y)-$i.y*(oi.x-xt.x))/Wt;return-D<=Ei&&Ei<=1-D&&-D<=Rt&&Rt<=1-D?new C.Point(oi.x+Rt*Lt.x,oi.y+Rt*Lt.y):null}if(0===F.length)return null;for(var Le=F[0].x,it=F[0].x,at=F[0].y,Dt=F[0].y,dt=1;dt<F.length;dt++){var Kt=F[dt];Kt.x<Le&&(Le=Kt.x),Kt.x>it&&(it=Kt.x),Kt.y<at&&(at=Kt.y),Kt.y>Dt&&(Dt=Kt.y)}return new C.Rect(Le,at,it-Le,Dt-at)},_getSegments:function(){var b=this.getTopLeft(),D=this.getTopRight(),F=this.getBottomLeft(),H=this.getBottomRight();return[[b,D],[D,H],[H,F],[F,b]]},rotate:function(b,D){if(0===(b=C.positiveModulo(b,360)))return this.clone();D=D||this.getCenter();var F=this.getTopLeft().rotate(b,D),z=this.getTopRight().rotate(b,D).minus(F);z=z.apply(function(W){return Math.abs(W)<1e-15?0:W});var V=Math.atan(z.y/z.x);return z.x<0?V+=Math.PI:z.y<0&&(V+=2*Math.PI),new C.Rect(F.x,F.y,this.width,this.height,V/Math.PI*180)},getBoundingBox:function(){if(0===this.degrees)return this.clone();var b=this.getTopLeft(),D=this.getTopRight(),F=this.getBottomLeft(),H=this.getBottomRight(),z=Math.min(b.x,D.x,F.x,H.x),V=Math.max(b.x,D.x,F.x,H.x),W=Math.min(b.y,D.y,F.y,H.y),te=Math.max(b.y,D.y,F.y,H.y);return new C.Rect(z,W,V-z,te-W)},getIntegerBoundingBox:function(){var b=this.getBoundingBox(),D=Math.floor(b.x),F=Math.floor(b.y),H=Math.ceil(b.width+b.x-D),z=Math.ceil(b.height+b.y-F);return new C.Rect(D,F,H,z)},containsPoint:function(b,D){D=D||0;var F=this.getTopLeft(),H=this.getTopRight(),z=this.getBottomLeft(),V=H.minus(F),W=z.minus(F);return(b.x-F.x)*V.x+(b.y-F.y)*V.y>=-D&&(b.x-H.x)*V.x+(b.y-H.y)*V.y<=D&&(b.x-F.x)*W.x+(b.y-F.y)*W.y>=-D&&(b.x-z.x)*W.x+(b.y-z.y)*W.y<=D},toString:function(){return"["+Math.round(100*this.x)/100+", "+Math.round(100*this.y)/100+", "+Math.round(100*this.width)/100+"x"+Math.round(100*this.height)/100+", "+Math.round(100*this.degrees)/100+"deg]"}}}(OpenSeadragon),function(C){var b={};function D(Q){var he=Number(this.element.style.marginLeft.replace("px","")),be=Number(this.element.style.marginTop.replace("px","")),ae=Number(this.element.style.width.replace("px","")),Te=Number(this.element.style.height.replace("px","")),Ae=C.getElementSize(this.viewer.canvas);return this.dragging=!0,this.element&&("horizontal"==this.scroll?-Q.delta.x>0?he>-(ae-Ae.x)&&(this.element.style.marginLeft=he+2*Q.delta.x+"px",H(this,Ae.x,he+2*Q.delta.x)):-Q.delta.x<0&&he<0&&(this.element.style.marginLeft=he+2*Q.delta.x+"px",H(this,Ae.x,he+2*Q.delta.x)):-Q.delta.y>0?be>-(Te-Ae.y)&&(this.element.style.marginTop=be+2*Q.delta.y+"px",H(this,Ae.y,be+2*Q.delta.y)):-Q.delta.y<0&&be<0&&(this.element.style.marginTop=be+2*Q.delta.y+"px",H(this,Ae.y,be+2*Q.delta.y))),!1}function F(Q){var he=Number(this.element.style.marginLeft.replace("px","")),be=Number(this.element.style.marginTop.replace("px","")),ae=Number(this.element.style.width.replace("px","")),Te=Number(this.element.style.height.replace("px","")),Ae=C.getElementSize(this.viewer.canvas);return this.element&&("horizontal"==this.scroll?Q.scroll>0?he>-(ae-Ae.x)&&(this.element.style.marginLeft=he-60*Q.scroll+"px",H(this,Ae.x,he-60*Q.scroll)):Q.scroll<0&&he<0&&(this.element.style.marginLeft=he-60*Q.scroll+"px",H(this,Ae.x,he-60*Q.scroll)):Q.scroll<0?be>Ae.y-Te&&(this.element.style.marginTop=be+60*Q.scroll+"px",H(this,Ae.y,be+60*Q.scroll)):Q.scroll>0&&be<0&&(this.element.style.marginTop=be+60*Q.scroll+"px",H(this,Ae.y,be+60*Q.scroll))),!1}function H(Q,he,be){var ae,Te,Ae,me,G,de,we;for(ae="horizontal"==Q.scroll?Q.panelWidth:Q.panelHeight,Te=Math.ceil(he/ae)+5,de=Te=(Te=(Ae=Math.ceil((Math.abs(be)+he)/ae)+1)-Te)<0?0:Te;de<Ae&&de<Q.panels.length;de++)if(!(we=Q.panels[de]).activePanel){var Le=Q.viewer.tileSources[de];(me=new C.Viewer({id:we.id,tileSources:[Le.referenceStripThumbnailUrl?{type:"image",url:Le.referenceStripThumbnailUrl}:Le],element:we,navigatorSizeRatio:Q.sizeRatio,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:0,loadTilesWithAjax:Q.viewer.loadTilesWithAjax,ajaxHeaders:Q.viewer.ajaxHeaders,useCanvas:Q.useCanvas})).displayRegion=C.makeNeutralElement("div"),me.displayRegion.id=we.id+"-displayregion",me.displayRegion.className="displayregion",(G=me.displayRegion.style).position="relative",G.top="0px",G.left="0px",G.fontSize="0px",G.overflow="hidden",G.float="left",G.cssFloat="left",G.styleFloat="left",G.zIndex=999999999,G.cursor="default",G.width=Q.panelWidth-4+"px",G.height=Q.panelHeight-4+"px",me.displayRegion.innerTracker=new C.MouseTracker({element:me.displayRegion,startDisabled:!0}),we.getElementsByTagName("div")[0].appendChild(me.displayRegion),Q.miniViewers[we.id]=me,we.activePanel=!0}}function z(Q){var he=Q.eventSource.element;return"horizontal"==this.scroll?he.style.marginBottom="0px":he.style.marginLeft="0px",!1}function V(Q){var he=Q.eventSource.element;return"horizontal"==this.scroll?he.style.marginBottom="-"+C.getElementSize(he).y/2+"px":he.style.marginLeft="-"+C.getElementSize(he).x/2+"px",!1}function W(Q){if(Q.preventDefaultAction||Q.ctrl||Q.alt||Q.meta)return!0;switch(Q.keyCode){case 38:case 39:return F.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;case 40:case 37:return F.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),!1;default:return!0}}function te(Q){if(Q.preventDefaultAction||Q.ctrl||Q.alt||Q.meta)return!0;switch(Q.keyCode){case 61:case 48:case 119:case 87:case 100:return F.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;case 45:case 115:case 83:case 97:return F.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),!1;default:return!0}}C.ReferenceStrip=function(Q){var Te,Ae,me,be=Q.viewer,ae=C.getElementSize(be.element);for(Q.id||(Q.id="referencestrip-"+C.now(),this.element=C.makeNeutralElement("div"),this.element.id=Q.id,this.element.className="referencestrip"),Q=C.extend(!0,{sizeRatio:C.DEFAULT_SETTINGS.referenceStripSizeRatio,position:C.DEFAULT_SETTINGS.referenceStripPosition,scroll:C.DEFAULT_SETTINGS.referenceStripScroll,clickTimeThreshold:C.DEFAULT_SETTINGS.clickTimeThreshold},Q,{element:this.element,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1}),C.extend(this,Q),b[this.id]={animating:!1},this.minPixelRatio=this.viewer.minPixelRatio,(Ae=this.element.style).marginTop="0px",Ae.marginRight="0px",Ae.marginBottom="0px",Ae.marginLeft="0px",Ae.left="0px",Ae.bottom="0px",Ae.border="0px",Ae.background="#000",Ae.position="relative",C.setElementTouchActionNone(this.element),C.setElementOpacity(this.element,.8),this.viewer=be,this.innerTracker=new C.MouseTracker({element:this.element,dragHandler:C.delegate(this,D),scrollHandler:C.delegate(this,F),enterHandler:C.delegate(this,z),exitHandler:C.delegate(this,V),keyDownHandler:C.delegate(this,W),keyHandler:C.delegate(this,te)}),Q.width&&Q.height?(this.element.style.width=Q.width+"px",this.element.style.height=Q.height+"px",be.addControl(this.element,{anchor:C.ControlAnchor.BOTTOM_LEFT})):"horizontal"==Q.scroll?(this.element.style.width=ae.x*Q.sizeRatio*be.tileSources.length+12*be.tileSources.length+"px",this.element.style.height=ae.y*Q.sizeRatio+"px",be.addControl(this.element,{anchor:C.ControlAnchor.BOTTOM_LEFT})):(this.element.style.height=ae.y*Q.sizeRatio*be.tileSources.length+12*be.tileSources.length+"px",this.element.style.width=ae.x*Q.sizeRatio+"px",be.addControl(this.element,{anchor:C.ControlAnchor.TOP_LEFT})),this.panelWidth=ae.x*this.sizeRatio+8,this.panelHeight=ae.y*this.sizeRatio+8,this.panels=[],this.miniViewers={},me=0;me<be.tileSources.length;me++)(Te=C.makeNeutralElement("div")).id=this.element.id+"-"+me,Te.style.width=this.panelWidth+"px",Te.style.height=this.panelHeight+"px",Te.style.display="inline",Te.style.float="left",Te.style.cssFloat="left",Te.style.styleFloat="left",Te.style.padding="2px",C.setElementTouchActionNone(Te),Te.innerTracker=new C.MouseTracker({element:Te,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,pressHandler:function(G){G.eventSource.dragging=C.now()},releaseHandler:function(G){var de=G.eventSource,Fe=Number(de.element.id.split("-")[2]),Le=C.now();G.insideElementPressed&&G.insideElementReleased&&de.dragging&&Le-de.dragging<de.clickTimeThreshold&&(de.dragging=null,be.goToPage(Fe))}}),this.element.appendChild(Te),Te.activePanel=!1,this.panels.push(Te);H(this,"vertical"==this.scroll?ae.y:ae.x,0),this.setFocus(0)},C.extend(C.ReferenceStrip.prototype,C.EventSource.prototype,C.Viewer.prototype,{setFocus:function(Q){var G,he=this.element.querySelector("#"+this.element.id+"-"+Q),be=C.getElementSize(this.viewer.canvas),ae=Number(this.element.style.width.replace("px","")),Te=Number(this.element.style.height.replace("px","")),Ae=-Number(this.element.style.marginLeft.replace("px","")),me=-Number(this.element.style.marginTop.replace("px",""));this.currentSelected!==he&&(this.currentSelected&&(this.currentSelected.style.background="#000"),this.currentSelected=he,this.currentSelected.style.background="#999","horizontal"==this.scroll?(G=Number(Q)*(this.panelWidth+3))>Ae+be.x-this.panelWidth?(G=Math.min(G,ae-be.x),this.element.style.marginLeft=-G+"px",H(this,be.x,-G)):G<Ae&&(G=Math.max(0,G-be.x/2),this.element.style.marginLeft=-G+"px",H(this,be.x,-G)):(G=Number(Q)*(this.panelHeight+3))>me+be.y-this.panelHeight?(G=Math.min(G,Te-be.y),this.element.style.marginTop=-G+"px",H(this,be.y,-G)):G<me&&(G=Math.max(0,G-be.y/2),this.element.style.marginTop=-G+"px",H(this,be.y,-G)),this.currentPage=Q,z.call(this,{eventSource:this.innerTracker}))},update:function(){return!!b[this.id].animating&&(C.console.log("image reference strip update"),!0)},destroy:function(){if(this.miniViewers)for(var Q in this.miniViewers)this.miniViewers[Q].destroy();this.element&&this.element.parentNode.removeChild(this.element)}})}(OpenSeadragon),function(C){C.DisplayRect=function(b,D,F,H,z,V){C.Rect.apply(this,[b,D,F,H]),this.minLevel=z,this.maxLevel=V},C.extend(C.DisplayRect.prototype,C.Rect.prototype)}(OpenSeadragon),function(C){C.Spring=function(D){var F=arguments;"object"!=typeof D&&(D={initial:F.length&&"number"==typeof F[0]?F[0]:void 0,springStiffness:F.length>1?F[1].springStiffness:5,animationTime:F.length>1?F[1].animationTime:1.5}),C.console.assert("number"==typeof D.springStiffness&&0!==D.springStiffness,"[OpenSeadragon.Spring] options.springStiffness must be a non-zero number"),C.console.assert("number"==typeof D.animationTime&&D.animationTime>=0,"[OpenSeadragon.Spring] options.animationTime must be a number greater than or equal to 0"),D.exponential&&(this._exponential=!0,delete D.exponential),C.extend(!0,this,D),this.current={value:"number"==typeof this.initial?this.initial:this._exponential?0:1,time:C.now()},C.console.assert(!this._exponential||0!==this.current.value,"[OpenSeadragon.Spring] value must be non-zero for exponential springs"),this.start={value:this.current.value,time:this.current.time},this.target={value:this.current.value,time:this.current.time},this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},C.Spring.prototype={resetTo:function(D){C.console.assert(!this._exponential||0!==D,"[OpenSeadragon.Spring.resetTo] target must be non-zero for exponential springs"),this.start.value=this.target.value=this.current.value=D,this.start.time=this.target.time=this.current.time=C.now(),this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},springTo:function(D){C.console.assert(!this._exponential||0!==D,"[OpenSeadragon.Spring.springTo] target must be non-zero for exponential springs"),this.start.value=this.current.value,this.start.time=this.current.time,this.target.value=D,this.target.time=this.start.time+1e3*this.animationTime,this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value))},shiftBy:function(D){this.start.value+=D,this.target.value+=D,this._exponential&&(C.console.assert(0!==this.target.value&&0!==this.start.value,"[OpenSeadragon.Spring.shiftBy] spring value must be non-zero for exponential springs"),this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value))},setExponential:function(D){this._exponential=D,this._exponential&&(C.console.assert(0!==this.current.value&&0!==this.target.value&&0!==this.start.value,"[OpenSeadragon.Spring.setExponential] spring value must be non-zero for exponential springs"),this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},update:function(){var D,F;this.current.time=C.now(),this._exponential?(D=this.start._logValue,F=this.target._logValue):(D=this.start.value,F=this.target.value);var H=this.current.time>=this.target.time?F:D+(F-D)*function b(D,F){return(1-Math.exp(D*-F))/(1-Math.exp(-D))}(this.springStiffness,(this.current.time-this.start.time)/(this.target.time-this.start.time)),z=this.current.value;return this.current.value=this._exponential?Math.exp(H):H,z!=this.current.value},isAtTargetValue:function(){return this.current.value===this.target.value}}}(OpenSeadragon),function(C){function b(F){C.extend(!0,this,{timeout:C.DEFAULT_SETTINGS.timeout,jobId:null},F),this.image=null}b.prototype={errorMsg:null,start:function(){var F=this,H=this.abort;this.image=new Image,this.image.onload=function(){F.finish(!0)},this.image.onabort=this.image.onerror=function(){F.errorMsg="Image load aborted",F.finish(!1)},this.jobId=window.setTimeout(function(){F.errorMsg="Image load exceeded timeout ("+F.timeout+" ms)",F.finish(!1)},this.timeout),this.loadWithAjax?(this.request=C.makeAjaxRequest({url:this.src,withCredentials:this.ajaxWithCredentials,headers:this.ajaxHeaders,responseType:"arraybuffer",success:function(z){var V;try{V=new window.Blob([z.response])}catch(he){var W=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;if("TypeError"===he.name&&W){var te=new W;te.append(z.response),V=te.getBlob()}}0===V.size&&(F.errorMsg="Empty image response.",F.finish(!1));var Q=(window.URL||window.webkitURL).createObjectURL(V);F.image.src=Q},error:function(z){F.errorMsg="Image load aborted - XHR error",F.finish(!1)}}),this.abort=function(){F.request.abort(),"function"==typeof H&&H()}):(!1!==this.crossOriginPolicy&&(this.image.crossOrigin=this.crossOriginPolicy),this.image.src=this.src)},finish:function(F){this.image.onload=this.image.onerror=this.image.onabort=null,F||(this.image=null),this.jobId&&window.clearTimeout(this.jobId),this.callback(this)}},C.ImageLoader=function(F){C.extend(!0,this,{jobLimit:C.DEFAULT_SETTINGS.imageLoaderLimit,timeout:C.DEFAULT_SETTINGS.timeout,jobQueue:[],jobsInProgress:0},F)},C.ImageLoader.prototype={addJob:function(F){var H=this,V={src:F.src,loadWithAjax:F.loadWithAjax,ajaxHeaders:F.loadWithAjax?F.ajaxHeaders:null,crossOriginPolicy:F.crossOriginPolicy,ajaxWithCredentials:F.ajaxWithCredentials,callback:function(te){!function D(F,H,z){F.jobsInProgress--,(!F.jobLimit||F.jobsInProgress<F.jobLimit)&&F.jobQueue.length>0&&(F.jobQueue.shift().start(),F.jobsInProgress++),z(H.image,H.errorMsg,H.request)}(H,te,F.callback)},abort:F.abort,timeout:this.timeout},W=new b(V);!this.jobLimit||this.jobsInProgress<this.jobLimit?(W.start(),this.jobsInProgress++):this.jobQueue.push(W)},clear:function(){for(var F=0;F<this.jobQueue.length;F++){var H=this.jobQueue[F];"function"==typeof H.abort&&H.abort()}this.jobQueue=[]}}}(OpenSeadragon),function(C){C.Tile=function(b,D,F,H,z,V,W,te,Q,he){this.level=b,this.x=D,this.y=F,this.bounds=H,this.sourceBounds=he,this.exists=z,this.url=V,this.context2D=W,this.loadWithAjax=te,this.ajaxHeaders=Q,this.cacheKey=this.ajaxHeaders?this.url+"+"+JSON.stringify(this.ajaxHeaders):this.url,this.loaded=!1,this.loading=!1,this.element=null,this.imgElement=null,this.image=null,this.style=null,this.position=null,this.size=null,this.blendStart=null,this.opacity=null,this.squaredDistance=null,this.visibility=null,this.beingDrawn=!1,this.lastTouchTime=0,this.isRightMost=!1,this.isBottomMost=!1},C.Tile.prototype={toString:function(){return this.level+"/"+this.x+"_"+this.y},_hasTransparencyChannel:function(){return!!this.context2D||this.url.match(".png")},drawHTML:function(b){this.cacheImageRecord?this.loaded?(this.element||(this.element=C.makeNeutralElement("div"),this.imgElement=this.cacheImageRecord.getImage().cloneNode(),this.imgElement.style.msInterpolationMode="nearest-neighbor",this.imgElement.style.width="100%",this.imgElement.style.height="100%",this.style=this.element.style,this.style.position="absolute"),this.element.parentNode!=b&&b.appendChild(this.element),this.imgElement.parentNode!=this.element&&this.element.appendChild(this.imgElement),this.style.top=this.position.y+"px",this.style.left=this.position.x+"px",this.style.height=this.size.y+"px",this.style.width=this.size.x+"px",C.setElementOpacity(this.element,this.opacity)):C.console.warn("Attempting to draw tile %s when it's not yet loaded.",this.toString()):C.console.warn("[Tile.drawHTML] attempting to draw tile %s when it's not cached",this.toString())},drawCanvas:function(b,D,F,H){var W,te,Q,z=this.position.times(C.pixelDensityRatio),V=this.size.times(C.pixelDensityRatio);this.context2D||this.cacheImageRecord?(W=this.context2D||this.cacheImageRecord.getRenderedContext(),this.loaded&&W?(b.save(),b.globalAlpha=this.opacity,"number"==typeof F&&1!==F&&(z=z.times(F),V=V.times(F)),H instanceof C.Point&&(z=z.plus(H)),1===b.globalAlpha&&this._hasTransparencyChannel()&&b.clearRect(z.x,z.y,V.x,V.y),D({context:b,tile:this,rendered:W}),this.sourceBounds?(te=Math.min(this.sourceBounds.width,W.canvas.width),Q=Math.min(this.sourceBounds.height,W.canvas.height)):(te=W.canvas.width,Q=W.canvas.height),b.drawImage(W.canvas,0,0,te,Q,z.x,z.y,V.x,V.y),b.restore()):C.console.warn("Attempting to draw tile %s when it's not yet loaded.",this.toString())):C.console.warn("[Tile.drawCanvas] attempting to draw tile %s when it's not cached",this.toString())},getScaleForEdgeSmoothing:function(){var b;if(this.cacheImageRecord)b=this.cacheImageRecord.getRenderedContext();else{if(!this.context2D)return C.console.warn("[Tile.drawCanvas] attempting to get tile scale %s when tile's not cached",this.toString()),1;b=this.context2D}return b.canvas.width/(this.size.x*C.pixelDensityRatio)},getTranslationForEdgeSmoothing:function(b,D,F){var H=Math.max(1,Math.ceil((F.x-D.x)/2)),z=Math.max(1,Math.ceil((F.y-D.y)/2));return new C.Point(H,z).minus(this.position.times(C.pixelDensityRatio).times(b||1).apply(function(V){return V%1}))},unload:function(){this.imgElement&&this.imgElement.parentNode&&this.imgElement.parentNode.removeChild(this.imgElement),this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=null,this.imgElement=null,this.loaded=!1,this.loading=!1}}}(OpenSeadragon),function(C){C.OverlayPlacement=C.Placement,C.OverlayRotationMode=C.freezeObject({NO_ROTATION:1,EXACT:2,BOUNDING_BOX:3}),C.Overlay=function(b,D,F){var H;H=C.isPlainObject(b)?b:{element:b,location:D,placement:F},this.element=H.element,this.style=H.element.style,this._init(H)},C.Overlay.prototype={_init:function(b){this.location=b.location,this.placement=void 0===b.placement?C.Placement.TOP_LEFT:b.placement,this.onDraw=b.onDraw,this.checkResize=void 0===b.checkResize||b.checkResize,this.width=void 0===b.width?null:b.width,this.height=void 0===b.height?null:b.height,this.rotationMode=b.rotationMode||C.OverlayRotationMode.EXACT,this.location instanceof C.Rect&&(this.width=this.location.width,this.height=this.location.height,this.location=this.location.getTopLeft(),this.placement=C.Placement.TOP_LEFT),this.scales=null!==this.width&&null!==this.height,this.bounds=new C.Rect(this.location.x,this.location.y,this.width,this.height),this.position=this.location},adjust:function(b,D){var F=C.Placement.properties[this.placement];!F||(F.isHorizontallyCentered?b.x-=D.x/2:F.isRight&&(b.x-=D.x),F.isVerticallyCentered?b.y-=D.y/2:F.isBottom&&(b.y-=D.y))},destroy:function(){var b=this.element,D=this.style;b.parentNode&&(b.parentNode.removeChild(b),b.prevElementParent&&(D.display="none",document.body.appendChild(b))),this.onDraw=null,D.top="",D.left="",D.position="",null!==this.width&&(D.width=""),null!==this.height&&(D.height="");var F=C.getCssPropertyWithVendorPrefix("transformOrigin"),H=C.getCssPropertyWithVendorPrefix("transform");F&&H&&(D[F]="",D[H]="")},drawHTML:function(b,D){var F=this.element;F.parentNode!==b&&(F.prevElementParent=F.parentNode,F.prevNextSibling=F.nextSibling,b.appendChild(F),this.style.position="absolute",this.size=C.getElementSize(F));var H=this._getOverlayPositionAndSize(D),z=H.position,V=this.size=H.size,W=H.rotate;if(this.onDraw)this.onDraw(z,V,this.element);else{var te=this.style;te.left=z.x+"px",te.top=z.y+"px",null!==this.width&&(te.width=V.x+"px"),null!==this.height&&(te.height=V.y+"px");var Q=C.getCssPropertyWithVendorPrefix("transformOrigin"),he=C.getCssPropertyWithVendorPrefix("transform");Q&&he&&(W?(te[Q]=this._getTransformOrigin(),te[he]="rotate("+W+"deg)"):(te[Q]="",te[he]="")),"none"!==te.display&&(te.display="block")}},_getOverlayPositionAndSize:function(b){var D=b.pixelFromPoint(this.location,!0),F=this._getSizeInPixels(b);this.adjust(D,F);var H=0;if(b.degrees&&this.rotationMode!==C.OverlayRotationMode.NO_ROTATION)if(this.rotationMode===C.OverlayRotationMode.BOUNDING_BOX&&null!==this.width&&null!==this.height){var z=new C.Rect(D.x,D.y,F.x,F.y),V=this._getBoundingBox(z,b.degrees);D=V.getTopLeft(),F=V.getSize()}else H=b.degrees;return{position:D,size:F,rotate:H}},_getSizeInPixels:function(b){var D=this.size.x,F=this.size.y;if(null!==this.width||null!==this.height){var H=b.deltaPixelsFromPointsNoRotate(new C.Point(this.width||0,this.height||0),!0);null!==this.width&&(D=H.x),null!==this.height&&(F=H.y)}if(this.checkResize&&(null===this.width||null===this.height)){var z=this.size=C.getElementSize(this.element);null===this.width&&(D=z.x),null===this.height&&(F=z.y)}return new C.Point(D,F)},_getBoundingBox:function(b,D){var F=this._getPlacementPoint(b);return b.rotate(D,F).getBoundingBox()},_getPlacementPoint:function(b){var D=new C.Point(b.x,b.y),F=C.Placement.properties[this.placement];return F&&(F.isHorizontallyCentered?D.x+=b.width/2:F.isRight&&(D.x+=b.width),F.isVerticallyCentered?D.y+=b.height/2:F.isBottom&&(D.y+=b.height)),D},_getTransformOrigin:function(){var b="",D=C.Placement.properties[this.placement];return D&&(D.isLeft?b="left":D.isRight&&(b="right"),D.isTop?b+=" top":D.isBottom&&(b+=" bottom")),b},update:function(b,D){var F=C.isPlainObject(b)?b:{location:b,placement:D};this._init({location:F.location||this.location,placement:void 0!==F.placement?F.placement:this.placement,onDraw:F.onDraw||this.onDraw,checkResize:F.checkResize||this.checkResize,width:void 0!==F.width?F.width:this.width,height:void 0!==F.height?F.height:this.height,rotationMode:F.rotationMode||this.rotationMode})},getBounds:function(b){C.console.assert(b,"A viewport must now be passed to Overlay.getBounds.");var D=this.width,F=this.height;if(null===D||null===F){var H=b.deltaPointsFromPixelsNoRotate(this.size,!0);null===D&&(D=H.x),null===F&&(F=H.y)}var z=this.location.clone();return this.adjust(z,new C.Point(D,F)),this._adjustBoundsForRotation(b,new C.Rect(z.x,z.y,D,F))},_adjustBoundsForRotation:function(b,D){if(!b||0===b.degrees||this.rotationMode===C.OverlayRotationMode.EXACT)return D;if(this.rotationMode===C.OverlayRotationMode.BOUNDING_BOX){if(null===this.width||null===this.height)return D;var F=this._getOverlayPositionAndSize(b);return b.viewerElementToViewportRectangle(new C.Rect(F.position.x,F.position.y,F.size.x,F.size.y))}return D.rotate(-b.degrees,this._getPlacementPoint(D))}}}(OpenSeadragon),function(C){C.Drawer=function(b){C.console.assert(b.viewer,"[Drawer] options.viewer is required");var D=arguments;if(C.isPlainObject(b)||(b={source:D[0],viewport:D[1],element:D[2]}),C.console.assert(b.viewport,"[Drawer] options.viewport is required"),C.console.assert(b.element,"[Drawer] options.element is required"),b.source&&C.console.error("[Drawer] options.source is no longer accepted; use TiledImage instead"),this.viewer=b.viewer,this.viewport=b.viewport,this.debugGridColor="string"==typeof b.debugGridColor?[b.debugGridColor]:b.debugGridColor||C.DEFAULT_SETTINGS.debugGridColor,b.opacity&&C.console.error("[Drawer] options.opacity is no longer accepted; set the opacity on the TiledImage instead"),this.useCanvas=C.supportsCanvas&&(!this.viewer||this.viewer.useCanvas),this.container=C.getElement(b.element),this.canvas=C.makeNeutralElement(this.useCanvas?"canvas":"div"),this.context=this.useCanvas?this.canvas.getContext("2d"):null,this.sketchCanvas=null,this.sketchContext=null,this.element=this.container,this.container.dir="ltr",this.useCanvas){var F=this._calculateCanvasSize();this.canvas.width=F.x,this.canvas.height=F.y}this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.position="absolute",C.setElementOpacity(this.canvas,this.opacity,!0),this.container.style.textAlign="left",this.container.appendChild(this.canvas),this._imageSmoothingEnabled=!0},C.Drawer.prototype={addOverlay:function(b,D,F,H){return C.console.error("drawer.addOverlay is deprecated. Use viewer.addOverlay instead."),this.viewer.addOverlay(b,D,F,H),this},updateOverlay:function(b,D,F){return C.console.error("drawer.updateOverlay is deprecated. Use viewer.updateOverlay instead."),this.viewer.updateOverlay(b,D,F),this},removeOverlay:function(b){return C.console.error("drawer.removeOverlay is deprecated. Use viewer.removeOverlay instead."),this.viewer.removeOverlay(b),this},clearOverlays:function(){return C.console.error("drawer.clearOverlays is deprecated. Use viewer.clearOverlays instead."),this.viewer.clearOverlays(),this},viewportCoordToDrawerCoord:function(b){var D=this.viewport.pixelFromPointNoRotate(b,!0);return new C.Point(D.x*C.pixelDensityRatio,D.y*C.pixelDensityRatio)},clipWithPolygons:function(b,D){if(this.useCanvas){var F=this._getContext(D);F.beginPath(),b.forEach(function(H){H.forEach(function(z,V){F[0===V?"moveTo":"lineTo"](z.x,z.y)})}),F.clip()}},setOpacity:function(b){C.console.error("drawer.setOpacity is deprecated. Use tiledImage.setOpacity instead.");for(var D=this.viewer.world,F=0;F<D.getItemCount();F++)D.getItemAt(F).setOpacity(b);return this},getOpacity:function(){C.console.error("drawer.getOpacity is deprecated. Use tiledImage.getOpacity instead.");for(var b=this.viewer.world,D=0,F=0;F<b.getItemCount();F++){var H=b.getItemAt(F).getOpacity();H>D&&(D=H)}return D},needsUpdate:function(){return C.console.error("[Drawer.needsUpdate] this function is deprecated. Use World.needsDraw instead."),this.viewer.world.needsDraw()},numTilesLoaded:function(){return C.console.error("[Drawer.numTilesLoaded] this function is deprecated. Use TileCache.numTilesLoaded instead."),this.viewer.tileCache.numTilesLoaded()},reset:function(){return C.console.error("[Drawer.reset] this function is deprecated. Use World.resetItems instead."),this.viewer.world.resetItems(),this},update:function(){return C.console.error("[Drawer.update] this function is deprecated. Use Drawer.clear and World.draw instead."),this.clear(),this.viewer.world.draw(),this},canRotate:function(){return this.useCanvas},destroy:function(){this.canvas.width=1,this.canvas.height=1,this.sketchCanvas=null,this.sketchContext=null},clear:function(){if(this.canvas.innerHTML="",this.useCanvas){var b=this._calculateCanvasSize();if((this.canvas.width!=b.x||this.canvas.height!=b.y)&&(this.canvas.width=b.x,this.canvas.height=b.y,this._updateImageSmoothingEnabled(this.context),null!==this.sketchCanvas)){var D=this._calculateSketchCanvasSize();this.sketchCanvas.width=D.x,this.sketchCanvas.height=D.y,this._updateImageSmoothingEnabled(this.sketchContext)}this._clear()}},_clear:function(b,D){if(this.useCanvas){var F=this._getContext(b);if(D)F.clearRect(D.x,D.y,D.width,D.height);else{var H=F.canvas;F.clearRect(0,0,H.width,H.height)}}},viewportToDrawerRectangle:function(b){var D=this.viewport.pixelFromPointNoRotate(b.getTopLeft(),!0),F=this.viewport.deltaPixelsFromPointsNoRotate(b.getSize(),!0);return new C.Rect(D.x*C.pixelDensityRatio,D.y*C.pixelDensityRatio,F.x*C.pixelDensityRatio,F.y*C.pixelDensityRatio)},drawTile:function(b,D,F,H,z){if(C.console.assert(b,"[Drawer.drawTile] tile is required"),C.console.assert(D,"[Drawer.drawTile] drawingHandler is required"),this.useCanvas){var V=this._getContext(F);b.drawCanvas(V,D,H=H||1,z)}else b.drawHTML(this.canvas)},_getContext:function(b){var D=this.context;if(b){if(null===this.sketchCanvas){this.sketchCanvas=document.createElement("canvas");var F=this._calculateSketchCanvasSize();if(this.sketchCanvas.width=F.x,this.sketchCanvas.height=F.y,this.sketchContext=this.sketchCanvas.getContext("2d"),0===this.viewport.getRotation()){var H=this;this.viewer.addHandler("rotate",function z(){if(0!==H.viewport.getRotation()){H.viewer.removeHandler("rotate",z);var V=H._calculateSketchCanvasSize();H.sketchCanvas.width=V.x,H.sketchCanvas.height=V.y}})}this._updateImageSmoothingEnabled(this.sketchContext)}D=this.sketchContext}return D},saveContext:function(b){!this.useCanvas||this._getContext(b).save()},restoreContext:function(b){!this.useCanvas||this._getContext(b).restore()},setClip:function(b,D){if(this.useCanvas){var F=this._getContext(D);F.beginPath(),F.rect(b.x,b.y,b.width,b.height),F.clip()}},drawRectangle:function(b,D,F){if(this.useCanvas){var H=this._getContext(F);H.save(),H.fillStyle=D,H.fillRect(b.x,b.y,b.width,b.height),H.restore()}},blendSketch:function(b,D,F,H){var z=b;if(C.isPlainObject(z)||(z={opacity:b,scale:D,translate:F,compositeOperation:H}),this.useCanvas&&this.sketchCanvas){b=z.opacity,H=z.compositeOperation;var V=z.bounds;if(this.context.save(),this.context.globalAlpha=b,H&&(this.context.globalCompositeOperation=H),V)V.x<0&&(V.width+=V.x,V.x=0),V.x+V.width>this.canvas.width&&(V.width=this.canvas.width-V.x),V.y<0&&(V.height+=V.y,V.y=0),V.y+V.height>this.canvas.height&&(V.height=this.canvas.height-V.y),this.context.drawImage(this.sketchCanvas,V.x,V.y,V.width,V.height,V.x,V.y,V.width,V.height);else{D=z.scale||1;var W=(F=z.translate)instanceof C.Point?F:new C.Point(0,0),te=0,Q=0;if(F){var be=this.sketchCanvas.height-this.canvas.height;te=Math.round((this.sketchCanvas.width-this.canvas.width)/2),Q=Math.round(be/2)}this.context.drawImage(this.sketchCanvas,W.x-te*D,W.y-Q*D,(this.canvas.width+2*te)*D,(this.canvas.height+2*Q)*D,-te,-Q,this.canvas.width+2*te,this.canvas.height+2*Q)}this.context.restore()}},drawDebugInfo:function(b,D,F,H){if(this.useCanvas){var z=this.viewer.world.getIndexOfItem(H)%this.debugGridColor.length,V=this.context;V.save(),V.lineWidth=2*C.pixelDensityRatio,V.font="small-caps bold "+13*C.pixelDensityRatio+"px arial",V.strokeStyle=this.debugGridColor[z],V.fillStyle=this.debugGridColor[z],0!==this.viewport.degrees&&this._offsetForRotation({degrees:this.viewport.degrees}),H.getRotation(!0)%360!=0&&this._offsetForRotation({degrees:H.getRotation(!0),point:H.viewport.pixelFromPointNoRotate(H._getRotationPoint(!0),!0)}),0===H.viewport.degrees&&H.getRotation(!0)%360==0&&H._drawer.viewer.viewport.getFlip()&&H._drawer._flip(),V.strokeRect(b.position.x*C.pixelDensityRatio,b.position.y*C.pixelDensityRatio,b.size.x*C.pixelDensityRatio,b.size.y*C.pixelDensityRatio);var W=(b.position.x+b.size.x/2)*C.pixelDensityRatio,te=(b.position.y+b.size.y/2)*C.pixelDensityRatio;V.translate(W,te),V.rotate(Math.PI/180*-this.viewport.degrees),V.translate(-W,-te),0===b.x&&0===b.y&&(V.fillText("Zoom: "+this.viewport.getZoom(),b.position.x*C.pixelDensityRatio,(b.position.y-30)*C.pixelDensityRatio),V.fillText("Pan: "+this.viewport.getBounds().toString(),b.position.x*C.pixelDensityRatio,(b.position.y-20)*C.pixelDensityRatio)),V.fillText("Level: "+b.level,(b.position.x+10)*C.pixelDensityRatio,(b.position.y+20)*C.pixelDensityRatio),V.fillText("Column: "+b.x,(b.position.x+10)*C.pixelDensityRatio,(b.position.y+30)*C.pixelDensityRatio),V.fillText("Row: "+b.y,(b.position.x+10)*C.pixelDensityRatio,(b.position.y+40)*C.pixelDensityRatio),V.fillText("Order: "+F+" of "+D,(b.position.x+10)*C.pixelDensityRatio,(b.position.y+50)*C.pixelDensityRatio),V.fillText("Size: "+b.size.toString(),(b.position.x+10)*C.pixelDensityRatio,(b.position.y+60)*C.pixelDensityRatio),V.fillText("Position: "+b.position.toString(),(b.position.x+10)*C.pixelDensityRatio,(b.position.y+70)*C.pixelDensityRatio),0!==this.viewport.degrees&&this._restoreRotationChanges(),H.getRotation(!0)%360!=0&&this._restoreRotationChanges(),0===H.viewport.degrees&&H.getRotation(!0)%360==0&&H._drawer.viewer.viewport.getFlip()&&H._drawer._flip(),V.restore()}},debugRect:function(b){if(this.useCanvas){var D=this.context;D.save(),D.lineWidth=2*C.pixelDensityRatio,D.strokeStyle=this.debugGridColor[0],D.fillStyle=this.debugGridColor[0],D.strokeRect(b.x*C.pixelDensityRatio,b.y*C.pixelDensityRatio,b.width*C.pixelDensityRatio,b.height*C.pixelDensityRatio),D.restore()}},setImageSmoothingEnabled:function(b){this.useCanvas&&(this._imageSmoothingEnabled=b,this._updateImageSmoothingEnabled(this.context),this.viewer.forceRedraw())},_updateImageSmoothingEnabled:function(b){b.msImageSmoothingEnabled=this._imageSmoothingEnabled,b.imageSmoothingEnabled=this._imageSmoothingEnabled},getCanvasSize:function(b){var D=this._getContext(b).canvas;return new C.Point(D.width,D.height)},getCanvasCenter:function(){return new C.Point(this.canvas.width/2,this.canvas.height/2)},_offsetForRotation:function(b){var D=b.point?b.point.times(C.pixelDensityRatio):this.getCanvasCenter(),F=this._getContext(b.useSketch);F.save(),F.translate(D.x,D.y),this.viewer.viewport.flipped?(F.rotate(Math.PI/180*-b.degrees),F.scale(-1,1)):F.rotate(Math.PI/180*b.degrees),F.translate(-D.x,-D.y)},_flip:function(b){var D=(b=b||{}).point?b.point.times(C.pixelDensityRatio):this.getCanvasCenter(),F=this._getContext(b.useSketch);F.translate(D.x,0),F.scale(-1,1),F.translate(-D.x,0)},_restoreRotationChanges:function(b){this._getContext(b).restore()},_calculateCanvasSize:function(){var b=C.pixelDensityRatio,D=this.viewport.getContainerSize();return{x:Math.round(D.x*b),y:Math.round(D.y*b)}},_calculateSketchCanvasSize:function(){var b=this._calculateCanvasSize();if(0===this.viewport.getRotation())return b;var D=Math.ceil(Math.sqrt(b.x*b.x+b.y*b.y));return{x:D,y:D}}}}(OpenSeadragon),function(C){C.Viewport=function(b){var D=arguments;D.length&&D[0]instanceof C.Point&&(b={containerSize:D[0],contentSize:D[1],config:D[2]}),b.config&&(C.extend(!0,b,b.config),delete b.config),this._margins=C.extend({left:0,top:0,right:0,bottom:0},b.margins||{}),delete b.margins,C.extend(!0,this,{containerSize:null,contentSize:null,zoomPoint:null,viewer:null,springStiffness:C.DEFAULT_SETTINGS.springStiffness,animationTime:C.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:C.DEFAULT_SETTINGS.minZoomImageRatio,maxZoomPixelRatio:C.DEFAULT_SETTINGS.maxZoomPixelRatio,visibilityRatio:C.DEFAULT_SETTINGS.visibilityRatio,wrapHorizontal:C.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:C.DEFAULT_SETTINGS.wrapVertical,defaultZoomLevel:C.DEFAULT_SETTINGS.defaultZoomLevel,minZoomLevel:C.DEFAULT_SETTINGS.minZoomLevel,maxZoomLevel:C.DEFAULT_SETTINGS.maxZoomLevel,degrees:C.DEFAULT_SETTINGS.degrees,flipped:C.DEFAULT_SETTINGS.flipped,homeFillsViewer:C.DEFAULT_SETTINGS.homeFillsViewer},b),this._updateContainerInnerSize(),this.centerSpringX=new C.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.centerSpringY=new C.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.zoomSpring=new C.Spring({exponential:!0,initial:1,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._oldCenterX=this.centerSpringX.current.value,this._oldCenterY=this.centerSpringY.current.value,this._oldZoom=this.zoomSpring.current.value,this._setContentBounds(new C.Rect(0,0,1,1),1),this.goHome(!0),this.update()},C.Viewport.prototype={resetContentSize:function(b){return C.console.assert(b,"[Viewport.resetContentSize] contentSize is required"),C.console.assert(b instanceof C.Point,"[Viewport.resetContentSize] contentSize must be an OpenSeadragon.Point"),C.console.assert(b.x>0,"[Viewport.resetContentSize] contentSize.x must be greater than 0"),C.console.assert(b.y>0,"[Viewport.resetContentSize] contentSize.y must be greater than 0"),this._setContentBounds(new C.Rect(0,0,1,b.y/b.x),b.x),this},setHomeBounds:function(b,D){C.console.error("[Viewport.setHomeBounds] this function is deprecated; The content bounds should not be set manually."),this._setContentBounds(b,D)},_setContentBounds:function(b,D){C.console.assert(b,"[Viewport._setContentBounds] bounds is required"),C.console.assert(b instanceof C.Rect,"[Viewport._setContentBounds] bounds must be an OpenSeadragon.Rect"),C.console.assert(b.width>0,"[Viewport._setContentBounds] bounds.width must be greater than 0"),C.console.assert(b.height>0,"[Viewport._setContentBounds] bounds.height must be greater than 0"),this._contentBoundsNoRotate=b.clone(),this._contentSizeNoRotate=this._contentBoundsNoRotate.getSize().times(D),this._contentBounds=b.rotate(this.degrees).getBoundingBox(),this._contentSize=this._contentBounds.getSize().times(D),this._contentAspectRatio=this._contentSize.x/this._contentSize.y,this.viewer&&this.viewer.raiseEvent("reset-size",{contentSize:this._contentSizeNoRotate.clone(),contentFactor:D,homeBounds:this._contentBoundsNoRotate.clone(),contentBounds:this._contentBounds.clone()})},getHomeZoom:function(){if(this.defaultZoomLevel)return this.defaultZoomLevel;var b=this._contentAspectRatio/this.getAspectRatio();return(this.homeFillsViewer?b>=1?b:1:b>=1?1:b)/this._contentBounds.width},getHomeBounds:function(){return this.getHomeBoundsNoRotate().rotate(-this.getRotation())},getHomeBoundsNoRotate:function(){var b=this._contentBounds.getCenter(),D=1/this.getHomeZoom(),F=D/this.getAspectRatio();return new C.Rect(b.x-D/2,b.y-F/2,D,F)},goHome:function(b){return this.viewer&&this.viewer.raiseEvent("home",{immediately:b}),this.fitBounds(this.getHomeBounds(),b)},getMinZoom:function(){var b=this.getHomeZoom();return this.minZoomLevel?this.minZoomLevel:this.minZoomImageRatio*b},getMaxZoom:function(){var b=this.maxZoomLevel;return b||(b=this._contentSize.x*this.maxZoomPixelRatio/this._containerInnerSize.x,b/=this._contentBounds.width),Math.max(b,this.getHomeZoom())},getAspectRatio:function(){return this._containerInnerSize.x/this._containerInnerSize.y},getContainerSize:function(){return new C.Point(this.containerSize.x,this.containerSize.y)},getMargins:function(){return C.extend({},this._margins)},setMargins:function(b){C.console.assert("object"===C.type(b),"[Viewport.setMargins] margins must be an object"),this._margins=C.extend({left:0,top:0,right:0,bottom:0},b),this._updateContainerInnerSize(),this.viewer&&this.viewer.forceRedraw()},getBounds:function(b){return this.getBoundsNoRotate(b).rotate(-this.getRotation())},getBoundsNoRotate:function(b){var D=this.getCenter(b),F=1/this.getZoom(b),H=F/this.getAspectRatio();return new C.Rect(D.x-F/2,D.y-H/2,F,H)},getBoundsWithMargins:function(b){return this.getBoundsNoRotateWithMargins(b).rotate(-this.getRotation(),this.getCenter(b))},getBoundsNoRotateWithMargins:function(b){var D=this.getBoundsNoRotate(b),F=this._containerInnerSize.x*this.getZoom(b);return D.x-=this._margins.left/F,D.y-=this._margins.top/F,D.width+=(this._margins.left+this._margins.right)/F,D.height+=(this._margins.top+this._margins.bottom)/F,D},getCenter:function(b){var H,z,V,W,te,be,D=new C.Point(this.centerSpringX.current.value,this.centerSpringY.current.value),F=new C.Point(this.centerSpringX.target.value,this.centerSpringY.target.value);return b?D:this.zoomPoint?(H=this.pixelFromPoint(this.zoomPoint,!0),W=(V=1/(z=this.getZoom()))/this.getAspectRatio(),te=new C.Rect(D.x-V/2,D.y-W/2,V,W),be=this._pixelFromPoint(this.zoomPoint,te).minus(H).divide(this._containerInnerSize.x*z),F.plus(be)):F},getZoom:function(b){return b?this.zoomSpring.current.value:this.zoomSpring.target.value},_applyZoomConstraints:function(b){return Math.max(Math.min(b,this.getMaxZoom()),this.getMinZoom())},_applyBoundaryConstraints:function(b){var D=new C.Rect(b.x,b.y,b.width,b.height);if(!this.wrapHorizontal){var F=this.visibilityRatio*D.width,V=this._contentBoundsNoRotate.x-(D.x+D.width)+F,W=this._contentBoundsNoRotate.x+this._contentBoundsNoRotate.width-D.x-F;F>this._contentBoundsNoRotate.width?D.x+=(V+W)/2:W<0?D.x+=W:V>0&&(D.x+=V)}if(!this.wrapVertical){var te=this.visibilityRatio*D.height,be=this._contentBoundsNoRotate.y-(D.y+D.height)+te,ae=this._contentBoundsNoRotate.y+this._contentBoundsNoRotate.height-D.y-te;te>this._contentBoundsNoRotate.height?D.y+=(be+ae)/2:ae<0?D.y+=ae:be>0&&(D.y+=be)}return D},_raiseConstraintsEvent:function(b){this.viewer&&this.viewer.raiseEvent("constrain",{immediately:b})},applyConstraints:function(b){var D=this.getZoom(),F=this._applyZoomConstraints(D);D!==F&&this.zoomTo(F,this.zoomPoint,b);var H=this.getBoundsNoRotate(),z=this._applyBoundaryConstraints(H);return this._raiseConstraintsEvent(b),(H.x!==z.x||H.y!==z.y||b)&&this.fitBounds(z.rotate(-this.getRotation()),b),this},ensureVisible:function(b){return this.applyConstraints(b)},_fitBounds:function(b,D){var F=(D=D||{}).immediately||!1,H=D.constraints||!1,z=this.getAspectRatio(),V=b.getCenter(),W=new C.Rect(b.x,b.y,b.width,b.height,b.degrees+this.getRotation()).getBoundingBox();W.getAspectRatio()>=z?W.height=W.width/z:W.width=W.height*z,W.x=V.x-W.width/2,W.y=V.y-W.height/2;var te=1/W.width;if(H){var Q=W.getAspectRatio(),he=this._applyZoomConstraints(te);te!==he&&(W.width=1/(te=he),W.x=V.x-W.width/2,W.height=W.width/Q,W.y=V.y-W.height/2),V=(W=this._applyBoundaryConstraints(W)).getCenter(),this._raiseConstraintsEvent(F)}if(F)return this.panTo(V,!0),this.zoomTo(te,null,!0);this.panTo(this.getCenter(!0),!0),this.zoomTo(this.getZoom(!0),null,!0);var be=this.getBounds(),ae=this.getZoom();if(0===ae||Math.abs(te/ae-1)<1e-8)return this.zoomTo(te,!0),this.panTo(V,F);var Te=(W=W.rotate(-this.getRotation())).getTopLeft().times(te).minus(be.getTopLeft().times(ae)).divide(te-ae);return this.zoomTo(te,Te,F)},fitBounds:function(b,D){return this._fitBounds(b,{immediately:D,constraints:!1})},fitBoundsWithConstraints:function(b,D){return this._fitBounds(b,{immediately:D,constraints:!0})},fitVertically:function(b){var D=new C.Rect(this._contentBounds.x+this._contentBounds.width/2,this._contentBounds.y,0,this._contentBounds.height);return this.fitBounds(D,b)},fitHorizontally:function(b){var D=new C.Rect(this._contentBounds.x,this._contentBounds.y+this._contentBounds.height/2,this._contentBounds.width,0);return this.fitBounds(D,b)},getConstrainedBounds:function(b){var D;return D=this.getBounds(b),this._applyBoundaryConstraints(D)},panBy:function(b,D){var F=new C.Point(this.centerSpringX.target.value,this.centerSpringY.target.value);return this.panTo(F.plus(b),D)},panTo:function(b,D){return D?(this.centerSpringX.resetTo(b.x),this.centerSpringY.resetTo(b.y)):(this.centerSpringX.springTo(b.x),this.centerSpringY.springTo(b.y)),this.viewer&&this.viewer.raiseEvent("pan",{center:b,immediately:D}),this},zoomBy:function(b,D,F){return this.zoomTo(this.zoomSpring.target.value*b,D,F)},zoomTo:function(b,D,F){var H=this;return this.zoomPoint=D instanceof C.Point&&!isNaN(D.x)&&!isNaN(D.y)?D:null,F?this._adjustCenterSpringsForZoomPoint(function(){H.zoomSpring.resetTo(b)}):this.zoomSpring.springTo(b),this.viewer&&this.viewer.raiseEvent("zoom",{zoom:b,refPoint:D,immediately:F}),this},setRotation:function(b){return this.viewer&&this.viewer.drawer.canRotate()?(this.degrees=C.positiveModulo(b,360),this._setContentBounds(this.viewer.world.getHomeBounds(),this.viewer.world.getContentFactor()),this.viewer.forceRedraw(),this.viewer.raiseEvent("rotate",{degrees:b}),this):this},getRotation:function(){return this.degrees},resize:function(b,D){var F=this.getBoundsNoRotate(),H=F;return this.containerSize.x=b.x,this.containerSize.y=b.y,this._updateContainerInnerSize(),D&&(H.width=F.width*(b.x/this.containerSize.x),H.height=H.width/this.getAspectRatio()),this.viewer&&this.viewer.raiseEvent("resize",{newContainerSize:b,maintain:D}),this.fitBounds(H,!0)},_updateContainerInnerSize:function(){this._containerInnerSize=new C.Point(Math.max(1,this.containerSize.x-(this._margins.left+this._margins.right)),Math.max(1,this.containerSize.y-(this._margins.top+this._margins.bottom)))},update:function(){var b=this;this._adjustCenterSpringsForZoomPoint(function(){b.zoomSpring.update()}),this.centerSpringX.update(),this.centerSpringY.update();var D=this.centerSpringX.current.value!==this._oldCenterX||this.centerSpringY.current.value!==this._oldCenterY||this.zoomSpring.current.value!==this._oldZoom;return this._oldCenterX=this.centerSpringX.current.value,this._oldCenterY=this.centerSpringY.current.value,this._oldZoom=this.zoomSpring.current.value,D},_adjustCenterSpringsForZoomPoint:function(b){if(this.zoomPoint){var D=this.pixelFromPoint(this.zoomPoint,!0);b();var H=this.pixelFromPoint(this.zoomPoint,!0).minus(D),z=this.deltaPointsFromPixels(H,!0);this.centerSpringX.shiftBy(z.x),this.centerSpringY.shiftBy(z.y),this.zoomSpring.isAtTargetValue()&&(this.zoomPoint=null)}else b()},deltaPixelsFromPointsNoRotate:function(b,D){return b.times(this._containerInnerSize.x*this.getZoom(D))},deltaPixelsFromPoints:function(b,D){return this.deltaPixelsFromPointsNoRotate(b.rotate(this.getRotation()),D)},deltaPointsFromPixelsNoRotate:function(b,D){return b.divide(this._containerInnerSize.x*this.getZoom(D))},deltaPointsFromPixels:function(b,D){return this.deltaPointsFromPixelsNoRotate(b,D).rotate(-this.getRotation())},pixelFromPointNoRotate:function(b,D){return this._pixelFromPointNoRotate(b,this.getBoundsNoRotate(D))},pixelFromPoint:function(b,D){return this._pixelFromPoint(b,this.getBoundsNoRotate(D))},_pixelFromPointNoRotate:function(b,D){return b.minus(D.getTopLeft()).times(this._containerInnerSize.x/D.width).plus(new C.Point(this._margins.left,this._margins.top))},_pixelFromPoint:function(b,D){return this._pixelFromPointNoRotate(b.rotate(this.getRotation(),this.getCenter(!0)),D)},pointFromPixelNoRotate:function(b,D){var F=this.getBoundsNoRotate(D);return b.minus(new C.Point(this._margins.left,this._margins.top)).divide(this._containerInnerSize.x/F.width).plus(F.getTopLeft())},pointFromPixel:function(b,D){return this.pointFromPixelNoRotate(b,D).rotate(-this.getRotation(),this.getCenter(!0))},_viewportToImageDelta:function(b,D){var F=this._contentBoundsNoRotate.width;return new C.Point(b*this._contentSizeNoRotate.x/F,D*this._contentSizeNoRotate.x/F)},viewportToImageCoordinates:function(b,D){if(b instanceof C.Point)return this.viewportToImageCoordinates(b.x,b.y);if(this.viewer){var F=this.viewer.world.getItemCount();if(F>1)C.console.error("[Viewport.viewportToImageCoordinates] is not accurate with multi-image; use TiledImage.viewportToImageCoordinates instead.");else if(1===F)return this.viewer.world.getItemAt(0).viewportToImageCoordinates(b,D,!0)}return this._viewportToImageDelta(b-this._contentBoundsNoRotate.x,D-this._contentBoundsNoRotate.y)},_imageToViewportDelta:function(b,D){var F=this._contentBoundsNoRotate.width;return new C.Point(b/this._contentSizeNoRotate.x*F,D/this._contentSizeNoRotate.x*F)},imageToViewportCoordinates:function(b,D){if(b instanceof C.Point)return this.imageToViewportCoordinates(b.x,b.y);if(this.viewer){var F=this.viewer.world.getItemCount();if(F>1)C.console.error("[Viewport.imageToViewportCoordinates] is not accurate with multi-image; use TiledImage.imageToViewportCoordinates instead.");else if(1===F)return this.viewer.world.getItemAt(0).imageToViewportCoordinates(b,D,!0)}var z=this._imageToViewportDelta(b,D);return z.x+=this._contentBoundsNoRotate.x,z.y+=this._contentBoundsNoRotate.y,z},imageToViewportRectangle:function(b,D,F,H){var z=b;if(z instanceof C.Rect||(z=new C.Rect(b,D,F,H)),this.viewer){var V=this.viewer.world.getItemCount();if(V>1)C.console.error("[Viewport.imageToViewportRectangle] is not accurate with multi-image; use TiledImage.imageToViewportRectangle instead.");else if(1===V)return this.viewer.world.getItemAt(0).imageToViewportRectangle(b,D,F,H,!0)}var te=this.imageToViewportCoordinates(z.x,z.y),Q=this._imageToViewportDelta(z.width,z.height);return new C.Rect(te.x,te.y,Q.x,Q.y,z.degrees)},viewportToImageRectangle:function(b,D,F,H){var z=b;if(z instanceof C.Rect||(z=new C.Rect(b,D,F,H)),this.viewer){var V=this.viewer.world.getItemCount();if(V>1)C.console.error("[Viewport.viewportToImageRectangle] is not accurate with multi-image; use TiledImage.viewportToImageRectangle instead.");else if(1===V)return this.viewer.world.getItemAt(0).viewportToImageRectangle(b,D,F,H,!0)}var te=this.viewportToImageCoordinates(z.x,z.y),Q=this._viewportToImageDelta(z.width,z.height);return new C.Rect(te.x,te.y,Q.x,Q.y,z.degrees)},viewerElementToImageCoordinates:function(b){var D=this.pointFromPixel(b,!0);return this.viewportToImageCoordinates(D)},imageToViewerElementCoordinates:function(b){var D=this.imageToViewportCoordinates(b);return this.pixelFromPoint(D,!0)},windowToImageCoordinates:function(b){C.console.assert(this.viewer,"[Viewport.windowToImageCoordinates] the viewport must have a viewer.");var D=b.minus(C.getElementPosition(this.viewer.element));return this.viewerElementToImageCoordinates(D)},imageToWindowCoordinates:function(b){return C.console.assert(this.viewer,"[Viewport.imageToWindowCoordinates] the viewport must have a viewer."),this.imageToViewerElementCoordinates(b).plus(C.getElementPosition(this.viewer.element))},viewerElementToViewportCoordinates:function(b){return this.pointFromPixel(b,!0)},viewportToViewerElementCoordinates:function(b){return this.pixelFromPoint(b,!0)},viewerElementToViewportRectangle:function(b){return C.Rect.fromSummits(this.pointFromPixel(b.getTopLeft(),!0),this.pointFromPixel(b.getTopRight(),!0),this.pointFromPixel(b.getBottomLeft(),!0))},viewportToViewerElementRectangle:function(b){return C.Rect.fromSummits(this.pixelFromPoint(b.getTopLeft(),!0),this.pixelFromPoint(b.getTopRight(),!0),this.pixelFromPoint(b.getBottomLeft(),!0))},windowToViewportCoordinates:function(b){C.console.assert(this.viewer,"[Viewport.windowToViewportCoordinates] the viewport must have a viewer.");var D=b.minus(C.getElementPosition(this.viewer.element));return this.viewerElementToViewportCoordinates(D)},viewportToWindowCoordinates:function(b){return C.console.assert(this.viewer,"[Viewport.viewportToWindowCoordinates] the viewport must have a viewer."),this.viewportToViewerElementCoordinates(b).plus(C.getElementPosition(this.viewer.element))},viewportToImageZoom:function(b){if(this.viewer){var D=this.viewer.world.getItemCount();if(D>1)C.console.error("[Viewport.viewportToImageZoom] is not accurate with multi-image.");else if(1===D)return this.viewer.world.getItemAt(0).viewportToImageZoom(b)}return b*(this._containerInnerSize.x/this._contentSizeNoRotate.x*this._contentBoundsNoRotate.width)},imageToViewportZoom:function(b){if(this.viewer){var D=this.viewer.world.getItemCount();if(D>1)C.console.error("[Viewport.imageToViewportZoom] is not accurate with multi-image.");else if(1===D)return this.viewer.world.getItemAt(0).imageToViewportZoom(b)}return b*(this._contentSizeNoRotate.x/this._containerInnerSize.x/this._contentBoundsNoRotate.width)},toggleFlip:function(){return this.setFlip(!this.getFlip()),this},getFlip:function(){return this.flipped},setFlip:function(b){return this.flipped===b||(this.flipped=b,this.viewer.navigator&&this.viewer.navigator.setFlip(this.getFlip()),this.viewer.forceRedraw(),this.viewer.raiseEvent("flip",{flipped:b})),this}}}(OpenSeadragon),function(C){function b(G,de,we,Fe,Le,it,at,Dt,dt){var Kt=at.getBoundingBox().getTopLeft(),oi=at.getBoundingBox().getBottomRight();G.viewer&&G.viewer.raiseEvent("update-level",{tiledImage:G,havedrawn:de,level:Fe,opacity:Le,visibility:it,drawArea:at,topleft:Kt,bottomright:oi,currenttime:Dt,best:dt}),ae(G.coverage,Fe),ae(G.loadingCoverage,Fe);for(var We=G._getCornerTiles(Fe,Kt,oi),xt=We.topLeft,_e=We.bottomRight,Lt=G.source.getNumTiles(Fe),$i=G.viewport.pixelFromPoint(G.viewport.getCenter()),Wt=xt.x;Wt<=_e.x;Wt++)for(var Ei=xt.y;Ei<=_e.y;Ei++){if(!G.wrapHorizontal&&!G.wrapVertical){var Rt=G.source.getTileBounds(Fe,Wt,Ei);if(null===at.intersection(Rt))continue}dt=D(G,we,de,Wt,Ei,Fe,Le,it,$i,Lt,Dt,dt)}return dt}function D(G,de,we,Fe,Le,it,at,Dt,dt,Kt,oi,We){var xt=function F(G,de,we,Fe,Le,it,at,Dt,dt,Kt){var oi,We,xt,_e,Lt,$i,Wt,Ei,Rt;return it[we]||(it[we]={}),it[we][G]||(it[we][G]={}),it[we][G][de]||(xt=Le.getTileBounds(we,oi=(Dt.x+G%Dt.x)%Dt.x,We=(Dt.y+de%Dt.y)%Dt.y),_e=Le.getTileBounds(we,oi,We,!0),Lt=Le.tileExists(we,oi,We),$i=Le.getTileUrl(we,oi,We),Fe.loadTilesWithAjax?(Wt=Le.getTileAjaxHeaders(we,oi,We),C.isPlainObject(Fe.ajaxHeaders)&&(Wt=C.extend({},Fe.ajaxHeaders,Wt))):Wt=null,Ei=Le.getContext2D?Le.getContext2D(we,oi,We):void 0,xt.x+=(G-oi)/Dt.x,xt.y+=Kt/dt*((de-We)/Dt.y),Rt=new C.Tile(we,G,de,xt,Lt,$i,Ei,Fe.loadTilesWithAjax,Wt,_e),oi===Dt.x-1&&(Rt.isRightMost=!0),We===Dt.y-1&&(Rt.isBottomMost=!0),it[we][G][de]=Rt),(Rt=it[we][G][de]).lastTouchTime=at,Rt}(Fe,Le,it,G,G.source,G.tilesMatrix,oi,Kt,G._worldWidthCurrent,G._worldHeightCurrent),_e=we;G.viewer&&G.viewer.raiseEvent("update-tile",{tiledImage:G,tile:xt}),be(G.coverage,it,Fe,Le,!1);var Lt=xt.loaded||xt.loading||he(G.loadingCoverage,it,Fe,Le);if(be(G.loadingCoverage,it,Fe,Le,Lt),!xt.exists||(de&&!_e&&(he(G.coverage,it,Fe,Le)?be(G.coverage,it,Fe,Le,!0):_e=!0),!_e))return We;if(function W(G,de,we,Fe,Le,it){var at=G.bounds.getTopLeft();at.x*=it._scaleSpring.current.value,at.y*=it._scaleSpring.current.value,at.x+=it._xSpring.current.value,at.y+=it._ySpring.current.value;var Dt=G.bounds.getSize();Dt.x*=it._scaleSpring.current.value,Dt.y*=it._scaleSpring.current.value;var dt=we.pixelFromPointNoRotate(at,!0),Kt=we.pixelFromPointNoRotate(at,!1),oi=we.deltaPixelsFromPointsNoRotate(Dt,!0),We=we.deltaPixelsFromPointsNoRotate(Dt,!1),xt=Kt.plus(We.divide(2)),_e=Fe.squaredDistanceTo(xt);de||(oi=oi.plus(new C.Point(1,1))),G.isRightMost&&it.wrapHorizontal&&(oi.x+=.75),G.isBottomMost&&it.wrapVertical&&(oi.y+=.75),G.position=dt,G.size=oi,G.squaredDistance=_e,G.visibility=Le}(xt,G.source.tileOverlap,G.viewport,dt,Dt,G),!xt.loaded)if(xt.context2D)V(G,xt);else{var $i=G._tileCache.getImageRecord(xt.cacheKey);$i&&V(G,xt,$i.getImage())}if(xt.loaded){var Ei=function te(G,de,we,Fe,Le,it,at){var dt,Kt,Dt=1e3*G.blendTime;if(de.blendStart||(de.blendStart=at),dt=at-de.blendStart,Kt=Dt?Math.min(1,dt/Dt):1,G.alwaysBlend&&(Kt*=it),de.opacity=Kt,G.lastDrawn.push(de),1===Kt)be(G.coverage,Le,we,Fe,!0),G._hasOpaqueTile=!0;else if(dt<Dt)return!0;return!1}(G,xt,Fe,Le,it,at,oi);Ei&&(G._needsDraw=!0)}else xt.loading?G._tilesLoading++:Lt||(We=function Te(G,de){return!G||de.visibility>G.visibility||de.visibility==G.visibility&&de.squaredDistance<G.squaredDistance?de:G}(We,xt));return We}function V(G,de,we,Fe,Le){var it=0;function at(){return it++,Dt}function Dt(){0==--it&&(de.loading=!1,de.loaded=!0,de.context2D||G._tileCache.cacheTile({image:we,tile:de,cutoff:Fe,tiledImage:G}),G._needsDraw=!0)}G.viewer.raiseEvent("tile-loaded",{tile:de,tiledImage:G,tileRequest:Le,image:we,getCompletionCallback:at}),at()()}function Q(G,de,we,Fe){var Le,it,at,Dt;if(!G[de])return!1;if(void 0===we||void 0===Fe){for(at in Le=G[de])if(Object.prototype.hasOwnProperty.call(Le,at))for(Dt in it=Le[at])if(Object.prototype.hasOwnProperty.call(it,Dt)&&!it[Dt])return!1;return!0}return void 0===G[de][we]||void 0===G[de][we][Fe]||!0===G[de][we][Fe]}function he(G,de,we,Fe){return void 0===we||void 0===Fe?Q(G,de+1):Q(G,de+1,2*we,2*Fe)&&Q(G,de+1,2*we,2*Fe+1)&&Q(G,de+1,2*we+1,2*Fe)&&Q(G,de+1,2*we+1,2*Fe+1)}function be(G,de,we,Fe,Le){G[de]?(G[de][we]||(G[de][we]={}),G[de][we][Fe]=Le):C.console.warn("Setting coverage for a tile before its level's coverage has been reset: %s",de)}function ae(G,de){G[de]={}}C.TiledImage=function(G){var de=this;C.console.assert(G.tileCache,"[TiledImage] options.tileCache is required"),C.console.assert(G.drawer,"[TiledImage] options.drawer is required"),C.console.assert(G.viewer,"[TiledImage] options.viewer is required"),C.console.assert(G.imageLoader,"[TiledImage] options.imageLoader is required"),C.console.assert(G.source,"[TiledImage] options.source is required"),C.console.assert(!G.clip||G.clip instanceof C.Rect,"[TiledImage] options.clip must be an OpenSeadragon.Rect if present"),C.EventSource.call(this),this._tileCache=G.tileCache,delete G.tileCache,this._drawer=G.drawer,delete G.drawer,this._imageLoader=G.imageLoader,delete G.imageLoader,G.clip instanceof C.Rect&&(this._clip=G.clip.clone()),delete G.clip;var we=G.x||0;delete G.x;var Fe=G.y||0;delete G.y,this.normHeight=G.source.dimensions.y/G.source.dimensions.x,this.contentAspectX=G.source.dimensions.x/G.source.dimensions.y;var Le=1;G.width?(Le=G.width,delete G.width,G.height&&(C.console.error("specifying both width and height to a tiledImage is not supported"),delete G.height)):G.height&&(Le=G.height/this.normHeight,delete G.height);var it=G.fitBounds;delete G.fitBounds;var at=G.fitBoundsPlacement||OpenSeadragon.Placement.CENTER;delete G.fitBoundsPlacement;var Dt=G.degrees||0;delete G.degrees,C.extend(!0,this,{viewer:null,tilesMatrix:{},coverage:{},loadingCoverage:{},lastDrawn:[],lastResetTime:0,_midDraw:!1,_needsDraw:!0,_hasOpaqueTile:!1,_tilesLoading:0,springStiffness:C.DEFAULT_SETTINGS.springStiffness,animationTime:C.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:C.DEFAULT_SETTINGS.minZoomImageRatio,wrapHorizontal:C.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:C.DEFAULT_SETTINGS.wrapVertical,immediateRender:C.DEFAULT_SETTINGS.immediateRender,blendTime:C.DEFAULT_SETTINGS.blendTime,alwaysBlend:C.DEFAULT_SETTINGS.alwaysBlend,minPixelRatio:C.DEFAULT_SETTINGS.minPixelRatio,smoothTileEdgesMinZoom:C.DEFAULT_SETTINGS.smoothTileEdgesMinZoom,iOSDevice:C.DEFAULT_SETTINGS.iOSDevice,debugMode:C.DEFAULT_SETTINGS.debugMode,crossOriginPolicy:C.DEFAULT_SETTINGS.crossOriginPolicy,ajaxWithCredentials:C.DEFAULT_SETTINGS.ajaxWithCredentials,placeholderFillStyle:C.DEFAULT_SETTINGS.placeholderFillStyle,opacity:C.DEFAULT_SETTINGS.opacity,preload:C.DEFAULT_SETTINGS.preload,compositeOperation:C.DEFAULT_SETTINGS.compositeOperation},G),this._preload=this.preload,delete this.preload,this._fullyLoaded=!1,this._xSpring=new C.Spring({initial:we,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._ySpring=new C.Spring({initial:Fe,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._scaleSpring=new C.Spring({initial:Le,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._degreesSpring=new C.Spring({initial:Dt,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._updateForScale(),it&&this.fitBounds(it,at,!0),this._drawingHandler=function(dt){de.viewer.raiseEvent("tile-drawing",C.extend({tiledImage:de},dt))}},C.extend(C.TiledImage.prototype,C.EventSource.prototype,{needsDraw:function(){return this._needsDraw},getFullyLoaded:function(){return this._fullyLoaded},_setFullyLoaded:function(G){G!==this._fullyLoaded&&(this._fullyLoaded=G,this.raiseEvent("fully-loaded-change",{fullyLoaded:this._fullyLoaded}))},reset:function(){this._tileCache.clearTilesFor(this),this.lastResetTime=C.now(),this._needsDraw=!0},update:function(){var G=this._xSpring.update(),de=this._ySpring.update(),we=this._scaleSpring.update(),Fe=this._degreesSpring.update();return!!(G||de||we||Fe)&&(this._updateForScale(),this._needsDraw=!0,!0)},draw:function(){0!==this.opacity||this._preload?(this._midDraw=!0,this._updateViewport(),this._midDraw=!1):this._needsDraw=!1},destroy:function(){this.reset()},getBounds:function(G){return this.getBoundsNoRotate(G).rotate(this.getRotation(G),this._getRotationPoint(G))},getBoundsNoRotate:function(G){return G?new C.Rect(this._xSpring.current.value,this._ySpring.current.value,this._worldWidthCurrent,this._worldHeightCurrent):new C.Rect(this._xSpring.target.value,this._ySpring.target.value,this._worldWidthTarget,this._worldHeightTarget)},getWorldBounds:function(){return C.console.error("[TiledImage.getWorldBounds] is deprecated; use TiledImage.getBounds instead"),this.getBounds()},getClippedBounds:function(G){var de=this.getBoundsNoRotate(G);if(this._clip){var Le=this._clip.times((G?this._worldWidthCurrent:this._worldWidthTarget)/this.source.dimensions.x);de=new C.Rect(de.x+Le.x,de.y+Le.y,Le.width,Le.height)}return de.rotate(this.getRotation(G),this._getRotationPoint(G))},getContentSize:function(){return new C.Point(this.source.dimensions.x,this.source.dimensions.y)},_viewportToImageDelta:function(G,de,we){var Fe=we?this._scaleSpring.current.value:this._scaleSpring.target.value;return new C.Point(G*(this.source.dimensions.x/Fe),de*(this.source.dimensions.y*this.contentAspectX/Fe))},viewportToImageCoordinates:function(G,de,we){var Fe;return G instanceof C.Point?(we=de,Fe=G):Fe=new C.Point(G,de),Fe=Fe.rotate(-this.getRotation(we),this._getRotationPoint(we)),we?this._viewportToImageDelta(Fe.x-this._xSpring.current.value,Fe.y-this._ySpring.current.value):this._viewportToImageDelta(Fe.x-this._xSpring.target.value,Fe.y-this._ySpring.target.value)},_imageToViewportDelta:function(G,de,we){var Fe=we?this._scaleSpring.current.value:this._scaleSpring.target.value;return new C.Point(G/this.source.dimensions.x*Fe,de/this.source.dimensions.y/this.contentAspectX*Fe)},imageToViewportCoordinates:function(G,de,we){G instanceof C.Point&&(we=de,de=G.y,G=G.x);var Fe=this._imageToViewportDelta(G,de);return we?(Fe.x+=this._xSpring.current.value,Fe.y+=this._ySpring.current.value):(Fe.x+=this._xSpring.target.value,Fe.y+=this._ySpring.target.value),Fe.rotate(this.getRotation(we),this._getRotationPoint(we))},imageToViewportRectangle:function(G,de,we,Fe,Le){var it=G;it instanceof C.Rect?Le=de:it=new C.Rect(G,de,we,Fe);var at=this.imageToViewportCoordinates(it.getTopLeft(),Le),Dt=this._imageToViewportDelta(it.width,it.height,Le);return new C.Rect(at.x,at.y,Dt.x,Dt.y,it.degrees+this.getRotation(Le))},viewportToImageRectangle:function(G,de,we,Fe,Le){var it=G;G instanceof C.Rect?Le=de:it=new C.Rect(G,de,we,Fe);var at=this.viewportToImageCoordinates(it.getTopLeft(),Le),Dt=this._viewportToImageDelta(it.width,it.height,Le);return new C.Rect(at.x,at.y,Dt.x,Dt.y,it.degrees-this.getRotation(Le))},viewerElementToImageCoordinates:function(G){var de=this.viewport.pointFromPixel(G,!0);return this.viewportToImageCoordinates(de)},imageToViewerElementCoordinates:function(G){var de=this.imageToViewportCoordinates(G);return this.viewport.pixelFromPoint(de,!0)},windowToImageCoordinates:function(G){var de=G.minus(OpenSeadragon.getElementPosition(this.viewer.element));return this.viewerElementToImageCoordinates(de)},imageToWindowCoordinates:function(G){return this.imageToViewerElementCoordinates(G).plus(OpenSeadragon.getElementPosition(this.viewer.element))},_viewportToTiledImageRectangle:function(G){var de=this._scaleSpring.current.value;return G=G.rotate(-this.getRotation(!0),this._getRotationPoint(!0)),new C.Rect((G.x-this._xSpring.current.value)/de,(G.y-this._ySpring.current.value)/de,G.width/de,G.height/de,G.degrees)},viewportToImageZoom:function(G){return this._scaleSpring.current.value*this.viewport._containerInnerSize.x/this.source.dimensions.x*G},imageToViewportZoom:function(G){return G/(this._scaleSpring.current.value*this.viewport._containerInnerSize.x/this.source.dimensions.x)},setPosition:function(G,de){var we=this._xSpring.target.value===G.x&&this._ySpring.target.value===G.y;if(de){if(we&&this._xSpring.current.value===G.x&&this._ySpring.current.value===G.y)return;this._xSpring.resetTo(G.x),this._ySpring.resetTo(G.y),this._needsDraw=!0}else{if(we)return;this._xSpring.springTo(G.x),this._ySpring.springTo(G.y),this._needsDraw=!0}we||this._raiseBoundsChange()},setWidth:function(G,de){this._setScale(G,de)},setHeight:function(G,de){this._setScale(G/this.normHeight,de)},setCroppingPolygons:function(G){try{if(!C.isArray(G))throw new Error("Provided cropping polygon is not an array");this._croppingPolygons=G.map(function(Fe){return function(Fe){return Fe.map(function(Le){try{if(function(Fe){return Fe instanceof C.Point||"number"==typeof Fe.x&&"number"==typeof Fe.y}(Le))return{x:Le.x,y:Le.y};throw new Error}catch(it){throw new Error("A Provided cropping polygon point is not supported")}})}(Fe)})}catch(Fe){C.console.error("[TiledImage.setCroppingPolygons] Cropping polygon format not supported"),C.console.error(Fe),this._croppingPolygons=null}},resetCroppingPolygons:function(){this._croppingPolygons=null},fitBounds:function(G,de,we){var Fe=C.Placement.properties[de=de||C.Placement.CENTER],Le=this.contentAspectX,it=0,at=0,Dt=1,dt=1;if(this._clip&&(Le=this._clip.getAspectRatio(),Dt=this._clip.width/this.source.dimensions.x,dt=this._clip.height/this.source.dimensions.y,G.getAspectRatio()>Le?(it=this._clip.x/this._clip.height*G.height,at=this._clip.y/this._clip.height*G.height):(it=this._clip.x/this._clip.width*G.width,at=this._clip.y/this._clip.width*G.width)),G.getAspectRatio()>Le){var Kt=G.height/dt,oi=0;Fe.isHorizontallyCentered?oi=(G.width-G.height*Le)/2:Fe.isRight&&(oi=G.width-G.height*Le),this.setPosition(new C.Point(G.x-it+oi,G.y-at),we),this.setHeight(Kt,we)}else{var We=G.width/Dt,xt=0;Fe.isVerticallyCentered?xt=(G.height-G.width/Le)/2:Fe.isBottom&&(xt=G.height-G.width/Le),this.setPosition(new C.Point(G.x-it,G.y-at+xt),we),this.setWidth(We,we)}},getClip:function(){return this._clip?this._clip.clone():null},setClip:function(G){C.console.assert(!G||G instanceof C.Rect,"[TiledImage.setClip] newClip must be an OpenSeadragon.Rect or null"),this._clip=G instanceof C.Rect?G.clone():null,this._needsDraw=!0,this.raiseEvent("clip-change")},getOpacity:function(){return this.opacity},setOpacity:function(G){G!==this.opacity&&(this.opacity=G,this._needsDraw=!0,this.raiseEvent("opacity-change",{opacity:this.opacity}))},getPreload:function(){return this._preload},setPreload:function(G){this._preload=!!G,this._needsDraw=!0},getRotation:function(G){return G?this._degreesSpring.current.value:this._degreesSpring.target.value},setRotation:function(G,de){this._degreesSpring.target.value===G&&this._degreesSpring.isAtTargetValue()||(de?this._degreesSpring.resetTo(G):this._degreesSpring.springTo(G),this._needsDraw=!0,this._raiseBoundsChange())},_getRotationPoint:function(G){return this.getBoundsNoRotate(G).getCenter()},getCompositeOperation:function(){return this.compositeOperation},setCompositeOperation:function(G){G!==this.compositeOperation&&(this.compositeOperation=G,this._needsDraw=!0,this.raiseEvent("composite-operation-change",{compositeOperation:this.compositeOperation}))},_setScale:function(G,de){var we=this._scaleSpring.target.value===G;if(de){if(we&&this._scaleSpring.current.value===G)return;this._scaleSpring.resetTo(G),this._updateForScale(),this._needsDraw=!0}else{if(we)return;this._scaleSpring.springTo(G),this._updateForScale(),this._needsDraw=!0}we||this._raiseBoundsChange()},_updateForScale:function(){this._worldWidthTarget=this._scaleSpring.target.value,this._worldHeightTarget=this.normHeight*this._scaleSpring.target.value,this._worldWidthCurrent=this._scaleSpring.current.value,this._worldHeightCurrent=this.normHeight*this._scaleSpring.current.value},_raiseBoundsChange:function(){this.raiseEvent("bounds-change")},_isBottomItem:function(){return this.viewer.world.getItemAt(0)===this},_getLevelsInterval:function(){var G=Math.max(this.source.minLevel,Math.floor(Math.log(this.minZoomImageRatio)/Math.log(2))),de=this.viewport.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(0),!0).x*this._scaleSpring.current.value,we=Math.min(Math.abs(this.source.maxLevel),Math.abs(Math.floor(Math.log(de/this.minPixelRatio)/Math.log(2))));return we=Math.max(we,this.source.minLevel||0),{lowestLevel:G=Math.min(G,we),highestLevel:we}},_updateViewport:function(){for(this._needsDraw=!1,this._tilesLoading=0,this.loadingCoverage={};this.lastDrawn.length>0;)this.lastDrawn.pop().beingDrawn=!1;var de=this.viewport,we=this._viewportToTiledImageRectangle(de.getBoundsWithMargins(!0));if(!this.wrapHorizontal&&!this.wrapVertical){var Fe=this._viewportToTiledImageRectangle(this.getClippedBounds(!0));if(null===(we=we.intersection(Fe)))return}for(var Le=this._getLevelsInterval(),it=Le.lowestLevel,at=Le.highestLevel,Dt=null,dt=!1,Kt=C.now(),oi=at;oi>=it;oi--){var We=!1,xt=de.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(oi),!0).x*this._scaleSpring.current.value;if(oi===it||!dt&&xt>=this.minPixelRatio)We=!0,dt=!0;else if(!dt)continue;var _e=de.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(oi),!1).x*this._scaleSpring.current.value,Lt=de.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(Math.max(this.source.getClosestLevel(),0)),!1).x*this._scaleSpring.current.value,$i=this.immediateRender?1:Lt;if(Dt=b(this,dt,We,oi,Math.min(1,(xt-.5)/.5),$i/Math.abs($i-_e),we,Kt,Dt),Q(this.coverage,oi))break}(function Ae(G,de){if(0!==G.opacity&&(0!==de.length||G.placeholderFillStyle)){var Fe,we=de[0];we&&(Fe=G.opacity<1||G.compositeOperation&&"source-over"!==G.compositeOperation||!G._isBottomItem()&&we._hasTransparencyChannel());var Le,it,dt,at=G.viewport.getZoom(!0),Dt=G.viewportToImageZoom(at);de.length>1&&Dt>G.smoothTileEdgesMinZoom&&!G.iOSDevice&&G.getRotation(!0)%360==0&&C.supportsCanvas&&(Fe=!0,Le=we.getScaleForEdgeSmoothing(),it=we.getTranslationForEdgeSmoothing(Le,G._drawer.getCanvasSize(!1),G._drawer.getCanvasSize(!0))),Fe&&(Le||(dt=G.viewport.viewportToViewerElementRectangle(G.getClippedBounds(!0)).getIntegerBoundingBox(),G._drawer.viewer.viewport.getFlip()&&(0!==G.viewport.degrees||G.getRotation(!0)%360!=0)&&(dt.x=G._drawer.viewer.container.clientWidth-(dt.x+dt.width)),dt=dt.times(C.pixelDensityRatio)),G._drawer._clear(!0,dt)),Le||(0!==G.viewport.degrees&&G._drawer._offsetForRotation({degrees:G.viewport.degrees,useSketch:Fe}),G.getRotation(!0)%360!=0&&G._drawer._offsetForRotation({degrees:G.getRotation(!0),point:G.viewport.pixelFromPointNoRotate(G._getRotationPoint(!0),!0),useSketch:Fe}),0===G.viewport.degrees&&G.getRotation(!0)%360==0&&G._drawer.viewer.viewport.getFlip()&&G._drawer._flip());var Kt=!1;if(G._clip){G._drawer.saveContext(Fe);var oi=G.imageToViewportRectangle(G._clip,!0);oi=oi.rotate(-G.getRotation(!0),G._getRotationPoint(!0));var We=G._drawer.viewportToDrawerRectangle(oi);Le&&(We=We.times(Le)),it&&(We=We.translate(it)),G._drawer.setClip(We,Fe),Kt=!0}if(G._croppingPolygons){G._drawer.saveContext(Fe);try{var xt=G._croppingPolygons.map(function(Wt){return Wt.map(function(Ei){var Rt=G.imageToViewportCoordinates(Ei.x,Ei.y,!0).rotate(-G.getRotation(!0),G._getRotationPoint(!0)),On=G._drawer.viewportCoordToDrawerCoord(Rt);return Le&&(On=On.times(Le)),On})});G._drawer.clipWithPolygons(xt,Fe)}catch(Wt){C.console.error(Wt)}Kt=!0}if(G.placeholderFillStyle&&!1===G._hasOpaqueTile){var _e=G._drawer.viewportToDrawerRectangle(G.getBounds(!0));Le&&(_e=_e.times(Le)),it&&(_e=_e.translate(it));var Lt;Lt="function"==typeof G.placeholderFillStyle?G.placeholderFillStyle(G,G._drawer.context):G.placeholderFillStyle,G._drawer.drawRectangle(_e,Lt,Fe)}for(var $i=de.length-1;$i>=0;$i--)G._drawer.drawTile(we=de[$i],G._drawingHandler,Fe,Le,it),we.beingDrawn=!0,G.viewer&&G.viewer.raiseEvent("tile-drawn",{tiledImage:G,tile:we});Kt&&G._drawer.restoreContext(Fe),Le||(G.getRotation(!0)%360!=0&&G._drawer._restoreRotationChanges(Fe),0!==G.viewport.degrees&&G._drawer._restoreRotationChanges(Fe)),Fe&&(Le&&(0!==G.viewport.degrees&&G._drawer._offsetForRotation({degrees:G.viewport.degrees,useSketch:!1}),G.getRotation(!0)%360!=0&&G._drawer._offsetForRotation({degrees:G.getRotation(!0),point:G.viewport.pixelFromPointNoRotate(G._getRotationPoint(!0),!0),useSketch:!1})),G._drawer.blendSketch({opacity:G.opacity,scale:Le,translate:it,compositeOperation:G.compositeOperation,bounds:dt}),Le&&(G.getRotation(!0)%360!=0&&G._drawer._restoreRotationChanges(!1),0!==G.viewport.degrees&&G._drawer._restoreRotationChanges(!1))),Le||0===G.viewport.degrees&&G.getRotation(!0)%360==0&&G._drawer.viewer.viewport.getFlip()&&G._drawer._flip(),function me(G,de){if(G.debugMode)for(var we=de.length-1;we>=0;we--){var Fe=de[we];try{G._drawer.drawDebugInfo(Fe,de.length,we,G)}catch(Le){C.console.error(Le)}}}(G,de)}})(this,this.lastDrawn),Dt&&!Dt.context2D?(function H(G,de,we){de.loading=!0,G._imageLoader.addJob({src:de.url,loadWithAjax:de.loadWithAjax,ajaxHeaders:de.ajaxHeaders,crossOriginPolicy:G.crossOriginPolicy,ajaxWithCredentials:G.ajaxWithCredentials,callback:function(Fe,Le,it){!function z(G,de,we,Fe,Le,it){if(!Fe)return C.console.log("Tile %s failed to load: %s - error: %s",de,de.url,Le),G.viewer.raiseEvent("tile-load-failed",{tile:de,tiledImage:G,time:we,message:Le,tileRequest:it}),de.loading=!1,void(de.exists=!1);if(we<G.lastResetTime)return C.console.log("Ignoring tile %s loaded before reset: %s",de,de.url),void(de.loading=!1);var at=function(){var Dt=G.source.getClosestLevel();V(G,de,Fe,Dt,it)};G._midDraw?window.setTimeout(at,1):at()}(G,de,we,Fe,Le,it)},abort:function(){de.loading=!1}})}(this,Dt,Kt),this._needsDraw=!0,this._setFullyLoaded(!1)):this._setFullyLoaded(0===this._tilesLoading)},_getCornerTiles:function(G,de,we){var Fe,Le;this.wrapHorizontal?(Fe=C.positiveModulo(de.x,1),Le=C.positiveModulo(we.x,1)):(Fe=Math.max(0,de.x),Le=Math.min(1,we.x));var it,at,Dt=1/this.source.aspectRatio;this.wrapVertical?(it=C.positiveModulo(de.y,Dt),at=C.positiveModulo(we.y,Dt)):(it=Math.max(0,de.y),at=Math.min(Dt,we.y));var dt=this.source.getTileAtPoint(G,new C.Point(Fe,it)),Kt=this.source.getTileAtPoint(G,new C.Point(Le,at)),oi=this.source.getNumTiles(G);return this.wrapHorizontal&&(dt.x+=oi.x*Math.floor(de.x),Kt.x+=oi.x*Math.floor(we.x)),this.wrapVertical&&(dt.y+=oi.y*Math.floor(de.y/Dt),Kt.y+=oi.y*Math.floor(we.y/Dt)),{topLeft:dt,bottomRight:Kt}}})}(OpenSeadragon),function(C){var b=function(F){C.console.assert(F,"[TileCache.cacheTile] options is required"),C.console.assert(F.tile,"[TileCache.cacheTile] options.tile is required"),C.console.assert(F.tiledImage,"[TileCache.cacheTile] options.tiledImage is required"),this.tile=F.tile,this.tiledImage=F.tiledImage},D=function(F){C.console.assert(F,"[ImageRecord] options is required"),C.console.assert(F.image,"[ImageRecord] options.image is required"),this._image=F.image,this._tiles=[]};D.prototype={destroy:function(){this._image=null,this._renderedContext=null,this._tiles=null},getImage:function(){return this._image},getRenderedContext:function(){if(!this._renderedContext){var F=document.createElement("canvas");F.width=this._image.width,F.height=this._image.height,this._renderedContext=F.getContext("2d"),this._renderedContext.drawImage(this._image,0,0),this._image=null}return this._renderedContext},setRenderedContext:function(F){C.console.error("ImageRecord.setRenderedContext is deprecated. The rendered context should be created by the ImageRecord itself when calling ImageRecord.getRenderedContext."),this._renderedContext=F},addTile:function(F){C.console.assert(F,"[ImageRecord.addTile] tile is required"),this._tiles.push(F)},removeTile:function(F){for(var H=0;H<this._tiles.length;H++)if(this._tiles[H]===F)return void this._tiles.splice(H,1);C.console.warn("[ImageRecord.removeTile] trying to remove unknown tile",F)},getTileCount:function(){return this._tiles.length}},C.TileCache=function(F){this._maxImageCacheCount=(F=F||{}).maxImageCacheCount||C.DEFAULT_SETTINGS.maxImageCacheCount,this._tilesLoaded=[],this._imagesLoaded=[],this._imagesLoadedCount=0},C.TileCache.prototype={numTilesLoaded:function(){return this._tilesLoaded.length},cacheTile:function(F){C.console.assert(F,"[TileCache.cacheTile] options is required"),C.console.assert(F.tile,"[TileCache.cacheTile] options.tile is required"),C.console.assert(F.tile.cacheKey,"[TileCache.cacheTile] options.tile.cacheKey is required"),C.console.assert(F.tiledImage,"[TileCache.cacheTile] options.tiledImage is required");var H=F.cutoff||0,z=this._tilesLoaded.length,V=this._imagesLoaded[F.tile.cacheKey];if(V||(C.console.assert(F.image,"[TileCache.cacheTile] options.image is required to create an ImageRecord"),V=this._imagesLoaded[F.tile.cacheKey]=new D({image:F.image}),this._imagesLoadedCount++),V.addTile(F.tile),F.tile.cacheImageRecord=V,this._imagesLoadedCount>this._maxImageCacheCount){for(var he,be,Te,me,W=null,te=-1,Q=null,G=this._tilesLoaded.length-1;G>=0;G--)if(!((he=(me=this._tilesLoaded[G]).tile).level<=H||he.beingDrawn)){if(!W){W=he,te=G,Q=me;continue}((Te=he.lastTouchTime)<(be=W.lastTouchTime)||Te==be&&he.level>W.level)&&(W=he,te=G,Q=me)}W&&te>=0&&(this._unloadTile(Q),z=te)}this._tilesLoaded[z]=new b({tile:F.tile,tiledImage:F.tiledImage})},clearTilesFor:function(F){C.console.assert(F,"[TileCache.clearTilesFor] tiledImage is required");for(var H,z=0;z<this._tilesLoaded.length;++z)(H=this._tilesLoaded[z]).tiledImage===F&&(this._unloadTile(H),this._tilesLoaded.splice(z,1),z--)},getImageRecord:function(F){return C.console.assert(F,"[TileCache.getImageRecord] cacheKey is required"),this._imagesLoaded[F]},_unloadTile:function(F){C.console.assert(F,"[TileCache._unloadTile] tileRecord is required");var H=F.tile,z=F.tiledImage;H.unload(),H.cacheImageRecord=null;var V=this._imagesLoaded[H.cacheKey];V.removeTile(H),V.getTileCount()||(V.destroy(),delete this._imagesLoaded[H.cacheKey],this._imagesLoadedCount--),z.viewer.raiseEvent("tile-unloaded",{tile:H,tiledImage:z})}}}(OpenSeadragon),function(C){C.World=function(b){var D=this;C.console.assert(b.viewer,"[World] options.viewer is required"),C.EventSource.call(this),this.viewer=b.viewer,this._items=[],this._needsDraw=!1,this._autoRefigureSizes=!0,this._needsSizesFigured=!1,this._delegatedFigureSizes=function(F){D._autoRefigureSizes?D._figureSizes():D._needsSizesFigured=!0},this._figureSizes()},C.extend(C.World.prototype,C.EventSource.prototype,{addItem:function(b,D){if(C.console.assert(b,"[World.addItem] item is required"),C.console.assert(b instanceof C.TiledImage,"[World.addItem] only TiledImages supported at this time"),void 0!==(D=D||{}).index){var F=Math.max(0,Math.min(this._items.length,D.index));this._items.splice(F,0,b)}else this._items.push(b);this._autoRefigureSizes?this._figureSizes():this._needsSizesFigured=!0,this._needsDraw=!0,b.addHandler("bounds-change",this._delegatedFigureSizes),b.addHandler("clip-change",this._delegatedFigureSizes),this.raiseEvent("add-item",{item:b})},getItemAt:function(b){return C.console.assert(void 0!==b,"[World.getItemAt] index is required"),this._items[b]},getIndexOfItem:function(b){return C.console.assert(b,"[World.getIndexOfItem] item is required"),C.indexOf(this._items,b)},getItemCount:function(){return this._items.length},setItemIndex:function(b,D){C.console.assert(b,"[World.setItemIndex] item is required"),C.console.assert(void 0!==D,"[World.setItemIndex] index is required");var F=this.getIndexOfItem(b);if(D>=this._items.length)throw new Error("Index bigger than number of layers.");D===F||-1===F||(this._items.splice(F,1),this._items.splice(D,0,b),this._needsDraw=!0,this.raiseEvent("item-index-change",{item:b,previousIndex:F,newIndex:D}))},removeItem:function(b){C.console.assert(b,"[World.removeItem] item is required");var D=C.indexOf(this._items,b);-1!==D&&(b.removeHandler("bounds-change",this._delegatedFigureSizes),b.removeHandler("clip-change",this._delegatedFigureSizes),b.destroy(),this._items.splice(D,1),this._figureSizes(),this._needsDraw=!0,this._raiseRemoveItem(b))},removeAll:function(){var b,D;for(this.viewer._cancelPendingImages(),D=0;D<this._items.length;D++)(b=this._items[D]).removeHandler("bounds-change",this._delegatedFigureSizes),b.removeHandler("clip-change",this._delegatedFigureSizes),b.destroy();var F=this._items;for(this._items=[],this._figureSizes(),this._needsDraw=!0,D=0;D<F.length;D++)this._raiseRemoveItem(b=F[D])},resetItems:function(){for(var b=0;b<this._items.length;b++)this._items[b].reset()},update:function(){for(var b=!1,D=0;D<this._items.length;D++)b=this._items[D].update()||b;return b},draw:function(){for(var b=0;b<this._items.length;b++)this._items[b].draw();this._needsDraw=!1},needsDraw:function(){for(var b=0;b<this._items.length;b++)if(this._items[b].needsDraw())return!0;return this._needsDraw},getHomeBounds:function(){return this._homeBounds.clone()},getContentFactor:function(){return this._contentFactor},setAutoRefigureSizes:function(b){this._autoRefigureSizes=b,b&this._needsSizesFigured&&(this._figureSizes(),this._needsSizesFigured=!1)},arrange:function(b){var Q,D=(b=b||{}).immediately||!1,F=b.layout||C.DEFAULT_SETTINGS.collectionLayout,z=b.columns||C.DEFAULT_SETTINGS.collectionColumns,V=b.tileSize||C.DEFAULT_SETTINGS.collectionTileSize,te=V+(b.tileMargin||C.DEFAULT_SETTINGS.collectionTileMargin);Q=!b.rows&&z?z:Math.ceil(this._items.length/(b.rows||C.DEFAULT_SETTINGS.collectionRows));var ae,Te,Ae,G,he=0,be=0;this.setAutoRefigureSizes(!1);for(var de=0;de<this._items.length;de++)de&&de%Q==0&&("horizontal"===F?(be+=te,he=0):(he+=te,be=0)),Te=(ae=this._items[de]).getBounds(),G=new C.Point(he+(V-(Ae=Te.width>Te.height?V:V*(Te.width/Te.height)))/2,be+(V-Ae*(Te.height/Te.width))/2),ae.setPosition(G,D),ae.setWidth(Ae,D),"horizontal"===F?he+=te:be+=te;this.setAutoRefigureSizes(!0)},_figureSizes:function(){var b=this._homeBounds?this._homeBounds.clone():null,D=this._contentSize?this._contentSize.clone():null,F=this._contentFactor||0;if(this._items.length){var H=this._items[0],z=H.getBounds();this._contentFactor=H.getContentSize().x/z.width;for(var V=H.getClippedBounds().getBoundingBox(),W=V.x,te=V.y,Q=V.x+V.width,he=V.y+V.height,be=1;be<this._items.length;be++)z=(H=this._items[be]).getBounds(),this._contentFactor=Math.max(this._contentFactor,H.getContentSize().x/z.width),V=H.getClippedBounds().getBoundingBox(),W=Math.min(W,V.x),te=Math.min(te,V.y),Q=Math.max(Q,V.x+V.width),he=Math.max(he,V.y+V.height);this._homeBounds=new C.Rect(W,te,Q-W,he-te),this._contentSize=new C.Point(this._homeBounds.width*this._contentFactor,this._homeBounds.height*this._contentFactor)}else this._homeBounds=new C.Rect(0,0,1,1),this._contentSize=new C.Point(1,1),this._contentFactor=1;(this._contentFactor!==F||!this._homeBounds.equals(b)||!this._contentSize.equals(D))&&this.raiseEvent("metrics-change",{})},_raiseRemoveItem:function(b){this.raiseEvent("remove-item",{item:b})}})}(OpenSeadragon)},8227:C=>{"use strict";function b(D){throw new Error(D)}C.exports=function(D){D.OBJLoader=function(F){this.manager=void 0!==F?F:D.DefaultLoadingManager,this.materials=null,this.regexp={vertex_pattern:/^v\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)/,normal_pattern:/^vn\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)/,uv_pattern:/^vt\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)/,face_vertex:/^f\s+(-?\d+)\s+(-?\d+)\s+(-?\d+)(?:\s+(-?\d+))?/,face_vertex_uv:/^f\s+(-?\d+)\/(-?\d+)\s+(-?\d+)\/(-?\d+)\s+(-?\d+)\/(-?\d+)(?:\s+(-?\d+)\/(-?\d+))?/,face_vertex_uv_normal:/^f\s+(-?\d+)\/(-?\d+)\/(-?\d+)\s+(-?\d+)\/(-?\d+)\/(-?\d+)\s+(-?\d+)\/(-?\d+)\/(-?\d+)(?:\s+(-?\d+)\/(-?\d+)\/(-?\d+))?/,face_vertex_normal:/^f\s+(-?\d+)\/\/(-?\d+)\s+(-?\d+)\/\/(-?\d+)\s+(-?\d+)\/\/(-?\d+)(?:\s+(-?\d+)\/\/(-?\d+))?/,object_pattern:/^[og]\s*(.+)?/,smoothing_pattern:/^s\s+(\d+|on|off)/,material_library_pattern:/^mtllib /,material_use_pattern:/^usemtl /}},D.OBJLoader.prototype={constructor:D.OBJLoader,load:function(H,z,V,W){var te=this;this.onError=W||b;var Q=new D.FileLoader(te.manager);Q.setPath(this.path),Q.load(H,function(he){z(te.parse(he))},V,W)},setPath:function(H){this.path=H},setMaterials:function(H){this.materials=H},_createParserState:function(){var H={objects:[],object:{},vertices:[],normals:[],uvs:[],materialLibraries:[],startObject:function(V,W){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=V,void(this.object.fromDeclaration=!1!==W);var te=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:V||"",fromDeclaration:!1!==W,geometry:{vertices:[],normals:[],uvs:[]},materials:[],smooth:!0,startMaterial:function(be,ae){var Te=this._finalize(!1);Te&&(Te.inherited||Te.groupCount<=0)&&this.materials.splice(Te.index,1);var Ae={index:this.materials.length,name:be||"",mtllib:Array.isArray(ae)&&ae.length>0?ae[ae.length-1]:"",smooth:void 0!==Te?Te.smooth:this.smooth,groupStart:void 0!==Te?Te.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(G){var de={index:"number"==typeof G?G:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return de.clone=this.clone.bind(de),de}};return this.materials.push(Ae),Ae},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(be){var ae=this.currentMaterial();if(ae&&-1===ae.groupEnd&&(ae.groupEnd=this.geometry.vertices.length/3,ae.groupCount=ae.groupEnd-ae.groupStart,ae.inherited=!1),be&&this.materials.length>1)for(var Te=this.materials.length-1;Te>=0;Te--)this.materials[Te].groupCount<=0&&this.materials.splice(Te,1);return be&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),ae}},te&&te.name&&"function"==typeof te.clone){var Q=te.clone(0);Q.inherited=!0,this.object.materials.push(Q)}this.objects.push(this.object)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(V,W){var te=parseInt(V,10);return 3*(te>=0?te-1:te+W/3)},parseNormalIndex:function(V,W){var te=parseInt(V,10);return 3*(te>=0?te-1:te+W/3)},parseUVIndex:function(V,W){var te=parseInt(V,10);return 2*(te>=0?te-1:te+W/2)},addVertex:function(V,W,te){var Q=this.vertices,he=this.object.geometry.vertices;he.push(Q[V+0]),he.push(Q[V+1]),he.push(Q[V+2]),he.push(Q[W+0]),he.push(Q[W+1]),he.push(Q[W+2]),he.push(Q[te+0]),he.push(Q[te+1]),he.push(Q[te+2])},addVertexLine:function(V){var W=this.vertices,te=this.object.geometry.vertices;te.push(W[V+0]),te.push(W[V+1]),te.push(W[V+2])},addNormal:function(V,W,te){var Q=this.normals,he=this.object.geometry.normals;he.push(Q[V+0]),he.push(Q[V+1]),he.push(Q[V+2]),he.push(Q[W+0]),he.push(Q[W+1]),he.push(Q[W+2]),he.push(Q[te+0]),he.push(Q[te+1]),he.push(Q[te+2])},addUV:function(V,W,te){var Q=this.uvs,he=this.object.geometry.uvs;he.push(Q[V+0]),he.push(Q[V+1]),he.push(Q[W+0]),he.push(Q[W+1]),he.push(Q[te+0]),he.push(Q[te+1])},addUVLine:function(V){var W=this.uvs,te=this.object.geometry.uvs;te.push(W[V+0]),te.push(W[V+1])},addFace:function(V,W,te,Q,he,be,ae,Te,Ae,me,G,de){var at,we=this.vertices.length,Fe=this.parseVertexIndex(V,we),Le=this.parseVertexIndex(W,we),it=this.parseVertexIndex(te,we);if(void 0===Q?this.addVertex(Fe,Le,it):(at=this.parseVertexIndex(Q,we),this.addVertex(Fe,Le,at),this.addVertex(Le,it,at)),void 0!==he){var Dt=this.uvs.length;Fe=this.parseUVIndex(he,Dt),Le=this.parseUVIndex(be,Dt),it=this.parseUVIndex(ae,Dt),void 0===Q?this.addUV(Fe,Le,it):(at=this.parseUVIndex(Te,Dt),this.addUV(Fe,Le,at),this.addUV(Le,it,at))}if(void 0!==Ae){var dt=this.normals.length;Fe=this.parseNormalIndex(Ae,dt),Le=Ae===me?Fe:this.parseNormalIndex(me,dt),it=Ae===G?Fe:this.parseNormalIndex(G,dt),void 0===Q?this.addNormal(Fe,Le,it):(at=this.parseNormalIndex(de,dt),this.addNormal(Fe,Le,at),this.addNormal(Le,it,at))}},addLineGeometry:function(V,W){this.object.geometry.type="Line";for(var te=this.vertices.length,Q=this.uvs.length,he=0,be=V.length;he<be;he++)this.addVertexLine(this.parseVertexIndex(V[he],te));var ae=0;for(be=W.length;ae<be;ae++)this.addUVLine(this.parseUVIndex(W[ae],Q))}};return H.startObject("",!1),H},parse:function(H,z){void 0===z&&(z=!0),z&&console.time("OBJLoader");var V=this._createParserState();-1!==H.indexOf("\r\n")&&(H=H.replace(/\r\n/g,"\n")),-1!==H.indexOf("\\\n")&&(H=H.replace(/\\\n/g,""));for(var W=H.split("\n"),te="",Q="",he="",ae=[],Te="function"==typeof"".trimLeft,Ae=0,me=W.length;Ae<me;Ae++)if(te=W[Ae],0!==(te=Te?te.trimLeft():te.trim()).length&&"#"!==(Q=te.charAt(0)))if("v"===Q)" "===(he=te.charAt(1))&&null!==(ae=this.regexp.vertex_pattern.exec(te))?V.vertices.push(parseFloat(ae[1]),parseFloat(ae[2]),parseFloat(ae[3])):"n"===he&&null!==(ae=this.regexp.normal_pattern.exec(te))?V.normals.push(parseFloat(ae[1]),parseFloat(ae[2]),parseFloat(ae[3])):"t"===he&&null!==(ae=this.regexp.uv_pattern.exec(te))?V.uvs.push(parseFloat(ae[1]),parseFloat(ae[2])):this.onError("Unexpected vertex/normal/uv line: '"+te+"'");else if("f"===Q)null!==(ae=this.regexp.face_vertex_uv_normal.exec(te))?V.addFace(ae[1],ae[4],ae[7],ae[10],ae[2],ae[5],ae[8],ae[11],ae[3],ae[6],ae[9],ae[12]):null!==(ae=this.regexp.face_vertex_uv.exec(te))?V.addFace(ae[1],ae[3],ae[5],ae[7],ae[2],ae[4],ae[6],ae[8]):null!==(ae=this.regexp.face_vertex_normal.exec(te))?V.addFace(ae[1],ae[3],ae[5],ae[7],void 0,void 0,void 0,void 0,ae[2],ae[4],ae[6],ae[8]):null!==(ae=this.regexp.face_vertex.exec(te))?V.addFace(ae[1],ae[2],ae[3],ae[4]):this.onError("Unexpected face line: '"+te+"'");else if("l"===Q){var G=te.substring(1).trim().split(" "),de=[],we=[];if(-1===te.indexOf("/"))de=G;else for(var Fe=0,Le=G.length;Fe<Le;Fe++){var it=G[Fe].split("/");""!==it[0]&&de.push(it[0]),""!==it[1]&&we.push(it[1])}V.addLineGeometry(de,we)}else if(null!==(ae=this.regexp.object_pattern.exec(te))){var at=(" "+ae[0].substr(1).trim()).substr(1);V.startObject(at)}else if(this.regexp.material_use_pattern.test(te))V.object.startMaterial(te.substring(7).trim(),V.materialLibraries);else if(this.regexp.material_library_pattern.test(te))V.materialLibraries.push(te.substring(7).trim());else if(null!==(ae=this.regexp.smoothing_pattern.exec(te))){var Dt=ae[1].trim().toLowerCase();V.object.smooth="1"===Dt||"on"===Dt,(dt=V.object.currentMaterial())&&(dt.smooth=V.object.smooth)}else{if("\0"===te)continue;this.onError("Unexpected line: '"+te+"'")}V.finalize();var Kt=new D.Group;for(Kt.materialLibraries=[].concat(V.materialLibraries),Ae=0,me=V.objects.length;Ae<me;Ae++){var oi=V.objects[Ae],We=oi.geometry,xt=oi.materials,_e="Line"===We.type;if(0!==We.vertices.length){var Ct,Lt=new D.BufferGeometry;Lt.addAttribute("position",new D.BufferAttribute(new Float32Array(We.vertices),3)),We.normals.length>0?Lt.addAttribute("normal",new D.BufferAttribute(new Float32Array(We.normals),3)):Lt.computeVertexNormals(),We.uvs.length>0&&Lt.addAttribute("uv",new D.BufferAttribute(new Float32Array(We.uvs),2));for(var $i=[],Wt=0,Ei=xt.length;Wt<Ei;Wt++){var Rt=xt[Wt],dt=void 0;if(null!==this.materials&&(dt=this.materials.create(Rt.name),_e&&dt&&!(dt instanceof D.LineBasicMaterial))){var On=new D.LineBasicMaterial;On.copy(dt),dt=On}dt||((dt=_e?new D.LineBasicMaterial:new D.MeshPhongMaterial).name=Rt.name),dt.shading=Rt.smooth?D.SmoothShading:D.FlatShading,$i.push(dt)}if($i.length>1){for(Wt=0,Ei=xt.length;Wt<Ei;Wt++)Lt.addGroup((Rt=xt[Wt]).groupStart,Rt.groupCount,Wt);var ft=new D.MultiMaterial($i);Ct=_e?new D.LineSegments(Lt,ft):new D.Mesh(Lt,ft)}else Ct=_e?new D.LineSegments(Lt,$i[0]):new D.Mesh(Lt,$i[0]);Ct.name=oi.name,Kt.add(Ct)}}return z&&console.timeEnd("OBJLoader"),Kt}}}},757:C=>{C.exports=function(b){var D=function(F){this.manager=void 0!==F?F:b.DefaultLoadingManager};return D.prototype={constructor:b.STLLoader,load:function(F,H,z,V){var W=this,te=new b.FileLoader(W.manager);te.setResponseType("arraybuffer"),te.load(F,function(Q){H(W.parse(Q))},z,V)},parse:function(F){var z=this.ensureBinary(F);return function(){var Q;if(84+50*(Q=new DataView(z)).getUint32(80,!0)===Q.byteLength)return!0;for(var he=[115,111,108,105,100],be=0;be<5;be++)if(he[be]!=Q.getUint8(be,!1))return!0;return!1}()?this.parseBinary(z):this.parseASCII(this.ensureString(F))},parseBinary:function(F){for(var V,W,te,he,be,ae,Te,Ae,H=new DataView(F),z=H.getUint32(80,!0),Q=!1,me=0;me<70;me++)1129270351==H.getUint32(me,!1)&&82==H.getUint8(me+4)&&61==H.getUint8(me+5)&&(Q=!0,he=[],be=H.getUint8(me+6)/255,ae=H.getUint8(me+7)/255,Te=H.getUint8(me+8)/255,Ae=H.getUint8(me+9)/255);for(var we=new b.BufferGeometry,Fe=[],Le=[],it=0;it<z;it++){var at=84+50*it,Dt=H.getFloat32(at,!0),dt=H.getFloat32(at+4,!0),Kt=H.getFloat32(at+8,!0);if(Q){var oi=H.getUint16(at+48,!0);0==(32768&oi)?(V=(31&oi)/31,W=(oi>>5&31)/31,te=(oi>>10&31)/31):(V=be,W=ae,te=Te)}for(var We=1;We<=3;We++){var xt=at+12*We;Fe.push(H.getFloat32(xt,!0)),Fe.push(H.getFloat32(xt+4,!0)),Fe.push(H.getFloat32(xt+8,!0)),Le.push(Dt,dt,Kt),Q&&he.push(V,W,te)}}return we.addAttribute("position",new b.BufferAttribute(new Float32Array(Fe),3)),we.addAttribute("normal",new b.BufferAttribute(new Float32Array(Le),3)),Q&&(we.addAttribute("color",new b.BufferAttribute(new Float32Array(he),3)),we.hasColors=!0,we.alpha=Ae),we},parseASCII:function(F){var H,V,W,te,Q,he;H=new b.BufferGeometry,V=/facet([\s\S]*?)endfacet/g;for(var be=[],ae=[],Te=new b.Vector3;null!==(Q=V.exec(F));){for(he=Q[0],W=/normal[\s]+([\-+]?[0-9]+\.?[0-9]*([eE][\-+]?[0-9]+)?)+[\s]+([\-+]?[0-9]*\.?[0-9]+([eE][\-+]?[0-9]+)?)+[\s]+([\-+]?[0-9]*\.?[0-9]+([eE][\-+]?[0-9]+)?)+/g;null!==(Q=W.exec(he));)Te.x=parseFloat(Q[1]),Te.y=parseFloat(Q[3]),Te.z=parseFloat(Q[5]);for(te=/vertex[\s]+([\-+]?[0-9]+\.?[0-9]*([eE][\-+]?[0-9]+)?)+[\s]+([\-+]?[0-9]*\.?[0-9]+([eE][\-+]?[0-9]+)?)+[\s]+([\-+]?[0-9]*\.?[0-9]+([eE][\-+]?[0-9]+)?)+/g;null!==(Q=te.exec(he));)be.push(parseFloat(Q[1]),parseFloat(Q[3]),parseFloat(Q[5])),ae.push(Te.x,Te.y,Te.z)}return H.addAttribute("position",new b.BufferAttribute(new Float32Array(be),3)),H.addAttribute("normal",new b.BufferAttribute(new Float32Array(ae),3)),H},ensureString:function(F){if("string"!=typeof F){for(var H=new Uint8Array(F),z=[],V=0;V<F.byteLength;V++)z.push(String.fromCharCode(H[V]));return z.join("")}return F},ensureBinary:function(F){if("string"==typeof F){for(var H=new Uint8Array(F.length),z=0;z<F.length;z++)H[z]=255&F.charCodeAt(z);return H.buffer||H}return F}},D}},8926:C=>{function b(F,H,z,V,W,te,Q){try{var he=F[te](Q),be=he.value}catch(ae){return void z(ae)}he.done?H(be):Promise.resolve(be).then(V,W)}C.exports=function D(F){return function(){var H=this,z=arguments;return new Promise(function(V,W){var te=F.apply(H,z);function Q(be){b(te,V,W,Q,he,"next",be)}function he(be){b(te,V,W,Q,he,"throw",be)}Q(void 0)})}},C.exports.__esModule=!0,C.exports.default=C.exports},712:(C,b,D)=>{"use strict";var F=D(8926).default;Object.defineProperty(b,"__esModule",{value:!0});const H="137",oa=1e3,Lo=1001,no=1002,ro=1003,tt=1006,Gi=1008,Xn=1009,vs=1012,ic=1014,eo=1015,Sa=1016,gh=1020,Ua=1023,ed=1026,ks=1027,ep=33776,Jp=33777,tu=33778,cf=33779,yr=2300,la=2301,rd=2400,sd=2401,hu=2402,od=3e3,zn=3001,ds=35044,df=35048,nc="300 es";class Fl{addEventListener(o,c){void 0===this._listeners&&(this._listeners={});const d=this._listeners;void 0===d[o]&&(d[o]=[]),-1===d[o].indexOf(c)&&d[o].push(c)}hasEventListener(o,c){if(void 0===this._listeners)return!1;const d=this._listeners;return void 0!==d[o]&&-1!==d[o].indexOf(c)}removeEventListener(o,c){if(void 0===this._listeners)return;const p=this._listeners[o];if(void 0!==p){const y=p.indexOf(c);-1!==y&&p.splice(y,1)}}dispatchEvent(o){if(void 0===this._listeners)return;const d=this._listeners[o.type];if(void 0!==d){o.target=this;const p=d.slice(0);for(let y=0,w=p.length;y<w;y++)p[y].call(this,o);o.target=null}}}const Co=[];for(let g=0;g<256;g++)Co[g]=(g<16?"0":"")+g.toString(16);let rm=1234567;const ud=Math.PI/180,ff=180/Math.PI;function tl(){const g=4294967295*Math.random()|0,o=4294967295*Math.random()|0,c=4294967295*Math.random()|0,d=4294967295*Math.random()|0;return(Co[255&g]+Co[g>>8&255]+Co[g>>16&255]+Co[g>>24&255]+"-"+Co[255&o]+Co[o>>8&255]+"-"+Co[o>>16&15|64]+Co[o>>24&255]+"-"+Co[63&c|128]+Co[c>>8&255]+"-"+Co[c>>16&255]+Co[c>>24&255]+Co[255&d]+Co[d>>8&255]+Co[d>>16&255]+Co[d>>24&255]).toUpperCase()}function Ur(g,o,c){return Math.max(o,Math.min(c,g))}function uv(g,o){return(g%o+o)%o}function Gs(g,o,c){return(1-c)*g+c*o}function lm(g){return 0==(g&g-1)&&0!==g}function dv(g){return Math.pow(2,Math.ceil(Math.log(g)/Math.LN2))}function yi(g){return Math.pow(2,Math.floor(Math.log(g)/Math.LN2))}var pv=Object.freeze({__proto__:null,DEG2RAD:ud,RAD2DEG:ff,generateUUID:tl,clamp:Ur,euclideanModulo:uv,mapLinear:function zE(g,o,c,d,p){return d+(g-o)*(p-d)/(c-o)},inverseLerp:function np(g,o,c){return g!==o?(c-g)/(o-g):0},lerp:Gs,damp:function Xg(g,o,c,d){return Gs(g,o,1-Math.exp(-c*d))},pingpong:function Zg(g,o=1){return o-Math.abs(uv(g,2*o)-o)},smoothstep:function Yg(g,o,c){return g<=o?0:g>=c?1:(g=(g-o)/(c-o))*g*(3-2*g)},smootherstep:function sm(g,o,c){return g<=o?0:g>=c?1:(g=(g-o)/(c-o))*g*g*(g*(6*g-15)+10)},randInt:function rc(g,o){return g+Math.floor(Math.random()*(o-g+1))},randFloat:function om(g,o){return g+Math.random()*(o-g)},randFloatSpread:function am(g){return g*(.5-Math.random())},seededRandom:function ei(g){return void 0!==g&&(rm=g%2147483647),rm=16807*rm%2147483647,(rm-1)/2147483646},degToRad:function hv(g){return g*ud},radToDeg:function J0(g){return g*ff},isPowerOfTwo:lm,ceilPowerOfTwo:dv,floorPowerOfTwo:yi,setQuaternionFromProperEuler:function fv(g,o,c,d,p){const y=Math.cos,w=Math.sin,M=y(c/2),R=w(c/2),A=y((o+d)/2),N=w((o+d)/2),U=y((o-d)/2),q=w((o-d)/2),Y=y((d-o)/2),ne=w((d-o)/2);switch(p){case"XYX":g.set(M*N,R*U,R*q,M*A);break;case"YZY":g.set(R*q,M*N,R*U,M*A);break;case"ZXZ":g.set(R*U,R*q,M*N,M*A);break;case"XZX":g.set(M*N,R*ne,R*Y,M*A);break;case"YXY":g.set(R*Y,M*N,R*ne,M*A);break;case"ZYZ":g.set(R*ne,R*Y,M*N,M*A);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+p)}}});class Be{constructor(o=0,c=0){this.x=o,this.y=c}get width(){return this.x}set width(o){this.x=o}get height(){return this.y}set height(o){this.y=o}set(o,c){return this.x=o,this.y=c,this}setScalar(o){return this.x=o,this.y=o,this}setX(o){return this.x=o,this}setY(o){return this.y=o,this}setComponent(o,c){switch(o){case 0:this.x=c;break;case 1:this.y=c;break;default:throw new Error("index is out of range: "+o)}return this}getComponent(o){switch(o){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+o)}}clone(){return new this.constructor(this.x,this.y)}copy(o){return this.x=o.x,this.y=o.y,this}add(o,c){return void 0!==c?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(o,c)):(this.x+=o.x,this.y+=o.y,this)}addScalar(o){return this.x+=o,this.y+=o,this}addVectors(o,c){return this.x=o.x+c.x,this.y=o.y+c.y,this}addScaledVector(o,c){return this.x+=o.x*c,this.y+=o.y*c,this}sub(o,c){return void 0!==c?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(o,c)):(this.x-=o.x,this.y-=o.y,this)}subScalar(o){return this.x-=o,this.y-=o,this}subVectors(o,c){return this.x=o.x-c.x,this.y=o.y-c.y,this}multiply(o){return this.x*=o.x,this.y*=o.y,this}multiplyScalar(o){return this.x*=o,this.y*=o,this}divide(o){return this.x/=o.x,this.y/=o.y,this}divideScalar(o){return this.multiplyScalar(1/o)}applyMatrix3(o){const c=this.x,d=this.y,p=o.elements;return this.x=p[0]*c+p[3]*d+p[6],this.y=p[1]*c+p[4]*d+p[7],this}min(o){return this.x=Math.min(this.x,o.x),this.y=Math.min(this.y,o.y),this}max(o){return this.x=Math.max(this.x,o.x),this.y=Math.max(this.y,o.y),this}clamp(o,c){return this.x=Math.max(o.x,Math.min(c.x,this.x)),this.y=Math.max(o.y,Math.min(c.y,this.y)),this}clampScalar(o,c){return this.x=Math.max(o,Math.min(c,this.x)),this.y=Math.max(o,Math.min(c,this.y)),this}clampLength(o,c){const d=this.length();return this.divideScalar(d||1).multiplyScalar(Math.max(o,Math.min(c,d)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(o){return this.x*o.x+this.y*o.y}cross(o){return this.x*o.y-this.y*o.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(o){return Math.sqrt(this.distanceToSquared(o))}distanceToSquared(o){const c=this.x-o.x,d=this.y-o.y;return c*c+d*d}manhattanDistanceTo(o){return Math.abs(this.x-o.x)+Math.abs(this.y-o.y)}setLength(o){return this.normalize().multiplyScalar(o)}lerp(o,c){return this.x+=(o.x-this.x)*c,this.y+=(o.y-this.y)*c,this}lerpVectors(o,c,d){return this.x=o.x+(c.x-o.x)*d,this.y=o.y+(c.y-o.y)*d,this}equals(o){return o.x===this.x&&o.y===this.y}fromArray(o,c=0){return this.x=o[c],this.y=o[c+1],this}toArray(o=[],c=0){return o[c]=this.x,o[c+1]=this.y,o}fromBufferAttribute(o,c,d){return void 0!==d&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=o.getX(c),this.y=o.getY(c),this}rotateAround(o,c){const d=Math.cos(c),p=Math.sin(c),y=this.x-o.x,w=this.y-o.y;return this.x=y*d-w*p+o.x,this.y=y*p+w*d+o.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}Be.prototype.isVector2=!0;class Hn{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(o,c,d,p,y,w,M,R,A){const N=this.elements;return N[0]=o,N[1]=p,N[2]=M,N[3]=c,N[4]=y,N[5]=R,N[6]=d,N[7]=w,N[8]=A,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(o){const c=this.elements,d=o.elements;return c[0]=d[0],c[1]=d[1],c[2]=d[2],c[3]=d[3],c[4]=d[4],c[5]=d[5],c[6]=d[6],c[7]=d[7],c[8]=d[8],this}extractBasis(o,c,d){return o.setFromMatrix3Column(this,0),c.setFromMatrix3Column(this,1),d.setFromMatrix3Column(this,2),this}setFromMatrix4(o){const c=o.elements;return this.set(c[0],c[4],c[8],c[1],c[5],c[9],c[2],c[6],c[10]),this}multiply(o){return this.multiplyMatrices(this,o)}premultiply(o){return this.multiplyMatrices(o,this)}multiplyMatrices(o,c){const d=o.elements,p=c.elements,y=this.elements,w=d[0],M=d[3],R=d[6],A=d[1],N=d[4],U=d[7],q=d[2],Y=d[5],ne=d[8],le=p[0],Se=p[3],re=p[6],K=p[1],Oe=p[4],xe=p[7],ze=p[2],$e=p[5],ht=p[8];return y[0]=w*le+M*K+R*ze,y[3]=w*Se+M*Oe+R*$e,y[6]=w*re+M*xe+R*ht,y[1]=A*le+N*K+U*ze,y[4]=A*Se+N*Oe+U*$e,y[7]=A*re+N*xe+U*ht,y[2]=q*le+Y*K+ne*ze,y[5]=q*Se+Y*Oe+ne*$e,y[8]=q*re+Y*xe+ne*ht,this}multiplyScalar(o){const c=this.elements;return c[0]*=o,c[3]*=o,c[6]*=o,c[1]*=o,c[4]*=o,c[7]*=o,c[2]*=o,c[5]*=o,c[8]*=o,this}determinant(){const o=this.elements,c=o[0],d=o[1],p=o[2],y=o[3],w=o[4],M=o[5],R=o[6],A=o[7],N=o[8];return c*w*N-c*M*A-d*y*N+d*M*R+p*y*A-p*w*R}invert(){const o=this.elements,c=o[0],d=o[1],p=o[2],y=o[3],w=o[4],M=o[5],R=o[6],A=o[7],N=o[8],U=N*w-M*A,q=M*R-N*y,Y=A*y-w*R,ne=c*U+d*q+p*Y;if(0===ne)return this.set(0,0,0,0,0,0,0,0,0);const le=1/ne;return o[0]=U*le,o[1]=(p*A-N*d)*le,o[2]=(M*d-p*w)*le,o[3]=q*le,o[4]=(N*c-p*R)*le,o[5]=(p*y-M*c)*le,o[6]=Y*le,o[7]=(d*R-A*c)*le,o[8]=(w*c-d*y)*le,this}transpose(){let o;const c=this.elements;return o=c[1],c[1]=c[3],c[3]=o,o=c[2],c[2]=c[6],c[6]=o,o=c[5],c[5]=c[7],c[7]=o,this}getNormalMatrix(o){return this.setFromMatrix4(o).invert().transpose()}transposeIntoArray(o){const c=this.elements;return o[0]=c[0],o[1]=c[3],o[2]=c[6],o[3]=c[1],o[4]=c[4],o[5]=c[7],o[6]=c[2],o[7]=c[5],o[8]=c[8],this}setUvTransform(o,c,d,p,y,w,M){const R=Math.cos(y),A=Math.sin(y);return this.set(d*R,d*A,-d*(R*w+A*M)+w+o,-p*A,p*R,-p*(-A*w+R*M)+M+c,0,0,1),this}scale(o,c){const d=this.elements;return d[0]*=o,d[3]*=o,d[6]*=o,d[1]*=c,d[4]*=c,d[7]*=c,this}rotate(o){const c=Math.cos(o),d=Math.sin(o),p=this.elements,y=p[0],w=p[3],M=p[6],R=p[1],A=p[4],N=p[7];return p[0]=c*y+d*R,p[3]=c*w+d*A,p[6]=c*M+d*N,p[1]=-d*y+c*R,p[4]=-d*w+c*A,p[7]=-d*M+c*N,this}translate(o,c){const d=this.elements;return d[0]+=o*d[2],d[3]+=o*d[5],d[6]+=o*d[8],d[1]+=c*d[2],d[4]+=c*d[5],d[7]+=c*d[8],this}equals(o){const c=this.elements,d=o.elements;for(let p=0;p<9;p++)if(c[p]!==d[p])return!1;return!0}fromArray(o,c=0){for(let d=0;d<9;d++)this.elements[d]=o[d+c];return this}toArray(o=[],c=0){const d=this.elements;return o[c]=d[0],o[c+1]=d[1],o[c+2]=d[2],o[c+3]=d[3],o[c+4]=d[4],o[c+5]=d[5],o[c+6]=d[6],o[c+7]=d[7],o[c+8]=d[8],o}clone(){return(new this.constructor).fromArray(this.elements)}}function pl(g){for(let o=g.length-1;o>=0;--o)if(g[o]>65535)return!0;return!1}Hn.prototype.isMatrix3=!0;const il={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function ml(g,o){return new il[g](o)}function Bl(g){return document.createElementNS("http://www.w3.org/1999/xhtml",g)}const Vu={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Bc={h:0,s:0,l:0},Nc={h:0,s:0,l:0};function rp(g,o,c){return c<0&&(c+=1),c>1&&(c-=1),c<1/6?g+6*(o-g)*c:c<.5?o:c<2/3?g+6*(o-g)*(2/3-c):g}function Nl(g){return g<.04045?.0773993808*g:Math.pow(.9478672986*g+.0521327014,2.4)}function Wa(g){return g<.0031308?12.92*g:1.055*Math.pow(g,.41666)-.055}let gl,cn=(()=>{class g{constructor(c,d,p){return void 0===d&&void 0===p?this.set(c):this.setRGB(c,d,p)}set(c){return c&&c.isColor?this.copy(c):"number"==typeof c?this.setHex(c):"string"==typeof c&&this.setStyle(c),this}setScalar(c){return this.r=c,this.g=c,this.b=c,this}setHex(c){return c=Math.floor(c),this.r=(c>>16&255)/255,this.g=(c>>8&255)/255,this.b=(255&c)/255,this}setRGB(c,d,p){return this.r=c,this.g=d,this.b=p,this}setHSL(c,d,p){if(c=uv(c,1),d=Ur(d,0,1),p=Ur(p,0,1),0===d)this.r=this.g=this.b=p;else{const y=p<=.5?p*(1+d):p+d-p*d,w=2*p-y;this.r=rp(w,y,c+1/3),this.g=rp(w,y,c),this.b=rp(w,y,c-1/3)}return this}setStyle(c){function d(y){void 0!==y&&parseFloat(y)<1&&console.warn("THREE.Color: Alpha component of "+c+" will be ignored.")}let p;if(p=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(c)){let y;const M=p[2];switch(p[1]){case"rgb":case"rgba":if(y=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(M))return this.r=Math.min(255,parseInt(y[1],10))/255,this.g=Math.min(255,parseInt(y[2],10))/255,this.b=Math.min(255,parseInt(y[3],10))/255,d(y[4]),this;if(y=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(M))return this.r=Math.min(100,parseInt(y[1],10))/100,this.g=Math.min(100,parseInt(y[2],10))/100,this.b=Math.min(100,parseInt(y[3],10))/100,d(y[4]),this;break;case"hsl":case"hsla":if(y=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(M)){const R=parseFloat(y[1])/360,A=parseInt(y[2],10)/100,N=parseInt(y[3],10)/100;return d(y[4]),this.setHSL(R,A,N)}}}else if(p=/^\#([A-Fa-f\d]+)$/.exec(c)){const y=p[1],w=y.length;if(3===w)return this.r=parseInt(y.charAt(0)+y.charAt(0),16)/255,this.g=parseInt(y.charAt(1)+y.charAt(1),16)/255,this.b=parseInt(y.charAt(2)+y.charAt(2),16)/255,this;if(6===w)return this.r=parseInt(y.charAt(0)+y.charAt(1),16)/255,this.g=parseInt(y.charAt(2)+y.charAt(3),16)/255,this.b=parseInt(y.charAt(4)+y.charAt(5),16)/255,this}return c&&c.length>0?this.setColorName(c):this}setColorName(c){const d=Vu[c.toLowerCase()];return void 0!==d?this.setHex(d):console.warn("THREE.Color: Unknown color "+c),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(c){return this.r=c.r,this.g=c.g,this.b=c.b,this}copySRGBToLinear(c){return this.r=Nl(c.r),this.g=Nl(c.g),this.b=Nl(c.b),this}copyLinearToSRGB(c){return this.r=Wa(c.r),this.g=Wa(c.g),this.b=Wa(c.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(c){const d=this.r,p=this.g,y=this.b,w=Math.max(d,p,y),M=Math.min(d,p,y);let R,A;const N=(M+w)/2;if(M===w)R=0,A=0;else{const U=w-M;switch(A=N<=.5?U/(w+M):U/(2-w-M),w){case d:R=(p-y)/U+(p<y?6:0);break;case p:R=(y-d)/U+2;break;case y:R=(d-p)/U+4}R/=6}return c.h=R,c.s=A,c.l=N,c}getStyle(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}offsetHSL(c,d,p){return this.getHSL(Bc),Bc.h+=c,Bc.s+=d,Bc.l+=p,this.setHSL(Bc.h,Bc.s,Bc.l),this}add(c){return this.r+=c.r,this.g+=c.g,this.b+=c.b,this}addColors(c,d){return this.r=c.r+d.r,this.g=c.g+d.g,this.b=c.b+d.b,this}addScalar(c){return this.r+=c,this.g+=c,this.b+=c,this}sub(c){return this.r=Math.max(0,this.r-c.r),this.g=Math.max(0,this.g-c.g),this.b=Math.max(0,this.b-c.b),this}multiply(c){return this.r*=c.r,this.g*=c.g,this.b*=c.b,this}multiplyScalar(c){return this.r*=c,this.g*=c,this.b*=c,this}lerp(c,d){return this.r+=(c.r-this.r)*d,this.g+=(c.g-this.g)*d,this.b+=(c.b-this.b)*d,this}lerpColors(c,d,p){return this.r=c.r+(d.r-c.r)*p,this.g=c.g+(d.g-c.g)*p,this.b=c.b+(d.b-c.b)*p,this}lerpHSL(c,d){this.getHSL(Bc),c.getHSL(Nc);const p=Gs(Bc.h,Nc.h,d),y=Gs(Bc.s,Nc.s,d),w=Gs(Bc.l,Nc.l,d);return this.setHSL(p,y,w),this}equals(c){return c.r===this.r&&c.g===this.g&&c.b===this.b}fromArray(c,d=0){return this.r=c[d],this.g=c[d+1],this.b=c[d+2],this}toArray(c=[],d=0){return c[d]=this.r,c[d+1]=this.g,c[d+2]=this.b,c}fromBufferAttribute(c,d){return this.r=c.getX(d),this.g=c.getY(d),this.b=c.getZ(d),!0===c.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}return g.NAMES=Vu,g})();cn.prototype.isColor=!0,cn.prototype.r=1,cn.prototype.g=1,cn.prototype.b=1;class Yi{static getDataURL(o){if(/^data:/i.test(o.src)||"undefined"==typeof HTMLCanvasElement)return o.src;let c;if(o instanceof HTMLCanvasElement)c=o;else{void 0===gl&&(gl=Bl("canvas")),gl.width=o.width,gl.height=o.height;const d=gl.getContext("2d");o instanceof ImageData?d.putImageData(o,0,0):d.drawImage(o,0,0,o.width,o.height),c=gl}return c.width>2048||c.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",o),c.toDataURL("image/jpeg",.6)):c.toDataURL("image/png")}static sRGBToLinear(o){if("undefined"!=typeof HTMLImageElement&&o instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&o instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&o instanceof ImageBitmap){const c=Bl("canvas");c.width=o.width,c.height=o.height;const d=c.getContext("2d");d.drawImage(o,0,0,o.width,o.height);const p=d.getImageData(0,0,o.width,o.height),y=p.data;for(let w=0;w<y.length;w++)y[w]=255*Nl(y[w]/255);return d.putImageData(p,0,0),c}if(o.data){const c=o.data.slice(0);for(let d=0;d<c.length;d++)c[d]=c instanceof Uint8Array||c instanceof Uint8ClampedArray?Math.floor(255*Nl(c[d]/255)):Nl(c[d]);return{data:c,width:o.width,height:o.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),o}}let us=0;class Jr extends Fl{constructor(o=Jr.DEFAULT_IMAGE,c=Jr.DEFAULT_MAPPING,d=Lo,p=Lo,y=tt,w=Gi,M=Ua,R=Xn,A=1,N=od){super(),Object.defineProperty(this,"id",{value:us++}),this.uuid=tl(),this.name="",this.image=o,this.mipmaps=[],this.mapping=c,this.wrapS=d,this.wrapT=p,this.magFilter=y,this.minFilter=w,this.anisotropy=A,this.format=M,this.internalFormat=null,this.type=R,this.offset=new Be(0,0),this.repeat=new Be(1,1),this.center=new Be(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Hn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=N,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(o){return this.name=o.name,this.image=o.image,this.mipmaps=o.mipmaps.slice(0),this.mapping=o.mapping,this.wrapS=o.wrapS,this.wrapT=o.wrapT,this.magFilter=o.magFilter,this.minFilter=o.minFilter,this.anisotropy=o.anisotropy,this.format=o.format,this.internalFormat=o.internalFormat,this.type=o.type,this.offset.copy(o.offset),this.repeat.copy(o.repeat),this.center.copy(o.center),this.rotation=o.rotation,this.matrixAutoUpdate=o.matrixAutoUpdate,this.matrix.copy(o.matrix),this.generateMipmaps=o.generateMipmaps,this.premultiplyAlpha=o.premultiplyAlpha,this.flipY=o.flipY,this.unpackAlignment=o.unpackAlignment,this.encoding=o.encoding,this.userData=JSON.parse(JSON.stringify(o.userData)),this}toJSON(o){const c=void 0===o||"string"==typeof o;if(!c&&void 0!==o.textures[this.uuid])return o.textures[this.uuid];const d={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){const p=this.image;if(void 0===p.uuid&&(p.uuid=tl()),!c&&void 0===o.images[p.uuid]){let y;if(Array.isArray(p)){y=[];for(let w=0,M=p.length;w<M;w++)y.push(_l(p[w].isDataTexture?p[w].image:p[w]))}else y=_l(p);o.images[p.uuid]={uuid:p.uuid,url:y}}d.image=p.uuid}return"{}"!==JSON.stringify(this.userData)&&(d.userData=this.userData),c||(o.textures[this.uuid]=d),d}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(o){if(300!==this.mapping)return o;if(o.applyMatrix3(this.matrix),o.x<0||o.x>1)switch(this.wrapS){case oa:o.x=o.x-Math.floor(o.x);break;case Lo:o.x=o.x<0?0:1;break;case no:o.x=1===Math.abs(Math.floor(o.x)%2)?Math.ceil(o.x)-o.x:o.x-Math.floor(o.x)}if(o.y<0||o.y>1)switch(this.wrapT){case oa:o.y=o.y-Math.floor(o.y);break;case Lo:o.y=o.y<0?0:1;break;case no:o.y=1===Math.abs(Math.floor(o.y)%2)?Math.ceil(o.y)-o.y:o.y-Math.floor(o.y)}return this.flipY&&(o.y=1-o.y),o}set needsUpdate(o){!0===o&&this.version++}}function _l(g){return"undefined"!=typeof HTMLImageElement&&g instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&g instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&g instanceof ImageBitmap?Yi.getDataURL(g):g.data?{data:Array.prototype.slice.call(g.data),width:g.width,height:g.height,type:g.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}Jr.DEFAULT_IMAGE=void 0,Jr.DEFAULT_MAPPING=300,Jr.prototype.isTexture=!0;class Es{constructor(o=0,c=0,d=0,p=1){this.x=o,this.y=c,this.z=d,this.w=p}get width(){return this.z}set width(o){this.z=o}get height(){return this.w}set height(o){this.w=o}set(o,c,d,p){return this.x=o,this.y=c,this.z=d,this.w=p,this}setScalar(o){return this.x=o,this.y=o,this.z=o,this.w=o,this}setX(o){return this.x=o,this}setY(o){return this.y=o,this}setZ(o){return this.z=o,this}setW(o){return this.w=o,this}setComponent(o,c){switch(o){case 0:this.x=c;break;case 1:this.y=c;break;case 2:this.z=c;break;case 3:this.w=c;break;default:throw new Error("index is out of range: "+o)}return this}getComponent(o){switch(o){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+o)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(o){return this.x=o.x,this.y=o.y,this.z=o.z,this.w=void 0!==o.w?o.w:1,this}add(o,c){return void 0!==c?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(o,c)):(this.x+=o.x,this.y+=o.y,this.z+=o.z,this.w+=o.w,this)}addScalar(o){return this.x+=o,this.y+=o,this.z+=o,this.w+=o,this}addVectors(o,c){return this.x=o.x+c.x,this.y=o.y+c.y,this.z=o.z+c.z,this.w=o.w+c.w,this}addScaledVector(o,c){return this.x+=o.x*c,this.y+=o.y*c,this.z+=o.z*c,this.w+=o.w*c,this}sub(o,c){return void 0!==c?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(o,c)):(this.x-=o.x,this.y-=o.y,this.z-=o.z,this.w-=o.w,this)}subScalar(o){return this.x-=o,this.y-=o,this.z-=o,this.w-=o,this}subVectors(o,c){return this.x=o.x-c.x,this.y=o.y-c.y,this.z=o.z-c.z,this.w=o.w-c.w,this}multiply(o){return this.x*=o.x,this.y*=o.y,this.z*=o.z,this.w*=o.w,this}multiplyScalar(o){return this.x*=o,this.y*=o,this.z*=o,this.w*=o,this}applyMatrix4(o){const c=this.x,d=this.y,p=this.z,y=this.w,w=o.elements;return this.x=w[0]*c+w[4]*d+w[8]*p+w[12]*y,this.y=w[1]*c+w[5]*d+w[9]*p+w[13]*y,this.z=w[2]*c+w[6]*d+w[10]*p+w[14]*y,this.w=w[3]*c+w[7]*d+w[11]*p+w[15]*y,this}divideScalar(o){return this.multiplyScalar(1/o)}setAxisAngleFromQuaternion(o){this.w=2*Math.acos(o.w);const c=Math.sqrt(1-o.w*o.w);return c<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=o.x/c,this.y=o.y/c,this.z=o.z/c),this}setAxisAngleFromRotationMatrix(o){let c,d,p,y;const R=o.elements,A=R[0],N=R[4],U=R[8],q=R[1],Y=R[5],ne=R[9],le=R[2],Se=R[6],re=R[10];if(Math.abs(N-q)<.01&&Math.abs(U-le)<.01&&Math.abs(ne-Se)<.01){if(Math.abs(N+q)<.1&&Math.abs(U+le)<.1&&Math.abs(ne+Se)<.1&&Math.abs(A+Y+re-3)<.1)return this.set(1,0,0,0),this;c=Math.PI;const Oe=(A+1)/2,xe=(Y+1)/2,ze=(re+1)/2,$e=(N+q)/4,ht=(U+le)/4,Et=(ne+Se)/4;return Oe>xe&&Oe>ze?Oe<.01?(d=0,p=.707106781,y=.707106781):(d=Math.sqrt(Oe),p=$e/d,y=ht/d):xe>ze?xe<.01?(d=.707106781,p=0,y=.707106781):(p=Math.sqrt(xe),d=$e/p,y=Et/p):ze<.01?(d=.707106781,p=.707106781,y=0):(y=Math.sqrt(ze),d=ht/y,p=Et/y),this.set(d,p,y,c),this}let K=Math.sqrt((Se-ne)*(Se-ne)+(U-le)*(U-le)+(q-N)*(q-N));return Math.abs(K)<.001&&(K=1),this.x=(Se-ne)/K,this.y=(U-le)/K,this.z=(q-N)/K,this.w=Math.acos((A+Y+re-1)/2),this}min(o){return this.x=Math.min(this.x,o.x),this.y=Math.min(this.y,o.y),this.z=Math.min(this.z,o.z),this.w=Math.min(this.w,o.w),this}max(o){return this.x=Math.max(this.x,o.x),this.y=Math.max(this.y,o.y),this.z=Math.max(this.z,o.z),this.w=Math.max(this.w,o.w),this}clamp(o,c){return this.x=Math.max(o.x,Math.min(c.x,this.x)),this.y=Math.max(o.y,Math.min(c.y,this.y)),this.z=Math.max(o.z,Math.min(c.z,this.z)),this.w=Math.max(o.w,Math.min(c.w,this.w)),this}clampScalar(o,c){return this.x=Math.max(o,Math.min(c,this.x)),this.y=Math.max(o,Math.min(c,this.y)),this.z=Math.max(o,Math.min(c,this.z)),this.w=Math.max(o,Math.min(c,this.w)),this}clampLength(o,c){const d=this.length();return this.divideScalar(d||1).multiplyScalar(Math.max(o,Math.min(c,d)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(o){return this.x*o.x+this.y*o.y+this.z*o.z+this.w*o.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(o){return this.normalize().multiplyScalar(o)}lerp(o,c){return this.x+=(o.x-this.x)*c,this.y+=(o.y-this.y)*c,this.z+=(o.z-this.z)*c,this.w+=(o.w-this.w)*c,this}lerpVectors(o,c,d){return this.x=o.x+(c.x-o.x)*d,this.y=o.y+(c.y-o.y)*d,this.z=o.z+(c.z-o.z)*d,this.w=o.w+(c.w-o.w)*d,this}equals(o){return o.x===this.x&&o.y===this.y&&o.z===this.z&&o.w===this.w}fromArray(o,c=0){return this.x=o[c],this.y=o[c+1],this.z=o[c+2],this.w=o[c+3],this}toArray(o=[],c=0){return o[c]=this.x,o[c+1]=this.y,o[c+2]=this.z,o[c+3]=this.w,o}fromBufferAttribute(o,c,d){return void 0!==d&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=o.getX(c),this.y=o.getY(c),this.z=o.getZ(c),this.w=o.getW(c),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}Es.prototype.isVector4=!0;class bs extends Fl{constructor(o,c,d={}){super(),this.width=o,this.height=c,this.depth=1,this.scissor=new Es(0,0,o,c),this.scissorTest=!1,this.viewport=new Es(0,0,o,c),this.texture=new Jr(void 0,d.mapping,d.wrapS,d.wrapT,d.magFilter,d.minFilter,d.format,d.type,d.anisotropy,d.encoding),this.texture.isRenderTargetTexture=!0,this.texture.image={width:o,height:c,depth:1},this.texture.generateMipmaps=void 0!==d.generateMipmaps&&d.generateMipmaps,this.texture.internalFormat=void 0!==d.internalFormat?d.internalFormat:null,this.texture.minFilter=void 0!==d.minFilter?d.minFilter:tt,this.depthBuffer=void 0===d.depthBuffer||d.depthBuffer,this.stencilBuffer=void 0!==d.stencilBuffer&&d.stencilBuffer,this.depthTexture=void 0!==d.depthTexture?d.depthTexture:null}setTexture(o){o.image={width:this.width,height:this.height,depth:this.depth},this.texture=o}setSize(o,c,d=1){(this.width!==o||this.height!==c||this.depth!==d)&&(this.width=o,this.height=c,this.depth=d,this.texture.image.width=o,this.texture.image.height=c,this.texture.image.depth=d,this.dispose()),this.viewport.set(0,0,o,c),this.scissor.set(0,0,o,c)}clone(){return(new this.constructor).copy(this)}copy(o){return this.width=o.width,this.height=o.height,this.depth=o.depth,this.viewport.copy(o.viewport),this.texture=o.texture.clone(),this.texture.image=Object.assign({},o.texture.image),this.depthBuffer=o.depthBuffer,this.stencilBuffer=o.stencilBuffer,this.depthTexture=o.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}bs.prototype.isWebGLRenderTarget=!0;class hd extends bs{constructor(o,c,d){super(o,c);const p=this.texture;this.texture=[];for(let y=0;y<d;y++)this.texture[y]=p.clone()}setSize(o,c,d=1){if(this.width!==o||this.height!==c||this.depth!==d){this.width=o,this.height=c,this.depth=d;for(let p=0,y=this.texture.length;p<y;p++)this.texture[p].image.width=o,this.texture[p].image.height=c,this.texture[p].image.depth=d;this.dispose()}return this.viewport.set(0,0,o,c),this.scissor.set(0,0,o,c),this}copy(o){this.dispose(),this.width=o.width,this.height=o.height,this.depth=o.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=o.depthBuffer,this.stencilBuffer=o.stencilBuffer,this.depthTexture=o.depthTexture,this.texture.length=0;for(let c=0,d=o.texture.length;c<d;c++)this.texture[c]=o.texture[c].clone();return this}}hd.prototype.isWebGLMultipleRenderTargets=!0;class ho extends bs{constructor(o,c,d={}){super(o,c,d),this.samples=4,this.ignoreDepthForMultisampleCopy=void 0===d.ignoreDepth||d.ignoreDepth,this.useRenderToTexture=void 0!==d.useRenderToTexture&&d.useRenderToTexture,this.useRenderbuffer=!1===this.useRenderToTexture}copy(o){return super.copy.call(this,o),this.samples=o.samples,this.useRenderToTexture=o.useRenderToTexture,this.useRenderbuffer=o.useRenderbuffer,this}}ho.prototype.isWebGLMultisampleRenderTarget=!0;class ua{constructor(o=0,c=0,d=0,p=1){this._x=o,this._y=c,this._z=d,this._w=p}static slerp(o,c,d,p){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),d.slerpQuaternions(o,c,p)}static slerpFlat(o,c,d,p,y,w,M){let R=d[p+0],A=d[p+1],N=d[p+2],U=d[p+3];const q=y[w+0],Y=y[w+1],ne=y[w+2],le=y[w+3];if(0===M)return o[c+0]=R,o[c+1]=A,o[c+2]=N,void(o[c+3]=U);if(1===M)return o[c+0]=q,o[c+1]=Y,o[c+2]=ne,void(o[c+3]=le);if(U!==le||R!==q||A!==Y||N!==ne){let Se=1-M;const re=R*q+A*Y+N*ne+U*le,K=re>=0?1:-1,Oe=1-re*re;if(Oe>Number.EPSILON){const ze=Math.sqrt(Oe),$e=Math.atan2(ze,re*K);Se=Math.sin(Se*$e)/ze,M=Math.sin(M*$e)/ze}const xe=M*K;if(R=R*Se+q*xe,A=A*Se+Y*xe,N=N*Se+ne*xe,U=U*Se+le*xe,Se===1-M){const ze=1/Math.sqrt(R*R+A*A+N*N+U*U);R*=ze,A*=ze,N*=ze,U*=ze}}o[c]=R,o[c+1]=A,o[c+2]=N,o[c+3]=U}static multiplyQuaternionsFlat(o,c,d,p,y,w){const M=d[p],R=d[p+1],A=d[p+2],N=d[p+3],U=y[w],q=y[w+1],Y=y[w+2],ne=y[w+3];return o[c]=M*ne+N*U+R*Y-A*q,o[c+1]=R*ne+N*q+A*U-M*Y,o[c+2]=A*ne+N*Y+M*q-R*U,o[c+3]=N*ne-M*U-R*q-A*Y,o}get x(){return this._x}set x(o){this._x=o,this._onChangeCallback()}get y(){return this._y}set y(o){this._y=o,this._onChangeCallback()}get z(){return this._z}set z(o){this._z=o,this._onChangeCallback()}get w(){return this._w}set w(o){this._w=o,this._onChangeCallback()}set(o,c,d,p){return this._x=o,this._y=c,this._z=d,this._w=p,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(o){return this._x=o.x,this._y=o.y,this._z=o.z,this._w=o.w,this._onChangeCallback(),this}setFromEuler(o,c){if(!o||!o.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const d=o._x,p=o._y,y=o._z,w=o._order,M=Math.cos,R=Math.sin,A=M(d/2),N=M(p/2),U=M(y/2),q=R(d/2),Y=R(p/2),ne=R(y/2);switch(w){case"XYZ":this._x=q*N*U+A*Y*ne,this._y=A*Y*U-q*N*ne,this._z=A*N*ne+q*Y*U,this._w=A*N*U-q*Y*ne;break;case"YXZ":this._x=q*N*U+A*Y*ne,this._y=A*Y*U-q*N*ne,this._z=A*N*ne-q*Y*U,this._w=A*N*U+q*Y*ne;break;case"ZXY":this._x=q*N*U-A*Y*ne,this._y=A*Y*U+q*N*ne,this._z=A*N*ne+q*Y*U,this._w=A*N*U-q*Y*ne;break;case"ZYX":this._x=q*N*U-A*Y*ne,this._y=A*Y*U+q*N*ne,this._z=A*N*ne-q*Y*U,this._w=A*N*U+q*Y*ne;break;case"YZX":this._x=q*N*U+A*Y*ne,this._y=A*Y*U+q*N*ne,this._z=A*N*ne-q*Y*U,this._w=A*N*U-q*Y*ne;break;case"XZY":this._x=q*N*U-A*Y*ne,this._y=A*Y*U-q*N*ne,this._z=A*N*ne+q*Y*U,this._w=A*N*U+q*Y*ne;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+w)}return!1!==c&&this._onChangeCallback(),this}setFromAxisAngle(o,c){const d=c/2,p=Math.sin(d);return this._x=o.x*p,this._y=o.y*p,this._z=o.z*p,this._w=Math.cos(d),this._onChangeCallback(),this}setFromRotationMatrix(o){const c=o.elements,d=c[0],p=c[4],y=c[8],w=c[1],M=c[5],R=c[9],A=c[2],N=c[6],U=c[10],q=d+M+U;if(q>0){const Y=.5/Math.sqrt(q+1);this._w=.25/Y,this._x=(N-R)*Y,this._y=(y-A)*Y,this._z=(w-p)*Y}else if(d>M&&d>U){const Y=2*Math.sqrt(1+d-M-U);this._w=(N-R)/Y,this._x=.25*Y,this._y=(p+w)/Y,this._z=(y+A)/Y}else if(M>U){const Y=2*Math.sqrt(1+M-d-U);this._w=(y-A)/Y,this._x=(p+w)/Y,this._y=.25*Y,this._z=(R+N)/Y}else{const Y=2*Math.sqrt(1+U-d-M);this._w=(w-p)/Y,this._x=(y+A)/Y,this._y=(R+N)/Y,this._z=.25*Y}return this._onChangeCallback(),this}setFromUnitVectors(o,c){let d=o.dot(c)+1;return d<Number.EPSILON?(d=0,Math.abs(o.x)>Math.abs(o.z)?(this._x=-o.y,this._y=o.x,this._z=0,this._w=d):(this._x=0,this._y=-o.z,this._z=o.y,this._w=d)):(this._x=o.y*c.z-o.z*c.y,this._y=o.z*c.x-o.x*c.z,this._z=o.x*c.y-o.y*c.x,this._w=d),this.normalize()}angleTo(o){return 2*Math.acos(Math.abs(Ur(this.dot(o),-1,1)))}rotateTowards(o,c){const d=this.angleTo(o);if(0===d)return this;const p=Math.min(1,c/d);return this.slerp(o,p),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(o){return this._x*o._x+this._y*o._y+this._z*o._z+this._w*o._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let o=this.length();return 0===o?(this._x=0,this._y=0,this._z=0,this._w=1):(o=1/o,this._x=this._x*o,this._y=this._y*o,this._z=this._z*o,this._w=this._w*o),this._onChangeCallback(),this}multiply(o,c){return void 0!==c?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(o,c)):this.multiplyQuaternions(this,o)}premultiply(o){return this.multiplyQuaternions(o,this)}multiplyQuaternions(o,c){const d=o._x,p=o._y,y=o._z,w=o._w,M=c._x,R=c._y,A=c._z,N=c._w;return this._x=d*N+w*M+p*A-y*R,this._y=p*N+w*R+y*M-d*A,this._z=y*N+w*A+d*R-p*M,this._w=w*N-d*M-p*R-y*A,this._onChangeCallback(),this}slerp(o,c){if(0===c)return this;if(1===c)return this.copy(o);const d=this._x,p=this._y,y=this._z,w=this._w;let M=w*o._w+d*o._x+p*o._y+y*o._z;if(M<0?(this._w=-o._w,this._x=-o._x,this._y=-o._y,this._z=-o._z,M=-M):this.copy(o),M>=1)return this._w=w,this._x=d,this._y=p,this._z=y,this;const R=1-M*M;if(R<=Number.EPSILON){const Y=1-c;return this._w=Y*w+c*this._w,this._x=Y*d+c*this._x,this._y=Y*p+c*this._y,this._z=Y*y+c*this._z,this.normalize(),this._onChangeCallback(),this}const A=Math.sqrt(R),N=Math.atan2(A,M),U=Math.sin((1-c)*N)/A,q=Math.sin(c*N)/A;return this._w=w*U+this._w*q,this._x=d*U+this._x*q,this._y=p*U+this._y*q,this._z=y*U+this._z*q,this._onChangeCallback(),this}slerpQuaternions(o,c,d){return this.copy(o).slerp(c,d)}random(){const o=Math.random(),c=Math.sqrt(1-o),d=Math.sqrt(o),p=2*Math.PI*Math.random(),y=2*Math.PI*Math.random();return this.set(c*Math.cos(p),d*Math.sin(y),d*Math.cos(y),c*Math.sin(p))}equals(o){return o._x===this._x&&o._y===this._y&&o._z===this._z&&o._w===this._w}fromArray(o,c=0){return this._x=o[c],this._y=o[c+1],this._z=o[c+2],this._w=o[c+3],this._onChangeCallback(),this}toArray(o=[],c=0){return o[c]=this._x,o[c+1]=this._y,o[c+2]=this._z,o[c+3]=this._w,o}fromBufferAttribute(o,c){return this._x=o.getX(c),this._y=o.getY(c),this._z=o.getZ(c),this._w=o.getW(c),this}_onChange(o){return this._onChangeCallback=o,this}_onChangeCallback(){}}ua.prototype.isQuaternion=!0;class Ne{constructor(o=0,c=0,d=0){this.x=o,this.y=c,this.z=d}set(o,c,d){return void 0===d&&(d=this.z),this.x=o,this.y=c,this.z=d,this}setScalar(o){return this.x=o,this.y=o,this.z=o,this}setX(o){return this.x=o,this}setY(o){return this.y=o,this}setZ(o){return this.z=o,this}setComponent(o,c){switch(o){case 0:this.x=c;break;case 1:this.y=c;break;case 2:this.z=c;break;default:throw new Error("index is out of range: "+o)}return this}getComponent(o){switch(o){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+o)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(o){return this.x=o.x,this.y=o.y,this.z=o.z,this}add(o,c){return void 0!==c?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(o,c)):(this.x+=o.x,this.y+=o.y,this.z+=o.z,this)}addScalar(o){return this.x+=o,this.y+=o,this.z+=o,this}addVectors(o,c){return this.x=o.x+c.x,this.y=o.y+c.y,this.z=o.z+c.z,this}addScaledVector(o,c){return this.x+=o.x*c,this.y+=o.y*c,this.z+=o.z*c,this}sub(o,c){return void 0!==c?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(o,c)):(this.x-=o.x,this.y-=o.y,this.z-=o.z,this)}subScalar(o){return this.x-=o,this.y-=o,this.z-=o,this}subVectors(o,c){return this.x=o.x-c.x,this.y=o.y-c.y,this.z=o.z-c.z,this}multiply(o,c){return void 0!==c?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(o,c)):(this.x*=o.x,this.y*=o.y,this.z*=o.z,this)}multiplyScalar(o){return this.x*=o,this.y*=o,this.z*=o,this}multiplyVectors(o,c){return this.x=o.x*c.x,this.y=o.y*c.y,this.z=o.z*c.z,this}applyEuler(o){return o&&o.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(sp.setFromEuler(o))}applyAxisAngle(o,c){return this.applyQuaternion(sp.setFromAxisAngle(o,c))}applyMatrix3(o){const c=this.x,d=this.y,p=this.z,y=o.elements;return this.x=y[0]*c+y[3]*d+y[6]*p,this.y=y[1]*c+y[4]*d+y[7]*p,this.z=y[2]*c+y[5]*d+y[8]*p,this}applyNormalMatrix(o){return this.applyMatrix3(o).normalize()}applyMatrix4(o){const c=this.x,d=this.y,p=this.z,y=o.elements,w=1/(y[3]*c+y[7]*d+y[11]*p+y[15]);return this.x=(y[0]*c+y[4]*d+y[8]*p+y[12])*w,this.y=(y[1]*c+y[5]*d+y[9]*p+y[13])*w,this.z=(y[2]*c+y[6]*d+y[10]*p+y[14])*w,this}applyQuaternion(o){const c=this.x,d=this.y,p=this.z,y=o.x,w=o.y,M=o.z,R=o.w,A=R*c+w*p-M*d,N=R*d+M*c-y*p,U=R*p+y*d-w*c,q=-y*c-w*d-M*p;return this.x=A*R+q*-y+N*-M-U*-w,this.y=N*R+q*-w+U*-y-A*-M,this.z=U*R+q*-M+A*-w-N*-y,this}project(o){return this.applyMatrix4(o.matrixWorldInverse).applyMatrix4(o.projectionMatrix)}unproject(o){return this.applyMatrix4(o.projectionMatrixInverse).applyMatrix4(o.matrixWorld)}transformDirection(o){const c=this.x,d=this.y,p=this.z,y=o.elements;return this.x=y[0]*c+y[4]*d+y[8]*p,this.y=y[1]*c+y[5]*d+y[9]*p,this.z=y[2]*c+y[6]*d+y[10]*p,this.normalize()}divide(o){return this.x/=o.x,this.y/=o.y,this.z/=o.z,this}divideScalar(o){return this.multiplyScalar(1/o)}min(o){return this.x=Math.min(this.x,o.x),this.y=Math.min(this.y,o.y),this.z=Math.min(this.z,o.z),this}max(o){return this.x=Math.max(this.x,o.x),this.y=Math.max(this.y,o.y),this.z=Math.max(this.z,o.z),this}clamp(o,c){return this.x=Math.max(o.x,Math.min(c.x,this.x)),this.y=Math.max(o.y,Math.min(c.y,this.y)),this.z=Math.max(o.z,Math.min(c.z,this.z)),this}clampScalar(o,c){return this.x=Math.max(o,Math.min(c,this.x)),this.y=Math.max(o,Math.min(c,this.y)),this.z=Math.max(o,Math.min(c,this.z)),this}clampLength(o,c){const d=this.length();return this.divideScalar(d||1).multiplyScalar(Math.max(o,Math.min(c,d)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(o){return this.x*o.x+this.y*o.y+this.z*o.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(o){return this.normalize().multiplyScalar(o)}lerp(o,c){return this.x+=(o.x-this.x)*c,this.y+=(o.y-this.y)*c,this.z+=(o.z-this.z)*c,this}lerpVectors(o,c,d){return this.x=o.x+(c.x-o.x)*d,this.y=o.y+(c.y-o.y)*d,this.z=o.z+(c.z-o.z)*d,this}cross(o,c){return void 0!==c?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(o,c)):this.crossVectors(this,o)}crossVectors(o,c){const d=o.x,p=o.y,y=o.z,w=c.x,M=c.y,R=c.z;return this.x=p*R-y*M,this.y=y*w-d*R,this.z=d*M-p*w,this}projectOnVector(o){const c=o.lengthSq();if(0===c)return this.set(0,0,0);const d=o.dot(this)/c;return this.copy(o).multiplyScalar(d)}projectOnPlane(o){return Gr.copy(this).projectOnVector(o),this.sub(Gr)}reflect(o){return this.sub(Gr.copy(o).multiplyScalar(2*this.dot(o)))}angleTo(o){const c=Math.sqrt(this.lengthSq()*o.lengthSq());if(0===c)return Math.PI/2;const d=this.dot(o)/c;return Math.acos(Ur(d,-1,1))}distanceTo(o){return Math.sqrt(this.distanceToSquared(o))}distanceToSquared(o){const c=this.x-o.x,d=this.y-o.y,p=this.z-o.z;return c*c+d*d+p*p}manhattanDistanceTo(o){return Math.abs(this.x-o.x)+Math.abs(this.y-o.y)+Math.abs(this.z-o.z)}setFromSpherical(o){return this.setFromSphericalCoords(o.radius,o.phi,o.theta)}setFromSphericalCoords(o,c,d){const p=Math.sin(c)*o;return this.x=p*Math.sin(d),this.y=Math.cos(c)*o,this.z=p*Math.cos(d),this}setFromCylindrical(o){return this.setFromCylindricalCoords(o.radius,o.theta,o.y)}setFromCylindricalCoords(o,c,d){return this.x=o*Math.sin(c),this.y=d,this.z=o*Math.cos(c),this}setFromMatrixPosition(o){const c=o.elements;return this.x=c[12],this.y=c[13],this.z=c[14],this}setFromMatrixScale(o){const c=this.setFromMatrixColumn(o,0).length(),d=this.setFromMatrixColumn(o,1).length(),p=this.setFromMatrixColumn(o,2).length();return this.x=c,this.y=d,this.z=p,this}setFromMatrixColumn(o,c){return this.fromArray(o.elements,4*c)}setFromMatrix3Column(o,c){return this.fromArray(o.elements,3*c)}equals(o){return o.x===this.x&&o.y===this.y&&o.z===this.z}fromArray(o,c=0){return this.x=o[c],this.y=o[c+1],this.z=o[c+2],this}toArray(o=[],c=0){return o[c]=this.x,o[c+1]=this.y,o[c+2]=this.z,o}fromBufferAttribute(o,c,d){return void 0!==d&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=o.getX(c),this.y=o.getY(c),this.z=o.getZ(c),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const o=2*(Math.random()-.5),c=Math.random()*Math.PI*2,d=Math.sqrt(1-o**2);return this.x=d*Math.cos(c),this.y=d*Math.sin(c),this.z=o,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}Ne.prototype.isVector3=!0;const Gr=new Ne,sp=new ua;class Ma{constructor(o=new Ne(1/0,1/0,1/0),c=new Ne(-1/0,-1/0,-1/0)){this.min=o,this.max=c}set(o,c){return this.min.copy(o),this.max.copy(c),this}setFromArray(o){let c=1/0,d=1/0,p=1/0,y=-1/0,w=-1/0,M=-1/0;for(let R=0,A=o.length;R<A;R+=3){const N=o[R],U=o[R+1],q=o[R+2];N<c&&(c=N),U<d&&(d=U),q<p&&(p=q),N>y&&(y=N),U>w&&(w=U),q>M&&(M=q)}return this.min.set(c,d,p),this.max.set(y,w,M),this}setFromBufferAttribute(o){let c=1/0,d=1/0,p=1/0,y=-1/0,w=-1/0,M=-1/0;for(let R=0,A=o.count;R<A;R++){const N=o.getX(R),U=o.getY(R),q=o.getZ(R);N<c&&(c=N),U<d&&(d=U),q<p&&(p=q),N>y&&(y=N),U>w&&(w=U),q>M&&(M=q)}return this.min.set(c,d,p),this.max.set(y,w,M),this}setFromPoints(o){this.makeEmpty();for(let c=0,d=o.length;c<d;c++)this.expandByPoint(o[c]);return this}setFromCenterAndSize(o,c){const d=xc.copy(c).multiplyScalar(.5);return this.min.copy(o).sub(d),this.max.copy(o).add(d),this}setFromObject(o,c=!1){return this.makeEmpty(),this.expandByObject(o,c)}clone(){return(new this.constructor).copy(this)}copy(o){return this.min.copy(o.min),this.max.copy(o.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(o){return this.isEmpty()?o.set(0,0,0):o.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(o){return this.isEmpty()?o.set(0,0,0):o.subVectors(this.max,this.min)}expandByPoint(o){return this.min.min(o),this.max.max(o),this}expandByVector(o){return this.min.sub(o),this.max.add(o),this}expandByScalar(o){return this.min.addScalar(-o),this.max.addScalar(o),this}expandByObject(o,c=!1){o.updateWorldMatrix(!1,!1);const d=o.geometry;if(void 0!==d)if(c&&null!=d.attributes&&void 0!==d.attributes.position){const y=d.attributes.position;for(let w=0,M=y.count;w<M;w++)xc.fromBufferAttribute(y,w).applyMatrix4(o.matrixWorld),this.expandByPoint(xc)}else null===d.boundingBox&&d.computeBoundingBox(),ja.copy(d.boundingBox),ja.applyMatrix4(o.matrixWorld),this.union(ja);const p=o.children;for(let y=0,w=p.length;y<w;y++)this.expandByObject(p[y],c);return this}containsPoint(o){return!(o.x<this.min.x||o.x>this.max.x||o.y<this.min.y||o.y>this.max.y||o.z<this.min.z||o.z>this.max.z)}containsBox(o){return this.min.x<=o.min.x&&o.max.x<=this.max.x&&this.min.y<=o.min.y&&o.max.y<=this.max.y&&this.min.z<=o.min.z&&o.max.z<=this.max.z}getParameter(o,c){return c.set((o.x-this.min.x)/(this.max.x-this.min.x),(o.y-this.min.y)/(this.max.y-this.min.y),(o.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(o){return!(o.max.x<this.min.x||o.min.x>this.max.x||o.max.y<this.min.y||o.min.y>this.max.y||o.max.z<this.min.z||o.min.z>this.max.z)}intersectsSphere(o){return this.clampPoint(o.center,xc),xc.distanceToSquared(o.center)<=o.radius*o.radius}intersectsPlane(o){let c,d;return o.normal.x>0?(c=o.normal.x*this.min.x,d=o.normal.x*this.max.x):(c=o.normal.x*this.max.x,d=o.normal.x*this.min.x),o.normal.y>0?(c+=o.normal.y*this.min.y,d+=o.normal.y*this.max.y):(c+=o.normal.y*this.max.y,d+=o.normal.y*this.min.y),o.normal.z>0?(c+=o.normal.z*this.min.z,d+=o.normal.z*this.max.z):(c+=o.normal.z*this.max.z,d+=o.normal.z*this.min.z),c<=-o.constant&&d>=-o.constant}intersectsTriangle(o){if(this.isEmpty())return!1;this.getCenter(Sc),oc.subVectors(this.max,Sc),sc.subVectors(o.a,Sc),wc.subVectors(o.b,Sc),nl.subVectors(o.c,Sc),Is.subVectors(wc,sc),dd.subVectors(nl,wc),zu.subVectors(sc,nl);let c=[0,-Is.z,Is.y,0,-dd.z,dd.y,0,-zu.z,zu.y,Is.z,0,-Is.x,dd.z,0,-dd.x,zu.z,0,-zu.x,-Is.y,Is.x,0,-dd.y,dd.x,0,-zu.y,zu.x,0];return!(!ap(c,sc,wc,nl,oc)||(c=[1,0,0,0,1,0,0,0,1],!ap(c,sc,wc,nl,oc)))&&(op.crossVectors(Is,dd),c=[op.x,op.y,op.z],ap(c,sc,wc,nl,oc))}clampPoint(o,c){return c.copy(o).clamp(this.min,this.max)}distanceToPoint(o){return xc.copy(o).clamp(this.min,this.max).sub(o).length()}getBoundingSphere(o){return this.getCenter(o.center),o.radius=.5*this.getSize(xc).length(),o}intersect(o){return this.min.max(o.min),this.max.min(o.max),this.isEmpty()&&this.makeEmpty(),this}union(o){return this.min.min(o.min),this.max.max(o.max),this}applyMatrix4(o){return this.isEmpty()||(bc[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(o),bc[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(o),bc[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(o),bc[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(o),bc[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(o),bc[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(o),bc[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(o),bc[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(o),this.setFromPoints(bc)),this}translate(o){return this.min.add(o),this.max.add(o),this}equals(o){return o.min.equals(this.min)&&o.max.equals(this.max)}}Ma.prototype.isBox3=!0;const bc=[new Ne,new Ne,new Ne,new Ne,new Ne,new Ne,new Ne,new Ne],xc=new Ne,ja=new Ma,sc=new Ne,wc=new Ne,nl=new Ne,Is=new Ne,dd=new Ne,zu=new Ne,Sc=new Ne,oc=new Ne,op=new Ne,gu=new Ne;function ap(g,o,c,d,p){for(let y=0,w=g.length-3;y<=w;y+=3){gu.fromArray(g,y);const M=p.x*Math.abs(gu.x)+p.y*Math.abs(gu.y)+p.z*Math.abs(gu.z),R=o.dot(gu),A=c.dot(gu),N=d.dot(gu);if(Math.max(-Math.max(R,A,N),Math.min(R,A,N))>M)return!1}return!0}const qa=new Ma,pf=new Ne,mv=new Ne,fd=new Ne;class pd{constructor(o=new Ne,c=-1){this.center=o,this.radius=c}set(o,c){return this.center.copy(o),this.radius=c,this}setFromPoints(o,c){const d=this.center;void 0!==c?d.copy(c):qa.setFromPoints(o).getCenter(d);let p=0;for(let y=0,w=o.length;y<w;y++)p=Math.max(p,d.distanceToSquared(o[y]));return this.radius=Math.sqrt(p),this}copy(o){return this.center.copy(o.center),this.radius=o.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(o){return o.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(o){return o.distanceTo(this.center)-this.radius}intersectsSphere(o){const c=this.radius+o.radius;return o.center.distanceToSquared(this.center)<=c*c}intersectsBox(o){return o.intersectsSphere(this)}intersectsPlane(o){return Math.abs(o.distanceToPoint(this.center))<=this.radius}clampPoint(o,c){const d=this.center.distanceToSquared(o);return c.copy(o),d>this.radius*this.radius&&(c.sub(this.center).normalize(),c.multiplyScalar(this.radius).add(this.center)),c}getBoundingBox(o){return this.isEmpty()?(o.makeEmpty(),o):(o.set(this.center,this.center),o.expandByScalar(this.radius),o)}applyMatrix4(o){return this.center.applyMatrix4(o),this.radius=this.radius*o.getMaxScaleOnAxis(),this}translate(o){return this.center.add(o),this}expandByPoint(o){fd.subVectors(o,this.center);const c=fd.lengthSq();if(c>this.radius*this.radius){const d=Math.sqrt(c),p=.5*(d-this.radius);this.center.add(fd.multiplyScalar(p/d)),this.radius+=p}return this}union(o){return!0===this.center.equals(o.center)?mv.set(0,0,1).multiplyScalar(o.radius):mv.subVectors(o.center,this.center).normalize().multiplyScalar(o.radius),this.expandByPoint(pf.copy(o.center).add(mv)),this.expandByPoint(pf.copy(o.center).sub(mv)),this}equals(o){return o.center.equals(this.center)&&o.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const vh=new Ne,$0=new Ne,mf=new Ne,gf=new Ne,_f=new Ne,Kg=new Ne,gv=new Ne;class yf{constructor(o=new Ne,c=new Ne(0,0,-1)){this.origin=o,this.direction=c}set(o,c){return this.origin.copy(o),this.direction.copy(c),this}copy(o){return this.origin.copy(o.origin),this.direction.copy(o.direction),this}at(o,c){return c.copy(this.direction).multiplyScalar(o).add(this.origin)}lookAt(o){return this.direction.copy(o).sub(this.origin).normalize(),this}recast(o){return this.origin.copy(this.at(o,vh)),this}closestPointToPoint(o,c){c.subVectors(o,this.origin);const d=c.dot(this.direction);return d<0?c.copy(this.origin):c.copy(this.direction).multiplyScalar(d).add(this.origin)}distanceToPoint(o){return Math.sqrt(this.distanceSqToPoint(o))}distanceSqToPoint(o){const c=vh.subVectors(o,this.origin).dot(this.direction);return c<0?this.origin.distanceToSquared(o):(vh.copy(this.direction).multiplyScalar(c).add(this.origin),vh.distanceToSquared(o))}distanceSqToSegment(o,c,d,p){$0.copy(o).add(c).multiplyScalar(.5),mf.copy(c).sub(o).normalize(),gf.copy(this.origin).sub($0);const y=.5*o.distanceTo(c),w=-this.direction.dot(mf),M=gf.dot(this.direction),R=-gf.dot(mf),A=gf.lengthSq(),N=Math.abs(1-w*w);let U,q,Y,ne;if(N>0)if(U=w*R-M,q=w*M-R,ne=y*N,U>=0)if(q>=-ne)if(q<=ne){const le=1/N;U*=le,q*=le,Y=U*(U+w*q+2*M)+q*(w*U+q+2*R)+A}else q=y,U=Math.max(0,-(w*q+M)),Y=-U*U+q*(q+2*R)+A;else q=-y,U=Math.max(0,-(w*q+M)),Y=-U*U+q*(q+2*R)+A;else q<=-ne?(U=Math.max(0,-(-w*y+M)),q=U>0?-y:Math.min(Math.max(-y,-R),y),Y=-U*U+q*(q+2*R)+A):q<=ne?(U=0,q=Math.min(Math.max(-y,-R),y),Y=q*(q+2*R)+A):(U=Math.max(0,-(w*y+M)),q=U>0?y:Math.min(Math.max(-y,-R),y),Y=-U*U+q*(q+2*R)+A);else q=w>0?-y:y,U=Math.max(0,-(w*q+M)),Y=-U*U+q*(q+2*R)+A;return d&&d.copy(this.direction).multiplyScalar(U).add(this.origin),p&&p.copy(mf).multiplyScalar(q).add($0),Y}intersectSphere(o,c){vh.subVectors(o.center,this.origin);const d=vh.dot(this.direction),p=vh.dot(vh)-d*d,y=o.radius*o.radius;if(p>y)return null;const w=Math.sqrt(y-p),M=d-w,R=d+w;return M<0&&R<0?null:this.at(M<0?R:M,c)}intersectsSphere(o){return this.distanceSqToPoint(o.center)<=o.radius*o.radius}distanceToPlane(o){const c=o.normal.dot(this.direction);if(0===c)return 0===o.distanceToPoint(this.origin)?0:null;const d=-(this.origin.dot(o.normal)+o.constant)/c;return d>=0?d:null}intersectPlane(o,c){const d=this.distanceToPlane(o);return null===d?null:this.at(d,c)}intersectsPlane(o){const c=o.distanceToPoint(this.origin);return 0===c||o.normal.dot(this.direction)*c<0}intersectBox(o,c){let d,p,y,w,M,R;const A=1/this.direction.x,N=1/this.direction.y,U=1/this.direction.z,q=this.origin;return A>=0?(d=(o.min.x-q.x)*A,p=(o.max.x-q.x)*A):(d=(o.max.x-q.x)*A,p=(o.min.x-q.x)*A),N>=0?(y=(o.min.y-q.y)*N,w=(o.max.y-q.y)*N):(y=(o.max.y-q.y)*N,w=(o.min.y-q.y)*N),d>w||y>p||((y>d||d!=d)&&(d=y),(w<p||p!=p)&&(p=w),U>=0?(M=(o.min.z-q.z)*U,R=(o.max.z-q.z)*U):(M=(o.max.z-q.z)*U,R=(o.min.z-q.z)*U),d>R||M>p)||((M>d||d!=d)&&(d=M),(R<p||p!=p)&&(p=R),p<0)?null:this.at(d>=0?d:p,c)}intersectsBox(o){return null!==this.intersectBox(o,vh)}intersectTriangle(o,c,d,p,y){_f.subVectors(c,o),Kg.subVectors(d,o),gv.crossVectors(_f,Kg);let M,w=this.direction.dot(gv);if(w>0){if(p)return null;M=1}else{if(!(w<0))return null;M=-1,w=-w}gf.subVectors(this.origin,o);const R=M*this.direction.dot(Kg.crossVectors(gf,Kg));if(R<0)return null;const A=M*this.direction.dot(_f.cross(gf));if(A<0||R+A>w)return null;const N=-M*gf.dot(gv);return N<0?null:this.at(N/w,y)}applyMatrix4(o){return this.origin.applyMatrix4(o),this.direction.transformDirection(o),this}equals(o){return o.origin.equals(this.origin)&&o.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Mn{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(o,c,d,p,y,w,M,R,A,N,U,q,Y,ne,le,Se){const re=this.elements;return re[0]=o,re[4]=c,re[8]=d,re[12]=p,re[1]=y,re[5]=w,re[9]=M,re[13]=R,re[2]=A,re[6]=N,re[10]=U,re[14]=q,re[3]=Y,re[7]=ne,re[11]=le,re[15]=Se,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Mn).fromArray(this.elements)}copy(o){const c=this.elements,d=o.elements;return c[0]=d[0],c[1]=d[1],c[2]=d[2],c[3]=d[3],c[4]=d[4],c[5]=d[5],c[6]=d[6],c[7]=d[7],c[8]=d[8],c[9]=d[9],c[10]=d[10],c[11]=d[11],c[12]=d[12],c[13]=d[13],c[14]=d[14],c[15]=d[15],this}copyPosition(o){const c=this.elements,d=o.elements;return c[12]=d[12],c[13]=d[13],c[14]=d[14],this}setFromMatrix3(o){const c=o.elements;return this.set(c[0],c[3],c[6],0,c[1],c[4],c[7],0,c[2],c[5],c[8],0,0,0,0,1),this}extractBasis(o,c,d){return o.setFromMatrixColumn(this,0),c.setFromMatrixColumn(this,1),d.setFromMatrixColumn(this,2),this}makeBasis(o,c,d){return this.set(o.x,c.x,d.x,0,o.y,c.y,d.y,0,o.z,c.z,d.z,0,0,0,0,1),this}extractRotation(o){const c=this.elements,d=o.elements,p=1/lp.setFromMatrixColumn(o,0).length(),y=1/lp.setFromMatrixColumn(o,1).length(),w=1/lp.setFromMatrixColumn(o,2).length();return c[0]=d[0]*p,c[1]=d[1]*p,c[2]=d[2]*p,c[3]=0,c[4]=d[4]*y,c[5]=d[5]*y,c[6]=d[6]*y,c[7]=0,c[8]=d[8]*w,c[9]=d[9]*w,c[10]=d[10]*w,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,this}makeRotationFromEuler(o){o&&o.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const c=this.elements,d=o.x,p=o.y,y=o.z,w=Math.cos(d),M=Math.sin(d),R=Math.cos(p),A=Math.sin(p),N=Math.cos(y),U=Math.sin(y);if("XYZ"===o.order){const q=w*N,Y=w*U,ne=M*N,le=M*U;c[0]=R*N,c[4]=-R*U,c[8]=A,c[1]=Y+ne*A,c[5]=q-le*A,c[9]=-M*R,c[2]=le-q*A,c[6]=ne+Y*A,c[10]=w*R}else if("YXZ"===o.order){const q=R*N,Y=R*U,ne=A*N,le=A*U;c[0]=q+le*M,c[4]=ne*M-Y,c[8]=w*A,c[1]=w*U,c[5]=w*N,c[9]=-M,c[2]=Y*M-ne,c[6]=le+q*M,c[10]=w*R}else if("ZXY"===o.order){const q=R*N,Y=R*U,ne=A*N,le=A*U;c[0]=q-le*M,c[4]=-w*U,c[8]=ne+Y*M,c[1]=Y+ne*M,c[5]=w*N,c[9]=le-q*M,c[2]=-w*A,c[6]=M,c[10]=w*R}else if("ZYX"===o.order){const q=w*N,Y=w*U,ne=M*N,le=M*U;c[0]=R*N,c[4]=ne*A-Y,c[8]=q*A+le,c[1]=R*U,c[5]=le*A+q,c[9]=Y*A-ne,c[2]=-A,c[6]=M*R,c[10]=w*R}else if("YZX"===o.order){const q=w*R,Y=w*A,ne=M*R,le=M*A;c[0]=R*N,c[4]=le-q*U,c[8]=ne*U+Y,c[1]=U,c[5]=w*N,c[9]=-M*N,c[2]=-A*N,c[6]=Y*U+ne,c[10]=q-le*U}else if("XZY"===o.order){const q=w*R,Y=w*A,ne=M*R,le=M*A;c[0]=R*N,c[4]=-U,c[8]=A*N,c[1]=q*U+le,c[5]=w*N,c[9]=Y*U-ne,c[2]=ne*U-Y,c[6]=M*N,c[10]=le*U+q}return c[3]=0,c[7]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,this}makeRotationFromQuaternion(o){return this.compose(Qg,o,UE)}lookAt(o,c,d){const p=this.elements;return Hl.subVectors(o,c),0===Hl.lengthSq()&&(Hl.z=1),Hl.normalize(),Uu.crossVectors(d,Hl),0===Uu.lengthSq()&&(1===Math.abs(d.z)?Hl.x+=1e-4:Hl.z+=1e-4,Hl.normalize(),Uu.crossVectors(d,Hl)),Uu.normalize(),bh.crossVectors(Hl,Uu),p[0]=Uu.x,p[4]=bh.x,p[8]=Hl.x,p[1]=Uu.y,p[5]=bh.y,p[9]=Hl.y,p[2]=Uu.z,p[6]=bh.z,p[10]=Hl.z,this}multiply(o,c){return void 0!==c?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(o,c)):this.multiplyMatrices(this,o)}premultiply(o){return this.multiplyMatrices(o,this)}multiplyMatrices(o,c){const d=o.elements,p=c.elements,y=this.elements,w=d[0],M=d[4],R=d[8],A=d[12],N=d[1],U=d[5],q=d[9],Y=d[13],ne=d[2],le=d[6],Se=d[10],re=d[14],K=d[3],Oe=d[7],xe=d[11],ze=d[15],$e=p[0],ht=p[4],Et=p[8],ci=p[12],Yt=p[1],Pe=p[5],bt=p[9],Ft=p[13],zt=p[2],Qt=p[6],Ut=p[10],ue=p[14],Xt=p[3],ui=p[7],hi=p[11],Bi=p[15];return y[0]=w*$e+M*Yt+R*zt+A*Xt,y[4]=w*ht+M*Pe+R*Qt+A*ui,y[8]=w*Et+M*bt+R*Ut+A*hi,y[12]=w*ci+M*Ft+R*ue+A*Bi,y[1]=N*$e+U*Yt+q*zt+Y*Xt,y[5]=N*ht+U*Pe+q*Qt+Y*ui,y[9]=N*Et+U*bt+q*Ut+Y*hi,y[13]=N*ci+U*Ft+q*ue+Y*Bi,y[2]=ne*$e+le*Yt+Se*zt+re*Xt,y[6]=ne*ht+le*Pe+Se*Qt+re*ui,y[10]=ne*Et+le*bt+Se*Ut+re*hi,y[14]=ne*ci+le*Ft+Se*ue+re*Bi,y[3]=K*$e+Oe*Yt+xe*zt+ze*Xt,y[7]=K*ht+Oe*Pe+xe*Qt+ze*ui,y[11]=K*Et+Oe*bt+xe*Ut+ze*hi,y[15]=K*ci+Oe*Ft+xe*ue+ze*Bi,this}multiplyScalar(o){const c=this.elements;return c[0]*=o,c[4]*=o,c[8]*=o,c[12]*=o,c[1]*=o,c[5]*=o,c[9]*=o,c[13]*=o,c[2]*=o,c[6]*=o,c[10]*=o,c[14]*=o,c[3]*=o,c[7]*=o,c[11]*=o,c[15]*=o,this}determinant(){const o=this.elements,c=o[0],d=o[4],p=o[8],y=o[12],w=o[1],M=o[5],R=o[9],A=o[13],N=o[2],U=o[6],q=o[10],Y=o[14];return o[3]*(+y*R*U-p*A*U-y*M*q+d*A*q+p*M*Y-d*R*Y)+o[7]*(+c*R*Y-c*A*q+y*w*q-p*w*Y+p*A*N-y*R*N)+o[11]*(+c*A*U-c*M*Y-y*w*U+d*w*Y+y*M*N-d*A*N)+o[15]*(-p*M*N-c*R*U+c*M*q+p*w*U-d*w*q+d*R*N)}transpose(){const o=this.elements;let c;return c=o[1],o[1]=o[4],o[4]=c,c=o[2],o[2]=o[8],o[8]=c,c=o[6],o[6]=o[9],o[9]=c,c=o[3],o[3]=o[12],o[12]=c,c=o[7],o[7]=o[13],o[13]=c,c=o[11],o[11]=o[14],o[14]=c,this}setPosition(o,c,d){const p=this.elements;return o.isVector3?(p[12]=o.x,p[13]=o.y,p[14]=o.z):(p[12]=o,p[13]=c,p[14]=d),this}invert(){const o=this.elements,c=o[0],d=o[1],p=o[2],y=o[3],w=o[4],M=o[5],R=o[6],A=o[7],N=o[8],U=o[9],q=o[10],Y=o[11],ne=o[12],le=o[13],Se=o[14],re=o[15],K=U*Se*A-le*q*A+le*R*Y-M*Se*Y-U*R*re+M*q*re,Oe=ne*q*A-N*Se*A-ne*R*Y+w*Se*Y+N*R*re-w*q*re,xe=N*le*A-ne*U*A+ne*M*Y-w*le*Y-N*M*re+w*U*re,ze=ne*U*R-N*le*R-ne*M*q+w*le*q+N*M*Se-w*U*Se,$e=c*K+d*Oe+p*xe+y*ze;if(0===$e)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const ht=1/$e;return o[0]=K*ht,o[1]=(le*q*y-U*Se*y-le*p*Y+d*Se*Y+U*p*re-d*q*re)*ht,o[2]=(M*Se*y-le*R*y+le*p*A-d*Se*A-M*p*re+d*R*re)*ht,o[3]=(U*R*y-M*q*y-U*p*A+d*q*A+M*p*Y-d*R*Y)*ht,o[4]=Oe*ht,o[5]=(N*Se*y-ne*q*y+ne*p*Y-c*Se*Y-N*p*re+c*q*re)*ht,o[6]=(ne*R*y-w*Se*y-ne*p*A+c*Se*A+w*p*re-c*R*re)*ht,o[7]=(w*q*y-N*R*y+N*p*A-c*q*A-w*p*Y+c*R*Y)*ht,o[8]=xe*ht,o[9]=(ne*U*y-N*le*y-ne*d*Y+c*le*Y+N*d*re-c*U*re)*ht,o[10]=(w*le*y-ne*M*y+ne*d*A-c*le*A-w*d*re+c*M*re)*ht,o[11]=(N*M*y-w*U*y-N*d*A+c*U*A+w*d*Y-c*M*Y)*ht,o[12]=ze*ht,o[13]=(N*le*p-ne*U*p+ne*d*q-c*le*q-N*d*Se+c*U*Se)*ht,o[14]=(ne*M*p-w*le*p-ne*d*R+c*le*R+w*d*Se-c*M*Se)*ht,o[15]=(w*U*p-N*M*p+N*d*R-c*U*R-w*d*q+c*M*q)*ht,this}scale(o){const c=this.elements,d=o.x,p=o.y,y=o.z;return c[0]*=d,c[4]*=p,c[8]*=y,c[1]*=d,c[5]*=p,c[9]*=y,c[2]*=d,c[6]*=p,c[10]*=y,c[3]*=d,c[7]*=p,c[11]*=y,this}getMaxScaleOnAxis(){const o=this.elements;return Math.sqrt(Math.max(o[0]*o[0]+o[1]*o[1]+o[2]*o[2],o[4]*o[4]+o[5]*o[5]+o[6]*o[6],o[8]*o[8]+o[9]*o[9]+o[10]*o[10]))}makeTranslation(o,c,d){return this.set(1,0,0,o,0,1,0,c,0,0,1,d,0,0,0,1),this}makeRotationX(o){const c=Math.cos(o),d=Math.sin(o);return this.set(1,0,0,0,0,c,-d,0,0,d,c,0,0,0,0,1),this}makeRotationY(o){const c=Math.cos(o),d=Math.sin(o);return this.set(c,0,d,0,0,1,0,0,-d,0,c,0,0,0,0,1),this}makeRotationZ(o){const c=Math.cos(o),d=Math.sin(o);return this.set(c,-d,0,0,d,c,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(o,c){const d=Math.cos(c),p=Math.sin(c),y=1-d,w=o.x,M=o.y,R=o.z,A=y*w,N=y*M;return this.set(A*w+d,A*M-p*R,A*R+p*M,0,A*M+p*R,N*M+d,N*R-p*w,0,A*R-p*M,N*R+p*w,y*R*R+d,0,0,0,0,1),this}makeScale(o,c,d){return this.set(o,0,0,0,0,c,0,0,0,0,d,0,0,0,0,1),this}makeShear(o,c,d,p,y,w){return this.set(1,d,y,0,o,1,w,0,c,p,1,0,0,0,0,1),this}compose(o,c,d){const p=this.elements,y=c._x,w=c._y,M=c._z,R=c._w,A=y+y,N=w+w,U=M+M,q=y*A,Y=y*N,ne=y*U,le=w*N,Se=w*U,re=M*U,K=R*A,Oe=R*N,xe=R*U,ze=d.x,$e=d.y,ht=d.z;return p[0]=(1-(le+re))*ze,p[1]=(Y+xe)*ze,p[2]=(ne-Oe)*ze,p[3]=0,p[4]=(Y-xe)*$e,p[5]=(1-(q+re))*$e,p[6]=(Se+K)*$e,p[7]=0,p[8]=(ne+Oe)*ht,p[9]=(Se-K)*ht,p[10]=(1-(q+le))*ht,p[11]=0,p[12]=o.x,p[13]=o.y,p[14]=o.z,p[15]=1,this}decompose(o,c,d){const p=this.elements;let y=lp.set(p[0],p[1],p[2]).length();const w=lp.set(p[4],p[5],p[6]).length(),M=lp.set(p[8],p[9],p[10]).length();this.determinant()<0&&(y=-y),o.x=p[12],o.y=p[13],o.z=p[14],_u.copy(this);const A=1/y,N=1/w,U=1/M;return _u.elements[0]*=A,_u.elements[1]*=A,_u.elements[2]*=A,_u.elements[4]*=N,_u.elements[5]*=N,_u.elements[6]*=N,_u.elements[8]*=U,_u.elements[9]*=U,_u.elements[10]*=U,c.setFromRotationMatrix(_u),d.x=y,d.y=w,d.z=M,this}makePerspective(o,c,d,p,y,w){void 0===w&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const M=this.elements,A=2*y/(d-p),N=(c+o)/(c-o),U=(d+p)/(d-p),q=-(w+y)/(w-y),Y=-2*w*y/(w-y);return M[0]=2*y/(c-o),M[4]=0,M[8]=N,M[12]=0,M[1]=0,M[5]=A,M[9]=U,M[13]=0,M[2]=0,M[6]=0,M[10]=q,M[14]=Y,M[3]=0,M[7]=0,M[11]=-1,M[15]=0,this}makeOrthographic(o,c,d,p,y,w){const M=this.elements,R=1/(c-o),A=1/(d-p),N=1/(w-y),U=(c+o)*R,q=(d+p)*A,Y=(w+y)*N;return M[0]=2*R,M[4]=0,M[8]=0,M[12]=-U,M[1]=0,M[5]=2*A,M[9]=0,M[13]=-q,M[2]=0,M[6]=0,M[10]=-2*N,M[14]=-Y,M[3]=0,M[7]=0,M[11]=0,M[15]=1,this}equals(o){const c=this.elements,d=o.elements;for(let p=0;p<16;p++)if(c[p]!==d[p])return!1;return!0}fromArray(o,c=0){for(let d=0;d<16;d++)this.elements[d]=o[d+c];return this}toArray(o=[],c=0){const d=this.elements;return o[c]=d[0],o[c+1]=d[1],o[c+2]=d[2],o[c+3]=d[3],o[c+4]=d[4],o[c+5]=d[5],o[c+6]=d[6],o[c+7]=d[7],o[c+8]=d[8],o[c+9]=d[9],o[c+10]=d[10],o[c+11]=d[11],o[c+12]=d[12],o[c+13]=d[13],o[c+14]=d[14],o[c+15]=d[15],o}}Mn.prototype.isMatrix4=!0;const lp=new Ne,_u=new Mn,Qg=new Ne(0,0,0),UE=new Ne(1,1,1),Uu=new Ne,bh=new Ne,Hl=new Ne,ex=new Mn,SC=new ua;class vf{constructor(o=0,c=0,d=0,p=vf.DefaultOrder){this._x=o,this._y=c,this._z=d,this._order=p}get x(){return this._x}set x(o){this._x=o,this._onChangeCallback()}get y(){return this._y}set y(o){this._y=o,this._onChangeCallback()}get z(){return this._z}set z(o){this._z=o,this._onChangeCallback()}get order(){return this._order}set order(o){this._order=o,this._onChangeCallback()}set(o,c,d,p=this._order){return this._x=o,this._y=c,this._z=d,this._order=p,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(o){return this._x=o._x,this._y=o._y,this._z=o._z,this._order=o._order,this._onChangeCallback(),this}setFromRotationMatrix(o,c=this._order,d=!0){const p=o.elements,y=p[0],w=p[4],M=p[8],R=p[1],A=p[5],N=p[9],U=p[2],q=p[6],Y=p[10];switch(c){case"XYZ":this._y=Math.asin(Ur(M,-1,1)),Math.abs(M)<.9999999?(this._x=Math.atan2(-N,Y),this._z=Math.atan2(-w,y)):(this._x=Math.atan2(q,A),this._z=0);break;case"YXZ":this._x=Math.asin(-Ur(N,-1,1)),Math.abs(N)<.9999999?(this._y=Math.atan2(M,Y),this._z=Math.atan2(R,A)):(this._y=Math.atan2(-U,y),this._z=0);break;case"ZXY":this._x=Math.asin(Ur(q,-1,1)),Math.abs(q)<.9999999?(this._y=Math.atan2(-U,Y),this._z=Math.atan2(-w,A)):(this._y=0,this._z=Math.atan2(R,y));break;case"ZYX":this._y=Math.asin(-Ur(U,-1,1)),Math.abs(U)<.9999999?(this._x=Math.atan2(q,Y),this._z=Math.atan2(R,y)):(this._x=0,this._z=Math.atan2(-w,A));break;case"YZX":this._z=Math.asin(Ur(R,-1,1)),Math.abs(R)<.9999999?(this._x=Math.atan2(-N,A),this._y=Math.atan2(-U,y)):(this._x=0,this._y=Math.atan2(M,Y));break;case"XZY":this._z=Math.asin(-Ur(w,-1,1)),Math.abs(w)<.9999999?(this._x=Math.atan2(q,A),this._y=Math.atan2(M,y)):(this._x=Math.atan2(-N,Y),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+c)}return this._order=c,!0===d&&this._onChangeCallback(),this}setFromQuaternion(o,c,d){return ex.makeRotationFromQuaternion(o),this.setFromRotationMatrix(ex,c,d)}setFromVector3(o,c=this._order){return this.set(o.x,o.y,o.z,c)}reorder(o){return SC.setFromEuler(this),this.setFromQuaternion(SC,o)}equals(o){return o._x===this._x&&o._y===this._y&&o._z===this._z&&o._order===this._order}fromArray(o){return this._x=o[0],this._y=o[1],this._z=o[2],void 0!==o[3]&&(this._order=o[3]),this._onChangeCallback(),this}toArray(o=[],c=0){return o[c]=this._x,o[c+1]=this._y,o[c+2]=this._z,o[c+3]=this._order,o}toVector3(o){return o?o.set(this._x,this._y,this._z):new Ne(this._x,this._y,this._z)}_onChange(o){return this._onChangeCallback=o,this}_onChangeCallback(){}}vf.prototype.isEuler=!0,vf.DefaultOrder="XYZ",vf.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class yu{constructor(){this.mask=1}set(o){this.mask=(1<<o|0)>>>0}enable(o){this.mask|=1<<o|0}enableAll(){this.mask=-1}toggle(o){this.mask^=1<<o|0}disable(o){this.mask&=~(1<<o|0)}disableAll(){this.mask=0}test(o){return 0!=(this.mask&o.mask)}isEnabled(o){return 0!=(this.mask&(1<<o|0))}}let tx=0;const Ls=new Ne,md=new ua,Gu=new Mn,cm=new Ne,cp=new Ne,f=new Ne,x=new ua,k=new Ne(1,0,0),X=new Ne(0,1,0),oe=new Ne(0,0,1),De={type:"added"},lt={type:"removed"};class _t extends Fl{constructor(){super(),Object.defineProperty(this,"id",{value:tx++}),this.uuid=tl(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=_t.DefaultUp.clone();const o=new Ne,c=new vf,d=new ua,p=new Ne(1,1,1);c._onChange(function y(){d.setFromEuler(c,!1)}),d._onChange(function w(){c.setFromQuaternion(d,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:o},rotation:{configurable:!0,enumerable:!0,value:c},quaternion:{configurable:!0,enumerable:!0,value:d},scale:{configurable:!0,enumerable:!0,value:p},modelViewMatrix:{value:new Mn},normalMatrix:{value:new Hn}}),this.matrix=new Mn,this.matrixWorld=new Mn,this.matrixAutoUpdate=_t.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new yu,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(o){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(o),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(o){return this.quaternion.premultiply(o),this}setRotationFromAxisAngle(o,c){this.quaternion.setFromAxisAngle(o,c)}setRotationFromEuler(o){this.quaternion.setFromEuler(o,!0)}setRotationFromMatrix(o){this.quaternion.setFromRotationMatrix(o)}setRotationFromQuaternion(o){this.quaternion.copy(o)}rotateOnAxis(o,c){return md.setFromAxisAngle(o,c),this.quaternion.multiply(md),this}rotateOnWorldAxis(o,c){return md.setFromAxisAngle(o,c),this.quaternion.premultiply(md),this}rotateX(o){return this.rotateOnAxis(k,o)}rotateY(o){return this.rotateOnAxis(X,o)}rotateZ(o){return this.rotateOnAxis(oe,o)}translateOnAxis(o,c){return Ls.copy(o).applyQuaternion(this.quaternion),this.position.add(Ls.multiplyScalar(c)),this}translateX(o){return this.translateOnAxis(k,o)}translateY(o){return this.translateOnAxis(X,o)}translateZ(o){return this.translateOnAxis(oe,o)}localToWorld(o){return o.applyMatrix4(this.matrixWorld)}worldToLocal(o){return o.applyMatrix4(Gu.copy(this.matrixWorld).invert())}lookAt(o,c,d){o.isVector3?cm.copy(o):cm.set(o,c,d);const p=this.parent;this.updateWorldMatrix(!0,!1),cp.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Gu.lookAt(cp,cm,this.up):Gu.lookAt(cm,cp,this.up),this.quaternion.setFromRotationMatrix(Gu),p&&(Gu.extractRotation(p.matrixWorld),md.setFromRotationMatrix(Gu),this.quaternion.premultiply(md.invert()))}add(o){if(arguments.length>1){for(let c=0;c<arguments.length;c++)this.add(arguments[c]);return this}return o===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",o),this):(o&&o.isObject3D?(null!==o.parent&&o.parent.remove(o),o.parent=this,this.children.push(o),o.dispatchEvent(De)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",o),this)}remove(o){if(arguments.length>1){for(let d=0;d<arguments.length;d++)this.remove(arguments[d]);return this}const c=this.children.indexOf(o);return-1!==c&&(o.parent=null,this.children.splice(c,1),o.dispatchEvent(lt)),this}removeFromParent(){const o=this.parent;return null!==o&&o.remove(this),this}clear(){for(let o=0;o<this.children.length;o++){const c=this.children[o];c.parent=null,c.dispatchEvent(lt)}return this.children.length=0,this}attach(o){return this.updateWorldMatrix(!0,!1),Gu.copy(this.matrixWorld).invert(),null!==o.parent&&(o.parent.updateWorldMatrix(!0,!1),Gu.multiply(o.parent.matrixWorld)),o.applyMatrix4(Gu),this.add(o),o.updateWorldMatrix(!1,!0),this}getObjectById(o){return this.getObjectByProperty("id",o)}getObjectByName(o){return this.getObjectByProperty("name",o)}getObjectByProperty(o,c){if(this[o]===c)return this;for(let d=0,p=this.children.length;d<p;d++){const w=this.children[d].getObjectByProperty(o,c);if(void 0!==w)return w}}getWorldPosition(o){return this.updateWorldMatrix(!0,!1),o.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(o){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(cp,o,f),o}getWorldScale(o){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(cp,x,o),o}getWorldDirection(o){this.updateWorldMatrix(!0,!1);const c=this.matrixWorld.elements;return o.set(c[8],c[9],c[10]).normalize()}raycast(){}traverse(o){o(this);const c=this.children;for(let d=0,p=c.length;d<p;d++)c[d].traverse(o)}traverseVisible(o){if(!1===this.visible)return;o(this);const c=this.children;for(let d=0,p=c.length;d<p;d++)c[d].traverseVisible(o)}traverseAncestors(o){const c=this.parent;null!==c&&(o(c),c.traverseAncestors(o))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(o){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||o)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,o=!0);const c=this.children;for(let d=0,p=c.length;d<p;d++)c[d].updateMatrixWorld(o)}updateWorldMatrix(o,c){const d=this.parent;if(!0===o&&null!==d&&d.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===c){const p=this.children;for(let y=0,w=p.length;y<w;y++)p[y].updateWorldMatrix(!1,!0)}}toJSON(o){const c=void 0===o||"string"==typeof o,d={};c&&(o={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},d.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const p={};function y(M,R){return void 0===M[R.uuid]&&(M[R.uuid]=R.toJSON(o)),R.uuid}if(p.uuid=this.uuid,p.type=this.type,""!==this.name&&(p.name=this.name),!0===this.castShadow&&(p.castShadow=!0),!0===this.receiveShadow&&(p.receiveShadow=!0),!1===this.visible&&(p.visible=!1),!1===this.frustumCulled&&(p.frustumCulled=!1),0!==this.renderOrder&&(p.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(p.userData=this.userData),p.layers=this.layers.mask,p.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(p.matrixAutoUpdate=!1),this.isInstancedMesh&&(p.type="InstancedMesh",p.count=this.count,p.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(p.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?p.background=this.background.toJSON():this.background.isTexture&&(p.background=this.background.toJSON(o).uuid)),this.environment&&this.environment.isTexture&&(p.environment=this.environment.toJSON(o).uuid);else if(this.isMesh||this.isLine||this.isPoints){p.geometry=y(o.geometries,this.geometry);const M=this.geometry.parameters;if(void 0!==M&&void 0!==M.shapes){const R=M.shapes;if(Array.isArray(R))for(let A=0,N=R.length;A<N;A++)y(o.shapes,R[A]);else y(o.shapes,R)}}if(this.isSkinnedMesh&&(p.bindMode=this.bindMode,p.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(y(o.skeletons,this.skeleton),p.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const M=[];for(let R=0,A=this.material.length;R<A;R++)M.push(y(o.materials,this.material[R]));p.material=M}else p.material=y(o.materials,this.material);if(this.children.length>0){p.children=[];for(let M=0;M<this.children.length;M++)p.children.push(this.children[M].toJSON(o).object)}if(this.animations.length>0){p.animations=[];for(let M=0;M<this.animations.length;M++)p.animations.push(y(o.animations,this.animations[M]))}if(c){const M=w(o.geometries),R=w(o.materials),A=w(o.textures),N=w(o.images),U=w(o.shapes),q=w(o.skeletons),Y=w(o.animations);M.length>0&&(d.geometries=M),R.length>0&&(d.materials=R),A.length>0&&(d.textures=A),N.length>0&&(d.images=N),U.length>0&&(d.shapes=U),q.length>0&&(d.skeletons=q),Y.length>0&&(d.animations=Y)}return d.object=p,d;function w(M){const R=[];for(const A in M){const N=M[A];delete N.metadata,R.push(N)}return R}}clone(o){return(new this.constructor).copy(this,o)}copy(o,c=!0){if(this.name=o.name,this.up.copy(o.up),this.position.copy(o.position),this.rotation.order=o.rotation.order,this.quaternion.copy(o.quaternion),this.scale.copy(o.scale),this.matrix.copy(o.matrix),this.matrixWorld.copy(o.matrixWorld),this.matrixAutoUpdate=o.matrixAutoUpdate,this.matrixWorldNeedsUpdate=o.matrixWorldNeedsUpdate,this.layers.mask=o.layers.mask,this.visible=o.visible,this.castShadow=o.castShadow,this.receiveShadow=o.receiveShadow,this.frustumCulled=o.frustumCulled,this.renderOrder=o.renderOrder,this.userData=JSON.parse(JSON.stringify(o.userData)),!0===c)for(let d=0;d<o.children.length;d++)this.add(o.children[d].clone());return this}}_t.DefaultUp=new Ne(0,1,0),_t.DefaultMatrixAutoUpdate=!0,_t.prototype.isObject3D=!0;const Vt=new Ne,_i=new Ne,on=new Ne,Ln=new Ne,ps=new Ne,Hc=new Ne,fo=new Ne,bf=new Ne,Wu=new Ne,zo=new Ne;class ha{constructor(o=new Ne,c=new Ne,d=new Ne){this.a=o,this.b=c,this.c=d}static getNormal(o,c,d,p){p.subVectors(d,c),Vt.subVectors(o,c),p.cross(Vt);const y=p.lengthSq();return y>0?p.multiplyScalar(1/Math.sqrt(y)):p.set(0,0,0)}static getBarycoord(o,c,d,p,y){Vt.subVectors(p,c),_i.subVectors(d,c),on.subVectors(o,c);const w=Vt.dot(Vt),M=Vt.dot(_i),R=Vt.dot(on),A=_i.dot(_i),N=_i.dot(on),U=w*A-M*M;if(0===U)return y.set(-2,-1,-1);const q=1/U,Y=(A*R-M*N)*q,ne=(w*N-M*R)*q;return y.set(1-Y-ne,ne,Y)}static containsPoint(o,c,d,p){return this.getBarycoord(o,c,d,p,Ln),Ln.x>=0&&Ln.y>=0&&Ln.x+Ln.y<=1}static getUV(o,c,d,p,y,w,M,R){return this.getBarycoord(o,c,d,p,Ln),R.set(0,0),R.addScaledVector(y,Ln.x),R.addScaledVector(w,Ln.y),R.addScaledVector(M,Ln.z),R}static isFrontFacing(o,c,d,p){return Vt.subVectors(d,c),_i.subVectors(o,c),Vt.cross(_i).dot(p)<0}set(o,c,d){return this.a.copy(o),this.b.copy(c),this.c.copy(d),this}setFromPointsAndIndices(o,c,d,p){return this.a.copy(o[c]),this.b.copy(o[d]),this.c.copy(o[p]),this}setFromAttributeAndIndices(o,c,d,p){return this.a.fromBufferAttribute(o,c),this.b.fromBufferAttribute(o,d),this.c.fromBufferAttribute(o,p),this}clone(){return(new this.constructor).copy(this)}copy(o){return this.a.copy(o.a),this.b.copy(o.b),this.c.copy(o.c),this}getArea(){return Vt.subVectors(this.c,this.b),_i.subVectors(this.a,this.b),.5*Vt.cross(_i).length()}getMidpoint(o){return o.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(o){return ha.getNormal(this.a,this.b,this.c,o)}getPlane(o){return o.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(o,c){return ha.getBarycoord(o,this.a,this.b,this.c,c)}getUV(o,c,d,p,y){return ha.getUV(o,this.a,this.b,this.c,c,d,p,y)}containsPoint(o){return ha.containsPoint(o,this.a,this.b,this.c)}isFrontFacing(o){return ha.isFrontFacing(this.a,this.b,this.c,o)}intersectsBox(o){return o.intersectsTriangle(this)}closestPointToPoint(o,c){const d=this.a,p=this.b,y=this.c;let w,M;ps.subVectors(p,d),Hc.subVectors(y,d),bf.subVectors(o,d);const R=ps.dot(bf),A=Hc.dot(bf);if(R<=0&&A<=0)return c.copy(d);Wu.subVectors(o,p);const N=ps.dot(Wu),U=Hc.dot(Wu);if(N>=0&&U<=N)return c.copy(p);const q=R*U-N*A;if(q<=0&&R>=0&&N<=0)return w=R/(R-N),c.copy(d).addScaledVector(ps,w);zo.subVectors(o,y);const Y=ps.dot(zo),ne=Hc.dot(zo);if(ne>=0&&Y<=ne)return c.copy(y);const le=Y*A-R*ne;if(le<=0&&A>=0&&ne<=0)return M=A/(A-ne),c.copy(d).addScaledVector(Hc,M);const Se=N*ne-Y*U;if(Se<=0&&U-N>=0&&Y-ne>=0)return fo.subVectors(y,p),M=(U-N)/(U-N+(Y-ne)),c.copy(p).addScaledVector(fo,M);const re=1/(Se+le+q);return w=le*re,M=q*re,c.copy(d).addScaledVector(ps,w).addScaledVector(Hc,M)}equals(o){return o.a.equals(this.a)&&o.b.equals(this.b)&&o.c.equals(this.c)}}let GE=0;class da extends Fl{constructor(){super(),Object.defineProperty(this,"id",{value:GE++}),this.uuid=tl(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.alphaWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(o){this._alphaTest>0!=o>0&&this.version++,this._alphaTest=o}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(o){if(void 0!==o)for(const c in o){const d=o[c];if(void 0===d){console.warn("THREE.Material: '"+c+"' parameter is undefined.");continue}if("shading"===c){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===d;continue}const p=this[c];void 0!==p?p&&p.isColor?p.set(d):p&&p.isVector3&&d&&d.isVector3?p.copy(d):this[c]=d:console.warn("THREE."+this.type+": '"+c+"' is not a property of this material.")}}toJSON(o){const c=void 0===o||"string"==typeof o;c&&(o={textures:{},images:{}});const d={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function p(y){const w=[];for(const M in y){const R=y[M];delete R.metadata,w.push(R)}return w}if(d.uuid=this.uuid,d.type=this.type,""!==this.name&&(d.name=this.name),this.color&&this.color.isColor&&(d.color=this.color.getHex()),void 0!==this.roughness&&(d.roughness=this.roughness),void 0!==this.metalness&&(d.metalness=this.metalness),void 0!==this.sheen&&(d.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(d.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(d.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(d.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(d.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(d.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(d.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(d.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(d.shininess=this.shininess),void 0!==this.clearcoat&&(d.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(d.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(d.clearcoatMap=this.clearcoatMap.toJSON(o).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(d.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(o).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(d.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(o).uuid,d.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(d.map=this.map.toJSON(o).uuid),this.matcap&&this.matcap.isTexture&&(d.matcap=this.matcap.toJSON(o).uuid),this.alphaMap&&this.alphaMap.isTexture&&(d.alphaMap=this.alphaMap.toJSON(o).uuid),this.lightMap&&this.lightMap.isTexture&&(d.lightMap=this.lightMap.toJSON(o).uuid,d.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(d.aoMap=this.aoMap.toJSON(o).uuid,d.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(d.bumpMap=this.bumpMap.toJSON(o).uuid,d.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(d.normalMap=this.normalMap.toJSON(o).uuid,d.normalMapType=this.normalMapType,d.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(d.displacementMap=this.displacementMap.toJSON(o).uuid,d.displacementScale=this.displacementScale,d.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(d.roughnessMap=this.roughnessMap.toJSON(o).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(d.metalnessMap=this.metalnessMap.toJSON(o).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(d.emissiveMap=this.emissiveMap.toJSON(o).uuid),this.specularMap&&this.specularMap.isTexture&&(d.specularMap=this.specularMap.toJSON(o).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(d.specularIntensityMap=this.specularIntensityMap.toJSON(o).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(d.specularColorMap=this.specularColorMap.toJSON(o).uuid),this.envMap&&this.envMap.isTexture&&(d.envMap=this.envMap.toJSON(o).uuid,void 0!==this.combine&&(d.combine=this.combine)),void 0!==this.envMapIntensity&&(d.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(d.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(d.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(d.gradientMap=this.gradientMap.toJSON(o).uuid),void 0!==this.transmission&&(d.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(d.transmissionMap=this.transmissionMap.toJSON(o).uuid),void 0!==this.thickness&&(d.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(d.thicknessMap=this.thicknessMap.toJSON(o).uuid),void 0!==this.attenuationDistance&&(d.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(d.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(d.size=this.size),null!==this.shadowSide&&(d.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(d.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(d.blending=this.blending),0!==this.side&&(d.side=this.side),this.vertexColors&&(d.vertexColors=!0),this.opacity<1&&(d.opacity=this.opacity),!0===this.transparent&&(d.transparent=this.transparent),d.depthFunc=this.depthFunc,d.depthTest=this.depthTest,d.depthWrite=this.depthWrite,d.colorWrite=this.colorWrite,d.alphaWrite=this.alphaWrite,d.stencilWrite=this.stencilWrite,d.stencilWriteMask=this.stencilWriteMask,d.stencilFunc=this.stencilFunc,d.stencilRef=this.stencilRef,d.stencilFuncMask=this.stencilFuncMask,d.stencilFail=this.stencilFail,d.stencilZFail=this.stencilZFail,d.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(d.rotation=this.rotation),!0===this.polygonOffset&&(d.polygonOffset=!0),0!==this.polygonOffsetFactor&&(d.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(d.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(d.linewidth=this.linewidth),void 0!==this.dashSize&&(d.dashSize=this.dashSize),void 0!==this.gapSize&&(d.gapSize=this.gapSize),void 0!==this.scale&&(d.scale=this.scale),!0===this.dithering&&(d.dithering=!0),this.alphaTest>0&&(d.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(d.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(d.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(d.wireframe=this.wireframe),this.wireframeLinewidth>1&&(d.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(d.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(d.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(d.flatShading=this.flatShading),!1===this.visible&&(d.visible=!1),!1===this.toneMapped&&(d.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(d.userData=this.userData),c){const y=p(o.textures),w=p(o.images);y.length>0&&(d.textures=y),w.length>0&&(d.images=w)}return d}clone(){return(new this.constructor).copy(this)}copy(o){this.name=o.name,this.fog=o.fog,this.blending=o.blending,this.side=o.side,this.vertexColors=o.vertexColors,this.opacity=o.opacity,this.transparent=o.transparent,this.blendSrc=o.blendSrc,this.blendDst=o.blendDst,this.blendEquation=o.blendEquation,this.blendSrcAlpha=o.blendSrcAlpha,this.blendDstAlpha=o.blendDstAlpha,this.blendEquationAlpha=o.blendEquationAlpha,this.depthFunc=o.depthFunc,this.depthTest=o.depthTest,this.depthWrite=o.depthWrite,this.stencilWriteMask=o.stencilWriteMask,this.stencilFunc=o.stencilFunc,this.stencilRef=o.stencilRef,this.stencilFuncMask=o.stencilFuncMask,this.stencilFail=o.stencilFail,this.stencilZFail=o.stencilZFail,this.stencilZPass=o.stencilZPass,this.stencilWrite=o.stencilWrite;const c=o.clippingPlanes;let d=null;if(null!==c){const p=c.length;d=new Array(p);for(let y=0;y!==p;++y)d[y]=c[y].clone()}return this.clippingPlanes=d,this.clipIntersection=o.clipIntersection,this.clipShadows=o.clipShadows,this.shadowSide=o.shadowSide,this.colorWrite=o.colorWrite,this.alphaWrite=o.alphaWrite,this.precision=o.precision,this.polygonOffset=o.polygonOffset,this.polygonOffsetFactor=o.polygonOffsetFactor,this.polygonOffsetUnits=o.polygonOffsetUnits,this.dithering=o.dithering,this.alphaTest=o.alphaTest,this.alphaToCoverage=o.alphaToCoverage,this.premultipliedAlpha=o.premultipliedAlpha,this.visible=o.visible,this.toneMapped=o.toneMapped,this.userData=JSON.parse(JSON.stringify(o.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(o){!0===o&&this.version++}}da.prototype.isMaterial=!0;class fa extends da{constructor(o){super(),this.type="MeshBasicMaterial",this.color=new cn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(o)}copy(o){return super.copy(o),this.color.copy(o.color),this.map=o.map,this.lightMap=o.lightMap,this.lightMapIntensity=o.lightMapIntensity,this.aoMap=o.aoMap,this.aoMapIntensity=o.aoMapIntensity,this.specularMap=o.specularMap,this.alphaMap=o.alphaMap,this.envMap=o.envMap,this.combine=o.combine,this.reflectivity=o.reflectivity,this.refractionRatio=o.refractionRatio,this.wireframe=o.wireframe,this.wireframeLinewidth=o.wireframeLinewidth,this.wireframeLinecap=o.wireframeLinecap,this.wireframeLinejoin=o.wireframeLinejoin,this}}fa.prototype.isMeshBasicMaterial=!0;const Do=new Ne,xf=new Be;class Zn{constructor(o,c,d){if(Array.isArray(o))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=o,this.itemSize=c,this.count=void 0!==o?o.length/c:0,this.normalized=!0===d,this.usage=ds,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(o){!0===o&&this.version++}setUsage(o){return this.usage=o,this}copy(o){return this.name=o.name,this.array=new o.array.constructor(o.array),this.itemSize=o.itemSize,this.count=o.count,this.normalized=o.normalized,this.usage=o.usage,this}copyAt(o,c,d){o*=this.itemSize,d*=c.itemSize;for(let p=0,y=this.itemSize;p<y;p++)this.array[o+p]=c.array[d+p];return this}copyArray(o){return this.array.set(o),this}copyColorsArray(o){const c=this.array;let d=0;for(let p=0,y=o.length;p<y;p++){let w=o[p];void 0===w&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",p),w=new cn),c[d++]=w.r,c[d++]=w.g,c[d++]=w.b}return this}copyVector2sArray(o){const c=this.array;let d=0;for(let p=0,y=o.length;p<y;p++){let w=o[p];void 0===w&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",p),w=new Be),c[d++]=w.x,c[d++]=w.y}return this}copyVector3sArray(o){const c=this.array;let d=0;for(let p=0,y=o.length;p<y;p++){let w=o[p];void 0===w&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",p),w=new Ne),c[d++]=w.x,c[d++]=w.y,c[d++]=w.z}return this}copyVector4sArray(o){const c=this.array;let d=0;for(let p=0,y=o.length;p<y;p++){let w=o[p];void 0===w&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",p),w=new Es),c[d++]=w.x,c[d++]=w.y,c[d++]=w.z,c[d++]=w.w}return this}applyMatrix3(o){if(2===this.itemSize)for(let c=0,d=this.count;c<d;c++)xf.fromBufferAttribute(this,c),xf.applyMatrix3(o),this.setXY(c,xf.x,xf.y);else if(3===this.itemSize)for(let c=0,d=this.count;c<d;c++)Do.fromBufferAttribute(this,c),Do.applyMatrix3(o),this.setXYZ(c,Do.x,Do.y,Do.z);return this}applyMatrix4(o){for(let c=0,d=this.count;c<d;c++)Do.x=this.getX(c),Do.y=this.getY(c),Do.z=this.getZ(c),Do.applyMatrix4(o),this.setXYZ(c,Do.x,Do.y,Do.z);return this}applyNormalMatrix(o){for(let c=0,d=this.count;c<d;c++)Do.x=this.getX(c),Do.y=this.getY(c),Do.z=this.getZ(c),Do.applyNormalMatrix(o),this.setXYZ(c,Do.x,Do.y,Do.z);return this}transformDirection(o){for(let c=0,d=this.count;c<d;c++)Do.x=this.getX(c),Do.y=this.getY(c),Do.z=this.getZ(c),Do.transformDirection(o),this.setXYZ(c,Do.x,Do.y,Do.z);return this}set(o,c=0){return this.array.set(o,c),this}getX(o){return this.array[o*this.itemSize]}setX(o,c){return this.array[o*this.itemSize]=c,this}getY(o){return this.array[o*this.itemSize+1]}setY(o,c){return this.array[o*this.itemSize+1]=c,this}getZ(o){return this.array[o*this.itemSize+2]}setZ(o,c){return this.array[o*this.itemSize+2]=c,this}getW(o){return this.array[o*this.itemSize+3]}setW(o,c){return this.array[o*this.itemSize+3]=c,this}setXY(o,c,d){return this.array[0+(o*=this.itemSize)]=c,this.array[o+1]=d,this}setXYZ(o,c,d,p){return this.array[0+(o*=this.itemSize)]=c,this.array[o+1]=d,this.array[o+2]=p,this}setXYZW(o,c,d,p,y){return this.array[0+(o*=this.itemSize)]=c,this.array[o+1]=d,this.array[o+2]=p,this.array[o+3]=y,this}onUpload(o){return this.onUploadCallback=o,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const o={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(o.name=this.name),this.usage!==ds&&(o.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(o.updateRange=this.updateRange),o}}Zn.prototype.isBufferAttribute=!0;class yl extends Zn{constructor(o,c,d){super(new Int8Array(o),c,d)}}class _v extends Zn{constructor(o,c,d){super(new Uint8Array(o),c,d)}}class Jg extends Zn{constructor(o,c,d){super(new Uint8ClampedArray(o),c,d)}}class ix extends Zn{constructor(o,c,d){super(new Int16Array(o),c,d)}}class Vc extends Zn{constructor(o,c,d){super(new Uint16Array(o),c,d)}}class $g extends Zn{constructor(o,c,d){super(new Int32Array(o),c,d)}}class up extends Zn{constructor(o,c,d){super(new Uint32Array(o),c,d)}}class Wr extends Zn{constructor(o,c,d){super(new Uint16Array(o),c,d)}}Wr.prototype.isFloat16BufferAttribute=!0;class Wn extends Zn{constructor(o,c,d){super(new Float32Array(o),c,d)}}class WE extends Zn{constructor(o,c,d){super(new Float64Array(o),c,d)}}let TL=0;const ju=new Mn,nx=new _t,e_=new Ne,vu=new Ma,Di=new Ma,Tr=new Ne;class gt extends Fl{constructor(){super(),Object.defineProperty(this,"id",{value:TL++}),this.uuid=tl(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(o){return this.index=Array.isArray(o)?new(pl(o)?up:Vc)(o,1):o,this}getAttribute(o){return this.attributes[o]}setAttribute(o,c){return this.attributes[o]=c,this}deleteAttribute(o){return delete this.attributes[o],this}hasAttribute(o){return void 0!==this.attributes[o]}addGroup(o,c,d=0){this.groups.push({start:o,count:c,materialIndex:d})}clearGroups(){this.groups=[]}setDrawRange(o,c){this.drawRange.start=o,this.drawRange.count=c}applyMatrix4(o){const c=this.attributes.position;void 0!==c&&(c.applyMatrix4(o),c.needsUpdate=!0);const d=this.attributes.normal;if(void 0!==d){const y=(new Hn).getNormalMatrix(o);d.applyNormalMatrix(y),d.needsUpdate=!0}const p=this.attributes.tangent;return void 0!==p&&(p.transformDirection(o),p.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(o){return ju.makeRotationFromQuaternion(o),this.applyMatrix4(ju),this}rotateX(o){return ju.makeRotationX(o),this.applyMatrix4(ju),this}rotateY(o){return ju.makeRotationY(o),this.applyMatrix4(ju),this}rotateZ(o){return ju.makeRotationZ(o),this.applyMatrix4(ju),this}translate(o,c,d){return ju.makeTranslation(o,c,d),this.applyMatrix4(ju),this}scale(o,c,d){return ju.makeScale(o,c,d),this.applyMatrix4(ju),this}lookAt(o){return nx.lookAt(o),nx.updateMatrix(),this.applyMatrix4(nx.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(e_).negate(),this.translate(e_.x,e_.y,e_.z),this}setFromPoints(o){const c=[];for(let d=0,p=o.length;d<p;d++){const y=o[d];c.push(y.x,y.y,y.z||0)}return this.setAttribute("position",new Wn(c,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Ma);const o=this.attributes.position,c=this.morphAttributes.position;if(o&&o.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new Ne(-1/0,-1/0,-1/0),new Ne(1/0,1/0,1/0));if(void 0!==o){if(this.boundingBox.setFromBufferAttribute(o),c)for(let d=0,p=c.length;d<p;d++)vu.setFromBufferAttribute(c[d]),this.morphTargetsRelative?(Tr.addVectors(this.boundingBox.min,vu.min),this.boundingBox.expandByPoint(Tr),Tr.addVectors(this.boundingBox.max,vu.max),this.boundingBox.expandByPoint(Tr)):(this.boundingBox.expandByPoint(vu.min),this.boundingBox.expandByPoint(vu.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new pd);const o=this.attributes.position,c=this.morphAttributes.position;if(o&&o.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new Ne,1/0);if(o){const d=this.boundingSphere.center;if(vu.setFromBufferAttribute(o),c)for(let y=0,w=c.length;y<w;y++)Di.setFromBufferAttribute(c[y]),this.morphTargetsRelative?(Tr.addVectors(vu.min,Di.min),vu.expandByPoint(Tr),Tr.addVectors(vu.max,Di.max),vu.expandByPoint(Tr)):(vu.expandByPoint(Di.min),vu.expandByPoint(Di.max));vu.getCenter(d);let p=0;for(let y=0,w=o.count;y<w;y++)Tr.fromBufferAttribute(o,y),p=Math.max(p,d.distanceToSquared(Tr));if(c)for(let y=0,w=c.length;y<w;y++){const M=c[y],R=this.morphTargetsRelative;for(let A=0,N=M.count;A<N;A++)Tr.fromBufferAttribute(M,A),R&&(e_.fromBufferAttribute(o,A),Tr.add(e_)),p=Math.max(p,d.distanceToSquared(Tr))}this.boundingSphere.radius=Math.sqrt(p),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const o=this.index,c=this.attributes;if(null===o||void 0===c.position||void 0===c.normal||void 0===c.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const d=o.array,p=c.position.array,y=c.normal.array,w=c.uv.array,M=p.length/3;void 0===c.tangent&&this.setAttribute("tangent",new Zn(new Float32Array(4*M),4));const R=c.tangent.array,A=[],N=[];for(let Yt=0;Yt<M;Yt++)A[Yt]=new Ne,N[Yt]=new Ne;const U=new Ne,q=new Ne,Y=new Ne,ne=new Be,le=new Be,Se=new Be,re=new Ne,K=new Ne;function Oe(Yt,Pe,bt){U.fromArray(p,3*Yt),q.fromArray(p,3*Pe),Y.fromArray(p,3*bt),ne.fromArray(w,2*Yt),le.fromArray(w,2*Pe),Se.fromArray(w,2*bt),q.sub(U),Y.sub(U),le.sub(ne),Se.sub(ne);const Ft=1/(le.x*Se.y-Se.x*le.y);!isFinite(Ft)||(re.copy(q).multiplyScalar(Se.y).addScaledVector(Y,-le.y).multiplyScalar(Ft),K.copy(Y).multiplyScalar(le.x).addScaledVector(q,-Se.x).multiplyScalar(Ft),A[Yt].add(re),A[Pe].add(re),A[bt].add(re),N[Yt].add(K),N[Pe].add(K),N[bt].add(K))}let xe=this.groups;0===xe.length&&(xe=[{start:0,count:d.length}]);for(let Yt=0,Pe=xe.length;Yt<Pe;++Yt){const bt=xe[Yt],Ft=bt.start;for(let Qt=Ft,Ut=Ft+bt.count;Qt<Ut;Qt+=3)Oe(d[Qt+0],d[Qt+1],d[Qt+2])}const ze=new Ne,$e=new Ne,ht=new Ne,Et=new Ne;function ci(Yt){ht.fromArray(y,3*Yt),Et.copy(ht);const Pe=A[Yt];ze.copy(Pe),ze.sub(ht.multiplyScalar(ht.dot(Pe))).normalize(),$e.crossVectors(Et,Pe);const Ft=$e.dot(N[Yt])<0?-1:1;R[4*Yt]=ze.x,R[4*Yt+1]=ze.y,R[4*Yt+2]=ze.z,R[4*Yt+3]=Ft}for(let Yt=0,Pe=xe.length;Yt<Pe;++Yt){const bt=xe[Yt],Ft=bt.start;for(let Qt=Ft,Ut=Ft+bt.count;Qt<Ut;Qt+=3)ci(d[Qt+0]),ci(d[Qt+1]),ci(d[Qt+2])}}computeVertexNormals(){const o=this.index,c=this.getAttribute("position");if(void 0!==c){let d=this.getAttribute("normal");if(void 0===d)d=new Zn(new Float32Array(3*c.count),3),this.setAttribute("normal",d);else for(let q=0,Y=d.count;q<Y;q++)d.setXYZ(q,0,0,0);const p=new Ne,y=new Ne,w=new Ne,M=new Ne,R=new Ne,A=new Ne,N=new Ne,U=new Ne;if(o)for(let q=0,Y=o.count;q<Y;q+=3){const ne=o.getX(q+0),le=o.getX(q+1),Se=o.getX(q+2);p.fromBufferAttribute(c,ne),y.fromBufferAttribute(c,le),w.fromBufferAttribute(c,Se),N.subVectors(w,y),U.subVectors(p,y),N.cross(U),M.fromBufferAttribute(d,ne),R.fromBufferAttribute(d,le),A.fromBufferAttribute(d,Se),M.add(N),R.add(N),A.add(N),d.setXYZ(ne,M.x,M.y,M.z),d.setXYZ(le,R.x,R.y,R.z),d.setXYZ(Se,A.x,A.y,A.z)}else for(let q=0,Y=c.count;q<Y;q+=3)p.fromBufferAttribute(c,q+0),y.fromBufferAttribute(c,q+1),w.fromBufferAttribute(c,q+2),N.subVectors(w,y),U.subVectors(p,y),N.cross(U),d.setXYZ(q+0,N.x,N.y,N.z),d.setXYZ(q+1,N.x,N.y,N.z),d.setXYZ(q+2,N.x,N.y,N.z);this.normalizeNormals(),d.needsUpdate=!0}}merge(o,c){if(!o||!o.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",o);void 0===c&&(c=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const d=this.attributes;for(const p in d){if(void 0===o.attributes[p])continue;const w=d[p].array,M=o.attributes[p],R=M.array,A=M.itemSize*c,N=Math.min(R.length,w.length-A);for(let U=0,q=A;U<N;U++,q++)w[q]=R[U]}return this}normalizeNormals(){const o=this.attributes.normal;for(let c=0,d=o.count;c<d;c++)Tr.fromBufferAttribute(o,c),Tr.normalize(),o.setXYZ(c,Tr.x,Tr.y,Tr.z)}toNonIndexed(){function o(M,R){const A=M.array,N=M.itemSize,U=M.normalized,q=new A.constructor(R.length*N);let Y=0,ne=0;for(let le=0,Se=R.length;le<Se;le++){Y=M.isInterleavedBufferAttribute?R[le]*M.data.stride+M.offset:R[le]*N;for(let re=0;re<N;re++)q[ne++]=A[Y++]}return new Zn(q,N,U)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const c=new gt,d=this.index.array,p=this.attributes;for(const M in p){const A=o(p[M],d);c.setAttribute(M,A)}const y=this.morphAttributes;for(const M in y){const R=[],A=y[M];for(let N=0,U=A.length;N<U;N++){const Y=o(A[N],d);R.push(Y)}c.morphAttributes[M]=R}c.morphTargetsRelative=this.morphTargetsRelative;const w=this.groups;for(let M=0,R=w.length;M<R;M++){const A=w[M];c.addGroup(A.start,A.count,A.materialIndex)}return c}toJSON(){const o={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(o.uuid=this.uuid,o.type=this.type,""!==this.name&&(o.name=this.name),Object.keys(this.userData).length>0&&(o.userData=this.userData),void 0!==this.parameters){const R=this.parameters;for(const A in R)void 0!==R[A]&&(o[A]=R[A]);return o}o.data={attributes:{}};const c=this.index;null!==c&&(o.data.index={type:c.array.constructor.name,array:Array.prototype.slice.call(c.array)});const d=this.attributes;for(const R in d)o.data.attributes[R]=d[R].toJSON(o.data);const p={};let y=!1;for(const R in this.morphAttributes){const A=this.morphAttributes[R],N=[];for(let U=0,q=A.length;U<q;U++)N.push(A[U].toJSON(o.data));N.length>0&&(p[R]=N,y=!0)}y&&(o.data.morphAttributes=p,o.data.morphTargetsRelative=this.morphTargetsRelative);const w=this.groups;w.length>0&&(o.data.groups=JSON.parse(JSON.stringify(w)));const M=this.boundingSphere;return null!==M&&(o.data.boundingSphere={center:M.center.toArray(),radius:M.radius}),o}clone(){return(new this.constructor).copy(this)}copy(o){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const c={};this.name=o.name;const d=o.index;null!==d&&this.setIndex(d.clone(c));const p=o.attributes;for(const A in p)this.setAttribute(A,p[A].clone(c));const y=o.morphAttributes;for(const A in y){const N=[],U=y[A];for(let q=0,Y=U.length;q<Y;q++)N.push(U[q].clone(c));this.morphAttributes[A]=N}this.morphTargetsRelative=o.morphTargetsRelative;const w=o.groups;for(let A=0,N=w.length;A<N;A++){const U=w[A];this.addGroup(U.start,U.count,U.materialIndex)}const M=o.boundingBox;null!==M&&(this.boundingBox=M.clone());const R=o.boundingSphere;return null!==R&&(this.boundingSphere=R.clone()),this.drawRange.start=o.drawRange.start,this.drawRange.count=o.drawRange.count,this.userData=o.userData,void 0!==o.parameters&&(this.parameters=Object.assign({},o.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}gt.prototype.isBufferGeometry=!0;const rl=new Mn,um=new yf,hm=new pd,ac=new Ne,gd=new Ne,_d=new Ne,jE=new Ne,CC=new Ne,t_=new Ne,dm=new Ne,Vl=new Ne,qu=new Ne,yv=new Be,wf=new Be,Xu=new Be,MC=new Ne,vv=new Ne;class sl extends _t{constructor(o=new gt,c=new fa){super(),this.type="Mesh",this.geometry=o,this.material=c,this.updateMorphTargets()}copy(o){return super.copy(o),void 0!==o.morphTargetInfluences&&(this.morphTargetInfluences=o.morphTargetInfluences.slice()),void 0!==o.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},o.morphTargetDictionary)),this.material=o.material,this.geometry=o.geometry,this}updateMorphTargets(){const o=this.geometry;if(o.isBufferGeometry){const c=o.morphAttributes,d=Object.keys(c);if(d.length>0){const p=c[d[0]];if(void 0!==p){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let y=0,w=p.length;y<w;y++){const M=p[y].name||String(y);this.morphTargetInfluences.push(0),this.morphTargetDictionary[M]=y}}}}else{const c=o.morphTargets;void 0!==c&&c.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(o,c){const d=this.geometry,p=this.material,y=this.matrixWorld;if(void 0===p||(null===d.boundingSphere&&d.computeBoundingSphere(),hm.copy(d.boundingSphere),hm.applyMatrix4(y),!1===o.ray.intersectsSphere(hm))||(rl.copy(y).invert(),um.copy(o.ray).applyMatrix4(rl),null!==d.boundingBox&&!1===um.intersectsBox(d.boundingBox)))return;let w;if(d.isBufferGeometry){const M=d.index,R=d.attributes.position,A=d.morphAttributes.position,N=d.morphTargetsRelative,U=d.attributes.uv,q=d.attributes.uv2,Y=d.groups,ne=d.drawRange;if(null!==M)if(Array.isArray(p))for(let le=0,Se=Y.length;le<Se;le++){const re=Y[le],K=p[re.materialIndex];for(let ze=Math.max(re.start,ne.start),$e=Math.min(M.count,Math.min(re.start+re.count,ne.start+ne.count));ze<$e;ze+=3){const ht=M.getX(ze),Et=M.getX(ze+1),ci=M.getX(ze+2);w=i_(this,K,o,um,R,A,N,U,q,ht,Et,ci),w&&(w.faceIndex=Math.floor(ze/3),w.face.materialIndex=re.materialIndex,c.push(w))}}else for(let re=Math.max(0,ne.start),K=Math.min(M.count,ne.start+ne.count);re<K;re+=3){const Oe=M.getX(re),xe=M.getX(re+1),ze=M.getX(re+2);w=i_(this,p,o,um,R,A,N,U,q,Oe,xe,ze),w&&(w.faceIndex=Math.floor(re/3),c.push(w))}else if(void 0!==R)if(Array.isArray(p))for(let le=0,Se=Y.length;le<Se;le++){const re=Y[le],K=p[re.materialIndex];for(let ze=Math.max(re.start,ne.start),$e=Math.min(R.count,Math.min(re.start+re.count,ne.start+ne.count));ze<$e;ze+=3)w=i_(this,K,o,um,R,A,N,U,q,ze,ze+1,ze+2),w&&(w.faceIndex=Math.floor(ze/3),w.face.materialIndex=re.materialIndex,c.push(w))}else for(let re=Math.max(0,ne.start),K=Math.min(R.count,ne.start+ne.count);re<K;re+=3)w=i_(this,p,o,um,R,A,N,U,q,re,re+1,re+2),w&&(w.faceIndex=Math.floor(re/3),c.push(w))}else d.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}function i_(g,o,c,d,p,y,w,M,R,A,N,U){ac.fromBufferAttribute(p,A),gd.fromBufferAttribute(p,N),_d.fromBufferAttribute(p,U);const q=g.morphTargetInfluences;if(y&&q){dm.set(0,0,0),Vl.set(0,0,0),qu.set(0,0,0);for(let ne=0,le=y.length;ne<le;ne++){const Se=q[ne],re=y[ne];0!==Se&&(jE.fromBufferAttribute(re,A),CC.fromBufferAttribute(re,N),t_.fromBufferAttribute(re,U),w?(dm.addScaledVector(jE,Se),Vl.addScaledVector(CC,Se),qu.addScaledVector(t_,Se)):(dm.addScaledVector(jE.sub(ac),Se),Vl.addScaledVector(CC.sub(gd),Se),qu.addScaledVector(t_.sub(_d),Se)))}ac.add(dm),gd.add(Vl),_d.add(qu)}g.isSkinnedMesh&&(g.boneTransform(A,ac),g.boneTransform(N,gd),g.boneTransform(U,_d));const Y=function EL(g,o,c,d,p,y,w,M){let R;if(R=1===o.side?d.intersectTriangle(w,y,p,!0,M):d.intersectTriangle(p,y,w,2!==o.side,M),null===R)return null;vv.copy(M),vv.applyMatrix4(g.matrixWorld);const A=c.ray.origin.distanceTo(vv);return A<c.near||A>c.far?null:{distance:A,point:vv.clone(),object:g}}(g,o,c,d,ac,gd,_d,MC);if(Y){M&&(yv.fromBufferAttribute(M,A),wf.fromBufferAttribute(M,N),Xu.fromBufferAttribute(M,U),Y.uv=ha.getUV(MC,ac,gd,_d,yv,wf,Xu,new Be)),R&&(yv.fromBufferAttribute(R,A),wf.fromBufferAttribute(R,N),Xu.fromBufferAttribute(R,U),Y.uv2=ha.getUV(MC,ac,gd,_d,yv,wf,Xu,new Be));const ne={a:A,b:N,c:U,normal:new Ne,materialIndex:0};ha.getNormal(ac,gd,_d,ne.normal),Y.face=ne}return Y}sl.prototype.isMesh=!0;class xh extends gt{constructor(o=1,c=1,d=1,p=1,y=1,w=1){super(),this.type="BoxGeometry",this.parameters={width:o,height:c,depth:d,widthSegments:p,heightSegments:y,depthSegments:w};const M=this;p=Math.floor(p),y=Math.floor(y),w=Math.floor(w);const R=[],A=[],N=[],U=[];let q=0,Y=0;function ne(le,Se,re,K,Oe,xe,ze,$e,ht,Et,ci){const Yt=xe/ht,Pe=ze/Et,bt=xe/2,Ft=ze/2,zt=$e/2,Qt=ht+1,Ut=Et+1;let ue=0,Xt=0;const ui=new Ne;for(let hi=0;hi<Ut;hi++){const Bi=hi*Pe-Ft;for(let yn=0;yn<Qt;yn++)ui[le]=(yn*Yt-bt)*K,ui[Se]=Bi*Oe,ui[re]=zt,A.push(ui.x,ui.y,ui.z),ui[le]=0,ui[Se]=0,ui[re]=$e>0?1:-1,N.push(ui.x,ui.y,ui.z),U.push(yn/ht),U.push(1-hi/Et),ue+=1}for(let hi=0;hi<Et;hi++)for(let Bi=0;Bi<ht;Bi++){const Yn=q+Bi+Qt*(hi+1),ur=q+(Bi+1)+Qt*(hi+1),At=q+(Bi+1)+Qt*hi;R.push(q+Bi+Qt*hi,Yn,At),R.push(Yn,ur,At),Xt+=6}M.addGroup(Y,Xt,ci),Y+=Xt,q+=ue}ne("z","y","x",-1,-1,d,c,o,w,y,0),ne("z","y","x",1,-1,d,c,-o,w,y,1),ne("x","z","y",1,1,o,d,c,p,w,2),ne("x","z","y",1,-1,o,d,-c,p,w,3),ne("x","y","z",1,-1,o,c,d,p,y,4),ne("x","y","z",-1,-1,o,c,-d,p,y,5),this.setIndex(R),this.setAttribute("position",new Wn(A,3)),this.setAttribute("normal",new Wn(N,3)),this.setAttribute("uv",new Wn(U,2))}static fromJSON(o){return new xh(o.width,o.height,o.depth,o.widthSegments,o.heightSegments,o.depthSegments)}}function fm(g){const o={};for(const c in g){o[c]={};for(const d in g[c]){const p=g[c][d];o[c][d]=p&&(p.isColor||p.isMatrix3||p.isMatrix4||p.isVector2||p.isVector3||p.isVector4||p.isTexture||p.isQuaternion)?p.clone():Array.isArray(p)?p.slice():p}}return o}function zl(g){const o={};for(let c=0;c<g.length;c++){const d=fm(g[c]);for(const p in d)o[p]=d[p]}return o}const qE={clone:fm,merge:zl};class yd extends da{constructor(o){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==o&&(void 0!==o.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(o))}copy(o){return super.copy(o),this.fragmentShader=o.fragmentShader,this.vertexShader=o.vertexShader,this.uniforms=fm(o.uniforms),this.defines=Object.assign({},o.defines),this.wireframe=o.wireframe,this.wireframeLinewidth=o.wireframeLinewidth,this.lights=o.lights,this.clipping=o.clipping,this.extensions=Object.assign({},o.extensions),this.glslVersion=o.glslVersion,this}toJSON(o){const c=super.toJSON(o);c.glslVersion=this.glslVersion,c.uniforms={};for(const p in this.uniforms){const w=this.uniforms[p].value;c.uniforms[p]=w&&w.isTexture?{type:"t",value:w.toJSON(o).uuid}:w&&w.isColor?{type:"c",value:w.getHex()}:w&&w.isVector2?{type:"v2",value:w.toArray()}:w&&w.isVector3?{type:"v3",value:w.toArray()}:w&&w.isVector4?{type:"v4",value:w.toArray()}:w&&w.isMatrix3?{type:"m3",value:w.toArray()}:w&&w.isMatrix4?{type:"m4",value:w.toArray()}:{value:w}}Object.keys(this.defines).length>0&&(c.defines=this.defines),c.vertexShader=this.vertexShader,c.fragmentShader=this.fragmentShader;const d={};for(const p in this.extensions)!0===this.extensions[p]&&(d[p]=!0);return Object.keys(d).length>0&&(c.extensions=d),c}}yd.prototype.isShaderMaterial=!0;class n_ extends _t{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new Mn,this.projectionMatrix=new Mn,this.projectionMatrixInverse=new Mn}copy(o,c){return super.copy(o,c),this.matrixWorldInverse.copy(o.matrixWorldInverse),this.projectionMatrix.copy(o.projectionMatrix),this.projectionMatrixInverse.copy(o.projectionMatrixInverse),this}getWorldDirection(o){this.updateWorldMatrix(!0,!1);const c=this.matrixWorld.elements;return o.set(-c[8],-c[9],-c[10]).normalize()}updateMatrixWorld(o){super.updateMatrixWorld(o),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(o,c){super.updateWorldMatrix(o,c),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}n_.prototype.isCamera=!0;class vl extends n_{constructor(o=50,c=1,d=.1,p=2e3){super(),this.type="PerspectiveCamera",this.fov=o,this.zoom=1,this.near=d,this.far=p,this.focus=10,this.aspect=c,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(o,c){return super.copy(o,c),this.fov=o.fov,this.zoom=o.zoom,this.near=o.near,this.far=o.far,this.focus=o.focus,this.aspect=o.aspect,this.view=null===o.view?null:Object.assign({},o.view),this.filmGauge=o.filmGauge,this.filmOffset=o.filmOffset,this}setFocalLength(o){const c=.5*this.getFilmHeight()/o;this.fov=2*ff*Math.atan(c),this.updateProjectionMatrix()}getFocalLength(){const o=Math.tan(.5*ud*this.fov);return.5*this.getFilmHeight()/o}getEffectiveFOV(){return 2*ff*Math.atan(Math.tan(.5*ud*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(o,c,d,p,y,w){this.aspect=o/c,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=o,this.view.fullHeight=c,this.view.offsetX=d,this.view.offsetY=p,this.view.width=y,this.view.height=w,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const o=this.near;let c=o*Math.tan(.5*ud*this.fov)/this.zoom,d=2*c,p=this.aspect*d,y=-.5*p;const w=this.view;if(null!==this.view&&this.view.enabled){const R=w.fullWidth,A=w.fullHeight;y+=w.offsetX*p/R,c-=w.offsetY*d/A,p*=w.width/R,d*=w.height/A}const M=this.filmOffset;0!==M&&(y+=o*M/this.getFilmWidth()),this.projectionMatrix.makePerspective(y,y+p,c,c-d,o,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(o){const c=super.toJSON(o);return c.object.fov=this.fov,c.object.zoom=this.zoom,c.object.near=this.near,c.object.far=this.far,c.object.focus=this.focus,c.object.aspect=this.aspect,null!==this.view&&(c.object.view=Object.assign({},this.view)),c.object.filmGauge=this.filmGauge,c.object.filmOffset=this.filmOffset,c}}vl.prototype.isPerspectiveCamera=!0;class sx extends _t{constructor(o,c,d){if(super(),this.type="CubeCamera",!0!==d.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=d;const p=new vl(90,1,o,c);p.layers=this.layers,p.up.set(0,-1,0),p.lookAt(new Ne(1,0,0)),this.add(p);const y=new vl(90,1,o,c);y.layers=this.layers,y.up.set(0,-1,0),y.lookAt(new Ne(-1,0,0)),this.add(y);const w=new vl(90,1,o,c);w.layers=this.layers,w.up.set(0,0,1),w.lookAt(new Ne(0,1,0)),this.add(w);const M=new vl(90,1,o,c);M.layers=this.layers,M.up.set(0,0,-1),M.lookAt(new Ne(0,-1,0)),this.add(M);const R=new vl(90,1,o,c);R.layers=this.layers,R.up.set(0,-1,0),R.lookAt(new Ne(0,0,1)),this.add(R);const A=new vl(90,1,o,c);A.layers=this.layers,A.up.set(0,-1,0),A.lookAt(new Ne(0,0,-1)),this.add(A)}update(o,c){null===this.parent&&this.updateMatrixWorld();const d=this.renderTarget,[p,y,w,M,R,A]=this.children,N=o.xr.enabled,U=o.getRenderTarget();o.xr.enabled=!1;const q=d.texture.generateMipmaps;d.texture.generateMipmaps=!1,o.setRenderTarget(d,0),o.render(c,p),o.setRenderTarget(d,1),o.render(c,y),o.setRenderTarget(d,2),o.render(c,w),o.setRenderTarget(d,3),o.render(c,M),o.setRenderTarget(d,4),o.render(c,R),d.texture.generateMipmaps=q,o.setRenderTarget(d,5),o.render(c,A),o.setRenderTarget(U),o.xr.enabled=N,d.texture.needsPMREMUpdate=!0}}class r_ extends Jr{constructor(o,c,d,p,y,w,M,R,A,N){super(o=void 0!==o?o:[],c=void 0!==c?c:301,d,p,y,w,M,R,A,N),this.flipY=!1}get images(){return this.image}set images(o){this.image=o}}r_.prototype.isCubeTexture=!0;class Ul extends bs{constructor(o,c,d){Number.isInteger(c)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),c=d),super(o,o,c),this.texture=new r_(void 0,(c=c||{}).mapping,c.wrapS,c.wrapT,c.magFilter,c.minFilter,c.format,c.type,c.anisotropy,c.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==c.generateMipmaps&&c.generateMipmaps,this.texture.minFilter=void 0!==c.minFilter?c.minFilter:tt}fromEquirectangularTexture(o,c){this.texture.type=c.type,this.texture.format=Ua,this.texture.encoding=c.encoding,this.texture.generateMipmaps=c.generateMipmaps,this.texture.minFilter=c.minFilter,this.texture.magFilter=c.magFilter;const d_uniforms={tEquirect:{value:null}},d_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",d_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",p=new xh(5,5,5),y=new yd({name:"CubemapFromEquirect",uniforms:fm(d_uniforms),vertexShader:d_vertexShader,fragmentShader:d_fragmentShader,side:1,blending:0});y.uniforms.tEquirect.value=c;const w=new sl(p,y),M=c.minFilter;return c.minFilter===Gi&&(c.minFilter=tt),new sx(1,10,this).update(o,w),c.minFilter=M,w.geometry.dispose(),w.material.dispose(),this}clear(o,c,d,p){const y=o.getRenderTarget();for(let w=0;w<6;w++)o.setRenderTarget(this,w),o.clear(c,d,p);o.setRenderTarget(y)}}Ul.prototype.isWebGLCubeRenderTarget=!0;const vd=new Ne,Ta=new Ne,Zu=new Hn;class bd{constructor(o=new Ne(1,0,0),c=0){this.normal=o,this.constant=c}set(o,c){return this.normal.copy(o),this.constant=c,this}setComponents(o,c,d,p){return this.normal.set(o,c,d),this.constant=p,this}setFromNormalAndCoplanarPoint(o,c){return this.normal.copy(o),this.constant=-c.dot(this.normal),this}setFromCoplanarPoints(o,c,d){const p=vd.subVectors(d,c).cross(Ta.subVectors(o,c)).normalize();return this.setFromNormalAndCoplanarPoint(p,o),this}copy(o){return this.normal.copy(o.normal),this.constant=o.constant,this}normalize(){const o=1/this.normal.length();return this.normal.multiplyScalar(o),this.constant*=o,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(o){return this.normal.dot(o)+this.constant}distanceToSphere(o){return this.distanceToPoint(o.center)-o.radius}projectPoint(o,c){return c.copy(this.normal).multiplyScalar(-this.distanceToPoint(o)).add(o)}intersectLine(o,c){const d=o.delta(vd),p=this.normal.dot(d);if(0===p)return 0===this.distanceToPoint(o.start)?c.copy(o.start):null;const y=-(o.start.dot(this.normal)+this.constant)/p;return y<0||y>1?null:c.copy(d).multiplyScalar(y).add(o.start)}intersectsLine(o){const c=this.distanceToPoint(o.start),d=this.distanceToPoint(o.end);return c<0&&d>0||d<0&&c>0}intersectsBox(o){return o.intersectsPlane(this)}intersectsSphere(o){return o.intersectsPlane(this)}coplanarPoint(o){return o.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(o,c){const d=c||Zu.getNormalMatrix(o),p=this.coplanarPoint(vd).applyMatrix4(o),y=this.normal.applyMatrix3(d).normalize();return this.constant=-p.dot(y),this}translate(o){return this.constant-=o.dot(this.normal),this}equals(o){return o.normal.equals(this.normal)&&o.constant===this.constant}clone(){return(new this.constructor).copy(this)}}bd.prototype.isPlane=!0;const xd=new pd,ox=new Ne;class bv{constructor(o=new bd,c=new bd,d=new bd,p=new bd,y=new bd,w=new bd){this.planes=[o,c,d,p,y,w]}set(o,c,d,p,y,w){const M=this.planes;return M[0].copy(o),M[1].copy(c),M[2].copy(d),M[3].copy(p),M[4].copy(y),M[5].copy(w),this}copy(o){const c=this.planes;for(let d=0;d<6;d++)c[d].copy(o.planes[d]);return this}setFromProjectionMatrix(o){const c=this.planes,d=o.elements,p=d[0],y=d[1],w=d[2],M=d[3],R=d[4],A=d[5],N=d[6],U=d[7],q=d[8],Y=d[9],ne=d[10],le=d[11],Se=d[12],re=d[13],K=d[14],Oe=d[15];return c[0].setComponents(M-p,U-R,le-q,Oe-Se).normalize(),c[1].setComponents(M+p,U+R,le+q,Oe+Se).normalize(),c[2].setComponents(M+y,U+A,le+Y,Oe+re).normalize(),c[3].setComponents(M-y,U-A,le-Y,Oe-re).normalize(),c[4].setComponents(M-w,U-N,le-ne,Oe-K).normalize(),c[5].setComponents(M+w,U+N,le+ne,Oe+K).normalize(),this}intersectsObject(o){const c=o.geometry;return null===c.boundingSphere&&c.computeBoundingSphere(),xd.copy(c.boundingSphere).applyMatrix4(o.matrixWorld),this.intersectsSphere(xd)}intersectsSprite(o){return xd.center.set(0,0,0),xd.radius=.7071067811865476,xd.applyMatrix4(o.matrixWorld),this.intersectsSphere(xd)}intersectsSphere(o){const c=this.planes,d=o.center,p=-o.radius;for(let y=0;y<6;y++)if(c[y].distanceToPoint(d)<p)return!1;return!0}intersectsBox(o){const c=this.planes;for(let d=0;d<6;d++){const p=c[d];if(ox.x=p.normal.x>0?o.max.x:o.min.x,ox.y=p.normal.y>0?o.max.y:o.min.y,ox.z=p.normal.z>0?o.max.z:o.min.z,p.distanceToPoint(ox)<0)return!1}return!0}containsPoint(o){const c=this.planes;for(let d=0;d<6;d++)if(c[d].distanceToPoint(o)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function ZE(){let g=null,o=!1,c=null,d=null;function p(y,w){c(y,w),d=g.requestAnimationFrame(p)}return{start:function(){!0!==o&&null!==c&&(d=g.requestAnimationFrame(p),o=!0)},stop:function(){g.cancelAnimationFrame(d),o=!1},setAnimationLoop:function(y){c=y},setContext:function(y){g=y}}}function ax(g,o){const c=o.isWebGL2,d=new WeakMap;return{get:function w(A){return A.isInterleavedBufferAttribute&&(A=A.data),d.get(A)},remove:function M(A){A.isInterleavedBufferAttribute&&(A=A.data);const N=d.get(A);N&&(g.deleteBuffer(N.buffer),d.delete(A))},update:function R(A,N){if(A.isGLBufferAttribute){const q=d.get(A);return void((!q||q.version<A.version)&&d.set(A,{buffer:A.buffer,type:A.type,bytesPerElement:A.elementSize,version:A.version}))}A.isInterleavedBufferAttribute&&(A=A.data);const U=d.get(A);void 0===U?d.set(A,function p(A,N){const U=A.array,q=A.usage,Y=g.createBuffer();g.bindBuffer(N,Y),g.bufferData(N,U,q),A.onUploadCallback();let ne=g.FLOAT;return U instanceof Float32Array?ne=g.FLOAT:U instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):U instanceof Uint16Array?A.isFloat16BufferAttribute?c?ne=g.HALF_FLOAT:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):ne=g.UNSIGNED_SHORT:U instanceof Int16Array?ne=g.SHORT:U instanceof Uint32Array?ne=g.UNSIGNED_INT:U instanceof Int32Array?ne=g.INT:U instanceof Int8Array?ne=g.BYTE:(U instanceof Uint8Array||U instanceof Uint8ClampedArray)&&(ne=g.UNSIGNED_BYTE),{buffer:Y,type:ne,bytesPerElement:U.BYTES_PER_ELEMENT,version:A.version}}(A,N)):U.version<A.version&&(function y(A,N,U){const q=N.array,Y=N.updateRange;g.bindBuffer(U,A),-1===Y.count?g.bufferSubData(U,0,q):(c?g.bufferSubData(U,Y.offset*q.BYTES_PER_ELEMENT,q,Y.offset,Y.count):g.bufferSubData(U,Y.offset*q.BYTES_PER_ELEMENT,q.subarray(Y.offset,Y.offset+Y.count)),Y.count=-1)}(U.buffer,A,N),U.version=A.version)}}}class wd extends gt{constructor(o=1,c=1,d=1,p=1){super(),this.type="PlaneGeometry",this.parameters={width:o,height:c,widthSegments:d,heightSegments:p};const y=o/2,w=c/2,M=Math.floor(d),R=Math.floor(p),A=M+1,N=R+1,U=o/M,q=c/R,Y=[],ne=[],le=[],Se=[];for(let re=0;re<N;re++){const K=re*q-w;for(let Oe=0;Oe<A;Oe++)ne.push(Oe*U-y,-K,0),le.push(0,0,1),Se.push(Oe/M),Se.push(1-re/R)}for(let re=0;re<R;re++)for(let K=0;K<M;K++){const xe=K+A*(re+1),ze=K+1+A*(re+1),$e=K+1+A*re;Y.push(K+A*re,xe,$e),Y.push(xe,ze,$e)}this.setIndex(Y),this.setAttribute("position",new Wn(ne,3)),this.setAttribute("normal",new Wn(le,3)),this.setAttribute("uv",new Wn(Se,2))}static fromJSON(o){return new wd(o.width,o.height,o.widthSegments,o.heightSegments)}}const Cs={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 ) + 0.5;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t}\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\t\tuv *= texelSize;\n\t\treturn texture2D( envMap, uv ).rgb;\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec;\n\t\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\t\treflectVec = reflect( - viewDir, normal );\n\t\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\t#else\n\t\t\t\treflectVec = refract( - viewDir, normal, refractionRatio );\n\t\t\t#endif\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tlightMapIrradiance *= PI;\n\t#endif\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\tvec3 FssEss = specularColor * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(\t\t0, 1,\t\t0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1, 2 ) * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform vec2 morphTargetsTextureSize;\n\t\tvec3 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset, const in int stride ) {\n\t\t\tfloat texelIndex = float( vertexIndex * stride + offset );\n\t\t\tfloat y = floor( texelIndex / morphTargetsTextureSize.x );\n\t\t\tfloat x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tvec3 morphUV = vec3( ( x + 0.5 ) / morphTargetsTextureSize.x, y / morphTargetsTextureSize.y, morphTargetIndex );\n\t\t\treturn texture( morphTargetsTexture, morphUV ).xyz;\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\t#ifndef USE_MORPHNORMALS\n\t\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 1 ) * morphTargetInfluences[ i ];\n\t\t\t#else\n\t\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 2 ) * morphTargetInfluences[ i ];\n\t\t\t#endif\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t\tf.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t\tf.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(\t1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,\t1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,\t1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationColor, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tgl_FragColor = texture2D( t2D, vUv );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},hn={common:{diffuse:{value:new cn(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Hn},uv2Transform:{value:new Hn},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Be(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new cn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new cn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Hn}},sprite:{diffuse:{value:new cn(16777215)},opacity:{value:1},center:{value:new Be(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Hn}}},Sh={basic:{uniforms:zl([hn.common,hn.specularmap,hn.envmap,hn.aomap,hn.lightmap,hn.fog]),vertexShader:Cs.meshbasic_vert,fragmentShader:Cs.meshbasic_frag},lambert:{uniforms:zl([hn.common,hn.specularmap,hn.envmap,hn.aomap,hn.lightmap,hn.emissivemap,hn.fog,hn.lights,{emissive:{value:new cn(0)}}]),vertexShader:Cs.meshlambert_vert,fragmentShader:Cs.meshlambert_frag},phong:{uniforms:zl([hn.common,hn.specularmap,hn.envmap,hn.aomap,hn.lightmap,hn.emissivemap,hn.bumpmap,hn.normalmap,hn.displacementmap,hn.fog,hn.lights,{emissive:{value:new cn(0)},specular:{value:new cn(1118481)},shininess:{value:30}}]),vertexShader:Cs.meshphong_vert,fragmentShader:Cs.meshphong_frag},standard:{uniforms:zl([hn.common,hn.envmap,hn.aomap,hn.lightmap,hn.emissivemap,hn.bumpmap,hn.normalmap,hn.displacementmap,hn.roughnessmap,hn.metalnessmap,hn.fog,hn.lights,{emissive:{value:new cn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Cs.meshphysical_vert,fragmentShader:Cs.meshphysical_frag},toon:{uniforms:zl([hn.common,hn.aomap,hn.lightmap,hn.emissivemap,hn.bumpmap,hn.normalmap,hn.displacementmap,hn.gradientmap,hn.fog,hn.lights,{emissive:{value:new cn(0)}}]),vertexShader:Cs.meshtoon_vert,fragmentShader:Cs.meshtoon_frag},matcap:{uniforms:zl([hn.common,hn.bumpmap,hn.normalmap,hn.displacementmap,hn.fog,{matcap:{value:null}}]),vertexShader:Cs.meshmatcap_vert,fragmentShader:Cs.meshmatcap_frag},points:{uniforms:zl([hn.points,hn.fog]),vertexShader:Cs.points_vert,fragmentShader:Cs.points_frag},dashed:{uniforms:zl([hn.common,hn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Cs.linedashed_vert,fragmentShader:Cs.linedashed_frag},depth:{uniforms:zl([hn.common,hn.displacementmap]),vertexShader:Cs.depth_vert,fragmentShader:Cs.depth_frag},normal:{uniforms:zl([hn.common,hn.bumpmap,hn.normalmap,hn.displacementmap,{opacity:{value:1}}]),vertexShader:Cs.meshnormal_vert,fragmentShader:Cs.meshnormal_frag},sprite:{uniforms:zl([hn.sprite,hn.fog]),vertexShader:Cs.sprite_vert,fragmentShader:Cs.sprite_frag},background:{uniforms:{uvTransform:{value:new Hn},t2D:{value:null}},vertexShader:Cs.background_vert,fragmentShader:Cs.background_frag},cube:{uniforms:zl([hn.envmap,{opacity:{value:1}}]),vertexShader:Cs.cube_vert,fragmentShader:Cs.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Cs.equirect_vert,fragmentShader:Cs.equirect_frag},distanceRGBA:{uniforms:zl([hn.common,hn.displacementmap,{referencePosition:{value:new Ne},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Cs.distanceRGBA_vert,fragmentShader:Cs.distanceRGBA_frag},shadow:{uniforms:zl([hn.lights,hn.fog,{color:{value:new cn(0)},opacity:{value:1}}]),vertexShader:Cs.shadow_vert,fragmentShader:Cs.shadow_frag}};function iO(g,o,c,d,p,y){const w=new cn(0);let R,A,M=!0===p?0:1,N=null,U=0,q=null;function ne(le,Se){c.buffers.color.setClear(le.r,le.g,le.b,Se,y)}return{getClearColor:function(){return w},setClearColor:function(le,Se=1){w.set(le),M=Se,ne(w,M)},getClearAlpha:function(){return M},setClearAlpha:function(le){M=le,ne(w,M)},render:function Y(le,Se){let re=!1,K=!0===Se.isScene?Se.background:null;K&&K.isTexture&&(K=o.get(K));const Oe=g.xr,xe=Oe.getSession&&Oe.getSession();xe&&"additive"===xe.environmentBlendMode&&(K=null),null===K?ne(w,M):K&&K.isColor&&(ne(K,1),re=!0),(g.autoClear||re)&&g.clear(g.autoClearColor,g.autoClearDepth,g.autoClearStencil),K&&(K.isCubeTexture||306===K.mapping)?(void 0===A&&(A=new sl(new xh(1,1,1),new yd({name:"BackgroundCubeMaterial",uniforms:fm(Sh.cube.uniforms),vertexShader:Sh.cube.vertexShader,fragmentShader:Sh.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),A.geometry.deleteAttribute("normal"),A.geometry.deleteAttribute("uv"),A.onBeforeRender=function(ze,$e,ht){this.matrixWorld.copyPosition(ht.matrixWorld)},Object.defineProperty(A.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),d.update(A)),A.material.uniforms.envMap.value=K,A.material.uniforms.flipEnvMap.value=K.isCubeTexture&&!1===K.isRenderTargetTexture?-1:1,(N!==K||U!==K.version||q!==g.toneMapping)&&(A.material.needsUpdate=!0,N=K,U=K.version,q=g.toneMapping),le.unshift(A,A.geometry,A.material,0,0,null)):K&&K.isTexture&&(void 0===R&&(R=new sl(new wd(2,2),new yd({name:"BackgroundMaterial",uniforms:fm(Sh.background.uniforms),vertexShader:Sh.background.vertexShader,fragmentShader:Sh.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),R.geometry.deleteAttribute("normal"),Object.defineProperty(R.material,"map",{get:function(){return this.uniforms.t2D.value}}),d.update(R)),R.material.uniforms.t2D.value=K,!0===K.matrixAutoUpdate&&K.updateMatrix(),R.material.uniforms.uvTransform.value.copy(K.matrix),(N!==K||U!==K.version||q!==g.toneMapping)&&(R.material.needsUpdate=!0,N=K,U=K.version,q=g.toneMapping),le.unshift(R,R.geometry,R.material,0,0,null))}}}function nO(g,o,c,d){const p=g.getParameter(g.MAX_VERTEX_ATTRIBS),y=d.isWebGL2?null:o.get("OES_vertex_array_object"),w=d.isWebGL2||null!==y,M={},R=le(null);let A=R;function q(Ft){return d.isWebGL2?g.bindVertexArray(Ft):y.bindVertexArrayOES(Ft)}function Y(Ft){return d.isWebGL2?g.deleteVertexArray(Ft):y.deleteVertexArrayOES(Ft)}function le(Ft){const zt=[],Qt=[],Ut=[];for(let ue=0;ue<p;ue++)zt[ue]=0,Qt[ue]=0,Ut[ue]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:zt,enabledAttributes:Qt,attributeDivisors:Ut,object:Ft,attributes:{},index:null}}function K(){const Ft=A.newAttributes;for(let zt=0,Qt=Ft.length;zt<Qt;zt++)Ft[zt]=0}function Oe(Ft){xe(Ft,0)}function xe(Ft,zt){const Ut=A.enabledAttributes,ue=A.attributeDivisors;A.newAttributes[Ft]=1,0===Ut[Ft]&&(g.enableVertexAttribArray(Ft),Ut[Ft]=1),ue[Ft]!==zt&&((d.isWebGL2?g:o.get("ANGLE_instanced_arrays"))[d.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](Ft,zt),ue[Ft]=zt)}function ze(){const Ft=A.newAttributes,zt=A.enabledAttributes;for(let Qt=0,Ut=zt.length;Qt<Ut;Qt++)zt[Qt]!==Ft[Qt]&&(g.disableVertexAttribArray(Qt),zt[Qt]=0)}function $e(Ft,zt,Qt,Ut,ue,Xt){!0!==d.isWebGL2||Qt!==g.INT&&Qt!==g.UNSIGNED_INT?g.vertexAttribPointer(Ft,zt,Qt,Ut,ue,Xt):g.vertexAttribIPointer(Ft,zt,Qt,ue,Xt)}function Pe(){bt(),A!==R&&(A=R,q(A.object))}function bt(){R.geometry=null,R.program=null,R.wireframe=!1}return{setup:function N(Ft,zt,Qt,Ut,ue){let Xt=!1;if(w){const ui=function ne(Ft,zt,Qt){const Ut=!0===Qt.wireframe;let ue=M[Ft.id];void 0===ue&&(ue={},M[Ft.id]=ue);let Xt=ue[zt.id];void 0===Xt&&(Xt={},ue[zt.id]=Xt);let ui=Xt[Ut];return void 0===ui&&(ui=le(function U(){return d.isWebGL2?g.createVertexArray():y.createVertexArrayOES()}()),Xt[Ut]=ui),ui}(Ut,Qt,zt);A!==ui&&(A=ui,q(A.object)),Xt=function Se(Ft,zt){const Qt=A.attributes,Ut=Ft.attributes;let ue=0;for(const Xt in Ut){const ui=Qt[Xt],hi=Ut[Xt];if(void 0===ui||ui.attribute!==hi||ui.data!==hi.data)return!0;ue++}return A.attributesNum!==ue||A.index!==zt}(Ut,ue),Xt&&function re(Ft,zt){const Qt={},Ut=Ft.attributes;let ue=0;for(const Xt in Ut){const ui=Ut[Xt],hi={};hi.attribute=ui,ui.data&&(hi.data=ui.data),Qt[Xt]=hi,ue++}A.attributes=Qt,A.attributesNum=ue,A.index=zt}(Ut,ue)}else{const ui=!0===zt.wireframe;(A.geometry!==Ut.id||A.program!==Qt.id||A.wireframe!==ui)&&(A.geometry=Ut.id,A.program=Qt.id,A.wireframe=ui,Xt=!0)}!0===Ft.isInstancedMesh&&(Xt=!0),null!==ue&&c.update(ue,g.ELEMENT_ARRAY_BUFFER),Xt&&(function ht(Ft,zt,Qt,Ut){if(!1===d.isWebGL2&&(Ft.isInstancedMesh||Ut.isInstancedBufferGeometry)&&null===o.get("ANGLE_instanced_arrays"))return;K();const ue=Ut.attributes,Xt=Qt.getAttributes(),ui=zt.defaultAttributeValues;for(const hi in Xt){const Bi=Xt[hi];if(Bi.location>=0){let yn=ue[hi];if(void 0===yn&&("instanceMatrix"===hi&&Ft.instanceMatrix&&(yn=Ft.instanceMatrix),"instanceColor"===hi&&Ft.instanceColor&&(yn=Ft.instanceColor)),void 0!==yn){const Yn=yn.normalized,ur=yn.itemSize,At=c.get(yn);if(void 0===At)continue;const oo=At.buffer,sr=At.type,Nr=At.bytesPerElement;if(yn.isInterleavedBufferAttribute){const Fn=yn.data,ws=Fn.stride,Xr=yn.offset;if(Fn&&Fn.isInstancedInterleavedBuffer){for(let Ai=0;Ai<Bi.locationSize;Ai++)xe(Bi.location+Ai,Fn.meshPerAttribute);!0!==Ft.isInstancedMesh&&void 0===Ut._maxInstanceCount&&(Ut._maxInstanceCount=Fn.meshPerAttribute*Fn.count)}else for(let Ai=0;Ai<Bi.locationSize;Ai++)Oe(Bi.location+Ai);g.bindBuffer(g.ARRAY_BUFFER,oo);for(let Ai=0;Ai<Bi.locationSize;Ai++)$e(Bi.location+Ai,ur/Bi.locationSize,sr,Yn,ws*Nr,(Xr+ur/Bi.locationSize*Ai)*Nr)}else{if(yn.isInstancedBufferAttribute){for(let Fn=0;Fn<Bi.locationSize;Fn++)xe(Bi.location+Fn,yn.meshPerAttribute);!0!==Ft.isInstancedMesh&&void 0===Ut._maxInstanceCount&&(Ut._maxInstanceCount=yn.meshPerAttribute*yn.count)}else for(let Fn=0;Fn<Bi.locationSize;Fn++)Oe(Bi.location+Fn);g.bindBuffer(g.ARRAY_BUFFER,oo);for(let Fn=0;Fn<Bi.locationSize;Fn++)$e(Bi.location+Fn,ur/Bi.locationSize,sr,Yn,ur*Nr,ur/Bi.locationSize*Fn*Nr)}}else if(void 0!==ui){const Yn=ui[hi];if(void 0!==Yn)switch(Yn.length){case 2:g.vertexAttrib2fv(Bi.location,Yn);break;case 3:g.vertexAttrib3fv(Bi.location,Yn);break;case 4:g.vertexAttrib4fv(Bi.location,Yn);break;default:g.vertexAttrib1fv(Bi.location,Yn)}}}}ze()}(Ft,zt,Qt,Ut),null!==ue&&g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,c.get(ue).buffer))},reset:Pe,resetDefaultState:bt,dispose:function Et(){Pe();for(const Ft in M){const zt=M[Ft];for(const Qt in zt){const Ut=zt[Qt];for(const ue in Ut)Y(Ut[ue].object),delete Ut[ue];delete zt[Qt]}delete M[Ft]}},releaseStatesOfGeometry:function ci(Ft){if(void 0===M[Ft.id])return;const zt=M[Ft.id];for(const Qt in zt){const Ut=zt[Qt];for(const ue in Ut)Y(Ut[ue].object),delete Ut[ue];delete zt[Qt]}delete M[Ft.id]},releaseStatesOfProgram:function Yt(Ft){for(const zt in M){const Qt=M[zt];if(void 0===Qt[Ft.id])continue;const Ut=Qt[Ft.id];for(const ue in Ut)Y(Ut[ue].object),delete Ut[ue];delete Qt[Ft.id]}},initAttributes:K,enableAttribute:Oe,disableUnusedAttributes:ze}}function xx(g,o,c,d){const p=d.isWebGL2;let y;this.setMode=function w(A){y=A},this.render=function M(A,N){g.drawArrays(y,A,N),c.update(N,y,1)},this.renderInstances=function R(A,N,U){if(0===U)return;let q,Y;if(p)q=g,Y="drawArraysInstanced";else if(q=o.get("ANGLE_instanced_arrays"),Y="drawArraysInstancedANGLE",null===q)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");q[Y](y,A,N,U),c.update(N,y,U)}}function VC(g,o,c){let d;function y(ht){if("highp"===ht){if(g.getShaderPrecisionFormat(g.VERTEX_SHADER,g.HIGH_FLOAT).precision>0&&g.getShaderPrecisionFormat(g.FRAGMENT_SHADER,g.HIGH_FLOAT).precision>0)return"highp";ht="mediump"}return"mediump"===ht&&g.getShaderPrecisionFormat(g.VERTEX_SHADER,g.MEDIUM_FLOAT).precision>0&&g.getShaderPrecisionFormat(g.FRAGMENT_SHADER,g.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const w="undefined"!=typeof WebGL2RenderingContext&&g instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&g instanceof WebGL2ComputeRenderingContext;let M=void 0!==c.precision?c.precision:"highp";const R=y(M);R!==M&&(console.warn("THREE.WebGLRenderer:",M,"not supported, using",R,"instead."),M=R);const A=w||o.has("WEBGL_draw_buffers"),N=!0===c.logarithmicDepthBuffer,U=g.getParameter(g.MAX_TEXTURE_IMAGE_UNITS),q=g.getParameter(g.MAX_VERTEX_TEXTURE_IMAGE_UNITS),Y=g.getParameter(g.MAX_TEXTURE_SIZE),ne=g.getParameter(g.MAX_CUBE_MAP_TEXTURE_SIZE),le=g.getParameter(g.MAX_VERTEX_ATTRIBS),Se=g.getParameter(g.MAX_VERTEX_UNIFORM_VECTORS),re=g.getParameter(g.MAX_VARYING_VECTORS),K=g.getParameter(g.MAX_FRAGMENT_UNIFORM_VECTORS),Oe=q>0,xe=w||o.has("OES_texture_float");return{isWebGL2:w,drawBuffers:A,getMaxAnisotropy:function p(){if(void 0!==d)return d;if(!0===o.has("EXT_texture_filter_anisotropic")){const ht=o.get("EXT_texture_filter_anisotropic");d=g.getParameter(ht.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else d=0;return d},getMaxPrecision:y,precision:M,logarithmicDepthBuffer:N,maxTextures:U,maxVertexTextures:q,maxTextureSize:Y,maxCubemapSize:ne,maxAttributes:le,maxVertexUniforms:Se,maxVaryings:re,maxFragmentUniforms:K,vertexTextures:Oe,floatFragmentTextures:xe,floatVertexTextures:Oe&&xe,maxSamples:w?g.getParameter(g.MAX_SAMPLES):0}}function p_(g){const o=this;let c=null,d=0,p=!1,y=!1;const w=new bd,M=new Hn,R={value:null,needsUpdate:!1};function A(){R.value!==c&&(R.value=c,R.needsUpdate=d>0),o.numPlanes=d,o.numIntersection=0}function N(U,q,Y,ne){const le=null!==U?U.length:0;let Se=null;if(0!==le){if(Se=R.value,!0!==ne||null===Se){const re=Y+4*le,K=q.matrixWorldInverse;M.getNormalMatrix(K),(null===Se||Se.length<re)&&(Se=new Float32Array(re));for(let Oe=0,xe=Y;Oe!==le;++Oe,xe+=4)w.copy(U[Oe]).applyMatrix4(K,M),w.normal.toArray(Se,xe),Se[xe+3]=w.constant}R.value=Se,R.needsUpdate=!0}return o.numPlanes=le,o.numIntersection=0,Se}this.uniform=R,this.numPlanes=0,this.numIntersection=0,this.init=function(U,q,Y){const ne=0!==U.length||q||0!==d||p;return p=q,c=N(U,Y,0),d=U.length,ne},this.beginShadows=function(){y=!0,N(null)},this.endShadows=function(){y=!1,A()},this.setState=function(U,q,Y){const ne=U.clippingPlanes,le=U.clipIntersection,Se=U.clipShadows,re=g.get(U);if(!p||null===ne||0===ne.length||y&&!Se)y?N(null):A();else{const K=y?0:d,Oe=4*K;let xe=re.clippingState||null;R.value=xe,xe=N(ne,q,Oe,Y);for(let ze=0;ze!==Oe;++ze)xe[ze]=c[ze];re.clippingState=xe,this.numIntersection=le?this.numPlanes:0,this.numPlanes+=K}}}function rO(g){let o=new WeakMap;function c(w,M){return 303===M?w.mapping=301:304===M&&(w.mapping=302),w}function p(w){const M=w.target;M.removeEventListener("dispose",p);const R=o.get(M);void 0!==R&&(o.delete(M),R.dispose())}return{get:function d(w){if(w&&w.isTexture&&!1===w.isRenderTargetTexture){const M=w.mapping;if(303===M||304===M){if(o.has(w))return c(o.get(w).texture,w.mapping);{const R=w.image;if(R&&R.height>0){const A=new Ul(R.height/2);return A.fromEquirectangularTexture(g,w),o.set(w,A),w.addEventListener("dispose",p),c(A.texture,w.mapping)}return null}}}return w},dispose:function y(){o=new WeakMap}}}Sh.physical={uniforms:zl([Sh.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Be(1,1)},clearcoatNormalMap:{value:null},sheen:{value:0},sheenColor:{value:new cn(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Be},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new cn(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new cn(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Cs.meshphysical_vert,fragmentShader:Cs.meshphysical_frag};class Dv extends n_{constructor(o=-1,c=1,d=1,p=-1,y=.1,w=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=o,this.right=c,this.top=d,this.bottom=p,this.near=y,this.far=w,this.updateProjectionMatrix()}copy(o,c){return super.copy(o,c),this.left=o.left,this.right=o.right,this.top=o.top,this.bottom=o.bottom,this.near=o.near,this.far=o.far,this.zoom=o.zoom,this.view=null===o.view?null:Object.assign({},o.view),this}setViewOffset(o,c,d,p,y,w){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=o,this.view.fullHeight=c,this.view.offsetX=d,this.view.offsetY=p,this.view.width=y,this.view.height=w,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const o=(this.right-this.left)/(2*this.zoom),c=(this.top-this.bottom)/(2*this.zoom),d=(this.right+this.left)/2,p=(this.top+this.bottom)/2;let y=d-o,w=d+o,M=p+c,R=p-c;if(null!==this.view&&this.view.enabled){const A=(this.right-this.left)/this.view.fullWidth/this.zoom,N=(this.top-this.bottom)/this.view.fullHeight/this.zoom;y+=A*this.view.offsetX,w=y+A*this.view.width,M-=N*this.view.offsetY,R=M-N*this.view.height}this.projectionMatrix.makeOrthographic(y,w,M,R,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(o){const c=super.toJSON(o);return c.object.zoom=this.zoom,c.object.left=this.left,c.object.right=this.right,c.object.top=this.top,c.object.bottom=this.bottom,c.object.near=this.near,c.object.far=this.far,null!==this.view&&(c.object.view=Object.assign({},this.view)),c}}Dv.prototype.isOrthographicCamera=!0;class Rv extends yd{constructor(o){super(o),this.type="RawShaderMaterial"}}Rv.prototype.isRawShaderMaterial=!0;const Ch=Math.pow(2,8),zC=[.125,.215,.35,.446,.526,.582],UC=5+zC.length,GC=new Dv,{_lodPlanes:kv,_sizeLods:gA,_sigmas:wx}=sO(),_A=new cn;let Uc=null;const Cc=(1+Math.sqrt(5))/2,gm=1/Cc,yA=[new Ne(1,1,1),new Ne(-1,1,1),new Ne(1,1,-1),new Ne(-1,1,-1),new Ne(0,Cc,gm),new Ne(0,Cc,-gm),new Ne(gm,0,Cc),new Ne(-gm,0,Cc),new Ne(Cc,gm,0),new Ne(-Cc,gm,0)];class WC{constructor(o){this._renderer=o,this._pingPongRenderTarget=null,this._blurMaterial=function bA(g){const o=new Float32Array(g),c=new Ne(0,1,0);return new Rv({name:"SphericalGaussianBlur",defines:{n:g},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:o},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:c}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(20),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}fromScene(o,c=0,d=.1,p=100){Uc=this._renderer.getRenderTarget();const y=this._allocateTargets();return this._sceneToCubeUV(o,d,p,y),c>0&&this._blur(y,0,0,c),this._applyPMREM(y),this._cleanup(y),y}fromEquirectangular(o,c=null){return this._fromTexture(o,c)}fromCubemap(o,c=null){return this._fromTexture(o,c)}compileCubemapShader(){null===this._cubemapShader&&(this._cubemapShader=wA(),this._compileMaterial(this._cubemapShader))}compileEquirectangularShader(){null===this._equirectShader&&(this._equirectShader=xA(),this._compileMaterial(this._equirectShader))}dispose(){this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(let o=0;o<kv.length;o++)kv[o].dispose()}_cleanup(o){this._renderer.setRenderTarget(Uc),o.scissorTest=!1,Sx(o,0,0,o.width,o.height)}_fromTexture(o,c){Uc=this._renderer.getRenderTarget();const d=c||this._allocateTargets(o);return this._textureToCubeUV(o,d),this._applyPMREM(d),this._cleanup(d),d}_allocateTargets(o){const c={magFilter:tt,minFilter:tt,generateMipmaps:!1,type:Sa,format:Ua,encoding:od,depthBuffer:!1},d=vA(c);return d.depthBuffer=!o,null===this._pingPongRenderTarget&&(this._pingPongRenderTarget=vA(c)),d}_compileMaterial(o){const c=new sl(kv[0],o);this._renderer.compile(c,GC)}_sceneToCubeUV(o,c,d,p){const M=new vl(90,1,c,d),R=[1,-1,1,1,1,1],A=[1,1,1,-1,-1,-1],N=this._renderer,U=N.autoClear,q=N.toneMapping;N.getClearColor(_A),N.toneMapping=0,N.autoClear=!1;const Y=new fa({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),ne=new sl(new xh,Y);let le=!1;const Se=o.background;Se?Se.isColor&&(Y.color.copy(Se),o.background=null,le=!0):(Y.color.copy(_A),le=!0);for(let re=0;re<6;re++){const K=re%3;0===K?(M.up.set(0,R[re],0),M.lookAt(A[re],0,0)):1===K?(M.up.set(0,0,R[re]),M.lookAt(0,A[re],0)):(M.up.set(0,R[re],0),M.lookAt(0,0,A[re])),Sx(p,K*Ch,re>2?Ch:0,Ch,Ch),N.setRenderTarget(p),le&&N.render(ne,M),N.render(o,M)}ne.geometry.dispose(),ne.material.dispose(),N.toneMapping=q,N.autoClear=U,o.background=Se}_textureToCubeUV(o,c){const d=this._renderer,p=301===o.mapping||302===o.mapping;p?(null===this._cubemapShader&&(this._cubemapShader=wA()),this._cubemapShader.uniforms.flipEnvMap.value=!1===o.isRenderTargetTexture?-1:1):null===this._equirectShader&&(this._equirectShader=xA());const y=p?this._cubemapShader:this._equirectShader,w=new sl(kv[0],y),M=y.uniforms;M.envMap.value=o,p||M.texelSize.value.set(1/o.image.width,1/o.image.height),Sx(c,0,0,3*Ch,2*Ch),d.setRenderTarget(c),d.render(w,GC)}_applyPMREM(o){const c=this._renderer,d=c.autoClear;c.autoClear=!1;for(let p=1;p<UC;p++){const y=Math.sqrt(wx[p]*wx[p]-wx[p-1]*wx[p-1]);this._blur(o,p-1,p,y,yA[(p-1)%yA.length])}c.autoClear=d}_blur(o,c,d,p,y){const w=this._pingPongRenderTarget;this._halfBlur(o,w,c,d,p,"latitudinal",y),this._halfBlur(w,o,d,d,p,"longitudinal",y)}_halfBlur(o,c,d,p,y,w,M){const R=this._renderer,A=this._blurMaterial;"latitudinal"!==w&&"longitudinal"!==w&&console.error("blur direction must be either latitudinal or longitudinal!");const U=new sl(kv[p],A),q=A.uniforms,Y=gA[d]-1,ne=isFinite(y)?Math.PI/(2*Y):2*Math.PI/39,le=y/ne,Se=isFinite(y)?1+Math.floor(3*le):20;Se>20&&console.warn(`sigmaRadians, ${y}, is too large and will clip, as it requested ${Se} samples when the maximum is set to 20`);const re=[];let K=0;for(let $e=0;$e<20;++$e){const ht=$e/le,Et=Math.exp(-ht*ht/2);re.push(Et),0===$e?K+=Et:$e<Se&&(K+=2*Et)}for(let $e=0;$e<re.length;$e++)re[$e]=re[$e]/K;q.envMap.value=o.texture,q.samples.value=Se,q.weights.value=re,q.latitudinal.value="latitudinal"===w,M&&(q.poleAxis.value=M),q.dTheta.value=ne,q.mipInt.value=8-d;const Oe=gA[p];Sx(c,3*Math.max(0,Ch-2*Oe),(0===p?0:2*Ch)+2*Oe*(p>4?p-8+4:0),3*Oe,2*Oe),R.setRenderTarget(c),R.render(U,GC)}}function sO(){const g=[],o=[],c=[];let d=8;for(let p=0;p<UC;p++){const y=Math.pow(2,d);o.push(y);let w=1/y;p>4?w=zC[p-8+4-1]:0===p&&(w=0),c.push(w);const M=1/(y-1),R=-M/2,A=1+M/2,N=[R,R,A,R,A,A,R,R,A,A,R,A],U=6,q=6,Y=3,ne=2,le=1,Se=new Float32Array(Y*q*U),re=new Float32Array(ne*q*U),K=new Float32Array(le*q*U);for(let xe=0;xe<U;xe++){const ze=xe%3*2/3-1,$e=xe>2?0:-1;Se.set([ze,$e,0,ze+2/3,$e,0,ze+2/3,$e+1,0,ze,$e,0,ze+2/3,$e+1,0,ze,$e+1,0],Y*q*xe),re.set(N,ne*q*xe),K.set([xe,xe,xe,xe,xe,xe],le*q*xe)}const Oe=new gt;Oe.setAttribute("position",new Zn(Se,Y)),Oe.setAttribute("uv",new Zn(re,ne)),Oe.setAttribute("faceIndex",new Zn(K,le)),g.push(Oe),d>4&&d--}return{_lodPlanes:g,_sizeLods:o,_sigmas:c}}function vA(g){const o=new bs(3*Ch,3*Ch,g);return o.texture.mapping=306,o.texture.name="PMREM.cubeUv",o.scissorTest=!0,o}function Sx(g,o,c,d,p){g.viewport.set(o,c,d,p),g.scissor.set(o,c,d,p)}function xA(){const g=new Be(1,1);return new Rv({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:g}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = texture2D ( envMap, uv ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = texture2D ( envMap, uv ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = texture2D ( envMap, uv ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = texture2D ( envMap, uv ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function wA(){return new Rv({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function oO(g){let o=new WeakMap,c=null;function y(M){const R=M.target;R.removeEventListener("dispose",y);const A=o.get(R);void 0!==A&&(o.delete(R),A.dispose())}return{get:function d(M){if(M&&M.isTexture){const R=M.mapping,A=303===R||304===R,N=301===R||302===R;if(A||N){if(M.isRenderTargetTexture&&!0===M.needsPMREMUpdate){M.needsPMREMUpdate=!1;let U=o.get(M);return null===c&&(c=new WC(g)),U=A?c.fromEquirectangular(M,U):c.fromCubemap(M,U),o.set(M,U),U.texture}if(o.has(M))return o.get(M).texture;{const U=M.image;if(A&&U&&U.height>0||N&&U&&function p(M){let R=0;for(let N=0;N<6;N++)void 0!==M[N]&&R++;return 6===R}(U)){null===c&&(c=new WC(g));const q=A?c.fromEquirectangular(M):c.fromCubemap(M);return o.set(M,q),M.addEventListener("dispose",y),q.texture}return null}}}return M},dispose:function w(){o=new WeakMap,null!==c&&(c.dispose(),c=null)}}}function Qz(g){const o={};function c(d){if(void 0!==o[d])return o[d];let p;switch(d){case"WEBGL_depth_texture":p=g.getExtension("WEBGL_depth_texture")||g.getExtension("MOZ_WEBGL_depth_texture")||g.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":p=g.getExtension("EXT_texture_filter_anisotropic")||g.getExtension("MOZ_EXT_texture_filter_anisotropic")||g.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":p=g.getExtension("WEBGL_compressed_texture_s3tc")||g.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||g.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":p=g.getExtension("WEBGL_compressed_texture_pvrtc")||g.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:p=g.getExtension(d)}return o[d]=p,p}return{has:function(d){return null!==c(d)},init:function(d){d.isWebGL2?c("EXT_color_buffer_float"):(c("WEBGL_depth_texture"),c("OES_texture_float"),c("OES_texture_half_float"),c("OES_texture_half_float_linear"),c("OES_standard_derivatives"),c("OES_element_index_uint"),c("OES_vertex_array_object"),c("ANGLE_instanced_arrays")),c("OES_texture_float_linear"),c("EXT_color_buffer_half_float"),c("WEBGL_multisampled_render_to_texture")},get:function(d){const p=c(d);return null===p&&console.warn("THREE.WebGLRenderer: "+d+" extension not supported."),p}}}function aO(g,o,c,d){const p={},y=new WeakMap;function w(U){const q=U.target;null!==q.index&&o.remove(q.index);for(const ne in q.attributes)o.remove(q.attributes[ne]);q.removeEventListener("dispose",w),delete p[q.id];const Y=y.get(q);Y&&(o.remove(Y),y.delete(q)),d.releaseStatesOfGeometry(q),!0===q.isInstancedBufferGeometry&&delete q._maxInstanceCount,c.memory.geometries--}function A(U){const q=[],Y=U.index,ne=U.attributes.position;let le=0;if(null!==Y){const K=Y.array;le=Y.version;for(let Oe=0,xe=K.length;Oe<xe;Oe+=3){const ze=K[Oe+0],$e=K[Oe+1],ht=K[Oe+2];q.push(ze,$e,$e,ht,ht,ze)}}else{le=ne.version;for(let Oe=0,xe=ne.array.length/3-1;Oe<xe;Oe+=3){const ze=Oe+0,$e=Oe+1,ht=Oe+2;q.push(ze,$e,$e,ht,ht,ze)}}const Se=new(pl(q)?up:Vc)(q,1);Se.version=le;const re=y.get(U);re&&o.remove(re),y.set(U,Se)}return{get:function M(U,q){return!0===p[q.id]||(q.addEventListener("dispose",w),p[q.id]=!0,c.memory.geometries++),q},update:function R(U){const q=U.attributes;for(const ne in q)o.update(q[ne],g.ARRAY_BUFFER);const Y=U.morphAttributes;for(const ne in Y){const le=Y[ne];for(let Se=0,re=le.length;Se<re;Se++)o.update(le[Se],g.ARRAY_BUFFER)}},getWireframeAttribute:function N(U){const q=y.get(U);if(q){const Y=U.index;null!==Y&&q.version<Y.version&&A(U)}else A(U);return y.get(U)}}}function Pv(g,o,c,d){const p=d.isWebGL2;let y,M,R;this.setMode=function w(q){y=q},this.setIndex=function A(q){M=q.type,R=q.bytesPerElement},this.render=function N(q,Y){g.drawElements(y,Y,M,q*R),c.update(Y,y,1)},this.renderInstances=function U(q,Y,ne){if(0===ne)return;let le,Se;if(p)le=g,Se="drawElementsInstanced";else if(le=o.get("ANGLE_instanced_arrays"),Se="drawElementsInstancedANGLE",null===le)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");le[Se](y,Y,M,q*R,ne),c.update(Y,y,ne)}}function SA(g){const c={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:c,programs:null,autoReset:!0,reset:function p(){c.frame++,c.calls=0,c.triangles=0,c.points=0,c.lines=0},update:function d(y,w,M){switch(c.calls++,w){case g.TRIANGLES:c.triangles+=M*(y/3);break;case g.LINES:c.lines+=M*(y/2);break;case g.LINE_STRIP:c.lines+=M*(y-1);break;case g.LINE_LOOP:c.lines+=M*y;break;case g.POINTS:c.points+=M*y;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",w)}}}}class xu extends Jr{constructor(o=null,c=1,d=1,p=1){super(null),this.image={data:o,width:c,height:d,depth:p},this.magFilter=ro,this.minFilter=ro,this.wrapR=Lo,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}function Iv(g,o){return g[0]-o[0]}function CA(g,o){return Math.abs(o[1])-Math.abs(g[1])}function qC(g,o){let c=1;const d=o.isInterleavedBufferAttribute?o.data.array:o.array;d instanceof Int8Array?c=127:d instanceof Int16Array?c=32767:d instanceof Int32Array?c=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",d),g.divideScalar(c)}function MA(g,o,c){const d={},p=new Float32Array(8),y=new WeakMap,w=new Ne,M=[];for(let A=0;A<8;A++)M[A]=[A,0];return{update:function R(A,N,U,q){const Y=A.morphTargetInfluences;if(!0===o.isWebGL2){const ne=N.morphAttributes.position.length;let le=y.get(N);if(void 0===le||le.count!==ne){let bt=function(){Yt.dispose(),y.delete(N),N.removeEventListener("dispose",bt)};void 0!==le&&le.texture.dispose();const K=void 0!==N.morphAttributes.normal,Oe=N.morphAttributes.position,xe=N.morphAttributes.normal||[],$e=!0===K?2:1;let ht=N.attributes.position.count*$e,Et=1;ht>o.maxTextureSize&&(Et=Math.ceil(ht/o.maxTextureSize),ht=o.maxTextureSize);const ci=new Float32Array(ht*Et*4*ne),Yt=new xu(ci,ht,Et,ne);Yt.format=Ua,Yt.type=eo,Yt.needsUpdate=!0;const Pe=4*$e;for(let Ft=0;Ft<ne;Ft++){const zt=Oe[Ft],Qt=xe[Ft],Ut=ht*Et*4*Ft;for(let ue=0;ue<zt.count;ue++){w.fromBufferAttribute(zt,ue),!0===zt.normalized&&qC(w,zt);const Xt=ue*Pe;ci[Ut+Xt+0]=w.x,ci[Ut+Xt+1]=w.y,ci[Ut+Xt+2]=w.z,ci[Ut+Xt+3]=0,!0===K&&(w.fromBufferAttribute(Qt,ue),!0===Qt.normalized&&qC(w,Qt),ci[Ut+Xt+4]=w.x,ci[Ut+Xt+5]=w.y,ci[Ut+Xt+6]=w.z,ci[Ut+Xt+7]=0)}}le={count:ne,texture:Yt,size:new Be(ht,Et)},y.set(N,le),N.addEventListener("dispose",bt)}let Se=0;for(let K=0;K<Y.length;K++)Se+=Y[K];const re=N.morphTargetsRelative?1:1-Se;q.getUniforms().setValue(g,"morphTargetBaseInfluence",re),q.getUniforms().setValue(g,"morphTargetInfluences",Y),q.getUniforms().setValue(g,"morphTargetsTexture",le.texture,c),q.getUniforms().setValue(g,"morphTargetsTextureSize",le.size)}else{const ne=void 0===Y?0:Y.length;let le=d[N.id];if(void 0===le||le.length!==ne){le=[];for(let xe=0;xe<ne;xe++)le[xe]=[xe,0];d[N.id]=le}for(let xe=0;xe<ne;xe++){const ze=le[xe];ze[0]=xe,ze[1]=Y[xe]}le.sort(CA);for(let xe=0;xe<8;xe++)xe<ne&&le[xe][1]?(M[xe][0]=le[xe][0],M[xe][1]=le[xe][1]):(M[xe][0]=Number.MAX_SAFE_INTEGER,M[xe][1]=0);M.sort(Iv);const Se=N.morphAttributes.position,re=N.morphAttributes.normal;let K=0;for(let xe=0;xe<8;xe++){const ze=M[xe],$e=ze[0],ht=ze[1];$e!==Number.MAX_SAFE_INTEGER&&ht?(Se&&N.getAttribute("morphTarget"+xe)!==Se[$e]&&N.setAttribute("morphTarget"+xe,Se[$e]),re&&N.getAttribute("morphNormal"+xe)!==re[$e]&&N.setAttribute("morphNormal"+xe,re[$e]),p[xe]=ht,K+=ht):(Se&&!0===N.hasAttribute("morphTarget"+xe)&&N.deleteAttribute("morphTarget"+xe),re&&!0===N.hasAttribute("morphNormal"+xe)&&N.deleteAttribute("morphNormal"+xe),p[xe]=0)}const Oe=N.morphTargetsRelative?1:1-K;q.getUniforms().setValue(g,"morphTargetBaseInfluence",Oe),q.getUniforms().setValue(g,"morphTargetInfluences",p)}}}}function Jz(g,o,c,d){let p=new WeakMap;function M(R){const A=R.target;A.removeEventListener("dispose",M),c.remove(A.instanceMatrix),null!==A.instanceColor&&c.remove(A.instanceColor)}return{update:function y(R){const A=d.render.frame,U=o.get(R,R.geometry);return p.get(U)!==A&&(o.update(U),p.set(U,A)),R.isInstancedMesh&&(!1===R.hasEventListener("dispose",M)&&R.addEventListener("dispose",M),c.update(R.instanceMatrix,g.ARRAY_BUFFER),null!==R.instanceColor&&c.update(R.instanceColor,g.ARRAY_BUFFER)),U},dispose:function w(){p=new WeakMap}}}xu.prototype.isDataTexture2DArray=!0;class TA extends Jr{constructor(o=null,c=1,d=1,p=1){super(null),this.image={data:o,width:c,height:d,depth:p},this.magFilter=ro,this.minFilter=ro,this.wrapR=Lo,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}TA.prototype.isDataTexture3D=!0;const lO=new Jr,Cx=new xu,Mx=new TA,Tx=new r_,cO=[],uO=[],XC=new Float32Array(16),EA=new Float32Array(9),AA=new Float32Array(4);function m_(g,o,c){const d=g[0];if(d<=0||d>0)return g;const p=o*c;let y=cO[p];if(void 0===y&&(y=new Float32Array(p),cO[p]=y),0!==o){d.toArray(y,0);for(let w=1,M=0;w!==o;++w)M+=c,g[w].toArray(y,M)}return y}function Gc(g,o){if(g.length!==o.length)return!1;for(let c=0,d=g.length;c<d;c++)if(g[c]!==o[c])return!1;return!0}function lc(g,o){for(let c=0,d=o.length;c<d;c++)g[c]=o[c]}function _m(g,o){let c=uO[o];void 0===c&&(c=new Int32Array(o),uO[o]=c);for(let d=0;d!==o;++d)c[d]=g.allocateTextureUnit();return c}function DA(g,o){const c=this.cache;c[0]!==o&&(g.uniform1f(this.addr,o),c[0]=o)}function ZC(g,o){const c=this.cache;if(void 0!==o.x)(c[0]!==o.x||c[1]!==o.y)&&(g.uniform2f(this.addr,o.x,o.y),c[0]=o.x,c[1]=o.y);else{if(Gc(c,o))return;g.uniform2fv(this.addr,o),lc(c,o)}}function hO(g,o){const c=this.cache;if(void 0!==o.x)(c[0]!==o.x||c[1]!==o.y||c[2]!==o.z)&&(g.uniform3f(this.addr,o.x,o.y,o.z),c[0]=o.x,c[1]=o.y,c[2]=o.z);else if(void 0!==o.r)(c[0]!==o.r||c[1]!==o.g||c[2]!==o.b)&&(g.uniform3f(this.addr,o.r,o.g,o.b),c[0]=o.r,c[1]=o.g,c[2]=o.b);else{if(Gc(c,o))return;g.uniform3fv(this.addr,o),lc(c,o)}}function so(g,o){const c=this.cache;if(void 0!==o.x)(c[0]!==o.x||c[1]!==o.y||c[2]!==o.z||c[3]!==o.w)&&(g.uniform4f(this.addr,o.x,o.y,o.z,o.w),c[0]=o.x,c[1]=o.y,c[2]=o.z,c[3]=o.w);else{if(Gc(c,o))return;g.uniform4fv(this.addr,o),lc(c,o)}}function Lv(g,o){const c=this.cache,d=o.elements;if(void 0===d){if(Gc(c,o))return;g.uniformMatrix2fv(this.addr,!1,o),lc(c,o)}else{if(Gc(c,d))return;AA.set(d),g.uniformMatrix2fv(this.addr,!1,AA),lc(c,d)}}function dO(g,o){const c=this.cache,d=o.elements;if(void 0===d){if(Gc(c,o))return;g.uniformMatrix3fv(this.addr,!1,o),lc(c,o)}else{if(Gc(c,d))return;EA.set(d),g.uniformMatrix3fv(this.addr,!1,EA),lc(c,d)}}function Mc(g,o){const c=this.cache,d=o.elements;if(void 0===d){if(Gc(c,o))return;g.uniformMatrix4fv(this.addr,!1,o),lc(c,o)}else{if(Gc(c,d))return;XC.set(d),g.uniformMatrix4fv(this.addr,!1,XC),lc(c,d)}}function RA(g,o){const c=this.cache;c[0]!==o&&(g.uniform1i(this.addr,o),c[0]=o)}function fO(g,o){const c=this.cache;Gc(c,o)||(g.uniform2iv(this.addr,o),lc(c,o))}function pO(g,o){const c=this.cache;Gc(c,o)||(g.uniform3iv(this.addr,o),lc(c,o))}function mO(g,o){const c=this.cache;Gc(c,o)||(g.uniform4iv(this.addr,o),lc(c,o))}function gO(g,o){const c=this.cache;c[0]!==o&&(g.uniform1ui(this.addr,o),c[0]=o)}function _O(g,o){const c=this.cache;Gc(c,o)||(g.uniform2uiv(this.addr,o),lc(c,o))}function $z(g,o){const c=this.cache;Gc(c,o)||(g.uniform3uiv(this.addr,o),lc(c,o))}function eU(g,o){const c=this.cache;Gc(c,o)||(g.uniform4uiv(this.addr,o),lc(c,o))}function Ov(g,o,c){const d=this.cache,p=c.allocateTextureUnit();d[0]!==p&&(g.uniform1i(this.addr,p),d[0]=p),c.safeSetTexture2D(o||lO,p)}function Wc(g,o,c){const d=this.cache,p=c.allocateTextureUnit();d[0]!==p&&(g.uniform1i(this.addr,p),d[0]=p),c.setTexture3D(o||Mx,p)}function YC(g,o,c){const d=this.cache,p=c.allocateTextureUnit();d[0]!==p&&(g.uniform1i(this.addr,p),d[0]=p),c.safeSetTextureCube(o||Tx,p)}function kA(g,o,c){const d=this.cache,p=c.allocateTextureUnit();d[0]!==p&&(g.uniform1i(this.addr,p),d[0]=p),c.setTexture2DArray(o||Cx,p)}function Tc(g,o){g.uniform1fv(this.addr,o)}function Fv(g,o){const c=m_(o,this.size,2);g.uniform2fv(this.addr,c)}function KC(g,o){const c=m_(o,this.size,3);g.uniform3fv(this.addr,c)}function yO(g,o){const c=m_(o,this.size,4);g.uniform4fv(this.addr,c)}function vO(g,o){const c=m_(o,this.size,4);g.uniformMatrix2fv(this.addr,!1,c)}function IA(g,o){const c=m_(o,this.size,9);g.uniformMatrix3fv(this.addr,!1,c)}function bO(g,o){const c=m_(o,this.size,16);g.uniformMatrix4fv(this.addr,!1,c)}function LA(g,o){g.uniform1iv(this.addr,o)}function xO(g,o){g.uniform2iv(this.addr,o)}function OA(g,o){g.uniform3iv(this.addr,o)}function wO(g,o){g.uniform4iv(this.addr,o)}function SO(g,o){g.uniform1uiv(this.addr,o)}function QC(g,o){g.uniform2uiv(this.addr,o)}function CO(g,o){g.uniform3uiv(this.addr,o)}function MO(g,o){g.uniform4uiv(this.addr,o)}function JC(g,o,c){const d=o.length,p=_m(c,d);g.uniform1iv(this.addr,p);for(let y=0;y!==d;++y)c.safeSetTexture2D(o[y]||lO,p[y])}function TO(g,o,c){const d=o.length,p=_m(c,d);g.uniform1iv(this.addr,p);for(let y=0;y!==d;++y)c.setTexture3D(o[y]||Mx,p[y])}function EO(g,o,c){const d=o.length,p=_m(c,d);g.uniform1iv(this.addr,p);for(let y=0;y!==d;++y)c.safeSetTextureCube(o[y]||Tx,p[y])}function fp(g,o,c){const d=o.length,p=_m(c,d);g.uniform1iv(this.addr,p);for(let y=0;y!==d;++y)c.setTexture2DArray(o[y]||Cx,p[y])}function DO(g,o,c){this.id=g,this.addr=c,this.cache=[],this.setValue=function PA(g){switch(g){case 5126:return DA;case 35664:return ZC;case 35665:return hO;case 35666:return so;case 35674:return Lv;case 35675:return dO;case 35676:return Mc;case 5124:case 35670:return RA;case 35667:case 35671:return fO;case 35668:case 35672:return pO;case 35669:case 35673:return mO;case 5125:return gO;case 36294:return _O;case 36295:return $z;case 36296:return eU;case 35678:case 36198:case 36298:case 36306:case 35682:return Ov;case 35679:case 36299:case 36307:return Wc;case 35680:case 36300:case 36308:case 36293:return YC;case 36289:case 36303:case 36311:case 36292:return kA}}(o.type)}function FA(g,o,c){this.id=g,this.addr=c,this.cache=[],this.size=o.size,this.setValue=function AO(g){switch(g){case 5126:return Tc;case 35664:return Fv;case 35665:return KC;case 35666:return yO;case 35674:return vO;case 35675:return IA;case 35676:return bO;case 5124:case 35670:return LA;case 35667:case 35671:return xO;case 35668:case 35672:return OA;case 35669:case 35673:return wO;case 5125:return SO;case 36294:return QC;case 36295:return CO;case 36296:return MO;case 35678:case 36198:case 36298:case 36306:case 35682:return JC;case 35679:case 36299:case 36307:return TO;case 35680:case 36300:case 36308:case 36293:return EO;case 36289:case 36303:case 36311:case 36292:return fp}}(o.type)}function BA(g){this.id=g,this.seq=[],this.map={}}FA.prototype.updateCache=function(g){const o=this.cache;g instanceof Float32Array&&o.length!==g.length&&(this.cache=new Float32Array(g.length)),lc(o,g)},BA.prototype.setValue=function(g,o,c){const d=this.seq;for(let p=0,y=d.length;p!==y;++p){const w=d[p];w.setValue(g,o[w.id],c)}};const $C=/(\w+)(\])?(\[|\.)?/g;function eM(g,o){g.seq.push(o),g.map[o.id]=o}function RO(g,o,c){const d=g.name,p=d.length;for($C.lastIndex=0;;){const y=$C.exec(d),w=$C.lastIndex;let M=y[1];const A=y[3];if("]"===y[2]&&(M|=0),void 0===A||"["===A&&w+2===p){eM(c,void 0===A?new DO(M,g,o):new FA(M,g,o));break}{let U=c.map[M];void 0===U&&(U=new BA(M),eM(c,U)),c=U}}}function pp(g,o){this.seq=[],this.map={};const c=g.getProgramParameter(o,g.ACTIVE_UNIFORMS);for(let d=0;d<c;++d){const p=g.getActiveUniform(o,d);RO(p,g.getUniformLocation(o,p.name),this)}}function NA(g,o,c){const d=g.createShader(o);return g.shaderSource(d,c),g.compileShader(d),d}pp.prototype.setValue=function(g,o,c,d){const p=this.map[o];void 0!==p&&p.setValue(g,c,d)},pp.prototype.setOptional=function(g,o,c){const d=o[c];void 0!==d&&this.setValue(g,c,d)},pp.upload=function(g,o,c,d){for(let p=0,y=o.length;p!==y;++p){const w=o[p],M=c[w.id];!1!==M.needsUpdate&&w.setValue(g,M.value,d)}},pp.seqWithValue=function(g,o){const c=[];for(let d=0,p=g.length;d!==p;++d){const y=g[d];y.id in o&&c.push(y)}return c};let kO=0;function Mh(g,o,c){const d=g.getShaderParameter(o,g.COMPILE_STATUS),p=g.getShaderInfoLog(o).trim();return d&&""===p?"":c.toUpperCase()+"\n\n"+p+"\n\n"+function PO(g){const o=g.split("\n");for(let c=0;c<o.length;c++)o[c]=c+1+": "+o[c];return o.join("\n")}(g.getShaderSource(o))}function IO(g,o){const c=function Ex(g){switch(g){case od:return["Linear","( value )"];case zn:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",g),["Linear","( value )"]}}(o);return"vec4 "+g+"( vec4 value ) { return LinearTo"+c[0]+c[1]+"; }"}function g_(g,o){let c;switch(o){case 1:c="Linear";break;case 2:c="Reinhard";break;case 3:c="OptimizedCineon";break;case 4:c="ACESFilmic";break;case 5:c="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",o),c="Linear"}return"vec3 "+g+"( vec3 color ) { return "+c+"ToneMapping( color ); }"}function __(g){return""!==g}function LO(g,o){return g.replace(/NUM_DIR_LIGHTS/g,o.numDirLights).replace(/NUM_SPOT_LIGHTS/g,o.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,o.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,o.numPointLights).replace(/NUM_HEMI_LIGHTS/g,o.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,o.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,o.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,o.numPointLightShadows)}function iu(g,o){return g.replace(/NUM_CLIPPING_PLANES/g,o.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,o.numClippingPlanes-o.numClipIntersection)}const tM=/^[ \t]*#include +<([\w\d./]+)>/gm;function Bv(g){return g.replace(tM,OO)}function OO(g,o){const c=Cs[o];if(void 0===c)throw new Error("Can not resolve #include <"+o+">");return Bv(c)}const HA=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Nv=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function iM(g){return g.replace(Nv,Ax).replace(HA,VA)}function VA(g,o,c,d){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Ax(0,o,c,d)}function Ax(g,o,c,d){let p="";for(let y=parseInt(o);y<parseInt(c);y++)p+=d.replace(/\[\s*i\s*\]/g,"[ "+y+" ]").replace(/UNROLLED_LOOP_INDEX/g,y);return p}function Dx(g){let o="precision "+g.precision+" float;\nprecision "+g.precision+" int;";return"highp"===g.precision?o+="\n#define HIGH_PRECISION":"mediump"===g.precision?o+="\n#define MEDIUM_PRECISION":"lowp"===g.precision&&(o+="\n#define LOW_PRECISION"),o}function UA(g,o,c,d){const p=g.getContext(),y=c.defines;let w=c.vertexShader,M=c.fragmentShader;const R=function zA(g){let o="SHADOWMAP_TYPE_BASIC";return 1===g.shadowMapType?o="SHADOWMAP_TYPE_PCF":2===g.shadowMapType?o="SHADOWMAP_TYPE_PCF_SOFT":3===g.shadowMapType&&(o="SHADOWMAP_TYPE_VSM"),o}(c),A=function nU(g){let o="ENVMAP_TYPE_CUBE";if(g.envMap)switch(g.envMapMode){case 301:case 302:o="ENVMAP_TYPE_CUBE";break;case 306:case 307:o="ENVMAP_TYPE_CUBE_UV"}return o}(c),N=function y_(g){let o="ENVMAP_MODE_REFLECTION";if(g.envMap)switch(g.envMapMode){case 302:case 307:o="ENVMAP_MODE_REFRACTION"}return o}(c),U=function nM(g){let o="ENVMAP_BLENDING_NONE";if(g.envMap)switch(g.combine){case 0:o="ENVMAP_BLENDING_MULTIPLY";break;case 1:o="ENVMAP_BLENDING_MIX";break;case 2:o="ENVMAP_BLENDING_ADD"}return o}(c),q=c.isWebGL2?"":function Md(g){return[g.extensionDerivatives||g.envMapCubeUV||g.bumpMap||g.tangentSpaceNormalMap||g.clearcoatNormalMap||g.flatShading||"physical"===g.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(g.extensionFragDepth||g.logarithmicDepthBuffer)&&g.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",g.extensionDrawBuffers&&g.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(g.extensionShaderTextureLOD||g.envMap||g.transmission)&&g.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(__).join("\n")}(c),Y=function tU(g){const o=[];for(const c in g){const d=g[c];!1!==d&&o.push("#define "+c+" "+d)}return o.join("\n")}(y),ne=p.createProgram();let le,Se,re=c.glslVersion?"#version "+c.glslVersion+"\n":"";c.isRawShaderMaterial?(le=[Y].filter(__).join("\n"),le.length>0&&(le+="\n"),Se=[q,Y].filter(__).join("\n"),Se.length>0&&(Se+="\n")):(le=[Dx(c),"#define SHADER_NAME "+c.shaderName,Y,c.instancing?"#define USE_INSTANCING":"",c.instancingColor?"#define USE_INSTANCING_COLOR":"",c.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define MAX_BONES "+c.maxBones,c.useFog&&c.fog?"#define USE_FOG":"",c.useFog&&c.fogExp2?"#define FOG_EXP2":"",c.map?"#define USE_MAP":"",c.envMap?"#define USE_ENVMAP":"",c.envMap?"#define "+N:"",c.lightMap?"#define USE_LIGHTMAP":"",c.aoMap?"#define USE_AOMAP":"",c.emissiveMap?"#define USE_EMISSIVEMAP":"",c.bumpMap?"#define USE_BUMPMAP":"",c.normalMap?"#define USE_NORMALMAP":"",c.normalMap&&c.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",c.normalMap&&c.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",c.clearcoatMap?"#define USE_CLEARCOATMAP":"",c.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",c.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",c.displacementMap&&c.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",c.specularMap?"#define USE_SPECULARMAP":"",c.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",c.specularColorMap?"#define USE_SPECULARCOLORMAP":"",c.roughnessMap?"#define USE_ROUGHNESSMAP":"",c.metalnessMap?"#define USE_METALNESSMAP":"",c.alphaMap?"#define USE_ALPHAMAP":"",c.transmission?"#define USE_TRANSMISSION":"",c.transmissionMap?"#define USE_TRANSMISSIONMAP":"",c.thicknessMap?"#define USE_THICKNESSMAP":"",c.sheenColorMap?"#define USE_SHEENCOLORMAP":"",c.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",c.vertexTangents?"#define USE_TANGENT":"",c.vertexColors?"#define USE_COLOR":"",c.vertexAlphas?"#define USE_COLOR_ALPHA":"",c.vertexUvs?"#define USE_UV":"",c.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",c.flatShading?"#define FLAT_SHADED":"",c.skinning?"#define USE_SKINNING":"",c.useVertexTexture?"#define BONE_TEXTURE":"",c.morphTargets?"#define USE_MORPHTARGETS":"",c.morphNormals&&!1===c.flatShading?"#define USE_MORPHNORMALS":"",c.morphTargets&&c.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",c.morphTargets&&c.isWebGL2?"#define MORPHTARGETS_COUNT "+c.morphTargetsCount:"",c.doubleSided?"#define DOUBLE_SIDED":"",c.flipSided?"#define FLIP_SIDED":"",c.shadowMapEnabled?"#define USE_SHADOWMAP":"",c.shadowMapEnabled?"#define "+R:"",c.sizeAttenuation?"#define USE_SIZEATTENUATION":"",c.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",c.logarithmicDepthBuffer&&c.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(__).join("\n"),Se=[q,Dx(c),"#define SHADER_NAME "+c.shaderName,Y,c.useFog&&c.fog?"#define USE_FOG":"",c.useFog&&c.fogExp2?"#define FOG_EXP2":"",c.map?"#define USE_MAP":"",c.matcap?"#define USE_MATCAP":"",c.envMap?"#define USE_ENVMAP":"",c.envMap?"#define "+A:"",c.envMap?"#define "+N:"",c.envMap?"#define "+U:"",c.lightMap?"#define USE_LIGHTMAP":"",c.aoMap?"#define USE_AOMAP":"",c.emissiveMap?"#define USE_EMISSIVEMAP":"",c.bumpMap?"#define USE_BUMPMAP":"",c.normalMap?"#define USE_NORMALMAP":"",c.normalMap&&c.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",c.normalMap&&c.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",c.clearcoat?"#define USE_CLEARCOAT":"",c.clearcoatMap?"#define USE_CLEARCOATMAP":"",c.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",c.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",c.specularMap?"#define USE_SPECULARMAP":"",c.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",c.specularColorMap?"#define USE_SPECULARCOLORMAP":"",c.roughnessMap?"#define USE_ROUGHNESSMAP":"",c.metalnessMap?"#define USE_METALNESSMAP":"",c.alphaMap?"#define USE_ALPHAMAP":"",c.alphaTest?"#define USE_ALPHATEST":"",c.sheen?"#define USE_SHEEN":"",c.sheenColorMap?"#define USE_SHEENCOLORMAP":"",c.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",c.transmission?"#define USE_TRANSMISSION":"",c.transmissionMap?"#define USE_TRANSMISSIONMAP":"",c.thicknessMap?"#define USE_THICKNESSMAP":"",c.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",c.vertexTangents?"#define USE_TANGENT":"",c.vertexColors||c.instancingColor?"#define USE_COLOR":"",c.vertexAlphas?"#define USE_COLOR_ALPHA":"",c.vertexUvs?"#define USE_UV":"",c.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",c.gradientMap?"#define USE_GRADIENTMAP":"",c.flatShading?"#define FLAT_SHADED":"",c.doubleSided?"#define DOUBLE_SIDED":"",c.flipSided?"#define FLIP_SIDED":"",c.shadowMapEnabled?"#define USE_SHADOWMAP":"",c.shadowMapEnabled?"#define "+R:"",c.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",c.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",c.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",c.logarithmicDepthBuffer&&c.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(c.extensionShaderTextureLOD||c.envMap)&&c.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==c.toneMapping?"#define TONE_MAPPING":"",0!==c.toneMapping?Cs.tonemapping_pars_fragment:"",0!==c.toneMapping?g_("toneMapping",c.toneMapping):"",c.dithering?"#define DITHERING":"",c.alphaWrite?"":"#define OPAQUE",Cs.encodings_pars_fragment,IO("linearToOutputTexel",c.outputEncoding),c.depthPacking?"#define DEPTH_PACKING "+c.depthPacking:"","\n"].filter(__).join("\n")),w=Bv(w),w=LO(w,c),w=iu(w,c),M=Bv(M),M=LO(M,c),M=iu(M,c),w=iM(w),M=iM(M),c.isWebGL2&&!0!==c.isRawShaderMaterial&&(re="#version 300 es\n",le=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+le,Se=["#define varying in",c.glslVersion===nc?"":"layout(location = 0) out highp vec4 pc_fragColor;",c.glslVersion===nc?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+Se);const Oe=re+Se+M,xe=NA(p,p.VERTEX_SHADER,re+le+w),ze=NA(p,p.FRAGMENT_SHADER,Oe);if(p.attachShader(ne,xe),p.attachShader(ne,ze),void 0!==c.index0AttributeName?p.bindAttribLocation(ne,0,c.index0AttributeName):!0===c.morphTargets&&p.bindAttribLocation(ne,0,"position"),p.linkProgram(ne),g.debug.checkShaderErrors){const Et=p.getProgramInfoLog(ne).trim(),ci=p.getShaderInfoLog(xe).trim(),Yt=p.getShaderInfoLog(ze).trim();let Pe=!0,bt=!0;if(!1===p.getProgramParameter(ne,p.LINK_STATUS)){Pe=!1;const Ft=Mh(p,xe,"vertex"),zt=Mh(p,ze,"fragment");console.error("THREE.WebGLProgram: Shader Error "+p.getError()+" - VALIDATE_STATUS "+p.getProgramParameter(ne,p.VALIDATE_STATUS)+"\n\nProgram Info Log: "+Et+"\n"+Ft+"\n"+zt)}else""!==Et?console.warn("THREE.WebGLProgram: Program Info Log:",Et):(""===ci||""===Yt)&&(bt=!1);bt&&(this.diagnostics={runnable:Pe,programLog:Et,vertexShader:{log:ci,prefix:le},fragmentShader:{log:Yt,prefix:Se}})}let $e,ht;return p.deleteShader(xe),p.deleteShader(ze),this.getUniforms=function(){return void 0===$e&&($e=new pp(p,ne)),$e},this.getAttributes=function(){return void 0===ht&&(ht=function iU(g,o){const c={},d=g.getProgramParameter(o,g.ACTIVE_ATTRIBUTES);for(let p=0;p<d;p++){const y=g.getActiveAttrib(o,p),w=y.name;let M=1;y.type===g.FLOAT_MAT2&&(M=2),y.type===g.FLOAT_MAT3&&(M=3),y.type===g.FLOAT_MAT4&&(M=4),c[w]={type:y.type,location:g.getAttribLocation(o,w),locationSize:M}}return c}(p,ne)),ht},this.destroy=function(){d.releaseStatesOfProgram(this),p.deleteProgram(ne),this.program=void 0},this.name=c.shaderName,this.id=kO++,this.cacheKey=o,this.usedTimes=1,this.program=ne,this.vertexShader=xe,this.fragmentShader=ze,this}let FO=0;class rM{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(o){const d=o.fragmentShader,p=this._getShaderStage(o.vertexShader),y=this._getShaderStage(d),w=this._getShaderCacheForMaterial(o);return!1===w.has(p)&&(w.add(p),p.usedTimes++),!1===w.has(y)&&(w.add(y),y.usedTimes++),this}remove(o){const c=this.materialCache.get(o);for(const d of c)d.usedTimes--,0===d.usedTimes&&this.shaderCache.delete(d);return this.materialCache.delete(o),this}getVertexShaderID(o){return this._getShaderStage(o.vertexShader).id}getFragmentShaderID(o){return this._getShaderStage(o.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(o){const c=this.materialCache;return!1===c.has(o)&&c.set(o,new Set),c.get(o)}_getShaderStage(o){const c=this.shaderCache;if(!1===c.has(o)){const d=new BO;c.set(o,d)}return c.get(o)}}class BO{constructor(){this.id=FO++,this.usedTimes=0}}function NO(g,o,c,d,p,y,w){const M=new yu,R=new rM,A=[],N=p.isWebGL2,U=p.logarithmicDepthBuffer,q=p.floatVertexTextures,Y=p.maxVertexUniforms,ne=p.vertexTextures;let le=p.precision;const Se={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function K(Pe,bt,Ft,zt,Qt){const Ut=zt.fog,Xt=(Pe.isMeshStandardMaterial?c:o).get(Pe.envMap||(Pe.isMeshStandardMaterial?zt.environment:null)),ui=Se[Pe.type],hi=Qt.isSkinnedMesh?function re(Pe){const Ft=Pe.skeleton.bones;if(q)return 1024;{const Qt=Math.floor((Y-20)/4),Ut=Math.min(Qt,Ft.length);return Ut<Ft.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+Ft.length+" bones. This GPU supports "+Ut+"."),0):Ut}}(Qt):0;let Bi,yn,Yn,ur;if(null!==Pe.precision&&(le=p.getMaxPrecision(Pe.precision),le!==Pe.precision&&console.warn("THREE.WebGLProgram.getParameters:",Pe.precision,"not supported, using",le,"instead.")),ui){const Fn=Sh[ui];Bi=Fn.vertexShader,yn=Fn.fragmentShader}else Bi=Pe.vertexShader,yn=Pe.fragmentShader,R.update(Pe),Yn=R.getVertexShaderID(Pe),ur=R.getFragmentShaderID(Pe);const At=g.getRenderTarget(),sr=Pe.clearcoat>0;return{isWebGL2:N,shaderID:ui,shaderName:Pe.type,vertexShader:Bi,fragmentShader:yn,defines:Pe.defines,customVertexShaderID:Yn,customFragmentShaderID:ur,isRawShaderMaterial:!0===Pe.isRawShaderMaterial,glslVersion:Pe.glslVersion,precision:le,instancing:!0===Qt.isInstancedMesh,instancingColor:!0===Qt.isInstancedMesh&&null!==Qt.instanceColor,supportsVertexTextures:ne,outputEncoding:null===At?g.outputEncoding:!0===At.isXRRenderTarget?At.texture.encoding:od,map:!!Pe.map,matcap:!!Pe.matcap,envMap:!!Xt,envMapMode:Xt&&Xt.mapping,envMapCubeUV:!!Xt&&(306===Xt.mapping||307===Xt.mapping),lightMap:!!Pe.lightMap,aoMap:!!Pe.aoMap,emissiveMap:!!Pe.emissiveMap,bumpMap:!!Pe.bumpMap,normalMap:!!Pe.normalMap,objectSpaceNormalMap:1===Pe.normalMapType,tangentSpaceNormalMap:0===Pe.normalMapType,decodeVideoTexture:!!Pe.map&&!0===Pe.map.isVideoTexture&&Pe.map.encoding===zn,clearcoat:sr,clearcoatMap:sr&&!!Pe.clearcoatMap,clearcoatRoughnessMap:sr&&!!Pe.clearcoatRoughnessMap,clearcoatNormalMap:sr&&!!Pe.clearcoatNormalMap,displacementMap:!!Pe.displacementMap,roughnessMap:!!Pe.roughnessMap,metalnessMap:!!Pe.metalnessMap,specularMap:!!Pe.specularMap,specularIntensityMap:!!Pe.specularIntensityMap,specularColorMap:!!Pe.specularColorMap,alphaMap:!!Pe.alphaMap,alphaTest:Pe.alphaTest>0,alphaWrite:Pe.alphaWrite||Pe.transparent,gradientMap:!!Pe.gradientMap,sheen:Pe.sheen>0,sheenColorMap:!!Pe.sheenColorMap,sheenRoughnessMap:!!Pe.sheenRoughnessMap,transmission:Pe.transmission>0,transmissionMap:!!Pe.transmissionMap,thicknessMap:!!Pe.thicknessMap,combine:Pe.combine,vertexTangents:!!Pe.normalMap&&!!Qt.geometry&&!!Qt.geometry.attributes.tangent,vertexColors:Pe.vertexColors,vertexAlphas:!0===Pe.vertexColors&&!!Qt.geometry&&!!Qt.geometry.attributes.color&&4===Qt.geometry.attributes.color.itemSize,vertexUvs:!!(Pe.map||Pe.bumpMap||Pe.normalMap||Pe.specularMap||Pe.alphaMap||Pe.emissiveMap||Pe.roughnessMap||Pe.metalnessMap||Pe.clearcoatMap||Pe.clearcoatRoughnessMap||Pe.clearcoatNormalMap||Pe.displacementMap||Pe.transmissionMap||Pe.thicknessMap||Pe.specularIntensityMap||Pe.specularColorMap||Pe.sheenColorMap||Pe.sheenRoughnessMap),uvsVertexOnly:!(Pe.map||Pe.bumpMap||Pe.normalMap||Pe.specularMap||Pe.alphaMap||Pe.emissiveMap||Pe.roughnessMap||Pe.metalnessMap||Pe.clearcoatNormalMap||Pe.transmission>0||Pe.transmissionMap||Pe.thicknessMap||Pe.specularIntensityMap||Pe.specularColorMap||Pe.sheen>0||Pe.sheenColorMap||Pe.sheenRoughnessMap||!Pe.displacementMap),fog:!!Ut,useFog:Pe.fog,fogExp2:Ut&&Ut.isFogExp2,flatShading:!!Pe.flatShading,sizeAttenuation:Pe.sizeAttenuation,logarithmicDepthBuffer:U,skinning:!0===Qt.isSkinnedMesh&&hi>0,maxBones:hi,useVertexTexture:q,morphTargets:!!Qt.geometry&&!!Qt.geometry.morphAttributes.position,morphNormals:!!Qt.geometry&&!!Qt.geometry.morphAttributes.normal,morphTargetsCount:Qt.geometry&&Qt.geometry.morphAttributes.position?Qt.geometry.morphAttributes.position.length:0,numDirLights:bt.directional.length,numPointLights:bt.point.length,numSpotLights:bt.spot.length,numRectAreaLights:bt.rectArea.length,numHemiLights:bt.hemi.length,numDirLightShadows:bt.directionalShadowMap.length,numPointLightShadows:bt.pointShadowMap.length,numSpotLightShadows:bt.spotShadowMap.length,numClippingPlanes:w.numPlanes,numClipIntersection:w.numIntersection,dithering:Pe.dithering,shadowMapEnabled:g.shadowMap.enabled&&Ft.length>0,shadowMapType:g.shadowMap.type,toneMapping:Pe.toneMapped?g.toneMapping:0,physicallyCorrectLights:g.physicallyCorrectLights,premultipliedAlpha:Pe.premultipliedAlpha,doubleSided:2===Pe.side,flipSided:1===Pe.side,depthPacking:void 0!==Pe.depthPacking&&Pe.depthPacking,index0AttributeName:Pe.index0AttributeName,extensionDerivatives:Pe.extensions&&Pe.extensions.derivatives,extensionFragDepth:Pe.extensions&&Pe.extensions.fragDepth,extensionDrawBuffers:Pe.extensions&&Pe.extensions.drawBuffers,extensionShaderTextureLOD:Pe.extensions&&Pe.extensions.shaderTextureLOD,rendererExtensionFragDepth:N||d.has("EXT_frag_depth"),rendererExtensionDrawBuffers:N||d.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:N||d.has("EXT_shader_texture_lod"),customProgramCacheKey:Pe.customProgramCacheKey()}},getProgramCacheKey:function Oe(Pe){const bt=[];if(Pe.shaderID?bt.push(Pe.shaderID):(bt.push(Pe.customVertexShaderID),bt.push(Pe.customFragmentShaderID)),void 0!==Pe.defines)for(const Ft in Pe.defines)bt.push(Ft),bt.push(Pe.defines[Ft]);return!1===Pe.isRawShaderMaterial&&(function xe(Pe,bt){Pe.push(bt.precision),Pe.push(bt.outputEncoding),Pe.push(bt.envMapMode),Pe.push(bt.combine),Pe.push(bt.vertexUvs),Pe.push(bt.fogExp2),Pe.push(bt.sizeAttenuation),Pe.push(bt.maxBones),Pe.push(bt.morphTargetsCount),Pe.push(bt.numDirLights),Pe.push(bt.numPointLights),Pe.push(bt.numSpotLights),Pe.push(bt.numHemiLights),Pe.push(bt.numRectAreaLights),Pe.push(bt.numDirLightShadows),Pe.push(bt.numPointLightShadows),Pe.push(bt.numSpotLightShadows),Pe.push(bt.shadowMapType),Pe.push(bt.toneMapping),Pe.push(bt.numClippingPlanes),Pe.push(bt.numClipIntersection),Pe.push(bt.alphaWrite)}(bt,Pe),function ze(Pe,bt){M.disableAll(),bt.isWebGL2&&M.enable(0),bt.supportsVertexTextures&&M.enable(1),bt.instancing&&M.enable(2),bt.instancingColor&&M.enable(3),bt.map&&M.enable(4),bt.matcap&&M.enable(5),bt.envMap&&M.enable(6),bt.envMapCubeUV&&M.enable(7),bt.lightMap&&M.enable(8),bt.aoMap&&M.enable(9),bt.emissiveMap&&M.enable(10),bt.bumpMap&&M.enable(11),bt.normalMap&&M.enable(12),bt.objectSpaceNormalMap&&M.enable(13),bt.tangentSpaceNormalMap&&M.enable(14),bt.clearcoat&&M.enable(15),bt.clearcoatMap&&M.enable(16),bt.clearcoatRoughnessMap&&M.enable(17),bt.clearcoatNormalMap&&M.enable(18),bt.displacementMap&&M.enable(19),bt.specularMap&&M.enable(20),bt.roughnessMap&&M.enable(21),bt.metalnessMap&&M.enable(22),bt.gradientMap&&M.enable(23),bt.alphaMap&&M.enable(24),bt.alphaTest&&M.enable(25),bt.vertexColors&&M.enable(26),bt.vertexAlphas&&M.enable(27),bt.vertexUvs&&M.enable(28),bt.vertexTangents&&M.enable(29),bt.uvsVertexOnly&&M.enable(30),bt.fog&&M.enable(31),Pe.push(M.mask),M.disableAll(),bt.useFog&&M.enable(0),bt.flatShading&&M.enable(1),bt.logarithmicDepthBuffer&&M.enable(2),bt.skinning&&M.enable(3),bt.useVertexTexture&&M.enable(4),bt.morphTargets&&M.enable(5),bt.morphNormals&&M.enable(6),bt.premultipliedAlpha&&M.enable(7),bt.shadowMapEnabled&&M.enable(8),bt.physicallyCorrectLights&&M.enable(9),bt.doubleSided&&M.enable(10),bt.flipSided&&M.enable(11),bt.depthPacking&&M.enable(12),bt.dithering&&M.enable(13),bt.specularIntensityMap&&M.enable(14),bt.specularColorMap&&M.enable(15),bt.transmission&&M.enable(16),bt.transmissionMap&&M.enable(17),bt.thicknessMap&&M.enable(18),bt.sheen&&M.enable(19),bt.sheenColorMap&&M.enable(20),bt.sheenRoughnessMap&&M.enable(21),bt.decodeVideoTexture&&M.enable(22),Pe.push(M.mask)}(bt,Pe),bt.push(g.outputEncoding)),bt.push(Pe.customProgramCacheKey),bt.join()},getUniforms:function $e(Pe){const bt=Se[Pe.type];let Ft;return Ft=bt?qE.clone(Sh[bt].uniforms):Pe.uniforms,Ft},acquireProgram:function ht(Pe,bt){let Ft;for(let zt=0,Qt=A.length;zt<Qt;zt++){const Ut=A[zt];if(Ut.cacheKey===bt){Ft=Ut,++Ft.usedTimes;break}}return void 0===Ft&&(Ft=new UA(g,bt,Pe,y),A.push(Ft)),Ft},releaseProgram:function Et(Pe){if(0==--Pe.usedTimes){const bt=A.indexOf(Pe);A[bt]=A[A.length-1],A.pop(),Pe.destroy()}},releaseShaderCache:function ci(Pe){R.remove(Pe)},programs:A,dispose:function Yt(){R.dispose()}}}function HO(){let g=new WeakMap;return{get:function o(y){let w=g.get(y);return void 0===w&&(w={},g.set(y,w)),w},remove:function c(y){g.delete(y)},update:function d(y,w,M){g.get(y)[w]=M},dispose:function p(){g=new WeakMap}}}function VO(g,o){return g.groupOrder!==o.groupOrder?g.groupOrder-o.groupOrder:g.renderOrder!==o.renderOrder?g.renderOrder-o.renderOrder:g.material.id!==o.material.id?g.material.id-o.material.id:g.z!==o.z?g.z-o.z:g.id-o.id}function GA(g,o){return g.groupOrder!==o.groupOrder?g.groupOrder-o.groupOrder:g.renderOrder!==o.renderOrder?g.renderOrder-o.renderOrder:g.z!==o.z?o.z-g.z:g.id-o.id}function WA(){const g=[];let o=0;const c=[],d=[],p=[];function w(U,q,Y,ne,le,Se){let re=g[o];return void 0===re?(re={id:U.id,object:U,geometry:q,material:Y,groupOrder:ne,renderOrder:U.renderOrder,z:le,group:Se},g[o]=re):(re.id=U.id,re.object=U,re.geometry=q,re.material=Y,re.groupOrder=ne,re.renderOrder=U.renderOrder,re.z=le,re.group=Se),o++,re}return{opaque:c,transmissive:d,transparent:p,init:function y(){o=0,c.length=0,d.length=0,p.length=0},push:function M(U,q,Y,ne,le,Se){const re=w(U,q,Y,ne,le,Se);Y.transmission>0?d.push(re):!0===Y.transparent?p.push(re):c.push(re)},unshift:function R(U,q,Y,ne,le,Se){const re=w(U,q,Y,ne,le,Se);Y.transmission>0?d.unshift(re):!0===Y.transparent?p.unshift(re):c.unshift(re)},finish:function N(){for(let U=o,q=g.length;U<q;U++){const Y=g[U];if(null===Y.id)break;Y.id=null,Y.object=null,Y.geometry=null,Y.material=null,Y.group=null}},sort:function A(U,q){c.length>1&&c.sort(U||VO),d.length>1&&d.sort(q||GA),p.length>1&&p.sort(q||GA)}}}function jA(){let g=new WeakMap;return{get:function o(d,p){let y;return!1===g.has(d)?(y=new WA,g.set(d,[y])):p>=g.get(d).length?(y=new WA,g.get(d).push(y)):y=g.get(d)[p],y},dispose:function c(){g=new WeakMap}}}function sM(){const g={};return{get:function(o){if(void 0!==g[o.id])return g[o.id];let c;switch(o.type){case"DirectionalLight":c={direction:new Ne,color:new cn};break;case"SpotLight":c={position:new Ne,direction:new Ne,color:new cn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":c={position:new Ne,color:new cn,distance:0,decay:0};break;case"HemisphereLight":c={direction:new Ne,skyColor:new cn,groundColor:new cn};break;case"RectAreaLight":c={color:new cn,position:new Ne,halfWidth:new Ne,halfHeight:new Ne}}return g[o.id]=c,c}}}let oM=0;function zO(g,o){return(o.castShadow?1:0)-(g.castShadow?1:0)}function UO(g,o){const c=new sM,d=function qA(){const g={};return{get:function(o){if(void 0!==g[o.id])return g[o.id];let c;switch(o.type){case"DirectionalLight":case"SpotLight":c={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Be};break;case"PointLight":c={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Be,shadowCameraNear:1,shadowCameraFar:1e3}}return g[o.id]=c,c}}}(),p={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let N=0;N<9;N++)p.probe.push(new Ne);const y=new Ne,w=new Mn,M=new Mn;return{setup:function R(N,U){let q=0,Y=0,ne=0;for(let ci=0;ci<9;ci++)p.probe[ci].set(0,0,0);let le=0,Se=0,re=0,K=0,Oe=0,xe=0,ze=0,$e=0;N.sort(zO);const ht=!0!==U?Math.PI:1;for(let ci=0,Yt=N.length;ci<Yt;ci++){const Pe=N[ci],bt=Pe.color,Ft=Pe.intensity,zt=Pe.distance,Qt=Pe.shadow&&Pe.shadow.map?Pe.shadow.map.texture:null;if(Pe.isAmbientLight)q+=bt.r*Ft*ht,Y+=bt.g*Ft*ht,ne+=bt.b*Ft*ht;else if(Pe.isLightProbe)for(let Ut=0;Ut<9;Ut++)p.probe[Ut].addScaledVector(Pe.sh.coefficients[Ut],Ft);else if(Pe.isDirectionalLight){const Ut=c.get(Pe);if(Ut.color.copy(Pe.color).multiplyScalar(Pe.intensity*ht),Pe.castShadow){const ue=Pe.shadow,Xt=d.get(Pe);Xt.shadowBias=ue.bias,Xt.shadowNormalBias=ue.normalBias,Xt.shadowRadius=ue.radius,Xt.shadowMapSize=ue.mapSize,p.directionalShadow[le]=Xt,p.directionalShadowMap[le]=Qt,p.directionalShadowMatrix[le]=Pe.shadow.matrix,xe++}p.directional[le]=Ut,le++}else if(Pe.isSpotLight){const Ut=c.get(Pe);if(Ut.position.setFromMatrixPosition(Pe.matrixWorld),Ut.color.copy(bt).multiplyScalar(Ft*ht),Ut.distance=zt,Ut.coneCos=Math.cos(Pe.angle),Ut.penumbraCos=Math.cos(Pe.angle*(1-Pe.penumbra)),Ut.decay=Pe.decay,Pe.castShadow){const ue=Pe.shadow,Xt=d.get(Pe);Xt.shadowBias=ue.bias,Xt.shadowNormalBias=ue.normalBias,Xt.shadowRadius=ue.radius,Xt.shadowMapSize=ue.mapSize,p.spotShadow[re]=Xt,p.spotShadowMap[re]=Qt,p.spotShadowMatrix[re]=Pe.shadow.matrix,$e++}p.spot[re]=Ut,re++}else if(Pe.isRectAreaLight){const Ut=c.get(Pe);Ut.color.copy(bt).multiplyScalar(Ft),Ut.halfWidth.set(.5*Pe.width,0,0),Ut.halfHeight.set(0,.5*Pe.height,0),p.rectArea[K]=Ut,K++}else if(Pe.isPointLight){const Ut=c.get(Pe);if(Ut.color.copy(Pe.color).multiplyScalar(Pe.intensity*ht),Ut.distance=Pe.distance,Ut.decay=Pe.decay,Pe.castShadow){const ue=Pe.shadow,Xt=d.get(Pe);Xt.shadowBias=ue.bias,Xt.shadowNormalBias=ue.normalBias,Xt.shadowRadius=ue.radius,Xt.shadowMapSize=ue.mapSize,Xt.shadowCameraNear=ue.camera.near,Xt.shadowCameraFar=ue.camera.far,p.pointShadow[Se]=Xt,p.pointShadowMap[Se]=Qt,p.pointShadowMatrix[Se]=Pe.shadow.matrix,ze++}p.point[Se]=Ut,Se++}else if(Pe.isHemisphereLight){const Ut=c.get(Pe);Ut.skyColor.copy(Pe.color).multiplyScalar(Ft*ht),Ut.groundColor.copy(Pe.groundColor).multiplyScalar(Ft*ht),p.hemi[Oe]=Ut,Oe++}}K>0&&(o.isWebGL2||!0===g.has("OES_texture_float_linear")?(p.rectAreaLTC1=hn.LTC_FLOAT_1,p.rectAreaLTC2=hn.LTC_FLOAT_2):!0===g.has("OES_texture_half_float_linear")?(p.rectAreaLTC1=hn.LTC_HALF_1,p.rectAreaLTC2=hn.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),p.ambient[0]=q,p.ambient[1]=Y,p.ambient[2]=ne;const Et=p.hash;(Et.directionalLength!==le||Et.pointLength!==Se||Et.spotLength!==re||Et.rectAreaLength!==K||Et.hemiLength!==Oe||Et.numDirectionalShadows!==xe||Et.numPointShadows!==ze||Et.numSpotShadows!==$e)&&(p.directional.length=le,p.spot.length=re,p.rectArea.length=K,p.point.length=Se,p.hemi.length=Oe,p.directionalShadow.length=xe,p.directionalShadowMap.length=xe,p.pointShadow.length=ze,p.pointShadowMap.length=ze,p.spotShadow.length=$e,p.spotShadowMap.length=$e,p.directionalShadowMatrix.length=xe,p.pointShadowMatrix.length=ze,p.spotShadowMatrix.length=$e,Et.directionalLength=le,Et.pointLength=Se,Et.spotLength=re,Et.rectAreaLength=K,Et.hemiLength=Oe,Et.numDirectionalShadows=xe,Et.numPointShadows=ze,Et.numSpotShadows=$e,p.version=oM++)},setupView:function A(N,U){let q=0,Y=0,ne=0,le=0,Se=0;const re=U.matrixWorldInverse;for(let K=0,Oe=N.length;K<Oe;K++){const xe=N[K];if(xe.isDirectionalLight){const ze=p.directional[q];ze.direction.setFromMatrixPosition(xe.matrixWorld),y.setFromMatrixPosition(xe.target.matrixWorld),ze.direction.sub(y),ze.direction.transformDirection(re),q++}else if(xe.isSpotLight){const ze=p.spot[ne];ze.position.setFromMatrixPosition(xe.matrixWorld),ze.position.applyMatrix4(re),ze.direction.setFromMatrixPosition(xe.matrixWorld),y.setFromMatrixPosition(xe.target.matrixWorld),ze.direction.sub(y),ze.direction.transformDirection(re),ne++}else if(xe.isRectAreaLight){const ze=p.rectArea[le];ze.position.setFromMatrixPosition(xe.matrixWorld),ze.position.applyMatrix4(re),M.identity(),w.copy(xe.matrixWorld),w.premultiply(re),M.extractRotation(w),ze.halfWidth.set(.5*xe.width,0,0),ze.halfHeight.set(0,.5*xe.height,0),ze.halfWidth.applyMatrix4(M),ze.halfHeight.applyMatrix4(M),le++}else if(xe.isPointLight){const ze=p.point[Y];ze.position.setFromMatrixPosition(xe.matrixWorld),ze.position.applyMatrix4(re),Y++}else if(xe.isHemisphereLight){const ze=p.hemi[Se];ze.direction.setFromMatrixPosition(xe.matrixWorld),ze.direction.transformDirection(re),ze.direction.normalize(),Se++}}},state:p}}function aM(g,o){const c=new UO(g,o),d=[],p=[];return{init:function y(){d.length=0,p.length=0},state:{lightsArray:d,shadowsArray:p,lights:c},setupLights:function R(U){c.setup(d,U)},setupLightsView:function A(U){c.setupView(d,U)},pushLight:function w(U){d.push(U)},pushShadow:function M(U){p.push(U)}}}function XA(g,o){let c=new WeakMap;return{get:function d(y,w=0){let M;return!1===c.has(y)?(M=new aM(g,o),c.set(y,[M])):w>=c.get(y).length?(M=new aM(g,o),c.get(y).push(M)):M=c.get(y)[w],M},dispose:function p(){c=new WeakMap}}}class Td extends da{constructor(o){super(),this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(o)}copy(o){return super.copy(o),this.depthPacking=o.depthPacking,this.map=o.map,this.alphaMap=o.alphaMap,this.displacementMap=o.displacementMap,this.displacementScale=o.displacementScale,this.displacementBias=o.displacementBias,this.wireframe=o.wireframe,this.wireframeLinewidth=o.wireframeLinewidth,this}}Td.prototype.isMeshDepthMaterial=!0;class Hv extends da{constructor(o){super(),this.type="MeshDistanceMaterial",this.referencePosition=new Ne,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(o)}copy(o){return super.copy(o),this.referencePosition.copy(o.referencePosition),this.nearDistance=o.nearDistance,this.farDistance=o.farDistance,this.map=o.map,this.alphaMap=o.alphaMap,this.displacementMap=o.displacementMap,this.displacementScale=o.displacementScale,this.displacementBias=o.displacementBias,this}}function Vv(g,o,c){let d=new bv;const p=new Be,y=new Be,w=new Es,M=new Td({depthPacking:3201}),R=new Hv,A={},N=c.maxTextureSize,U={0:1,1:0,2:2},q=new yd({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Be},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),Y=q.clone();Y.defines.HORIZONTAL_PASS=1;const ne=new gt;ne.setAttribute("position",new Zn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const le=new sl(ne,q),Se=this;function re(xe,ze){const $e=o.update(le);q.defines.VSM_SAMPLES!==xe.blurSamples&&(q.defines.VSM_SAMPLES=xe.blurSamples,Y.defines.VSM_SAMPLES=xe.blurSamples,q.needsUpdate=!0,Y.needsUpdate=!0),q.uniforms.shadow_pass.value=xe.map.texture,q.uniforms.resolution.value=xe.mapSize,q.uniforms.radius.value=xe.radius,g.setRenderTarget(xe.mapPass),g.clear(),g.renderBufferDirect(ze,null,$e,q,le,null),Y.uniforms.shadow_pass.value=xe.mapPass.texture,Y.uniforms.resolution.value=xe.mapSize,Y.uniforms.radius.value=xe.radius,g.setRenderTarget(xe.map),g.clear(),g.renderBufferDirect(ze,null,$e,Y,le,null)}function K(xe,ze,$e,ht,Et,ci,Yt){let Pe=null;const bt=!0===ht.isPointLight?xe.customDistanceMaterial:xe.customDepthMaterial;if(Pe=void 0!==bt?bt:!0===ht.isPointLight?R:M,g.localClippingEnabled&&!0===$e.clipShadows&&0!==$e.clippingPlanes.length||$e.displacementMap&&0!==$e.displacementScale||$e.alphaMap&&$e.alphaTest>0){const Ft=Pe.uuid,zt=$e.uuid;let Qt=A[Ft];void 0===Qt&&(Qt={},A[Ft]=Qt);let Ut=Qt[zt];void 0===Ut&&(Ut=Pe.clone(),Qt[zt]=Ut),Pe=Ut}return Pe.visible=$e.visible,Pe.wireframe=$e.wireframe,Pe.side=3===Yt?null!==$e.shadowSide?$e.shadowSide:$e.side:null!==$e.shadowSide?$e.shadowSide:U[$e.side],Pe.alphaMap=$e.alphaMap,Pe.alphaTest=$e.alphaTest,Pe.clipShadows=$e.clipShadows,Pe.clippingPlanes=$e.clippingPlanes,Pe.clipIntersection=$e.clipIntersection,Pe.displacementMap=$e.displacementMap,Pe.displacementScale=$e.displacementScale,Pe.displacementBias=$e.displacementBias,Pe.wireframeLinewidth=$e.wireframeLinewidth,Pe.linewidth=$e.linewidth,!0===ht.isPointLight&&!0===Pe.isMeshDistanceMaterial&&(Pe.referencePosition.setFromMatrixPosition(ht.matrixWorld),Pe.nearDistance=Et,Pe.farDistance=ci),Pe}function Oe(xe,ze,$e,ht,Et){if(!1===xe.visible)return;if(xe.layers.test(ze.layers)&&(xe.isMesh||xe.isLine||xe.isPoints)&&(xe.castShadow||xe.receiveShadow&&3===Et)&&(!xe.frustumCulled||d.intersectsObject(xe))){xe.modelViewMatrix.multiplyMatrices($e.matrixWorldInverse,xe.matrixWorld);const Pe=o.update(xe),bt=xe.material;if(Array.isArray(bt)){const Ft=Pe.groups;for(let zt=0,Qt=Ft.length;zt<Qt;zt++){const Ut=Ft[zt],ue=bt[Ut.materialIndex];if(ue&&ue.visible){const Xt=K(xe,0,ue,ht,$e.near,$e.far,Et);g.renderBufferDirect($e,null,Pe,Xt,xe,Ut)}}}else if(bt.visible){const Ft=K(xe,0,bt,ht,$e.near,$e.far,Et);g.renderBufferDirect($e,null,Pe,Ft,xe,null)}}const Yt=xe.children;for(let Pe=0,bt=Yt.length;Pe<bt;Pe++)Oe(Yt[Pe],ze,$e,ht,Et)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(xe,ze,$e){if(!1===Se.enabled||!1===Se.autoUpdate&&!1===Se.needsUpdate||0===xe.length)return;const ht=g.getRenderTarget(),Et=g.getActiveCubeFace(),ci=g.getActiveMipmapLevel(),Yt=g.state;Yt.setBlending(0),Yt.buffers.color.setClear(1,1,1,1),Yt.buffers.depth.setTest(!0),Yt.setScissorTest(!1);for(let Pe=0,bt=xe.length;Pe<bt;Pe++){const Ft=xe[Pe],zt=Ft.shadow;if(void 0===zt){console.warn("THREE.WebGLShadowMap:",Ft,"has no shadow.");continue}if(!1===zt.autoUpdate&&!1===zt.needsUpdate)continue;p.copy(zt.mapSize);const Qt=zt.getFrameExtents();if(p.multiply(Qt),y.copy(zt.mapSize),(p.x>N||p.y>N)&&(p.x>N&&(y.x=Math.floor(N/Qt.x),p.x=y.x*Qt.x,zt.mapSize.x=y.x),p.y>N&&(y.y=Math.floor(N/Qt.y),p.y=y.y*Qt.y,zt.mapSize.y=y.y)),null===zt.map&&!zt.isPointLightShadow&&3===this.type){const ue={minFilter:tt,magFilter:tt,format:Ua};zt.map=new bs(p.x,p.y,ue),zt.map.texture.name=Ft.name+".shadowMap",zt.mapPass=new bs(p.x,p.y,ue),zt.camera.updateProjectionMatrix()}null===zt.map&&(zt.map=new bs(p.x,p.y,{minFilter:ro,magFilter:ro,format:Ua}),zt.map.texture.name=Ft.name+".shadowMap",zt.camera.updateProjectionMatrix()),g.setRenderTarget(zt.map),g.clear();const Ut=zt.getViewportCount();for(let ue=0;ue<Ut;ue++){const Xt=zt.getViewport(ue);w.set(y.x*Xt.x,y.y*Xt.y,y.x*Xt.z,y.y*Xt.w),Yt.viewport(w),zt.updateMatrices(Ft,ue),d=zt.getFrustum(),Oe(ze,$e,zt.camera,Ft,this.type)}!zt.isPointLightShadow&&3===this.type&&re(zt,$e),zt.needsUpdate=!1}Se.needsUpdate=!1,g.setRenderTarget(ht,Et,ci)}}function WO(g,o,c){const d=c.isWebGL2,M=new function p(){let St=!1;const Kn=new Es;let dn=null;const Cr=new Es(0,0,0,0);return{setMask:function(bi){dn!==bi&&!St&&(g.colorMask(bi,bi,bi,bi),dn=bi)},setLocked:function(bi){St=bi},setClear:function(bi,Pr,Ws,ko,rh){!0===rh&&(bi*=ko,Pr*=ko,Ws*=ko),Kn.set(bi,Pr,Ws,ko),!1===Cr.equals(Kn)&&(g.clearColor(bi,Pr,Ws,ko),Cr.copy(Kn))},reset:function(){St=!1,dn=null,Cr.set(-1,0,0,0)}}},R=new function y(){let St=!1,Kn=null,dn=null,Cr=null;return{setTest:function(bi){bi?At(g.DEPTH_TEST):oo(g.DEPTH_TEST)},setMask:function(bi){Kn!==bi&&!St&&(g.depthMask(bi),Kn=bi)},setFunc:function(bi){if(dn!==bi){if(bi)switch(bi){case 0:g.depthFunc(g.NEVER);break;case 1:g.depthFunc(g.ALWAYS);break;case 2:g.depthFunc(g.LESS);break;case 3:default:g.depthFunc(g.LEQUAL);break;case 4:g.depthFunc(g.EQUAL);break;case 5:g.depthFunc(g.GEQUAL);break;case 6:g.depthFunc(g.GREATER);break;case 7:g.depthFunc(g.NOTEQUAL)}else g.depthFunc(g.LEQUAL);dn=bi}},setLocked:function(bi){St=bi},setClear:function(bi){Cr!==bi&&(g.clearDepth(bi),Cr=bi)},reset:function(){St=!1,Kn=null,dn=null,Cr=null}}},A=new function w(){let St=!1,Kn=null,dn=null,Cr=null,bi=null,Pr=null,Ws=null,ko=null,rh=null;return{setTest:function(Fs){St||(Fs?At(g.STENCIL_TEST):oo(g.STENCIL_TEST))},setMask:function(Fs){Kn!==Fs&&!St&&(g.stencilMask(Fs),Kn=Fs)},setFunc:function(Fs,If,zd){(dn!==Fs||Cr!==If||bi!==zd)&&(g.stencilFunc(Fs,If,zd),dn=Fs,Cr=If,bi=zd)},setOp:function(Fs,If,zd){(Pr!==Fs||Ws!==If||ko!==zd)&&(g.stencilOp(Fs,If,zd),Pr=Fs,Ws=If,ko=zd)},setLocked:function(Fs){St=Fs},setClear:function(Fs){rh!==Fs&&(g.clearStencil(Fs),rh=Fs)},reset:function(){St=!1,Kn=null,dn=null,Cr=null,bi=null,Pr=null,Ws=null,ko=null,rh=null}}};let N={},U={},q=new WeakMap,Y=[],ne=null,le=!1,Se=null,re=null,K=null,Oe=null,xe=null,ze=null,$e=null,ht=!1,Et=null,ci=null,Yt=null,Pe=null,bt=null;const Ft=g.getParameter(g.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let zt=!1,Qt=0;const Ut=g.getParameter(g.VERSION);-1!==Ut.indexOf("WebGL")?(Qt=parseFloat(/^WebGL (\d)/.exec(Ut)[1]),zt=Qt>=1):-1!==Ut.indexOf("OpenGL ES")&&(Qt=parseFloat(/^OpenGL ES (\d)/.exec(Ut)[1]),zt=Qt>=2);let ue=null,Xt={};const ui=g.getParameter(g.SCISSOR_BOX),hi=g.getParameter(g.VIEWPORT),Bi=(new Es).fromArray(ui),yn=(new Es).fromArray(hi);function Yn(St,Kn,dn){const Cr=new Uint8Array(4),bi=g.createTexture();g.bindTexture(St,bi),g.texParameteri(St,g.TEXTURE_MIN_FILTER,g.NEAREST),g.texParameteri(St,g.TEXTURE_MAG_FILTER,g.NEAREST);for(let Pr=0;Pr<dn;Pr++)g.texImage2D(Kn+Pr,0,g.RGBA,1,1,0,g.RGBA,g.UNSIGNED_BYTE,Cr);return bi}const ur={};function At(St){!0!==N[St]&&(g.enable(St),N[St]=!0)}function oo(St){!1!==N[St]&&(g.disable(St),N[St]=!1)}ur[g.TEXTURE_2D]=Yn(g.TEXTURE_2D,g.TEXTURE_2D,1),ur[g.TEXTURE_CUBE_MAP]=Yn(g.TEXTURE_CUBE_MAP,g.TEXTURE_CUBE_MAP_POSITIVE_X,6),M.setClear(0,0,0,1),R.setClear(1),A.setClear(0),At(g.DEPTH_TEST),R.setFunc(3),en(!1),Bn(1),At(g.CULL_FACE),Ai(0);const ws={100:g.FUNC_ADD,101:g.FUNC_SUBTRACT,102:g.FUNC_REVERSE_SUBTRACT};if(d)ws[103]=g.MIN,ws[104]=g.MAX;else{const St=o.get("EXT_blend_minmax");null!==St&&(ws[103]=St.MIN_EXT,ws[104]=St.MAX_EXT)}const Xr={200:g.ZERO,201:g.ONE,202:g.SRC_COLOR,204:g.SRC_ALPHA,210:g.SRC_ALPHA_SATURATE,208:g.DST_COLOR,206:g.DST_ALPHA,203:g.ONE_MINUS_SRC_COLOR,205:g.ONE_MINUS_SRC_ALPHA,209:g.ONE_MINUS_DST_COLOR,207:g.ONE_MINUS_DST_ALPHA};function Ai(St,Kn,dn,Cr,bi,Pr,Ws,ko){if(0!==St){if(!1===le&&(At(g.BLEND),le=!0),5===St)bi=bi||Kn,Pr=Pr||dn,Ws=Ws||Cr,(Kn!==re||bi!==xe)&&(g.blendEquationSeparate(ws[Kn],ws[bi]),re=Kn,xe=bi),(dn!==K||Cr!==Oe||Pr!==ze||Ws!==$e)&&(g.blendFuncSeparate(Xr[dn],Xr[Cr],Xr[Pr],Xr[Ws]),K=dn,Oe=Cr,ze=Pr,$e=Ws),Se=St,ht=null;else if(St!==Se||ko!==ht){if((100!==re||100!==xe)&&(g.blendEquation(g.FUNC_ADD),re=100,xe=100),ko)switch(St){case 1:g.blendFuncSeparate(g.ONE,g.ONE_MINUS_SRC_ALPHA,g.ONE,g.ONE_MINUS_SRC_ALPHA);break;case 2:g.blendFunc(g.ONE,g.ONE);break;case 3:g.blendFuncSeparate(g.ZERO,g.ONE_MINUS_SRC_COLOR,g.ZERO,g.ONE);break;case 4:g.blendFuncSeparate(g.ZERO,g.SRC_COLOR,g.ZERO,g.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",St)}else switch(St){case 1:g.blendFuncSeparate(g.SRC_ALPHA,g.ONE_MINUS_SRC_ALPHA,g.ONE,g.ONE_MINUS_SRC_ALPHA);break;case 2:g.blendFunc(g.SRC_ALPHA,g.ONE);break;case 3:g.blendFuncSeparate(g.ZERO,g.ONE_MINUS_SRC_COLOR,g.ZERO,g.ONE);break;case 4:g.blendFunc(g.ZERO,g.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",St)}K=null,Oe=null,ze=null,$e=null,Se=St,ht=ko}}else!0===le&&(oo(g.BLEND),le=!1)}function en(St){Et!==St&&(g.frontFace(St?g.CW:g.CCW),Et=St)}function Bn(St){0!==St?(At(g.CULL_FACE),St!==ci&&g.cullFace(1===St?g.BACK:2===St?g.FRONT:g.FRONT_AND_BACK)):oo(g.CULL_FACE),ci=St}function jr(St,Kn,dn){St?(At(g.POLYGON_OFFSET_FILL),(Pe!==Kn||bt!==dn)&&(g.polygonOffset(Kn,dn),Pe=Kn,bt=dn)):oo(g.POLYGON_OFFSET_FILL)}function Ys(St){void 0===St&&(St=g.TEXTURE0+Ft-1),ue!==St&&(g.activeTexture(St),ue=St)}return{buffers:{color:M,depth:R,stencil:A},enable:At,disable:oo,bindFramebuffer:function sr(St,Kn){return U[St]!==Kn&&(g.bindFramebuffer(St,Kn),U[St]=Kn,d&&(St===g.DRAW_FRAMEBUFFER&&(U[g.FRAMEBUFFER]=Kn),St===g.FRAMEBUFFER&&(U[g.DRAW_FRAMEBUFFER]=Kn)),!0)},drawBuffers:function Nr(St,Kn){let dn=Y,Cr=!1;if(St)if(dn=q.get(Kn),void 0===dn&&(dn=[],q.set(Kn,dn)),St.isWebGLMultipleRenderTargets){const bi=St.texture;if(dn.length!==bi.length||dn[0]!==g.COLOR_ATTACHMENT0){for(let Pr=0,Ws=bi.length;Pr<Ws;Pr++)dn[Pr]=g.COLOR_ATTACHMENT0+Pr;dn.length=bi.length,Cr=!0}}else dn[0]!==g.COLOR_ATTACHMENT0&&(dn[0]=g.COLOR_ATTACHMENT0,Cr=!0);else dn[0]!==g.BACK&&(dn[0]=g.BACK,Cr=!0);Cr&&(c.isWebGL2?g.drawBuffers(dn):o.get("WEBGL_draw_buffers").drawBuffersWEBGL(dn))},useProgram:function Fn(St){return ne!==St&&(g.useProgram(St),ne=St,!0)},setBlending:Ai,setMaterial:function an(St,Kn){2===St.side?oo(g.CULL_FACE):At(g.CULL_FACE);let dn=1===St.side;Kn&&(dn=!dn),en(dn),1===St.blending&&!1===St.transparent?Ai(0):Ai(St.blending,St.blendEquation,St.blendSrc,St.blendDst,St.blendEquationAlpha,St.blendSrcAlpha,St.blendDstAlpha,St.premultipliedAlpha),R.setFunc(St.depthFunc),R.setTest(St.depthTest),R.setMask(St.depthWrite),M.setMask(St.colorWrite);const Cr=St.stencilWrite;A.setTest(Cr),Cr&&(A.setMask(St.stencilWriteMask),A.setFunc(St.stencilFunc,St.stencilRef,St.stencilFuncMask),A.setOp(St.stencilFail,St.stencilZFail,St.stencilZPass)),jr(St.polygonOffset,St.polygonOffsetFactor,St.polygonOffsetUnits),!0===St.alphaToCoverage?At(g.SAMPLE_ALPHA_TO_COVERAGE):oo(g.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:en,setCullFace:Bn,setLineWidth:function Tn(St){St!==Yt&&(zt&&g.lineWidth(St),Yt=St)},setPolygonOffset:jr,setScissorTest:function Zr(St){St?At(g.SCISSOR_TEST):oo(g.SCISSOR_TEST)},activeTexture:Ys,bindTexture:function qo(St,Kn){null===ue&&Ys();let dn=Xt[ue];void 0===dn&&(dn={type:void 0,texture:void 0},Xt[ue]=dn),(dn.type!==St||dn.texture!==Kn)&&(g.bindTexture(St,Kn||ur[St]),dn.type=St,dn.texture=Kn)},unbindTexture:function Ro(){const St=Xt[ue];void 0!==St&&void 0!==St.type&&(g.bindTexture(St.type,null),St.type=void 0,St.texture=void 0)},compressedTexImage2D:function rt(){try{g.compressedTexImage2D.apply(g,arguments)}catch(St){console.error("THREE.WebGLState:",St)}},texImage2D:function Sr(){try{g.texImage2D.apply(g,arguments)}catch(St){console.error("THREE.WebGLState:",St)}},texImage3D:function or(){try{g.texImage3D.apply(g,arguments)}catch(St){console.error("THREE.WebGLState:",St)}},texStorage2D:function ir(){try{g.texStorage2D.apply(g,arguments)}catch(St){console.error("THREE.WebGLState:",St)}},texStorage3D:function vi(){try{g.texStorage3D.apply(g,arguments)}catch(St){console.error("THREE.WebGLState:",St)}},texSubImage2D:function qe(){try{g.texSubImage2D.apply(g,arguments)}catch(St){console.error("THREE.WebGLState:",St)}},texSubImage3D:function wi(){try{g.texSubImage3D.apply(g,arguments)}catch(St){console.error("THREE.WebGLState:",St)}},compressedTexSubImage2D:function rn(){try{g.compressedTexSubImage2D.apply(g,arguments)}catch(St){console.error("THREE.WebGLState:",St)}},scissor:function wn(St){!1===Bi.equals(St)&&(g.scissor(St.x,St.y,St.z,St.w),Bi.copy(St))},viewport:function vn(St){!1===yn.equals(St)&&(g.viewport(St.x,St.y,St.z,St.w),yn.copy(St))},reset:function ss(){g.disable(g.BLEND),g.disable(g.CULL_FACE),g.disable(g.DEPTH_TEST),g.disable(g.POLYGON_OFFSET_FILL),g.disable(g.SCISSOR_TEST),g.disable(g.STENCIL_TEST),g.disable(g.SAMPLE_ALPHA_TO_COVERAGE),g.blendEquation(g.FUNC_ADD),g.blendFunc(g.ONE,g.ZERO),g.blendFuncSeparate(g.ONE,g.ZERO,g.ONE,g.ZERO),g.colorMask(!0,!0,!0,!0),g.clearColor(0,0,0,0),g.depthMask(!0),g.depthFunc(g.LESS),g.clearDepth(1),g.stencilMask(4294967295),g.stencilFunc(g.ALWAYS,0,4294967295),g.stencilOp(g.KEEP,g.KEEP,g.KEEP),g.clearStencil(0),g.cullFace(g.BACK),g.frontFace(g.CCW),g.polygonOffset(0,0),g.activeTexture(g.TEXTURE0),g.bindFramebuffer(g.FRAMEBUFFER,null),!0===d&&(g.bindFramebuffer(g.DRAW_FRAMEBUFFER,null),g.bindFramebuffer(g.READ_FRAMEBUFFER,null)),g.useProgram(null),g.lineWidth(1),g.scissor(0,0,g.canvas.width,g.canvas.height),g.viewport(0,0,g.canvas.width,g.canvas.height),N={},ue=null,Xt={},U={},q=new WeakMap,Y=[],ne=null,le=!1,Se=null,re=null,K=null,Oe=null,xe=null,ze=null,$e=null,ht=!1,Et=null,ci=null,Yt=null,Pe=null,bt=null,Bi.set(0,0,g.canvas.width,g.canvas.height),yn.set(0,0,g.canvas.width,g.canvas.height),M.reset(),R.reset(),A.reset()}}}function YA(g,o,c,d,p,y,w){const M=p.isWebGL2,R=p.maxTextures,A=p.maxCubemapSize,N=p.maxTextureSize,U=p.maxSamples,Y=o.has("WEBGL_multisampled_render_to_texture")?o.get("WEBGL_multisampled_render_to_texture"):void 0,ne=new WeakMap;let le,Se=!1;try{Se="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(rt){}function re(rt,qe){return Se?new OffscreenCanvas(rt,qe):Bl("canvas")}function K(rt,qe,wi,rn){let ir=1;if((rt.width>rn||rt.height>rn)&&(ir=rn/Math.max(rt.width,rt.height)),ir<1||!0===qe){if("undefined"!=typeof HTMLImageElement&&rt instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&rt instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&rt instanceof ImageBitmap){const vi=qe?yi:Math.floor,Sr=vi(ir*rt.width),or=vi(ir*rt.height);void 0===le&&(le=re(Sr,or));const wn=wi?re(Sr,or):le;return wn.width=Sr,wn.height=or,wn.getContext("2d").drawImage(rt,0,0,Sr,or),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+rt.width+"x"+rt.height+") to ("+Sr+"x"+or+")."),wn}return"data"in rt&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+rt.width+"x"+rt.height+")."),rt}return rt}function Oe(rt){return lm(rt.width)&&lm(rt.height)}function ze(rt,qe){return rt.generateMipmaps&&qe&&rt.minFilter!==ro&&rt.minFilter!==tt}function $e(rt){g.generateMipmap(rt)}function ht(rt,qe,wi,rn,ir=!1){if(!1===M)return qe;if(null!==rt){if(void 0!==g[rt])return g[rt];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+rt+"'")}let vi=qe;return qe===g.RED&&(wi===g.FLOAT&&(vi=g.R32F),wi===g.HALF_FLOAT&&(vi=g.R16F),wi===g.UNSIGNED_BYTE&&(vi=g.R8)),qe===g.RG&&(wi===g.FLOAT&&(vi=g.RG32F),wi===g.HALF_FLOAT&&(vi=g.RG16F),wi===g.UNSIGNED_BYTE&&(vi=g.RG8)),qe===g.RGBA&&(wi===g.FLOAT&&(vi=g.RGBA32F),wi===g.HALF_FLOAT&&(vi=g.RGBA16F),wi===g.UNSIGNED_BYTE&&(vi=rn===zn&&!1===ir?g.SRGB8_ALPHA8:g.RGBA8),wi===g.UNSIGNED_SHORT_4_4_4_4&&(vi=g.RGBA4),wi===g.UNSIGNED_SHORT_5_5_5_1&&(vi=g.RGB5_A1)),(vi===g.R16F||vi===g.R32F||vi===g.RG16F||vi===g.RG32F||vi===g.RGBA16F||vi===g.RGBA32F)&&o.get("EXT_color_buffer_float"),vi}function Et(rt,qe,wi){return!0===ze(rt,wi)||rt.isFramebufferTexture&&rt.minFilter!==ro&&rt.minFilter!==tt?Math.log2(Math.max(qe.width,qe.height))+1:void 0!==rt.mipmaps&&rt.mipmaps.length>0?rt.mipmaps.length:rt.isCompressedTexture&&Array.isArray(rt.image)?qe.mipmaps.length:1}function ci(rt){return rt===ro||1004===rt||1005===rt?g.NEAREST:g.LINEAR}function Yt(rt){const qe=rt.target;qe.removeEventListener("dispose",Yt),function bt(rt){const qe=d.get(rt);void 0!==qe.__webglInit&&(g.deleteTexture(qe.__webglTexture),d.remove(rt))}(qe),qe.isVideoTexture&&ne.delete(qe),w.memory.textures--}function Pe(rt){const qe=rt.target;qe.removeEventListener("dispose",Pe),function Ft(rt){const qe=rt.texture,wi=d.get(rt),rn=d.get(qe);if(rt){if(void 0!==rn.__webglTexture&&(g.deleteTexture(rn.__webglTexture),w.memory.textures--),rt.depthTexture&&rt.depthTexture.dispose(),rt.isWebGLCubeRenderTarget)for(let ir=0;ir<6;ir++)g.deleteFramebuffer(wi.__webglFramebuffer[ir]),wi.__webglDepthbuffer&&g.deleteRenderbuffer(wi.__webglDepthbuffer[ir]);else g.deleteFramebuffer(wi.__webglFramebuffer),wi.__webglDepthbuffer&&g.deleteRenderbuffer(wi.__webglDepthbuffer),wi.__webglMultisampledFramebuffer&&g.deleteFramebuffer(wi.__webglMultisampledFramebuffer),wi.__webglColorRenderbuffer&&g.deleteRenderbuffer(wi.__webglColorRenderbuffer),wi.__webglDepthRenderbuffer&&g.deleteRenderbuffer(wi.__webglDepthRenderbuffer);if(rt.isWebGLMultipleRenderTargets)for(let ir=0,vi=qe.length;ir<vi;ir++){const Sr=d.get(qe[ir]);Sr.__webglTexture&&(g.deleteTexture(Sr.__webglTexture),w.memory.textures--),d.remove(qe[ir])}d.remove(qe),d.remove(rt)}}(qe)}let zt=0;function ue(rt,qe){const wi=d.get(rt);if(rt.isVideoTexture&&function Tn(rt){const qe=w.render.frame;ne.get(rt)!==qe&&(ne.set(rt,qe),rt.update())}(rt),rt.version>0&&wi.__version!==rt.version){const rn=rt.image;if(void 0===rn)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==rn.complete)return void At(wi,rt,qe);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}c.activeTexture(g.TEXTURE0+qe),c.bindTexture(g.TEXTURE_2D,wi.__webglTexture)}function hi(rt,qe){const wi=d.get(rt);rt.version>0&&wi.__version!==rt.version?function oo(rt,qe,wi){if(6!==qe.image.length)return;ur(rt,qe),c.activeTexture(g.TEXTURE0+wi),c.bindTexture(g.TEXTURE_CUBE_MAP,rt.__webglTexture),g.pixelStorei(g.UNPACK_FLIP_Y_WEBGL,qe.flipY),g.pixelStorei(g.UNPACK_PREMULTIPLY_ALPHA_WEBGL,qe.premultiplyAlpha),g.pixelStorei(g.UNPACK_ALIGNMENT,qe.unpackAlignment),g.pixelStorei(g.UNPACK_COLORSPACE_CONVERSION_WEBGL,g.NONE);const rn=qe&&(qe.isCompressedTexture||qe.image[0].isCompressedTexture),ir=qe.image[0]&&qe.image[0].isDataTexture,vi=[];for(let bi=0;bi<6;bi++)vi[bi]=rn||ir?ir?qe.image[bi].image:qe.image[bi]:K(qe.image[bi],!1,!0,A),vi[bi]=jr(qe,vi[bi]);const Sr=vi[0],or=Oe(Sr)||M,wn=y.convert(qe.format,qe.encoding),vn=y.convert(qe.type),ss=ht(qe.internalFormat,wn,vn,qe.encoding),St=M&&!0!==qe.isVideoTexture,Kn=void 0===rt.__version;let Cr,dn=Et(qe,Sr,or);if(Yn(g.TEXTURE_CUBE_MAP,qe,or),rn){St&&Kn&&c.texStorage2D(g.TEXTURE_CUBE_MAP,dn,ss,Sr.width,Sr.height);for(let bi=0;bi<6;bi++){Cr=vi[bi].mipmaps;for(let Pr=0;Pr<Cr.length;Pr++){const Ws=Cr[Pr];qe.format!==Ua?null!==wn?St?c.compressedTexSubImage2D(g.TEXTURE_CUBE_MAP_POSITIVE_X+bi,Pr,0,0,Ws.width,Ws.height,wn,Ws.data):c.compressedTexImage2D(g.TEXTURE_CUBE_MAP_POSITIVE_X+bi,Pr,ss,Ws.width,Ws.height,0,Ws.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):St?c.texSubImage2D(g.TEXTURE_CUBE_MAP_POSITIVE_X+bi,Pr,0,0,Ws.width,Ws.height,wn,vn,Ws.data):c.texImage2D(g.TEXTURE_CUBE_MAP_POSITIVE_X+bi,Pr,ss,Ws.width,Ws.height,0,wn,vn,Ws.data)}}}else{Cr=qe.mipmaps,St&&Kn&&(Cr.length>0&&dn++,c.texStorage2D(g.TEXTURE_CUBE_MAP,dn,ss,vi[0].width,vi[0].height));for(let bi=0;bi<6;bi++)if(ir){St?c.texSubImage2D(g.TEXTURE_CUBE_MAP_POSITIVE_X+bi,0,0,0,vi[bi].width,vi[bi].height,wn,vn,vi[bi].data):c.texImage2D(g.TEXTURE_CUBE_MAP_POSITIVE_X+bi,0,ss,vi[bi].width,vi[bi].height,0,wn,vn,vi[bi].data);for(let Pr=0;Pr<Cr.length;Pr++){const ko=Cr[Pr].image[bi].image;St?c.texSubImage2D(g.TEXTURE_CUBE_MAP_POSITIVE_X+bi,Pr+1,0,0,ko.width,ko.height,wn,vn,ko.data):c.texImage2D(g.TEXTURE_CUBE_MAP_POSITIVE_X+bi,Pr+1,ss,ko.width,ko.height,0,wn,vn,ko.data)}}else{St?c.texSubImage2D(g.TEXTURE_CUBE_MAP_POSITIVE_X+bi,0,0,0,wn,vn,vi[bi]):c.texImage2D(g.TEXTURE_CUBE_MAP_POSITIVE_X+bi,0,ss,wn,vn,vi[bi]);for(let Pr=0;Pr<Cr.length;Pr++){const Ws=Cr[Pr];St?c.texSubImage2D(g.TEXTURE_CUBE_MAP_POSITIVE_X+bi,Pr+1,0,0,wn,vn,Ws.image[bi]):c.texImage2D(g.TEXTURE_CUBE_MAP_POSITIVE_X+bi,Pr+1,ss,wn,vn,Ws.image[bi])}}}ze(qe,or)&&$e(g.TEXTURE_CUBE_MAP),rt.__version=qe.version,qe.onUpdate&&qe.onUpdate(qe)}(wi,rt,qe):(c.activeTexture(g.TEXTURE0+qe),c.bindTexture(g.TEXTURE_CUBE_MAP,wi.__webglTexture))}const Bi={[oa]:g.REPEAT,[Lo]:g.CLAMP_TO_EDGE,[no]:g.MIRRORED_REPEAT},yn={[ro]:g.NEAREST,1004:g.NEAREST_MIPMAP_NEAREST,1005:g.NEAREST_MIPMAP_LINEAR,[tt]:g.LINEAR,1007:g.LINEAR_MIPMAP_NEAREST,[Gi]:g.LINEAR_MIPMAP_LINEAR};function Yn(rt,qe,wi){if(wi?(g.texParameteri(rt,g.TEXTURE_WRAP_S,Bi[qe.wrapS]),g.texParameteri(rt,g.TEXTURE_WRAP_T,Bi[qe.wrapT]),(rt===g.TEXTURE_3D||rt===g.TEXTURE_2D_ARRAY)&&g.texParameteri(rt,g.TEXTURE_WRAP_R,Bi[qe.wrapR]),g.texParameteri(rt,g.TEXTURE_MAG_FILTER,yn[qe.magFilter]),g.texParameteri(rt,g.TEXTURE_MIN_FILTER,yn[qe.minFilter])):(g.texParameteri(rt,g.TEXTURE_WRAP_S,g.CLAMP_TO_EDGE),g.texParameteri(rt,g.TEXTURE_WRAP_T,g.CLAMP_TO_EDGE),(rt===g.TEXTURE_3D||rt===g.TEXTURE_2D_ARRAY)&&g.texParameteri(rt,g.TEXTURE_WRAP_R,g.CLAMP_TO_EDGE),(qe.wrapS!==Lo||qe.wrapT!==Lo)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),g.texParameteri(rt,g.TEXTURE_MAG_FILTER,ci(qe.magFilter)),g.texParameteri(rt,g.TEXTURE_MIN_FILTER,ci(qe.minFilter)),qe.minFilter!==ro&&qe.minFilter!==tt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===o.has("EXT_texture_filter_anisotropic")){const rn=o.get("EXT_texture_filter_anisotropic");if(qe.type===eo&&!1===o.has("OES_texture_float_linear")||!1===M&&qe.type===Sa&&!1===o.has("OES_texture_half_float_linear"))return;(qe.anisotropy>1||d.get(qe).__currentAnisotropy)&&(g.texParameterf(rt,rn.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(qe.anisotropy,p.getMaxAnisotropy())),d.get(qe).__currentAnisotropy=qe.anisotropy)}}function ur(rt,qe){void 0===rt.__webglInit&&(rt.__webglInit=!0,qe.addEventListener("dispose",Yt),rt.__webglTexture=g.createTexture(),w.memory.textures++)}function At(rt,qe,wi){let rn=g.TEXTURE_2D;qe.isDataTexture2DArray&&(rn=g.TEXTURE_2D_ARRAY),qe.isDataTexture3D&&(rn=g.TEXTURE_3D),ur(rt,qe),c.activeTexture(g.TEXTURE0+wi),c.bindTexture(rn,rt.__webglTexture),g.pixelStorei(g.UNPACK_FLIP_Y_WEBGL,qe.flipY),g.pixelStorei(g.UNPACK_PREMULTIPLY_ALPHA_WEBGL,qe.premultiplyAlpha),g.pixelStorei(g.UNPACK_ALIGNMENT,qe.unpackAlignment),g.pixelStorei(g.UNPACK_COLORSPACE_CONVERSION_WEBGL,g.NONE);const ir=function xe(rt){return!M&&(rt.wrapS!==Lo||rt.wrapT!==Lo||rt.minFilter!==ro&&rt.minFilter!==tt)}(qe)&&!1===Oe(qe.image);let vi=K(qe.image,ir,!1,N);vi=jr(qe,vi);const Sr=Oe(vi)||M,or=y.convert(qe.format,qe.encoding);let ss,wn=y.convert(qe.type),vn=ht(qe.internalFormat,or,wn,qe.encoding,qe.isVideoTexture);Yn(rn,qe,Sr);const St=qe.mipmaps,Kn=M&&!0!==qe.isVideoTexture,dn=void 0===rt.__version,Cr=Et(qe,vi,Sr);if(qe.isDepthTexture)vn=g.DEPTH_COMPONENT,M?vn=qe.type===eo?g.DEPTH_COMPONENT32F:qe.type===ic?g.DEPTH_COMPONENT24:qe.type===gh?g.DEPTH24_STENCIL8:g.DEPTH_COMPONENT16:qe.type===eo&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),qe.format===ed&&vn===g.DEPTH_COMPONENT&&qe.type!==vs&&qe.type!==ic&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),qe.type=vs,wn=y.convert(qe.type)),qe.format===ks&&vn===g.DEPTH_COMPONENT&&(vn=g.DEPTH_STENCIL,qe.type!==gh&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),qe.type=gh,wn=y.convert(qe.type))),Kn&&dn?c.texStorage2D(g.TEXTURE_2D,1,vn,vi.width,vi.height):c.texImage2D(g.TEXTURE_2D,0,vn,vi.width,vi.height,0,or,wn,null);else if(qe.isDataTexture)if(St.length>0&&Sr){Kn&&dn&&c.texStorage2D(g.TEXTURE_2D,Cr,vn,St[0].width,St[0].height);for(let bi=0,Pr=St.length;bi<Pr;bi++)ss=St[bi],Kn?c.texSubImage2D(g.TEXTURE_2D,0,0,0,ss.width,ss.height,or,wn,ss.data):c.texImage2D(g.TEXTURE_2D,bi,vn,ss.width,ss.height,0,or,wn,ss.data);qe.generateMipmaps=!1}else Kn?(dn&&c.texStorage2D(g.TEXTURE_2D,Cr,vn,vi.width,vi.height),c.texSubImage2D(g.TEXTURE_2D,0,0,0,vi.width,vi.height,or,wn,vi.data)):c.texImage2D(g.TEXTURE_2D,0,vn,vi.width,vi.height,0,or,wn,vi.data);else if(qe.isCompressedTexture){Kn&&dn&&c.texStorage2D(g.TEXTURE_2D,Cr,vn,St[0].width,St[0].height);for(let bi=0,Pr=St.length;bi<Pr;bi++)ss=St[bi],qe.format!==Ua?null!==or?Kn?c.compressedTexSubImage2D(g.TEXTURE_2D,bi,0,0,ss.width,ss.height,or,ss.data):c.compressedTexImage2D(g.TEXTURE_2D,bi,vn,ss.width,ss.height,0,ss.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Kn?c.texSubImage2D(g.TEXTURE_2D,bi,0,0,ss.width,ss.height,or,wn,ss.data):c.texImage2D(g.TEXTURE_2D,bi,vn,ss.width,ss.height,0,or,wn,ss.data)}else if(qe.isDataTexture2DArray)Kn?(dn&&c.texStorage3D(g.TEXTURE_2D_ARRAY,Cr,vn,vi.width,vi.height,vi.depth),c.texSubImage3D(g.TEXTURE_2D_ARRAY,0,0,0,0,vi.width,vi.height,vi.depth,or,wn,vi.data)):c.texImage3D(g.TEXTURE_2D_ARRAY,0,vn,vi.width,vi.height,vi.depth,0,or,wn,vi.data);else if(qe.isDataTexture3D)Kn?(dn&&c.texStorage3D(g.TEXTURE_3D,Cr,vn,vi.width,vi.height,vi.depth),c.texSubImage3D(g.TEXTURE_3D,0,0,0,0,vi.width,vi.height,vi.depth,or,wn,vi.data)):c.texImage3D(g.TEXTURE_3D,0,vn,vi.width,vi.height,vi.depth,0,or,wn,vi.data);else if(qe.isFramebufferTexture)Kn&&dn?c.texStorage2D(g.TEXTURE_2D,Cr,vn,vi.width,vi.height):c.texImage2D(g.TEXTURE_2D,0,vn,vi.width,vi.height,0,or,wn,null);else if(St.length>0&&Sr){Kn&&dn&&c.texStorage2D(g.TEXTURE_2D,Cr,vn,St[0].width,St[0].height);for(let bi=0,Pr=St.length;bi<Pr;bi++)ss=St[bi],Kn?c.texSubImage2D(g.TEXTURE_2D,bi,0,0,or,wn,ss):c.texImage2D(g.TEXTURE_2D,bi,vn,or,wn,ss);qe.generateMipmaps=!1}else Kn?(dn&&c.texStorage2D(g.TEXTURE_2D,Cr,vn,vi.width,vi.height),c.texSubImage2D(g.TEXTURE_2D,0,0,0,or,wn,vi)):c.texImage2D(g.TEXTURE_2D,0,vn,or,wn,vi);ze(qe,Sr)&&$e(rn),rt.__version=qe.version,qe.onUpdate&&qe.onUpdate(qe)}function sr(rt,qe,wi,rn,ir){const vi=y.convert(wi.format,wi.encoding),Sr=y.convert(wi.type),or=ht(wi.internalFormat,vi,Sr,wi.encoding);d.get(qe).__hasExternalTextures||(ir===g.TEXTURE_3D||ir===g.TEXTURE_2D_ARRAY?c.texImage3D(ir,0,or,qe.width,qe.height,qe.depth,0,vi,Sr,null):c.texImage2D(ir,0,or,qe.width,qe.height,0,vi,Sr,null)),c.bindFramebuffer(g.FRAMEBUFFER,rt),qe.useRenderToTexture?Y.framebufferTexture2DMultisampleEXT(g.FRAMEBUFFER,rn,ir,d.get(wi).__webglTexture,0,Bn(qe)):g.framebufferTexture2D(g.FRAMEBUFFER,rn,ir,d.get(wi).__webglTexture,0),c.bindFramebuffer(g.FRAMEBUFFER,null)}function Nr(rt,qe,wi){if(g.bindRenderbuffer(g.RENDERBUFFER,rt),qe.depthBuffer&&!qe.stencilBuffer){let rn=g.DEPTH_COMPONENT16;if(wi||qe.useRenderToTexture){const ir=qe.depthTexture;ir&&ir.isDepthTexture&&(ir.type===eo?rn=g.DEPTH_COMPONENT32F:ir.type===ic&&(rn=g.DEPTH_COMPONENT24));const vi=Bn(qe);qe.useRenderToTexture?Y.renderbufferStorageMultisampleEXT(g.RENDERBUFFER,vi,rn,qe.width,qe.height):g.renderbufferStorageMultisample(g.RENDERBUFFER,vi,rn,qe.width,qe.height)}else g.renderbufferStorage(g.RENDERBUFFER,rn,qe.width,qe.height);g.framebufferRenderbuffer(g.FRAMEBUFFER,g.DEPTH_ATTACHMENT,g.RENDERBUFFER,rt)}else if(qe.depthBuffer&&qe.stencilBuffer){const rn=Bn(qe);wi&&qe.useRenderbuffer?g.renderbufferStorageMultisample(g.RENDERBUFFER,rn,g.DEPTH24_STENCIL8,qe.width,qe.height):qe.useRenderToTexture?Y.renderbufferStorageMultisampleEXT(g.RENDERBUFFER,rn,g.DEPTH24_STENCIL8,qe.width,qe.height):g.renderbufferStorage(g.RENDERBUFFER,g.DEPTH_STENCIL,qe.width,qe.height),g.framebufferRenderbuffer(g.FRAMEBUFFER,g.DEPTH_STENCIL_ATTACHMENT,g.RENDERBUFFER,rt)}else{const rn=!0===qe.isWebGLMultipleRenderTargets?qe.texture[0]:qe.texture,ir=y.convert(rn.format,rn.encoding),vi=y.convert(rn.type),Sr=ht(rn.internalFormat,ir,vi,rn.encoding),or=Bn(qe);wi&&qe.useRenderbuffer?g.renderbufferStorageMultisample(g.RENDERBUFFER,or,Sr,qe.width,qe.height):qe.useRenderToTexture?Y.renderbufferStorageMultisampleEXT(g.RENDERBUFFER,or,Sr,qe.width,qe.height):g.renderbufferStorage(g.RENDERBUFFER,Sr,qe.width,qe.height)}g.bindRenderbuffer(g.RENDERBUFFER,null)}function ws(rt){const qe=d.get(rt),wi=!0===rt.isWebGLCubeRenderTarget;if(rt.depthTexture&&!qe.__autoAllocateDepthBuffer){if(wi)throw new Error("target.depthTexture not supported in Cube render targets");!function Fn(rt,qe){if(qe&&qe.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(c.bindFramebuffer(g.FRAMEBUFFER,rt),!qe.depthTexture||!qe.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!d.get(qe.depthTexture).__webglTexture||qe.depthTexture.image.width!==qe.width||qe.depthTexture.image.height!==qe.height)&&(qe.depthTexture.image.width=qe.width,qe.depthTexture.image.height=qe.height,qe.depthTexture.needsUpdate=!0),ue(qe.depthTexture,0);const rn=d.get(qe.depthTexture).__webglTexture,ir=Bn(qe);if(qe.depthTexture.format===ed)qe.useRenderToTexture?Y.framebufferTexture2DMultisampleEXT(g.FRAMEBUFFER,g.DEPTH_ATTACHMENT,g.TEXTURE_2D,rn,0,ir):g.framebufferTexture2D(g.FRAMEBUFFER,g.DEPTH_ATTACHMENT,g.TEXTURE_2D,rn,0);else{if(qe.depthTexture.format!==ks)throw new Error("Unknown depthTexture format");qe.useRenderToTexture?Y.framebufferTexture2DMultisampleEXT(g.FRAMEBUFFER,g.DEPTH_STENCIL_ATTACHMENT,g.TEXTURE_2D,rn,0,ir):g.framebufferTexture2D(g.FRAMEBUFFER,g.DEPTH_STENCIL_ATTACHMENT,g.TEXTURE_2D,rn,0)}}(qe.__webglFramebuffer,rt)}else if(wi){qe.__webglDepthbuffer=[];for(let rn=0;rn<6;rn++)c.bindFramebuffer(g.FRAMEBUFFER,qe.__webglFramebuffer[rn]),qe.__webglDepthbuffer[rn]=g.createRenderbuffer(),Nr(qe.__webglDepthbuffer[rn],rt,!1)}else c.bindFramebuffer(g.FRAMEBUFFER,qe.__webglFramebuffer),qe.__webglDepthbuffer=g.createRenderbuffer(),Nr(qe.__webglDepthbuffer,rt,!1);c.bindFramebuffer(g.FRAMEBUFFER,null)}function Bn(rt){return M&&(rt.useRenderbuffer||rt.useRenderToTexture)?Math.min(U,rt.samples):0}function jr(rt,qe){const wi=rt.encoding,rn=rt.format,ir=rt.type;return!0===rt.isCompressedTexture||!0===rt.isVideoTexture||1035===rt.format||wi!==od&&(wi===zn?!1===M?!0===o.has("EXT_sRGB")&&rn===Ua?(rt.format=1035,rt.minFilter=tt,rt.generateMipmaps=!1):qe=Yi.sRGBToLinear(qe):(rn!==Ua||ir!==Xn)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",wi)),qe}let Zr=!1,Ys=!1;this.allocateTextureUnit=function Ut(){const rt=zt;return rt>=R&&console.warn("THREE.WebGLTextures: Trying to use "+rt+" texture units while this GPU supports only "+R),zt+=1,rt},this.resetTextureUnits=function Qt(){zt=0},this.setTexture2D=ue,this.setTexture2DArray=function Xt(rt,qe){const wi=d.get(rt);rt.version>0&&wi.__version!==rt.version?At(wi,rt,qe):(c.activeTexture(g.TEXTURE0+qe),c.bindTexture(g.TEXTURE_2D_ARRAY,wi.__webglTexture))},this.setTexture3D=function ui(rt,qe){const wi=d.get(rt);rt.version>0&&wi.__version!==rt.version?At(wi,rt,qe):(c.activeTexture(g.TEXTURE0+qe),c.bindTexture(g.TEXTURE_3D,wi.__webglTexture))},this.setTextureCube=hi,this.rebindTextures=function Xr(rt,qe,wi){const rn=d.get(rt);void 0!==qe&&sr(rn.__webglFramebuffer,rt,rt.texture,g.COLOR_ATTACHMENT0,g.TEXTURE_2D),void 0!==wi&&ws(rt)},this.setupRenderTarget=function Ai(rt){const qe=rt.texture,wi=d.get(rt),rn=d.get(qe);rt.addEventListener("dispose",Pe),!0!==rt.isWebGLMultipleRenderTargets&&(void 0===rn.__webglTexture&&(rn.__webglTexture=g.createTexture()),rn.__version=qe.version,w.memory.textures++);const ir=!0===rt.isWebGLCubeRenderTarget,vi=!0===rt.isWebGLMultipleRenderTargets,Sr=qe.isDataTexture3D||qe.isDataTexture2DArray,or=Oe(rt)||M;if(ir){wi.__webglFramebuffer=[];for(let wn=0;wn<6;wn++)wi.__webglFramebuffer[wn]=g.createFramebuffer()}else if(wi.__webglFramebuffer=g.createFramebuffer(),vi)if(p.drawBuffers){const wn=rt.texture;for(let vn=0,ss=wn.length;vn<ss;vn++){const St=d.get(wn[vn]);void 0===St.__webglTexture&&(St.__webglTexture=g.createTexture(),w.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(rt.useRenderbuffer)if(M){wi.__webglMultisampledFramebuffer=g.createFramebuffer(),wi.__webglColorRenderbuffer=g.createRenderbuffer(),g.bindRenderbuffer(g.RENDERBUFFER,wi.__webglColorRenderbuffer);const wn=y.convert(qe.format,qe.encoding),vn=y.convert(qe.type),ss=ht(qe.internalFormat,wn,vn,qe.encoding),St=Bn(rt);g.renderbufferStorageMultisample(g.RENDERBUFFER,St,ss,rt.width,rt.height),c.bindFramebuffer(g.FRAMEBUFFER,wi.__webglMultisampledFramebuffer),g.framebufferRenderbuffer(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.RENDERBUFFER,wi.__webglColorRenderbuffer),g.bindRenderbuffer(g.RENDERBUFFER,null),rt.depthBuffer&&(wi.__webglDepthRenderbuffer=g.createRenderbuffer(),Nr(wi.__webglDepthRenderbuffer,rt,!0)),c.bindFramebuffer(g.FRAMEBUFFER,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(ir){c.bindTexture(g.TEXTURE_CUBE_MAP,rn.__webglTexture),Yn(g.TEXTURE_CUBE_MAP,qe,or);for(let wn=0;wn<6;wn++)sr(wi.__webglFramebuffer[wn],rt,qe,g.COLOR_ATTACHMENT0,g.TEXTURE_CUBE_MAP_POSITIVE_X+wn);ze(qe,or)&&$e(g.TEXTURE_CUBE_MAP),c.unbindTexture()}else if(vi){const wn=rt.texture;for(let vn=0,ss=wn.length;vn<ss;vn++){const St=wn[vn],Kn=d.get(St);c.bindTexture(g.TEXTURE_2D,Kn.__webglTexture),Yn(g.TEXTURE_2D,St,or),sr(wi.__webglFramebuffer,rt,St,g.COLOR_ATTACHMENT0+vn,g.TEXTURE_2D),ze(St,or)&&$e(g.TEXTURE_2D)}c.unbindTexture()}else{let wn=g.TEXTURE_2D;Sr&&(M?wn=qe.isDataTexture3D?g.TEXTURE_3D:g.TEXTURE_2D_ARRAY:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),c.bindTexture(wn,rn.__webglTexture),Yn(wn,qe,or),sr(wi.__webglFramebuffer,rt,qe,g.COLOR_ATTACHMENT0,wn),ze(qe,or)&&$e(wn),c.unbindTexture()}rt.depthBuffer&&ws(rt)},this.updateRenderTargetMipmap=function an(rt){const qe=Oe(rt)||M,wi=!0===rt.isWebGLMultipleRenderTargets?rt.texture:[rt.texture];for(let rn=0,ir=wi.length;rn<ir;rn++){const vi=wi[rn];if(ze(vi,qe)){const Sr=rt.isWebGLCubeRenderTarget?g.TEXTURE_CUBE_MAP:g.TEXTURE_2D,or=d.get(vi).__webglTexture;c.bindTexture(Sr,or),$e(Sr),c.unbindTexture()}}},this.updateMultisampleRenderTarget=function en(rt){if(rt.useRenderbuffer)if(M){const qe=rt.width,wi=rt.height;let rn=g.COLOR_BUFFER_BIT;const ir=[g.COLOR_ATTACHMENT0],vi=rt.stencilBuffer?g.DEPTH_STENCIL_ATTACHMENT:g.DEPTH_ATTACHMENT;rt.depthBuffer&&ir.push(vi),rt.ignoreDepthForMultisampleCopy||(rt.depthBuffer&&(rn|=g.DEPTH_BUFFER_BIT),rt.stencilBuffer&&(rn|=g.STENCIL_BUFFER_BIT));const Sr=d.get(rt);c.bindFramebuffer(g.READ_FRAMEBUFFER,Sr.__webglMultisampledFramebuffer),c.bindFramebuffer(g.DRAW_FRAMEBUFFER,Sr.__webglFramebuffer),rt.ignoreDepthForMultisampleCopy&&(g.invalidateFramebuffer(g.READ_FRAMEBUFFER,[vi]),g.invalidateFramebuffer(g.DRAW_FRAMEBUFFER,[vi])),g.blitFramebuffer(0,0,qe,wi,0,0,qe,wi,rn,g.NEAREST),g.invalidateFramebuffer(g.READ_FRAMEBUFFER,ir),c.bindFramebuffer(g.READ_FRAMEBUFFER,null),c.bindFramebuffer(g.DRAW_FRAMEBUFFER,Sr.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.setupDepthRenderbuffer=ws,this.setupFrameBufferTexture=sr,this.safeSetTexture2D=function qo(rt,qe){rt&&rt.isWebGLRenderTarget&&(!1===Zr&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),Zr=!0),rt=rt.texture),ue(rt,qe)},this.safeSetTextureCube=function Ro(rt,qe){rt&&rt.isWebGLCubeRenderTarget&&(!1===Ys&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),Ys=!0),rt=rt.texture),hi(rt,qe)}}function lM(g,o,c){const d=c.isWebGL2;return{convert:function p(y,w=null){let M;if(y===Xn)return g.UNSIGNED_BYTE;if(1017===y)return g.UNSIGNED_SHORT_4_4_4_4;if(1018===y)return g.UNSIGNED_SHORT_5_5_5_1;if(1010===y)return g.BYTE;if(1011===y)return g.SHORT;if(y===vs)return g.UNSIGNED_SHORT;if(1013===y)return g.INT;if(y===ic)return g.UNSIGNED_INT;if(y===eo)return g.FLOAT;if(y===Sa)return d?g.HALF_FLOAT:(M=o.get("OES_texture_half_float"),null!==M?M.HALF_FLOAT_OES:null);if(1021===y)return g.ALPHA;if(y===Ua)return g.RGBA;if(1024===y)return g.LUMINANCE;if(1025===y)return g.LUMINANCE_ALPHA;if(y===ed)return g.DEPTH_COMPONENT;if(y===ks)return g.DEPTH_STENCIL;if(1028===y)return g.RED;if(1035===y)return M=o.get("EXT_sRGB"),null!==M?M.SRGB_ALPHA_EXT:null;if(1029===y)return g.RED_INTEGER;if(1030===y)return g.RG;if(1031===y)return g.RG_INTEGER;if(1033===y)return g.RGBA_INTEGER;if(y===ep||y===Jp||y===tu||y===cf)if(w===zn){if(M=o.get("WEBGL_compressed_texture_s3tc_srgb"),null===M)return null;if(y===ep)return M.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(y===Jp)return M.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(y===tu)return M.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(y===cf)return M.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(M=o.get("WEBGL_compressed_texture_s3tc"),null===M)return null;if(y===ep)return M.COMPRESSED_RGB_S3TC_DXT1_EXT;if(y===Jp)return M.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(y===tu)return M.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(y===cf)return M.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===y||35841===y||35842===y||35843===y){if(M=o.get("WEBGL_compressed_texture_pvrtc"),null===M)return null;if(35840===y)return M.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===y)return M.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===y)return M.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===y)return M.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===y)return M=o.get("WEBGL_compressed_texture_etc1"),null!==M?M.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===y||37496===y){if(M=o.get("WEBGL_compressed_texture_etc"),null===M)return null;if(37492===y)return w===zn?M.COMPRESSED_SRGB8_ETC2:M.COMPRESSED_RGB8_ETC2;if(37496===y)return w===zn?M.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:M.COMPRESSED_RGBA8_ETC2_EAC}if(37808===y||37809===y||37810===y||37811===y||37812===y||37813===y||37814===y||37815===y||37816===y||37817===y||37818===y||37819===y||37820===y||37821===y){if(M=o.get("WEBGL_compressed_texture_astc"),null===M)return null;if(37808===y)return w===zn?M.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:M.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===y)return w===zn?M.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:M.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===y)return w===zn?M.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:M.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===y)return w===zn?M.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:M.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===y)return w===zn?M.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:M.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===y)return w===zn?M.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:M.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===y)return w===zn?M.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:M.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===y)return w===zn?M.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:M.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===y)return w===zn?M.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:M.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===y)return w===zn?M.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:M.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===y)return w===zn?M.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:M.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===y)return w===zn?M.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:M.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===y)return w===zn?M.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:M.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===y)return w===zn?M.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:M.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===y){if(M=o.get("EXT_texture_compression_bptc"),null===M)return null;if(36492===y)return w===zn?M.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:M.COMPRESSED_RGBA_BPTC_UNORM_EXT}return y===gh?d?g.UNSIGNED_INT_24_8:(M=o.get("WEBGL_depth_texture"),null!==M?M.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}Hv.prototype.isMeshDistanceMaterial=!0;class Rx extends vl{constructor(o=[]){super(),this.cameras=o}}Rx.prototype.isArrayCamera=!0;class Mf extends _t{constructor(){super(),this.type="Group"}}Mf.prototype.isGroup=!0;const KA={type:"move"};class v_{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Mf,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Mf,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Ne,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Ne),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Mf,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Ne,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Ne),this._grip}dispatchEvent(o){return null!==this._targetRay&&this._targetRay.dispatchEvent(o),null!==this._grip&&this._grip.dispatchEvent(o),null!==this._hand&&this._hand.dispatchEvent(o),this}disconnect(o){return this.dispatchEvent({type:"disconnected",data:o}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(o,c,d){let p=null,y=null,w=null;const M=this._targetRay,R=this._grip,A=this._hand;if(o&&"visible-blurred"!==c.session.visibilityState)if(null!==M&&(p=c.getPose(o.targetRaySpace,d),null!==p&&(M.matrix.fromArray(p.transform.matrix),M.matrix.decompose(M.position,M.rotation,M.scale),p.linearVelocity?(M.hasLinearVelocity=!0,M.linearVelocity.copy(p.linearVelocity)):M.hasLinearVelocity=!1,p.angularVelocity?(M.hasAngularVelocity=!0,M.angularVelocity.copy(p.angularVelocity)):M.hasAngularVelocity=!1,this.dispatchEvent(KA))),A&&o.hand){w=!0;for(const le of o.hand.values()){const Se=c.getJointPose(le,d);if(void 0===A.joints[le.jointName]){const K=new Mf;K.matrixAutoUpdate=!1,K.visible=!1,A.joints[le.jointName]=K,A.add(K)}const re=A.joints[le.jointName];null!==Se&&(re.matrix.fromArray(Se.transform.matrix),re.matrix.decompose(re.position,re.rotation,re.scale),re.jointRadius=Se.radius),re.visible=null!==Se}const q=A.joints["index-finger-tip"].position.distanceTo(A.joints["thumb-tip"].position),Y=.02,ne=.005;A.inputState.pinching&&q>Y+ne?(A.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:o.handedness,target:this})):!A.inputState.pinching&&q<=Y-ne&&(A.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:o.handedness,target:this}))}else null!==R&&o.gripSpace&&(y=c.getPose(o.gripSpace,d),null!==y&&(R.matrix.fromArray(y.transform.matrix),R.matrix.decompose(R.position,R.rotation,R.scale),y.linearVelocity?(R.hasLinearVelocity=!0,R.linearVelocity.copy(y.linearVelocity)):R.hasLinearVelocity=!1,y.angularVelocity?(R.hasAngularVelocity=!0,R.angularVelocity.copy(y.angularVelocity)):R.hasAngularVelocity=!1));return null!==M&&(M.visible=null!==p),null!==R&&(R.visible=null!==y),null!==A&&(A.visible=null!==w),this}}class ym extends Jr{constructor(o,c,d,p,y,w,M,R,A,N){if((N=void 0!==N?N:ed)!==ed&&N!==ks)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===d&&N===ed&&(d=vs),void 0===d&&N===ks&&(d=gh),super(null,p,y,w,M,R,N,d,A),this.image={width:o,height:c},this.magFilter=void 0!==M?M:ro,this.minFilter=void 0!==R?R:ro,this.flipY=!1,this.generateMipmaps=!1}}ym.prototype.isDepthTexture=!0;class QA extends Fl{constructor(o,c){super();const d=this;let p=null,y=1,w=null,M="local-floor";const R=o.extensions.has("WEBGL_multisampled_render_to_texture");let A=null,N=null,U=null,q=null,Y=!1,ne=null;const le=c.getContextAttributes();let Se=null,re=null;const K=[],Oe=new Map,xe=new vl;xe.layers.enable(1),xe.viewport=new Es;const ze=new vl;ze.layers.enable(2),ze.viewport=new Es;const $e=[xe,ze],ht=new Rx;ht.layers.enable(1),ht.layers.enable(2);let Et=null,ci=null;function Yt(hi){const Bi=Oe.get(hi.inputSource);Bi&&Bi.dispatchEvent({type:hi.type,data:hi.inputSource})}function Pe(){Oe.forEach(function(hi,Bi){hi.disconnect(Bi)}),Oe.clear(),Et=null,ci=null,o.setRenderTarget(Se),q=null,U=null,N=null,p=null,re=null,ui.stop(),d.isPresenting=!1,d.dispatchEvent({type:"sessionend"})}function bt(hi){const Bi=p.inputSources;for(let yn=0;yn<K.length;yn++)Oe.set(Bi[yn],K[yn]);for(let yn=0;yn<hi.removed.length;yn++){const Yn=hi.removed[yn],ur=Oe.get(Yn);ur&&(ur.dispatchEvent({type:"disconnected",data:Yn}),Oe.delete(Yn))}for(let yn=0;yn<hi.added.length;yn++){const Yn=hi.added[yn],ur=Oe.get(Yn);ur&&ur.dispatchEvent({type:"connected",data:Yn})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(hi){let Bi=K[hi];return void 0===Bi&&(Bi=new v_,K[hi]=Bi),Bi.getTargetRaySpace()},this.getControllerGrip=function(hi){let Bi=K[hi];return void 0===Bi&&(Bi=new v_,K[hi]=Bi),Bi.getGripSpace()},this.getHand=function(hi){let Bi=K[hi];return void 0===Bi&&(Bi=new v_,K[hi]=Bi),Bi.getHandSpace()},this.setFramebufferScaleFactor=function(hi){y=hi,!0===d.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(hi){M=hi,!0===d.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return w},this.getBaseLayer=function(){return null!==U?U:q},this.getBinding=function(){return N},this.getFrame=function(){return ne},this.getSession=function(){return p},this.setSession=function(){var hi=F(function*(Bi){if(p=Bi,null!==p){if(Se=o.getRenderTarget(),p.addEventListener("select",Yt),p.addEventListener("selectstart",Yt),p.addEventListener("selectend",Yt),p.addEventListener("squeeze",Yt),p.addEventListener("squeezestart",Yt),p.addEventListener("squeezeend",Yt),p.addEventListener("end",Pe),p.addEventListener("inputsourceschange",bt),!0!==le.xrCompatible&&(yield c.makeXRCompatible()),void 0===p.renderState.layers||!1===o.capabilities.isWebGL2)q=new XRWebGLLayer(p,c,{antialias:void 0!==p.renderState.layers||le.antialias,alpha:le.alpha,depth:le.depth,stencil:le.stencil,framebufferScaleFactor:y}),p.updateRenderState({baseLayer:q}),re=new bs(q.framebufferWidth,q.framebufferHeight,{format:Ua,type:Xn,encoding:o.outputEncoding});else{Y=le.antialias;let yn=null,Yn=null,ur=null;le.depth&&(ur=le.stencil?c.DEPTH24_STENCIL8:c.DEPTH_COMPONENT24,yn=le.stencil?ks:ed,Yn=le.stencil?gh:vs);const At={colorFormat:o.outputEncoding===zn?c.SRGB8_ALPHA8:c.RGBA8,depthFormat:ur,scaleFactor:y};N=new XRWebGLBinding(p,c),U=N.createProjectionLayer(At),p.updateRenderState({layers:[U]}),re=Y?new ho(U.textureWidth,U.textureHeight,{format:Ua,type:Xn,depthTexture:new ym(U.textureWidth,U.textureHeight,Yn,void 0,void 0,void 0,void 0,void 0,void 0,yn),stencilBuffer:le.stencil,ignoreDepth:U.ignoreDepthValues,useRenderToTexture:R,encoding:o.outputEncoding}):new bs(U.textureWidth,U.textureHeight,{format:Ua,type:Xn,depthTexture:new ym(U.textureWidth,U.textureHeight,Yn,void 0,void 0,void 0,void 0,void 0,void 0,yn),stencilBuffer:le.stencil,ignoreDepth:U.ignoreDepthValues,encoding:o.outputEncoding})}re.isXRRenderTarget=!0,this.setFoveation(1),w=yield p.requestReferenceSpace(M),ui.setContext(p),ui.start(),d.isPresenting=!0,d.dispatchEvent({type:"sessionstart"})}});return function(Bi){return hi.apply(this,arguments)}}();const Ft=new Ne,zt=new Ne;function Ut(hi,Bi){null===Bi?hi.matrixWorld.copy(hi.matrix):hi.matrixWorld.multiplyMatrices(Bi.matrixWorld,hi.matrix),hi.matrixWorldInverse.copy(hi.matrixWorld).invert()}this.updateCamera=function(hi){if(null===p)return;ht.near=ze.near=xe.near=hi.near,ht.far=ze.far=xe.far=hi.far,(Et!==ht.near||ci!==ht.far)&&(p.updateRenderState({depthNear:ht.near,depthFar:ht.far}),Et=ht.near,ci=ht.far);const Bi=hi.parent,yn=ht.cameras;Ut(ht,Bi);for(let ur=0;ur<yn.length;ur++)Ut(yn[ur],Bi);ht.matrixWorld.decompose(ht.position,ht.quaternion,ht.scale),hi.position.copy(ht.position),hi.quaternion.copy(ht.quaternion),hi.scale.copy(ht.scale),hi.matrix.copy(ht.matrix),hi.matrixWorld.copy(ht.matrixWorld);const Yn=hi.children;for(let ur=0,At=Yn.length;ur<At;ur++)Yn[ur].updateMatrixWorld(!0);2===yn.length?function Qt(hi,Bi,yn){Ft.setFromMatrixPosition(Bi.matrixWorld),zt.setFromMatrixPosition(yn.matrixWorld);const Yn=Ft.distanceTo(zt),ur=Bi.projectionMatrix.elements,At=yn.projectionMatrix.elements,oo=ur[14]/(ur[10]-1),sr=ur[14]/(ur[10]+1),Nr=(ur[9]+1)/ur[5],Fn=(ur[9]-1)/ur[5],ws=(ur[8]-1)/ur[0],Xr=(At[8]+1)/At[0],Ai=oo*ws,an=oo*Xr,en=Yn/(-ws+Xr),Bn=en*-ws;Bi.matrixWorld.decompose(hi.position,hi.quaternion,hi.scale),hi.translateX(Bn),hi.translateZ(en),hi.matrixWorld.compose(hi.position,hi.quaternion,hi.scale),hi.matrixWorldInverse.copy(hi.matrixWorld).invert();const Tn=oo+en,jr=sr+en;hi.projectionMatrix.makePerspective(Ai-Bn,an+(Yn-Bn),Nr*sr/jr*Tn,Fn*sr/jr*Tn,Tn,jr)}(ht,xe,ze):ht.projectionMatrix.copy(xe.projectionMatrix)},this.getCamera=function(){return ht},this.getFoveation=function(){return null!==U?U.fixedFoveation:null!==q?q.fixedFoveation:void 0},this.setFoveation=function(hi){null!==U&&(U.fixedFoveation=hi),null!==q&&void 0!==q.fixedFoveation&&(q.fixedFoveation=hi)};let ue=null;const ui=new ZE;ui.setAnimationLoop(function Xt(hi,Bi){if(A=Bi.getViewerPose(w),ne=Bi,null!==A){const Yn=A.views;null!==q&&(o.setRenderTargetFramebuffer(re,q.framebuffer),o.setRenderTarget(re));let ur=!1;Yn.length!==ht.cameras.length&&(ht.cameras.length=0,ur=!0);for(let At=0;At<Yn.length;At++){const oo=Yn[At];let sr=null;if(null!==q)sr=q.getViewport(oo);else{const Fn=N.getViewSubImage(U,oo);sr=Fn.viewport,0===At&&(o.setRenderTargetTextures(re,Fn.colorTexture,U.ignoreDepthValues?void 0:Fn.depthStencilTexture),o.setRenderTarget(re))}const Nr=$e[At];Nr.matrix.fromArray(oo.transform.matrix),Nr.projectionMatrix.fromArray(oo.projectionMatrix),Nr.viewport.set(sr.x,sr.y,sr.width,sr.height),0===At&&ht.matrix.copy(Nr.matrix),!0===ur&&ht.cameras.push(Nr)}}const yn=p.inputSources;for(let Yn=0;Yn<K.length;Yn++)K[Yn].update(yn[Yn],Bi,w);ue&&ue(hi,Bi),ne=null}),this.setAnimationLoop=function(hi){ue=hi},this.dispose=function(){}}}function cM(g){function d(re,K){re.opacity.value=K.opacity,K.color&&re.diffuse.value.copy(K.color),K.emissive&&re.emissive.value.copy(K.emissive).multiplyScalar(K.emissiveIntensity),K.map&&(re.map.value=K.map),K.alphaMap&&(re.alphaMap.value=K.alphaMap),K.specularMap&&(re.specularMap.value=K.specularMap),K.alphaTest>0&&(re.alphaTest.value=K.alphaTest);const Oe=g.get(K).envMap;let xe,ze;Oe&&(re.envMap.value=Oe,re.flipEnvMap.value=Oe.isCubeTexture&&!1===Oe.isRenderTargetTexture?-1:1,re.reflectivity.value=K.reflectivity,re.ior.value=K.ior,re.refractionRatio.value=K.refractionRatio),K.lightMap&&(re.lightMap.value=K.lightMap,re.lightMapIntensity.value=K.lightMapIntensity),K.aoMap&&(re.aoMap.value=K.aoMap,re.aoMapIntensity.value=K.aoMapIntensity),K.map?xe=K.map:K.specularMap?xe=K.specularMap:K.displacementMap?xe=K.displacementMap:K.normalMap?xe=K.normalMap:K.bumpMap?xe=K.bumpMap:K.roughnessMap?xe=K.roughnessMap:K.metalnessMap?xe=K.metalnessMap:K.alphaMap?xe=K.alphaMap:K.emissiveMap?xe=K.emissiveMap:K.clearcoatMap?xe=K.clearcoatMap:K.clearcoatNormalMap?xe=K.clearcoatNormalMap:K.clearcoatRoughnessMap?xe=K.clearcoatRoughnessMap:K.specularIntensityMap?xe=K.specularIntensityMap:K.specularColorMap?xe=K.specularColorMap:K.transmissionMap?xe=K.transmissionMap:K.thicknessMap?xe=K.thicknessMap:K.sheenColorMap?xe=K.sheenColorMap:K.sheenRoughnessMap&&(xe=K.sheenRoughnessMap),void 0!==xe&&(xe.isWebGLRenderTarget&&(xe=xe.texture),!0===xe.matrixAutoUpdate&&xe.updateMatrix(),re.uvTransform.value.copy(xe.matrix)),K.aoMap?ze=K.aoMap:K.lightMap&&(ze=K.lightMap),void 0!==ze&&(ze.isWebGLRenderTarget&&(ze=ze.texture),!0===ze.matrixAutoUpdate&&ze.updateMatrix(),re.uv2Transform.value.copy(ze.matrix))}function U(re,K){re.roughness.value=K.roughness,re.metalness.value=K.metalness,K.roughnessMap&&(re.roughnessMap.value=K.roughnessMap),K.metalnessMap&&(re.metalnessMap.value=K.metalnessMap),K.emissiveMap&&(re.emissiveMap.value=K.emissiveMap),K.bumpMap&&(re.bumpMap.value=K.bumpMap,re.bumpScale.value=K.bumpScale,1===K.side&&(re.bumpScale.value*=-1)),K.normalMap&&(re.normalMap.value=K.normalMap,re.normalScale.value.copy(K.normalScale),1===K.side&&re.normalScale.value.negate()),K.displacementMap&&(re.displacementMap.value=K.displacementMap,re.displacementScale.value=K.displacementScale,re.displacementBias.value=K.displacementBias),g.get(K).envMap&&(re.envMapIntensity.value=K.envMapIntensity)}return{refreshFogUniforms:function o(re,K){re.fogColor.value.copy(K.color),K.isFog?(re.fogNear.value=K.near,re.fogFar.value=K.far):K.isFogExp2&&(re.fogDensity.value=K.density)},refreshMaterialUniforms:function c(re,K,Oe,xe,ze){K.isMeshBasicMaterial?d(re,K):K.isMeshLambertMaterial?(d(re,K),function R(re,K){K.emissiveMap&&(re.emissiveMap.value=K.emissiveMap)}(re,K)):K.isMeshToonMaterial?(d(re,K),function N(re,K){K.gradientMap&&(re.gradientMap.value=K.gradientMap),K.emissiveMap&&(re.emissiveMap.value=K.emissiveMap),K.bumpMap&&(re.bumpMap.value=K.bumpMap,re.bumpScale.value=K.bumpScale,1===K.side&&(re.bumpScale.value*=-1)),K.normalMap&&(re.normalMap.value=K.normalMap,re.normalScale.value.copy(K.normalScale),1===K.side&&re.normalScale.value.negate()),K.displacementMap&&(re.displacementMap.value=K.displacementMap,re.displacementScale.value=K.displacementScale,re.displacementBias.value=K.displacementBias)}(re,K)):K.isMeshPhongMaterial?(d(re,K),function A(re,K){re.specular.value.copy(K.specular),re.shininess.value=Math.max(K.shininess,1e-4),K.emissiveMap&&(re.emissiveMap.value=K.emissiveMap),K.bumpMap&&(re.bumpMap.value=K.bumpMap,re.bumpScale.value=K.bumpScale,1===K.side&&(re.bumpScale.value*=-1)),K.normalMap&&(re.normalMap.value=K.normalMap,re.normalScale.value.copy(K.normalScale),1===K.side&&re.normalScale.value.negate()),K.displacementMap&&(re.displacementMap.value=K.displacementMap,re.displacementScale.value=K.displacementScale,re.displacementBias.value=K.displacementBias)}(re,K)):K.isMeshStandardMaterial?(d(re,K),K.isMeshPhysicalMaterial?function q(re,K,Oe){U(re,K),re.ior.value=K.ior,K.sheen>0&&(re.sheenColor.value.copy(K.sheenColor).multiplyScalar(K.sheen),re.sheenRoughness.value=K.sheenRoughness,K.sheenColorMap&&(re.sheenColorMap.value=K.sheenColorMap),K.sheenRoughnessMap&&(re.sheenRoughnessMap.value=K.sheenRoughnessMap)),K.clearcoat>0&&(re.clearcoat.value=K.clearcoat,re.clearcoatRoughness.value=K.clearcoatRoughness,K.clearcoatMap&&(re.clearcoatMap.value=K.clearcoatMap),K.clearcoatRoughnessMap&&(re.clearcoatRoughnessMap.value=K.clearcoatRoughnessMap),K.clearcoatNormalMap&&(re.clearcoatNormalScale.value.copy(K.clearcoatNormalScale),re.clearcoatNormalMap.value=K.clearcoatNormalMap,1===K.side&&re.clearcoatNormalScale.value.negate())),K.transmission>0&&(re.transmission.value=K.transmission,re.transmissionSamplerMap.value=Oe.texture,re.transmissionSamplerSize.value.set(Oe.width,Oe.height),K.transmissionMap&&(re.transmissionMap.value=K.transmissionMap),re.thickness.value=K.thickness,K.thicknessMap&&(re.thicknessMap.value=K.thicknessMap),re.attenuationDistance.value=K.attenuationDistance,re.attenuationColor.value.copy(K.attenuationColor)),re.specularIntensity.value=K.specularIntensity,re.specularColor.value.copy(K.specularColor),K.specularIntensityMap&&(re.specularIntensityMap.value=K.specularIntensityMap),K.specularColorMap&&(re.specularColorMap.value=K.specularColorMap)}(re,K,ze):U(re,K)):K.isMeshMatcapMaterial?(d(re,K),function Y(re,K){K.matcap&&(re.matcap.value=K.matcap),K.bumpMap&&(re.bumpMap.value=K.bumpMap,re.bumpScale.value=K.bumpScale,1===K.side&&(re.bumpScale.value*=-1)),K.normalMap&&(re.normalMap.value=K.normalMap,re.normalScale.value.copy(K.normalScale),1===K.side&&re.normalScale.value.negate()),K.displacementMap&&(re.displacementMap.value=K.displacementMap,re.displacementScale.value=K.displacementScale,re.displacementBias.value=K.displacementBias)}(re,K)):K.isMeshDepthMaterial?(d(re,K),function ne(re,K){K.displacementMap&&(re.displacementMap.value=K.displacementMap,re.displacementScale.value=K.displacementScale,re.displacementBias.value=K.displacementBias)}(re,K)):K.isMeshDistanceMaterial?(d(re,K),function le(re,K){K.displacementMap&&(re.displacementMap.value=K.displacementMap,re.displacementScale.value=K.displacementScale,re.displacementBias.value=K.displacementBias),re.referencePosition.value.copy(K.referencePosition),re.nearDistance.value=K.nearDistance,re.farDistance.value=K.farDistance}(re,K)):K.isMeshNormalMaterial?(d(re,K),function Se(re,K){K.bumpMap&&(re.bumpMap.value=K.bumpMap,re.bumpScale.value=K.bumpScale,1===K.side&&(re.bumpScale.value*=-1)),K.normalMap&&(re.normalMap.value=K.normalMap,re.normalScale.value.copy(K.normalScale),1===K.side&&re.normalScale.value.negate()),K.displacementMap&&(re.displacementMap.value=K.displacementMap,re.displacementScale.value=K.displacementScale,re.displacementBias.value=K.displacementBias)}(re,K)):K.isLineBasicMaterial?(function p(re,K){re.diffuse.value.copy(K.color),re.opacity.value=K.opacity}(re,K),K.isLineDashedMaterial&&function y(re,K){re.dashSize.value=K.dashSize,re.totalSize.value=K.dashSize+K.gapSize,re.scale.value=K.scale}(re,K)):K.isPointsMaterial?function w(re,K,Oe,xe){let ze;re.diffuse.value.copy(K.color),re.opacity.value=K.opacity,re.size.value=K.size*Oe,re.scale.value=.5*xe,K.map&&(re.map.value=K.map),K.alphaMap&&(re.alphaMap.value=K.alphaMap),K.alphaTest>0&&(re.alphaTest.value=K.alphaTest),K.map?ze=K.map:K.alphaMap&&(ze=K.alphaMap),void 0!==ze&&(!0===ze.matrixAutoUpdate&&ze.updateMatrix(),re.uvTransform.value.copy(ze.matrix))}(re,K,Oe,xe):K.isSpriteMaterial?function M(re,K){let Oe;re.diffuse.value.copy(K.color),re.opacity.value=K.opacity,re.rotation.value=K.rotation,K.map&&(re.map.value=K.map),K.alphaMap&&(re.alphaMap.value=K.alphaMap),K.alphaTest>0&&(re.alphaTest.value=K.alphaTest),K.map?Oe=K.map:K.alphaMap&&(Oe=K.alphaMap),void 0!==Oe&&(!0===Oe.matrixAutoUpdate&&Oe.updateMatrix(),re.uvTransform.value.copy(Oe.matrix))}(re,K):K.isShadowMaterial?(re.color.value.copy(K.color),re.opacity.value=K.opacity):K.isShaderMaterial&&(K.uniformsNeedUpdate=!1)}}}function po(g={}){const o=void 0!==g.canvas?g.canvas:function JA(){const g=Bl("canvas");return g.style.display="block",g}(),c=void 0!==g.context?g.context:null,d=void 0!==g.alpha&&g.alpha,p=void 0===g.depth||g.depth,y=void 0===g.stencil||g.stencil,w=void 0!==g.antialias&&g.antialias,M=void 0===g.premultipliedAlpha||g.premultipliedAlpha,R=void 0!==g.preserveDrawingBuffer&&g.preserveDrawingBuffer,A=void 0!==g.powerPreference?g.powerPreference:"default",N=void 0!==g.failIfMajorPerformanceCaveat&&g.failIfMajorPerformanceCaveat;let U=null,q=null;const Y=[],ne=[];this.domElement=o,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=od,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1;const le=this;let Se=!1,re=0,K=0,Oe=null,xe=-1,ze=null;const $e=new Es,ht=new Es;let Et=null,ci=o.width,Yt=o.height,Pe=1,bt=null,Ft=null;const zt=new Es(0,0,ci,Yt),Qt=new Es(0,0,ci,Yt);let Ut=!1;const ue=new bv;let Xt=!1,ui=!1,hi=null;const Bi=new Mn,yn=new Ne,Yn={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function ur(){return null===Oe?Pe:1}let sr,Nr,Fn,ws,Xr,Ai,an,en,Bn,Tn,jr,Zr,Ys,qo,Ro,rt,qe,wi,rn,ir,vi,Sr,or,At=c;function oo(Ze,Bt){for(let si=0;si<Ze.length;si++){const ki=o.getContext(Ze[si],Bt);if(null!==ki)return ki}return null}try{const Ze={alpha:!0,depth:p,stencil:y,antialias:w,premultipliedAlpha:M,preserveDrawingBuffer:R,powerPreference:A,failIfMajorPerformanceCaveat:N};if("setAttribute"in o&&o.setAttribute("data-engine","three.js r137"),o.addEventListener("webglcontextlost",ss,!1),o.addEventListener("webglcontextrestored",St,!1),null===At){const Bt=["webgl2","webgl","experimental-webgl"];if(!0===le.isWebGL1Renderer&&Bt.shift(),At=oo(Bt,Ze),null===At)throw oo(Bt)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===At.getShaderPrecisionFormat&&(At.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Ze){throw console.error("THREE.WebGLRenderer: "+Ze.message),Ze}function wn(){sr=new Qz(At),Nr=new VC(At,sr,g),sr.init(Nr),Sr=new lM(At,sr,Nr),Fn=new WO(At,sr,Nr),ws=new SA(At),Xr=new HO,Ai=new YA(At,sr,Fn,Xr,Nr,Sr,ws),an=new rO(le),en=new oO(le),Bn=new ax(At,Nr),or=new nO(At,sr,Bn,Nr),Tn=new aO(At,Bn,ws,or),jr=new Jz(At,Tn,Bn,ws),rn=new MA(At,Nr,Ai),rt=new p_(Xr),Zr=new NO(le,an,en,sr,Nr,or,rt),Ys=new cM(Xr),qo=new jA,Ro=new XA(sr,Nr),wi=new iO(le,an,Fn,jr,d,M),qe=new Vv(le,jr,Nr),ir=new xx(At,sr,ws,Nr),vi=new Pv(At,sr,ws,Nr),ws.programs=Zr.programs,le.capabilities=Nr,le.extensions=sr,le.properties=Xr,le.renderLists=qo,le.shadowMap=qe,le.state=Fn,le.info=ws}wn();const vn=new QA(le,At);function ss(Ze){Ze.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),Se=!0}function St(){console.log("THREE.WebGLRenderer: Context Restored."),Se=!1;const Ze=ws.autoReset,Bt=qe.enabled,si=qe.autoUpdate,Ot=qe.needsUpdate,ki=qe.type;wn(),ws.autoReset=Ze,qe.enabled=Bt,qe.autoUpdate=si,qe.needsUpdate=Ot,qe.type=ki}function Kn(Ze){const Bt=Ze.target;Bt.removeEventListener("dispose",Kn),function dn(Ze){(function Cr(Ze){const Bt=Xr.get(Ze).programs;void 0!==Bt&&(Bt.forEach(function(si){Zr.releaseProgram(si)}),Ze.isShaderMaterial&&Zr.releaseShaderCache(Ze))})(Ze),Xr.remove(Ze)}(Bt)}this.xr=vn,this.getContext=function(){return At},this.getContextAttributes=function(){return At.getContextAttributes()},this.forceContextLoss=function(){const Ze=sr.get("WEBGL_lose_context");Ze&&Ze.loseContext()},this.forceContextRestore=function(){const Ze=sr.get("WEBGL_lose_context");Ze&&Ze.restoreContext()},this.getPixelRatio=function(){return Pe},this.setPixelRatio=function(Ze){void 0!==Ze&&(Pe=Ze,this.setSize(ci,Yt,!1))},this.getSize=function(Ze){return Ze.set(ci,Yt)},this.setSize=function(Ze,Bt,si){vn.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(ci=Ze,Yt=Bt,o.width=Math.floor(Ze*Pe),o.height=Math.floor(Bt*Pe),!1!==si&&(o.style.width=Ze+"px",o.style.height=Bt+"px"),this.setViewport(0,0,Ze,Bt))},this.getDrawingBufferSize=function(Ze){return Ze.set(ci*Pe,Yt*Pe).floor()},this.setDrawingBufferSize=function(Ze,Bt,si){ci=Ze,Yt=Bt,Pe=si,o.width=Math.floor(Ze*si),o.height=Math.floor(Bt*si),this.setViewport(0,0,Ze,Bt)},this.getCurrentViewport=function(Ze){return Ze.copy($e)},this.getViewport=function(Ze){return Ze.copy(zt)},this.setViewport=function(Ze,Bt,si,Ot){Ze.isVector4?zt.set(Ze.x,Ze.y,Ze.z,Ze.w):zt.set(Ze,Bt,si,Ot),Fn.viewport($e.copy(zt).multiplyScalar(Pe).floor())},this.getScissor=function(Ze){return Ze.copy(Qt)},this.setScissor=function(Ze,Bt,si,Ot){Ze.isVector4?Qt.set(Ze.x,Ze.y,Ze.z,Ze.w):Qt.set(Ze,Bt,si,Ot),Fn.scissor(ht.copy(Qt).multiplyScalar(Pe).floor())},this.getScissorTest=function(){return Ut},this.setScissorTest=function(Ze){Fn.setScissorTest(Ut=Ze)},this.setOpaqueSort=function(Ze){bt=Ze},this.setTransparentSort=function(Ze){Ft=Ze},this.getClearColor=function(Ze){return Ze.copy(wi.getClearColor())},this.setClearColor=function(){wi.setClearColor.apply(wi,arguments)},this.getClearAlpha=function(){return wi.getClearAlpha()},this.setClearAlpha=function(){wi.setClearAlpha.apply(wi,arguments)},this.clear=function(Ze,Bt,si){let Ot=0;(void 0===Ze||Ze)&&(Ot|=At.COLOR_BUFFER_BIT),(void 0===Bt||Bt)&&(Ot|=At.DEPTH_BUFFER_BIT),(void 0===si||si)&&(Ot|=At.STENCIL_BUFFER_BIT),At.clear(Ot)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){o.removeEventListener("webglcontextlost",ss,!1),o.removeEventListener("webglcontextrestored",St,!1),qo.dispose(),Ro.dispose(),Xr.dispose(),an.dispose(),en.dispose(),jr.dispose(),or.dispose(),Zr.dispose(),vn.dispose(),vn.removeEventListener("sessionstart",Ws),vn.removeEventListener("sessionend",ko),hi&&(hi.dispose(),hi=null),rh.stop()},this.renderBufferDirect=function(Ze,Bt,si,Ot,ki,es){null===Bt&&(Bt=Yn);const hs=ki.isMesh&&ki.matrixWorld.determinant()<0,Ms=function OF(Ze,Bt,si,Ot,ki){!0!==Bt.isScene&&(Bt=Yn),Ai.resetTextureUnits();const es=Bt.fog,Ms=null===Oe?le.outputEncoding:!0===Oe.isXRRenderTarget?Oe.texture.encoding:od,xs=(Ot.isMeshStandardMaterial?en:an).get(Ot.envMap||(Ot.isMeshStandardMaterial?Bt.environment:null)),yo=!0===Ot.vertexColors&&!!si.attributes.color&&4===si.attributes.color.itemSize,Ks=!!Ot.normalMap&&!!si.attributes.tangent,to=!!si.morphAttributes.position,Ra=!!si.morphAttributes.normal,Om=si.morphAttributes.position?si.morphAttributes.position.length:0,J_=Ot.toneMapped?le.toneMapping:0,js=Xr.get(Ot),Ud=q.state.lights;!0!==Xt||!0!==ui&&Ze===ze||rt.setState(Ot,Ze,Ze===ze&&Ot.id===xe);let wl=!1;Ot.version===js.__version?(js.needsLights&&js.lightsStateVersion!==Ud.state.version||js.outputEncoding!==Ms||ki.isInstancedMesh&&!1===js.instancing||!ki.isInstancedMesh&&!0===js.instancing||ki.isSkinnedMesh&&!1===js.skinning||!ki.isSkinnedMesh&&!0===js.skinning||js.envMap!==xs||Ot.fog&&js.fog!==es||void 0!==js.numClippingPlanes&&(js.numClippingPlanes!==rt.numPlanes||js.numIntersection!==rt.numIntersection)||js.vertexAlphas!==yo||js.vertexTangents!==Ks||js.morphTargets!==to||js.morphNormals!==Ra||js.toneMapping!==J_||!0===Nr.isWebGL2&&js.morphTargetsCount!==Om)&&(wl=!0):(wl=!0,js.__version=Ot.version);let Gd=js.currentProgram;!0===wl&&(Gd=pn(Ot,Bt,ki));let Fm=!1,Dh=!1,Wd=!1;const uc=Gd.getUniforms(),_b=js.uniforms;if(Fn.useProgram(Gd.program)&&(Fm=!0,Dh=!0,Wd=!0),Ot.id!==xe&&(xe=Ot.id,Dh=!0),Fm||ze!==Ze){if(uc.setValue(At,"projectionMatrix",Ze.projectionMatrix),Nr.logarithmicDepthBuffer&&uc.setValue(At,"logDepthBufFC",2/(Math.log(Ze.far+1)/Math.LN2)),ze!==Ze&&(ze=Ze,Dh=!0,Wd=!0),Ot.isShaderMaterial||Ot.isMeshPhongMaterial||Ot.isMeshToonMaterial||Ot.isMeshStandardMaterial||Ot.envMap){const qc=uc.map.cameraPosition;void 0!==qc&&qc.setValue(At,yn.setFromMatrixPosition(Ze.matrixWorld))}(Ot.isMeshPhongMaterial||Ot.isMeshToonMaterial||Ot.isMeshLambertMaterial||Ot.isMeshBasicMaterial||Ot.isMeshStandardMaterial||Ot.isShaderMaterial)&&uc.setValue(At,"isOrthographic",!0===Ze.isOrthographicCamera),(Ot.isMeshPhongMaterial||Ot.isMeshToonMaterial||Ot.isMeshLambertMaterial||Ot.isMeshBasicMaterial||Ot.isMeshStandardMaterial||Ot.isShaderMaterial||Ot.isShadowMaterial||ki.isSkinnedMesh)&&uc.setValue(At,"viewMatrix",Ze.matrixWorldInverse)}if(ki.isSkinnedMesh){uc.setOptional(At,ki,"bindMatrix"),uc.setOptional(At,ki,"bindMatrixInverse");const qc=ki.skeleton;qc&&(Nr.floatVertexTextures?(null===qc.boneTexture&&qc.computeBoneTexture(),uc.setValue(At,"boneTexture",qc.boneTexture,Ai),uc.setValue(At,"boneTextureSize",qc.boneTextureSize)):uc.setOptional(At,qc,"boneMatrices"))}return!!si&&(void 0!==si.morphAttributes.position||void 0!==si.morphAttributes.normal)&&rn.update(ki,si,Ot,Gd),(Dh||js.receiveShadow!==ki.receiveShadow)&&(js.receiveShadow=ki.receiveShadow,uc.setValue(At,"receiveShadow",ki.receiveShadow)),Dh&&(uc.setValue(At,"toneMappingExposure",le.toneMappingExposure),js.needsLights&&function FF(Ze,Bt){Ze.ambientLightColor.needsUpdate=Bt,Ze.lightProbe.needsUpdate=Bt,Ze.directionalLights.needsUpdate=Bt,Ze.directionalLightShadows.needsUpdate=Bt,Ze.pointLights.needsUpdate=Bt,Ze.pointLightShadows.needsUpdate=Bt,Ze.spotLights.needsUpdate=Bt,Ze.spotLightShadows.needsUpdate=Bt,Ze.rectAreaLights.needsUpdate=Bt,Ze.hemisphereLights.needsUpdate=Bt}(_b,Wd),es&&Ot.fog&&Ys.refreshFogUniforms(_b,es),Ys.refreshMaterialUniforms(_b,Ot,Pe,Yt,hi),pp.upload(At,js.uniformsList,_b,Ai)),Ot.isShaderMaterial&&!0===Ot.uniformsNeedUpdate&&(pp.upload(At,js.uniformsList,_b,Ai),Ot.uniformsNeedUpdate=!1),Ot.isSpriteMaterial&&uc.setValue(At,"center",ki.center),uc.setValue(At,"modelViewMatrix",ki.modelViewMatrix),uc.setValue(At,"normalMatrix",ki.normalMatrix),uc.setValue(At,"modelMatrix",ki.matrixWorld),Gd}(Ze,Bt,si,Ot,ki);Fn.setMaterial(Ot,hs);let xs=si.index;const yo=si.attributes.position;if(null===xs){if(void 0===yo||0===yo.count)return}else if(0===xs.count)return;let Ks=1;!0===Ot.wireframe&&(xs=Tn.getWireframeAttribute(si),Ks=2),or.setup(ki,Ot,Ms,si,xs);let to,Ra=ir;null!==xs&&(to=Bn.get(xs),Ra=vi,Ra.setIndex(to));const Om=null!==xs?xs.count:yo.count,J_=si.drawRange.start*Ks,js=si.drawRange.count*Ks,Ud=null!==es?es.start*Ks:0,wl=null!==es?es.count*Ks:1/0,Gd=Math.max(J_,Ud),Fm=Math.min(Om,J_+js,Ud+wl)-1,Dh=Math.max(0,Fm-Gd+1);if(0!==Dh){if(ki.isMesh)!0===Ot.wireframe?(Fn.setLineWidth(Ot.wireframeLinewidth*ur()),Ra.setMode(At.LINES)):Ra.setMode(At.TRIANGLES);else if(ki.isLine){let Wd=Ot.linewidth;void 0===Wd&&(Wd=1),Fn.setLineWidth(Wd*ur()),Ra.setMode(ki.isLineSegments?At.LINES:ki.isLineLoop?At.LINE_LOOP:At.LINE_STRIP)}else ki.isPoints?Ra.setMode(At.POINTS):ki.isSprite&&Ra.setMode(At.TRIANGLES);if(ki.isInstancedMesh)Ra.renderInstances(Gd,Dh,ki.count);else if(si.isInstancedBufferGeometry){const Wd=Math.min(si.instanceCount,si._maxInstanceCount);Ra.renderInstances(Gd,Dh,Wd)}else Ra.render(Gd,Dh)}},this.compile=function(Ze,Bt){q=Ro.get(Ze),q.init(),ne.push(q),Ze.traverseVisible(function(si){si.isLight&&si.layers.test(Bt.layers)&&(q.pushLight(si),si.castShadow&&q.pushShadow(si))}),q.setupLights(le.physicallyCorrectLights),Ze.traverse(function(si){const Ot=si.material;if(Ot)if(Array.isArray(Ot))for(let ki=0;ki<Ot.length;ki++)pn(Ot[ki],Ze,si);else pn(Ot,Ze,si)}),ne.pop(),q=null};let bi=null;function Ws(){rh.stop()}function ko(){rh.start()}const rh=new ZE;function Fs(Ze,Bt,si,Ot){if(!1===Ze.visible)return;if(Ze.layers.test(Bt.layers))if(Ze.isGroup)si=Ze.renderOrder;else if(Ze.isLOD)!0===Ze.autoUpdate&&Ze.update(Bt);else if(Ze.isLight)q.pushLight(Ze),Ze.castShadow&&q.pushShadow(Ze);else if(Ze.isSprite){if(!Ze.frustumCulled||ue.intersectsSprite(Ze)){Ot&&yn.setFromMatrixPosition(Ze.matrixWorld).applyMatrix4(Bi);const hs=jr.update(Ze),Ms=Ze.material;Ms.visible&&U.push(Ze,hs,Ms,si,yn.z,null)}}else if((Ze.isMesh||Ze.isLine||Ze.isPoints)&&(Ze.isSkinnedMesh&&Ze.skeleton.frame!==ws.render.frame&&(Ze.skeleton.update(),Ze.skeleton.frame=ws.render.frame),!Ze.frustumCulled||ue.intersectsObject(Ze))){Ot&&yn.setFromMatrixPosition(Ze.matrixWorld).applyMatrix4(Bi);const hs=jr.update(Ze),Ms=Ze.material;if(Array.isArray(Ms)){const xs=hs.groups;for(let yo=0,Ks=xs.length;yo<Ks;yo++){const to=xs[yo],Ra=Ms[to.materialIndex];Ra&&Ra.visible&&U.push(Ze,hs,Ra,si,yn.z,to)}}else Ms.visible&&U.push(Ze,hs,Ms,si,yn.z,null)}const es=Ze.children;for(let hs=0,Ms=es.length;hs<Ms;hs++)Fs(es[hs],Bt,si,Ot)}function If(Ze,Bt,si,Ot){const ki=Ze.opaque,es=Ze.transmissive,hs=Ze.transparent;q.setupLightsView(si),es.length>0&&function zd(Ze,Bt,si){null===hi&&(hi=new(!0===w&&!0===Nr.isWebGL2?ho:bs)(1024,1024,{generateMipmaps:!0,type:null!==Sr.convert(Sa)?Sa:Xn,minFilter:Gi,magFilter:ro,wrapS:Lo,wrapT:Lo,useRenderToTexture:sr.has("WEBGL_multisampled_render_to_texture")}));const Ot=le.getRenderTarget();le.setRenderTarget(hi),le.clear();const ki=le.toneMapping;le.toneMapping=0,gb(Ze,Bt,si),le.toneMapping=ki,Ai.updateMultisampleRenderTarget(hi),Ai.updateRenderTargetMipmap(hi),le.setRenderTarget(Ot)}(ki,Bt,si),Ot&&Fn.viewport($e.copy(Ot)),ki.length>0&&gb(ki,Bt,si),es.length>0&&gb(es,Bt,si),hs.length>0&&gb(hs,Bt,si)}function gb(Ze,Bt,si){const Ot=!0===Bt.isScene?Bt.overrideMaterial:null;for(let ki=0,es=Ze.length;ki<es;ki++){const hs=Ze[ki],Ms=hs.object,xs=hs.geometry,yo=null===Ot?hs.material:Ot,Ks=hs.group;Ms.layers.test(si.layers)&&uU(Ms,Bt,si,xs,yo,Ks)}}function uU(Ze,Bt,si,Ot,ki,es){Ze.onBeforeRender(le,Bt,si,Ot,ki,es),Ze.modelViewMatrix.multiplyMatrices(si.matrixWorldInverse,Ze.matrixWorld),Ze.normalMatrix.getNormalMatrix(Ze.modelViewMatrix),ki.onBeforeRender(le,Bt,si,Ot,Ze,es),!0===ki.transparent&&2===ki.side?(ki.side=1,ki.needsUpdate=!0,le.renderBufferDirect(si,Bt,Ot,ki,Ze,es),ki.side=0,ki.needsUpdate=!0,le.renderBufferDirect(si,Bt,Ot,ki,Ze,es),ki.side=2):le.renderBufferDirect(si,Bt,Ot,ki,Ze,es),Ze.onAfterRender(le,Bt,si,Ot,ki,es)}function pn(Ze,Bt,si){!0!==Bt.isScene&&(Bt=Yn);const Ot=Xr.get(Ze),ki=q.state.lights,hs=ki.state.version,Ms=Zr.getParameters(Ze,ki.state,q.state.shadowsArray,Bt,si),xs=Zr.getProgramCacheKey(Ms);let yo=Ot.programs;Ot.environment=Ze.isMeshStandardMaterial?Bt.environment:null,Ot.fog=Bt.fog,Ot.envMap=(Ze.isMeshStandardMaterial?en:an).get(Ze.envMap||Ot.environment),void 0===yo&&(Ze.addEventListener("dispose",Kn),yo=new Map,Ot.programs=yo);let Ks=yo.get(xs);if(void 0!==Ks){if(Ot.currentProgram===Ks&&Ot.lightsStateVersion===hs)return aR(Ze,Ms),Ks}else Ms.uniforms=Zr.getUniforms(Ze),Ze.onBuild(si,Ms,le),Ze.onBeforeCompile(Ms,le),Ks=Zr.acquireProgram(Ms,xs),yo.set(xs,Ks),Ot.uniforms=Ms.uniforms;const to=Ot.uniforms;(!Ze.isShaderMaterial&&!Ze.isRawShaderMaterial||!0===Ze.clipping)&&(to.clippingPlanes=rt.uniform),aR(Ze,Ms),Ot.needsLights=function ww(Ze){return Ze.isMeshLambertMaterial||Ze.isMeshToonMaterial||Ze.isMeshPhongMaterial||Ze.isMeshStandardMaterial||Ze.isShadowMaterial||Ze.isShaderMaterial&&!0===Ze.lights}(Ze),Ot.lightsStateVersion=hs,Ot.needsLights&&(to.ambientLightColor.value=ki.state.ambient,to.lightProbe.value=ki.state.probe,to.directionalLights.value=ki.state.directional,to.directionalLightShadows.value=ki.state.directionalShadow,to.spotLights.value=ki.state.spot,to.spotLightShadows.value=ki.state.spotShadow,to.rectAreaLights.value=ki.state.rectArea,to.ltc_1.value=ki.state.rectAreaLTC1,to.ltc_2.value=ki.state.rectAreaLTC2,to.pointLights.value=ki.state.point,to.pointLightShadows.value=ki.state.pointShadow,to.hemisphereLights.value=ki.state.hemi,to.directionalShadowMap.value=ki.state.directionalShadowMap,to.directionalShadowMatrix.value=ki.state.directionalShadowMatrix,to.spotShadowMap.value=ki.state.spotShadowMap,to.spotShadowMatrix.value=ki.state.spotShadowMatrix,to.pointShadowMap.value=ki.state.pointShadowMap,to.pointShadowMatrix.value=ki.state.pointShadowMatrix);const Ra=Ks.getUniforms(),Om=pp.seqWithValue(Ra.seq,to);return Ot.currentProgram=Ks,Ot.uniformsList=Om,Ks}function aR(Ze,Bt){const si=Xr.get(Ze);si.outputEncoding=Bt.outputEncoding,si.instancing=Bt.instancing,si.skinning=Bt.skinning,si.morphTargets=Bt.morphTargets,si.morphNormals=Bt.morphNormals,si.morphTargetsCount=Bt.morphTargetsCount,si.numClippingPlanes=Bt.numClippingPlanes,si.numIntersection=Bt.numClipIntersection,si.vertexAlphas=Bt.vertexAlphas,si.vertexTangents=Bt.vertexTangents,si.toneMapping=Bt.toneMapping}rh.setAnimationLoop(function Pr(Ze){bi&&bi(Ze)}),"undefined"!=typeof window&&rh.setContext(window),this.setAnimationLoop=function(Ze){bi=Ze,vn.setAnimationLoop(Ze),null===Ze?rh.stop():rh.start()},vn.addEventListener("sessionstart",Ws),vn.addEventListener("sessionend",ko),this.render=function(Ze,Bt){if(void 0===Bt||!0===Bt.isCamera){if(!0!==Se){if(!0===Ze.autoUpdate&&Ze.updateMatrixWorld(),null===Bt.parent&&Bt.updateMatrixWorld(),!0===vn.enabled&&!0===vn.isPresenting&&(!0===vn.cameraAutoUpdate&&vn.updateCamera(Bt),Bt=vn.getCamera()),!0===Ze.isScene&&Ze.onBeforeRender(le,Ze,Bt,Oe),q=Ro.get(Ze,ne.length),q.init(),ne.push(q),Bi.multiplyMatrices(Bt.projectionMatrix,Bt.matrixWorldInverse),ue.setFromProjectionMatrix(Bi),ui=this.localClippingEnabled,Xt=rt.init(this.clippingPlanes,ui,Bt),U=qo.get(Ze,Y.length),U.init(),Y.push(U),Fs(Ze,Bt,0,le.sortObjects),U.finish(),!0===le.sortObjects&&U.sort(bt,Ft),!0===Xt&&rt.beginShadows(),qe.render(q.state.shadowsArray,Ze,Bt),!0===Xt&&rt.endShadows(),!0===this.info.autoReset&&this.info.reset(),wi.render(U,Ze),q.setupLights(le.physicallyCorrectLights),Bt.isArrayCamera){const Ot=Bt.cameras;for(let ki=0,es=Ot.length;ki<es;ki++){const hs=Ot[ki];If(U,Ze,hs,hs.viewport)}}else If(U,Ze,Bt);null!==Oe&&(Ai.updateMultisampleRenderTarget(Oe),Ai.updateRenderTargetMipmap(Oe)),!0===Ze.isScene&&Ze.onAfterRender(le,Ze,Bt),Fn.buffers.depth.setTest(!0),Fn.buffers.depth.setMask(!0),Fn.buffers.color.setMask(!0),Fn.setPolygonOffset(!1),or.resetDefaultState(),xe=-1,ze=null,ne.pop(),q=ne.length>0?ne[ne.length-1]:null,Y.pop(),U=Y.length>0?Y[Y.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return re},this.getActiveMipmapLevel=function(){return K},this.getRenderTarget=function(){return Oe},this.setRenderTargetTextures=function(Ze,Bt,si){Xr.get(Ze.texture).__webglTexture=Bt,Xr.get(Ze.depthTexture).__webglTexture=si;const Ot=Xr.get(Ze);Ot.__hasExternalTextures=!0,Ot.__hasExternalTextures&&(Ot.__autoAllocateDepthBuffer=void 0===si,Ot.__autoAllocateDepthBuffer||Ze.useRenderToTexture&&(console.warn("render-to-texture extension was disabled because an external texture was provided"),Ze.useRenderToTexture=!1,Ze.useRenderbuffer=!0))},this.setRenderTargetFramebuffer=function(Ze,Bt){const si=Xr.get(Ze);si.__webglFramebuffer=Bt,si.__useDefaultFramebuffer=void 0===Bt},this.setRenderTarget=function(Ze,Bt=0,si=0){Oe=Ze,re=Bt,K=si;let Ot=!0;if(Ze){const xs=Xr.get(Ze);void 0!==xs.__useDefaultFramebuffer?(Fn.bindFramebuffer(At.FRAMEBUFFER,null),Ot=!1):void 0===xs.__webglFramebuffer?Ai.setupRenderTarget(Ze):xs.__hasExternalTextures&&Ai.rebindTextures(Ze,Xr.get(Ze.texture).__webglTexture,Xr.get(Ze.depthTexture).__webglTexture)}let ki=null,es=!1,hs=!1;if(Ze){const xs=Ze.texture;(xs.isDataTexture3D||xs.isDataTexture2DArray)&&(hs=!0);const yo=Xr.get(Ze).__webglFramebuffer;Ze.isWebGLCubeRenderTarget?(ki=yo[Bt],es=!0):ki=Ze.useRenderbuffer?Xr.get(Ze).__webglMultisampledFramebuffer:yo,$e.copy(Ze.viewport),ht.copy(Ze.scissor),Et=Ze.scissorTest}else $e.copy(zt).multiplyScalar(Pe).floor(),ht.copy(Qt).multiplyScalar(Pe).floor(),Et=Ut;if(Fn.bindFramebuffer(At.FRAMEBUFFER,ki)&&Nr.drawBuffers&&Ot&&Fn.drawBuffers(Ze,ki),Fn.viewport($e),Fn.scissor(ht),Fn.setScissorTest(Et),es){const xs=Xr.get(Ze.texture);At.framebufferTexture2D(At.FRAMEBUFFER,At.COLOR_ATTACHMENT0,At.TEXTURE_CUBE_MAP_POSITIVE_X+Bt,xs.__webglTexture,si)}else if(hs){const xs=Xr.get(Ze.texture);At.framebufferTextureLayer(At.FRAMEBUFFER,At.COLOR_ATTACHMENT0,xs.__webglTexture,si||0,Bt||0)}xe=-1},this.readRenderTargetPixels=function(Ze,Bt,si,Ot,ki,es,hs){if(!Ze||!Ze.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Ms=Xr.get(Ze).__webglFramebuffer;if(Ze.isWebGLCubeRenderTarget&&void 0!==hs&&(Ms=Ms[hs]),Ms){Fn.bindFramebuffer(At.FRAMEBUFFER,Ms);try{const xs=Ze.texture,yo=xs.format,Ks=xs.type;if(yo!==Ua&&Sr.convert(yo)!==At.getParameter(At.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const to=Ks===Sa&&(sr.has("EXT_color_buffer_half_float")||Nr.isWebGL2&&sr.has("EXT_color_buffer_float"));if(!(Ks===Xn||Sr.convert(Ks)===At.getParameter(At.IMPLEMENTATION_COLOR_READ_TYPE)||Ks===eo&&(Nr.isWebGL2||sr.has("OES_texture_float")||sr.has("WEBGL_color_buffer_float"))||to))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");At.checkFramebufferStatus(At.FRAMEBUFFER)===At.FRAMEBUFFER_COMPLETE?Bt>=0&&Bt<=Ze.width-Ot&&si>=0&&si<=Ze.height-ki&&At.readPixels(Bt,si,Ot,ki,Sr.convert(yo),Sr.convert(Ks),es):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{const xs=null!==Oe?Xr.get(Oe).__webglFramebuffer:null;Fn.bindFramebuffer(At.FRAMEBUFFER,xs)}}},this.copyFramebufferToTexture=function(Ze,Bt,si=0){if(!0!==Bt.isFramebufferTexture)return void console.error("THREE.WebGLRenderer: copyFramebufferToTexture() can only be used with FramebufferTexture.");const Ot=Math.pow(2,-si),ki=Math.floor(Bt.image.width*Ot),es=Math.floor(Bt.image.height*Ot);Ai.setTexture2D(Bt,0),At.copyTexSubImage2D(At.TEXTURE_2D,si,0,0,Ze.x,Ze.y,ki,es),Fn.unbindTexture()},this.copyTextureToTexture=function(Ze,Bt,si,Ot=0){const ki=Bt.image.width,es=Bt.image.height,hs=Sr.convert(si.format),Ms=Sr.convert(si.type);Ai.setTexture2D(si,0),At.pixelStorei(At.UNPACK_FLIP_Y_WEBGL,si.flipY),At.pixelStorei(At.UNPACK_PREMULTIPLY_ALPHA_WEBGL,si.premultiplyAlpha),At.pixelStorei(At.UNPACK_ALIGNMENT,si.unpackAlignment),Bt.isDataTexture?At.texSubImage2D(At.TEXTURE_2D,Ot,Ze.x,Ze.y,ki,es,hs,Ms,Bt.image.data):Bt.isCompressedTexture?At.compressedTexSubImage2D(At.TEXTURE_2D,Ot,Ze.x,Ze.y,Bt.mipmaps[0].width,Bt.mipmaps[0].height,hs,Bt.mipmaps[0].data):At.texSubImage2D(At.TEXTURE_2D,Ot,Ze.x,Ze.y,hs,Ms,Bt.image),0===Ot&&si.generateMipmaps&&At.generateMipmap(At.TEXTURE_2D),Fn.unbindTexture()},this.copyTextureToTexture3D=function(Ze,Bt,si,Ot,ki=0){if(le.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const es=Ze.max.x-Ze.min.x+1,hs=Ze.max.y-Ze.min.y+1,Ms=Ze.max.z-Ze.min.z+1,xs=Sr.convert(Ot.format),yo=Sr.convert(Ot.type);let Ks;if(Ot.isDataTexture3D)Ai.setTexture3D(Ot,0),Ks=At.TEXTURE_3D;else{if(!Ot.isDataTexture2DArray)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");Ai.setTexture2DArray(Ot,0),Ks=At.TEXTURE_2D_ARRAY}At.pixelStorei(At.UNPACK_FLIP_Y_WEBGL,Ot.flipY),At.pixelStorei(At.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Ot.premultiplyAlpha),At.pixelStorei(At.UNPACK_ALIGNMENT,Ot.unpackAlignment);const to=At.getParameter(At.UNPACK_ROW_LENGTH),Ra=At.getParameter(At.UNPACK_IMAGE_HEIGHT),Om=At.getParameter(At.UNPACK_SKIP_PIXELS),J_=At.getParameter(At.UNPACK_SKIP_ROWS),js=At.getParameter(At.UNPACK_SKIP_IMAGES),Ud=si.isCompressedTexture?si.mipmaps[0]:si.image;At.pixelStorei(At.UNPACK_ROW_LENGTH,Ud.width),At.pixelStorei(At.UNPACK_IMAGE_HEIGHT,Ud.height),At.pixelStorei(At.UNPACK_SKIP_PIXELS,Ze.min.x),At.pixelStorei(At.UNPACK_SKIP_ROWS,Ze.min.y),At.pixelStorei(At.UNPACK_SKIP_IMAGES,Ze.min.z),si.isDataTexture||si.isDataTexture3D?At.texSubImage3D(Ks,ki,Bt.x,Bt.y,Bt.z,es,hs,Ms,xs,yo,Ud.data):si.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),At.compressedTexSubImage3D(Ks,ki,Bt.x,Bt.y,Bt.z,es,hs,Ms,xs,Ud.data)):At.texSubImage3D(Ks,ki,Bt.x,Bt.y,Bt.z,es,hs,Ms,xs,yo,Ud),At.pixelStorei(At.UNPACK_ROW_LENGTH,to),At.pixelStorei(At.UNPACK_IMAGE_HEIGHT,Ra),At.pixelStorei(At.UNPACK_SKIP_PIXELS,Om),At.pixelStorei(At.UNPACK_SKIP_ROWS,J_),At.pixelStorei(At.UNPACK_SKIP_IMAGES,js),0===ki&&Ot.generateMipmaps&&At.generateMipmap(Ks),Fn.unbindTexture()},this.initTexture=function(Ze){Ai.setTexture2D(Ze,0),Fn.unbindTexture()},this.resetState=function(){re=0,K=0,Oe=null,Fn.reset(),or.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}po.prototype.isWebGLRenderer=!0;class b_ extends po{}b_.prototype.isWebGL1Renderer=!0;class zv{constructor(o,c=25e-5){this.name="",this.color=new cn(o),this.density=c}clone(){return new zv(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}zv.prototype.isFogExp2=!0;class x_{constructor(o,c=1,d=1e3){this.name="",this.color=new cn(o),this.near=c,this.far=d}clone(){return new x_(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}x_.prototype.isFog=!0;class kx extends _t{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(o,c){return super.copy(o,c),null!==o.background&&(this.background=o.background.clone()),null!==o.environment&&(this.environment=o.environment.clone()),null!==o.fog&&(this.fog=o.fog.clone()),null!==o.overrideMaterial&&(this.overrideMaterial=o.overrideMaterial.clone()),this.autoUpdate=o.autoUpdate,this.matrixAutoUpdate=o.matrixAutoUpdate,this}toJSON(o){const c=super.toJSON(o);return null!==this.fog&&(c.object.fog=this.fog.toJSON()),c}}kx.prototype.isScene=!0;class vm{constructor(o,c){this.array=o,this.stride=c,this.count=void 0!==o?o.length/c:0,this.usage=ds,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=tl()}onUploadCallback(){}set needsUpdate(o){!0===o&&this.version++}setUsage(o){return this.usage=o,this}copy(o){return this.array=new o.array.constructor(o.array),this.count=o.count,this.stride=o.stride,this.usage=o.usage,this}copyAt(o,c,d){o*=this.stride,d*=c.stride;for(let p=0,y=this.stride;p<y;p++)this.array[o+p]=c.array[d+p];return this}set(o,c=0){return this.array.set(o,c),this}clone(o){void 0===o.arrayBuffers&&(o.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=tl()),void 0===o.arrayBuffers[this.array.buffer._uuid]&&(o.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const c=new this.array.constructor(o.arrayBuffers[this.array.buffer._uuid]),d=new this.constructor(c,this.stride);return d.setUsage(this.usage),d}onUpload(o){return this.onUploadCallback=o,this}toJSON(o){return void 0===o.arrayBuffers&&(o.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=tl()),void 0===o.arrayBuffers[this.array.buffer._uuid]&&(o.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}vm.prototype.isInterleavedBuffer=!0;const Ea=new Ne;class Ed{constructor(o,c,d,p=!1){this.name="",this.data=o,this.itemSize=c,this.offset=d,this.normalized=!0===p}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(o){this.data.needsUpdate=o}applyMatrix4(o){for(let c=0,d=this.data.count;c<d;c++)Ea.x=this.getX(c),Ea.y=this.getY(c),Ea.z=this.getZ(c),Ea.applyMatrix4(o),this.setXYZ(c,Ea.x,Ea.y,Ea.z);return this}applyNormalMatrix(o){for(let c=0,d=this.count;c<d;c++)Ea.x=this.getX(c),Ea.y=this.getY(c),Ea.z=this.getZ(c),Ea.applyNormalMatrix(o),this.setXYZ(c,Ea.x,Ea.y,Ea.z);return this}transformDirection(o){for(let c=0,d=this.count;c<d;c++)Ea.x=this.getX(c),Ea.y=this.getY(c),Ea.z=this.getZ(c),Ea.transformDirection(o),this.setXYZ(c,Ea.x,Ea.y,Ea.z);return this}setX(o,c){return this.data.array[o*this.data.stride+this.offset]=c,this}setY(o,c){return this.data.array[o*this.data.stride+this.offset+1]=c,this}setZ(o,c){return this.data.array[o*this.data.stride+this.offset+2]=c,this}setW(o,c){return this.data.array[o*this.data.stride+this.offset+3]=c,this}getX(o){return this.data.array[o*this.data.stride+this.offset]}getY(o){return this.data.array[o*this.data.stride+this.offset+1]}getZ(o){return this.data.array[o*this.data.stride+this.offset+2]}getW(o){return this.data.array[o*this.data.stride+this.offset+3]}setXY(o,c,d){return this.data.array[(o=o*this.data.stride+this.offset)+0]=c,this.data.array[o+1]=d,this}setXYZ(o,c,d,p){return this.data.array[(o=o*this.data.stride+this.offset)+0]=c,this.data.array[o+1]=d,this.data.array[o+2]=p,this}setXYZW(o,c,d,p,y){return this.data.array[(o=o*this.data.stride+this.offset)+0]=c,this.data.array[o+1]=d,this.data.array[o+2]=p,this.data.array[o+3]=y,this}clone(o){if(void 0===o){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const c=[];for(let d=0;d<this.count;d++){const p=d*this.data.stride+this.offset;for(let y=0;y<this.itemSize;y++)c.push(this.data.array[p+y])}return new Zn(new this.array.constructor(c),this.itemSize,this.normalized)}return void 0===o.interleavedBuffers&&(o.interleavedBuffers={}),void 0===o.interleavedBuffers[this.data.uuid]&&(o.interleavedBuffers[this.data.uuid]=this.data.clone(o)),new Ed(o.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(o){if(void 0===o){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const c=[];for(let d=0;d<this.count;d++){const p=d*this.data.stride+this.offset;for(let y=0;y<this.itemSize;y++)c.push(this.data.array[p+y])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:c,normalized:this.normalized}}return void 0===o.interleavedBuffers&&(o.interleavedBuffers={}),void 0===o.interleavedBuffers[this.data.uuid]&&(o.interleavedBuffers[this.data.uuid]=this.data.toJSON(o)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}Ed.prototype.isInterleavedBufferAttribute=!0;class Uv extends da{constructor(o){super(),this.type="SpriteMaterial",this.color=new cn(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(o)}copy(o){return super.copy(o),this.color.copy(o.color),this.map=o.map,this.alphaMap=o.alphaMap,this.rotation=o.rotation,this.sizeAttenuation=o.sizeAttenuation,this}}let Gv;Uv.prototype.isSpriteMaterial=!0;const w_=new Ne,S_=new Ne,bm=new Ne,C_=new Be,Wv=new Be,Qu=new Mn,Px=new Ne,M_=new Ne,Ix=new Ne,$A=new Be,uM=new Be,eD=new Be;class jv extends _t{constructor(o){if(super(),this.type="Sprite",void 0===Gv){Gv=new gt;const c=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),d=new vm(c,5);Gv.setIndex([0,1,2,0,2,3]),Gv.setAttribute("position",new Ed(d,3,0,!1)),Gv.setAttribute("uv",new Ed(d,2,3,!1))}this.geometry=Gv,this.material=void 0!==o?o:new Uv,this.center=new Be(.5,.5)}raycast(o,c){null===o.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),S_.setFromMatrixScale(this.matrixWorld),Qu.copy(o.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(o.camera.matrixWorldInverse,this.matrixWorld),bm.setFromMatrixPosition(this.modelViewMatrix),o.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&S_.multiplyScalar(-bm.z);const d=this.material.rotation;let p,y;0!==d&&(y=Math.cos(d),p=Math.sin(d));const w=this.center;Lx(Px.set(-.5,-.5,0),bm,w,S_,p,y),Lx(M_.set(.5,-.5,0),bm,w,S_,p,y),Lx(Ix.set(.5,.5,0),bm,w,S_,p,y),$A.set(0,0),uM.set(1,0),eD.set(1,1);let M=o.ray.intersectTriangle(Px,M_,Ix,!1,w_);if(null===M&&(Lx(M_.set(-.5,.5,0),bm,w,S_,p,y),uM.set(0,1),M=o.ray.intersectTriangle(Px,Ix,M_,!1,w_),null===M))return;const R=o.ray.origin.distanceTo(w_);R<o.near||R>o.far||c.push({distance:R,point:w_.clone(),uv:ha.getUV(w_,Px,M_,Ix,$A,uM,eD,new Be),face:null,object:this})}copy(o){return super.copy(o),void 0!==o.center&&this.center.copy(o.center),this.material=o.material,this}}function Lx(g,o,c,d,p,y){C_.subVectors(g,c).addScalar(.5).multiply(d),void 0!==p?(Wv.x=y*C_.x-p*C_.y,Wv.y=p*C_.x+y*C_.y):Wv.copy(C_),g.copy(o),g.x+=Wv.x,g.y+=Wv.y,g.applyMatrix4(Qu)}jv.prototype.isSprite=!0;const Ox=new Ne,tD=new Ne;class $r extends _t{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(o){super.copy(o,!1);const c=o.levels;for(let d=0,p=c.length;d<p;d++){const y=c[d];this.addLevel(y.object.clone(),y.distance)}return this.autoUpdate=o.autoUpdate,this}addLevel(o,c=0){c=Math.abs(c);const d=this.levels;let p;for(p=0;p<d.length&&!(c<d[p].distance);p++);return d.splice(p,0,{distance:c,object:o}),this.add(o),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(o){const c=this.levels;if(c.length>0){let d,p;for(d=1,p=c.length;d<p&&!(o<c[d].distance);d++);return c[d-1].object}return null}raycast(o,c){if(this.levels.length>0){Ox.setFromMatrixPosition(this.matrixWorld);const p=o.ray.origin.distanceTo(Ox);this.getObjectForDistance(p).raycast(o,c)}}update(o){const c=this.levels;if(c.length>1){Ox.setFromMatrixPosition(o.matrixWorld),tD.setFromMatrixPosition(this.matrixWorld);const d=Ox.distanceTo(tD)/o.zoom;let p,y;for(c[0].object.visible=!0,p=1,y=c.length;p<y&&d>=c[p].distance;p++)c[p-1].object.visible=!1,c[p].object.visible=!0;for(this._currentLevel=p-1;p<y;p++)c[p].object.visible=!1}}toJSON(o){const c=super.toJSON(o);!1===this.autoUpdate&&(c.object.autoUpdate=!1),c.object.levels=[];const d=this.levels;for(let p=0,y=d.length;p<y;p++){const w=d[p];c.object.levels.push({object:w.object.uuid,distance:w.distance})}return c}}const se=new Ne,hM=new Es,dM=new Es,Fx=new Ne,Ju=new Mn;class qv extends sl{constructor(o,c){super(o,c),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Mn,this.bindMatrixInverse=new Mn}copy(o){return super.copy(o),this.bindMode=o.bindMode,this.bindMatrix.copy(o.bindMatrix),this.bindMatrixInverse.copy(o.bindMatrixInverse),this.skeleton=o.skeleton,this}bind(o,c){this.skeleton=o,void 0===c&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),c=this.matrixWorld),this.bindMatrix.copy(c),this.bindMatrixInverse.copy(c).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const o=new Es,c=this.geometry.attributes.skinWeight;for(let d=0,p=c.count;d<p;d++){o.x=c.getX(d),o.y=c.getY(d),o.z=c.getZ(d),o.w=c.getW(d);const y=1/o.manhattanLength();y!==1/0?o.multiplyScalar(y):o.set(1,0,0,0),c.setXYZW(d,o.x,o.y,o.z,o.w)}}updateMatrixWorld(o){super.updateMatrixWorld(o),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(o,c){const d=this.skeleton,p=this.geometry;hM.fromBufferAttribute(p.attributes.skinIndex,o),dM.fromBufferAttribute(p.attributes.skinWeight,o),se.copy(c).applyMatrix4(this.bindMatrix),c.set(0,0,0);for(let y=0;y<4;y++){const w=dM.getComponent(y);if(0!==w){const M=hM.getComponent(y);Ju.multiplyMatrices(d.bones[M].matrixWorld,d.boneInverses[M]),c.addScaledVector(Fx.copy(se).applyMatrix4(Ju),w)}}return c.applyMatrix4(this.bindMatrixInverse)}}qv.prototype.isSkinnedMesh=!0;class Bx extends _t{constructor(){super(),this.type="Bone"}}Bx.prototype.isBone=!0;class Tf extends Jr{constructor(o=null,c=1,d=1,p,y,w,M,R,A=ro,N=ro,U,q){super(null,w,M,R,A,N,p,y,U,q),this.image={data:o,width:c,height:d},this.magFilter=A,this.minFilter=N,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}Tf.prototype.isDataTexture=!0;const Ad=new Mn,fM=new Mn;class Xv{constructor(o=[],c=[]){this.uuid=tl(),this.bones=o.slice(0),this.boneInverses=c,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const o=this.bones,c=this.boneInverses;if(this.boneMatrices=new Float32Array(16*o.length),0===c.length)this.calculateInverses();else if(o.length!==c.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let d=0,p=this.bones.length;d<p;d++)this.boneInverses.push(new Mn)}}calculateInverses(){this.boneInverses.length=0;for(let o=0,c=this.bones.length;o<c;o++){const d=new Mn;this.bones[o]&&d.copy(this.bones[o].matrixWorld).invert(),this.boneInverses.push(d)}}pose(){for(let o=0,c=this.bones.length;o<c;o++){const d=this.bones[o];d&&d.matrixWorld.copy(this.boneInverses[o]).invert()}for(let o=0,c=this.bones.length;o<c;o++){const d=this.bones[o];d&&(d.parent&&d.parent.isBone?(d.matrix.copy(d.parent.matrixWorld).invert(),d.matrix.multiply(d.matrixWorld)):d.matrix.copy(d.matrixWorld),d.matrix.decompose(d.position,d.quaternion,d.scale))}}update(){const o=this.bones,c=this.boneInverses,d=this.boneMatrices,p=this.boneTexture;for(let y=0,w=o.length;y<w;y++)Ad.multiplyMatrices(o[y]?o[y].matrixWorld:fM,c[y]),Ad.toArray(d,16*y);null!==p&&(p.needsUpdate=!0)}clone(){return new Xv(this.bones,this.boneInverses)}computeBoneTexture(){let o=Math.sqrt(4*this.bones.length);o=dv(o),o=Math.max(o,4);const c=new Float32Array(o*o*4);c.set(this.boneMatrices);const d=new Tf(c,o,o,Ua,eo);return d.needsUpdate=!0,this.boneMatrices=c,this.boneTexture=d,this.boneTextureSize=o,this}getBoneByName(o){for(let c=0,d=this.bones.length;c<d;c++){const p=this.bones[c];if(p.name===o)return p}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(o,c){this.uuid=o.uuid;for(let d=0,p=o.bones.length;d<p;d++){const y=o.bones[d];let w=c[y];void 0===w&&(console.warn("THREE.Skeleton: No bone found with UUID:",y),w=new Bx),this.bones.push(w),this.boneInverses.push((new Mn).fromArray(o.boneInverses[d]))}return this.init(),this}toJSON(){const o={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};o.uuid=this.uuid;const c=this.bones,d=this.boneInverses;for(let p=0,y=c.length;p<y;p++)o.bones.push(c[p].uuid),o.boneInverses.push(d[p].toArray());return o}}class Ef extends Zn{constructor(o,c,d,p=1){"number"==typeof d&&(p=d,d=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(o,c,d),this.meshPerAttribute=p}copy(o){return super.copy(o),this.meshPerAttribute=o.meshPerAttribute,this}toJSON(){const o=super.toJSON();return o.meshPerAttribute=this.meshPerAttribute,o.isInstancedBufferAttribute=!0,o}}Ef.prototype.isInstancedBufferAttribute=!0;const jO=new Mn,pM=new Mn,mM=[],mp=new sl;class T_ extends sl{constructor(o,c,d){super(o,c),this.instanceMatrix=new Ef(new Float32Array(16*d),16),this.instanceColor=null,this.count=d,this.frustumCulled=!1}copy(o){return super.copy(o),this.instanceMatrix.copy(o.instanceMatrix),null!==o.instanceColor&&(this.instanceColor=o.instanceColor.clone()),this.count=o.count,this}getColorAt(o,c){c.fromArray(this.instanceColor.array,3*o)}getMatrixAt(o,c){c.fromArray(this.instanceMatrix.array,16*o)}raycast(o,c){const d=this.matrixWorld,p=this.count;if(mp.geometry=this.geometry,mp.material=this.material,void 0!==mp.material)for(let y=0;y<p;y++){this.getMatrixAt(y,jO),pM.multiplyMatrices(d,jO),mp.matrixWorld=pM,mp.raycast(o,mM);for(let w=0,M=mM.length;w<M;w++){const R=mM[w];R.instanceId=y,R.object=this,c.push(R)}mM.length=0}}setColorAt(o,c){null===this.instanceColor&&(this.instanceColor=new Ef(new Float32Array(3*this.instanceMatrix.count),3)),c.toArray(this.instanceColor.array,3*o)}setMatrixAt(o,c){c.toArray(this.instanceMatrix.array,16*o)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}T_.prototype.isInstancedMesh=!0;class ol extends da{constructor(o){super(),this.type="LineBasicMaterial",this.color=new cn(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(o)}copy(o){return super.copy(o),this.color.copy(o.color),this.linewidth=o.linewidth,this.linecap=o.linecap,this.linejoin=o.linejoin,this}}ol.prototype.isLineBasicMaterial=!0;const Nx=new Ne,Hx=new Ne,qO=new Mn,gM=new yf,Vx=new pd;class Af extends _t{constructor(o=new gt,c=new ol){super(),this.type="Line",this.geometry=o,this.material=c,this.updateMorphTargets()}copy(o){return super.copy(o),this.material=o.material,this.geometry=o.geometry,this}computeLineDistances(){const o=this.geometry;if(o.isBufferGeometry)if(null===o.index){const c=o.attributes.position,d=[0];for(let p=1,y=c.count;p<y;p++)Nx.fromBufferAttribute(c,p-1),Hx.fromBufferAttribute(c,p),d[p]=d[p-1],d[p]+=Nx.distanceTo(Hx);o.setAttribute("lineDistance",new Wn(d,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else o.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(o,c){const d=this.geometry,p=this.matrixWorld,y=o.params.Line.threshold,w=d.drawRange;if(null===d.boundingSphere&&d.computeBoundingSphere(),Vx.copy(d.boundingSphere),Vx.applyMatrix4(p),Vx.radius+=y,!1===o.ray.intersectsSphere(Vx))return;qO.copy(p).invert(),gM.copy(o.ray).applyMatrix4(qO);const M=y/((this.scale.x+this.scale.y+this.scale.z)/3),R=M*M,A=new Ne,N=new Ne,U=new Ne,q=new Ne,Y=this.isLineSegments?2:1;if(d.isBufferGeometry){const ne=d.index,Se=d.attributes.position;if(null!==ne)for(let Oe=Math.max(0,w.start),xe=Math.min(ne.count,w.start+w.count)-1;Oe<xe;Oe+=Y){const ze=ne.getX(Oe),$e=ne.getX(Oe+1);if(A.fromBufferAttribute(Se,ze),N.fromBufferAttribute(Se,$e),gM.distanceSqToSegment(A,N,q,U)>R)continue;q.applyMatrix4(this.matrixWorld);const Et=o.ray.origin.distanceTo(q);Et<o.near||Et>o.far||c.push({distance:Et,point:U.clone().applyMatrix4(this.matrixWorld),index:Oe,face:null,faceIndex:null,object:this})}else for(let Oe=Math.max(0,w.start),xe=Math.min(Se.count,w.start+w.count)-1;Oe<xe;Oe+=Y){if(A.fromBufferAttribute(Se,Oe),N.fromBufferAttribute(Se,Oe+1),gM.distanceSqToSegment(A,N,q,U)>R)continue;q.applyMatrix4(this.matrixWorld);const $e=o.ray.origin.distanceTo(q);$e<o.near||$e>o.far||c.push({distance:$e,point:U.clone().applyMatrix4(this.matrixWorld),index:Oe,face:null,faceIndex:null,object:this})}}else d.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const o=this.geometry;if(o.isBufferGeometry){const c=o.morphAttributes,d=Object.keys(c);if(d.length>0){const p=c[d[0]];if(void 0!==p){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let y=0,w=p.length;y<w;y++){const M=p[y].name||String(y);this.morphTargetInfluences.push(0),this.morphTargetDictionary[M]=y}}}}else{const c=o.morphTargets;void 0!==c&&c.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}Af.prototype.isLine=!0;const iD=new Ne,_M=new Ne;class wu extends Af{constructor(o,c){super(o,c),this.type="LineSegments"}computeLineDistances(){const o=this.geometry;if(o.isBufferGeometry)if(null===o.index){const c=o.attributes.position,d=[];for(let p=0,y=c.count;p<y;p+=2)iD.fromBufferAttribute(c,p),_M.fromBufferAttribute(c,p+1),d[p]=0===p?0:d[p-1],d[p+1]=d[p]+iD.distanceTo(_M);o.setAttribute("lineDistance",new Wn(d,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else o.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}wu.prototype.isLineSegments=!0;class yM extends Af{constructor(o,c){super(o,c),this.type="LineLoop"}}yM.prototype.isLineLoop=!0;class E_ extends da{constructor(o){super(),this.type="PointsMaterial",this.color=new cn(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.setValues(o)}copy(o){return super.copy(o),this.color.copy(o.color),this.map=o.map,this.alphaMap=o.alphaMap,this.size=o.size,this.sizeAttenuation=o.sizeAttenuation,this}}E_.prototype.isPointsMaterial=!0;const vM=new Mn,zx=new yf,Ux=new pd,A_=new Ne;class Gx extends _t{constructor(o=new gt,c=new E_){super(),this.type="Points",this.geometry=o,this.material=c,this.updateMorphTargets()}copy(o){return super.copy(o),this.material=o.material,this.geometry=o.geometry,this}raycast(o,c){const d=this.geometry,p=this.matrixWorld,y=o.params.Points.threshold,w=d.drawRange;if(null===d.boundingSphere&&d.computeBoundingSphere(),Ux.copy(d.boundingSphere),Ux.applyMatrix4(p),Ux.radius+=y,!1===o.ray.intersectsSphere(Ux))return;vM.copy(p).invert(),zx.copy(o.ray).applyMatrix4(vM);const M=y/((this.scale.x+this.scale.y+this.scale.z)/3),R=M*M;if(d.isBufferGeometry){const A=d.index,U=d.attributes.position;if(null!==A)for(let ne=Math.max(0,w.start),le=Math.min(A.count,w.start+w.count);ne<le;ne++){const Se=A.getX(ne);A_.fromBufferAttribute(U,Se),XO(A_,Se,R,p,o,c,this)}else for(let ne=Math.max(0,w.start),le=Math.min(U.count,w.start+w.count);ne<le;ne++)A_.fromBufferAttribute(U,ne),XO(A_,ne,R,p,o,c,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const o=this.geometry;if(o.isBufferGeometry){const c=o.morphAttributes,d=Object.keys(c);if(d.length>0){const p=c[d[0]];if(void 0!==p){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let y=0,w=p.length;y<w;y++){const M=p[y].name||String(y);this.morphTargetInfluences.push(0),this.morphTargetDictionary[M]=y}}}}else{const c=o.morphTargets;void 0!==c&&c.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}function XO(g,o,c,d,p,y,w){const M=zx.distanceSqToPoint(g);if(M<c){const R=new Ne;zx.closestPointToPoint(g,R),R.applyMatrix4(d);const A=p.ray.origin.distanceTo(R);if(A<p.near||A>p.far)return;y.push({distance:A,distanceToRay:Math.sqrt(M),point:R,index:o,face:null,object:w})}}Gx.prototype.isPoints=!0;class ZO extends Jr{constructor(o,c,d,p,y,w,M,R,A){super(o,c,d,p,y,w,M,R,A),this.minFilter=void 0!==w?w:tt,this.magFilter=void 0!==y?y:tt,this.generateMipmaps=!1;const N=this;"requestVideoFrameCallback"in o&&o.requestVideoFrameCallback(function U(){N.needsUpdate=!0,o.requestVideoFrameCallback(U)})}clone(){return new this.constructor(this.image).copy(this)}update(){const o=this.image;"requestVideoFrameCallback"in o==0&&o.readyState>=o.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}ZO.prototype.isVideoTexture=!0;class YO extends Jr{constructor(o,c,d){super({width:o,height:c}),this.format=d,this.magFilter=ro,this.minFilter=ro,this.generateMipmaps=!1,this.needsUpdate=!0}}YO.prototype.isFramebufferTexture=!0;class nD extends Jr{constructor(o,c,d,p,y,w,M,R,A,N,U,q){super(null,w,M,R,A,N,p,y,U,q),this.image={width:c,height:d},this.mipmaps=o,this.flipY=!1,this.generateMipmaps=!1}}nD.prototype.isCompressedTexture=!0;class KO extends Jr{constructor(o,c,d,p,y,w,M,R,A){super(o,c,d,p,y,w,M,R,A),this.needsUpdate=!0}}KO.prototype.isCanvasTexture=!0;class Zv extends gt{constructor(o=1,c=8,d=0,p=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:o,segments:c,thetaStart:d,thetaLength:p},c=Math.max(3,c);const y=[],w=[],M=[],R=[],A=new Ne,N=new Be;w.push(0,0,0),M.push(0,0,1),R.push(.5,.5);for(let U=0,q=3;U<=c;U++,q+=3){const Y=d+U/c*p;A.x=o*Math.cos(Y),A.y=o*Math.sin(Y),w.push(A.x,A.y,A.z),M.push(0,0,1),N.x=(w[q]/o+1)/2,N.y=(w[q+1]/o+1)/2,R.push(N.x,N.y)}for(let U=1;U<=c;U++)y.push(U,U+1,0);this.setIndex(y),this.setAttribute("position",new Wn(w,3)),this.setAttribute("normal",new Wn(M,3)),this.setAttribute("uv",new Wn(R,2))}static fromJSON(o){return new Zv(o.radius,o.segments,o.thetaStart,o.thetaLength)}}class xm extends gt{constructor(o=1,c=1,d=1,p=8,y=1,w=!1,M=0,R=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:o,radiusBottom:c,height:d,radialSegments:p,heightSegments:y,openEnded:w,thetaStart:M,thetaLength:R};const A=this;p=Math.floor(p),y=Math.floor(y);const N=[],U=[],q=[],Y=[];let ne=0;const le=[],Se=d/2;let re=0;function Oe(xe){const ze=ne,$e=new Be,ht=new Ne;let Et=0;const ci=!0===xe?o:c,Yt=!0===xe?1:-1;for(let bt=1;bt<=p;bt++)U.push(0,Se*Yt,0),q.push(0,Yt,0),Y.push(.5,.5),ne++;const Pe=ne;for(let bt=0;bt<=p;bt++){const zt=bt/p*R+M,Qt=Math.cos(zt),Ut=Math.sin(zt);ht.x=ci*Ut,ht.y=Se*Yt,ht.z=ci*Qt,U.push(ht.x,ht.y,ht.z),q.push(0,Yt,0),$e.x=.5*Qt+.5,$e.y=.5*Ut*Yt+.5,Y.push($e.x,$e.y),ne++}for(let bt=0;bt<p;bt++){const Ft=ze+bt,zt=Pe+bt;!0===xe?N.push(zt,zt+1,Ft):N.push(zt+1,zt,Ft),Et+=3}A.addGroup(re,Et,!0===xe?1:2),re+=Et}(function K(){const xe=new Ne,ze=new Ne;let $e=0;const ht=(c-o)/d;for(let Et=0;Et<=y;Et++){const ci=[],Yt=Et/y,Pe=Yt*(c-o)+o;for(let bt=0;bt<=p;bt++){const Ft=bt/p,zt=Ft*R+M,Qt=Math.sin(zt),Ut=Math.cos(zt);ze.x=Pe*Qt,ze.y=-Yt*d+Se,ze.z=Pe*Ut,U.push(ze.x,ze.y,ze.z),xe.set(Qt,ht,Ut).normalize(),q.push(xe.x,xe.y,xe.z),Y.push(Ft,1-Yt),ci.push(ne++)}le.push(ci)}for(let Et=0;Et<p;Et++)for(let ci=0;ci<y;ci++){const Pe=le[ci+1][Et],bt=le[ci+1][Et+1],Ft=le[ci][Et+1];N.push(le[ci][Et],Pe,Ft),N.push(Pe,bt,Ft),$e+=6}A.addGroup(re,$e,0),re+=$e})(),!1===w&&(o>0&&Oe(!0),c>0&&Oe(!1)),this.setIndex(N),this.setAttribute("position",new Wn(U,3)),this.setAttribute("normal",new Wn(q,3)),this.setAttribute("uv",new Wn(Y,2))}static fromJSON(o){return new xm(o.radiusTop,o.radiusBottom,o.height,o.radialSegments,o.heightSegments,o.openEnded,o.thetaStart,o.thetaLength)}}class Yv extends xm{constructor(o=1,c=1,d=8,p=1,y=!1,w=0,M=2*Math.PI){super(0,o,c,d,p,y,w,M),this.type="ConeGeometry",this.parameters={radius:o,height:c,radialSegments:d,heightSegments:p,openEnded:y,thetaStart:w,thetaLength:M}}static fromJSON(o){return new Yv(o.radius,o.height,o.radialSegments,o.heightSegments,o.openEnded,o.thetaStart,o.thetaLength)}}class Df extends gt{constructor(o=[],c=[],d=1,p=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:o,indices:c,radius:d,detail:p};const y=[],w=[];function R(K,Oe,xe,ze){const $e=ze+1,ht=[];for(let Et=0;Et<=$e;Et++){ht[Et]=[];const ci=K.clone().lerp(xe,Et/$e),Yt=Oe.clone().lerp(xe,Et/$e),Pe=$e-Et;for(let bt=0;bt<=Pe;bt++)ht[Et][bt]=0===bt&&Et===$e?ci:ci.clone().lerp(Yt,bt/Pe)}for(let Et=0;Et<$e;Et++)for(let ci=0;ci<2*($e-Et)-1;ci++){const Yt=Math.floor(ci/2);ci%2==0?(q(ht[Et][Yt+1]),q(ht[Et+1][Yt]),q(ht[Et][Yt])):(q(ht[Et][Yt+1]),q(ht[Et+1][Yt+1]),q(ht[Et+1][Yt]))}}function q(K){y.push(K.x,K.y,K.z)}function Y(K,Oe){const xe=3*K;Oe.x=o[xe+0],Oe.y=o[xe+1],Oe.z=o[xe+2]}function le(K,Oe,xe,ze){ze<0&&1===K.x&&(w[Oe]=K.x-1),0===xe.x&&0===xe.z&&(w[Oe]=ze/2/Math.PI+.5)}function Se(K){return Math.atan2(K.z,-K.x)}function re(K){return Math.atan2(-K.y,Math.sqrt(K.x*K.x+K.z*K.z))}(function M(K){const Oe=new Ne,xe=new Ne,ze=new Ne;for(let $e=0;$e<c.length;$e+=3)Y(c[$e+0],Oe),Y(c[$e+1],xe),Y(c[$e+2],ze),R(Oe,xe,ze,K)})(p),function A(K){const Oe=new Ne;for(let xe=0;xe<y.length;xe+=3)Oe.x=y[xe+0],Oe.y=y[xe+1],Oe.z=y[xe+2],Oe.normalize().multiplyScalar(K),y[xe+0]=Oe.x,y[xe+1]=Oe.y,y[xe+2]=Oe.z}(d),function N(){const K=new Ne;for(let Oe=0;Oe<y.length;Oe+=3){K.x=y[Oe+0],K.y=y[Oe+1],K.z=y[Oe+2];const xe=Se(K)/2/Math.PI+.5,ze=re(K)/Math.PI+.5;w.push(xe,1-ze)}(function ne(){const K=new Ne,Oe=new Ne,xe=new Ne,ze=new Ne,$e=new Be,ht=new Be,Et=new Be;for(let ci=0,Yt=0;ci<y.length;ci+=9,Yt+=6){K.set(y[ci+0],y[ci+1],y[ci+2]),Oe.set(y[ci+3],y[ci+4],y[ci+5]),xe.set(y[ci+6],y[ci+7],y[ci+8]),$e.set(w[Yt+0],w[Yt+1]),ht.set(w[Yt+2],w[Yt+3]),Et.set(w[Yt+4],w[Yt+5]),ze.copy(K).add(Oe).add(xe).divideScalar(3);const Pe=Se(ze);le($e,Yt+0,K,Pe),le(ht,Yt+2,Oe,Pe),le(Et,Yt+4,xe,Pe)}})(),function U(){for(let K=0;K<w.length;K+=6){const Oe=w[K+0],xe=w[K+2],ze=w[K+4],$e=Math.max(Oe,xe,ze),ht=Math.min(Oe,xe,ze);$e>.9&&ht<.1&&(Oe<.2&&(w[K+0]+=1),xe<.2&&(w[K+2]+=1),ze<.2&&(w[K+4]+=1))}}()}(),this.setAttribute("position",new Wn(y,3)),this.setAttribute("normal",new Wn(y.slice(),3)),this.setAttribute("uv",new Wn(w,2)),0===p?this.computeVertexNormals():this.normalizeNormals()}static fromJSON(o){return new Df(o.vertices,o.indices,o.radius,o.details)}}class Su extends Df{constructor(o=1,c=0){const d=(1+Math.sqrt(5))/2,p=1/d;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-p,-d,0,-p,d,0,p,-d,0,p,d,-p,-d,0,-p,d,0,p,-d,0,p,d,0,-d,0,-p,d,0,-p,-d,0,p,d,0,p],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],o,c),this.type="DodecahedronGeometry",this.parameters={radius:o,detail:c}}static fromJSON(o){return new Su(o.radius,o.detail)}}const D_=new Ne,Wx=new Ne,jx=new Ne,R_=new ha;class qx extends gt{constructor(o=null,c=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:o,thresholdAngle:c},null!==o){const p=Math.pow(10,4),y=Math.cos(ud*c),w=o.getIndex(),M=o.getAttribute("position"),R=w?w.count:M.count,A=[0,0,0],N=["a","b","c"],U=new Array(3),q={},Y=[];for(let ne=0;ne<R;ne+=3){w?(A[0]=w.getX(ne),A[1]=w.getX(ne+1),A[2]=w.getX(ne+2)):(A[0]=ne,A[1]=ne+1,A[2]=ne+2);const{a:le,b:Se,c:re}=R_;if(le.fromBufferAttribute(M,A[0]),Se.fromBufferAttribute(M,A[1]),re.fromBufferAttribute(M,A[2]),R_.getNormal(jx),U[0]=`${Math.round(le.x*p)},${Math.round(le.y*p)},${Math.round(le.z*p)}`,U[1]=`${Math.round(Se.x*p)},${Math.round(Se.y*p)},${Math.round(Se.z*p)}`,U[2]=`${Math.round(re.x*p)},${Math.round(re.y*p)},${Math.round(re.z*p)}`,U[0]!==U[1]&&U[1]!==U[2]&&U[2]!==U[0])for(let K=0;K<3;K++){const Oe=(K+1)%3,xe=U[K],ze=U[Oe],$e=R_[N[K]],ht=R_[N[Oe]],Et=`${xe}_${ze}`,ci=`${ze}_${xe}`;ci in q&&q[ci]?(jx.dot(q[ci].normal)<=y&&(Y.push($e.x,$e.y,$e.z),Y.push(ht.x,ht.y,ht.z)),q[ci]=null):Et in q||(q[Et]={index0:A[K],index1:A[Oe],normal:jx.clone()})}}for(const ne in q)if(q[ne]){const{index0:le,index1:Se}=q[ne];D_.fromBufferAttribute(M,le),Wx.fromBufferAttribute(M,Se),Y.push(D_.x,D_.y,D_.z),Y.push(Wx.x,Wx.y,Wx.z)}this.setAttribute("position",new Wn(Y,3))}}}class jc{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(o,c){const d=this.getUtoTmapping(o);return this.getPoint(d,c)}getPoints(o=5){const c=[];for(let d=0;d<=o;d++)c.push(this.getPoint(d/o));return c}getSpacedPoints(o=5){const c=[];for(let d=0;d<=o;d++)c.push(this.getPointAt(d/o));return c}getLength(){const o=this.getLengths();return o[o.length-1]}getLengths(o=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===o+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const c=[];let d,p=this.getPoint(0),y=0;c.push(0);for(let w=1;w<=o;w++)d=this.getPoint(w/o),y+=d.distanceTo(p),c.push(y),p=d;return this.cacheArcLengths=c,c}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(o,c){const d=this.getLengths();let p=0;const y=d.length;let w;w=c||o*d[y-1];let A,M=0,R=y-1;for(;M<=R;)if(p=Math.floor(M+(R-M)/2),A=d[p]-w,A<0)M=p+1;else{if(!(A>0)){R=p;break}R=p-1}if(p=R,d[p]===w)return p/(y-1);const N=d[p];return(p+(w-N)/(d[p+1]-N))/(y-1)}getTangent(o,c){let p=o-1e-4,y=o+1e-4;p<0&&(p=0),y>1&&(y=1);const w=this.getPoint(p),M=this.getPoint(y),R=c||(w.isVector2?new Be:new Ne);return R.copy(M).sub(w).normalize(),R}getTangentAt(o,c){const d=this.getUtoTmapping(o);return this.getTangent(d,c)}computeFrenetFrames(o,c){const d=new Ne,p=[],y=[],w=[],M=new Ne,R=new Mn;for(let Y=0;Y<=o;Y++)p[Y]=this.getTangentAt(Y/o,new Ne);y[0]=new Ne,w[0]=new Ne;let A=Number.MAX_VALUE;const N=Math.abs(p[0].x),U=Math.abs(p[0].y),q=Math.abs(p[0].z);N<=A&&(A=N,d.set(1,0,0)),U<=A&&(A=U,d.set(0,1,0)),q<=A&&d.set(0,0,1),M.crossVectors(p[0],d).normalize(),y[0].crossVectors(p[0],M),w[0].crossVectors(p[0],y[0]);for(let Y=1;Y<=o;Y++){if(y[Y]=y[Y-1].clone(),w[Y]=w[Y-1].clone(),M.crossVectors(p[Y-1],p[Y]),M.length()>Number.EPSILON){M.normalize();const ne=Math.acos(Ur(p[Y-1].dot(p[Y]),-1,1));y[Y].applyMatrix4(R.makeRotationAxis(M,ne))}w[Y].crossVectors(p[Y],y[Y])}if(!0===c){let Y=Math.acos(Ur(y[0].dot(y[o]),-1,1));Y/=o,p[0].dot(M.crossVectors(y[0],y[o]))>0&&(Y=-Y);for(let ne=1;ne<=o;ne++)y[ne].applyMatrix4(R.makeRotationAxis(p[ne],Y*ne)),w[ne].crossVectors(p[ne],y[ne])}return{tangents:p,normals:y,binormals:w}}clone(){return(new this.constructor).copy(this)}copy(o){return this.arcLengthDivisions=o.arcLengthDivisions,this}toJSON(){const o={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return o.arcLengthDivisions=this.arcLengthDivisions,o.type=this.type,o}fromJSON(o){return this.arcLengthDivisions=o.arcLengthDivisions,this}}class Kv extends jc{constructor(o=0,c=0,d=1,p=1,y=0,w=2*Math.PI,M=!1,R=0){super(),this.type="EllipseCurve",this.aX=o,this.aY=c,this.xRadius=d,this.yRadius=p,this.aStartAngle=y,this.aEndAngle=w,this.aClockwise=M,this.aRotation=R}getPoint(o,c){const d=c||new Be,p=2*Math.PI;let y=this.aEndAngle-this.aStartAngle;const w=Math.abs(y)<Number.EPSILON;for(;y<0;)y+=p;for(;y>p;)y-=p;y<Number.EPSILON&&(y=w?0:p),!0===this.aClockwise&&!w&&(y===p?y=-p:y-=p);const M=this.aStartAngle+o*y;let R=this.aX+this.xRadius*Math.cos(M),A=this.aY+this.yRadius*Math.sin(M);if(0!==this.aRotation){const N=Math.cos(this.aRotation),U=Math.sin(this.aRotation),q=R-this.aX,Y=A-this.aY;R=q*N-Y*U+this.aX,A=q*U+Y*N+this.aY}return d.set(R,A)}copy(o){return super.copy(o),this.aX=o.aX,this.aY=o.aY,this.xRadius=o.xRadius,this.yRadius=o.yRadius,this.aStartAngle=o.aStartAngle,this.aEndAngle=o.aEndAngle,this.aClockwise=o.aClockwise,this.aRotation=o.aRotation,this}toJSON(){const o=super.toJSON();return o.aX=this.aX,o.aY=this.aY,o.xRadius=this.xRadius,o.yRadius=this.yRadius,o.aStartAngle=this.aStartAngle,o.aEndAngle=this.aEndAngle,o.aClockwise=this.aClockwise,o.aRotation=this.aRotation,o}fromJSON(o){return super.fromJSON(o),this.aX=o.aX,this.aY=o.aY,this.xRadius=o.xRadius,this.yRadius=o.yRadius,this.aStartAngle=o.aStartAngle,this.aEndAngle=o.aEndAngle,this.aClockwise=o.aClockwise,this.aRotation=o.aRotation,this}}Kv.prototype.isEllipseCurve=!0;class Dd extends Kv{constructor(o,c,d,p,y,w){super(o,c,d,d,p,y,w),this.type="ArcCurve"}}function Xx(){let g=0,o=0,c=0,d=0;function p(y,w,M,R){g=y,o=M,c=-3*y+3*w-2*M-R,d=2*y-2*w+M+R}return{initCatmullRom:function(y,w,M,R,A){p(w,M,A*(M-y),A*(R-w))},initNonuniformCatmullRom:function(y,w,M,R,A,N,U){let q=(w-y)/A-(M-y)/(A+N)+(M-w)/N,Y=(M-w)/N-(R-w)/(N+U)+(R-M)/U;q*=N,Y*=N,p(w,M,q,Y)},calc:function(y){const w=y*y;return g+o*y+c*w+d*(w*y)}}}Dd.prototype.isArcCurve=!0;const Zx=new Ne,Qv=new Xx,bM=new Xx,Yx=new Xx;class xM extends jc{constructor(o=[],c=!1,d="centripetal",p=.5){super(),this.type="CatmullRomCurve3",this.points=o,this.closed=c,this.curveType=d,this.tension=p}getPoint(o,c=new Ne){const d=c,p=this.points,y=p.length,w=(y-(this.closed?0:1))*o;let A,N,M=Math.floor(w),R=w-M;this.closed?M+=M>0?0:(Math.floor(Math.abs(M)/y)+1)*y:0===R&&M===y-1&&(M=y-2,R=1),this.closed||M>0?A=p[(M-1)%y]:(Zx.subVectors(p[0],p[1]).add(p[0]),A=Zx);const U=p[M%y],q=p[(M+1)%y];if(this.closed||M+2<y?N=p[(M+2)%y]:(Zx.subVectors(p[y-1],p[y-2]).add(p[y-1]),N=Zx),"centripetal"===this.curveType||"chordal"===this.curveType){const Y="chordal"===this.curveType?.5:.25;let ne=Math.pow(A.distanceToSquared(U),Y),le=Math.pow(U.distanceToSquared(q),Y),Se=Math.pow(q.distanceToSquared(N),Y);le<1e-4&&(le=1),ne<1e-4&&(ne=le),Se<1e-4&&(Se=le),Qv.initNonuniformCatmullRom(A.x,U.x,q.x,N.x,ne,le,Se),bM.initNonuniformCatmullRom(A.y,U.y,q.y,N.y,ne,le,Se),Yx.initNonuniformCatmullRom(A.z,U.z,q.z,N.z,ne,le,Se)}else"catmullrom"===this.curveType&&(Qv.initCatmullRom(A.x,U.x,q.x,N.x,this.tension),bM.initCatmullRom(A.y,U.y,q.y,N.y,this.tension),Yx.initCatmullRom(A.z,U.z,q.z,N.z,this.tension));return d.set(Qv.calc(R),bM.calc(R),Yx.calc(R)),d}copy(o){super.copy(o),this.points=[];for(let c=0,d=o.points.length;c<d;c++)this.points.push(o.points[c].clone());return this.closed=o.closed,this.curveType=o.curveType,this.tension=o.tension,this}toJSON(){const o=super.toJSON();o.points=[];for(let c=0,d=this.points.length;c<d;c++)o.points.push(this.points[c].toArray());return o.closed=this.closed,o.curveType=this.curveType,o.tension=this.tension,o}fromJSON(o){super.fromJSON(o),this.points=[];for(let c=0,d=o.points.length;c<d;c++){const p=o.points[c];this.points.push((new Ne).fromArray(p))}return this.closed=o.closed,this.curveType=o.curveType,this.tension=o.tension,this}}function rD(g,o,c,d,p){const y=.5*(d-o),w=.5*(p-c),M=g*g;return(2*c-2*d+y+w)*(g*M)+(-3*c+3*d-2*y-w)*M+y*g+c}function Rd(g,o,c,d){return function Jv(g,o){const c=1-g;return c*c*o}(g,o)+function k_(g,o){return 2*(1-g)*g*o}(g,c)+function wM(g,o){return g*g*o}(g,d)}function I_(g,o,c,d,p){return function $v(g,o){const c=1-g;return c*c*c*o}(g,o)+function P_(g,o){const c=1-g;return 3*c*c*g*o}(g,c)+function QO(g,o){return 3*(1-g)*g*g*o}(g,d)+function sD(g,o){return g*g*g*o}(g,p)}xM.prototype.isCatmullRomCurve3=!0;class L_ extends jc{constructor(o=new Be,c=new Be,d=new Be,p=new Be){super(),this.type="CubicBezierCurve",this.v0=o,this.v1=c,this.v2=d,this.v3=p}getPoint(o,c=new Be){const d=c,p=this.v0,y=this.v1,w=this.v2,M=this.v3;return d.set(I_(o,p.x,y.x,w.x,M.x),I_(o,p.y,y.y,w.y,M.y)),d}copy(o){return super.copy(o),this.v0.copy(o.v0),this.v1.copy(o.v1),this.v2.copy(o.v2),this.v3.copy(o.v3),this}toJSON(){const o=super.toJSON();return o.v0=this.v0.toArray(),o.v1=this.v1.toArray(),o.v2=this.v2.toArray(),o.v3=this.v3.toArray(),o}fromJSON(o){return super.fromJSON(o),this.v0.fromArray(o.v0),this.v1.fromArray(o.v1),this.v2.fromArray(o.v2),this.v3.fromArray(o.v3),this}}L_.prototype.isCubicBezierCurve=!0;class eb extends jc{constructor(o=new Ne,c=new Ne,d=new Ne,p=new Ne){super(),this.type="CubicBezierCurve3",this.v0=o,this.v1=c,this.v2=d,this.v3=p}getPoint(o,c=new Ne){const d=c,p=this.v0,y=this.v1,w=this.v2,M=this.v3;return d.set(I_(o,p.x,y.x,w.x,M.x),I_(o,p.y,y.y,w.y,M.y),I_(o,p.z,y.z,w.z,M.z)),d}copy(o){return super.copy(o),this.v0.copy(o.v0),this.v1.copy(o.v1),this.v2.copy(o.v2),this.v3.copy(o.v3),this}toJSON(){const o=super.toJSON();return o.v0=this.v0.toArray(),o.v1=this.v1.toArray(),o.v2=this.v2.toArray(),o.v3=this.v3.toArray(),o}fromJSON(o){return super.fromJSON(o),this.v0.fromArray(o.v0),this.v1.fromArray(o.v1),this.v2.fromArray(o.v2),this.v3.fromArray(o.v3),this}}eb.prototype.isCubicBezierCurve3=!0;class O_ extends jc{constructor(o=new Be,c=new Be){super(),this.type="LineCurve",this.v1=o,this.v2=c}getPoint(o,c=new Be){const d=c;return 1===o?d.copy(this.v2):(d.copy(this.v2).sub(this.v1),d.multiplyScalar(o).add(this.v1)),d}getPointAt(o,c){return this.getPoint(o,c)}getTangent(o,c){const d=c||new Be;return d.copy(this.v2).sub(this.v1).normalize(),d}copy(o){return super.copy(o),this.v1.copy(o.v1),this.v2.copy(o.v2),this}toJSON(){const o=super.toJSON();return o.v1=this.v1.toArray(),o.v2=this.v2.toArray(),o}fromJSON(o){return super.fromJSON(o),this.v1.fromArray(o.v1),this.v2.fromArray(o.v2),this}}O_.prototype.isLineCurve=!0;class tb extends jc{constructor(o=new Ne,c=new Ne){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=o,this.v2=c}getPoint(o,c=new Ne){const d=c;return 1===o?d.copy(this.v2):(d.copy(this.v2).sub(this.v1),d.multiplyScalar(o).add(this.v1)),d}getPointAt(o,c){return this.getPoint(o,c)}copy(o){return super.copy(o),this.v1.copy(o.v1),this.v2.copy(o.v2),this}toJSON(){const o=super.toJSON();return o.v1=this.v1.toArray(),o.v2=this.v2.toArray(),o}fromJSON(o){return super.fromJSON(o),this.v1.fromArray(o.v1),this.v2.fromArray(o.v2),this}}class Kx extends jc{constructor(o=new Be,c=new Be,d=new Be){super(),this.type="QuadraticBezierCurve",this.v0=o,this.v1=c,this.v2=d}getPoint(o,c=new Be){const d=c,p=this.v0,y=this.v1,w=this.v2;return d.set(Rd(o,p.x,y.x,w.x),Rd(o,p.y,y.y,w.y)),d}copy(o){return super.copy(o),this.v0.copy(o.v0),this.v1.copy(o.v1),this.v2.copy(o.v2),this}toJSON(){const o=super.toJSON();return o.v0=this.v0.toArray(),o.v1=this.v1.toArray(),o.v2=this.v2.toArray(),o}fromJSON(o){return super.fromJSON(o),this.v0.fromArray(o.v0),this.v1.fromArray(o.v1),this.v2.fromArray(o.v2),this}}Kx.prototype.isQuadraticBezierCurve=!0;class ib extends jc{constructor(o=new Ne,c=new Ne,d=new Ne){super(),this.type="QuadraticBezierCurve3",this.v0=o,this.v1=c,this.v2=d}getPoint(o,c=new Ne){const d=c,p=this.v0,y=this.v1,w=this.v2;return d.set(Rd(o,p.x,y.x,w.x),Rd(o,p.y,y.y,w.y),Rd(o,p.z,y.z,w.z)),d}copy(o){return super.copy(o),this.v0.copy(o.v0),this.v1.copy(o.v1),this.v2.copy(o.v2),this}toJSON(){const o=super.toJSON();return o.v0=this.v0.toArray(),o.v1=this.v1.toArray(),o.v2=this.v2.toArray(),o}fromJSON(o){return super.fromJSON(o),this.v0.fromArray(o.v0),this.v1.fromArray(o.v1),this.v2.fromArray(o.v2),this}}ib.prototype.isQuadraticBezierCurve3=!0;class SM extends jc{constructor(o=[]){super(),this.type="SplineCurve",this.points=o}getPoint(o,c=new Be){const d=c,p=this.points,y=(p.length-1)*o,w=Math.floor(y),M=y-w,R=p[0===w?w:w-1],A=p[w],N=p[w>p.length-2?p.length-1:w+1],U=p[w>p.length-3?p.length-1:w+2];return d.set(rD(M,R.x,A.x,N.x,U.x),rD(M,R.y,A.y,N.y,U.y)),d}copy(o){super.copy(o),this.points=[];for(let c=0,d=o.points.length;c<d;c++)this.points.push(o.points[c].clone());return this}toJSON(){const o=super.toJSON();o.points=[];for(let c=0,d=this.points.length;c<d;c++)o.points.push(this.points[c].toArray());return o}fromJSON(o){super.fromJSON(o),this.points=[];for(let c=0,d=o.points.length;c<d;c++){const p=o.points[c];this.points.push((new Be).fromArray(p))}return this}}SM.prototype.isSplineCurve=!0;var Qx=Object.freeze({__proto__:null,ArcCurve:Dd,CatmullRomCurve3:xM,CubicBezierCurve:L_,CubicBezierCurve3:eb,EllipseCurve:Kv,LineCurve:O_,LineCurve3:tb,QuadraticBezierCurve:Kx,QuadraticBezierCurve3:ib,SplineCurve:SM});class CM extends jc{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(o){this.curves.push(o)}closePath(){const o=this.curves[0].getPoint(0),c=this.curves[this.curves.length-1].getPoint(1);o.equals(c)||this.curves.push(new O_(c,o))}getPoint(o,c){const d=o*this.getLength(),p=this.getCurveLengths();let y=0;for(;y<p.length;){if(p[y]>=d){const w=p[y]-d,M=this.curves[y],R=M.getLength();return M.getPointAt(0===R?0:1-w/R,c)}y++}return null}getLength(){const o=this.getCurveLengths();return o[o.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const o=[];let c=0;for(let d=0,p=this.curves.length;d<p;d++)c+=this.curves[d].getLength(),o.push(c);return this.cacheLengths=o,o}getSpacedPoints(o=40){const c=[];for(let d=0;d<=o;d++)c.push(this.getPoint(d/o));return this.autoClose&&c.push(c[0]),c}getPoints(o=12){const c=[];let d;for(let p=0,y=this.curves;p<y.length;p++){const w=y[p],R=w.getPoints(w&&w.isEllipseCurve?2*o:w&&(w.isLineCurve||w.isLineCurve3)?1:w&&w.isSplineCurve?o*w.points.length:o);for(let A=0;A<R.length;A++){const N=R[A];d&&d.equals(N)||(c.push(N),d=N)}}return this.autoClose&&c.length>1&&!c[c.length-1].equals(c[0])&&c.push(c[0]),c}copy(o){super.copy(o),this.curves=[];for(let c=0,d=o.curves.length;c<d;c++)this.curves.push(o.curves[c].clone());return this.autoClose=o.autoClose,this}toJSON(){const o=super.toJSON();o.autoClose=this.autoClose,o.curves=[];for(let c=0,d=this.curves.length;c<d;c++)o.curves.push(this.curves[c].toJSON());return o}fromJSON(o){super.fromJSON(o),this.autoClose=o.autoClose,this.curves=[];for(let c=0,d=o.curves.length;c<d;c++){const p=o.curves[c];this.curves.push((new Qx[p.type]).fromJSON(p))}return this}}class nb extends CM{constructor(o){super(),this.type="Path",this.currentPoint=new Be,o&&this.setFromPoints(o)}setFromPoints(o){this.moveTo(o[0].x,o[0].y);for(let c=1,d=o.length;c<d;c++)this.lineTo(o[c].x,o[c].y);return this}moveTo(o,c){return this.currentPoint.set(o,c),this}lineTo(o,c){const d=new O_(this.currentPoint.clone(),new Be(o,c));return this.curves.push(d),this.currentPoint.set(o,c),this}quadraticCurveTo(o,c,d,p){const y=new Kx(this.currentPoint.clone(),new Be(o,c),new Be(d,p));return this.curves.push(y),this.currentPoint.set(d,p),this}bezierCurveTo(o,c,d,p,y,w){const M=new L_(this.currentPoint.clone(),new Be(o,c),new Be(d,p),new Be(y,w));return this.curves.push(M),this.currentPoint.set(y,w),this}splineThru(o){const c=[this.currentPoint.clone()].concat(o),d=new SM(c);return this.curves.push(d),this.currentPoint.copy(o[o.length-1]),this}arc(o,c,d,p,y,w){return this.absarc(o+this.currentPoint.x,c+this.currentPoint.y,d,p,y,w),this}absarc(o,c,d,p,y,w){return this.absellipse(o,c,d,d,p,y,w),this}ellipse(o,c,d,p,y,w,M,R){return this.absellipse(o+this.currentPoint.x,c+this.currentPoint.y,d,p,y,w,M,R),this}absellipse(o,c,d,p,y,w,M,R){const A=new Kv(o,c,d,p,y,w,M,R);if(this.curves.length>0){const U=A.getPoint(0);U.equals(this.currentPoint)||this.lineTo(U.x,U.y)}this.curves.push(A);const N=A.getPoint(1);return this.currentPoint.copy(N),this}copy(o){return super.copy(o),this.currentPoint.copy(o.currentPoint),this}toJSON(){const o=super.toJSON();return o.currentPoint=this.currentPoint.toArray(),o}fromJSON(o){return super.fromJSON(o),this.currentPoint.fromArray(o.currentPoint),this}}class Th extends nb{constructor(o){super(o),this.uuid=tl(),this.type="Shape",this.holes=[]}getPointsHoles(o){const c=[];for(let d=0,p=this.holes.length;d<p;d++)c[d]=this.holes[d].getPoints(o);return c}extractPoints(o){return{shape:this.getPoints(o),holes:this.getPointsHoles(o)}}copy(o){super.copy(o),this.holes=[];for(let c=0,d=o.holes.length;c<d;c++)this.holes.push(o.holes[c].clone());return this}toJSON(){const o=super.toJSON();o.uuid=this.uuid,o.holes=[];for(let c=0,d=this.holes.length;c<d;c++)o.holes.push(this.holes[c].toJSON());return o}fromJSON(o){super.fromJSON(o),this.uuid=o.uuid,this.holes=[];for(let c=0,d=o.holes.length;c<d;c++){const p=o.holes[c];this.holes.push((new nb).fromJSON(p))}return this}}function oD(g,o,c,d,p){let y,w;if(p===function lF(g,o,c,d){let p=0;for(let y=o,w=c-d;y<c;y+=d)p+=(g[w]-g[y])*(g[y+1]+g[w+1]),w=y;return p}(g,o,c,d)>0)for(y=o;y<c;y+=d)w=AM(y,g[y],g[y+1],w);else for(y=c-d;y>=o;y-=d)w=AM(y,g[y],g[y+1],w);return w&&sb(w,w.next)&&(ab(w),w=w.next),w}function al(g,o){if(!g)return g;o||(o=g);let d,c=g;do{if(d=!1,c.steiner||!sb(c,c.next)&&0!==pa(c.prev,c,c.next))c=c.next;else{if(ab(c),c=o=c.prev,c===c.next)break;d=!0}}while(d||c!==o);return o}function rb(g,o,c,d,p,y,w){if(!g)return;!w&&y&&function iF(g,o,c,d){let p=g;do{null===p.z&&(p.z=Jx(p.x,p.y,o,c,d)),p.prevZ=p.prev,p.nextZ=p.next,p=p.next}while(p!==g);p.prevZ.nextZ=null,p.prevZ=null,function nF(g){let o,c,d,p,y,w,M,R,A=1;do{for(c=g,g=null,y=null,w=0;c;){for(w++,d=c,M=0,o=0;o<A&&(M++,d=d.nextZ,d);o++);for(R=A;M>0||R>0&&d;)0!==M&&(0===R||!d||c.z<=d.z)?(p=c,c=c.nextZ,M--):(p=d,d=d.nextZ,R--),y?y.nextZ=p:g=p,p.prevZ=y,y=p;c=d}y.nextZ=null,A*=2}while(w>1)}(p)}(g,d,p,y);let R,A,M=g;for(;g.prev!==g.next;)if(R=g.prev,A=g.next,y?rU(g,d,p,y):$O(g))o.push(R.i/c),o.push(g.i/c),o.push(A.i/c),ab(g),g=A.next,M=A.next;else if((g=A)===M){w?1===w?rb(g=sU(al(g),o,c),o,c,d,p,y,2):2===w&&aD(g,o,c,d,p,y):rb(al(g),o,c,d,p,y,1);break}}function $O(g){const o=g.prev,c=g,d=g.next;if(pa(o,c,d)>=0)return!1;let p=g.next.next;for(;p!==g.prev;){if(wm(o.x,o.y,c.x,c.y,d.x,d.y,p.x,p.y)&&pa(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function rU(g,o,c,d){const p=g.prev,y=g,w=g.next;if(pa(p,y,w)>=0)return!1;const A=p.x>y.x?p.x>w.x?p.x:w.x:y.x>w.x?y.x:w.x,N=p.y>y.y?p.y>w.y?p.y:w.y:y.y>w.y?y.y:w.y,U=Jx(p.x<y.x?p.x<w.x?p.x:w.x:y.x<w.x?y.x:w.x,p.y<y.y?p.y<w.y?p.y:w.y:y.y<w.y?y.y:w.y,o,c,d),q=Jx(A,N,o,c,d);let Y=g.prevZ,ne=g.nextZ;for(;Y&&Y.z>=U&&ne&&ne.z<=q;){if(Y!==g.prev&&Y!==g.next&&wm(p.x,p.y,y.x,y.y,w.x,w.y,Y.x,Y.y)&&pa(Y.prev,Y,Y.next)>=0||(Y=Y.prevZ,ne!==g.prev&&ne!==g.next&&wm(p.x,p.y,y.x,y.y,w.x,w.y,ne.x,ne.y)&&pa(ne.prev,ne,ne.next)>=0))return!1;ne=ne.nextZ}for(;Y&&Y.z>=U;){if(Y!==g.prev&&Y!==g.next&&wm(p.x,p.y,y.x,y.y,w.x,w.y,Y.x,Y.y)&&pa(Y.prev,Y,Y.next)>=0)return!1;Y=Y.prevZ}for(;ne&&ne.z<=q;){if(ne!==g.prev&&ne!==g.next&&wm(p.x,p.y,y.x,y.y,w.x,w.y,ne.x,ne.y)&&pa(ne.prev,ne,ne.next)>=0)return!1;ne=ne.nextZ}return!0}function sU(g,o,c){let d=g;do{const p=d.prev,y=d.next.next;!sb(p,y)&&TM(p,d,d.next,y)&&ob(p,y)&&ob(y,p)&&(o.push(p.i/c),o.push(d.i/c),o.push(y.i/c),ab(d),ab(d.next),d=g=y),d=d.next}while(d!==g);return al(d)}function aD(g,o,c,d,p,y){let w=g;do{let M=w.next.next;for(;M!==w.prev;){if(w.i!==M.i&&sF(w,M)){let R=aF(w,M);return w=al(w,w.next),R=al(R,R.next),rb(w,o,c,d,p,y),void rb(R,o,c,d,p,y)}M=M.next}w=w.next}while(w!==g)}function eF(g,o){return g.x-o.x}function MM(g,o){if(o=function lD(g,o){let c=o;const d=g.x,p=g.y;let w,y=-1/0;do{if(p<=c.y&&p>=c.next.y&&c.next.y!==c.y){const q=c.x+(p-c.y)*(c.next.x-c.x)/(c.next.y-c.y);if(q<=d&&q>y){if(y=q,q===d){if(p===c.y)return c;if(p===c.next.y)return c.next}w=c.x<c.next.x?c:c.next}}c=c.next}while(c!==o);if(!w)return null;if(d===y)return w;const M=w,R=w.x,A=w.y;let U,N=1/0;c=w;do{d>=c.x&&c.x>=R&&d!==c.x&&wm(p<A?d:y,p,R,A,p<A?y:d,p,c.x,c.y)&&(U=Math.abs(p-c.y)/(d-c.x),ob(c,g)&&(U<N||U===N&&(c.x>w.x||c.x===w.x&&tF(w,c)))&&(w=c,N=U)),c=c.next}while(c!==M);return w}(g,o),o){const c=aF(o,g);al(o,o.next),al(c,c.next)}}function tF(g,o){return pa(g.prev,g,o.prev)<0&&pa(o.next,g,g.next)<0}function Jx(g,o,c,d,p){return(g=1431655765&((g=858993459&((g=252645135&((g=16711935&((g=32767*(g-c)*p)|g<<8))|g<<4))|g<<2))|g<<1))|(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=32767*(o-d)*p)|o<<8))|o<<4))|o<<2))|o<<1))<<1}function rF(g){let o=g,c=g;do{(o.x<c.x||o.x===c.x&&o.y<c.y)&&(c=o),o=o.next}while(o!==g);return c}function wm(g,o,c,d,p,y,w,M){return(p-w)*(o-M)-(g-w)*(y-M)>=0&&(g-w)*(d-M)-(c-w)*(o-M)>=0&&(c-w)*(y-M)-(p-w)*(d-M)>=0}function sF(g,o){return g.next.i!==o.i&&g.prev.i!==o.i&&!function EM(g,o){let c=g;do{if(c.i!==g.i&&c.next.i!==g.i&&c.i!==o.i&&c.next.i!==o.i&&TM(c,c.next,g,o))return!0;c=c.next}while(c!==g);return!1}(g,o)&&(ob(g,o)&&ob(o,g)&&function oF(g,o){let c=g,d=!1;const p=(g.x+o.x)/2,y=(g.y+o.y)/2;do{c.y>y!=c.next.y>y&&c.next.y!==c.y&&p<(c.next.x-c.x)*(y-c.y)/(c.next.y-c.y)+c.x&&(d=!d),c=c.next}while(c!==g);return d}(g,o)&&(pa(g.prev,g,o.prev)||pa(g,o.prev,o))||sb(g,o)&&pa(g.prev,g,g.next)>0&&pa(o.prev,o,o.next)>0)}function pa(g,o,c){return(o.y-g.y)*(c.x-o.x)-(o.x-g.x)*(c.y-o.y)}function sb(g,o){return g.x===o.x&&g.y===o.y}function TM(g,o,c,d){const p=Cu(pa(g,o,c)),y=Cu(pa(g,o,d)),w=Cu(pa(c,d,g)),M=Cu(pa(c,d,o));return!!(p!==y&&w!==M||0===p&&$x(g,c,o)||0===y&&$x(g,d,o)||0===w&&$x(c,g,d)||0===M&&$x(c,o,d))}function $x(g,o,c){return o.x<=Math.max(g.x,c.x)&&o.x>=Math.min(g.x,c.x)&&o.y<=Math.max(g.y,c.y)&&o.y>=Math.min(g.y,c.y)}function Cu(g){return g>0?1:g<0?-1:0}function ob(g,o){return pa(g.prev,g,g.next)<0?pa(g,o,g.next)>=0&&pa(g,g.prev,o)>=0:pa(g,o,g.prev)<0||pa(g,g.next,o)<0}function aF(g,o){const c=new DM(g.i,g.x,g.y),d=new DM(o.i,o.x,o.y),p=g.next,y=o.prev;return g.next=o,o.prev=g,c.next=p,p.prev=c,d.next=c,c.prev=d,y.next=d,d.prev=y,d}function AM(g,o,c,d){const p=new DM(g,o,c);return d?(p.next=d.next,p.prev=d,d.next.prev=p,d.next=p):(p.prev=p,p.next=p),p}function ab(g){g.next.prev=g.prev,g.prev.next=g.next,g.prevZ&&(g.prevZ.nextZ=g.nextZ),g.nextZ&&(g.nextZ.prevZ=g.prevZ)}function DM(g,o,c){this.i=g,this.x=o,this.y=c,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}class $u{static area(o){const c=o.length;let d=0;for(let p=c-1,y=0;y<c;p=y++)d+=o[p].x*o[y].y-o[y].x*o[p].y;return.5*d}static isClockWise(o){return $u.area(o)<0}static triangulateShape(o,c){const d=[],p=[],y=[];cD(o),uD(d,o);let w=o.length;c.forEach(cD);for(let R=0;R<c.length;R++)p.push(w),w+=c[R].length,uD(d,c[R]);const M=function(g,o,c=2){const d=o&&o.length,p=d?o[0]*c:g.length;let y=oD(g,0,p,c,!0);const w=[];if(!y||y.next===y.prev)return w;let M,R,A,N,U,q,Y;if(d&&(y=function oU(g,o,c,d){const p=[];let y,w,M,R,A;for(y=0,w=o.length;y<w;y++)M=o[y]*d,R=y<w-1?o[y+1]*d:g.length,A=oD(g,M,R,d,!1),A===A.next&&(A.steiner=!0),p.push(rF(A));for(p.sort(eF),y=0;y<p.length;y++)MM(p[y],c),c=al(c,c.next);return c}(g,o,y,c)),g.length>80*c){M=A=g[0],R=N=g[1];for(let ne=c;ne<p;ne+=c)U=g[ne],q=g[ne+1],U<M&&(M=U),q<R&&(R=q),U>A&&(A=U),q>N&&(N=q);Y=Math.max(A-M,N-R),Y=0!==Y?1/Y:0}return rb(y,w,c,M,R,Y),w}(d,p);for(let R=0;R<M.length;R+=3)y.push(M.slice(R,R+3));return y}}function cD(g){const o=g.length;o>2&&g[o-1].equals(g[0])&&g.pop()}function uD(g,o){for(let c=0;c<o.length;c++)g.push(o[c].x),g.push(o[c].y)}class Mu extends gt{constructor(o=new Th([new Be(.5,.5),new Be(-.5,.5),new Be(-.5,-.5),new Be(.5,-.5)]),c={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:o,options:c},o=Array.isArray(o)?o:[o];const d=this,p=[],y=[];for(let M=0,R=o.length;M<R;M++)w(o[M]);function w(M){const R=[],A=void 0!==c.curveSegments?c.curveSegments:12,N=void 0!==c.steps?c.steps:1;let U=void 0!==c.depth?c.depth:1,q=void 0===c.bevelEnabled||c.bevelEnabled,Y=void 0!==c.bevelThickness?c.bevelThickness:.2,ne=void 0!==c.bevelSize?c.bevelSize:Y-.1,le=void 0!==c.bevelOffset?c.bevelOffset:0,Se=void 0!==c.bevelSegments?c.bevelSegments:3;const re=c.extrudePath,K=void 0!==c.UVGenerator?c.UVGenerator:RM;void 0!==c.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),U=c.amount);let Oe,ze,$e,ht,Et,xe=!1;re&&(Oe=re.getSpacedPoints(N),xe=!0,q=!1,ze=re.computeFrenetFrames(N,!1),$e=new Ne,ht=new Ne,Et=new Ne),q||(Se=0,Y=0,ne=0,le=0);const ci=M.extractPoints(A);let Yt=ci.shape;const Pe=ci.holes;if(!$u.isClockWise(Yt)){Yt=Yt.reverse();for(let Ai=0,an=Pe.length;Ai<an;Ai++){const en=Pe[Ai];$u.isClockWise(en)&&(Pe[Ai]=en.reverse())}}const Ft=$u.triangulateShape(Yt,Pe),zt=Yt;for(let Ai=0,an=Pe.length;Ai<an;Ai++)Yt=Yt.concat(Pe[Ai]);function Qt(Ai,an,en){return an||console.error("THREE.ExtrudeGeometry: vec does not exist"),an.clone().multiplyScalar(en).add(Ai)}const Ut=Yt.length,ue=Ft.length;function Xt(Ai,an,en){let Bn,Tn,jr;const Zr=Ai.x-an.x,Ys=Ai.y-an.y,qo=en.x-Ai.x,Ro=en.y-Ai.y,rt=Zr*Zr+Ys*Ys;if(Math.abs(Zr*Ro-Ys*qo)>Number.EPSILON){const wi=Math.sqrt(rt),rn=Math.sqrt(qo*qo+Ro*Ro),ir=an.x-Ys/wi,vi=an.y+Zr/wi,wn=((en.x-Ro/rn-ir)*Ro-(en.y+qo/rn-vi)*qo)/(Zr*Ro-Ys*qo);Bn=ir+Zr*wn-Ai.x,Tn=vi+Ys*wn-Ai.y;const vn=Bn*Bn+Tn*Tn;if(vn<=2)return new Be(Bn,Tn);jr=Math.sqrt(vn/2)}else{let wi=!1;Zr>Number.EPSILON?qo>Number.EPSILON&&(wi=!0):Zr<-Number.EPSILON?qo<-Number.EPSILON&&(wi=!0):Math.sign(Ys)===Math.sign(Ro)&&(wi=!0),wi?(Bn=-Ys,Tn=Zr,jr=Math.sqrt(rt)):(Bn=Zr,Tn=Ys,jr=Math.sqrt(rt/2))}return new Be(Bn/jr,Tn/jr)}const ui=[];for(let Ai=0,an=zt.length,en=an-1,Bn=Ai+1;Ai<an;Ai++,en++,Bn++)en===an&&(en=0),Bn===an&&(Bn=0),ui[Ai]=Xt(zt[Ai],zt[en],zt[Bn]);const hi=[];let Bi,yn=ui.concat();for(let Ai=0,an=Pe.length;Ai<an;Ai++){const en=Pe[Ai];Bi=[];for(let Bn=0,Tn=en.length,jr=Tn-1,Zr=Bn+1;Bn<Tn;Bn++,jr++,Zr++)jr===Tn&&(jr=0),Zr===Tn&&(Zr=0),Bi[Bn]=Xt(en[Bn],en[jr],en[Zr]);hi.push(Bi),yn=yn.concat(Bi)}for(let Ai=0;Ai<Se;Ai++){const an=Ai/Se,en=Y*Math.cos(an*Math.PI/2),Bn=ne*Math.sin(an*Math.PI/2)+le;for(let Tn=0,jr=zt.length;Tn<jr;Tn++){const Zr=Qt(zt[Tn],ui[Tn],Bn);sr(Zr.x,Zr.y,-en)}for(let Tn=0,jr=Pe.length;Tn<jr;Tn++){const Zr=Pe[Tn];Bi=hi[Tn];for(let Ys=0,qo=Zr.length;Ys<qo;Ys++){const Ro=Qt(Zr[Ys],Bi[Ys],Bn);sr(Ro.x,Ro.y,-en)}}}const Yn=ne+le;for(let Ai=0;Ai<Ut;Ai++){const an=q?Qt(Yt[Ai],yn[Ai],Yn):Yt[Ai];xe?(ht.copy(ze.normals[0]).multiplyScalar(an.x),$e.copy(ze.binormals[0]).multiplyScalar(an.y),Et.copy(Oe[0]).add(ht).add($e),sr(Et.x,Et.y,Et.z)):sr(an.x,an.y,0)}for(let Ai=1;Ai<=N;Ai++)for(let an=0;an<Ut;an++){const en=q?Qt(Yt[an],yn[an],Yn):Yt[an];xe?(ht.copy(ze.normals[Ai]).multiplyScalar(en.x),$e.copy(ze.binormals[Ai]).multiplyScalar(en.y),Et.copy(Oe[Ai]).add(ht).add($e),sr(Et.x,Et.y,Et.z)):sr(en.x,en.y,U/N*Ai)}for(let Ai=Se-1;Ai>=0;Ai--){const an=Ai/Se,en=Y*Math.cos(an*Math.PI/2),Bn=ne*Math.sin(an*Math.PI/2)+le;for(let Tn=0,jr=zt.length;Tn<jr;Tn++){const Zr=Qt(zt[Tn],ui[Tn],Bn);sr(Zr.x,Zr.y,U+en)}for(let Tn=0,jr=Pe.length;Tn<jr;Tn++){const Zr=Pe[Tn];Bi=hi[Tn];for(let Ys=0,qo=Zr.length;Ys<qo;Ys++){const Ro=Qt(Zr[Ys],Bi[Ys],Bn);xe?sr(Ro.x,Ro.y+Oe[N-1].y,Oe[N-1].x+en):sr(Ro.x,Ro.y,U+en)}}}function oo(Ai,an){let en=Ai.length;for(;--en>=0;){const Bn=en;let Tn=en-1;Tn<0&&(Tn=Ai.length-1);for(let jr=0,Zr=N+2*Se;jr<Zr;jr++){const Ys=Ut*jr,qo=Ut*(jr+1);Fn(an+Bn+Ys,an+Tn+Ys,an+Tn+qo,an+Bn+qo)}}}function sr(Ai,an,en){R.push(Ai),R.push(an),R.push(en)}function Nr(Ai,an,en){ws(Ai),ws(an),ws(en);const Bn=p.length/3,Tn=K.generateTopUV(d,p,Bn-3,Bn-2,Bn-1);Xr(Tn[0]),Xr(Tn[1]),Xr(Tn[2])}function Fn(Ai,an,en,Bn){ws(Ai),ws(an),ws(Bn),ws(an),ws(en),ws(Bn);const Tn=p.length/3,jr=K.generateSideWallUV(d,p,Tn-6,Tn-3,Tn-2,Tn-1);Xr(jr[0]),Xr(jr[1]),Xr(jr[3]),Xr(jr[1]),Xr(jr[2]),Xr(jr[3])}function ws(Ai){p.push(R[3*Ai+0]),p.push(R[3*Ai+1]),p.push(R[3*Ai+2])}function Xr(Ai){y.push(Ai.x),y.push(Ai.y)}(function ur(){const Ai=p.length/3;if(q){let an=0,en=Ut*an;for(let Bn=0;Bn<ue;Bn++){const Tn=Ft[Bn];Nr(Tn[2]+en,Tn[1]+en,Tn[0]+en)}an=N+2*Se,en=Ut*an;for(let Bn=0;Bn<ue;Bn++){const Tn=Ft[Bn];Nr(Tn[0]+en,Tn[1]+en,Tn[2]+en)}}else{for(let an=0;an<ue;an++){const en=Ft[an];Nr(en[2],en[1],en[0])}for(let an=0;an<ue;an++){const en=Ft[an];Nr(en[0]+Ut*N,en[1]+Ut*N,en[2]+Ut*N)}}d.addGroup(Ai,p.length/3-Ai,0)})(),function At(){const Ai=p.length/3;let an=0;oo(zt,an),an+=zt.length;for(let en=0,Bn=Pe.length;en<Bn;en++){const Tn=Pe[en];oo(Tn,an),an+=Tn.length}d.addGroup(Ai,p.length/3-Ai,1)}()}this.setAttribute("position",new Wn(p,3)),this.setAttribute("uv",new Wn(y,2)),this.computeVertexNormals()}toJSON(){const o=super.toJSON();return function cF(g,o,c){if(c.shapes=[],Array.isArray(g))for(let d=0,p=g.length;d<p;d++)c.shapes.push(g[d].uuid);else c.shapes.push(g.uuid);return void 0!==o.extrudePath&&(c.options.extrudePath=o.extrudePath.toJSON()),c}(this.parameters.shapes,this.parameters.options,o)}static fromJSON(o,c){const d=[];for(let y=0,w=o.shapes.length;y<w;y++)d.push(c[o.shapes[y]]);const p=o.options.extrudePath;return void 0!==p&&(o.options.extrudePath=(new Qx[p.type]).fromJSON(p)),new Mu(d,o.options)}}const RM={generateTopUV:function(g,o,c,d,p){const M=o[3*d],R=o[3*d+1],A=o[3*p],N=o[3*p+1];return[new Be(o[3*c],o[3*c+1]),new Be(M,R),new Be(A,N)]},generateSideWallUV:function(g,o,c,d,p,y){const w=o[3*c],M=o[3*c+1],R=o[3*c+2],A=o[3*d],N=o[3*d+1],U=o[3*d+2],q=o[3*p],Y=o[3*p+1],ne=o[3*p+2],le=o[3*y],Se=o[3*y+1],re=o[3*y+2];return Math.abs(M-N)<Math.abs(w-A)?[new Be(w,1-R),new Be(A,1-U),new Be(q,1-ne),new Be(le,1-re)]:[new Be(M,1-R),new Be(N,1-U),new Be(Y,1-ne),new Be(Se,1-re)]}};class gp extends Df{constructor(o=1,c=0){const d=(1+Math.sqrt(5))/2;super([-1,d,0,1,d,0,-1,-d,0,1,-d,0,0,-1,d,0,1,d,0,-1,-d,0,1,-d,d,0,-1,d,0,1,-d,0,-1,-d,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],o,c),this.type="IcosahedronGeometry",this.parameters={radius:o,detail:c}}static fromJSON(o){return new gp(o.radius,o.detail)}}class _p extends gt{constructor(o=[new Be(0,.5),new Be(.5,0),new Be(0,-.5)],c=12,d=0,p=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:o,segments:c,phiStart:d,phiLength:p},c=Math.floor(c),p=Ur(p,0,2*Math.PI);const y=[],w=[],M=[],R=[],A=[],N=1/c,U=new Ne,q=new Be,Y=new Ne,ne=new Ne,le=new Ne;let Se=0,re=0;for(let K=0;K<=o.length-1;K++)switch(K){case 0:Se=o[K+1].x-o[K].x,re=o[K+1].y-o[K].y,Y.x=1*re,Y.y=-Se,Y.z=0*re,le.copy(Y),Y.normalize(),R.push(Y.x,Y.y,Y.z);break;case o.length-1:R.push(le.x,le.y,le.z);break;default:Se=o[K+1].x-o[K].x,re=o[K+1].y-o[K].y,Y.x=1*re,Y.y=-Se,Y.z=0*re,ne.copy(Y),Y.x+=le.x,Y.y+=le.y,Y.z+=le.z,Y.normalize(),R.push(Y.x,Y.y,Y.z),le.copy(ne)}for(let K=0;K<=c;K++){const Oe=d+K*N*p,xe=Math.sin(Oe),ze=Math.cos(Oe);for(let $e=0;$e<=o.length-1;$e++)U.x=o[$e].x*xe,U.y=o[$e].y,U.z=o[$e].x*ze,w.push(U.x,U.y,U.z),q.x=K/c,q.y=$e/(o.length-1),M.push(q.x,q.y),A.push(R[3*$e+0]*xe,R[3*$e+1],R[3*$e+0]*ze)}for(let K=0;K<c;K++)for(let Oe=0;Oe<o.length-1;Oe++){const xe=Oe+K*o.length,$e=xe+o.length,ht=xe+o.length+1,Et=xe+1;y.push(xe,$e,Et),y.push(ht,Et,$e)}this.setIndex(y),this.setAttribute("position",new Wn(w,3)),this.setAttribute("uv",new Wn(M,2)),this.setAttribute("normal",new Wn(A,3))}static fromJSON(o){return new _p(o.points,o.segments,o.phiStart,o.phiLength)}}class yp extends Df{constructor(o=1,c=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],o,c),this.type="OctahedronGeometry",this.parameters={radius:o,detail:c}}static fromJSON(o){return new yp(o.radius,o.detail)}}class F_ extends gt{constructor(o=.5,c=1,d=8,p=1,y=0,w=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:o,outerRadius:c,thetaSegments:d,phiSegments:p,thetaStart:y,thetaLength:w},d=Math.max(3,d);const M=[],R=[],A=[],N=[];let U=o;const q=(c-o)/(p=Math.max(1,p)),Y=new Ne,ne=new Be;for(let le=0;le<=p;le++){for(let Se=0;Se<=d;Se++){const re=y+Se/d*w;Y.x=U*Math.cos(re),Y.y=U*Math.sin(re),R.push(Y.x,Y.y,Y.z),A.push(0,0,1),ne.x=(Y.x/c+1)/2,ne.y=(Y.y/c+1)/2,N.push(ne.x,ne.y)}U+=q}for(let le=0;le<p;le++){const Se=le*(d+1);for(let re=0;re<d;re++){const K=re+Se,xe=K+d+1,ze=K+d+2,$e=K+1;M.push(K,xe,$e),M.push(xe,ze,$e)}}this.setIndex(M),this.setAttribute("position",new Wn(R,3)),this.setAttribute("normal",new Wn(A,3)),this.setAttribute("uv",new Wn(N,2))}static fromJSON(o){return new F_(o.innerRadius,o.outerRadius,o.thetaSegments,o.phiSegments,o.thetaStart,o.thetaLength)}}class Sm extends gt{constructor(o=new Th([new Be(0,.5),new Be(-.5,-.5),new Be(.5,-.5)]),c=12){super(),this.type="ShapeGeometry",this.parameters={shapes:o,curveSegments:c};const d=[],p=[],y=[],w=[];let M=0,R=0;if(!1===Array.isArray(o))A(o);else for(let N=0;N<o.length;N++)A(o[N]),this.addGroup(M,R,N),M+=R,R=0;function A(N){const U=p.length/3,q=N.extractPoints(c);let Y=q.shape;const ne=q.holes;!1===$u.isClockWise(Y)&&(Y=Y.reverse());for(let Se=0,re=ne.length;Se<re;Se++){const K=ne[Se];!0===$u.isClockWise(K)&&(ne[Se]=K.reverse())}const le=$u.triangulateShape(Y,ne);for(let Se=0,re=ne.length;Se<re;Se++)Y=Y.concat(ne[Se]);for(let Se=0,re=Y.length;Se<re;Se++){const K=Y[Se];p.push(K.x,K.y,0),y.push(0,0,1),w.push(K.x,K.y)}for(let Se=0,re=le.length;Se<re;Se++){const K=le[Se];d.push(K[0]+U,K[1]+U,K[2]+U),R+=3}}this.setIndex(d),this.setAttribute("position",new Wn(p,3)),this.setAttribute("normal",new Wn(y,3)),this.setAttribute("uv",new Wn(w,2))}toJSON(){const o=super.toJSON();return function kM(g,o){if(o.shapes=[],Array.isArray(g))for(let c=0,d=g.length;c<d;c++)o.shapes.push(g[c].uuid);else o.shapes.push(g.uuid);return o}(this.parameters.shapes,o)}static fromJSON(o,c){const d=[];for(let p=0,y=o.shapes.length;p<y;p++)d.push(c[o.shapes[p]]);return new Sm(d,o.curveSegments)}}class B_ extends gt{constructor(o=1,c=32,d=16,p=0,y=2*Math.PI,w=0,M=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:o,widthSegments:c,heightSegments:d,phiStart:p,phiLength:y,thetaStart:w,thetaLength:M},c=Math.max(3,Math.floor(c)),d=Math.max(2,Math.floor(d));const R=Math.min(w+M,Math.PI);let A=0;const N=[],U=new Ne,q=new Ne,Y=[],ne=[],le=[],Se=[];for(let re=0;re<=d;re++){const K=[],Oe=re/d;let xe=0;0==re&&0==w?xe=.5/c:re==d&&R==Math.PI&&(xe=-.5/c);for(let ze=0;ze<=c;ze++){const $e=ze/c;U.x=-o*Math.cos(p+$e*y)*Math.sin(w+Oe*M),U.y=o*Math.cos(w+Oe*M),U.z=o*Math.sin(p+$e*y)*Math.sin(w+Oe*M),ne.push(U.x,U.y,U.z),q.copy(U).normalize(),le.push(q.x,q.y,q.z),Se.push($e+xe,1-Oe),K.push(A++)}N.push(K)}for(let re=0;re<d;re++)for(let K=0;K<c;K++){const Oe=N[re][K+1],xe=N[re][K],ze=N[re+1][K],$e=N[re+1][K+1];(0!==re||w>0)&&Y.push(Oe,xe,$e),(re!==d-1||R<Math.PI)&&Y.push(xe,ze,$e)}this.setIndex(Y),this.setAttribute("position",new Wn(ne,3)),this.setAttribute("normal",new Wn(le,3)),this.setAttribute("uv",new Wn(Se,2))}static fromJSON(o){return new B_(o.radius,o.widthSegments,o.heightSegments,o.phiStart,o.phiLength,o.thetaStart,o.thetaLength)}}class N_ extends Df{constructor(o=1,c=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],o,c),this.type="TetrahedronGeometry",this.parameters={radius:o,detail:c}}static fromJSON(o){return new N_(o.radius,o.detail)}}class Cm extends gt{constructor(o=1,c=.4,d=8,p=6,y=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:o,tube:c,radialSegments:d,tubularSegments:p,arc:y},d=Math.floor(d),p=Math.floor(p);const w=[],M=[],R=[],A=[],N=new Ne,U=new Ne,q=new Ne;for(let Y=0;Y<=d;Y++)for(let ne=0;ne<=p;ne++){const le=ne/p*y,Se=Y/d*Math.PI*2;U.x=(o+c*Math.cos(Se))*Math.cos(le),U.y=(o+c*Math.cos(Se))*Math.sin(le),U.z=c*Math.sin(Se),M.push(U.x,U.y,U.z),N.x=o*Math.cos(le),N.y=o*Math.sin(le),q.subVectors(U,N).normalize(),R.push(q.x,q.y,q.z),A.push(ne/p),A.push(Y/d)}for(let Y=1;Y<=d;Y++)for(let ne=1;ne<=p;ne++){const Se=(p+1)*(Y-1)+ne-1,re=(p+1)*(Y-1)+ne,K=(p+1)*Y+ne;w.push((p+1)*Y+ne-1,Se,K),w.push(Se,re,K)}this.setIndex(w),this.setAttribute("position",new Wn(M,3)),this.setAttribute("normal",new Wn(R,3)),this.setAttribute("uv",new Wn(A,2))}static fromJSON(o){return new Cm(o.radius,o.tube,o.radialSegments,o.tubularSegments,o.arc)}}class Mm extends gt{constructor(o=1,c=.4,d=64,p=8,y=2,w=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:o,tube:c,tubularSegments:d,radialSegments:p,p:y,q:w},d=Math.floor(d),p=Math.floor(p);const M=[],R=[],A=[],N=[],U=new Ne,q=new Ne,Y=new Ne,ne=new Ne,le=new Ne,Se=new Ne,re=new Ne;for(let Oe=0;Oe<=d;++Oe){const xe=Oe/d*y*Math.PI*2;K(xe,y,w,o,Y),K(xe+.01,y,w,o,ne),Se.subVectors(ne,Y),re.addVectors(ne,Y),le.crossVectors(Se,re),re.crossVectors(le,Se),le.normalize(),re.normalize();for(let ze=0;ze<=p;++ze){const $e=ze/p*Math.PI*2,ht=-c*Math.cos($e),Et=c*Math.sin($e);U.x=Y.x+(ht*re.x+Et*le.x),U.y=Y.y+(ht*re.y+Et*le.y),U.z=Y.z+(ht*re.z+Et*le.z),R.push(U.x,U.y,U.z),q.subVectors(U,Y).normalize(),A.push(q.x,q.y,q.z),N.push(Oe/d),N.push(ze/p)}}for(let Oe=1;Oe<=d;Oe++)for(let xe=1;xe<=p;xe++){const $e=(p+1)*Oe+(xe-1),ht=(p+1)*Oe+xe,Et=(p+1)*(Oe-1)+xe;M.push((p+1)*(Oe-1)+(xe-1),$e,Et),M.push($e,ht,Et)}function K(Oe,xe,ze,$e,ht){const Et=Math.cos(Oe),ci=Math.sin(Oe),Yt=ze/xe*Oe,Pe=Math.cos(Yt);ht.x=$e*(2+Pe)*.5*Et,ht.y=$e*(2+Pe)*ci*.5,ht.z=$e*Math.sin(Yt)*.5}this.setIndex(M),this.setAttribute("position",new Wn(R,3)),this.setAttribute("normal",new Wn(A,3)),this.setAttribute("uv",new Wn(N,2))}static fromJSON(o){return new Mm(o.radius,o.tube,o.tubularSegments,o.radialSegments,o.p,o.q)}}class Tm extends gt{constructor(o=new ib(new Ne(-1,-1,0),new Ne(-1,1,0),new Ne(1,1,0)),c=64,d=1,p=8,y=!1){super(),this.type="TubeGeometry",this.parameters={path:o,tubularSegments:c,radius:d,radialSegments:p,closed:y};const w=o.computeFrenetFrames(c,y);this.tangents=w.tangents,this.normals=w.normals,this.binormals=w.binormals;const M=new Ne,R=new Ne,A=new Be;let N=new Ne;const U=[],q=[],Y=[],ne=[];function Se(Oe){N=o.getPointAt(Oe/c,N);const xe=w.normals[Oe],ze=w.binormals[Oe];for(let $e=0;$e<=p;$e++){const ht=$e/p*Math.PI*2,Et=Math.sin(ht),ci=-Math.cos(ht);R.x=ci*xe.x+Et*ze.x,R.y=ci*xe.y+Et*ze.y,R.z=ci*xe.z+Et*ze.z,R.normalize(),q.push(R.x,R.y,R.z),M.x=N.x+d*R.x,M.y=N.y+d*R.y,M.z=N.z+d*R.z,U.push(M.x,M.y,M.z)}}(function le(){for(let Oe=0;Oe<c;Oe++)Se(Oe);Se(!1===y?c:0),function K(){for(let Oe=0;Oe<=c;Oe++)for(let xe=0;xe<=p;xe++)A.x=Oe/c,A.y=xe/p,Y.push(A.x,A.y)}(),function re(){for(let Oe=1;Oe<=c;Oe++)for(let xe=1;xe<=p;xe++){const $e=(p+1)*Oe+(xe-1),ht=(p+1)*Oe+xe,Et=(p+1)*(Oe-1)+xe;ne.push((p+1)*(Oe-1)+(xe-1),$e,Et),ne.push($e,ht,Et)}}()})(),this.setIndex(ne),this.setAttribute("position",new Wn(U,3)),this.setAttribute("normal",new Wn(q,3)),this.setAttribute("uv",new Wn(Y,2))}toJSON(){const o=super.toJSON();return o.path=this.parameters.path.toJSON(),o}static fromJSON(o){return new Tm((new Qx[o.path.type]).fromJSON(o.path),o.tubularSegments,o.radius,o.radialSegments,o.closed)}}class ew extends gt{constructor(o=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:o},null!==o){const c=[],d=new Set,p=new Ne,y=new Ne;if(null!==o.index){const w=o.attributes.position,M=o.index;let R=o.groups;0===R.length&&(R=[{start:0,count:M.count,materialIndex:0}]);for(let A=0,N=R.length;A<N;++A){const U=R[A],q=U.start;for(let ne=q,le=q+U.count;ne<le;ne+=3)for(let Se=0;Se<3;Se++){const re=M.getX(ne+Se),K=M.getX(ne+(Se+1)%3);p.fromBufferAttribute(w,re),y.fromBufferAttribute(w,K),!0===PM(p,y,d)&&(c.push(p.x,p.y,p.z),c.push(y.x,y.y,y.z))}}}else{const w=o.attributes.position;for(let M=0,R=w.count/3;M<R;M++)for(let A=0;A<3;A++){const U=3*M+(A+1)%3;p.fromBufferAttribute(w,3*M+A),y.fromBufferAttribute(w,U),!0===PM(p,y,d)&&(c.push(p.x,p.y,p.z),c.push(y.x,y.y,y.z))}}this.setAttribute("position",new Wn(c,3))}}}function PM(g,o,c){const d=`${g.x},${g.y},${g.z}-${o.x},${o.y},${o.z}`,p=`${o.x},${o.y},${o.z}-${g.x},${g.y},${g.z}`;return!0!==c.has(d)&&!0!==c.has(p)&&(c.add(d,p),!0)}var kd=Object.freeze({__proto__:null,BoxGeometry:xh,BoxBufferGeometry:xh,CircleGeometry:Zv,CircleBufferGeometry:Zv,ConeGeometry:Yv,ConeBufferGeometry:Yv,CylinderGeometry:xm,CylinderBufferGeometry:xm,DodecahedronGeometry:Su,DodecahedronBufferGeometry:Su,EdgesGeometry:qx,ExtrudeGeometry:Mu,ExtrudeBufferGeometry:Mu,IcosahedronGeometry:gp,IcosahedronBufferGeometry:gp,LatheGeometry:_p,LatheBufferGeometry:_p,OctahedronGeometry:yp,OctahedronBufferGeometry:yp,PlaneGeometry:wd,PlaneBufferGeometry:wd,PolyhedronGeometry:Df,PolyhedronBufferGeometry:Df,RingGeometry:F_,RingBufferGeometry:F_,ShapeGeometry:Sm,ShapeBufferGeometry:Sm,SphereGeometry:B_,SphereBufferGeometry:B_,TetrahedronGeometry:N_,TetrahedronBufferGeometry:N_,TorusGeometry:Cm,TorusBufferGeometry:Cm,TorusKnotGeometry:Mm,TorusKnotBufferGeometry:Mm,TubeGeometry:Tm,TubeBufferGeometry:Tm,WireframeGeometry:ew});class H_ extends da{constructor(o){super(),this.type="ShadowMaterial",this.color=new cn(0),this.transparent=!0,this.setValues(o)}copy(o){return super.copy(o),this.color.copy(o.color),this}}H_.prototype.isShadowMaterial=!0;class tw extends da{constructor(o){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new cn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new cn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Be(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(o)}copy(o){return super.copy(o),this.defines={STANDARD:""},this.color.copy(o.color),this.roughness=o.roughness,this.metalness=o.metalness,this.map=o.map,this.lightMap=o.lightMap,this.lightMapIntensity=o.lightMapIntensity,this.aoMap=o.aoMap,this.aoMapIntensity=o.aoMapIntensity,this.emissive.copy(o.emissive),this.emissiveMap=o.emissiveMap,this.emissiveIntensity=o.emissiveIntensity,this.bumpMap=o.bumpMap,this.bumpScale=o.bumpScale,this.normalMap=o.normalMap,this.normalMapType=o.normalMapType,this.normalScale.copy(o.normalScale),this.displacementMap=o.displacementMap,this.displacementScale=o.displacementScale,this.displacementBias=o.displacementBias,this.roughnessMap=o.roughnessMap,this.metalnessMap=o.metalnessMap,this.alphaMap=o.alphaMap,this.envMap=o.envMap,this.envMapIntensity=o.envMapIntensity,this.refractionRatio=o.refractionRatio,this.wireframe=o.wireframe,this.wireframeLinewidth=o.wireframeLinewidth,this.wireframeLinecap=o.wireframeLinecap,this.wireframeLinejoin=o.wireframeLinejoin,this.flatShading=o.flatShading,this}}tw.prototype.isMeshStandardMaterial=!0;class IM extends tw{constructor(o){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Be(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Ur(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(c){this.ior=(1+.4*c)/(1-.4*c)}}),this.sheenColor=new cn(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new cn(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new cn(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._transmission=0,this.setValues(o)}get sheen(){return this._sheen}set sheen(o){this._sheen>0!=o>0&&this.version++,this._sheen=o}get clearcoat(){return this._clearcoat}set clearcoat(o){this._clearcoat>0!=o>0&&this.version++,this._clearcoat=o}get transmission(){return this._transmission}set transmission(o){this._transmission>0!=o>0&&this.version++,this._transmission=o}copy(o){return super.copy(o),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=o.clearcoat,this.clearcoatMap=o.clearcoatMap,this.clearcoatRoughness=o.clearcoatRoughness,this.clearcoatRoughnessMap=o.clearcoatRoughnessMap,this.clearcoatNormalMap=o.clearcoatNormalMap,this.clearcoatNormalScale.copy(o.clearcoatNormalScale),this.ior=o.ior,this.sheen=o.sheen,this.sheenColor.copy(o.sheenColor),this.sheenColorMap=o.sheenColorMap,this.sheenRoughness=o.sheenRoughness,this.sheenRoughnessMap=o.sheenRoughnessMap,this.transmission=o.transmission,this.transmissionMap=o.transmissionMap,this.thickness=o.thickness,this.thicknessMap=o.thicknessMap,this.attenuationDistance=o.attenuationDistance,this.attenuationColor.copy(o.attenuationColor),this.specularIntensity=o.specularIntensity,this.specularIntensityMap=o.specularIntensityMap,this.specularColor.copy(o.specularColor),this.specularColorMap=o.specularColorMap,this}}IM.prototype.isMeshPhysicalMaterial=!0;class hD extends da{constructor(o){super(),this.type="MeshPhongMaterial",this.color=new cn(16777215),this.specular=new cn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new cn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Be(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(o)}copy(o){return super.copy(o),this.color.copy(o.color),this.specular.copy(o.specular),this.shininess=o.shininess,this.map=o.map,this.lightMap=o.lightMap,this.lightMapIntensity=o.lightMapIntensity,this.aoMap=o.aoMap,this.aoMapIntensity=o.aoMapIntensity,this.emissive.copy(o.emissive),this.emissiveMap=o.emissiveMap,this.emissiveIntensity=o.emissiveIntensity,this.bumpMap=o.bumpMap,this.bumpScale=o.bumpScale,this.normalMap=o.normalMap,this.normalMapType=o.normalMapType,this.normalScale.copy(o.normalScale),this.displacementMap=o.displacementMap,this.displacementScale=o.displacementScale,this.displacementBias=o.displacementBias,this.specularMap=o.specularMap,this.alphaMap=o.alphaMap,this.envMap=o.envMap,this.combine=o.combine,this.reflectivity=o.reflectivity,this.refractionRatio=o.refractionRatio,this.wireframe=o.wireframe,this.wireframeLinewidth=o.wireframeLinewidth,this.wireframeLinecap=o.wireframeLinecap,this.wireframeLinejoin=o.wireframeLinejoin,this.flatShading=o.flatShading,this}}hD.prototype.isMeshPhongMaterial=!0;class lb extends da{constructor(o){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new cn(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new cn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Be(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(o)}copy(o){return super.copy(o),this.color.copy(o.color),this.map=o.map,this.gradientMap=o.gradientMap,this.lightMap=o.lightMap,this.lightMapIntensity=o.lightMapIntensity,this.aoMap=o.aoMap,this.aoMapIntensity=o.aoMapIntensity,this.emissive.copy(o.emissive),this.emissiveMap=o.emissiveMap,this.emissiveIntensity=o.emissiveIntensity,this.bumpMap=o.bumpMap,this.bumpScale=o.bumpScale,this.normalMap=o.normalMap,this.normalMapType=o.normalMapType,this.normalScale.copy(o.normalScale),this.displacementMap=o.displacementMap,this.displacementScale=o.displacementScale,this.displacementBias=o.displacementBias,this.alphaMap=o.alphaMap,this.wireframe=o.wireframe,this.wireframeLinewidth=o.wireframeLinewidth,this.wireframeLinecap=o.wireframeLinecap,this.wireframeLinejoin=o.wireframeLinejoin,this}}lb.prototype.isMeshToonMaterial=!0;class iw extends da{constructor(o){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Be(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.flatShading=!1,this.setValues(o)}copy(o){return super.copy(o),this.bumpMap=o.bumpMap,this.bumpScale=o.bumpScale,this.normalMap=o.normalMap,this.normalMapType=o.normalMapType,this.normalScale.copy(o.normalScale),this.displacementMap=o.displacementMap,this.displacementScale=o.displacementScale,this.displacementBias=o.displacementBias,this.wireframe=o.wireframe,this.wireframeLinewidth=o.wireframeLinewidth,this.flatShading=o.flatShading,this}}iw.prototype.isMeshNormalMaterial=!0;class cb extends da{constructor(o){super(),this.type="MeshLambertMaterial",this.color=new cn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new cn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(o)}copy(o){return super.copy(o),this.color.copy(o.color),this.map=o.map,this.lightMap=o.lightMap,this.lightMapIntensity=o.lightMapIntensity,this.aoMap=o.aoMap,this.aoMapIntensity=o.aoMapIntensity,this.emissive.copy(o.emissive),this.emissiveMap=o.emissiveMap,this.emissiveIntensity=o.emissiveIntensity,this.specularMap=o.specularMap,this.alphaMap=o.alphaMap,this.envMap=o.envMap,this.combine=o.combine,this.reflectivity=o.reflectivity,this.refractionRatio=o.refractionRatio,this.wireframe=o.wireframe,this.wireframeLinewidth=o.wireframeLinewidth,this.wireframeLinecap=o.wireframeLinecap,this.wireframeLinejoin=o.wireframeLinejoin,this}}cb.prototype.isMeshLambertMaterial=!0;class Em extends da{constructor(o){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new cn(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Be(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.setValues(o)}copy(o){return super.copy(o),this.defines={MATCAP:""},this.color.copy(o.color),this.matcap=o.matcap,this.map=o.map,this.bumpMap=o.bumpMap,this.bumpScale=o.bumpScale,this.normalMap=o.normalMap,this.normalMapType=o.normalMapType,this.normalScale.copy(o.normalScale),this.displacementMap=o.displacementMap,this.displacementScale=o.displacementScale,this.displacementBias=o.displacementBias,this.alphaMap=o.alphaMap,this.flatShading=o.flatShading,this}}Em.prototype.isMeshMatcapMaterial=!0;class LM extends ol{constructor(o){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(o)}copy(o){return super.copy(o),this.scale=o.scale,this.dashSize=o.dashSize,this.gapSize=o.gapSize,this}}LM.prototype.isLineDashedMaterial=!0;var OM=Object.freeze({__proto__:null,ShadowMaterial:H_,SpriteMaterial:Uv,RawShaderMaterial:Rv,ShaderMaterial:yd,PointsMaterial:E_,MeshPhysicalMaterial:IM,MeshStandardMaterial:tw,MeshPhongMaterial:hD,MeshToonMaterial:lb,MeshNormalMaterial:iw,MeshLambertMaterial:cb,MeshDepthMaterial:Td,MeshDistanceMaterial:Hv,MeshBasicMaterial:fa,MeshMatcapMaterial:Em,LineDashedMaterial:LM,LineBasicMaterial:ol,Material:da});const Uo={arraySlice:function(g,o,c){return Uo.isTypedArray(g)?new g.constructor(g.subarray(o,void 0!==c?c:g.length)):g.slice(o,c)},convertArray:function(g,o,c){return!g||!c&&g.constructor===o?g:"number"==typeof o.BYTES_PER_ELEMENT?new o(g):Array.prototype.slice.call(g)},isTypedArray:function(g){return ArrayBuffer.isView(g)&&!(g instanceof DataView)},getKeyframeOrder:function(g){const c=g.length,d=new Array(c);for(let p=0;p!==c;++p)d[p]=p;return d.sort(function o(p,y){return g[p]-g[y]}),d},sortedArray:function(g,o,c){const d=g.length,p=new g.constructor(d);for(let y=0,w=0;w!==d;++y){const M=c[y]*o;for(let R=0;R!==o;++R)p[w++]=g[M+R]}return p},flattenJSON:function(g,o,c,d){let p=1,y=g[0];for(;void 0!==y&&void 0===y[d];)y=g[p++];if(void 0===y)return;let w=y[d];if(void 0!==w)if(Array.isArray(w))do{w=y[d],void 0!==w&&(o.push(y.time),c.push.apply(c,w)),y=g[p++]}while(void 0!==y);else if(void 0!==w.toArray)do{w=y[d],void 0!==w&&(o.push(y.time),w.toArray(c,c.length)),y=g[p++]}while(void 0!==y);else do{w=y[d],void 0!==w&&(o.push(y.time),c.push(w)),y=g[p++]}while(void 0!==y)},subclip:function(g,o,c,d,p=30){const y=g.clone();y.name=o;const w=[];for(let R=0;R<y.tracks.length;++R){const A=y.tracks[R],N=A.getValueSize(),U=[],q=[];for(let Y=0;Y<A.times.length;++Y){const ne=A.times[Y]*p;if(!(ne<c||ne>=d)){U.push(A.times[Y]);for(let le=0;le<N;++le)q.push(A.values[Y*N+le])}}0!==U.length&&(A.times=Uo.convertArray(U,A.times.constructor),A.values=Uo.convertArray(q,A.values.constructor),w.push(A))}y.tracks=w;let M=1/0;for(let R=0;R<y.tracks.length;++R)M>y.tracks[R].times[0]&&(M=y.tracks[R].times[0]);for(let R=0;R<y.tracks.length;++R)y.tracks[R].shift(-1*M);return y.resetDuration(),y},makeClipAdditive:function(g,o=0,c=g,d=30){d<=0&&(d=30);const p=c.tracks.length,y=o/d;for(let w=0;w<p;++w){const M=c.tracks[w],R=M.ValueTypeName;if("bool"===R||"string"===R)continue;const A=g.tracks.find(function(re){return re.name===M.name&&re.ValueTypeName===R});if(void 0===A)continue;let N=0;const U=M.getValueSize();M.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(N=U/3);let q=0;const Y=A.getValueSize();A.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(q=Y/3);const ne=M.times.length-1;let le;if(y<=M.times[0])le=Uo.arraySlice(M.values,N,U-N);else if(y>=M.times[ne]){const re=ne*U+N;le=Uo.arraySlice(M.values,re,re+U-N)}else{const re=M.createInterpolant(),K=N,Oe=U-N;re.evaluate(y),le=Uo.arraySlice(re.resultBuffer,K,Oe)}"quaternion"===R&&(new ua).fromArray(le).normalize().conjugate().toArray(le);const Se=A.times.length;for(let re=0;re<Se;++re){const K=re*Y+q;if("quaternion"===R)ua.multiplyQuaternionsFlat(A.values,K,le,0,A.values,K);else{const Oe=Y-2*q;for(let xe=0;xe<Oe;++xe)A.values[K+xe]-=le[xe]}}}return g.blendMode=2501,g}};class Pd{constructor(o,c,d,p){this.parameterPositions=o,this._cachedIndex=0,this.resultBuffer=void 0!==p?p:new c.constructor(d),this.sampleValues=c,this.valueSize=d,this.settings=null,this.DefaultSettings_={}}evaluate(o){const c=this.parameterPositions;let d=this._cachedIndex,p=c[d],y=c[d-1];e:{t:{let w;i:{n:if(!(o<p)){for(let M=d+2;;){if(void 0===p){if(o<y)break n;return d=c.length,this._cachedIndex=d,this.afterEnd_(d-1,o,y)}if(d===M)break;if(y=p,p=c[++d],o<p)break t}w=c.length;break i}if(o>=y)break e;{const M=c[1];o<M&&(d=2,y=M);for(let R=d-2;;){if(void 0===y)return this._cachedIndex=0,this.beforeStart_(0,o,p);if(d===R)break;if(p=y,y=c[--d-1],o>=y)break t}w=d,d=0}}for(;d<w;){const M=d+w>>>1;o<c[M]?w=M:d=M+1}if(p=c[d],y=c[d-1],void 0===y)return this._cachedIndex=0,this.beforeStart_(0,o,p);if(void 0===p)return d=c.length,this._cachedIndex=d,this.afterEnd_(d-1,y,o)}this._cachedIndex=d,this.intervalChanged_(d,y,p)}return this.interpolate_(d,y,o,p)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(o){const c=this.resultBuffer,d=this.sampleValues,p=this.valueSize,y=o*p;for(let w=0;w!==p;++w)c[w]=d[y+w];return c}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}Pd.prototype.beforeStart_=Pd.prototype.copySampleValue_,Pd.prototype.afterEnd_=Pd.prototype.copySampleValue_;class FM extends Pd{constructor(o,c,d,p){super(o,c,d,p),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:rd,endingEnd:rd}}intervalChanged_(o,c,d){const p=this.parameterPositions;let y=o-2,w=o+1,M=p[y],R=p[w];if(void 0===M)switch(this.getSettings_().endingStart){case sd:y=o,M=2*c-d;break;case hu:y=p.length-2,M=c+p[y]-p[y+1];break;default:y=o,M=d}if(void 0===R)switch(this.getSettings_().endingEnd){case sd:w=o,R=2*d-c;break;case hu:w=1,R=d+p[1]-p[0];break;default:w=o-1,R=c}const A=.5*(d-c),N=this.valueSize;this._weightPrev=A/(c-M),this._weightNext=A/(R-d),this._offsetPrev=y*N,this._offsetNext=w*N}interpolate_(o,c,d,p){const y=this.resultBuffer,w=this.sampleValues,M=this.valueSize,R=o*M,A=R-M,N=this._offsetPrev,U=this._offsetNext,q=this._weightPrev,Y=this._weightNext,ne=(d-c)/(p-c),le=ne*ne,Se=le*ne,re=-q*Se+2*q*le-q*ne,K=(1+q)*Se+(-1.5-2*q)*le+(-.5+q)*ne+1,Oe=(-1-Y)*Se+(1.5+Y)*le+.5*ne,xe=Y*Se-Y*le;for(let ze=0;ze!==M;++ze)y[ze]=re*w[N+ze]+K*w[A+ze]+Oe*w[R+ze]+xe*w[U+ze];return y}}class BM extends Pd{constructor(o,c,d,p){super(o,c,d,p)}interpolate_(o,c,d,p){const y=this.resultBuffer,w=this.sampleValues,M=this.valueSize,R=o*M,A=R-M,N=(d-c)/(p-c),U=1-N;for(let q=0;q!==M;++q)y[q]=w[A+q]*U+w[R+q]*N;return y}}class nw extends Pd{constructor(o,c,d,p){super(o,c,d,p)}interpolate_(o){return this.copySampleValue_(o-1)}}class Eh{constructor(o,c,d,p){if(void 0===o)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===c||0===c.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+o);this.name=o,this.times=Uo.convertArray(c,this.TimeBufferType),this.values=Uo.convertArray(d,this.ValueBufferType),this.setInterpolation(p||this.DefaultInterpolation)}static toJSON(o){const c=o.constructor;let d;if(c.toJSON!==this.toJSON)d=c.toJSON(o);else{d={name:o.name,times:Uo.convertArray(o.times,Array),values:Uo.convertArray(o.values,Array)};const p=o.getInterpolation();p!==o.DefaultInterpolation&&(d.interpolation=p)}return d.type=o.ValueTypeName,d}InterpolantFactoryMethodDiscrete(o){return new nw(this.times,this.values,this.getValueSize(),o)}InterpolantFactoryMethodLinear(o){return new BM(this.times,this.values,this.getValueSize(),o)}InterpolantFactoryMethodSmooth(o){return new FM(this.times,this.values,this.getValueSize(),o)}setInterpolation(o){let c;switch(o){case yr:c=this.InterpolantFactoryMethodDiscrete;break;case la:c=this.InterpolantFactoryMethodLinear;break;case 2302:c=this.InterpolantFactoryMethodSmooth}if(void 0===c){const d="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(o===this.DefaultInterpolation)throw new Error(d);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",d),this}return this.createInterpolant=c,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return yr;case this.InterpolantFactoryMethodLinear:return la;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(o){if(0!==o){const c=this.times;for(let d=0,p=c.length;d!==p;++d)c[d]+=o}return this}scale(o){if(1!==o){const c=this.times;for(let d=0,p=c.length;d!==p;++d)c[d]*=o}return this}trim(o,c){const d=this.times,p=d.length;let y=0,w=p-1;for(;y!==p&&d[y]<o;)++y;for(;-1!==w&&d[w]>c;)--w;if(++w,0!==y||w!==p){y>=w&&(w=Math.max(w,1),y=w-1);const M=this.getValueSize();this.times=Uo.arraySlice(d,y,w),this.values=Uo.arraySlice(this.values,y*M,w*M)}return this}validate(){let o=!0;const c=this.getValueSize();c-Math.floor(c)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),o=!1);const d=this.times,p=this.values,y=d.length;0===y&&(console.error("THREE.KeyframeTrack: Track is empty.",this),o=!1);let w=null;for(let M=0;M!==y;M++){const R=d[M];if("number"==typeof R&&isNaN(R)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,M,R),o=!1;break}if(null!==w&&w>R){console.error("THREE.KeyframeTrack: Out of order keys.",this,M,R,w),o=!1;break}w=R}if(void 0!==p&&Uo.isTypedArray(p))for(let M=0,R=p.length;M!==R;++M){const A=p[M];if(isNaN(A)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,M,A),o=!1;break}}return o}optimize(){const o=Uo.arraySlice(this.times),c=Uo.arraySlice(this.values),d=this.getValueSize(),p=2302===this.getInterpolation(),y=o.length-1;let w=1;for(let M=1;M<y;++M){let R=!1;const A=o[M];if(A!==o[M+1]&&(1!==M||A!==o[0]))if(p)R=!0;else{const U=M*d,q=U-d,Y=U+d;for(let ne=0;ne!==d;++ne){const le=c[U+ne];if(le!==c[q+ne]||le!==c[Y+ne]){R=!0;break}}}if(R){if(M!==w){o[w]=o[M];const U=M*d,q=w*d;for(let Y=0;Y!==d;++Y)c[q+Y]=c[U+Y]}++w}}if(y>0){o[w]=o[y];for(let M=y*d,R=w*d,A=0;A!==d;++A)c[R+A]=c[M+A];++w}return w!==o.length?(this.times=Uo.arraySlice(o,0,w),this.values=Uo.arraySlice(c,0,w*d)):(this.times=o,this.values=c),this}clone(){const o=Uo.arraySlice(this.times,0),c=Uo.arraySlice(this.values,0),p=new(0,this.constructor)(this.name,o,c);return p.createInterpolant=this.createInterpolant,p}}Eh.prototype.TimeBufferType=Float32Array,Eh.prototype.ValueBufferType=Float32Array,Eh.prototype.DefaultInterpolation=la;class Am extends Eh{}Am.prototype.ValueTypeName="bool",Am.prototype.ValueBufferType=Array,Am.prototype.DefaultInterpolation=yr,Am.prototype.InterpolantFactoryMethodLinear=void 0,Am.prototype.InterpolantFactoryMethodSmooth=void 0;class rw extends Eh{}rw.prototype.ValueTypeName="color";class Id extends Eh{}Id.prototype.ValueTypeName="number";class NM extends Pd{constructor(o,c,d,p){super(o,c,d,p)}interpolate_(o,c,d,p){const y=this.resultBuffer,w=this.sampleValues,M=this.valueSize,R=(d-c)/(p-c);let A=o*M;for(let N=A+M;A!==N;A+=4)ua.slerpFlat(y,0,w,A-M,w,A,R);return y}}class V_ extends Eh{InterpolantFactoryMethodLinear(o){return new NM(this.times,this.values,this.getValueSize(),o)}}V_.prototype.ValueTypeName="quaternion",V_.prototype.DefaultInterpolation=la,V_.prototype.InterpolantFactoryMethodSmooth=void 0;class Dm extends Eh{}Dm.prototype.ValueTypeName="string",Dm.prototype.ValueBufferType=Array,Dm.prototype.DefaultInterpolation=yr,Dm.prototype.InterpolantFactoryMethodLinear=void 0,Dm.prototype.InterpolantFactoryMethodSmooth=void 0;class Ld extends Eh{}Ld.prototype.ValueTypeName="vector";class ub{constructor(o,c=-1,d,p=2500){this.name=o,this.tracks=d,this.duration=c,this.blendMode=p,this.uuid=tl(),this.duration<0&&this.resetDuration()}static parse(o){const c=[],d=o.tracks,p=1/(o.fps||1);for(let w=0,M=d.length;w!==M;++w)c.push(hF(d[w]).scale(p));const y=new this(o.name,o.duration,c,o.blendMode);return y.uuid=o.uuid,y}static toJSON(o){const c=[],d=o.tracks,p={name:o.name,duration:o.duration,tracks:c,uuid:o.uuid,blendMode:o.blendMode};for(let y=0,w=d.length;y!==w;++y)c.push(Eh.toJSON(d[y]));return p}static CreateFromMorphTargetSequence(o,c,d,p){const y=c.length,w=[];for(let M=0;M<y;M++){let R=[],A=[];R.push((M+y-1)%y,M,(M+1)%y),A.push(0,1,0);const N=Uo.getKeyframeOrder(R);R=Uo.sortedArray(R,1,N),A=Uo.sortedArray(A,1,N),!p&&0===R[0]&&(R.push(y),A.push(A[0])),w.push(new Id(".morphTargetInfluences["+c[M].name+"]",R,A).scale(1/d))}return new this(o,-1,w)}static findByName(o,c){let d=o;if(!Array.isArray(o)){const p=o;d=p.geometry&&p.geometry.animations||p.animations}for(let p=0;p<d.length;p++)if(d[p].name===c)return d[p];return null}static CreateClipsFromMorphTargetSequences(o,c,d){const p={},y=/^([\w-]*?)([\d]+)$/;for(let M=0,R=o.length;M<R;M++){const A=o[M],N=A.name.match(y);if(N&&N.length>1){const U=N[1];let q=p[U];q||(p[U]=q=[]),q.push(A)}}const w=[];for(const M in p)w.push(this.CreateFromMorphTargetSequence(M,p[M],c,d));return w}static parseAnimation(o,c){if(!o)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const d=function(U,q,Y,ne,le){if(0!==Y.length){const Se=[],re=[];Uo.flattenJSON(Y,Se,re,ne),0!==Se.length&&le.push(new U(q,Se,re))}},p=[],y=o.name||"default",w=o.fps||30,M=o.blendMode;let R=o.length||-1;const A=o.hierarchy||[];for(let U=0;U<A.length;U++){const q=A[U].keys;if(q&&0!==q.length)if(q[0].morphTargets){const Y={};let ne;for(ne=0;ne<q.length;ne++)if(q[ne].morphTargets)for(let le=0;le<q[ne].morphTargets.length;le++)Y[q[ne].morphTargets[le]]=-1;for(const le in Y){const Se=[],re=[];for(let K=0;K!==q[ne].morphTargets.length;++K){const Oe=q[ne];Se.push(Oe.time),re.push(Oe.morphTarget===le?1:0)}p.push(new Id(".morphTargetInfluence["+le+"]",Se,re))}R=Y.length*(w||1)}else{const Y=".bones["+c[U].name+"]";d(Ld,Y+".position",q,"pos",p),d(V_,Y+".quaternion",q,"rot",p),d(Ld,Y+".scale",q,"scl",p)}}return 0===p.length?null:new this(y,R,p,M)}resetDuration(){let c=0;for(let d=0,p=this.tracks.length;d!==p;++d){const y=this.tracks[d];c=Math.max(c,y.times[y.times.length-1])}return this.duration=c,this}trim(){for(let o=0;o<this.tracks.length;o++)this.tracks[o].trim(0,this.duration);return this}validate(){let o=!0;for(let c=0;c<this.tracks.length;c++)o=o&&this.tracks[c].validate();return o}optimize(){for(let o=0;o<this.tracks.length;o++)this.tracks[o].optimize();return this}clone(){const o=[];for(let c=0;c<this.tracks.length;c++)o.push(this.tracks[c].clone());return new this.constructor(this.name,this.duration,o,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function hF(g){if(void 0===g.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const o=function uF(g){switch(g.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Id;case"vector":case"vector2":case"vector3":case"vector4":return Ld;case"color":return rw;case"quaternion":return V_;case"bool":case"boolean":return Am;case"string":return Dm}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+g)}(g.type);if(void 0===g.times){const c=[],d=[];Uo.flattenJSON(g.keys,c,d,"value"),g.times=c,g.values=d}return void 0!==o.parse?o.parse(g):new o(g.name,g.times,g.values,g.interpolation)}const Rm={enabled:!1,files:{},add:function(g,o){!1!==this.enabled&&(this.files[g]=o)},get:function(g){if(!1!==this.enabled)return this.files[g]},remove:function(g){delete this.files[g]},clear:function(){this.files={}}};class Os{constructor(o,c,d){const p=this;let R,y=!1,w=0,M=0;const A=[];this.onStart=void 0,this.onLoad=o,this.onProgress=c,this.onError=d,this.itemStart=function(N){M++,!1===y&&void 0!==p.onStart&&p.onStart(N,w,M),y=!0},this.itemEnd=function(N){w++,void 0!==p.onProgress&&p.onProgress(N,w,M),w===M&&(y=!1,void 0!==p.onLoad&&p.onLoad())},this.itemError=function(N){void 0!==p.onError&&p.onError(N)},this.resolveURL=function(N){return R?R(N):N},this.setURLModifier=function(N){return R=N,this},this.addHandler=function(N,U){return A.push(N,U),this},this.removeHandler=function(N){const U=A.indexOf(N);return-1!==U&&A.splice(U,2),this},this.getHandler=function(N){for(let U=0,q=A.length;U<q;U+=2){const Y=A[U],ne=A[U+1];if(Y.global&&(Y.lastIndex=0),Y.test(N))return ne}return null}}}const sw=new Os;class Ec{constructor(o){this.manager=void 0!==o?o:sw,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(o,c){const d=this;return new Promise(function(p,y){d.load(o,p,c,y)})}parse(){}setCrossOrigin(o){return this.crossOrigin=o,this}setWithCredentials(o){return this.withCredentials=o,this}setPath(o){return this.path=o,this}setResourcePath(o){return this.resourcePath=o,this}setRequestHeader(o){return this.requestHeader=o,this}}const Od={};class Ah extends Ec{constructor(o){super(o)}load(o,c,d,p){void 0===o&&(o=""),void 0!==this.path&&(o=this.path+o),o=this.manager.resolveURL(o);const y=Rm.get(o);if(void 0!==y)return this.manager.itemStart(o),setTimeout(()=>{c&&c(y),this.manager.itemEnd(o)},0),y;if(void 0!==Od[o])return void Od[o].push({onLoad:c,onProgress:d,onError:p});Od[o]=[],Od[o].push({onLoad:c,onProgress:d,onError:p});const w=new Request(o,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),M=this.mimeType,R=this.responseType;fetch(w).then(A=>{if(200===A.status||0===A.status){if(0===A.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"==typeof ReadableStream||void 0===A.body.getReader)return A;const N=Od[o],U=A.body.getReader(),q=A.headers.get("Content-Length"),Y=q?parseInt(q):0,ne=0!==Y;let le=0;const Se=new ReadableStream({start(re){!function K(){U.read().then(({done:Oe,value:xe})=>{if(Oe)re.close();else{le+=xe.byteLength;const ze=new ProgressEvent("progress",{lengthComputable:ne,loaded:le,total:Y});for(let $e=0,ht=N.length;$e<ht;$e++){const Et=N[$e];Et.onProgress&&Et.onProgress(ze)}re.enqueue(xe),K()}})}()}});return new Response(Se)}throw Error(`fetch for "${A.url}" responded with ${A.status}: ${A.statusText}`)}).then(A=>{switch(R){case"arraybuffer":return A.arrayBuffer();case"blob":return A.blob();case"document":return A.text().then(N=>(new DOMParser).parseFromString(N,M));case"json":return A.json();default:if(void 0===M)return A.text();{const U=/charset="?([^;"\s]*)"?/i.exec(M),q=U&&U[1]?U[1].toLowerCase():void 0,Y=new TextDecoder(q);return A.arrayBuffer().then(ne=>Y.decode(ne))}}}).then(A=>{Rm.add(o,A);const N=Od[o];delete Od[o];for(let U=0,q=N.length;U<q;U++){const Y=N[U];Y.onLoad&&Y.onLoad(A)}}).catch(A=>{const N=Od[o];if(void 0===N)throw this.manager.itemError(o),A;delete Od[o];for(let U=0,q=N.length;U<q;U++){const Y=N[U];Y.onError&&Y.onError(A)}this.manager.itemError(o)}).finally(()=>{this.manager.itemEnd(o)}),this.manager.itemStart(o)}setResponseType(o){return this.responseType=o,this}setMimeType(o){return this.mimeType=o,this}}class hb extends Ec{constructor(o){super(o)}load(o,c,d,p){void 0!==this.path&&(o=this.path+o),o=this.manager.resolveURL(o);const y=this,w=Rm.get(o);if(void 0!==w)return y.manager.itemStart(o),setTimeout(function(){c&&c(w),y.manager.itemEnd(o)},0),w;const M=Bl("img");function R(){N(),Rm.add(o,this),c&&c(this),y.manager.itemEnd(o)}function A(U){N(),p&&p(U),y.manager.itemError(o),y.manager.itemEnd(o)}function N(){M.removeEventListener("load",R,!1),M.removeEventListener("error",A,!1)}return M.addEventListener("load",R,!1),M.addEventListener("error",A,!1),"data:"!==o.substr(0,5)&&void 0!==this.crossOrigin&&(M.crossOrigin=this.crossOrigin),y.manager.itemStart(o),M.src=o,M}}class fD extends Ec{constructor(o){super(o)}load(o,c,d,p){const y=new r_,w=new hb(this.manager);w.setCrossOrigin(this.crossOrigin),w.setPath(this.path);let M=0;function R(A){w.load(o[A],function(N){y.images[A]=N,M++,6===M&&(y.needsUpdate=!0,c&&c(y))},void 0,p)}for(let A=0;A<o.length;++A)R(A);return y}}class pD extends Ec{constructor(o){super(o)}load(o,c,d,p){const y=this,w=new Tf,M=new Ah(this.manager);return M.setResponseType("arraybuffer"),M.setRequestHeader(this.requestHeader),M.setPath(this.path),M.setWithCredentials(y.withCredentials),M.load(o,function(R){const A=y.parse(R);!A||(void 0!==A.image?w.image=A.image:void 0!==A.data&&(w.image.width=A.width,w.image.height=A.height,w.image.data=A.data),w.wrapS=void 0!==A.wrapS?A.wrapS:Lo,w.wrapT=void 0!==A.wrapT?A.wrapT:Lo,w.magFilter=void 0!==A.magFilter?A.magFilter:tt,w.minFilter=void 0!==A.minFilter?A.minFilter:tt,w.anisotropy=void 0!==A.anisotropy?A.anisotropy:1,void 0!==A.encoding&&(w.encoding=A.encoding),void 0!==A.flipY&&(w.flipY=A.flipY),void 0!==A.format&&(w.format=A.format),void 0!==A.type&&(w.type=A.type),void 0!==A.mipmaps&&(w.mipmaps=A.mipmaps,w.minFilter=Gi),1===A.mipmapCount&&(w.minFilter=tt),void 0!==A.generateMipmaps&&(w.generateMipmaps=A.generateMipmaps),w.needsUpdate=!0,c&&c(w,A))},d,p),w}}class HM extends Ec{constructor(o){super(o)}load(o,c,d,p){const y=new Jr,w=new hb(this.manager);return w.setCrossOrigin(this.crossOrigin),w.setPath(this.path),w.load(o,function(M){y.image=M,y.needsUpdate=!0,void 0!==c&&c(y)},d,p),y}}class Fd extends _t{constructor(o,c=1){super(),this.type="Light",this.color=new cn(o),this.intensity=c}dispose(){}copy(o){return super.copy(o),this.color.copy(o.color),this.intensity=o.intensity,this}toJSON(o){const c=super.toJSON(o);return c.object.color=this.color.getHex(),c.object.intensity=this.intensity,void 0!==this.groundColor&&(c.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(c.object.distance=this.distance),void 0!==this.angle&&(c.object.angle=this.angle),void 0!==this.decay&&(c.object.decay=this.decay),void 0!==this.penumbra&&(c.object.penumbra=this.penumbra),void 0!==this.shadow&&(c.object.shadow=this.shadow.toJSON()),c}}Fd.prototype.isLight=!0;class ow extends Fd{constructor(o,c,d){super(o,d),this.type="HemisphereLight",this.position.copy(_t.DefaultUp),this.updateMatrix(),this.groundColor=new cn(c)}copy(o){return Fd.prototype.copy.call(this,o),this.groundColor.copy(o.groundColor),this}}ow.prototype.isHemisphereLight=!0;const mD=new Mn,gD=new Ne,fF=new Ne;class _D{constructor(o){this.camera=o,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Be(512,512),this.map=null,this.mapPass=null,this.matrix=new Mn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new bv,this._frameExtents=new Be(1,1),this._viewportCount=1,this._viewports=[new Es(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(o){const c=this.camera,d=this.matrix;gD.setFromMatrixPosition(o.matrixWorld),c.position.copy(gD),fF.setFromMatrixPosition(o.target.matrixWorld),c.lookAt(fF),c.updateMatrixWorld(),mD.multiplyMatrices(c.projectionMatrix,c.matrixWorldInverse),this._frustum.setFromProjectionMatrix(mD),d.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),d.multiply(c.projectionMatrix),d.multiply(c.matrixWorldInverse)}getViewport(o){return this._viewports[o]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(o){return this.camera=o.camera.clone(),this.bias=o.bias,this.radius=o.radius,this.mapSize.copy(o.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const o={};return 0!==this.bias&&(o.bias=this.bias),0!==this.normalBias&&(o.normalBias=this.normalBias),1!==this.radius&&(o.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(o.mapSize=this.mapSize.toArray()),o.camera=this.camera.toJSON(!1).object,delete o.camera.matrix,o}}class aw extends _D{constructor(){super(new vl(50,1,.5,500)),this.focus=1}updateMatrices(o){const c=this.camera,d=2*ff*o.angle*this.focus,p=this.mapSize.width/this.mapSize.height,y=o.distance||c.far;(d!==c.fov||p!==c.aspect||y!==c.far)&&(c.fov=d,c.aspect=p,c.far=y,c.updateProjectionMatrix()),super.updateMatrices(o)}copy(o){return super.copy(o),this.focus=o.focus,this}}aw.prototype.isSpotLightShadow=!0;class VM extends Fd{constructor(o,c,d=0,p=Math.PI/3,y=0,w=1){super(o,c),this.type="SpotLight",this.position.copy(_t.DefaultUp),this.updateMatrix(),this.target=new _t,this.distance=d,this.angle=p,this.penumbra=y,this.decay=w,this.shadow=new aw}get power(){return this.intensity*Math.PI}set power(o){this.intensity=o/Math.PI}dispose(){this.shadow.dispose()}copy(o){return super.copy(o),this.distance=o.distance,this.angle=o.angle,this.penumbra=o.penumbra,this.decay=o.decay,this.target=o.target.clone(),this.shadow=o.shadow.clone(),this}}VM.prototype.isSpotLight=!0;const zM=new Mn,z_=new Ne,yD=new Ne;class eh extends _D{constructor(){super(new vl(90,1,.5,500)),this._frameExtents=new Be(4,2),this._viewportCount=6,this._viewports=[new Es(2,1,1,1),new Es(0,1,1,1),new Es(3,1,1,1),new Es(1,1,1,1),new Es(3,0,1,1),new Es(1,0,1,1)],this._cubeDirections=[new Ne(1,0,0),new Ne(-1,0,0),new Ne(0,0,1),new Ne(0,0,-1),new Ne(0,1,0),new Ne(0,-1,0)],this._cubeUps=[new Ne(0,1,0),new Ne(0,1,0),new Ne(0,1,0),new Ne(0,1,0),new Ne(0,0,1),new Ne(0,0,-1)]}updateMatrices(o,c=0){const d=this.camera,p=this.matrix,y=o.distance||d.far;y!==d.far&&(d.far=y,d.updateProjectionMatrix()),z_.setFromMatrixPosition(o.matrixWorld),d.position.copy(z_),yD.copy(d.position),yD.add(this._cubeDirections[c]),d.up.copy(this._cubeUps[c]),d.lookAt(yD),d.updateMatrixWorld(),p.makeTranslation(-z_.x,-z_.y,-z_.z),zM.multiplyMatrices(d.projectionMatrix,d.matrixWorldInverse),this._frustum.setFromProjectionMatrix(zM)}}eh.prototype.isPointLightShadow=!0;class vD extends Fd{constructor(o,c,d=0,p=1){super(o,c),this.type="PointLight",this.distance=d,this.decay=p,this.shadow=new eh}get power(){return 4*this.intensity*Math.PI}set power(o){this.intensity=o/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(o){return super.copy(o),this.distance=o.distance,this.decay=o.decay,this.shadow=o.shadow.clone(),this}}vD.prototype.isPointLight=!0;class pF extends _D{constructor(){super(new Dv(-5,5,5,-5,.5,500))}}pF.prototype.isDirectionalLightShadow=!0;class lw extends Fd{constructor(o,c){super(o,c),this.type="DirectionalLight",this.position.copy(_t.DefaultUp),this.updateMatrix(),this.target=new _t,this.shadow=new pF}dispose(){this.shadow.dispose()}copy(o){return super.copy(o),this.target=o.target.clone(),this.shadow=o.shadow.clone(),this}}lw.prototype.isDirectionalLight=!0;class cw extends Fd{constructor(o,c){super(o,c),this.type="AmbientLight"}}cw.prototype.isAmbientLight=!0;class uw extends Fd{constructor(o,c,d=10,p=10){super(o,c),this.type="RectAreaLight",this.width=d,this.height=p}get power(){return this.intensity*this.width*this.height*Math.PI}set power(o){this.intensity=o/(this.width*this.height*Math.PI)}copy(o){return super.copy(o),this.width=o.width,this.height=o.height,this}toJSON(o){const c=super.toJSON(o);return c.object.width=this.width,c.object.height=this.height,c}}uw.prototype.isRectAreaLight=!0;class UM{constructor(){this.coefficients=[];for(let o=0;o<9;o++)this.coefficients.push(new Ne)}set(o){for(let c=0;c<9;c++)this.coefficients[c].copy(o[c]);return this}zero(){for(let o=0;o<9;o++)this.coefficients[o].set(0,0,0);return this}getAt(o,c){const d=o.x,p=o.y,y=o.z,w=this.coefficients;return c.copy(w[0]).multiplyScalar(.282095),c.addScaledVector(w[1],.488603*p),c.addScaledVector(w[2],.488603*y),c.addScaledVector(w[3],.488603*d),c.addScaledVector(w[4],d*p*1.092548),c.addScaledVector(w[5],p*y*1.092548),c.addScaledVector(w[6],.315392*(3*y*y-1)),c.addScaledVector(w[7],d*y*1.092548),c.addScaledVector(w[8],.546274*(d*d-p*p)),c}getIrradianceAt(o,c){const d=o.x,p=o.y,y=o.z,w=this.coefficients;return c.copy(w[0]).multiplyScalar(.886227),c.addScaledVector(w[1],1.023328*p),c.addScaledVector(w[2],1.023328*y),c.addScaledVector(w[3],1.023328*d),c.addScaledVector(w[4],.858086*d*p),c.addScaledVector(w[5],.858086*p*y),c.addScaledVector(w[6],.743125*y*y-.247708),c.addScaledVector(w[7],.858086*d*y),c.addScaledVector(w[8],.429043*(d*d-p*p)),c}add(o){for(let c=0;c<9;c++)this.coefficients[c].add(o.coefficients[c]);return this}addScaledSH(o,c){for(let d=0;d<9;d++)this.coefficients[d].addScaledVector(o.coefficients[d],c);return this}scale(o){for(let c=0;c<9;c++)this.coefficients[c].multiplyScalar(o);return this}lerp(o,c){for(let d=0;d<9;d++)this.coefficients[d].lerp(o.coefficients[d],c);return this}equals(o){for(let c=0;c<9;c++)if(!this.coefficients[c].equals(o.coefficients[c]))return!1;return!0}copy(o){return this.set(o.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(o,c=0){const d=this.coefficients;for(let p=0;p<9;p++)d[p].fromArray(o,c+3*p);return this}toArray(o=[],c=0){const d=this.coefficients;for(let p=0;p<9;p++)d[p].toArray(o,c+3*p);return o}static getBasisAt(o,c){const d=o.x,p=o.y,y=o.z;c[0]=.282095,c[1]=.488603*p,c[2]=.488603*y,c[3]=.488603*d,c[4]=1.092548*d*p,c[5]=1.092548*p*y,c[6]=.315392*(3*y*y-1),c[7]=1.092548*d*y,c[8]=.546274*(d*d-p*p)}}UM.prototype.isSphericalHarmonics3=!0;class hw extends Fd{constructor(o=new UM,c=1){super(void 0,c),this.sh=o}copy(o){return super.copy(o),this.sh.copy(o.sh),this}fromJSON(o){return this.intensity=o.intensity,this.sh.fromArray(o.sh),this}toJSON(o){const c=super.toJSON(o);return c.object.sh=this.sh.toArray(),c}}hw.prototype.isLightProbe=!0;class GM extends Ec{constructor(o){super(o),this.textures={}}load(o,c,d,p){const y=this,w=new Ah(y.manager);w.setPath(y.path),w.setRequestHeader(y.requestHeader),w.setWithCredentials(y.withCredentials),w.load(o,function(M){try{c(y.parse(JSON.parse(M)))}catch(R){p?p(R):console.error(R),y.manager.itemError(o)}},d,p)}parse(o){const c=this.textures;function d(y){return void 0===c[y]&&console.warn("THREE.MaterialLoader: Undefined texture",y),c[y]}const p=new OM[o.type];if(void 0!==o.uuid&&(p.uuid=o.uuid),void 0!==o.name&&(p.name=o.name),void 0!==o.color&&void 0!==p.color&&p.color.setHex(o.color),void 0!==o.roughness&&(p.roughness=o.roughness),void 0!==o.metalness&&(p.metalness=o.metalness),void 0!==o.sheen&&(p.sheen=o.sheen),void 0!==o.sheenColor&&(p.sheenColor=(new cn).setHex(o.sheenColor)),void 0!==o.sheenRoughness&&(p.sheenRoughness=o.sheenRoughness),void 0!==o.emissive&&void 0!==p.emissive&&p.emissive.setHex(o.emissive),void 0!==o.specular&&void 0!==p.specular&&p.specular.setHex(o.specular),void 0!==o.specularIntensity&&(p.specularIntensity=o.specularIntensity),void 0!==o.specularColor&&void 0!==p.specularColor&&p.specularColor.setHex(o.specularColor),void 0!==o.shininess&&(p.shininess=o.shininess),void 0!==o.clearcoat&&(p.clearcoat=o.clearcoat),void 0!==o.clearcoatRoughness&&(p.clearcoatRoughness=o.clearcoatRoughness),void 0!==o.transmission&&(p.transmission=o.transmission),void 0!==o.thickness&&(p.thickness=o.thickness),void 0!==o.attenuationDistance&&(p.attenuationDistance=o.attenuationDistance),void 0!==o.attenuationColor&&void 0!==p.attenuationColor&&p.attenuationColor.setHex(o.attenuationColor),void 0!==o.fog&&(p.fog=o.fog),void 0!==o.flatShading&&(p.flatShading=o.flatShading),void 0!==o.blending&&(p.blending=o.blending),void 0!==o.combine&&(p.combine=o.combine),void 0!==o.side&&(p.side=o.side),void 0!==o.shadowSide&&(p.shadowSide=o.shadowSide),void 0!==o.opacity&&(p.opacity=o.opacity),void 0!==o.transparent&&(p.transparent=o.transparent),void 0!==o.alphaTest&&(p.alphaTest=o.alphaTest),void 0!==o.depthTest&&(p.depthTest=o.depthTest),void 0!==o.depthWrite&&(p.depthWrite=o.depthWrite),void 0!==o.colorWrite&&(p.colorWrite=o.colorWrite),void 0!==o.alphaWrite&&(p.alphaWrite=o.alphaWrite),void 0!==o.stencilWrite&&(p.stencilWrite=o.stencilWrite),void 0!==o.stencilWriteMask&&(p.stencilWriteMask=o.stencilWriteMask),void 0!==o.stencilFunc&&(p.stencilFunc=o.stencilFunc),void 0!==o.stencilRef&&(p.stencilRef=o.stencilRef),void 0!==o.stencilFuncMask&&(p.stencilFuncMask=o.stencilFuncMask),void 0!==o.stencilFail&&(p.stencilFail=o.stencilFail),void 0!==o.stencilZFail&&(p.stencilZFail=o.stencilZFail),void 0!==o.stencilZPass&&(p.stencilZPass=o.stencilZPass),void 0!==o.wireframe&&(p.wireframe=o.wireframe),void 0!==o.wireframeLinewidth&&(p.wireframeLinewidth=o.wireframeLinewidth),void 0!==o.wireframeLinecap&&(p.wireframeLinecap=o.wireframeLinecap),void 0!==o.wireframeLinejoin&&(p.wireframeLinejoin=o.wireframeLinejoin),void 0!==o.rotation&&(p.rotation=o.rotation),1!==o.linewidth&&(p.linewidth=o.linewidth),void 0!==o.dashSize&&(p.dashSize=o.dashSize),void 0!==o.gapSize&&(p.gapSize=o.gapSize),void 0!==o.scale&&(p.scale=o.scale),void 0!==o.polygonOffset&&(p.polygonOffset=o.polygonOffset),void 0!==o.polygonOffsetFactor&&(p.polygonOffsetFactor=o.polygonOffsetFactor),void 0!==o.polygonOffsetUnits&&(p.polygonOffsetUnits=o.polygonOffsetUnits),void 0!==o.dithering&&(p.dithering=o.dithering),void 0!==o.alphaToCoverage&&(p.alphaToCoverage=o.alphaToCoverage),void 0!==o.premultipliedAlpha&&(p.premultipliedAlpha=o.premultipliedAlpha),void 0!==o.visible&&(p.visible=o.visible),void 0!==o.toneMapped&&(p.toneMapped=o.toneMapped),void 0!==o.userData&&(p.userData=o.userData),void 0!==o.vertexColors&&(p.vertexColors="number"==typeof o.vertexColors?o.vertexColors>0:o.vertexColors),void 0!==o.uniforms)for(const y in o.uniforms){const w=o.uniforms[y];switch(p.uniforms[y]={},w.type){case"t":p.uniforms[y].value=d(w.value);break;case"c":p.uniforms[y].value=(new cn).setHex(w.value);break;case"v2":p.uniforms[y].value=(new Be).fromArray(w.value);break;case"v3":p.uniforms[y].value=(new Ne).fromArray(w.value);break;case"v4":p.uniforms[y].value=(new Es).fromArray(w.value);break;case"m3":p.uniforms[y].value=(new Hn).fromArray(w.value);break;case"m4":p.uniforms[y].value=(new Mn).fromArray(w.value);break;default:p.uniforms[y].value=w.value}}if(void 0!==o.defines&&(p.defines=o.defines),void 0!==o.vertexShader&&(p.vertexShader=o.vertexShader),void 0!==o.fragmentShader&&(p.fragmentShader=o.fragmentShader),void 0!==o.extensions)for(const y in o.extensions)p.extensions[y]=o.extensions[y];if(void 0!==o.shading&&(p.flatShading=1===o.shading),void 0!==o.size&&(p.size=o.size),void 0!==o.sizeAttenuation&&(p.sizeAttenuation=o.sizeAttenuation),void 0!==o.map&&(p.map=d(o.map)),void 0!==o.matcap&&(p.matcap=d(o.matcap)),void 0!==o.alphaMap&&(p.alphaMap=d(o.alphaMap)),void 0!==o.bumpMap&&(p.bumpMap=d(o.bumpMap)),void 0!==o.bumpScale&&(p.bumpScale=o.bumpScale),void 0!==o.normalMap&&(p.normalMap=d(o.normalMap)),void 0!==o.normalMapType&&(p.normalMapType=o.normalMapType),void 0!==o.normalScale){let y=o.normalScale;!1===Array.isArray(y)&&(y=[y,y]),p.normalScale=(new Be).fromArray(y)}return void 0!==o.displacementMap&&(p.displacementMap=d(o.displacementMap)),void 0!==o.displacementScale&&(p.displacementScale=o.displacementScale),void 0!==o.displacementBias&&(p.displacementBias=o.displacementBias),void 0!==o.roughnessMap&&(p.roughnessMap=d(o.roughnessMap)),void 0!==o.metalnessMap&&(p.metalnessMap=d(o.metalnessMap)),void 0!==o.emissiveMap&&(p.emissiveMap=d(o.emissiveMap)),void 0!==o.emissiveIntensity&&(p.emissiveIntensity=o.emissiveIntensity),void 0!==o.specularMap&&(p.specularMap=d(o.specularMap)),void 0!==o.specularIntensityMap&&(p.specularIntensityMap=d(o.specularIntensityMap)),void 0!==o.specularColorMap&&(p.specularColorMap=d(o.specularColorMap)),void 0!==o.envMap&&(p.envMap=d(o.envMap)),void 0!==o.envMapIntensity&&(p.envMapIntensity=o.envMapIntensity),void 0!==o.reflectivity&&(p.reflectivity=o.reflectivity),void 0!==o.refractionRatio&&(p.refractionRatio=o.refractionRatio),void 0!==o.lightMap&&(p.lightMap=d(o.lightMap)),void 0!==o.lightMapIntensity&&(p.lightMapIntensity=o.lightMapIntensity),void 0!==o.aoMap&&(p.aoMap=d(o.aoMap)),void 0!==o.aoMapIntensity&&(p.aoMapIntensity=o.aoMapIntensity),void 0!==o.gradientMap&&(p.gradientMap=d(o.gradientMap)),void 0!==o.clearcoatMap&&(p.clearcoatMap=d(o.clearcoatMap)),void 0!==o.clearcoatRoughnessMap&&(p.clearcoatRoughnessMap=d(o.clearcoatRoughnessMap)),void 0!==o.clearcoatNormalMap&&(p.clearcoatNormalMap=d(o.clearcoatNormalMap)),void 0!==o.clearcoatNormalScale&&(p.clearcoatNormalScale=(new Be).fromArray(o.clearcoatNormalScale)),void 0!==o.transmissionMap&&(p.transmissionMap=d(o.transmissionMap)),void 0!==o.thicknessMap&&(p.thicknessMap=d(o.thicknessMap)),void 0!==o.sheenColorMap&&(p.sheenColorMap=d(o.sheenColorMap)),void 0!==o.sheenRoughnessMap&&(p.sheenRoughnessMap=d(o.sheenRoughnessMap)),p}setTextures(o){return this.textures=o,this}}class It{static decodeText(o){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(o);let c="";for(let d=0,p=o.length;d<p;d++)c+=String.fromCharCode(o[d]);try{return decodeURIComponent(escape(c))}catch(d){return c}}static extractUrlBase(o){const c=o.lastIndexOf("/");return-1===c?"./":o.substr(0,c+1)}static resolveURL(o,c){return"string"!=typeof o||""===o?"":(/^https?:\/\//i.test(c)&&/^\//.test(o)&&(c=c.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(o)||/^data:.*,.*$/i.test(o)||/^blob:.*$/i.test(o)?o:c+o)}}class WM extends gt{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(o){return super.copy(o),this.instanceCount=o.instanceCount,this}clone(){return(new this.constructor).copy(this)}toJSON(){const o=super.toJSON(this);return o.instanceCount=this.instanceCount,o.isInstancedBufferGeometry=!0,o}}WM.prototype.isInstancedBufferGeometry=!0;class dw extends Ec{constructor(o){super(o)}load(o,c,d,p){const y=this,w=new Ah(y.manager);w.setPath(y.path),w.setRequestHeader(y.requestHeader),w.setWithCredentials(y.withCredentials),w.load(o,function(M){try{c(y.parse(JSON.parse(M)))}catch(R){p?p(R):console.error(R),y.manager.itemError(o)}},d,p)}parse(o){const c={},d={};function p(Y,ne){if(void 0!==c[ne])return c[ne];const Se=Y.interleavedBuffers[ne],re=function y(Y,ne){if(void 0!==d[ne])return d[ne];const re=new Uint32Array(Y.arrayBuffers[ne]).buffer;return d[ne]=re,re}(Y,Se.buffer),K=ml(Se.type,re),Oe=new vm(K,Se.stride);return Oe.uuid=Se.uuid,c[ne]=Oe,Oe}const w=o.isInstancedBufferGeometry?new WM:new gt,M=o.data.index;if(void 0!==M){const Y=ml(M.type,M.array);w.setIndex(new Zn(Y,1))}const R=o.data.attributes;for(const Y in R){const ne=R[Y];let le;if(ne.isInterleavedBufferAttribute){const Se=p(o.data,ne.data);le=new Ed(Se,ne.itemSize,ne.offset,ne.normalized)}else{const Se=ml(ne.type,ne.array);le=new(ne.isInstancedBufferAttribute?Ef:Zn)(Se,ne.itemSize,ne.normalized)}void 0!==ne.name&&(le.name=ne.name),void 0!==ne.usage&&le.setUsage(ne.usage),void 0!==ne.updateRange&&(le.updateRange.offset=ne.updateRange.offset,le.updateRange.count=ne.updateRange.count),w.setAttribute(Y,le)}const A=o.data.morphAttributes;if(A)for(const Y in A){const ne=A[Y],le=[];for(let Se=0,re=ne.length;Se<re;Se++){const K=ne[Se];let Oe;if(K.isInterleavedBufferAttribute){const xe=p(o.data,K.data);Oe=new Ed(xe,K.itemSize,K.offset,K.normalized)}else{const xe=ml(K.type,K.array);Oe=new Zn(xe,K.itemSize,K.normalized)}void 0!==K.name&&(Oe.name=K.name),le.push(Oe)}w.morphAttributes[Y]=le}o.data.morphTargetsRelative&&(w.morphTargetsRelative=!0);const U=o.data.groups||o.data.drawcalls||o.data.offsets;if(void 0!==U)for(let Y=0,ne=U.length;Y!==ne;++Y){const le=U[Y];w.addGroup(le.start,le.count,le.materialIndex)}const q=o.data.boundingSphere;if(void 0!==q){const Y=new Ne;void 0!==q.center&&Y.fromArray(q.center),w.boundingSphere=new pd(Y,q.radius)}return o.name&&(w.name=o.name),o.userData&&(w.userData=o.userData),w}}const gF={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,CubeUVReflectionMapping:306,CubeUVRefractionMapping:307},bD={RepeatWrapping:oa,ClampToEdgeWrapping:Lo,MirroredRepeatWrapping:no},xD={NearestFilter:ro,NearestMipmapNearestFilter:1004,NearestMipmapLinearFilter:1005,LinearFilter:tt,LinearMipmapNearestFilter:1007,LinearMipmapLinearFilter:Gi};class wD extends Ec{constructor(o){super(o),"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(o){return this.options=o,this}load(o,c,d,p){void 0===o&&(o=""),void 0!==this.path&&(o=this.path+o),o=this.manager.resolveURL(o);const y=this,w=Rm.get(o);if(void 0!==w)return y.manager.itemStart(o),setTimeout(function(){c&&c(w),y.manager.itemEnd(o)},0),w;const M={};M.credentials="anonymous"===this.crossOrigin?"same-origin":"include",M.headers=this.requestHeader,fetch(o,M).then(function(R){return R.blob()}).then(function(R){return createImageBitmap(R,Object.assign(y.options,{colorSpaceConversion:"none"}))}).then(function(R){Rm.add(o,R),c&&c(R),y.manager.itemEnd(o)}).catch(function(R){p&&p(R),y.manager.itemError(o),y.manager.itemEnd(o)}),y.manager.itemStart(o)}}let fw;wD.prototype.isImageBitmapLoader=!0;const U_={getContext:function(){return void 0===fw&&(fw=new(window.AudioContext||window.webkitAudioContext)),fw},setContext:function(g){fw=g}};class km extends Ec{constructor(o){super(o)}load(o,c,d,p){const y=this,w=new Ah(this.manager);w.setResponseType("arraybuffer"),w.setPath(this.path),w.setRequestHeader(this.requestHeader),w.setWithCredentials(this.withCredentials),w.load(o,function(M){try{const R=M.slice(0);U_.getContext().decodeAudioData(R,function(N){c(N)})}catch(R){p?p(R):console.error(R),y.manager.itemError(o)}},d,p)}}class SD extends hw{constructor(o,c,d=1){super(void 0,d);const p=(new cn).set(o),y=(new cn).set(c),w=new Ne(p.r,p.g,p.b),M=new Ne(y.r,y.g,y.b),R=Math.sqrt(Math.PI),A=R*Math.sqrt(.75);this.sh.coefficients[0].copy(w).add(M).multiplyScalar(R),this.sh.coefficients[1].copy(w).sub(M).multiplyScalar(A)}}SD.prototype.isHemisphereLightProbe=!0;class G_ extends hw{constructor(o,c=1){super(void 0,c);const d=(new cn).set(o);this.sh.coefficients[0].set(d.r,d.g,d.b).multiplyScalar(2*Math.sqrt(Math.PI))}}G_.prototype.isAmbientLightProbe=!0;const CD=new Mn,MD=new Mn,Rf=new Mn;class W_{constructor(o=!0){this.autoStart=o,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=cc(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let o=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const c=cc();o=(c-this.oldTime)/1e3,this.oldTime=c,this.elapsedTime+=o}return o}}function cc(){return("undefined"==typeof performance?Date:performance).now()}const Tu=new Ne,db=new ua,th=new Ne,Vi=new Ne;class vp extends _t{constructor(o){super(),this.type="Audio",this.listener=o,this.context=o.context,this.gain=this.context.createGain(),this.gain.connect(o.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(o){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=o,this.connect(),this}setMediaElementSource(o){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(o),this.connect(),this}setMediaStreamSource(o){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(o),this.connect(),this}setBuffer(o){return this.buffer=o,this.sourceType="buffer",this.autoplay&&this.play(),this}play(o=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+o;const c=this.context.createBufferSource();return c.buffer=this.buffer,c.loop=this.loop,c.loopStart=this.loopStart,c.loopEnd=this.loopEnd,c.onended=this.onEnded.bind(this),c.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=c,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let o=1,c=this.filters.length;o<c;o++)this.filters[o-1].connect(this.filters[o]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let o=1,c=this.filters.length;o<c;o++)this.filters[o-1].disconnect(this.filters[o]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(o){return o||(o=[]),!0===this._connected?(this.disconnect(),this.filters=o.slice(),this.connect()):this.filters=o.slice(),this}setDetune(o){if(this.detune=o,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(o){return this.setFilters(o?[o]:[])}setPlaybackRate(o){if(!1!==this.hasPlaybackControl)return this.playbackRate=o,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(o){if(!1!==this.hasPlaybackControl)return this.loop=o,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(o){return this.loopStart=o,this}setLoopEnd(o){return this.loopEnd=o,this}getVolume(){return this.gain.gain.value}setVolume(o){return this.gain.gain.setTargetAtTime(o,this.context.currentTime,.01),this}}const ih=new Ne,Pm=new ua,q_=new Ne,nh=new Ne;class Im{constructor(o,c=2048){this.analyser=o.context.createAnalyser(),this.analyser.fftSize=c,this.data=new Uint8Array(this.analyser.frequencyBinCount),o.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let o=0;const c=this.getFrequencyData();for(let d=0;d<c.length;d++)o+=c[d];return o/c.length}}class Lm{constructor(o,c,d){let p,y,w;switch(this.binding=o,this.valueSize=d,c){case"quaternion":p=this._slerp,y=this._slerpAdditive,w=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*d),this._workIndex=5;break;case"string":case"bool":p=this._select,y=this._select,w=this._setAdditiveIdentityOther,this.buffer=new Array(5*d);break;default:p=this._lerp,y=this._lerpAdditive,w=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*d)}this._mixBufferRegion=p,this._mixBufferRegionAdditive=y,this._setIdentity=w,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(o,c){const d=this.buffer,p=this.valueSize,y=o*p+p;let w=this.cumulativeWeight;if(0===w){for(let M=0;M!==p;++M)d[y+M]=d[M];w=c}else w+=c,this._mixBufferRegion(d,y,0,c/w,p);this.cumulativeWeight=w}accumulateAdditive(o){const c=this.buffer,d=this.valueSize,p=d*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(c,p,0,o,d),this.cumulativeWeightAdditive+=o}apply(o){const c=this.valueSize,d=this.buffer,p=o*c+c,y=this.cumulativeWeight,w=this.cumulativeWeightAdditive,M=this.binding;this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,y<1&&this._mixBufferRegion(d,p,c*this._origIndex,1-y,c),w>0&&this._mixBufferRegionAdditive(d,p,this._addIndex*c,1,c);for(let R=c,A=c+c;R!==A;++R)if(d[R]!==d[R+c]){M.setValue(d,p);break}}saveOriginalState(){const c=this.buffer,d=this.valueSize,p=d*this._origIndex;this.binding.getValue(c,p);for(let y=d,w=p;y!==w;++y)c[y]=c[p+y%d];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){this.binding.setValue(this.buffer,3*this.valueSize)}_setAdditiveIdentityNumeric(){const o=this._addIndex*this.valueSize,c=o+this.valueSize;for(let d=o;d<c;d++)this.buffer[d]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const o=this._origIndex*this.valueSize,c=this._addIndex*this.valueSize;for(let d=0;d<this.valueSize;d++)this.buffer[c+d]=this.buffer[o+d]}_select(o,c,d,p,y){if(p>=.5)for(let w=0;w!==y;++w)o[c+w]=o[d+w]}_slerp(o,c,d,p){ua.slerpFlat(o,c,o,c,o,d,p)}_slerpAdditive(o,c,d,p,y){const w=this._workIndex*y;ua.multiplyQuaternionsFlat(o,w,o,c,o,d),ua.slerpFlat(o,c,o,c,o,w,p)}_lerp(o,c,d,p,y){const w=1-p;for(let M=0;M!==y;++M){const R=c+M;o[R]=o[R]*w+o[d+M]*p}}_lerpAdditive(o,c,d,p,y){for(let w=0;w!==y;++w){const M=c+w;o[M]=o[M]+o[d+w]*p}}}const pw="\\[\\]\\.:\\/",TD=new RegExp("["+pw+"]","g"),mw="[^"+pw+"]",ED="[^"+pw.replace("\\.","")+"]",AD=/((?:WC+[\/:])*)/.source.replace("WC",mw),DD=/(WCOD+)?/.source.replace("WCOD",ED),RD=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",mw),kD=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",mw),PD=new RegExp("^"+AD+DD+RD+kD+"$"),_F=["material","materials","bones"];class Ue{constructor(o,c,d){const p=d||Go.parseTrackName(c);this._targetGroup=o,this._bindings=o.subscribe_(c,p)}getValue(o,c){this.bind();const p=this._bindings[this._targetGroup.nCachedObjects_];void 0!==p&&p.getValue(o,c)}setValue(o,c){const d=this._bindings;for(let p=this._targetGroup.nCachedObjects_,y=d.length;p!==y;++p)d[p].setValue(o,c)}bind(){const o=this._bindings;for(let c=this._targetGroup.nCachedObjects_,d=o.length;c!==d;++c)o[c].bind()}unbind(){const o=this._bindings;for(let c=this._targetGroup.nCachedObjects_,d=o.length;c!==d;++c)o[c].unbind()}}let Go=(()=>{class g{constructor(c,d,p){this.path=d,this.parsedPath=p||g.parseTrackName(d),this.node=g.findNode(c,this.parsedPath.nodeName)||c,this.rootNode=c,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(c,d,p){return c&&c.isAnimationObjectGroup?new g.Composite(c,d,p):new g(c,d,p)}static sanitizeNodeName(c){return c.replace(/\s/g,"_").replace(TD,"")}static parseTrackName(c){const d=PD.exec(c);if(!d)throw new Error("PropertyBinding: Cannot parse trackName: "+c);const p={nodeName:d[2],objectName:d[3],objectIndex:d[4],propertyName:d[5],propertyIndex:d[6]},y=p.nodeName&&p.nodeName.lastIndexOf(".");if(void 0!==y&&-1!==y){const w=p.nodeName.substring(y+1);-1!==_F.indexOf(w)&&(p.nodeName=p.nodeName.substring(0,y),p.objectName=w)}if(null===p.propertyName||0===p.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+c);return p}static findNode(c,d){if(!d||""===d||"."===d||-1===d||d===c.name||d===c.uuid)return c;if(c.skeleton){const p=c.skeleton.getBoneByName(d);if(void 0!==p)return p}if(c.children){const p=function(w){for(let M=0;M<w.length;M++){const R=w[M];if(R.name===d||R.uuid===d)return R;const A=p(R.children);if(A)return A}return null},y=p(c.children);if(y)return y}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(c,d){c[d]=this.targetObject[this.propertyName]}_getValue_array(c,d){const p=this.resolvedProperty;for(let y=0,w=p.length;y!==w;++y)c[d++]=p[y]}_getValue_arrayElement(c,d){c[d]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(c,d){this.resolvedProperty.toArray(c,d)}_setValue_direct(c,d){this.targetObject[this.propertyName]=c[d]}_setValue_direct_setNeedsUpdate(c,d){this.targetObject[this.propertyName]=c[d],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(c,d){this.targetObject[this.propertyName]=c[d],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(c,d){const p=this.resolvedProperty;for(let y=0,w=p.length;y!==w;++y)p[y]=c[d++]}_setValue_array_setNeedsUpdate(c,d){const p=this.resolvedProperty;for(let y=0,w=p.length;y!==w;++y)p[y]=c[d++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(c,d){const p=this.resolvedProperty;for(let y=0,w=p.length;y!==w;++y)p[y]=c[d++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(c,d){this.resolvedProperty[this.propertyIndex]=c[d]}_setValue_arrayElement_setNeedsUpdate(c,d){this.resolvedProperty[this.propertyIndex]=c[d],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(c,d){this.resolvedProperty[this.propertyIndex]=c[d],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(c,d){this.resolvedProperty.fromArray(c,d)}_setValue_fromArray_setNeedsUpdate(c,d){this.resolvedProperty.fromArray(c,d),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(c,d){this.resolvedProperty.fromArray(c,d),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(c,d){this.bind(),this.getValue(c,d)}_setValue_unbound(c,d){this.bind(),this.setValue(c,d)}bind(){let c=this.node;const d=this.parsedPath,p=d.objectName,y=d.propertyName;let w=d.propertyIndex;if(c||(c=g.findNode(this.rootNode,d.nodeName)||this.rootNode,this.node=c),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!c)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(p){let N=d.objectIndex;switch(p){case"materials":if(!c.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!c.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);c=c.material.materials;break;case"bones":if(!c.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);c=c.skeleton.bones;for(let U=0;U<c.length;U++)if(c[U].name===N){N=U;break}break;default:if(void 0===c[p])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);c=c[p]}if(void 0!==N){if(void 0===c[N])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,c);c=c[N]}}const M=c[y];if(void 0===M)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+d.nodeName+"."+y+" but it wasn't found.",c);let R=this.Versioning.None;this.targetObject=c,void 0!==c.needsUpdate?R=this.Versioning.NeedsUpdate:void 0!==c.matrixWorldNeedsUpdate&&(R=this.Versioning.MatrixWorldNeedsUpdate);let A=this.BindingType.Direct;if(void 0!==w){if("morphTargetInfluences"===y){if(!c.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!c.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!c.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==c.morphTargetDictionary[w]&&(w=c.morphTargetDictionary[w])}A=this.BindingType.ArrayElement,this.resolvedProperty=M,this.propertyIndex=w}else void 0!==M.fromArray&&void 0!==M.toArray?(A=this.BindingType.HasFromToArray,this.resolvedProperty=M):Array.isArray(M)?(A=this.BindingType.EntireArray,this.resolvedProperty=M):this.propertyName=y;this.getValue=this.GetterByBindingType[A],this.setValue=this.SetterByBindingTypeAndVersioning[A][R]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return g.Composite=Ue,g})();Go.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Go.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Go.prototype.GetterByBindingType=[Go.prototype._getValue_direct,Go.prototype._getValue_array,Go.prototype._getValue_arrayElement,Go.prototype._getValue_toArray],Go.prototype.SetterByBindingTypeAndVersioning=[[Go.prototype._setValue_direct,Go.prototype._setValue_direct_setNeedsUpdate,Go.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Go.prototype._setValue_array,Go.prototype._setValue_array_setNeedsUpdate,Go.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Go.prototype._setValue_arrayElement,Go.prototype._setValue_arrayElement_setNeedsUpdate,Go.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Go.prototype._setValue_fromArray,Go.prototype._setValue_fromArray_setNeedsUpdate,Go.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class Yo{constructor(){this.uuid=tl(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const o={};this._indicesByUUID=o;for(let d=0,p=arguments.length;d!==p;++d)o[arguments[d].uuid]=d;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const c=this;this.stats={objects:{get total(){return c._objects.length},get inUse(){return this.total-c.nCachedObjects_}},get bindingsPerObject(){return c._bindings.length}}}add(){const o=this._objects,c=this._indicesByUUID,d=this._paths,p=this._parsedPaths,y=this._bindings,w=y.length;let M,R=o.length,A=this.nCachedObjects_;for(let N=0,U=arguments.length;N!==U;++N){const q=arguments[N],Y=q.uuid;let ne=c[Y];if(void 0===ne){ne=R++,c[Y]=ne,o.push(q);for(let le=0,Se=w;le!==Se;++le)y[le].push(new Go(q,d[le],p[le]))}else if(ne<A){M=o[ne];const le=--A,Se=o[le];c[Se.uuid]=ne,o[ne]=Se,c[Y]=le,o[le]=q;for(let re=0,K=w;re!==K;++re){const Oe=y[re];let ze=Oe[ne];Oe[ne]=Oe[le],void 0===ze&&(ze=new Go(q,d[re],p[re])),Oe[le]=ze}}else o[ne]!==M&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=A}remove(){const o=this._objects,c=this._indicesByUUID,d=this._bindings,p=d.length;let y=this.nCachedObjects_;for(let w=0,M=arguments.length;w!==M;++w){const R=arguments[w],A=R.uuid,N=c[A];if(void 0!==N&&N>=y){const U=y++,q=o[U];c[q.uuid]=N,o[N]=q,c[A]=U,o[U]=R;for(let Y=0,ne=p;Y!==ne;++Y){const le=d[Y],re=le[N];le[N]=le[U],le[U]=re}}}this.nCachedObjects_=y}uncache(){const o=this._objects,c=this._indicesByUUID,d=this._bindings,p=d.length;let y=this.nCachedObjects_,w=o.length;for(let M=0,R=arguments.length;M!==R;++M){const N=arguments[M].uuid,U=c[N];if(void 0!==U)if(delete c[N],U<y){const q=--y,Y=o[q],ne=--w,le=o[ne];c[Y.uuid]=U,o[U]=Y,c[le.uuid]=q,o[q]=le,o.pop();for(let Se=0,re=p;Se!==re;++Se){const K=d[Se],xe=K[ne];K[U]=K[q],K[q]=xe,K.pop()}}else{const q=--w,Y=o[q];q>0&&(c[Y.uuid]=U),o[U]=Y,o.pop();for(let ne=0,le=p;ne!==le;++ne){const Se=d[ne];Se[U]=Se[q],Se.pop()}}}this.nCachedObjects_=y}subscribe_(o,c){const d=this._bindingsIndicesByPath;let p=d[o];const y=this._bindings;if(void 0!==p)return y[p];const w=this._paths,M=this._parsedPaths,R=this._objects,N=this.nCachedObjects_,U=new Array(R.length);p=y.length,d[o]=p,w.push(o),M.push(c),y.push(U);for(let q=N,Y=R.length;q!==Y;++q)U[q]=new Go(R[q],o,c);return U}unsubscribe_(o){const c=this._bindingsIndicesByPath,d=c[o];if(void 0!==d){const p=this._paths,y=this._parsedPaths,w=this._bindings,M=w.length-1,R=w[M];c[o[M]]=d,w[d]=R,w.pop(),y[d]=y[M],y.pop(),p[d]=p[M],p.pop()}}}Yo.prototype.isAnimationObjectGroup=!0;class ID{constructor(o,c,d=null,p=c.blendMode){this._mixer=o,this._clip=c,this._localRoot=d,this.blendMode=p;const y=c.tracks,w=y.length,M=new Array(w),R={endingStart:rd,endingEnd:rd};for(let A=0;A!==w;++A){const N=y[A].createInterpolant(null);M[A]=N,N.settings=R}this._interpolantSettings=R,this._interpolants=M,this._propertyBindings=new Array(w),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(o){return this._startTime=o,this}setLoop(o,c){return this.loop=o,this.repetitions=c,this}setEffectiveWeight(o){return this.weight=o,this._effectiveWeight=this.enabled?o:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(o){return this._scheduleFading(o,0,1)}fadeOut(o){return this._scheduleFading(o,1,0)}crossFadeFrom(o,c,d){if(o.fadeOut(c),this.fadeIn(c),d){const p=this._clip.duration,y=o._clip.duration,M=p/y;o.warp(1,y/p,c),this.warp(M,1,c)}return this}crossFadeTo(o,c,d){return o.crossFadeFrom(this,c,d)}stopFading(){const o=this._weightInterpolant;return null!==o&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(o)),this}setEffectiveTimeScale(o){return this.timeScale=o,this._effectiveTimeScale=this.paused?0:o,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(o){return this.timeScale=this._clip.duration/o,this.stopWarping()}syncWith(o){return this.time=o.time,this.timeScale=o.timeScale,this.stopWarping()}halt(o){return this.warp(this._effectiveTimeScale,0,o)}warp(o,c,d){const p=this._mixer,y=p.time,w=this.timeScale;let M=this._timeScaleInterpolant;null===M&&(M=p._lendControlInterpolant(),this._timeScaleInterpolant=M);const R=M.parameterPositions,A=M.sampleValues;return R[0]=y,R[1]=y+d,A[0]=o/w,A[1]=c/w,this}stopWarping(){const o=this._timeScaleInterpolant;return null!==o&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(o)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(o,c,d,p){if(!this.enabled)return void this._updateWeight(o);const y=this._startTime;if(null!==y){const R=(o-y)*d;if(R<0||0===d)return;this._startTime=null,c=d*R}c*=this._updateTimeScale(o);const w=this._updateTime(c),M=this._updateWeight(o);if(M>0){const R=this._interpolants,A=this._propertyBindings;if(2501===this.blendMode)for(let N=0,U=R.length;N!==U;++N)R[N].evaluate(w),A[N].accumulateAdditive(M);else for(let N=0,U=R.length;N!==U;++N)R[N].evaluate(w),A[N].accumulate(p,M)}}_updateWeight(o){let c=0;if(this.enabled){c=this.weight;const d=this._weightInterpolant;if(null!==d){const p=d.evaluate(o)[0];c*=p,o>d.parameterPositions[1]&&(this.stopFading(),0===p&&(this.enabled=!1))}}return this._effectiveWeight=c,c}_updateTimeScale(o){let c=0;if(!this.paused){c=this.timeScale;const d=this._timeScaleInterpolant;null!==d&&(c*=d.evaluate(o)[0],o>d.parameterPositions[1]&&(this.stopWarping(),0===c?this.paused=!0:this.timeScale=c))}return this._effectiveTimeScale=c,c}_updateTime(o){const c=this._clip.duration,d=this.loop;let p=this.time+o,y=this._loopCount;const w=2202===d;if(0===o)return-1===y?p:w&&1==(1&y)?c-p:p;if(2200===d){-1===y&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(p>=c)p=c;else{if(!(p<0)){this.time=p;break e}p=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=p,this._mixer.dispatchEvent({type:"finished",action:this,direction:o<0?-1:1})}}else{if(-1===y&&(o>=0?(y=0,this._setEndings(!0,0===this.repetitions,w)):this._setEndings(0===this.repetitions,!0,w)),p>=c||p<0){const M=Math.floor(p/c);p-=c*M,y+=Math.abs(M);const R=this.repetitions-y;if(R<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,p=o>0?c:0,this.time=p,this._mixer.dispatchEvent({type:"finished",action:this,direction:o>0?1:-1});else{if(1===R){const A=o<0;this._setEndings(A,!A,w)}else this._setEndings(!1,!1,w);this._loopCount=y,this.time=p,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:M})}}else this.time=p;if(w&&1==(1&y))return c-p}return p}_setEndings(o,c,d){const p=this._interpolantSettings;d?(p.endingStart=sd,p.endingEnd=sd):(p.endingStart=o?this.zeroSlopeAtStart?sd:rd:hu,p.endingEnd=c?this.zeroSlopeAtEnd?sd:rd:hu)}_scheduleFading(o,c,d){const p=this._mixer,y=p.time;let w=this._weightInterpolant;null===w&&(w=p._lendControlInterpolant(),this._weightInterpolant=w);const M=w.parameterPositions,R=w.sampleValues;return M[0]=y,R[0]=c,M[1]=y+o,R[1]=d,this}}class LD extends Fl{constructor(o){super(),this._root=o,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(o,c){const d=o._localRoot||this._root,p=o._clip.tracks,y=p.length,w=o._propertyBindings,M=o._interpolants,R=d.uuid,A=this._bindingsByRootAndName;let N=A[R];void 0===N&&(N={},A[R]=N);for(let U=0;U!==y;++U){const q=p[U],Y=q.name;let ne=N[Y];if(void 0!==ne)++ne.referenceCount,w[U]=ne;else{if(ne=w[U],void 0!==ne){null===ne._cacheIndex&&(++ne.referenceCount,this._addInactiveBinding(ne,R,Y));continue}ne=new Lm(Go.create(d,Y,c&&c._propertyBindings[U].binding.parsedPath),q.ValueTypeName,q.getValueSize()),++ne.referenceCount,this._addInactiveBinding(ne,R,Y),w[U]=ne}M[U].resultBuffer=ne.buffer}}_activateAction(o){if(!this._isActiveAction(o)){if(null===o._cacheIndex){const d=(o._localRoot||this._root).uuid,p=o._clip.uuid,y=this._actionsByClip[p];this._bindAction(o,y&&y.knownActions[0]),this._addInactiveAction(o,p,d)}const c=o._propertyBindings;for(let d=0,p=c.length;d!==p;++d){const y=c[d];0==y.useCount++&&(this._lendBinding(y),y.saveOriginalState())}this._lendAction(o)}}_deactivateAction(o){if(this._isActiveAction(o)){const c=o._propertyBindings;for(let d=0,p=c.length;d!==p;++d){const y=c[d];0==--y.useCount&&(y.restoreOriginalState(),this._takeBackBinding(y))}this._takeBackAction(o)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const o=this;this.stats={actions:{get total(){return o._actions.length},get inUse(){return o._nActiveActions}},bindings:{get total(){return o._bindings.length},get inUse(){return o._nActiveBindings}},controlInterpolants:{get total(){return o._controlInterpolants.length},get inUse(){return o._nActiveControlInterpolants}}}}_isActiveAction(o){const c=o._cacheIndex;return null!==c&&c<this._nActiveActions}_addInactiveAction(o,c,d){const p=this._actions,y=this._actionsByClip;let w=y[c];if(void 0===w)w={knownActions:[o],actionByRoot:{}},o._byClipCacheIndex=0,y[c]=w;else{const M=w.knownActions;o._byClipCacheIndex=M.length,M.push(o)}o._cacheIndex=p.length,p.push(o),w.actionByRoot[d]=o}_removeInactiveAction(o){const c=this._actions,d=c[c.length-1],p=o._cacheIndex;d._cacheIndex=p,c[p]=d,c.pop(),o._cacheIndex=null;const y=o._clip.uuid,w=this._actionsByClip,M=w[y],R=M.knownActions,A=R[R.length-1],N=o._byClipCacheIndex;A._byClipCacheIndex=N,R[N]=A,R.pop(),o._byClipCacheIndex=null,delete M.actionByRoot[(o._localRoot||this._root).uuid],0===R.length&&delete w[y],this._removeInactiveBindingsForAction(o)}_removeInactiveBindingsForAction(o){const c=o._propertyBindings;for(let d=0,p=c.length;d!==p;++d){const y=c[d];0==--y.referenceCount&&this._removeInactiveBinding(y)}}_lendAction(o){const c=this._actions,d=o._cacheIndex,p=this._nActiveActions++,y=c[p];o._cacheIndex=p,c[p]=o,y._cacheIndex=d,c[d]=y}_takeBackAction(o){const c=this._actions,d=o._cacheIndex,p=--this._nActiveActions,y=c[p];o._cacheIndex=p,c[p]=o,y._cacheIndex=d,c[d]=y}_addInactiveBinding(o,c,d){const p=this._bindingsByRootAndName,y=this._bindings;let w=p[c];void 0===w&&(w={},p[c]=w),w[d]=o,o._cacheIndex=y.length,y.push(o)}_removeInactiveBinding(o){const c=this._bindings,d=o.binding,p=d.rootNode.uuid,y=d.path,w=this._bindingsByRootAndName,M=w[p],R=c[c.length-1],A=o._cacheIndex;R._cacheIndex=A,c[A]=R,c.pop(),delete M[y],0===Object.keys(M).length&&delete w[p]}_lendBinding(o){const c=this._bindings,d=o._cacheIndex,p=this._nActiveBindings++,y=c[p];o._cacheIndex=p,c[p]=o,y._cacheIndex=d,c[d]=y}_takeBackBinding(o){const c=this._bindings,d=o._cacheIndex,p=--this._nActiveBindings,y=c[p];o._cacheIndex=p,c[p]=o,y._cacheIndex=d,c[d]=y}_lendControlInterpolant(){const o=this._controlInterpolants,c=this._nActiveControlInterpolants++;let d=o[c];return void 0===d&&(d=new BM(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),d.__cacheIndex=c,o[c]=d),d}_takeBackControlInterpolant(o){const c=this._controlInterpolants,d=o.__cacheIndex,p=--this._nActiveControlInterpolants,y=c[p];o.__cacheIndex=p,c[p]=o,y.__cacheIndex=d,c[d]=y}clipAction(o,c,d){const p=c||this._root,y=p.uuid;let w="string"==typeof o?ub.findByName(p,o):o;const M=null!==w?w.uuid:o,R=this._actionsByClip[M];let A=null;if(void 0===d&&(d=null!==w?w.blendMode:2500),void 0!==R){const U=R.actionByRoot[y];if(void 0!==U&&U.blendMode===d)return U;A=R.knownActions[0],null===w&&(w=A._clip)}if(null===w)return null;const N=new ID(this,w,c,d);return this._bindAction(N,A),this._addInactiveAction(N,M,y),N}existingAction(o,c){const d=c||this._root,p=d.uuid,y="string"==typeof o?ub.findByName(d,o):o,M=this._actionsByClip[y?y.uuid:o];return void 0!==M&&M.actionByRoot[p]||null}stopAllAction(){const o=this._actions;for(let d=this._nActiveActions-1;d>=0;--d)o[d].stop();return this}update(o){const c=this._actions,d=this._nActiveActions,p=this.time+=o*=this.timeScale,y=Math.sign(o),w=this._accuIndex^=1;for(let A=0;A!==d;++A)c[A]._update(p,o,y,w);const M=this._bindings,R=this._nActiveBindings;for(let A=0;A!==R;++A)M[A].apply(w);return this}setTime(o){this.time=0;for(let c=0;c<this._actions.length;c++)this._actions[c].time=0;return this.update(o)}getRoot(){return this._root}uncacheClip(o){const c=this._actions,d=o.uuid,p=this._actionsByClip,y=p[d];if(void 0!==y){const w=y.knownActions;for(let M=0,R=w.length;M!==R;++M){const A=w[M];this._deactivateAction(A);const N=A._cacheIndex,U=c[c.length-1];A._cacheIndex=null,A._byClipCacheIndex=null,U._cacheIndex=N,c[N]=U,c.pop(),this._removeInactiveBindingsForAction(A)}delete p[d]}}uncacheRoot(o){const c=o.uuid,d=this._actionsByClip;for(const w in d){const R=d[w].actionByRoot[c];void 0!==R&&(this._deactivateAction(R),this._removeInactiveAction(R))}const y=this._bindingsByRootAndName[c];if(void 0!==y)for(const w in y){const M=y[w];M.restoreOriginalState(),this._removeInactiveBinding(M)}}uncacheAction(o,c){const d=this.existingAction(o,c);null!==d&&(this._deactivateAction(d),this._removeInactiveAction(d))}}LD.prototype._controlInterpolantsResultBuffer=new Float32Array(1);class gw{constructor(o){"string"==typeof o&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),o=arguments[1]),this.value=o}clone(){return new gw(void 0===this.value.clone?this.value:this.value.clone())}}class jM extends vm{constructor(o,c,d=1){super(o,c),this.meshPerAttribute=d}copy(o){return super.copy(o),this.meshPerAttribute=o.meshPerAttribute,this}clone(o){const c=super.clone(o);return c.meshPerAttribute=this.meshPerAttribute,c}toJSON(o){const c=super.toJSON(o);return c.isInstancedInterleavedBuffer=!0,c.meshPerAttribute=this.meshPerAttribute,c}}jM.prototype.isInstancedInterleavedBuffer=!0;class OD{constructor(o,c,d,p,y){this.buffer=o,this.type=c,this.itemSize=d,this.elementSize=p,this.count=y,this.version=0}set needsUpdate(o){!0===o&&this.version++}setBuffer(o){return this.buffer=o,this}setType(o,c){return this.type=o,this.elementSize=c,this}setItemSize(o){return this.itemSize=o,this}setCount(o){return this.count=o,this}}function BD(g,o){return g.distance-o.distance}function qM(g,o,c,d){if(g.layers.test(o.layers)&&g.raycast(o,c),!0===d){const p=g.children;for(let y=0,w=p.length;y<w;y++)qM(p[y],o,c,!0)}}OD.prototype.isGLBufferAttribute=!0;const _w=new Be;class bp{constructor(o=new Be(1/0,1/0),c=new Be(-1/0,-1/0)){this.min=o,this.max=c}set(o,c){return this.min.copy(o),this.max.copy(c),this}setFromPoints(o){this.makeEmpty();for(let c=0,d=o.length;c<d;c++)this.expandByPoint(o[c]);return this}setFromCenterAndSize(o,c){const d=_w.copy(c).multiplyScalar(.5);return this.min.copy(o).sub(d),this.max.copy(o).add(d),this}clone(){return(new this.constructor).copy(this)}copy(o){return this.min.copy(o.min),this.max.copy(o.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(o){return this.isEmpty()?o.set(0,0):o.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(o){return this.isEmpty()?o.set(0,0):o.subVectors(this.max,this.min)}expandByPoint(o){return this.min.min(o),this.max.max(o),this}expandByVector(o){return this.min.sub(o),this.max.add(o),this}expandByScalar(o){return this.min.addScalar(-o),this.max.addScalar(o),this}containsPoint(o){return!(o.x<this.min.x||o.x>this.max.x||o.y<this.min.y||o.y>this.max.y)}containsBox(o){return this.min.x<=o.min.x&&o.max.x<=this.max.x&&this.min.y<=o.min.y&&o.max.y<=this.max.y}getParameter(o,c){return c.set((o.x-this.min.x)/(this.max.x-this.min.x),(o.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(o){return!(o.max.x<this.min.x||o.min.x>this.max.x||o.max.y<this.min.y||o.min.y>this.max.y)}clampPoint(o,c){return c.copy(o).clamp(this.min,this.max)}distanceToPoint(o){return _w.copy(o).clamp(this.min,this.max).sub(o).length()}intersect(o){return this.min.max(o.min),this.max.min(o.max),this}union(o){return this.min.min(o.min),this.max.max(o.max),this}translate(o){return this.min.add(o),this.max.add(o),this}equals(o){return o.min.equals(this.min)&&o.max.equals(this.max)}}bp.prototype.isBox2=!0;const ND=new Ne,yw=new Ne;class HD{constructor(o=new Ne,c=new Ne){this.start=o,this.end=c}set(o,c){return this.start.copy(o),this.end.copy(c),this}copy(o){return this.start.copy(o.start),this.end.copy(o.end),this}getCenter(o){return o.addVectors(this.start,this.end).multiplyScalar(.5)}delta(o){return o.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(o,c){return this.delta(c).multiplyScalar(o).add(this.start)}closestPointToPointParameter(o,c){ND.subVectors(o,this.start),yw.subVectors(this.end,this.start);const d=yw.dot(yw);let y=yw.dot(ND)/d;return c&&(y=Ur(y,0,1)),y}closestPointToPoint(o,c,d){const p=this.closestPointToPointParameter(o,c);return this.delta(d).multiplyScalar(p).add(this.start)}applyMatrix4(o){return this.start.applyMatrix4(o),this.end.applyMatrix4(o),this}equals(o){return o.start.equals(this.start)&&o.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}}const VD=new Ne,kf=new Ne,vw=new Mn,XM=new Mn;class Pf extends wu{constructor(o){const c=zD(o),d=new gt,p=[],y=[],w=new cn(0,0,1),M=new cn(0,1,0);for(let A=0;A<c.length;A++){const N=c[A];N.parent&&N.parent.isBone&&(p.push(0,0,0),p.push(0,0,0),y.push(w.r,w.g,w.b),y.push(M.r,M.g,M.b))}d.setAttribute("position",new Wn(p,3)),d.setAttribute("color",new Wn(y,3)),super(d,new ol({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=o,this.bones=c,this.matrix=o.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(o){const c=this.bones,d=this.geometry,p=d.getAttribute("position");XM.copy(this.root.matrixWorld).invert();for(let y=0,w=0;y<c.length;y++){const M=c[y];M.parent&&M.parent.isBone&&(vw.multiplyMatrices(XM,M.matrixWorld),kf.setFromMatrixPosition(vw),p.setXYZ(w,kf.x,kf.y,kf.z),vw.multiplyMatrices(XM,M.parent.matrixWorld),kf.setFromMatrixPosition(vw),p.setXYZ(w+1,kf.x,kf.y,kf.z),w+=2)}d.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(o)}}function zD(g){const o=[];g&&g.isBone&&o.push(g);for(let c=0;c<g.children.length;c++)o.push.apply(o,zD(g.children[c]));return o}const bF=new Ne,ZM=new cn,fb=new cn;class YM extends wu{constructor(o=10,c=10,d=4473924,p=8947848){d=new cn(d),p=new cn(p);const y=c/2,w=o/c,M=o/2,R=[],A=[];for(let q=0,Y=0,ne=-M;q<=c;q++,ne+=w){R.push(-M,0,ne,M,0,ne),R.push(ne,0,-M,ne,0,M);const le=q===y?d:p;le.toArray(A,Y),Y+=3,le.toArray(A,Y),Y+=3,le.toArray(A,Y),Y+=3,le.toArray(A,Y),Y+=3}const N=new gt;N.setAttribute("position",new Wn(R,3)),N.setAttribute("color",new Wn(A,3)),super(N,new ol({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}const GD=new Ne,bw=new Ne,WD=new Ne,pb=new Ne,Aa=new n_;function Da(g,o,c,d,p,y,w){pb.set(p,y,w).unproject(d);const M=o[g];if(void 0!==M){const R=c.getAttribute("position");for(let A=0,N=M.length;A<N;A++)R.setXYZ(M[A],pb.x,pb.y,pb.z)}}const Z_=new Ma;class Y_ extends wu{constructor(o,c=16776960){const d=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),p=new Float32Array(24),y=new gt;y.setIndex(new Zn(d,1)),y.setAttribute("position",new Zn(p,3)),super(y,new ol({color:c,toneMapped:!1})),this.object=o,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(o){if(void 0!==o&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&Z_.setFromObject(this.object),Z_.isEmpty())return;const c=Z_.min,d=Z_.max,p=this.geometry.attributes.position,y=p.array;y[0]=d.x,y[1]=d.y,y[2]=d.z,y[3]=c.x,y[4]=d.y,y[5]=d.z,y[6]=c.x,y[7]=c.y,y[8]=d.z,y[9]=d.x,y[10]=c.y,y[11]=d.z,y[12]=d.x,y[13]=d.y,y[14]=c.z,y[15]=c.x,y[16]=d.y,y[17]=c.z,y[18]=c.x,y[19]=c.y,y[20]=c.z,y[21]=d.x,y[22]=c.y,y[23]=c.z,p.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(o){return this.object=o,this.update(),this}copy(o){return wu.prototype.copy.call(this,o),this.object=o.object,this}}const qD=new Ne;let B,Nd;class xw extends wu{constructor(o=1){const c=[0,0,0,o,0,0,0,0,0,0,o,0,0,0,0,0,0,o],p=new gt;p.setAttribute("position",new Wn(c,3)),p.setAttribute("color",new Wn([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),super(p,new ol({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(o,c,d){const p=new cn,y=this.geometry.attributes.color.array;return p.set(o),p.toArray(y,0),p.toArray(y,3),p.set(c),p.toArray(y,6),p.toArray(y,9),p.set(d),p.toArray(y,12),p.toArray(y,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}const Z=new Float32Array(1),J=new Int32Array(Z.buffer);jc.create=function(g,o){return console.log("THREE.Curve.create() has been deprecated"),g.prototype=Object.create(jc.prototype),g.prototype.constructor=g,g.prototype.getPoint=o,g},nb.prototype.fromPoints=function(g){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(g)},YM.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Pf.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Ec.prototype.extractUrlBase=function(g){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),It.extractUrlBase(g)},Ec.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},bp.prototype.center=function(g){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(g)},bp.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},bp.prototype.isIntersectionBox=function(g){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(g)},bp.prototype.size=function(g){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(g)},Ma.prototype.center=function(g){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(g)},Ma.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Ma.prototype.isIntersectionBox=function(g){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(g)},Ma.prototype.isIntersectionSphere=function(g){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(g)},Ma.prototype.size=function(g){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(g)},pd.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},bv.prototype.setFromMatrix=function(g){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(g)},HD.prototype.center=function(g){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(g)},Hn.prototype.flattenToArrayOffset=function(g,o){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(g,o)},Hn.prototype.multiplyVector3=function(g){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),g.applyMatrix3(this)},Hn.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},Hn.prototype.applyToBufferAttribute=function(g){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),g.applyMatrix3(this)},Hn.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},Hn.prototype.getInverse=function(g){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(g).invert()},Mn.prototype.extractPosition=function(g){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(g)},Mn.prototype.flattenToArrayOffset=function(g,o){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(g,o)},Mn.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new Ne).setFromMatrixColumn(this,3)},Mn.prototype.setRotationFromQuaternion=function(g){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(g)},Mn.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},Mn.prototype.multiplyVector3=function(g){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),g.applyMatrix4(this)},Mn.prototype.multiplyVector4=function(g){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),g.applyMatrix4(this)},Mn.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},Mn.prototype.rotateAxis=function(g){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),g.transformDirection(this)},Mn.prototype.crossVector=function(g){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),g.applyMatrix4(this)},Mn.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},Mn.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},Mn.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},Mn.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},Mn.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},Mn.prototype.applyToBufferAttribute=function(g){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),g.applyMatrix4(this)},Mn.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},Mn.prototype.makeFrustum=function(g,o,c,d,p,y){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(g,o,d,c,p,y)},Mn.prototype.getInverse=function(g){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(g).invert()},bd.prototype.isIntersectionLine=function(g){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(g)},ua.prototype.multiplyVector3=function(g){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),g.applyQuaternion(this)},ua.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},yf.prototype.isIntersectionBox=function(g){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(g)},yf.prototype.isIntersectionPlane=function(g){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(g)},yf.prototype.isIntersectionSphere=function(g){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(g)},ha.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},ha.prototype.barycoordFromPoint=function(g,o){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(g,o)},ha.prototype.midpoint=function(g){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(g)},ha.prototypenormal=function(g){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(g)},ha.prototype.plane=function(g){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(g)},ha.barycoordFromPoint=function(g,o,c,d,p){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),ha.getBarycoord(g,o,c,d,p)},ha.normal=function(g,o,c,d){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),ha.getNormal(g,o,c,d)},Th.prototype.extractAllPoints=function(g){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(g)},Th.prototype.extrude=function(g){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Mu(this,g)},Th.prototype.makeGeometry=function(g){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Sm(this,g)},Be.prototype.fromAttribute=function(g,o,c){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(g,o,c)},Be.prototype.distanceToManhattan=function(g){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(g)},Be.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Ne.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},Ne.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},Ne.prototype.getPositionFromMatrix=function(g){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(g)},Ne.prototype.getScaleFromMatrix=function(g){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(g)},Ne.prototype.getColumnFromMatrix=function(g,o){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(o,g)},Ne.prototype.applyProjection=function(g){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(g)},Ne.prototype.fromAttribute=function(g,o,c){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(g,o,c)},Ne.prototype.distanceToManhattan=function(g){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(g)},Ne.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Es.prototype.fromAttribute=function(g,o,c){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(g,o,c)},Es.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},_t.prototype.getChildByName=function(g){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(g)},_t.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},_t.prototype.translate=function(g,o){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(o,g)},_t.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},_t.prototype.applyMatrix=function(g){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(g)},Object.defineProperties(_t.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(g){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=g}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),sl.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(sl.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),qv.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},vl.prototype.setLens=function(g,o){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==o&&(this.filmGauge=o),this.setFocalLength(g)},Object.defineProperties(Fd.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(g){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=g}},shadowCameraLeft:{set:function(g){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=g}},shadowCameraRight:{set:function(g){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=g}},shadowCameraTop:{set:function(g){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=g}},shadowCameraBottom:{set:function(g){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=g}},shadowCameraNear:{set:function(g){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=g}},shadowCameraFar:{set:function(g){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=g}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(g){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=g}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(g){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=g}},shadowMapHeight:{set:function(g){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=g}}}),Object.defineProperties(Zn.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===df},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(df)}}}),Zn.prototype.setDynamic=function(g){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===g?df:ds),this},Zn.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},Zn.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},gt.prototype.addIndex=function(g){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(g)},gt.prototype.addAttribute=function(g,o){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),o&&o.isBufferAttribute||o&&o.isInterleavedBufferAttribute?"index"===g?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(o),this):this.setAttribute(g,o):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(g,new Zn(arguments[1],arguments[2])))},gt.prototype.addDrawCall=function(g,o,c){void 0!==c&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(g,o)},gt.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},gt.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},gt.prototype.removeAttribute=function(g){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(g)},gt.prototype.applyMatrix=function(g){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(g)},Object.defineProperties(gt.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),vm.prototype.setDynamic=function(g){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===g?df:ds),this},vm.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Mu.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},Mu.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},Mu.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},kx.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},gw.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(da.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new cn}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(g){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===g}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(g){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=g}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}}),Object.defineProperties(yd.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(g){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=g}}}),po.prototype.clearTarget=function(g,o,c,d){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(g),this.clear(o,c,d)},po.prototype.animate=function(g){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(g)},po.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},po.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},po.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},po.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},po.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},po.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},po.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},po.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},po.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},po.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},po.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},po.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},po.prototype.enableScissorTest=function(g){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(g)},po.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},po.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},po.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},po.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},po.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},po.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},po.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},po.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},po.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},po.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(po.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(g){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=g}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(g){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=g}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(g){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===g?zn:od}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}},gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}}),Object.defineProperties(Vv.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(bs.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(g){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=g}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(g){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=g}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(g){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=g}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(g){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=g}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(g){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=g}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(g){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=g}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(g){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=g}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(g){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=g}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(g){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=g}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(g){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=g}}}),vp.prototype.load=function(g){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const o=this;return(new km).load(g,function(d){o.setBuffer(d)}),this},Im.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},sx.prototype.updateCubeMap=function(g,o){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(g,o)},sx.prototype.clear=function(g,o,c,d){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(g,o,c,d)},Yi.crossOrigin=void 0,Yi.loadTexture=function(g,o,c,d){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const p=new HM;p.setCrossOrigin(this.crossOrigin);const y=p.load(g,c,void 0,d);return o&&(y.mapping=o),y},Yi.loadTextureCube=function(g,o,c,d){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const p=new fD;p.setCrossOrigin(this.crossOrigin);const y=p.load(g,c,void 0,d);return o&&(y.mapping=o),y},Yi.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Yi.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};const kF={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:H}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=H),b.ACESFilmicToneMapping=4,b.AddEquation=100,b.AddOperation=2,b.AdditiveAnimationBlendMode=2501,b.AdditiveBlending=2,b.AlphaFormat=1021,b.AlwaysDepth=1,b.AlwaysStencilFunc=519,b.AmbientLight=cw,b.AmbientLightProbe=G_,b.AnimationClip=ub,b.AnimationLoader=class dD extends Ec{constructor(o){super(o)}load(o,c,d,p){const y=this,w=new Ah(this.manager);w.setPath(this.path),w.setRequestHeader(this.requestHeader),w.setWithCredentials(this.withCredentials),w.load(o,function(M){try{c(y.parse(JSON.parse(M)))}catch(R){p?p(R):console.error(R),y.manager.itemError(o)}},d,p)}parse(o){const c=[];for(let d=0;d<o.length;d++){const p=ub.parse(o[d]);c.push(p)}return c}},b.AnimationMixer=LD,b.AnimationObjectGroup=Yo,b.AnimationUtils=Uo,b.ArcCurve=Dd,b.ArrayCamera=Rx,b.ArrowHelper=class fe extends _t{constructor(o=new Ne(0,0,1),c=new Ne(0,0,0),d=1,p=16776960,y=.2*d,w=.2*y){super(),this.type="ArrowHelper",void 0===B&&(B=new gt,B.setAttribute("position",new Wn([0,0,0,0,1,0],3)),Nd=new xm(0,.5,1,5,1),Nd.translate(0,-.5,0)),this.position.copy(c),this.line=new Af(B,new ol({color:p,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new sl(Nd,new fa({color:p,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(o),this.setLength(d,y,w)}setDirection(o){if(o.y>.99999)this.quaternion.set(0,0,0,1);else if(o.y<-.99999)this.quaternion.set(1,0,0,0);else{qD.set(o.z,0,-o.x).normalize();const c=Math.acos(o.y);this.quaternion.setFromAxisAngle(qD,c)}}setLength(o,c=.2*o,d=.2*c){this.line.scale.set(1,Math.max(1e-4,o-c),1),this.line.updateMatrix(),this.cone.scale.set(d,c,d),this.cone.position.y=o,this.cone.updateMatrix()}setColor(o){this.line.material.color.set(o),this.cone.material.color.set(o)}copy(o){return super.copy(o,!1),this.line.copy(o.line),this.cone.copy(o.cone),this}},b.Audio=vp,b.AudioAnalyser=Im,b.AudioContext=U_,b.AudioListener=class j_ extends _t{constructor(){super(),this.type="AudioListener",this.context=U_.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new W_}getInput(){return this.gain}removeFilter(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(o){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=o,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(o){return this.gain.gain.setTargetAtTime(o,this.context.currentTime,.01),this}updateMatrixWorld(o){super.updateMatrixWorld(o);const c=this.context.listener,d=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Tu,db,th),Vi.set(0,0,-1).applyQuaternion(db),c.positionX){const p=this.context.currentTime+this.timeDelta;c.positionX.linearRampToValueAtTime(Tu.x,p),c.positionY.linearRampToValueAtTime(Tu.y,p),c.positionZ.linearRampToValueAtTime(Tu.z,p),c.forwardX.linearRampToValueAtTime(Vi.x,p),c.forwardY.linearRampToValueAtTime(Vi.y,p),c.forwardZ.linearRampToValueAtTime(Vi.z,p),c.upX.linearRampToValueAtTime(d.x,p),c.upY.linearRampToValueAtTime(d.y,p),c.upZ.linearRampToValueAtTime(d.z,p)}else c.setPosition(Tu.x,Tu.y,Tu.z),c.setOrientation(Vi.x,Vi.y,Vi.z,d.x,d.y,d.z)}},b.AudioLoader=km,b.AxesHelper=xw,b.AxisHelper=function $D(g){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new xw(g)},b.BackSide=1,b.BasicDepthPacking=3200,b.BasicShadowMap=0,b.BinaryTextureLoader=function cU(g){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new pD(g)},b.Bone=Bx,b.BooleanKeyframeTrack=Am,b.BoundingBoxHelper=function eR(g,o){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new Y_(g,o)},b.Box2=bp,b.Box3=Ma,b.Box3Helper=class K_ extends wu{constructor(o,c=16776960){const d=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),y=new gt;y.setIndex(new Zn(d,1)),y.setAttribute("position",new Wn([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(y,new ol({color:c,toneMapped:!1})),this.box=o,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(o){const c=this.box;c.isEmpty()||(c.getCenter(this.position),c.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(o))}},b.BoxBufferGeometry=xh,b.BoxGeometry=xh,b.BoxHelper=Y_,b.BufferAttribute=Zn,b.BufferGeometry=gt,b.BufferGeometryLoader=dw,b.ByteType=1010,b.Cache=Rm,b.Camera=n_,b.CameraHelper=class jD extends wu{constructor(o){const c=new gt,d=new ol({color:16777215,vertexColors:!0,toneMapped:!1}),p=[],y=[],w={},M=new cn(16755200),R=new cn(16711680),A=new cn(43775),N=new cn(16777215),U=new cn(3355443);function q(ne,le,Se){Y(ne,Se),Y(le,Se)}function Y(ne,le){p.push(0,0,0),y.push(le.r,le.g,le.b),void 0===w[ne]&&(w[ne]=[]),w[ne].push(p.length/3-1)}q("n1","n2",M),q("n2","n4",M),q("n4","n3",M),q("n3","n1",M),q("f1","f2",M),q("f2","f4",M),q("f4","f3",M),q("f3","f1",M),q("n1","f1",M),q("n2","f2",M),q("n3","f3",M),q("n4","f4",M),q("p","n1",R),q("p","n2",R),q("p","n3",R),q("p","n4",R),q("u1","u2",A),q("u2","u3",A),q("u3","u1",A),q("c","t",N),q("p","c",U),q("cn1","cn2",U),q("cn3","cn4",U),q("cf1","cf2",U),q("cf3","cf4",U),c.setAttribute("position",new Wn(p,3)),c.setAttribute("color",new Wn(y,3)),super(c,d),this.type="CameraHelper",this.camera=o,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=o.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=w,this.update()}update(){const o=this.geometry,c=this.pointMap;Aa.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Da("c",c,o,Aa,0,0,-1),Da("t",c,o,Aa,0,0,1),Da("n1",c,o,Aa,-1,-1,-1),Da("n2",c,o,Aa,1,-1,-1),Da("n3",c,o,Aa,-1,1,-1),Da("n4",c,o,Aa,1,1,-1),Da("f1",c,o,Aa,-1,-1,1),Da("f2",c,o,Aa,1,-1,1),Da("f3",c,o,Aa,-1,1,1),Da("f4",c,o,Aa,1,1,1),Da("u1",c,o,Aa,.7,1.1,-1),Da("u2",c,o,Aa,-.7,1.1,-1),Da("u3",c,o,Aa,0,2,-1),Da("cf1",c,o,Aa,-1,0,1),Da("cf2",c,o,Aa,1,0,1),Da("cf3",c,o,Aa,0,-1,1),Da("cf4",c,o,Aa,0,1,1),Da("cn1",c,o,Aa,-1,0,-1),Da("cn2",c,o,Aa,1,0,-1),Da("cn3",c,o,Aa,0,-1,-1),Da("cn4",c,o,Aa,0,1,-1),o.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}},b.CanvasRenderer=function RF(){console.error("THREE.CanvasRenderer has been removed")},b.CanvasTexture=KO,b.CatmullRomCurve3=xM,b.CineonToneMapping=3,b.CircleBufferGeometry=Zv,b.CircleGeometry=Zv,b.ClampToEdgeWrapping=Lo,b.Clock=W_,b.Color=cn,b.ColorKeyframeTrack=rw,b.CompressedTexture=nD,b.CompressedTextureLoader=class dF extends Ec{constructor(o){super(o)}load(o,c,d,p){const y=this,w=[],M=new nD,R=new Ah(this.manager);R.setPath(this.path),R.setResponseType("arraybuffer"),R.setRequestHeader(this.requestHeader),R.setWithCredentials(y.withCredentials);let A=0;function N(U){R.load(o[U],function(q){const Y=y.parse(q,!0);w[U]={width:Y.width,height:Y.height,format:Y.format,mipmaps:Y.mipmaps},A+=1,6===A&&(1===Y.mipmapCount&&(M.minFilter=tt),M.image=w,M.format=Y.format,M.needsUpdate=!0,c&&c(M))},d,p)}if(Array.isArray(o))for(let U=0,q=o.length;U<q;++U)N(U);else R.load(o,function(U){const q=y.parse(U,!0);if(q.isCubemap){const Y=q.mipmaps.length/q.mipmapCount;for(let ne=0;ne<Y;ne++){w[ne]={mipmaps:[]};for(let le=0;le<q.mipmapCount;le++)w[ne].mipmaps.push(q.mipmaps[ne*q.mipmapCount+le]),w[ne].format=q.format,w[ne].width=q.width,w[ne].height=q.height}M.image=w}else M.image.width=q.width,M.image.height=q.height,M.mipmaps=q.mipmaps;1===q.mipmapCount&&(M.minFilter=tt),M.format=q.format,M.needsUpdate=!0,c&&c(M)},d,p);return M}},b.ConeBufferGeometry=Yv,b.ConeGeometry=Yv,b.CubeCamera=sx,b.CubeReflectionMapping=301,b.CubeRefractionMapping=302,b.CubeTexture=r_,b.CubeTextureLoader=fD,b.CubeUVReflectionMapping=306,b.CubeUVRefractionMapping=307,b.CubicBezierCurve=L_,b.CubicBezierCurve3=eb,b.CubicInterpolant=FM,b.CullFaceBack=1,b.CullFaceFront=2,b.CullFaceFrontBack=3,b.CullFaceNone=0,b.Curve=jc,b.CurvePath=CM,b.CustomBlending=5,b.CustomToneMapping=5,b.CylinderBufferGeometry=xm,b.CylinderGeometry=xm,b.Cylindrical=class yF{constructor(o=1,c=0,d=0){return this.radius=o,this.theta=c,this.y=d,this}set(o,c,d){return this.radius=o,this.theta=c,this.y=d,this}copy(o){return this.radius=o.radius,this.theta=o.theta,this.y=o.y,this}setFromVector3(o){return this.setFromCartesianCoords(o.x,o.y,o.z)}setFromCartesianCoords(o,c,d){return this.radius=Math.sqrt(o*o+d*d),this.theta=Math.atan2(o,d),this.y=c,this}clone(){return(new this.constructor).copy(this)}},b.DataTexture=Tf,b.DataTexture2DArray=xu,b.DataTexture3D=TA,b.DataTextureLoader=pD,b.DataUtils=class yt{static toHalfFloat(o){o>65504&&(console.warn("THREE.DataUtils.toHalfFloat(): value exceeds 65504."),o=65504),Z[0]=o;const c=J[0];let d=c>>16&32768,p=c>>12&2047;const y=c>>23&255;return y<103?d:y>142?(d|=31744,d|=(255==y?0:1)&&8388607&c,d):y<113?(p|=2048,d|=(p>>114-y)+(p>>113-y&1),d):(d|=y-112<<10|p>>1,d+=1&p,d)}},b.DecrementStencilOp=7683,b.DecrementWrapStencilOp=34056,b.DefaultLoadingManager=sw,b.DepthFormat=ed,b.DepthStencilFormat=ks,b.DepthTexture=ym,b.DirectionalLight=lw,b.DirectionalLightHelper=class SF extends _t{constructor(o,c,d){super(),this.light=o,this.light.updateMatrixWorld(),this.matrix=o.matrixWorld,this.matrixAutoUpdate=!1,this.color=d,void 0===c&&(c=1);let p=new gt;p.setAttribute("position",new Wn([-c,c,0,c,c,0,c,-c,0,-c,-c,0,-c,c,0],3));const y=new ol({fog:!1,toneMapped:!1});this.lightPlane=new Af(p,y),this.add(this.lightPlane),p=new gt,p.setAttribute("position",new Wn([0,0,0,0,0,1],3)),this.targetLine=new Af(p,y),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){GD.setFromMatrixPosition(this.light.matrixWorld),bw.setFromMatrixPosition(this.light.target.matrixWorld),WD.subVectors(bw,GD),this.lightPlane.lookAt(bw),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(bw),this.targetLine.scale.z=WD.length()}},b.DiscreteInterpolant=nw,b.DodecahedronBufferGeometry=Su,b.DodecahedronGeometry=Su,b.DoubleSide=2,b.DstAlphaFactor=206,b.DstColorFactor=208,b.DynamicBufferAttribute=function QM(g,o){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new Zn(g,o).setUsage(df)},b.DynamicCopyUsage=35050,b.DynamicDrawUsage=df,b.DynamicReadUsage=35049,b.EdgesGeometry=qx,b.EdgesHelper=function tR(g,o){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new wu(new qx(g.geometry),new ol({color:void 0!==o?o:16777215}))},b.EllipseCurve=Kv,b.EqualDepth=4,b.EqualStencilFunc=514,b.EquirectangularReflectionMapping=303,b.EquirectangularRefractionMapping=304,b.Euler=vf,b.EventDispatcher=Fl,b.ExtrudeBufferGeometry=Mu,b.ExtrudeGeometry=Mu,b.FaceColors=1,b.FileLoader=Ah,b.FlatShading=1,b.Float16BufferAttribute=Wr,b.Float32Attribute=function QD(g,o){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new Wn(g,o)},b.Float32BufferAttribute=Wn,b.Float64Attribute=function JD(g,o){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new WE(g,o)},b.Float64BufferAttribute=WE,b.FloatType=eo,b.Fog=x_,b.FogExp2=zv,b.Font=function oR(){console.error("THREE.Font has been moved to /examples/jsm/loaders/FontLoader.js")},b.FontLoader=function IF(){console.error("THREE.FontLoader has been moved to /examples/jsm/loaders/FontLoader.js")},b.FramebufferTexture=YO,b.FrontSide=0,b.Frustum=bv,b.GLBufferAttribute=OD,b.GLSL1="100",b.GLSL3=nc,b.GreaterDepth=6,b.GreaterEqualDepth=5,b.GreaterEqualStencilFunc=518,b.GreaterStencilFunc=516,b.GridHelper=YM,b.Group=Mf,b.HalfFloatType=Sa,b.HemisphereLight=ow,b.HemisphereLightHelper=class xF extends _t{constructor(o,c,d){super(),this.light=o,this.light.updateMatrixWorld(),this.matrix=o.matrixWorld,this.matrixAutoUpdate=!1,this.color=d;const p=new yp(c);p.rotateY(.5*Math.PI),this.material=new fa({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const y=p.getAttribute("position"),w=new Float32Array(3*y.count);p.setAttribute("color",new Zn(w,3)),this.add(new sl(p,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const o=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const c=o.geometry.getAttribute("color");ZM.copy(this.light.color),fb.copy(this.light.groundColor);for(let d=0,p=c.count;d<p;d++){const y=d<p/2?ZM:fb;c.setXYZ(d,y.r,y.g,y.b)}c.needsUpdate=!0}o.lookAt(bF.setFromMatrixPosition(this.light.matrixWorld).negate())}},b.HemisphereLightProbe=SD,b.IcosahedronBufferGeometry=gp,b.IcosahedronGeometry=gp,b.ImageBitmapLoader=wD,b.ImageLoader=hb,b.ImageUtils=Yi,b.ImmediateRenderObject=function LF(){console.error("THREE.ImmediateRenderObject has been removed.")},b.IncrementStencilOp=7682,b.IncrementWrapStencilOp=34055,b.InstancedBufferAttribute=Ef,b.InstancedBufferGeometry=WM,b.InstancedInterleavedBuffer=jM,b.InstancedMesh=T_,b.Int16Attribute=function hr(g,o){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new ix(g,o)},b.Int16BufferAttribute=ix,b.Int32Attribute=function Vd(g,o){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new $g(g,o)},b.Int32BufferAttribute=$g,b.Int8Attribute=function Re(g,o){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new yl(g,o)},b.Int8BufferAttribute=yl,b.IntType=1013,b.InterleavedBuffer=vm,b.InterleavedBufferAttribute=Ed,b.Interpolant=Pd,b.InterpolateDiscrete=yr,b.InterpolateLinear=la,b.InterpolateSmooth=2302,b.InvertStencilOp=5386,b.JSONLoader=function rR(){console.error("THREE.JSONLoader has been removed.")},b.KeepStencilOp=7680,b.KeyframeTrack=Eh,b.LOD=$r,b.LatheBufferGeometry=_p,b.LatheGeometry=_p,b.Layers=yu,b.LensFlare=function xl(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")},b.LessDepth=2,b.LessEqualDepth=3,b.LessEqualStencilFunc=515,b.LessStencilFunc=513,b.Light=Fd,b.LightProbe=hw,b.Line=Af,b.Line3=HD,b.LineBasicMaterial=ol,b.LineCurve=O_,b.LineCurve3=tb,b.LineDashedMaterial=LM,b.LineLoop=yM,b.LinePieces=1,b.LineSegments=wu,b.LineStrip=0,b.LinearEncoding=od,b.LinearFilter=tt,b.LinearInterpolant=BM,b.LinearMipMapLinearFilter=1008,b.LinearMipMapNearestFilter=1007,b.LinearMipmapLinearFilter=Gi,b.LinearMipmapNearestFilter=1007,b.LinearToneMapping=1,b.Loader=Ec,b.LoaderUtils=It,b.LoadingManager=Os,b.LoopOnce=2200,b.LoopPingPong=2202,b.LoopRepeat=2201,b.LuminanceAlphaFormat=1025,b.LuminanceFormat=1024,b.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},b.Material=da,b.MaterialLoader=GM,b.Math=pv,b.MathUtils=pv,b.Matrix3=Hn,b.Matrix4=Mn,b.MaxEquation=104,b.Mesh=sl,b.MeshBasicMaterial=fa,b.MeshDepthMaterial=Td,b.MeshDistanceMaterial=Hv,b.MeshFaceMaterial=function Wi(g){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),g},b.MeshLambertMaterial=cb,b.MeshMatcapMaterial=Em,b.MeshNormalMaterial=iw,b.MeshPhongMaterial=hD,b.MeshPhysicalMaterial=IM,b.MeshStandardMaterial=tw,b.MeshToonMaterial=lb,b.MinEquation=103,b.MirroredRepeatWrapping=no,b.MixOperation=1,b.MultiMaterial=function mb(g=[]){return console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),g.isMultiMaterial=!0,g.materials=g,g.clone=function(){return g.slice()},g},b.MultiplyBlending=4,b.MultiplyOperation=0,b.NearestFilter=ro,b.NearestMipMapLinearFilter=1005,b.NearestMipMapNearestFilter=1004,b.NearestMipmapLinearFilter=1005,b.NearestMipmapNearestFilter=1004,b.NeverDepth=0,b.NeverStencilFunc=512,b.NoBlending=0,b.NoColors=0,b.NoToneMapping=0,b.NormalAnimationBlendMode=2500,b.NormalBlending=1,b.NotEqualDepth=7,b.NotEqualStencilFunc=517,b.NumberKeyframeTrack=Id,b.Object3D=_t,b.ObjectLoader=class mF extends Ec{constructor(o){super(o)}load(o,c,d,p){const y=this,w=""===this.path?It.extractUrlBase(o):this.path;this.resourcePath=this.resourcePath||w;const M=new Ah(this.manager);M.setPath(this.path),M.setRequestHeader(this.requestHeader),M.setWithCredentials(this.withCredentials),M.load(o,function(R){let A=null;try{A=JSON.parse(R)}catch(U){return void 0!==p&&p(U),void console.error("THREE:ObjectLoader: Can't parse "+o+".",U.message)}const N=A.metadata;void 0!==N&&void 0!==N.type&&"geometry"!==N.type.toLowerCase()?y.parse(A,c):console.error("THREE.ObjectLoader: Can't load "+o)},d,p)}loadAsync(o,c){var d=this;return F(function*(){const p=d,y=""===d.path?It.extractUrlBase(o):d.path;d.resourcePath=d.resourcePath||y;const w=new Ah(d.manager);w.setPath(d.path),w.setRequestHeader(d.requestHeader),w.setWithCredentials(d.withCredentials);const M=yield w.loadAsync(o,c),R=JSON.parse(M),A=R.metadata;if(void 0===A||void 0===A.type||"geometry"===A.type.toLowerCase())throw new Error("THREE.ObjectLoader: Can't load "+o);return yield p.parseAsync(R)})()}parse(o,c){const d=this.parseAnimations(o.animations),p=this.parseShapes(o.shapes),y=this.parseGeometries(o.geometries,p),w=this.parseImages(o.images,function(){void 0!==c&&c(A)}),M=this.parseTextures(o.textures,w),R=this.parseMaterials(o.materials,M),A=this.parseObject(o.object,y,R,M,d),N=this.parseSkeletons(o.skeletons,A);if(this.bindSkeletons(A,N),void 0!==c){let U=!1;for(const q in w)if(w[q]instanceof HTMLImageElement){U=!0;break}!1===U&&c(A)}return A}parseAsync(o){var c=this;return F(function*(){const d=c.parseAnimations(o.animations),p=c.parseShapes(o.shapes),y=c.parseGeometries(o.geometries,p),w=yield c.parseImagesAsync(o.images),M=c.parseTextures(o.textures,w),R=c.parseMaterials(o.materials,M),A=c.parseObject(o.object,y,R,M,d),N=c.parseSkeletons(o.skeletons,A);return c.bindSkeletons(A,N),A})()}parseShapes(o){const c={};if(void 0!==o)for(let d=0,p=o.length;d<p;d++){const y=(new Th).fromJSON(o[d]);c[y.uuid]=y}return c}parseSkeletons(o,c){const d={},p={};if(c.traverse(function(y){y.isBone&&(p[y.uuid]=y)}),void 0!==o)for(let y=0,w=o.length;y<w;y++){const M=(new Xv).fromJSON(o[y],p);d[M.uuid]=M}return d}parseGeometries(o,c){const d={};if(void 0!==o){const p=new dw;for(let y=0,w=o.length;y<w;y++){let M;const R=o[y];switch(R.type){case"BufferGeometry":case"InstancedBufferGeometry":M=p.parse(R);break;case"Geometry":console.error("THREE.ObjectLoader: The legacy Geometry type is no longer supported.");break;default:R.type in kd?M=kd[R.type].fromJSON(R,c):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${R.type}"`)}M.uuid=R.uuid,void 0!==R.name&&(M.name=R.name),!0===M.isBufferGeometry&&void 0!==R.userData&&(M.userData=R.userData),d[R.uuid]=M}}return d}parseMaterials(o,c){const d={},p={};if(void 0!==o){const y=new GM;y.setTextures(c);for(let w=0,M=o.length;w<M;w++){const R=o[w];if("MultiMaterial"===R.type){const A=[];for(let N=0;N<R.materials.length;N++){const U=R.materials[N];void 0===d[U.uuid]&&(d[U.uuid]=y.parse(U)),A.push(d[U.uuid])}p[R.uuid]=A}else void 0===d[R.uuid]&&(d[R.uuid]=y.parse(R)),p[R.uuid]=d[R.uuid]}}return p}parseAnimations(o){const c={};if(void 0!==o)for(let d=0;d<o.length;d++){const y=ub.parse(o[d]);c[y.uuid]=y}return c}parseImages(o,c){const d=this,p={};let y;function M(R){if("string"==typeof R){const A=R;return function w(R){return d.manager.itemStart(R),y.load(R,function(){d.manager.itemEnd(R)},void 0,function(){d.manager.itemError(R),d.manager.itemEnd(R)})}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(A)?A:d.resourcePath+A)}return R.data?{data:ml(R.type,R.data),width:R.width,height:R.height}:null}if(void 0!==o&&o.length>0){const R=new Os(c);y=new hb(R),y.setCrossOrigin(this.crossOrigin);for(let A=0,N=o.length;A<N;A++){const U=o[A],q=U.url;if(Array.isArray(q)){p[U.uuid]=[];for(let Y=0,ne=q.length;Y<ne;Y++){const Se=M(q[Y]);null!==Se&&(Se instanceof HTMLImageElement?p[U.uuid].push(Se):p[U.uuid].push(new Tf(Se.data,Se.width,Se.height)))}}else{const Y=M(U.url);null!==Y&&(p[U.uuid]=Y)}}}return p}parseImagesAsync(o){var c=this;return F(function*(){const d=c,p={};let y;function w(R){return M.apply(this,arguments)}function M(){return(M=F(function*(R){if("string"==typeof R){const A=R,N=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(A)?A:d.resourcePath+A;return yield y.loadAsync(N)}return R.data?{data:ml(R.type,R.data),width:R.width,height:R.height}:null})).apply(this,arguments)}if(void 0!==o&&o.length>0){y=new hb(c.manager),y.setCrossOrigin(c.crossOrigin);for(let R=0,A=o.length;R<A;R++){const N=o[R],U=N.url;if(Array.isArray(U)){p[N.uuid]=[];for(let q=0,Y=U.length;q<Y;q++){const ne=U[q],le=yield w(ne);null!==le&&(le instanceof HTMLImageElement?p[N.uuid].push(le):p[N.uuid].push(new Tf(le.data,le.width,le.height)))}}else{const q=yield w(N.url);null!==q&&(p[N.uuid]=q)}}}return p})()}parseTextures(o,c){function d(y,w){return"number"==typeof y?y:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",y),w[y])}const p={};if(void 0!==o)for(let y=0,w=o.length;y<w;y++){const M=o[y];let R;void 0===M.image&&console.warn('THREE.ObjectLoader: No "image" specified for',M.uuid),void 0===c[M.image]&&console.warn("THREE.ObjectLoader: Undefined image",M.image);const A=c[M.image];Array.isArray(A)?(R=new r_(A),6===A.length&&(R.needsUpdate=!0)):(R=A&&A.data?new Tf(A.data,A.width,A.height):new Jr(A),A&&(R.needsUpdate=!0)),R.uuid=M.uuid,void 0!==M.name&&(R.name=M.name),void 0!==M.mapping&&(R.mapping=d(M.mapping,gF)),void 0!==M.offset&&R.offset.fromArray(M.offset),void 0!==M.repeat&&R.repeat.fromArray(M.repeat),void 0!==M.center&&R.center.fromArray(M.center),void 0!==M.rotation&&(R.rotation=M.rotation),void 0!==M.wrap&&(R.wrapS=d(M.wrap[0],bD),R.wrapT=d(M.wrap[1],bD)),void 0!==M.format&&(R.format=M.format),void 0!==M.type&&(R.type=M.type),void 0!==M.encoding&&(R.encoding=M.encoding),void 0!==M.minFilter&&(R.minFilter=d(M.minFilter,xD)),void 0!==M.magFilter&&(R.magFilter=d(M.magFilter,xD)),void 0!==M.anisotropy&&(R.anisotropy=M.anisotropy),void 0!==M.flipY&&(R.flipY=M.flipY),void 0!==M.premultiplyAlpha&&(R.premultiplyAlpha=M.premultiplyAlpha),void 0!==M.unpackAlignment&&(R.unpackAlignment=M.unpackAlignment),void 0!==M.userData&&(R.userData=M.userData),p[M.uuid]=R}return p}parseObject(o,c,d,p,y){let w,N,U;function M(q){return void 0===c[q]&&console.warn("THREE.ObjectLoader: Undefined geometry",q),c[q]}function R(q){if(void 0!==q){if(Array.isArray(q)){const Y=[];for(let ne=0,le=q.length;ne<le;ne++){const Se=q[ne];void 0===d[Se]&&console.warn("THREE.ObjectLoader: Undefined material",Se),Y.push(d[Se])}return Y}return void 0===d[q]&&console.warn("THREE.ObjectLoader: Undefined material",q),d[q]}}function A(q){return void 0===p[q]&&console.warn("THREE.ObjectLoader: Undefined texture",q),p[q]}switch(o.type){case"Scene":w=new kx,void 0!==o.background&&(w.background=Number.isInteger(o.background)?new cn(o.background):A(o.background)),void 0!==o.environment&&(w.environment=A(o.environment)),void 0!==o.fog&&("Fog"===o.fog.type?w.fog=new x_(o.fog.color,o.fog.near,o.fog.far):"FogExp2"===o.fog.type&&(w.fog=new zv(o.fog.color,o.fog.density)));break;case"PerspectiveCamera":w=new vl(o.fov,o.aspect,o.near,o.far),void 0!==o.focus&&(w.focus=o.focus),void 0!==o.zoom&&(w.zoom=o.zoom),void 0!==o.filmGauge&&(w.filmGauge=o.filmGauge),void 0!==o.filmOffset&&(w.filmOffset=o.filmOffset),void 0!==o.view&&(w.view=Object.assign({},o.view));break;case"OrthographicCamera":w=new Dv(o.left,o.right,o.top,o.bottom,o.near,o.far),void 0!==o.zoom&&(w.zoom=o.zoom),void 0!==o.view&&(w.view=Object.assign({},o.view));break;case"AmbientLight":w=new cw(o.color,o.intensity);break;case"DirectionalLight":w=new lw(o.color,o.intensity);break;case"PointLight":w=new vD(o.color,o.intensity,o.distance,o.decay);break;case"RectAreaLight":w=new uw(o.color,o.intensity,o.width,o.height);break;case"SpotLight":w=new VM(o.color,o.intensity,o.distance,o.angle,o.penumbra,o.decay);break;case"HemisphereLight":w=new ow(o.color,o.groundColor,o.intensity);break;case"LightProbe":w=(new hw).fromJSON(o);break;case"SkinnedMesh":N=M(o.geometry),U=R(o.material),w=new qv(N,U),void 0!==o.bindMode&&(w.bindMode=o.bindMode),void 0!==o.bindMatrix&&w.bindMatrix.fromArray(o.bindMatrix),void 0!==o.skeleton&&(w.skeleton=o.skeleton);break;case"Mesh":N=M(o.geometry),U=R(o.material),w=new sl(N,U);break;case"InstancedMesh":N=M(o.geometry),U=R(o.material);const Y=o.instanceMatrix,ne=o.instanceColor;w=new T_(N,U,o.count),w.instanceMatrix=new Ef(new Float32Array(Y.array),16),void 0!==ne&&(w.instanceColor=new Ef(new Float32Array(ne.array),ne.itemSize));break;case"LOD":w=new $r;break;case"Line":w=new Af(M(o.geometry),R(o.material));break;case"LineLoop":w=new yM(M(o.geometry),R(o.material));break;case"LineSegments":w=new wu(M(o.geometry),R(o.material));break;case"PointCloud":case"Points":w=new Gx(M(o.geometry),R(o.material));break;case"Sprite":w=new jv(R(o.material));break;case"Group":w=new Mf;break;case"Bone":w=new Bx;break;default:w=new _t}if(w.uuid=o.uuid,void 0!==o.name&&(w.name=o.name),void 0!==o.matrix?(w.matrix.fromArray(o.matrix),void 0!==o.matrixAutoUpdate&&(w.matrixAutoUpdate=o.matrixAutoUpdate),w.matrixAutoUpdate&&w.matrix.decompose(w.position,w.quaternion,w.scale)):(void 0!==o.position&&w.position.fromArray(o.position),void 0!==o.rotation&&w.rotation.fromArray(o.rotation),void 0!==o.quaternion&&w.quaternion.fromArray(o.quaternion),void 0!==o.scale&&w.scale.fromArray(o.scale)),void 0!==o.castShadow&&(w.castShadow=o.castShadow),void 0!==o.receiveShadow&&(w.receiveShadow=o.receiveShadow),o.shadow&&(void 0!==o.shadow.bias&&(w.shadow.bias=o.shadow.bias),void 0!==o.shadow.normalBias&&(w.shadow.normalBias=o.shadow.normalBias),void 0!==o.shadow.radius&&(w.shadow.radius=o.shadow.radius),void 0!==o.shadow.mapSize&&w.shadow.mapSize.fromArray(o.shadow.mapSize),void 0!==o.shadow.camera&&(w.shadow.camera=this.parseObject(o.shadow.camera))),void 0!==o.visible&&(w.visible=o.visible),void 0!==o.frustumCulled&&(w.frustumCulled=o.frustumCulled),void 0!==o.renderOrder&&(w.renderOrder=o.renderOrder),void 0!==o.userData&&(w.userData=o.userData),void 0!==o.layers&&(w.layers.mask=o.layers),void 0!==o.children){const q=o.children;for(let Y=0;Y<q.length;Y++)w.add(this.parseObject(q[Y],c,d,p,y))}if(void 0!==o.animations){const q=o.animations;for(let Y=0;Y<q.length;Y++)w.animations.push(y[q[Y]])}if("LOD"===o.type){void 0!==o.autoUpdate&&(w.autoUpdate=o.autoUpdate);const q=o.levels;for(let Y=0;Y<q.length;Y++){const ne=q[Y],le=w.getObjectByProperty("uuid",ne.object);void 0!==le&&w.addLevel(le,ne.distance)}}return w}bindSkeletons(o,c){0!==Object.keys(c).length&&o.traverse(function(d){if(!0===d.isSkinnedMesh&&void 0!==d.skeleton){const p=c[d.skeleton];void 0===p?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",d.skeleton):d.bind(p,d.bindMatrix)}})}setTexturePath(o){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(o)}},b.ObjectSpaceNormalMap=1,b.OctahedronBufferGeometry=yp,b.OctahedronGeometry=yp,b.OneFactor=201,b.OneMinusDstAlphaFactor=207,b.OneMinusDstColorFactor=209,b.OneMinusSrcAlphaFactor=205,b.OneMinusSrcColorFactor=203,b.OrthographicCamera=Dv,b.PCFShadowMap=1,b.PCFSoftShadowMap=2,b.PMREMGenerator=WC,b.ParametricGeometry=function sR(){return console.error("THREE.ParametricGeometry has been moved to /examples/jsm/geometries/ParametricGeometry.js"),new gt},b.Particle=function KM(g){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new jv(g)},b.ParticleBasicMaterial=function EF(g){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new E_(g)},b.ParticleSystem=function je(g,o){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new Gx(g,o)},b.ParticleSystemMaterial=function ZD(g){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new E_(g)},b.Path=nb,b.PerspectiveCamera=vl,b.Plane=bd,b.PlaneBufferGeometry=wd,b.PlaneGeometry=wd,b.PlaneHelper=class CF extends Af{constructor(o,c=1,d=16776960){const p=d,w=new gt;w.setAttribute("position",new Wn([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),w.computeBoundingSphere(),super(w,new ol({color:p,toneMapped:!1})),this.type="PlaneHelper",this.plane=o,this.size=c;const R=new gt;R.setAttribute("position",new Wn([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),R.computeBoundingSphere(),this.add(new sl(R,new fa({color:p,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(o){let c=-this.plane.constant;Math.abs(c)<1e-8&&(c=1e-8),this.scale.set(.5*this.size,.5*this.size,c),this.children[0].material.side=c<0?1:0,this.lookAt(this.plane.normal),super.updateMatrixWorld(o)}},b.PointCloud=function XD(g,o){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new Gx(g,o)},b.PointCloudMaterial=function Q_(g){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new E_(g)},b.PointLight=vD,b.PointLightHelper=class UD extends sl{constructor(o,c,d){super(new B_(c,4,2),new fa({wireframe:!0,fog:!1,toneMapped:!1})),this.light=o,this.light.updateMatrixWorld(),this.color=d,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}},b.Points=Gx,b.PointsMaterial=E_,b.PolarGridHelper=class wF extends wu{constructor(o=10,c=16,d=8,p=64,y=4473924,w=8947848){y=new cn(y),w=new cn(w);const M=[],R=[];for(let U=0;U<=c;U++){const q=U/c*(2*Math.PI),Y=Math.sin(q)*o,ne=Math.cos(q)*o;M.push(0,0,0),M.push(Y,0,ne);const le=1&U?y:w;R.push(le.r,le.g,le.b),R.push(le.r,le.g,le.b)}for(let U=0;U<=d;U++){const q=1&U?y:w,Y=o-o/d*U;for(let ne=0;ne<p;ne++){let le=ne/p*(2*Math.PI),Se=Math.sin(le)*Y,re=Math.cos(le)*Y;M.push(Se,0,re),R.push(q.r,q.g,q.b),le=(ne+1)/p*(2*Math.PI),Se=Math.sin(le)*Y,re=Math.cos(le)*Y,M.push(Se,0,re),R.push(q.r,q.g,q.b)}}const A=new gt;A.setAttribute("position",new Wn(M,3)),A.setAttribute("color",new Wn(R,3)),super(A,new ol({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}},b.PolyhedronBufferGeometry=Df,b.PolyhedronGeometry=Df,b.PositionalAudio=class X_ extends vp{constructor(o){super(o),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(o){return this.panner.refDistance=o,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(o){return this.panner.rolloffFactor=o,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(o){return this.panner.distanceModel=o,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(o){return this.panner.maxDistance=o,this}setDirectionalCone(o,c,d){return this.panner.coneInnerAngle=o,this.panner.coneOuterAngle=c,this.panner.coneOuterGain=d,this}updateMatrixWorld(o){if(super.updateMatrixWorld(o),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(ih,Pm,q_),nh.set(0,0,1).applyQuaternion(Pm);const c=this.panner;if(c.positionX){const d=this.context.currentTime+this.listener.timeDelta;c.positionX.linearRampToValueAtTime(ih.x,d),c.positionY.linearRampToValueAtTime(ih.y,d),c.positionZ.linearRampToValueAtTime(ih.z,d),c.orientationX.linearRampToValueAtTime(nh.x,d),c.orientationY.linearRampToValueAtTime(nh.y,d),c.orientationZ.linearRampToValueAtTime(nh.z,d)}else c.setPosition(ih.x,ih.y,ih.z),c.setOrientation(nh.x,nh.y,nh.z)}},b.PropertyBinding=Go,b.PropertyMixer=Lm,b.QuadraticBezierCurve=Kx,b.QuadraticBezierCurve3=ib,b.Quaternion=ua,b.QuaternionKeyframeTrack=V_,b.QuaternionLinearInterpolant=NM,b.REVISION=H,b.RGBADepthPacking=3201,b.RGBAFormat=Ua,b.RGBAIntegerFormat=1033,b.RGBA_ASTC_10x10_Format=37819,b.RGBA_ASTC_10x5_Format=37816,b.RGBA_ASTC_10x6_Format=37817,b.RGBA_ASTC_10x8_Format=37818,b.RGBA_ASTC_12x10_Format=37820,b.RGBA_ASTC_12x12_Format=37821,b.RGBA_ASTC_4x4_Format=37808,b.RGBA_ASTC_5x4_Format=37809,b.RGBA_ASTC_5x5_Format=37810,b.RGBA_ASTC_6x5_Format=37811,b.RGBA_ASTC_6x6_Format=37812,b.RGBA_ASTC_8x5_Format=37813,b.RGBA_ASTC_8x6_Format=37814,b.RGBA_ASTC_8x8_Format=37815,b.RGBA_BPTC_Format=36492,b.RGBA_ETC2_EAC_Format=37496,b.RGBA_PVRTC_2BPPV1_Format=35843,b.RGBA_PVRTC_4BPPV1_Format=35842,b.RGBA_S3TC_DXT1_Format=Jp,b.RGBA_S3TC_DXT3_Format=tu,b.RGBA_S3TC_DXT5_Format=cf,b.RGB_ETC1_Format=36196,b.RGB_ETC2_Format=37492,b.RGB_PVRTC_2BPPV1_Format=35841,b.RGB_PVRTC_4BPPV1_Format=35840,b.RGB_S3TC_DXT1_Format=ep,b.RGFormat=1030,b.RGIntegerFormat=1031,b.RawShaderMaterial=Rv,b.Ray=yf,b.Raycaster=class FD{constructor(o,c,d=0,p=1/0){this.ray=new yf(o,c),this.near=d,this.far=p,this.camera=null,this.layers=new yu,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(o,c){this.ray.set(o,c)}setFromCamera(o,c){c&&c.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(c.matrixWorld),this.ray.direction.set(o.x,o.y,.5).unproject(c).sub(this.ray.origin).normalize(),this.camera=c):c&&c.isOrthographicCamera?(this.ray.origin.set(o.x,o.y,(c.near+c.far)/(c.near-c.far)).unproject(c),this.ray.direction.set(0,0,-1).transformDirection(c.matrixWorld),this.camera=c):console.error("THREE.Raycaster: Unsupported camera type: "+c.type)}intersectObject(o,c=!0,d=[]){return qM(o,this,d,c),d.sort(BD),d}intersectObjects(o,c=!0,d=[]){for(let p=0,y=o.length;p<y;p++)qM(o[p],this,d,c);return d.sort(BD),d}},b.RectAreaLight=uw,b.RedFormat=1028,b.RedIntegerFormat=1029,b.ReinhardToneMapping=2,b.RepeatWrapping=oa,b.ReplaceStencilOp=7681,b.ReverseSubtractEquation=102,b.RingBufferGeometry=F_,b.RingGeometry=F_,b.Scene=kx,b.SceneUtils=kF,b.ShaderChunk=Cs,b.ShaderLib=Sh,b.ShaderMaterial=yd,b.ShadowMaterial=H_,b.Shape=Th,b.ShapeBufferGeometry=Sm,b.ShapeGeometry=Sm,b.ShapePath=class MF{constructor(){this.type="ShapePath",this.color=new cn,this.subPaths=[],this.currentPath=null}moveTo(o,c){return this.currentPath=new nb,this.subPaths.push(this.currentPath),this.currentPath.moveTo(o,c),this}lineTo(o,c){return this.currentPath.lineTo(o,c),this}quadraticCurveTo(o,c,d,p){return this.currentPath.quadraticCurveTo(o,c,d,p),this}bezierCurveTo(o,c,d,p,y,w){return this.currentPath.bezierCurveTo(o,c,d,p,y,w),this}splineThru(o){return this.currentPath.splineThru(o),this}toShapes(o,c){function d(K){const Oe=[];for(let xe=0,ze=K.length;xe<ze;xe++){const $e=K[xe],ht=new Th;ht.curves=$e.curves,Oe.push(ht)}return Oe}function p(K,Oe){const xe=Oe.length;let ze=!1;for(let $e=xe-1,ht=0;ht<xe;$e=ht++){let Et=Oe[$e],ci=Oe[ht],Yt=ci.x-Et.x,Pe=ci.y-Et.y;if(Math.abs(Pe)>Number.EPSILON){if(Pe<0&&(Et=Oe[ht],Yt=-Yt,ci=Oe[$e],Pe=-Pe),K.y<Et.y||K.y>ci.y)continue;if(K.y===Et.y){if(K.x===Et.x)return!0}else{const bt=Pe*(K.x-Et.x)-Yt*(K.y-Et.y);if(0===bt)return!0;if(bt<0)continue;ze=!ze}}else{if(K.y!==Et.y)continue;if(ci.x<=K.x&&K.x<=Et.x||Et.x<=K.x&&K.x<=ci.x)return!0}}return ze}const y=$u.isClockWise,w=this.subPaths;if(0===w.length)return[];if(!0===c)return d(w);let M,R,A;const N=[];if(1===w.length)return R=w[0],A=new Th,A.curves=R.curves,N.push(A),N;let U=!y(w[0].getPoints());U=o?!U:U;const q=[],Y=[];let Se,re,ne=[],le=0;Y[le]=void 0,ne[le]=[];for(let K=0,Oe=w.length;K<Oe;K++)R=w[K],Se=R.getPoints(),M=y(Se),M=o?!M:M,M?(!U&&Y[le]&&le++,Y[le]={s:new Th,p:Se},Y[le].s.curves=R.curves,U&&le++,ne[le]=[]):ne[le].push({h:R,p:Se[0]});if(!Y[0])return d(w);if(Y.length>1){let K=!1;const Oe=[];for(let xe=0,ze=Y.length;xe<ze;xe++)q[xe]=[];for(let xe=0,ze=Y.length;xe<ze;xe++){const $e=ne[xe];for(let ht=0;ht<$e.length;ht++){const Et=$e[ht];let ci=!0;for(let Yt=0;Yt<Y.length;Yt++)p(Et.p,Y[Yt].p)&&(xe!==Yt&&Oe.push({froms:xe,tos:Yt,hole:ht}),ci?(ci=!1,q[Yt].push(Et)):K=!0);ci&&q[xe].push(Et)}}Oe.length>0&&(K||(ne=q))}for(let K=0,Oe=Y.length;K<Oe;K++){A=Y[K].s,N.push(A),re=ne[K];for(let xe=0,ze=re.length;xe<ze;xe++)A.holes.push(re[xe].h)}return N}},b.ShapeUtils=$u,b.ShortType=1011,b.Skeleton=Xv,b.SkeletonHelper=Pf,b.SkinnedMesh=qv,b.SmoothShading=2,b.Sphere=pd,b.SphereBufferGeometry=B_,b.SphereGeometry=B_,b.Spherical=class aU{constructor(o=1,c=0,d=0){return this.radius=o,this.phi=c,this.theta=d,this}set(o,c,d){return this.radius=o,this.phi=c,this.theta=d,this}copy(o){return this.radius=o.radius,this.phi=o.phi,this.theta=o.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(o){return this.setFromCartesianCoords(o.x,o.y,o.z)}setFromCartesianCoords(o,c,d){return this.radius=Math.sqrt(o*o+c*c+d*d),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(o,d),this.phi=Math.acos(Ur(c/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}},b.SphericalHarmonics3=UM,b.SplineCurve=SM,b.SpotLight=VM,b.SpotLightHelper=class vF extends _t{constructor(o,c){super(),this.light=o,this.light.updateMatrixWorld(),this.matrix=o.matrixWorld,this.matrixAutoUpdate=!1,this.color=c;const d=new gt,p=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let w=0,M=1,R=32;w<R;w++,M++){const A=w/R*Math.PI*2,N=M/R*Math.PI*2;p.push(Math.cos(A),Math.sin(A),1,Math.cos(N),Math.sin(N),1)}d.setAttribute("position",new Wn(p,3));const y=new ol({fog:!1,toneMapped:!1});this.cone=new wu(d,y),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateMatrixWorld();const o=this.light.distance?this.light.distance:1e3,c=o*Math.tan(this.light.angle);this.cone.scale.set(c,c,o),VD.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(VD),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}},b.Sprite=jv,b.SpriteMaterial=Uv,b.SrcAlphaFactor=204,b.SrcAlphaSaturateFactor=210,b.SrcColorFactor=202,b.StaticCopyUsage=35046,b.StaticDrawUsage=ds,b.StaticReadUsage=35045,b.StereoCamera=class Bd{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new vl,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new vl,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(o){const c=this._cache;if(c.focus!==o.focus||c.fov!==o.fov||c.aspect!==o.aspect*this.aspect||c.near!==o.near||c.far!==o.far||c.zoom!==o.zoom||c.eyeSep!==this.eyeSep){c.focus=o.focus,c.fov=o.fov,c.aspect=o.aspect*this.aspect,c.near=o.near,c.far=o.far,c.zoom=o.zoom,c.eyeSep=this.eyeSep,Rf.copy(o.projectionMatrix);const p=c.eyeSep/2,y=p*c.near/c.focus,w=c.near*Math.tan(ud*c.fov*.5)/c.zoom;let M,R;MD.elements[12]=-p,CD.elements[12]=p,M=-w*c.aspect+y,R=w*c.aspect+y,Rf.elements[0]=2*c.near/(R-M),Rf.elements[8]=(R+M)/(R-M),this.cameraL.projectionMatrix.copy(Rf),M=-w*c.aspect-y,R=w*c.aspect-y,Rf.elements[0]=2*c.near/(R-M),Rf.elements[8]=(R+M)/(R-M),this.cameraR.projectionMatrix.copy(Rf)}this.cameraL.matrixWorld.copy(o.matrixWorld).multiply(MD),this.cameraR.matrixWorld.copy(o.matrixWorld).multiply(CD)}},b.StreamCopyUsage=35042,b.StreamDrawUsage=35040,b.StreamReadUsage=35041,b.StringKeyframeTrack=Dm,b.SubtractEquation=101,b.SubtractiveBlending=3,b.TOUCH={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},b.TangentSpaceNormalMap=0,b.TetrahedronBufferGeometry=N_,b.TetrahedronGeometry=N_,b.TextGeometry=function PF(){return console.error("THREE.TextGeometry has been moved to /examples/jsm/geometries/TextGeometry.js"),new gt},b.Texture=Jr,b.TextureLoader=HM,b.TorusBufferGeometry=Cm,b.TorusGeometry=Cm,b.TorusKnotBufferGeometry=Mm,b.TorusKnotGeometry=Mm,b.Triangle=ha,b.TriangleFanDrawMode=2,b.TriangleStripDrawMode=1,b.TrianglesDrawMode=0,b.TubeBufferGeometry=Tm,b.TubeGeometry=Tm,b.UVMapping=300,b.Uint16Attribute=function _o(g,o){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new Vc(g,o)},b.Uint16BufferAttribute=Vc,b.Uint32Attribute=function KD(g,o){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new up(g,o)},b.Uint32BufferAttribute=up,b.Uint8Attribute=function AF(g,o){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new _v(g,o)},b.Uint8BufferAttribute=_v,b.Uint8ClampedAttribute=function As(g,o){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new Jg(g,o)},b.Uint8ClampedBufferAttribute=Jg,b.Uniform=gw,b.UniformsLib=hn,b.UniformsUtils=qE,b.UnsignedByteType=Xn,b.UnsignedInt248Type=gh,b.UnsignedIntType=ic,b.UnsignedShort4444Type=1017,b.UnsignedShort5551Type=1018,b.UnsignedShortType=vs,b.VSMShadowMap=3,b.Vector2=Be,b.Vector3=Ne,b.Vector4=Es,b.VectorKeyframeTrack=Ld,b.Vertex=function YD(g,o,c){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new Ne(g,o,c)},b.VertexColors=2,b.VideoTexture=ZO,b.WebGL1Renderer=b_,b.WebGLCubeRenderTarget=Ul,b.WebGLMultipleRenderTargets=hd,b.WebGLMultisampleRenderTarget=ho,b.WebGLRenderTarget=bs,b.WebGLRenderTargetCube=function DF(g,o,c){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new Ul(g,c)},b.WebGLRenderer=po,b.WebGLUtils=lM,b.WireframeGeometry=ew,b.WireframeHelper=function iR(g,o){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new wu(new ew(g.geometry),new ol({color:void 0!==o?o:16777215}))},b.WrapAroundEnding=hu,b.XHRLoader=function nR(g){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Ah(g)},b.ZeroCurvatureEnding=rd,b.ZeroFactor=200,b.ZeroSlopeEnding=sd,b.ZeroStencilOp=0,b._SRGBAFormat=1035,b.sRGBEncoding=zn}},C=>{C(C.s=5022)}]);